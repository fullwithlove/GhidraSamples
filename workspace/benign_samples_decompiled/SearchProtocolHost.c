/* Function: FUN_0040d99a */

void __fastcall
FUN_0040d99a(int param_1,byte *param_2,undefined4 param_3,undefined4 param_4,undefined4 *param_5,
            undefined4 param_6,undefined4 *param_7)

{
  _EVENT_DATA_DESCRIPTOR local_58 [2];
  undefined4 local_38 [4];
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18 [4];
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  FUN_0040ea79(local_18,(short *)*param_7);
  local_24 = 0;
  local_1c = 0;
  local_28 = param_6;
  local_20 = 4;
  FUN_0040ea79(local_38,(short *)*param_5);
  FUN_00461120(param_1,param_2,(LPCGUID)0x0,(LPCGUID)0x0,5,local_58);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040da0a */

void __fastcall
FUN_0040da0a(int param_1,byte *param_2,undefined4 param_3,undefined4 param_4,undefined4 *param_5)

{
  _EVENT_DATA_DESCRIPTOR local_38 [2];
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_10 = 8;
  local_14 = 0;
  local_18 = *param_5;
  local_c = 0;
  FUN_00461120(param_1,param_2,(LPCGUID)0x0,(LPCGUID)0x0,3,local_38);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040da58 */

void __fastcall
FUN_0040da58(int param_1,byte *param_2,undefined4 param_3,undefined4 *param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 *param_7,undefined4 *param_8,undefined4 *param_9,
            undefined4 *param_10,undefined4 *param_11,undefined4 *param_12,undefined4 *param_13)

{
  _EVENT_DATA_DESCRIPTOR local_d0 [2];
  undefined4 local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  undefined4 local_94;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30 [4];
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_c;
  
  local_c = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_1c = 0;
  local_14 = 0;
  local_20 = *param_13;
  local_18 = 8;
  FUN_0040ea79(local_30,(short *)*param_12);
  local_3c = 0;
  local_38 = 8;
  local_34 = 0;
  local_40 = *param_11;
  local_4c = 0;
  local_48 = 8;
  local_44 = 0;
  local_50 = *param_10;
  local_5c = 0;
  local_58 = 8;
  local_54 = 0;
  local_60 = *param_9;
  local_6c = 0;
  local_68 = 8;
  local_64 = 0;
  local_70 = *param_8;
  local_7c = 0;
  local_78 = 8;
  local_74 = 0;
  local_80 = *param_7;
  local_8c = 0;
  local_88 = 8;
  local_84 = 0;
  local_90 = *param_6;
  local_9c = 0;
  local_98 = 8;
  local_94 = 0;
  local_a0 = *param_5;
  local_ac = 0;
  local_a8 = 8;
  local_a4 = 0;
  local_b0 = *param_4;
  FUN_00442068(param_1,param_2,0,0xc,local_d0);
  FUN_0041e590(local_c ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040db6a */

void __fastcall
FUN_0040db6a(int param_1,byte *param_2,undefined4 param_3,undefined4 *param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 param_7,undefined4 *param_8)

{
  _EVENT_DATA_DESCRIPTOR local_7c [2];
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c [4];
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_1c = *param_8;
  local_18 = 0;
  local_10 = 0;
  local_28 = 0;
  local_20 = 0;
  local_14 = 8;
  local_2c = param_7;
  local_24 = 4;
  FUN_0040ea79(local_3c,(short *)*param_6);
  local_48 = 0;
  local_44 = 8;
  local_40 = 0;
  local_4c = *param_5;
  local_58 = 0;
  local_54 = 8;
  local_50 = 0;
  local_5c = *param_4;
  FUN_00442068(param_1,param_2,0,7,local_7c);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040dc02 */

void __fastcall
FUN_0040dc02(int param_1,byte *param_2,LPCGUID param_3,undefined4 param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 param_7,undefined4 *param_8,undefined4 param_9,
            undefined4 *param_10,undefined4 param_11,undefined4 *param_12,undefined4 param_13,
            undefined4 *param_14,undefined4 param_15,undefined4 *param_16,undefined4 *param_17,
            undefined4 param_18,undefined4 *param_19,undefined4 *param_20)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  _EVENT_DATA_DESCRIPTOR local_128 [2];
  undefined4 local_108;
  undefined4 local_104;
  undefined4 local_100;
  undefined4 local_fc;
  undefined4 local_f8;
  undefined4 local_f4;
  undefined4 local_f0;
  undefined4 local_ec;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  char *local_d8;
  undefined4 local_d4;
  char *local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  char *local_b8;
  undefined4 local_b4;
  char *local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_98 [4];
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  char *local_78;
  undefined4 local_74;
  char *local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  char *local_58;
  undefined4 local_54;
  char *local_50;
  undefined4 local_4c;
  undefined4 local_48 [4];
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  char *local_28;
  undefined4 local_24;
  char *local_20;
  undefined4 local_1c;
  undefined4 local_18 [4];
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  FUN_0040ea79(local_18,(short *)*param_20);
  pcVar3 = (char *)0x1;
  local_28 = (char *)*param_19;
  if (local_28 == (char *)0x0) {
    local_28 = "";
    local_20 = pcVar3;
  }
  else {
    pcVar2 = local_28;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_20 = pcVar2 + (1 - (int)(local_28 + 1));
  }
  local_24 = 0;
  local_1c = 0;
  local_38 = param_18;
  local_34 = 0;
  local_30 = 4;
  local_2c = 0;
  FUN_0040ea79(local_48,(short *)*param_17);
  local_58 = (char *)*param_16;
  if (local_58 == (char *)0x0) {
    local_58 = "";
    local_50 = pcVar3;
  }
  else {
    pcVar2 = local_58;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_50 = pcVar2 + (1 - (int)(local_58 + 1));
  }
  local_68 = param_15;
  local_54 = 0;
  local_78 = (char *)*param_14;
  local_4c = 0;
  local_64 = 0;
  local_60 = 4;
  local_5c = 0;
  if (local_78 == (char *)0x0) {
    local_78 = "";
    local_70 = pcVar3;
  }
  else {
    pcVar2 = local_78;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_70 = pcVar2 + (1 - (int)(local_78 + 1));
  }
  local_74 = 0;
  local_6c = 0;
  local_88 = param_13;
  local_84 = 0;
  local_80 = 4;
  local_7c = 0;
  FUN_0040ea79(local_98,(short *)*param_12);
  local_a8 = param_11;
  local_a4 = 0;
  local_a0 = 4;
  local_9c = 0;
  local_b8 = (char *)*param_10;
  if (local_b8 == (char *)0x0) {
    local_b8 = "";
    local_b0 = pcVar3;
  }
  else {
    pcVar2 = local_b8;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_b0 = pcVar2 + (1 - (int)(local_b8 + 1));
  }
  local_c8 = param_9;
  local_b4 = 0;
  local_d8 = (char *)*param_8;
  local_ac = 0;
  local_c4 = 0;
  local_c0 = 4;
  local_bc = 0;
  if (local_d8 == (char *)0x0) {
    local_d8 = "";
  }
  else {
    pcVar3 = local_d8;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    pcVar3 = pcVar3 + (1 - (int)(local_d8 + 1));
  }
  local_e8 = param_7;
  local_f8 = *param_6;
  local_d4 = 0;
  local_cc = 0;
  local_108 = *param_5;
  local_e4 = 0;
  local_e0 = 4;
  local_dc = 0;
  local_f4 = 0;
  local_f0 = 8;
  local_ec = 0;
  local_104 = 0;
  local_100 = 8;
  local_fc = 0;
  local_d0 = pcVar3;
  FUN_00461120(param_1,param_2,param_3,(LPCGUID)0x0,0x12,local_128);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040de75 */

void __fastcall
FUN_0040de75(int param_1,byte *param_2,LPCGUID param_3,undefined4 param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 param_7,undefined4 *param_8,undefined4 param_9,
            undefined4 *param_10,undefined4 param_11,undefined4 *param_12,undefined4 param_13,
            undefined4 *param_14,undefined4 param_15,undefined4 *param_16,undefined4 *param_17,
            undefined4 param_18,undefined4 *param_19,undefined4 *param_20,undefined4 param_21,
            undefined4 param_22)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  _EVENT_DATA_DESCRIPTOR local_148 [2];
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  undefined4 local_11c;
  undefined4 local_118;
  undefined4 local_114;
  undefined4 local_110;
  undefined4 local_10c;
  undefined4 local_108;
  undefined4 local_104;
  undefined4 local_100;
  undefined4 local_fc;
  char *local_f8;
  undefined4 local_f4;
  char *local_f0;
  undefined4 local_ec;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  char *local_d8;
  undefined4 local_d4;
  char *local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  undefined4 local_b8 [4];
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  char *local_98;
  undefined4 local_94;
  char *local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  char *local_78;
  undefined4 local_74;
  char *local_70;
  undefined4 local_6c;
  undefined4 local_68 [4];
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  char *local_48;
  undefined4 local_44;
  char *local_40;
  undefined4 local_3c;
  undefined4 local_38 [4];
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_18 = param_22;
  local_10 = 4;
  local_20 = 4;
  local_14 = 0;
  local_c = 0;
  local_28 = param_21;
  local_24 = 0;
  local_1c = 0;
  FUN_0040ea79(local_38,(short *)*param_20);
  pcVar3 = (char *)0x1;
  local_48 = (char *)*param_19;
  if (local_48 == (char *)0x0) {
    local_48 = "";
    local_40 = pcVar3;
  }
  else {
    pcVar2 = local_48;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_40 = pcVar2 + (1 - (int)(local_48 + 1));
  }
  local_44 = 0;
  local_3c = 0;
  local_58 = param_18;
  local_54 = 0;
  local_50 = 4;
  local_4c = 0;
  FUN_0040ea79(local_68,(short *)*param_17);
  local_78 = (char *)*param_16;
  if (local_78 == (char *)0x0) {
    local_78 = "";
    local_70 = pcVar3;
  }
  else {
    pcVar2 = local_78;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_70 = pcVar2 + (1 - (int)(local_78 + 1));
  }
  local_88 = param_15;
  local_74 = 0;
  local_98 = (char *)*param_14;
  local_6c = 0;
  local_84 = 0;
  local_80 = 4;
  local_7c = 0;
  if (local_98 == (char *)0x0) {
    local_98 = "";
    local_90 = pcVar3;
  }
  else {
    pcVar2 = local_98;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_90 = pcVar2 + (1 - (int)(local_98 + 1));
  }
  local_94 = 0;
  local_8c = 0;
  local_a8 = param_13;
  local_a4 = 0;
  local_a0 = 4;
  local_9c = 0;
  FUN_0040ea79(local_b8,(short *)*param_12);
  local_c8 = param_11;
  local_c4 = 0;
  local_c0 = 4;
  local_bc = 0;
  local_d8 = (char *)*param_10;
  if (local_d8 == (char *)0x0) {
    local_d8 = "";
    local_d0 = pcVar3;
  }
  else {
    pcVar2 = local_d8;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_d0 = pcVar2 + (1 - (int)(local_d8 + 1));
  }
  local_e8 = param_9;
  local_d4 = 0;
  local_f8 = (char *)*param_8;
  local_cc = 0;
  local_e4 = 0;
  local_e0 = 4;
  local_dc = 0;
  if (local_f8 == (char *)0x0) {
    local_f8 = "";
  }
  else {
    pcVar3 = local_f8;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    pcVar3 = pcVar3 + (1 - (int)(local_f8 + 1));
  }
  local_108 = param_7;
  local_118 = *param_6;
  local_f4 = 0;
  local_ec = 0;
  local_128 = *param_5;
  local_104 = 0;
  local_100 = 4;
  local_fc = 0;
  local_114 = 0;
  local_110 = 8;
  local_10c = 0;
  local_124 = 0;
  local_120 = 8;
  local_11c = 0;
  local_f0 = pcVar3;
  FUN_00461120(param_1,param_2,param_3,(LPCGUID)0x0,0x14,local_148);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040e123 */

void __fastcall
FUN_0040e123(int param_1,byte *param_2,undefined4 param_3,undefined4 *param_4,undefined4 param_5,
            undefined4 param_6,undefined4 *param_7)

{
  _EVENT_DATA_DESCRIPTOR local_70 [2];
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_c;
  
  local_c = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_20 = *param_7;
  local_30 = param_6;
  local_40 = param_5;
  local_1c = 0;
  local_18 = 8;
  local_50 = *param_4;
  local_14 = 0;
  local_2c = 0;
  local_28 = 4;
  local_24 = 0;
  local_3c = 0;
  local_38 = 2;
  local_34 = 0;
  local_4c = 0;
  local_48 = 8;
  local_44 = 0;
  FUN_00442068(param_1,param_2,0,6,local_70);
  FUN_0041e590(local_c ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040e1a8 */

void __fastcall
FUN_0040e1a8(int param_1,byte *param_2,LPCGUID param_3,undefined4 param_4,undefined4 *param_5,
            undefined4 param_6,undefined4 *param_7,undefined4 param_8,undefined4 *param_9,
            undefined4 param_10,undefined4 *param_11,undefined4 param_12,undefined4 *param_13,
            undefined4 param_14,undefined4 *param_15,undefined4 *param_16,undefined4 param_17,
            undefined4 *param_18,undefined4 *param_19)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  _EVENT_DATA_DESCRIPTOR local_118 [2];
  undefined4 local_f8;
  undefined4 local_f4;
  undefined4 local_f0;
  undefined4 local_ec;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  char *local_d8;
  undefined4 local_d4;
  char *local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  char *local_b8;
  undefined4 local_b4;
  char *local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_98 [4];
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  char *local_78;
  undefined4 local_74;
  char *local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  char *local_58;
  undefined4 local_54;
  char *local_50;
  undefined4 local_4c;
  undefined4 local_48 [4];
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  char *local_28;
  undefined4 local_24;
  char *local_20;
  undefined4 local_1c;
  undefined4 local_18 [4];
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  FUN_0040ea79(local_18,(short *)*param_19);
  pcVar3 = (char *)0x1;
  local_28 = (char *)*param_18;
  if (local_28 == (char *)0x0) {
    local_28 = "";
    local_20 = pcVar3;
  }
  else {
    pcVar2 = local_28;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_20 = pcVar2 + (1 - (int)(local_28 + 1));
  }
  local_24 = 0;
  local_1c = 0;
  local_38 = param_17;
  local_34 = 0;
  local_30 = 4;
  local_2c = 0;
  FUN_0040ea79(local_48,(short *)*param_16);
  local_58 = (char *)*param_15;
  if (local_58 == (char *)0x0) {
    local_58 = "";
    local_50 = pcVar3;
  }
  else {
    pcVar2 = local_58;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_50 = pcVar2 + (1 - (int)(local_58 + 1));
  }
  local_68 = param_14;
  local_54 = 0;
  local_78 = (char *)*param_13;
  local_4c = 0;
  local_64 = 0;
  local_60 = 4;
  local_5c = 0;
  if (local_78 == (char *)0x0) {
    local_78 = "";
    local_70 = pcVar3;
  }
  else {
    pcVar2 = local_78;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_70 = pcVar2 + (1 - (int)(local_78 + 1));
  }
  local_74 = 0;
  local_6c = 0;
  local_88 = param_12;
  local_84 = 0;
  local_80 = 4;
  local_7c = 0;
  FUN_0040ea79(local_98,(short *)*param_11);
  local_a8 = param_10;
  local_a4 = 0;
  local_a0 = 4;
  local_9c = 0;
  local_b8 = (char *)*param_9;
  if (local_b8 == (char *)0x0) {
    local_b8 = "";
    local_b0 = pcVar3;
  }
  else {
    pcVar2 = local_b8;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_b0 = pcVar2 + (1 - (int)(local_b8 + 1));
  }
  local_c8 = param_8;
  local_b4 = 0;
  local_d8 = (char *)*param_7;
  local_ac = 0;
  local_c4 = 0;
  local_c0 = 4;
  local_bc = 0;
  if (local_d8 == (char *)0x0) {
    local_d8 = "";
  }
  else {
    pcVar3 = local_d8;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    pcVar3 = pcVar3 + (1 - (int)(local_d8 + 1));
  }
  local_e8 = param_6;
  local_d4 = 0;
  local_f8 = *param_5;
  local_cc = 0;
  local_e4 = 0;
  local_e0 = 4;
  local_dc = 0;
  local_f4 = 0;
  local_f0 = 8;
  local_ec = 0;
  local_d0 = pcVar3;
  FUN_00461120(param_1,param_2,param_3,(LPCGUID)0x0,0x11,local_118);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040e3ff */

void __fastcall
FUN_0040e3ff(int param_1,byte *param_2,LPCGUID param_3,undefined4 param_4,undefined4 *param_5,
            undefined4 param_6,undefined4 *param_7,undefined4 param_8,undefined4 *param_9,
            undefined4 param_10,undefined4 *param_11,undefined4 param_12,undefined4 *param_13,
            undefined4 param_14,undefined4 *param_15,undefined4 *param_16,undefined4 param_17,
            undefined4 *param_18,undefined4 *param_19,undefined4 param_20,undefined4 param_21,
            undefined4 *param_22)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  _EVENT_DATA_DESCRIPTOR local_148 [2];
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  undefined4 local_11c;
  undefined4 local_118;
  undefined4 local_114;
  undefined4 local_110;
  undefined4 local_10c;
  char *local_108;
  undefined4 local_104;
  char *local_100;
  undefined4 local_fc;
  undefined4 local_f8;
  undefined4 local_f4;
  undefined4 local_f0;
  undefined4 local_ec;
  char *local_e8;
  undefined4 local_e4;
  char *local_e0;
  undefined4 local_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined4 local_c8 [4];
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  char *local_a8;
  undefined4 local_a4;
  char *local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  undefined4 local_94;
  undefined4 local_90;
  undefined4 local_8c;
  char *local_88;
  undefined4 local_84;
  char *local_80;
  undefined4 local_7c;
  undefined4 local_78 [4];
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  char *local_58;
  undefined4 local_54;
  char *local_50;
  undefined4 local_4c;
  undefined4 local_48 [4];
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  char *local_18;
  undefined4 local_14;
  char *local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  pcVar3 = (char *)0x1;
  local_18 = (char *)*param_22;
  if (local_18 == (char *)0x0) {
    local_18 = "";
    local_10 = pcVar3;
  }
  else {
    pcVar2 = local_18;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_10 = pcVar2 + (1 - (int)(local_18 + 1));
  }
  local_28 = param_21;
  local_20 = 4;
  local_30 = 4;
  local_14 = 0;
  local_c = 0;
  local_24 = 0;
  local_1c = 0;
  local_38 = param_20;
  local_34 = 0;
  local_2c = 0;
  FUN_0040ea79(local_48,(short *)*param_19);
  local_58 = (char *)*param_18;
  if (local_58 == (char *)0x0) {
    local_58 = "";
    local_50 = pcVar3;
  }
  else {
    pcVar2 = local_58;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_50 = pcVar2 + (1 - (int)(local_58 + 1));
  }
  local_54 = 0;
  local_4c = 0;
  local_68 = param_17;
  local_64 = 0;
  local_60 = 4;
  local_5c = 0;
  FUN_0040ea79(local_78,(short *)*param_16);
  local_88 = (char *)*param_15;
  if (local_88 == (char *)0x0) {
    local_88 = "";
    local_80 = pcVar3;
  }
  else {
    pcVar2 = local_88;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_80 = pcVar2 + (1 - (int)(local_88 + 1));
  }
  local_98 = param_14;
  local_84 = 0;
  local_a8 = (char *)*param_13;
  local_7c = 0;
  local_94 = 0;
  local_90 = 4;
  local_8c = 0;
  if (local_a8 == (char *)0x0) {
    local_a8 = "";
    local_a0 = pcVar3;
  }
  else {
    pcVar2 = local_a8;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_a0 = pcVar2 + (1 - (int)(local_a8 + 1));
  }
  local_a4 = 0;
  local_9c = 0;
  local_b8 = param_12;
  local_b4 = 0;
  local_b0 = 4;
  local_ac = 0;
  FUN_0040ea79(local_c8,(short *)*param_11);
  local_d8 = param_10;
  local_d4 = 0;
  local_d0 = 4;
  local_cc = 0;
  local_e8 = (char *)*param_9;
  if (local_e8 == (char *)0x0) {
    local_e8 = "";
    local_e0 = pcVar3;
  }
  else {
    pcVar2 = local_e8;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_e0 = pcVar2 + (1 - (int)(local_e8 + 1));
  }
  local_f8 = param_8;
  local_e4 = 0;
  local_108 = (char *)*param_7;
  local_dc = 0;
  local_f4 = 0;
  local_f0 = 4;
  local_ec = 0;
  if (local_108 == (char *)0x0) {
    local_108 = "";
  }
  else {
    pcVar3 = local_108;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    pcVar3 = pcVar3 + (1 - (int)(local_108 + 1));
  }
  local_118 = param_6;
  local_104 = 0;
  local_128 = *param_5;
  local_fc = 0;
  local_114 = 0;
  local_110 = 4;
  local_10c = 0;
  local_124 = 0;
  local_120 = 8;
  local_11c = 0;
  local_100 = pcVar3;
  FUN_00461120(param_1,param_2,param_3,(LPCGUID)0x0,0x14,local_148);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040e6d3 */

void __fastcall
FUN_0040e6d3(int param_1,byte *param_2,undefined4 param_3,undefined4 param_4,undefined4 *param_5,
            undefined4 param_6,undefined4 *param_7,undefined4 param_8,undefined4 *param_9,
            undefined4 param_10,undefined4 *param_11,undefined4 param_12,undefined4 *param_13,
            undefined4 param_14,undefined4 *param_15,undefined4 *param_16,undefined4 param_17,
            undefined4 *param_18,undefined4 *param_19,undefined4 param_20,undefined4 param_21,
            undefined4 *param_22,undefined4 *param_23)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  _EVENT_DATA_DESCRIPTOR local_158 [2];
  undefined4 local_138;
  undefined4 local_134;
  undefined4 local_130;
  undefined4 local_12c;
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  undefined4 local_11c;
  char *local_118;
  undefined4 local_114;
  char *local_110;
  undefined4 local_10c;
  undefined4 local_108;
  undefined4 local_104;
  undefined4 local_100;
  undefined4 local_fc;
  char *local_f8;
  undefined4 local_f4;
  char *local_f0;
  undefined4 local_ec;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  undefined4 local_d8 [4];
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  char *local_b8;
  undefined4 local_b4;
  char *local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  char *local_98;
  undefined4 local_94;
  char *local_90;
  undefined4 local_8c;
  undefined4 local_88 [4];
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined4 local_6c;
  char *local_68;
  undefined4 local_64;
  char *local_60;
  undefined4 local_5c;
  undefined4 local_58 [4];
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  char *local_28;
  undefined4 local_24;
  char *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_18 = *param_23;
  pcVar3 = (char *)0x1;
  local_28 = (char *)*param_22;
  local_14 = 0;
  local_10 = 8;
  local_c = 0;
  if (local_28 == (char *)0x0) {
    local_28 = "";
    local_20 = pcVar3;
  }
  else {
    pcVar2 = local_28;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_20 = pcVar2 + (1 - (int)(local_28 + 1));
  }
  local_38 = param_21;
  local_30 = 4;
  local_40 = 4;
  local_24 = 0;
  local_1c = 0;
  local_34 = 0;
  local_2c = 0;
  local_48 = param_20;
  local_44 = 0;
  local_3c = 0;
  FUN_0040ea79(local_58,(short *)*param_19);
  local_68 = (char *)*param_18;
  if (local_68 == (char *)0x0) {
    local_68 = "";
    local_60 = pcVar3;
  }
  else {
    pcVar2 = local_68;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_60 = pcVar2 + (1 - (int)(local_68 + 1));
  }
  local_64 = 0;
  local_5c = 0;
  local_78 = param_17;
  local_74 = 0;
  local_70 = 4;
  local_6c = 0;
  FUN_0040ea79(local_88,(short *)*param_16);
  local_98 = (char *)*param_15;
  if (local_98 == (char *)0x0) {
    local_98 = "";
    local_90 = pcVar3;
  }
  else {
    pcVar2 = local_98;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_90 = pcVar2 + (1 - (int)(local_98 + 1));
  }
  local_a8 = param_14;
  local_94 = 0;
  local_b8 = (char *)*param_13;
  local_8c = 0;
  local_a4 = 0;
  local_a0 = 4;
  local_9c = 0;
  if (local_b8 == (char *)0x0) {
    local_b8 = "";
    local_b0 = pcVar3;
  }
  else {
    pcVar2 = local_b8;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_b0 = pcVar2 + (1 - (int)(local_b8 + 1));
  }
  local_b4 = 0;
  local_ac = 0;
  local_c8 = param_12;
  local_c4 = 0;
  local_c0 = 4;
  local_bc = 0;
  FUN_0040ea79(local_d8,(short *)*param_11);
  local_e8 = param_10;
  local_e4 = 0;
  local_e0 = 4;
  local_dc = 0;
  local_f8 = (char *)*param_9;
  if (local_f8 == (char *)0x0) {
    local_f8 = "";
    local_f0 = pcVar3;
  }
  else {
    pcVar2 = local_f8;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_f0 = pcVar2 + (1 - (int)(local_f8 + 1));
  }
  local_108 = param_8;
  local_f4 = 0;
  local_118 = (char *)*param_7;
  local_ec = 0;
  local_104 = 0;
  local_100 = 4;
  local_fc = 0;
  if (local_118 == (char *)0x0) {
    local_118 = "";
  }
  else {
    pcVar3 = local_118;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    pcVar3 = pcVar3 + (1 - (int)(local_118 + 1));
  }
  local_128 = param_6;
  local_114 = 0;
  local_138 = *param_5;
  local_10c = 0;
  local_124 = 0;
  local_120 = 4;
  local_11c = 0;
  local_134 = 0;
  local_130 = 8;
  local_12c = 0;
  local_110 = pcVar3;
  FUN_00461120(param_1,param_2,(LPCGUID)0x0,(LPCGUID)0x0,0x15,local_158);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040e9bc */

void __fastcall
FUN_0040e9bc(int param_1,byte *param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5)

{
  _EVENT_DATA_DESCRIPTOR local_38 [2];
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_18 = param_5;
  local_14 = 0;
  local_10 = 4;
  local_c = 0;
  FUN_00461120(param_1,param_2,(LPCGUID)0x0,(LPCGUID)0x0,3,local_38);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040ea08 */

void __fastcall
FUN_0040ea08(int param_1,byte *param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5,
            undefined4 param_6,undefined4 *param_7)

{
  _EVENT_DATA_DESCRIPTOR local_58 [2];
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_18 = *param_7;
  local_28 = param_6;
  local_38 = param_5;
  local_14 = 0;
  local_10 = 8;
  local_c = 0;
  local_24 = 0;
  local_20 = 4;
  local_1c = 0;
  local_34 = 0;
  local_30 = 4;
  local_2c = 0;
  FUN_00461120(param_1,param_2,(LPCGUID)0x0,(LPCGUID)0x0,5,local_58);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040ea79 */

void __fastcall FUN_0040ea79(undefined4 *param_1,short *param_2)

{
  short sVar1;
  short *psVar2;
  int iVar3;
  
  if (param_2 == (short *)0x0) {
    param_2 = &DAT_0040352c;
    iVar3 = 2;
  }
  else {
    psVar2 = param_2;
    do {
      sVar1 = *psVar2;
      psVar2 = psVar2 + 1;
    } while (sVar1 != 0);
    iVar3 = ((int)psVar2 - (int)(param_2 + 1) >> 1) * 2 + 2;
  }
  param_1[2] = iVar3;
  param_1[1] = 0;
  param_1[3] = 0;
  *param_1 = param_2;
  return;
}



/* Function: FUN_0040eabe */

void __fastcall
FUN_0040eabe(int param_1,byte *param_2,undefined4 param_3,undefined4 param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 param_7,undefined4 *param_8)

{
  _EVENT_DATA_DESCRIPTOR local_68 [2];
  undefined4 local_48 [4];
  undefined4 local_38 [4];
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_18 = *param_8;
  local_14 = 0;
  local_c = 0;
  local_24 = 0;
  local_1c = 0;
  local_10 = 8;
  local_28 = param_7;
  local_20 = 4;
  FUN_0040ea79(local_38,(short *)*param_6);
  FUN_0040ea79(local_48,(short *)*param_5);
  FUN_00461120(param_1,param_2,(LPCGUID)0x0,(LPCGUID)0x0,6,local_68);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040eb43 */

void __fastcall
FUN_0040eb43(undefined4 param_1,byte *param_2,undefined4 param_3,undefined4 param_4,
            undefined4 *param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8,
            undefined4 *param_9,undefined4 *param_10,undefined4 *param_11,undefined4 param_12,
            undefined4 *param_13,undefined4 *param_14,undefined4 param_15,undefined4 *param_16,
            undefined4 *param_17,undefined4 param_18,undefined4 *param_19,undefined4 *param_20,
            undefined4 param_21,undefined4 *param_22,undefined4 *param_23,undefined4 param_24,
            undefined4 *param_25,undefined4 *param_26,undefined4 param_27,undefined4 *param_28,
            undefined4 *param_29,undefined4 param_30,undefined4 *param_31,undefined4 *param_32,
            undefined4 param_33,undefined4 *param_34,undefined4 param_35,undefined4 param_36)

{
  _EVENT_DATA_DESCRIPTOR local_2b8 [2];
  undefined4 local_298;
  undefined4 local_294;
  undefined4 local_290;
  undefined4 local_28c;
  undefined4 local_288;
  undefined4 local_284;
  undefined4 local_280;
  undefined4 local_27c;
  undefined4 local_278;
  undefined4 local_274;
  undefined4 local_270;
  undefined4 local_26c;
  undefined4 local_268;
  undefined4 local_264;
  undefined4 local_260;
  undefined4 local_25c;
  undefined4 local_258;
  undefined4 local_254;
  undefined4 local_250;
  undefined4 local_24c;
  uint *local_248;
  undefined4 local_244;
  undefined4 local_240;
  undefined4 local_23c;
  undefined4 local_238;
  undefined4 local_234;
  uint local_230 [3];
  undefined4 local_224;
  undefined4 local_220;
  undefined4 local_21c;
  undefined4 local_218;
  undefined4 local_214;
  undefined4 local_210;
  undefined4 local_20c;
  uint *local_208;
  undefined4 local_204;
  undefined4 local_200;
  undefined4 local_1fc;
  undefined4 local_1f8;
  undefined4 local_1f4;
  uint local_1f0 [3];
  undefined4 local_1e4;
  undefined4 local_1e0;
  undefined4 local_1dc;
  undefined4 local_1d8;
  undefined4 local_1d4;
  undefined4 local_1d0;
  undefined4 local_1cc;
  uint *local_1c8;
  undefined4 local_1c4;
  undefined4 local_1c0;
  undefined4 local_1bc;
  undefined4 local_1b8;
  undefined4 local_1b4;
  uint local_1b0 [3];
  undefined4 local_1a4;
  undefined4 local_1a0;
  undefined4 local_19c;
  undefined4 local_198;
  undefined4 local_194;
  undefined4 local_190;
  undefined4 local_18c;
  uint *local_188;
  undefined4 local_184;
  undefined4 local_180;
  undefined4 local_17c;
  undefined4 local_178;
  undefined4 local_174;
  uint local_170 [3];
  undefined4 local_164;
  undefined4 local_160;
  undefined4 local_15c;
  undefined4 local_158;
  undefined4 local_154;
  undefined4 local_150;
  undefined4 local_14c;
  uint *local_148;
  undefined4 local_144;
  undefined4 local_140;
  undefined4 local_13c;
  undefined4 local_138;
  undefined4 local_134;
  uint local_130 [3];
  undefined4 local_124;
  undefined4 local_120;
  undefined4 local_11c;
  undefined4 local_118;
  undefined4 local_114;
  undefined4 local_110;
  undefined4 local_10c;
  uint *local_108;
  undefined4 local_104;
  undefined4 local_100;
  undefined4 local_fc;
  undefined4 local_f8;
  undefined4 local_f4;
  uint local_f0 [3];
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  undefined4 local_cc;
  uint *local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  uint local_b0 [3];
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  undefined4 local_94;
  undefined4 local_90;
  undefined4 local_8c;
  uint *local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  uint local_70 [3];
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  uint *local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  uint local_30 [3];
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_18 = param_36;
  local_30[2] = param_35;
  local_48 = local_30;
  local_38 = *param_34;
  local_30[0] = (uint)*(ushort *)(param_34 + 1);
  local_58 = param_33;
  local_74 = 0;
  local_b4 = 0;
  local_5c = 0;
  local_70[2] = *param_32;
  local_88 = local_70;
  local_84 = 0;
  local_7c = 0;
  local_78 = *param_31;
  local_70[0] = (uint)*(ushort *)(param_31 + 1);
  local_98 = param_30;
  local_70[1] = 0;
  local_94 = 0;
  local_b0[2] = *param_29;
  local_8c = 0;
  local_a4 = 0;
  local_9c = 0;
  local_c4 = 0;
  local_bc = 0;
  local_c8 = local_b0;
  local_b8 = *param_28;
  local_b0[0] = (uint)*(ushort *)(param_28 + 1);
  local_14 = 0;
  local_c = 0;
  local_24 = 0;
  local_1c = 0;
  local_44 = 0;
  local_3c = 0;
  local_34 = 0;
  local_30[1] = 0;
  local_54 = 0;
  local_4c = 0;
  local_64 = 0;
  local_10 = 1;
  local_20 = 4;
  local_40 = 2;
  local_50 = 1;
  local_60 = 8;
  local_80 = 2;
  local_90 = 1;
  local_a0 = 8;
  local_c0 = 2;
  local_b0[1] = 0;
  local_d8 = param_27;
  local_d4 = 0;
  local_cc = 0;
  local_e4 = 0;
  local_f0[2] = *param_26;
  local_108 = local_f0;
  local_dc = 0;
  local_104 = 0;
  local_fc = 0;
  local_f4 = 0;
  local_134 = 0;
  local_174 = 0;
  local_f8 = *param_25;
  local_f0[0] = (uint)*(ushort *)(param_25 + 1);
  local_118 = param_24;
  local_f0[1] = 0;
  local_114 = 0;
  local_10c = 0;
  local_130[2] = *param_23;
  local_148 = local_130;
  local_124 = 0;
  local_11c = 0;
  local_144 = 0;
  local_13c = 0;
  local_d0 = 1;
  local_e0 = 8;
  local_100 = 2;
  local_138 = *param_22;
  local_130[0] = (uint)*(ushort *)(param_22 + 1);
  local_158 = param_21;
  local_130[1] = 0;
  local_154 = 0;
  local_14c = 0;
  local_170[2] = *param_20;
  local_188 = local_170;
  local_164 = 0;
  local_15c = 0;
  local_184 = 0;
  local_17c = 0;
  local_110 = 1;
  local_120 = 8;
  local_178 = *param_19;
  local_170[0] = (uint)*(ushort *)(param_19 + 1);
  local_198 = param_18;
  local_140 = 2;
  local_150 = 1;
  local_160 = 8;
  local_1b0[2] = *param_17;
  local_180 = 2;
  local_170[1] = 0;
  local_194 = 0;
  local_190 = 1;
  local_18c = 0;
  local_1a4 = 0;
  local_19c = 0;
  local_1c8 = local_1b0;
  local_1c4 = 0;
  local_1bc = 0;
  local_1b4 = 0;
  local_1f4 = 0;
  local_1b8 = *param_16;
  local_1b0[0] = (uint)*(ushort *)(param_16 + 1);
  local_1d8 = param_15;
  local_1b0[1] = 0;
  local_1d4 = 0;
  local_1cc = 0;
  local_1f0[2] = *param_14;
  local_208 = local_1f0;
  local_1e4 = 0;
  local_1dc = 0;
  local_204 = 0;
  local_1fc = 0;
  local_1c0 = 2;
  local_200 = 2;
  local_240 = 2;
  local_1f8 = *param_13;
  local_1f0[0] = (uint)*(ushort *)(param_13 + 1);
  local_218 = param_12;
  local_1f0[1] = 0;
  local_214 = 0;
  local_20c = 0;
  local_230[2] = *param_11;
  local_248 = local_230;
  local_224 = 0;
  local_21c = 0;
  local_244 = 0;
  local_1a0 = 8;
  local_1d0 = 1;
  local_238 = *param_10;
  local_230[0] = (uint)*(ushort *)(param_10 + 1);
  local_1e0 = 8;
  local_210 = 1;
  local_258 = *param_9;
  local_268 = param_8;
  local_220 = 8;
  local_23c = 0;
  local_234 = 0;
  local_230[1] = 0;
  local_254 = 0;
  local_250 = 0x10;
  local_24c = 0;
  local_264 = 0;
  local_260 = 1;
  local_25c = 0;
  local_278 = param_7;
  local_274 = 0;
  local_270 = 4;
  local_26c = 0;
  local_288 = param_6;
  local_284 = 0;
  local_280 = 4;
  local_27c = 0;
  local_298 = *param_5;
  local_294 = 0;
  local_290 = 8;
  local_28c = 0;
  FUN_00461120(0x46b570,param_2,(LPCGUID)0x0,(LPCGUID)0x0,0x2b,local_2b8);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040f018 */

void __fastcall
FUN_0040f018(int param_1,byte *param_2,undefined4 param_3,undefined4 *param_4,undefined4 *param_5,
            undefined4 param_6,undefined4 param_7,undefined4 *param_8,undefined4 *param_9)

{
  char cVar1;
  char *pcVar2;
  _EVENT_DATA_DESCRIPTOR local_90 [2];
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  char *local_60;
  undefined4 local_5c;
  char *local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  char *local_30;
  undefined4 local_2c;
  char *local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_c;
  
  local_c = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_18 = 8;
  local_20 = *param_9;
  local_58 = (char *)0x1;
  local_1c = 0;
  local_30 = (char *)*param_8;
  local_14 = 0;
  if (local_30 == (char *)0x0) {
    local_30 = "";
    local_28 = local_58;
  }
  else {
    pcVar2 = local_30;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_28 = pcVar2 + (1 - (int)(local_30 + 1));
  }
  local_40 = param_7;
  local_50 = param_6;
  local_2c = 0;
  local_24 = 0;
  local_3c = 0;
  local_34 = 0;
  local_4c = 0;
  local_44 = 0;
  local_60 = (char *)*param_5;
  local_38 = 4;
  local_48 = 4;
  if (local_60 == (char *)0x0) {
    local_60 = "";
  }
  else {
    local_58 = local_60;
    do {
      cVar1 = *local_58;
      local_58 = local_58 + 1;
    } while (cVar1 != '\0');
    local_58 = local_58 + (1 - (int)(local_60 + 1));
  }
  local_70 = *param_4;
  local_5c = 0;
  local_54 = 0;
  local_6c = 0;
  local_68 = 8;
  local_64 = 0;
  FUN_00442068(param_1,param_2,0,8,local_90);
  FUN_0041e590(local_c ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040f114 */

void __fastcall
FUN_0040f114(int param_1,byte *param_2,undefined4 param_3,undefined4 *param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 *param_7,undefined4 *param_8,undefined4 *param_9)

{
  _EVENT_DATA_DESCRIPTOR local_90 [2];
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30 [4];
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_c;
  
  local_c = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_1c = 0;
  local_14 = 0;
  local_20 = *param_9;
  local_18 = 8;
  FUN_0040ea79(local_30,(short *)*param_8);
  local_3c = 0;
  local_38 = 8;
  local_34 = 0;
  local_40 = *param_7;
  local_4c = 0;
  local_48 = 8;
  local_44 = 0;
  local_50 = *param_6;
  local_5c = 0;
  local_58 = 8;
  local_54 = 0;
  local_60 = *param_5;
  local_6c = 0;
  local_68 = 8;
  local_64 = 0;
  local_70 = *param_4;
  FUN_00442068(param_1,param_2,0,8,local_90);
  FUN_0041e590(local_c ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040f1c0 */

void __fastcall
FUN_0040f1c0(int param_1,byte *param_2,undefined4 param_3,undefined4 *param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 *param_7,undefined4 *param_8,undefined4 *param_9,
            undefined4 *param_10,undefined4 *param_11,undefined4 *param_12,undefined4 param_13,
            undefined4 param_14,undefined4 param_15,undefined4 *param_16)

{
  _EVENT_DATA_DESCRIPTOR local_fc [2];
  undefined4 local_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  undefined4 local_94;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_1c = *param_16;
  local_2c = param_15;
  local_3c = param_14;
  local_4c = param_13;
  local_5c = *param_12;
  local_18 = 0;
  local_6c = *param_11;
  local_14 = 8;
  local_10 = 0;
  local_28 = 0;
  local_7c = *param_10;
  local_24 = 4;
  local_20 = 0;
  local_38 = 0;
  local_8c = *param_9;
  local_34 = 4;
  local_30 = 0;
  local_48 = 0;
  local_9c = *param_8;
  local_44 = 4;
  local_40 = 0;
  local_58 = 0;
  local_ac = *param_7;
  local_54 = 8;
  local_50 = 0;
  local_68 = 0;
  local_bc = *param_6;
  local_64 = 8;
  local_60 = 0;
  local_78 = 0;
  local_cc = *param_5;
  local_74 = 8;
  local_70 = 0;
  local_88 = 0;
  local_dc = *param_4;
  local_84 = 8;
  local_80 = 0;
  local_98 = 0;
  local_94 = 8;
  local_90 = 0;
  local_a8 = 0;
  local_a4 = 8;
  local_a0 = 0;
  local_b8 = 0;
  local_b4 = 8;
  local_b0 = 0;
  local_c8 = 0;
  local_c4 = 8;
  local_c0 = 0;
  local_d8 = 0;
  local_d4 = 8;
  local_d0 = 0;
  FUN_00442068(param_1,param_2,0,0xf,local_fc);
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040f330 */

void FUN_0040f330(void)

{
  FUN_0041df04(&DAT_0046d000,"Error formatting string.");
  FUN_0041ee63(FUN_00459210);
  return;
}



/* Function: FUN_0040f360 */

void FUN_0040f360(void)

{
  FUN_0041d3f7();
  FUN_0041ee63(FUN_00459250);
  return;
}



/* Function: FUN_0040f380 */

void FUN_0040f380(void)

{
  FUN_0041deb0(&DAT_0046d028,L"Error formatting string.");
  FUN_0041ee63(FUN_00459260);
  return;
}



/* Function: FUN_0040f3b0 */

void FUN_0040f3b0(void)

{
  FUN_0041cd24();
  FUN_0041ee63(FUN_00459270);
  return;
}



/* Function: FUN_0040f3d0 */

void FUN_0040f3d0(void)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  iVar2 = 5;
  puVar3 = &DAT_004030ac;
  puVar4 = &DAT_0046c558;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_00403124;
  puVar4 = &DAT_0046c56c;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_00403110;
  puVar4 = &DAT_0046c580;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_00403070;
  puVar4 = &DAT_0046c594;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_0040305c;
  puVar4 = &DAT_0046c5a8;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_00403160;
  puVar4 = &DAT_0046c5bc;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_00403098;
  puVar4 = &DAT_0046c5d0;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_00403188;
  puVar4 = &DAT_0046c5e4;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_004031b0;
  puVar4 = &DAT_0046c5f8;
  for (iVar1 = iVar2; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  puVar3 = &DAT_00403020;
  puVar4 = &DAT_0046c60c;
  for (; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  return;
}



/* Function: FUN_0040f470 */

void FUN_0040f470(void)

{
  InitializeCriticalSection((LPCRITICAL_SECTION)&DAT_0046ca60);
  FUN_0041ee63(FUN_004592a0);
  return;
}



/* Function: FUN_0040f490 */

void FUN_0040f490(void)

{
  InitializeCriticalSection((LPCRITICAL_SECTION)&DAT_0046cac0);
  FUN_0041ee63(FUN_004592b0);
  return;
}



/* Function: FUN_0040f4b0 */

void FUN_0040f4b0(void)

{
  FUN_0041dcf9();
  FUN_0041ee63(FUN_004592c0);
  return;
}



/* Function: FUN_0040f4d0 */

void FUN_0040f4d0(void)

{
  FUN_0041cf28(&DAT_0046d098);
  FUN_0041ee63(FUN_00459310);
  return;
}



/* Function: FUN_0040f4f0 */

void FUN_0040f4f0(void)

{
  FUN_0041ee63(FUN_00459340);
  return;
}



/* Function: FUN_0040f510 */

void FUN_0040f510(void)

{
  FUN_0041ee63(FUN_00459350);
  return;
}



/* Function: FUN_0040f530 */

void FUN_0040f530(void)

{
  FUN_0041ee63(FUN_00459360);
  return;
}



/* Function: FUN_0040f550 */

void FUN_0040f550(void)

{
  FUN_0041ee63(FUN_00459370);
  return;
}



/* Function: FUN_0040f570 */

void FUN_0040f570(void)

{
  FUN_0041ee63(FUN_00459380);
  return;
}



/* Function: FUN_0040f590 */

void FUN_0040f590(void)

{
  FUN_0041ee63(FUN_00459390);
  return;
}



/* Function: FUN_0040f5b0 */

void FUN_0040f5b0(void)

{
  FUN_0041ee63(FUN_004593a0);
  return;
}



/* Function: FUN_0040f5d0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0040f5d0(void)

{
  _DAT_0046c2d4 = FUN_0045edd0;
  DAT_0046c2dc = FUN_0045fdb0;
  DAT_0046c2d8 = FUN_004328a0;
  return;
}



/* Function: FUN_0040f600 */

void FUN_0040f600(void)

{
  DAT_0046c2d0 = FUN_0045c880;
  DAT_0046c2c0 = &PTR_s_WilError_03_0046b5e8;
  DAT_0046c2c4 = s_padpadpa_0046bde4 + 8;
  return;
}



/* Function: FUN_0040f630 */

void FUN_0040f630(void)

{
  DAT_0046d1d8 = FUN_004373e0;
  DAT_0046d19c = FUN_00460210;
  DAT_0046d1c8 = FUN_00460290;
  DAT_0046d1dc = FUN_004602c0;
  DAT_0046d1d0 = FUN_00437460;
  DAT_0046d1cc = FUN_0043c4c0;
  return;
}



/* Function: FUN_0040f680 */

void FUN_0040f680(void)

{
  DAT_0046d1c4 = FUN_0045e290;
  return;
}



/* Function: FUN_0040f6a0 */

void FUN_0040f6a0(void)

{
  DAT_0046c2cc = FUN_00432aa0;
  DAT_0046c544 = FUN_0043beb0;
  return;
}



/* Function: FUN_0040f6c0 */

void FUN_0040f6c0(void)

{
  DAT_0046d194 = FUN_0045c8b0;
  DAT_0046d18c = DebugBreak;
  DAT_0046d190 = FUN_004603b0;
  DAT_0046d184 = FUN_004288c0;
  DAT_0046d180 = FUN_0042f380;
  DAT_0046d198 = FUN_0045ef90;
  DAT_0046d188 = FUN_0045ef20;
  return;
}



/* Function: FUN_0040f710 */

void FUN_0040f710(void)

{
  DAT_0046c36c = FUN_0043b850;
  return;
}



/* Function: FUN_0040f730 */

void FUN_0040f730(void)

{
  FUN_0041ee63(FUN_004593b0);
  return;
}



/* Function: FUN_0040f750 */

void FUN_0040f750(void)

{
  FUN_0041ee63(FUN_004593c0);
  return;
}



/* Function: FUN_0040f770 */

void FUN_0040f770(void)

{
  FUN_0041cd96();
  FUN_0041ee63(FUN_00459470);
  return;
}



/* Function: FUN_0040f790 */

void FUN_0040f790(void)

{
  FUN_0041cdfe();
  FUN_0041ee63(FUN_00459480);
  return;
}



/* Function: FUN_0040f7b0 */

void FUN_0040f7b0(void)

{
  FUN_0041d927(&DAT_0046cbbc,(short *)&DAT_004081b8);
  FUN_0041ee63(FUN_00459560);
  return;
}



/* Function: FUN_0040f7e0 */

void FUN_0040f7e0(void)

{
  FUN_0041d927(&DAT_0046cb9c,L"file");
  FUN_0041ee63(FUN_00459580);
  return;
}



/* Function: FUN_0040f810 */

void FUN_0040f810(void)

{
  FUN_0041d927(&DAT_0046cb7c,L"http");
  FUN_0041ee63(FUN_004595a0);
  return;
}



/* Function: FUN_0040f840 */

void FUN_0040f840(void)

{
  FUN_0041d927(&DAT_0046cb8c,L"https");
  FUN_0041ee63(FUN_004595c0);
  return;
}



/* Function: FUN_0040f870 */

void FUN_0040f870(void)

{
  FUN_0041d927(&DAT_0046cbcc,L"unknown");
  FUN_0041ee63(FUN_004595e0);
  return;
}



/* Function: FUN_0040f8a0 */

void FUN_0040f8a0(void)

{
  FUN_0041d927(&DAT_0046cbac,L"winrt");
  FUN_0041ee63(FUN_00459600);
  return;
}



/* Function: FUN_0040f8d0 */

void FUN_0040f8d0(void)

{
  DAT_0046c304 = 0;
  DAT_0046c30c = 0;
  DAT_0046c300 = 0;
  DAT_0046c2fc = 0;
  DAT_0046c308 = 0;
  FUN_0041ee63(thunk_FUN_0041dc98);
  return;
}



/* Function: FUN_0040f900 */

int __thiscall FUN_0040f900(void *this,uint param_1)

{
  int iVar1;
  int extraout_EDX;
  short *psVar2;
  
  if (param_1 < *(uint *)((int)this + 0xc)) {
    psVar2 = (short *)(*(int *)((int)this + 4) + param_1 * 2);
    do {
      iVar1 = FUN_00444229(*psVar2);
      if (iVar1 != 0) {
        return extraout_EDX;
      }
      psVar2 = psVar2 + 1;
    } while (extraout_EDX + 1U < *(uint *)((int)this + 0xc));
  }
  return -1;
}



/* Function: FUN_0040f93d */

DWORD __fastcall FUN_0040f93d(void *param_1)

{
  uint uVar1;
  int iVar2;
  DWORD DVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar1 = FUN_00419d16(param_1,*(int *)((int)param_1 + 0x30));
  uVar6 = 10000;
  if ((*(int *)((int)param_1 + 0x4c) != -1) && (*(uint *)((int)param_1 + 0x4c) < 10000)) {
    uVar6 = *(uint *)((int)param_1 + 0x4c);
  }
  uVar5 = 0;
  while( true ) {
    iVar2 = FUN_00444c93(uVar1,(HANDLE *)((int)param_1 + 0x14),uVar6,*(char *)((int)param_1 + 0x124)
                        );
    if (-1 < *(int *)(*(int *)((int)param_1 + 0x28) + 0x80)) {
      return 0x80040db4;
    }
    if (iVar2 != 0x102) break;
    uVar4 = uVar5 + uVar6;
    if (*(int *)((int)param_1 + 0x4c) == -1) {
      uVar4 = uVar5;
    }
    uVar5 = uVar4;
    if (*(uint *)((int)param_1 + 0x4c) <= uVar4) {
      return 0x800705b4;
    }
  }
  DVar3 = FUN_00419d78(iVar2);
  return DVar3;
}



/* Function: FUN_0040f9af */

/* WARNING: Variable defined which should be unmapped: param_2 */

undefined4 * __thiscall FUN_0040f9af(int param_1,undefined4 *param_2)

{
  short sVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 uVar4;
  
  FUN_0041bf6e(param_1);
  sVar1 = *(short *)(param_1 + 0x1a0);
  if (sVar1 == 0) {
    *param_2 = 0;
    uVar4 = DAT_0046cba8;
    param_2[2] = &DAT_0046cb9c;
  }
  else if (sVar1 == 1) {
    *param_2 = 0;
    uVar4 = DAT_0046cb88;
    param_2[2] = &DAT_0046cb7c;
  }
  else {
    if (sVar1 == 6) {
      iVar3 = FUN_004286dd((void *)(param_1 + 0xc),L':',0);
      FUN_0041c10d((void *)(param_1 + 0xc),param_2,0,iVar3);
      return param_2;
    }
    if (sVar1 == 7) {
      *param_2 = 0;
      uVar4 = DAT_0046cb98;
      param_2[2] = &DAT_0046cb8c;
    }
    else if (sVar1 == 8) {
      *param_2 = 0;
      uVar4 = DAT_0046cbb8;
      param_2[2] = &DAT_0046cbac;
    }
    else {
      *param_2 = 0;
      uVar2 = DAT_0046cbd8;
      uVar4 = DAT_0046cbc8;
      if (sVar1 == 9) {
        param_2[2] = &DAT_0046cbbc;
      }
      else {
        param_2[2] = &DAT_0046cbcc;
        uVar4 = uVar2;
      }
    }
  }
  param_2[1] = uVar4;
  return param_2;
}



/* Function: FUN_0040fa23 */

void __thiscall FUN_0040fa23(void *this,PSID param_1)

{
  code *pcVar1;
  DWORD dwAceIndex;
  BOOL BVar2;
  int unaff_retaddr;
  void *local_8;
  
  local_8 = this;
  dwAceIndex = FUN_0040fa73((int *)this);
  while( true ) {
    dwAceIndex = dwAceIndex - 1;
    if ((int)dwAceIndex < 0) {
      return;
    }
                    /* WARNING: Load size is inaccurate */
    BVar2 = GetAce(*this,dwAceIndex,&local_8);
    if (BVar2 == 0) break;
    BVar2 = EqualPrefixSid((PSID)((int)local_8 + 8),param_1);
    if (BVar2 != 0) {
      FUN_00459705();
      return;
    }
  }
  FUN_0045fdf4(unaff_retaddr,0x611,0x407140);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_0040fa73 */

void __fastcall FUN_0040fa73(int *param_1)

{
  code *pcVar1;
  BOOL BVar2;
  int unaff_retaddr;
  undefined1 local_14 [12];
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  if ((*param_1 != 0) &&
     (BVar2 = GetAclInformation((PACL)*param_1,local_14,0xc,AclSizeInformation), BVar2 == 0)) {
    FUN_0045fdf4(unaff_retaddr,0x3b4,0x407140);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0040fabb */

DWORD FUN_0040fabb(void)

{
  undefined4 *puVar1;
  PHANDLE TokenHandle;
  HANDLE ProcessHandle;
  BOOL BVar2;
  DWORD DVar3;
  PACL pAVar4;
  DWORD DVar5;
  undefined4 *TokenInformation;
  undefined4 *TokenInformation_00;
  undefined1 local_30 [20];
  uint local_1c;
  undefined4 *local_18;
  PACL local_14;
  HANDLE local_10;
  uint local_c;
  undefined4 *local_8;
  
  TokenInformation_00 = (undefined4 *)0x0;
  DVar5 = 0;
  local_10 = (HANDLE)0x0;
  TokenHandle = (PHANDLE)FUN_0043a79f(&local_10);
  ProcessHandle = GetCurrentProcess();
  BVar2 = OpenProcessToken(ProcessHandle,8,TokenHandle);
  if (BVar2 == 0) {
    DVar3 = GetLastError();
    if (0 < (int)DVar3) {
      DVar3 = DVar3 & 0xffff | 0x80070000;
    }
    goto LAB_0040fd88;
  }
  TokenInformation = (undefined4 *)0x0;
  GetTokenInformation(local_10,TokenUser,(LPVOID)0x0,0,&local_c);
  DVar3 = GetLastError();
  if (DVar3 == 0x7a) {
    TokenInformation_00 = (undefined4 *)FUN_0041eea7(local_c);
    if (TokenInformation_00 == (undefined4 *)0x0) {
      DVar3 = 0x8007000e;
      goto LAB_0040fd88;
    }
LAB_0040fb40:
    BVar2 = GetTokenInformation(local_10,TokenUser,TokenInformation_00,local_c,&local_c);
    if (BVar2 == 0) {
      DVar3 = GetLastError();
      if (0 < (int)DVar3) {
        DVar3 = DVar3 & 0xffff | 0x80070000;
      }
      DVar5 = DVar3;
      if ((int)DVar3 < 0) goto LAB_0040fbf6;
    }
    TokenInformation = (undefined4 *)0x0;
    GetTokenInformation(local_10,TokenPrimaryGroup,(LPVOID)0x0,0,&local_c);
    DVar3 = GetLastError();
    if (DVar3 != 0x7a) {
      if (0 < (int)DVar3) {
        DVar3 = DVar3 & 0xffff | 0x80070000;
      }
      if (-1 < (int)DVar3) goto LAB_0040fbca;
      goto LAB_0040fbf6;
    }
    TokenInformation = (undefined4 *)FUN_0041eea7(local_c);
    DVar3 = DVar5;
    if (TokenInformation != (undefined4 *)0x0) {
LAB_0040fbca:
      BVar2 = GetTokenInformation(local_10,TokenPrimaryGroup,TokenInformation,local_c,&local_c);
      if ((BVar2 == 0) && (DVar3 = GetLastError(), 0 < (int)DVar3)) {
        DVar3 = DVar3 & 0xffff | 0x80070000;
      }
      goto LAB_0040fbf6;
    }
    DVar3 = 0x8007000e;
  }
  else {
    if (0 < (int)DVar3) {
      DVar3 = DVar3 & 0xffff | 0x80070000;
    }
    DVar5 = DVar3;
    if (-1 < (int)DVar3) goto LAB_0040fb40;
LAB_0040fbf6:
    pAVar4 = (PACL)0x0;
    puVar1 = TokenInformation_00;
    local_18 = TokenInformation_00;
    local_8 = TokenInformation;
    if ((int)DVar3 < 0) {
LAB_0040fd5e:
      TokenInformation_00 = puVar1;
      if (pAVar4 != (PACL)0x0) goto LAB_0040fd62;
    }
    else {
      DVar5 = GetLengthSid((PSID)*TokenInformation_00);
      local_1c = DVar5 + 0x10;
      local_14 = (PACL)FUN_0041eea7(local_1c);
      if (local_14 == (PACL)0x0) {
        DVar3 = 0x8007000e;
      }
      else {
        BVar2 = InitializeSecurityDescriptor(local_30,1);
        puVar1 = local_18;
        TokenInformation = local_8;
        if ((((BVar2 == 0) ||
             (BVar2 = SetSecurityDescriptorOwner(local_30,(PSID)*local_18,0),
             TokenInformation = local_8, BVar2 == 0)) ||
            (BVar2 = SetSecurityDescriptorGroup(local_30,(PSID)*local_8,0), pAVar4 = local_14,
            BVar2 == 0)) ||
           (((BVar2 = InitializeAcl(local_14,local_1c,2), TokenInformation = local_8, BVar2 == 0 ||
             (BVar2 = AddAccessAllowedAce(pAVar4,2,0x1f0081,(PSID)*puVar1),
             TokenInformation = local_8, BVar2 == 0)) ||
            (BVar2 = SetSecurityDescriptorDacl(local_30,1,pAVar4,0), TokenInformation = local_8,
            TokenInformation_00 = puVar1, BVar2 == 0)))) {
          DVar3 = GetLastError();
          if (0 < (int)DVar3) {
            DVar3 = DVar3 & 0xffff | 0x80070000;
          }
          pAVar4 = local_14;
          TokenInformation_00 = local_18;
          if ((int)DVar3 < 0) goto LAB_0040fd5e;
        }
        BVar2 = MakeSelfRelativeSD(local_30,(PSECURITY_DESCRIPTOR)0x0,&DAT_0046c788);
        if (BVar2 == 0) {
          DVar5 = GetLastError();
          if (DVar5 == 0x7a) {
            DAT_0046c49c = (PSECURITY_DESCRIPTOR)FUN_0041eea7(DAT_0046c788);
            if (DAT_0046c49c == (PSECURITY_DESCRIPTOR)0x0) {
              DVar3 = 0x8007000e;
              pAVar4 = local_14;
              TokenInformation = local_8;
            }
            else {
              BVar2 = MakeSelfRelativeSD(local_30,DAT_0046c49c,&DAT_0046c788);
              pAVar4 = local_14;
              TokenInformation = local_8;
              if (BVar2 == 0) goto LAB_0040fd30;
            }
          }
          else {
LAB_0040fd30:
            DVar3 = GetLastError();
            pAVar4 = local_14;
            TokenInformation = local_8;
            if (0 < (int)DVar3) {
              DVar3 = DVar3 & 0xffff | 0x80070000;
            }
          }
        }
        else {
          DVar3 = 0x80004005;
          pAVar4 = local_14;
          TokenInformation = local_8;
        }
LAB_0040fd62:
        FUN_0041ee80(pAVar4);
      }
    }
    if (TokenInformation != (undefined4 *)0x0) {
      FUN_0041ee80(TokenInformation);
    }
  }
  if (TokenInformation_00 != (undefined4 *)0x0) {
    FUN_0041ee80(TokenInformation_00);
  }
LAB_0040fd88:
  FUN_0041d8d0((int *)&local_10);
  return DVar3;
}



/* Function: FUN_0040fd9d */

undefined4 __fastcall FUN_0040fd9d(ushort *param_1)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  
  uVar1 = *param_1;
  if (uVar1 < 0x13) {
    if (uVar1 == 0x12) {
      uVar2 = (uint)param_1[4];
    }
    else {
      if (uVar1 != 2) {
        if (uVar1 == 3) goto LAB_0040fdba;
        if (uVar1 != 0xb) {
          if (uVar1 == 0x10) {
            uVar2 = (uint)(char)param_1[4];
          }
          else {
            if (uVar1 != 0x11) {
              return 0;
            }
            uVar2 = (uint)(byte)param_1[4];
          }
          goto LAB_0040fdbd;
        }
      }
      uVar2 = (uint)(short)param_1[4];
    }
  }
  else {
    if (uVar1 != 0x13) {
      if (uVar1 == 0x15) {
        uVar2 = *(uint *)(param_1 + 4);
        iVar3 = *(int *)(param_1 + 6);
        goto LAB_0040fdbe;
      }
      if ((uVar1 != 0x16) && (uVar1 != 0x17)) {
        return 0;
      }
    }
LAB_0040fdba:
    uVar2 = *(uint *)(param_1 + 4);
  }
LAB_0040fdbd:
  iVar3 = (int)uVar2 >> 0x1f;
LAB_0040fdbe:
  *param_1 = 0x14;
  *(uint *)(param_1 + 4) = uVar2;
  *(int *)(param_1 + 6) = iVar3;
  return 0;
}



/* Function: FUN_0040fde1 */

undefined4 * __thiscall FUN_0040fde1(void *this,undefined4 *param_1)

{
  FUN_0041bdbc((uint)this);
  FUN_0041c10d((void *)((int)this + 0xc),param_1,(uint)*(ushort *)((int)this + 0x1a2),
               (uint)*(ushort *)((int)this + 0x1a4));
  return param_1;
}



/* Function: FUN_0040fe20 */

void __thiscall FUN_0040fe20(void *this,uint param_1)

{
  FUN_00444638(this,param_1,0x400,0x100000,(void *)((int)this + 0x10));
  return;
}



/* Function: FUN_0040fe50 */

void __thiscall FUN_0040fe50(void *this,uint param_1)

{
  FUN_00444638(this,param_1,0x40,0x7fff,(void *)((int)this + 0x10));
  return;
}



/* Function: FUN_0040fe80 */

void FUN_0040fe80(int *param_1,int *param_2,int *param_3)

{
  FUN_0040fe9d(param_1,param_2,param_3);
  return;
}



/* Function: FUN_0040fe9d */

int __fastcall FUN_0040fe9d(int *param_1,int *param_2,int *param_3)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 uStack_8;
  
  uStack_8 = 0xffffffff;
  puStack_c = &LAB_00454fbe;
  local_10 = ExceptionList;
  uVar2 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_3 = 0;
  iVar3 = FUN_00410f1a(param_2,(int *)&DAT_00406be0);
  if (iVar3 == 0) {
    iVar3 = FUN_0040ff35(param_1,param_2,param_3);
    if (-1 < iVar3) {
      pcVar1 = *(code **)(*(int *)*param_3 + 4);
      (*(code *)PTR_guard_check_icall_0046e528)((int *)*param_3);
      (*pcVar1)();
    }
  }
  else {
    *param_3 = (int)param_1;
    pcVar1 = *(code **)(*param_1 + 4);
    (*(code *)PTR_guard_check_icall_0046e528)(param_1,uVar2);
    (*pcVar1)();
    iVar3 = 0;
  }
  ExceptionList = local_10;
  return iVar3;
}



/* Function: FUN_0040ff35 */

undefined4 __thiscall FUN_0040ff35(void *this,int *param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  int *extraout_ECX;
  
  iVar1 = FUN_00410f1a(param_1,(int *)&DAT_00406ab0);
  if (iVar1 == 0) {
    uVar2 = FUN_0046164b((void *)((int)this + 4),extraout_ECX,param_2);
  }
  else {
    *param_2 = (int)this;
    uVar2 = 0;
  }
  return uVar2;
}



/* Function: FUN_0040ff6f */

/* WARNING: Function: __EH_prolog3 replaced with injection: EH_prolog3 */
/* WARNING: Function: __EH_epilog3 replaced with injection: EH_epilog3 */

void __fastcall FUN_0040ff6f(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined1 local_11 [9];
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 8;
  local_8 = 0x40ff7b;
  FUN_0041cac8(param_1 + 1);
  local_8 = 0;
  if ((*(char *)(param_1 + 0x15) != '\0') && (param_1[0x14] != -1)) {
    SetEvent((HANDLE)param_1[0x14]);
    local_11[0] = 0;
    FUN_00445c84(local_11);
  }
  if (param_1[0x12] != 5) {
    param_1[0x12] = 5;
    puVar3 = (undefined4 *)0x0;
    puVar1 = (undefined4 *)0x0;
    do {
      if (puVar1 == (undefined4 *)0x0) {
        if (puVar3 != (undefined4 *)0x0) goto LAB_0040ffe7;
        puVar2 = (undefined4 *)*param_1;
      }
      else {
        puVar2 = (undefined4 *)*puVar1;
        puVar3 = puVar1;
      }
      if (puVar2 == (undefined4 *)0x0) goto LAB_0040ffe7;
      FUN_00410049(puVar2[1]);
      puVar1 = puVar2;
    } while( true );
  }
  local_8 = 1;
LAB_0040fff1:
  FUN_0041ca59(param_1 + 1);
  return;
LAB_0040ffe7:
  local_8 = 2;
  goto LAB_0040fff1;
}



/* Function: FUN_00410006 */

void __fastcall FUN_00410006(undefined4 *param_1)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 uStack_8;
  
  uStack_8 = 0xffffffff;
  puStack_c = &LAB_00454f48;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_0041ca59((int *)*param_1);
  ExceptionList = local_10;
  return;
}



/* Function: FUN_00410049 */

void __fastcall FUN_00410049(int param_1)

{
  code *pcVar1;
  char cVar2;
  BOOL BVar3;
  undefined4 *extraout_ECX;
  int unaff_retaddr;
  
  if (*(int *)(param_1 + 8) != 5) {
    *(undefined4 *)(param_1 + 8) = 5;
    cVar2 = FUN_00439ccf((int *)(param_1 + 0x1c));
    if (cVar2 != '\0') {
      BVar3 = SetEvent((HANDLE)*extraout_ECX);
      if (BVar3 == 0) {
        FUN_0045fdf4(unaff_retaddr,0x1cf,0x408300);
        pcVar1 = (code *)swi(3);
        (*pcVar1)();
        return;
      }
    }
  }
  return;
}



/* Function: FUN_0041008e */

/* WARNING: Function: __EH_prolog3 replaced with injection: EH_prolog3 */
/* WARNING: Function: __EH_epilog3 replaced with injection: EH_epilog3 */

void __fastcall FUN_0041008e(int param_1)

{
  code *pcVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  uint *puVar6;
  undefined4 unaff_retaddr;
  char *pcVar7;
  void *in_stack_ffffffdc;
  
  puVar6 = (uint *)0x0;
  *(undefined4 *)(param_1 + 0x10) = 0;
  uVar2 = FUN_00410123(*(uint *)(param_1 + 0x14));
  *(uint *)(param_1 + 0xc) = uVar2;
  *(uint *)(param_1 + 0x18) = *(int *)(param_1 + 0x20) * uVar2;
  if (uVar2 == 0) {
    pcVar7 = (char *)0x80070057;
    iVar5 = 0xe2;
  }
  else {
    uVar4 = -(uint)((int)((ulonglong)uVar2 * 0x10 >> 0x20) != 0) | (uint)((ulonglong)uVar2 * 0x10);
    puVar3 = (uint *)FUN_0041eea7(-(uint)(0xfffffffb < uVar4) | uVar4 + 4);
    if (puVar3 != (uint *)0x0) {
      puVar6 = puVar3 + 1;
      *puVar3 = uVar2;
      _eh_vector_constructor_iterator_(puVar6,0x10,uVar2,FUN_0041cce0,thunk_FUN_0045eb11);
    }
    *(uint **)(param_1 + 0x24) = puVar6;
    if (puVar6 != (uint *)0x0) {
      return;
    }
    in_stack_ffffffdc = (void *)0x8007000e;
    pcVar7 = "onecoreuap\\base\\appmodel\\Search\\common\\include\\TPKPHMAP.hxx";
    iVar5 = 0xe5;
  }
  FUN_0045fe0e(unaff_retaddr,iVar5,(int)pcVar7,in_stack_ffffffdc);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_00410123 */

uint __fastcall FUN_00410123(uint param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar2 = 0;
  while( true ) {
    uVar1 = *(uint *)((int)&DAT_0040aa00 + uVar2);
    if (uVar1 == 0) {
      return param_1;
    }
    if (param_1 <= uVar1) break;
    uVar2 = uVar2 + 4;
    if (0x67 < uVar2) {
      return param_1;
    }
  }
  return uVar1;
}



/* Function: FUN_00410147 */

void __fastcall FUN_00410147(undefined4 *param_1)

{
  code *pcVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  undefined1 local_60 [92];
  
  if (param_1[3] == 0) {
    if (DAT_0046c2c4 == 0) {
      *param_1 = 0;
    }
    else {
      pDVar2 = FUN_00410194('\x01');
      *param_1 = pDVar2;
      if (pDVar2 != (DWORD *)0x0) {
        param_1[2] = *pDVar2;
        *pDVar2 = (DWORD)param_1;
        DVar3 = GetCurrentThreadId();
        param_1[3] = DVar3;
      }
    }
    return;
  }
  memset(local_60,0,0x58);
  FUN_004603f1((int)local_60);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_00410194 */

DWORD * FUN_00410194(char param_1)

{
  DWORD *pDVar1;
  DWORD DVar2;
  int iVar3;
  DWORD DVar4;
  DWORD *pDVar5;
  DWORD DVar6;
  DWORD *pDVar7;
  
  iVar3 = DAT_0046c2c4;
  DVar4 = GetCurrentThreadId();
  pDVar1 = (DWORD *)(iVar3 + (DVar4 % 10) * 4);
  pDVar5 = (DWORD *)*pDVar1;
  while( true ) {
    if (pDVar5 == (DWORD *)0x0) {
      if ((param_1 == '\0') || (pDVar5 = (DWORD *)FUN_0042fbf7(0,0xc), pDVar5 == (DWORD *)0x0)) {
        pDVar7 = (DWORD *)0x0;
      }
      else {
        pDVar5[1] = 0;
        *pDVar5 = DVar4;
        pDVar7 = pDVar5 + 2;
        *pDVar7 = 0;
        do {
          DVar2 = *(DWORD *)(iVar3 + (DVar4 % 10) * 4);
          pDVar5[1] = DVar2;
          LOCK();
          DVar6 = *pDVar1;
          if (DVar2 == DVar6) {
            *pDVar1 = (DWORD)pDVar5;
            DVar6 = DVar2;
          }
          UNLOCK();
        } while (DVar6 != DVar2);
      }
      return pDVar7;
    }
    if (*pDVar5 == DVar4) break;
    pDVar5 = (DWORD *)pDVar5[1];
  }
  return pDVar5 + 2;
}



/* Function: FUN_00410226 */

void FUN_00410226(void)

{
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_8 = 2;
  SetProcessMitigationPolicy(9,&local_8,4);
  local_c = 1;
  SetProcessMitigationPolicy(10,&local_c,4);
  local_10 = 1;
  SetProcessMitigationPolicy(0xd,&local_10,4);
  return;
}



/* Function: FUN_00410272 */

void __fastcall FUN_00410272(undefined4 *param_1)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = FUN_0041d133();
  if (5 < **(uint **)(iVar1 + 4)) {
    uVar2 = FUN_004102bd(*(uint **)(iVar1 + 4),0,0x4000);
    if ((char)uVar2 != '\0') {
      EventActivityIdControl(3,(LPGUID)(param_1 + 2));
      goto LAB_004102ad;
    }
  }
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
LAB_004102ad:
  *param_1 = 1;
  return;
}



/* Function: FUN_004102bd */

uint __thiscall FUN_004102bd(void *this,uint param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = param_1 | param_2;
  if (uVar1 == 0) {
LAB_004102e4:
    uVar1 = CONCAT31((int3)(uVar1 >> 8),1);
  }
  else {
    uVar1 = *(uint *)((int)this + 0xc) & param_2;
    if ((param_1 & *(uint *)((int)this + 8)) != 0 || uVar1 != 0) {
      uVar1 = *(uint *)((int)this + 0x10) & param_1;
      if ((uVar1 == *(uint *)((int)this + 0x10)) &&
         ((*(uint *)((int)this + 0x14) & param_2) == *(uint *)((int)this + 0x14)))
      goto LAB_004102e4;
    }
    uVar1 = uVar1 & 0xffffff00;
  }
  return uVar1;
}



/* Function: FUN_004102ee */

undefined4 * __thiscall FUN_004102ee(void *this,undefined4 *param_1)

{
  int iVar1;
  void **ppvVar2;
  PSRWLOCK SRWLock;
  void *local_c;
  void *local_8;
  
  iVar1 = *(int *)((int)this + 0xac);
  local_c = this;
  local_8 = this;
  if (iVar1 == 0) {
    SRWLock = (PSRWLOCK)0x0;
    ppvVar2 = &local_8;
  }
  else {
    SRWLock = (PSRWLOCK)(iVar1 + 0xa4);
    AcquireSRWLockExclusive(SRWLock);
    ppvVar2 = &local_c;
  }
  *ppvVar2 = (void *)0x0;
  *param_1 = SRWLock;
  if (iVar1 == 0) {
    FUN_0042564f((int *)&local_8);
  }
  else {
    FUN_0042564f((int *)&local_c);
  }
  return param_1;
}



/* Function: FUN_00410352 */

void __fastcall FUN_00410352(void *param_1)

{
  int iVar1;
  bool bVar2;
  uint *this;
  uint uVar3;
  LPCGUID pGVar4;
  undefined4 *extraout_ECX;
  DWORD local_58;
  _EVENT_DATA_DESCRIPTOR local_54 [2];
  undefined *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  DWORD *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 uStack_8;
  
  uStack_8 = 0xffffffff;
  puStack_c = &LAB_0045506c;
  local_10 = ExceptionList;
  local_14 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_004102ee(param_1,&local_58);
  FUN_00410272(*(undefined4 **)((int)param_1 + 0xa8));
  FUN_0042564f((int *)&local_58);
  this = (uint *)FUN_0042fce2();
  if (5 < *this) {
    uVar3 = FUN_004102bd(this,0,0x4000);
    if ((char)uVar3 != '\0') {
      local_58 = GetCurrentThreadId();
      iVar1 = *(int *)((int)param_1 + 0xa8);
      if ((*(char *)(iVar1 + 4) == '\0') ||
         ((((pGVar4 = (LPCGUID)(iVar1 + 0x18), pGVar4->Data1 == 0 && (*(int *)(iVar1 + 0x1c) == 0))
           && (*(int *)(iVar1 + 0x20) == 0)) && (*(int *)(iVar1 + 0x24) == 0)))) {
        pGVar4 = (LPCGUID)0x0;
      }
      local_24 = &local_58;
      local_20 = 0;
      local_18 = 0;
      local_30 = 0;
      local_28 = 0;
      local_1c = 4;
      local_34 = &DAT_004061d8;
      local_2c = 8;
      FUN_00461120((int)this,&DAT_0040bd40,(LPCGUID)(iVar1 + 8),pGVar4,4,local_54);
    }
  }
  bVar2 = FUN_0042ebba((int)param_1 + 0xb0);
  if (!bVar2) {
    FUN_00410147(extraout_ECX);
  }
  ExceptionList = local_10;
  FUN_0041e590(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_0041045e */

void __fastcall FUN_0041045e(int *param_1)

{
  int *piVar1;
  code *pcVar2;
  
  piVar1 = (int *)*param_1;
  if (piVar1 != (int *)0x0) {
    pcVar2 = *(code **)(*piVar1 + 8);
    (*(code *)PTR_guard_check_icall_0046e528)(piVar1);
    (*pcVar2)();
  }
  return;
}



/* Function: FUN_00410480 */

int FUN_00410480(int *param_1)

{
  code *pcVar1;
  int iVar2;
  
  iVar2 = thunk_FUN_00432ca0(param_1 + 1);
  if (iVar2 == 0) {
    pcVar1 = *(code **)(*DAT_0046c368 + 4);
    (*(code *)PTR_guard_check_icall_0046e528)();
    (*pcVar1)();
    if (param_1 != (int *)0x0) {
      pcVar1 = *(code **)(*param_1 + 0x10);
      (*(code *)PTR_guard_check_icall_0046e528)(1);
      (*pcVar1)();
    }
    pcVar1 = *(code **)(*DAT_0046c368 + 8);
    (*(code *)PTR_guard_check_icall_0046e528)();
    (*pcVar1)();
  }
  return iVar2;
}



/* Function: thunk_FUN_004254f4 */

int __fastcall thunk_FUN_004254f4(int param_1)

{
  int *piVar1;
  int iVar2;
  code *pcVar3;
  int *piVar4;
  int in_EAX;
  int iVar5;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  
  piVar4 = *(int **)(param_1 + 4);
  if (piVar4 == (int *)0x0) {
    return in_EAX;
  }
  LOCK();
  piVar1 = piVar4 + 1;
  iVar2 = *piVar1;
  iVar5 = *piVar1;
  *piVar1 = iVar2 + -1;
  UNLOCK();
  if (iVar2 + -1 == 0) {
    pcVar3 = *(code **)*piVar4;
    (*(code *)PTR_guard_check_icall_0046e528)();
    (*pcVar3)();
    LOCK();
    piVar1 = piVar4 + 2;
    iVar2 = *piVar1;
    iVar5 = *piVar1;
    *piVar1 = iVar2 + -1;
    UNLOCK();
    if (iVar2 + -1 == 0) {
      pcVar3 = *(code **)(*piVar4 + 4);
      (*(code *)PTR_guard_check_icall_0046e528)(unaff_ESI,unaff_EDI);
      iVar5 = (*pcVar3)();
    }
    return iVar5;
  }
  return iVar5;
}



/* Function: thunk_FUN_004401fd */

void __fastcall thunk_FUN_004401fd(int *param_1)

{
  int *piVar1;
  code *pcVar2;
  
  piVar1 = (int *)param_1[9];
  if (piVar1 != (int *)0x0) {
    pcVar2 = *(code **)(*piVar1 + 0x10);
    (*(code *)PTR_guard_check_icall_0046e528)(piVar1 != param_1);
    (*pcVar2)();
    param_1[9] = 0;
  }
  return;
}



/* Function: FUN_00410506 */

DWORD FUN_00410506(void)

{
  bool bVar1;
  PHANDLE TokenHandle;
  HANDLE ProcessHandle;
  BOOL BVar2;
  DWORD DVar3;
  PTOKEN_PRIVILEGES NewState;
  int iVar4;
  uint uVar5;
  DWORD DVar6;
  _LUID local_18;
  PTOKEN_PRIVILEGES local_10;
  HANDLE local_c;
  DWORD local_8;
  
  DVar6 = 0;
  local_c = (HANDLE)0x0;
  TokenHandle = (PHANDLE)FUN_0043a79f(&local_c);
  ProcessHandle = GetCurrentProcess();
  BVar2 = OpenProcessToken(ProcessHandle,0x28,TokenHandle);
  if (BVar2 == 0) {
LAB_00410556:
    DVar6 = GetLastError();
    if (0 < (int)DVar6) {
      DVar6 = DVar6 & 0xffff | 0x80070000;
    }
    goto LAB_0041061f;
  }
  local_8 = 0;
  BVar2 = GetTokenInformation(local_c,TokenPrivileges,(LPVOID)0x0,0,&local_8);
  if (BVar2 == 0) {
    DVar3 = GetLastError();
    if (DVar3 != 0x7a) goto LAB_00410556;
  }
  NewState = (PTOKEN_PRIVILEGES)FUN_0041eea7(local_8);
  local_10 = NewState;
  bVar1 = FUN_00425d02((int *)&local_10);
  if (bVar1) {
    BVar2 = GetTokenInformation(local_c,TokenPrivileges,NewState,local_8,&local_8);
    if (BVar2 != 0) {
      LookupPrivilegeValueW((LPCWSTR)0x0,L"SeChangeNotifyPrivilege",&local_18);
      uVar5 = 0;
      if (NewState->PrivilegeCount != 0) {
        iVar4 = 0;
        do {
          if ((*(DWORD *)((int)&NewState->Privileges[0].Luid.LowPart + iVar4) != local_18.LowPart)
             || (*(int *)((int)&NewState->Privileges[0].Luid.HighPart + iVar4) != local_18.HighPart)
             ) {
            *(undefined4 *)((int)&NewState->Privileges[0].Attributes + iVar4) = 4;
          }
          uVar5 = uVar5 + 1;
          iVar4 = iVar4 + 0xc;
        } while (uVar5 < NewState->PrivilegeCount);
      }
      BVar2 = AdjustTokenPrivileges(local_c,0,NewState,local_8,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0);
      if (BVar2 != 0) goto LAB_00410615;
    }
    DVar6 = GetLastError();
    if (0 < (int)DVar6) {
      DVar6 = DVar6 & 0xffff | 0x80070000;
    }
  }
  else {
    DVar6 = 0x8007000e;
  }
LAB_00410615:
  if (NewState != (PTOKEN_PRIVILEGES)0x0) {
    FUN_004203a7(NewState);
  }
LAB_0041061f:
  FUN_0041d8d0((int *)&local_c);
  return DVar6;
}



/* Function: FUN_00410633 */

undefined4 FUN_00410633(void)

{
  undefined4 uVar1;
  uint uVar2;
  BOOL BVar3;
  DWORD DVar4;
  undefined4 uVar5;
  undefined1 local_24 [4];
  int local_20;
  undefined4 local_c;
  undefined4 local_8;
  
  uVar5 = 0;
  local_c = 1;
  local_8 = 0;
  uVar1 = NtQueryInformationProcess(0xffffffff,0,local_24,0x18,0);
  uVar2 = RtlNtStatusToDosError(uVar1);
  if (0 < (int)uVar2) {
    uVar2 = uVar2 & 0xffff | 0x80070000;
  }
  if ((uVar2 == 0) || (-1 < (int)uVar2)) {
    BVar3 = ReadProcessMemory((HANDLE)0xffffffff,(LPCVOID)(local_20 + 0x464),&local_8,4,
                              (SIZE_T *)0x0);
    if (BVar3 == 0) {
      DVar4 = GetLastError();
      if (0 < (int)DVar4) {
        DVar4 = DVar4 & 0xffff | 0x80070000;
      }
    }
    else {
      DVar4 = 0;
    }
    if ((DVar4 == 0) || (-1 < (int)DVar4)) {
      BVar3 = WriteProcessMemory((HANDLE)0xffffffff,(LPVOID)(local_20 + 0x464),&local_c,4,
                                 (SIZE_T *)0x0);
      if (BVar3 == 0) {
        DVar4 = GetLastError();
        if (0 < (int)DVar4) {
          DVar4 = DVar4 & 0xffff | 0x80070000;
        }
      }
      else {
        DVar4 = 0;
      }
      if (-1 < (int)DVar4) {
        uVar5 = local_8;
      }
    }
  }
  return uVar5;
}



/* Function: FUN_004106db */

/* WARNING: Function: __EH_prolog3_catch replaced with injection: EH_prolog3 */
/* WARNING: Function: __EH_epilog3 replaced with injection: EH_epilog3 */

DWORD __fastcall FUN_004106db(int *param_1)

{
  void *pvVar1;
  BOOL BVar2;
  DWORD DVar3;
  int iVar4;
  undefined4 uVar5;
  
  uVar5 = 0;
  iVar4 = *param_1;
  FUN_0041ee80(iVar4);
  *param_1 = 0;
  o_free(param_1[1],iVar4,uVar5);
  param_1[1] = 0;
  o_free(param_1[2]);
  param_1[2] = 0;
  o_free(param_1[3]);
  param_1[3] = 0;
  o_free(param_1[4]);
  param_1[4] = 0;
  pvVar1 = operator_new(0x14);
  *param_1 = (int)pvVar1;
  if (*param_1 == 0) {
    DVar3 = 0x8007000e;
  }
  else {
    BVar2 = InitializeSecurityDescriptor((PSECURITY_DESCRIPTOR)*param_1,1);
    if (BVar2 == 0) {
      DVar3 = FUN_00410842();
      FUN_0041ee80(*param_1);
      *param_1 = 0;
    }
    else {
      DVar3 = 0;
    }
  }
  return DVar3;
}



/* Function: FUN_00410763 */

DWORD __fastcall FUN_00410763(int *param_1)

{
  DWORD DVar1;
  int *local_c;
  int *local_8;
  
  local_c = param_1;
  local_8 = param_1;
  DVar1 = FUN_004106db(param_1);
  if (-1 < (int)DVar1) {
    local_8 = (int *)0x0;
    local_c = (int *)0x0;
    DVar1 = FUN_004107f4((int *)&local_8,(int *)&local_c);
    if ((short)DVar1 == 0x3f0) {
      DVar1 = FUN_0041085b((int *)&local_8,(int *)&local_c);
    }
    if (-1 < (int)DVar1) {
      DVar1 = FUN_004108ba(param_1,local_8);
      if (-1 < (int)DVar1) {
        DVar1 = FUN_00410926(param_1,local_c);
      }
      o_free(local_8);
      o_free(local_c);
      if ((int)DVar1 < 0) {
        FUN_004106db(param_1);
      }
    }
  }
  return DVar1;
}



/* Function: FUN_004107f4 */

DWORD __fastcall FUN_004107f4(int *param_1,int *param_2)

{
  HANDLE ThreadHandle;
  DWORD DVar1;
  BOOL BVar2;
  HANDLE *TokenHandle;
  HANDLE local_8;
  
  local_8 = (HANDLE)0x0;
  if (param_1 != (int *)0x0) {
    *param_1 = 0;
  }
  if (param_2 != (int *)0x0) {
    *param_2 = 0;
  }
  TokenHandle = &local_8;
  BVar2 = 0;
  DVar1 = 8;
  ThreadHandle = GetCurrentThread();
  BVar2 = OpenThreadToken(ThreadHandle,DVar1,BVar2,TokenHandle);
  if (BVar2 == 0) {
    DVar1 = FUN_00410842();
  }
  else {
    DVar1 = FUN_00410992(local_8,param_1,param_2);
    CloseHandle(local_8);
  }
  return DVar1;
}



/* Function: FUN_00410842 */

DWORD FUN_00410842(void)

{
  DWORD DVar1;
  
  DVar1 = GetLastError();
  if (0 < (int)DVar1) {
    DVar1 = DVar1 & 0xffff | 0x80070000;
  }
  return DVar1;
}



/* Function: FUN_0041085b */

DWORD __fastcall FUN_0041085b(int *param_1,int *param_2)

{
  HANDLE ProcessHandle;
  BOOL BVar1;
  DWORD DVar2;
  HANDLE *TokenHandle;
  HANDLE local_8;
  
  local_8 = (HANDLE)0x0;
  if (param_1 != (int *)0x0) {
    *param_1 = 0;
  }
  if (param_2 != (int *)0x0) {
    *param_2 = 0;
  }
  TokenHandle = &local_8;
  DVar2 = 8;
  ProcessHandle = GetCurrentProcess();
  BVar1 = OpenProcessToken(ProcessHandle,DVar2,TokenHandle);
  if (BVar1 == 0) {
    DVar2 = FUN_00410842();
  }
  else {
    DVar2 = FUN_00410992(local_8,param_1,param_2);
    CloseHandle(local_8);
  }
  return DVar2;
}



/* Function: FUN_004108ba */

DWORD __thiscall FUN_004108ba(void *this,PSID param_1)

{
  int *piVar1;
  BOOL BVar2;
  DWORD DVar3;
  
                    /* WARNING: Load size is inaccurate */
  BVar2 = SetSecurityDescriptorOwner(*this,(PSID)0x0,0);
  if (BVar2 == 0) {
    DVar3 = FUN_00410842();
  }
  else {
    piVar1 = (int *)((int)this + 4);
    o_free(*piVar1);
    *piVar1 = 0;
    if (param_1 == (PSID)0x0) {
      DVar3 = 0;
    }
    else {
      DVar3 = FUN_00410ab6(piVar1,param_1);
                    /* WARNING: Load size is inaccurate */
      if ((-1 < (int)DVar3) &&
         (BVar2 = SetSecurityDescriptorOwner(*this,(PSID)*piVar1,0), BVar2 == 0)) {
        DVar3 = FUN_00410842();
        o_free(*piVar1);
        *piVar1 = 0;
      }
    }
  }
  return DVar3;
}



/* Function: FUN_00410926 */

DWORD __thiscall FUN_00410926(void *this,PSID param_1)

{
  int *piVar1;
  BOOL BVar2;
  DWORD DVar3;
  
                    /* WARNING: Load size is inaccurate */
  BVar2 = SetSecurityDescriptorGroup(*this,(PSID)0x0,0);
  if (BVar2 == 0) {
    DVar3 = FUN_00410842();
  }
  else {
    piVar1 = (int *)((int)this + 8);
    o_free(*piVar1);
    *piVar1 = 0;
    if (param_1 == (PSID)0x0) {
      DVar3 = 0;
    }
    else {
      DVar3 = FUN_00410ab6(piVar1,param_1);
                    /* WARNING: Load size is inaccurate */
      if ((-1 < (int)DVar3) &&
         (BVar2 = SetSecurityDescriptorGroup(*this,(PSID)*piVar1,0), BVar2 == 0)) {
        DVar3 = FUN_00410842();
        o_free(*piVar1);
        *piVar1 = 0;
      }
    }
  }
  return DVar3;
}



/* Function: FUN_00410992 */

DWORD __fastcall FUN_00410992(HANDLE param_1,int *param_2,int *param_3)

{
  undefined4 *puVar1;
  BOOL BVar2;
  DWORD DVar3;
  DWORD local_8;
  
  local_8 = 0;
  DVar3 = 0;
  if (param_2 != (int *)0x0) {
    *param_2 = 0;
  }
  if (param_3 != (int *)0x0) {
    *param_3 = 0;
  }
  if (param_2 == (int *)0x0) {
LAB_00410a30:
    if (param_3 == (int *)0x0) {
      return DVar3;
    }
    GetTokenInformation(param_1,TokenPrimaryGroup,(LPVOID)0x0,0,&local_8);
    DVar3 = GetLastError();
    if (DVar3 == 0x7a) {
      puVar1 = (undefined4 *)o_malloc(local_8);
      if (puVar1 == (undefined4 *)0x0) {
        DVar3 = 0x8007000e;
      }
      else {
        BVar2 = GetTokenInformation(param_1,TokenPrimaryGroup,puVar1,local_8,&local_8);
        if (BVar2 == 0) {
          DVar3 = FUN_00410842();
        }
        else {
          DVar3 = FUN_00410ab6(param_3,(PSID)*puVar1);
        }
        o_free(puVar1);
      }
    }
    else {
      DVar3 = FUN_0045bf64(DVar3);
    }
    if (-1 < (int)DVar3) {
      return DVar3;
    }
    if (param_2 == (int *)0x0) goto LAB_004598f1;
  }
  else {
    GetTokenInformation(param_1,TokenUser,(LPVOID)0x0,0,&local_8);
    DVar3 = GetLastError();
    if (DVar3 == 0x7a) {
      puVar1 = (undefined4 *)o_malloc(local_8);
      if (puVar1 == (undefined4 *)0x0) {
        DVar3 = 0x8007000e;
      }
      else {
        BVar2 = GetTokenInformation(param_1,TokenUser,puVar1,local_8,&local_8);
        if (BVar2 == 0) {
          DVar3 = FUN_00410842();
        }
        else {
          DVar3 = FUN_00410ab6(param_2,(PSID)*puVar1);
        }
        o_free(puVar1);
      }
    }
    else {
      DVar3 = FUN_0045bf64(DVar3);
    }
    if (-1 < (int)DVar3) goto LAB_00410a30;
  }
  o_free(*param_2);
  *param_2 = 0;
  if (param_3 == (int *)0x0) {
    return DVar3;
  }
LAB_004598f1:
  o_free(*param_3);
  *param_3 = 0;
  return DVar3;
}



/* Function: FUN_00410ab6 */

DWORD __fastcall FUN_00410ab6(int *param_1,PSID param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  PSID pDestinationSid;
  
  if (param_1 == (int *)0x0) {
    DVar2 = 0x80004003;
  }
  else {
    if (*param_1 == 0) {
      *param_1 = 0;
      BVar1 = IsValidSid(param_2);
      if (BVar1 != 0) {
        DVar2 = GetLengthSid(param_2);
        pDestinationSid = (PSID)o_malloc(DVar2);
        *param_1 = (int)pDestinationSid;
        if (pDestinationSid == (PSID)0x0) {
          return 0x8007000e;
        }
        BVar1 = CopySid(DVar2,pDestinationSid,param_2);
        if (BVar1 != 0) {
          return 0;
        }
        DVar2 = FUN_00410842();
        o_free(*param_1);
        *param_1 = 0;
        return DVar2;
      }
    }
    DVar2 = 0x80070057;
  }
  return DVar2;
}



/* Function: FUN_00410b27 */

/* WARNING: Function: __EH_prolog3 replaced with injection: EH_prolog3 */
/* WARNING: Function: __EH_epilog3 replaced with injection: EH_epilog3 */

char * FUN_00410b27(void)

{
  code *pcVar1;
  char *pcVar2;
  int *piVar3;
  int unaff_retaddr;
  int iVar4;
  char *pcVar5;
  char *pcVar6;
  int *local_14 [3];
  int local_8;
  undefined4 uStack_4;
  
  uStack_4 = 4;
  local_8 = 0;
  if (DAT_0046ce6c == 0) {
    pcVar2 = (char *)FUN_00410c69(local_14);
    if (-1 < (int)pcVar2) {
      FUN_00410ec8(local_14,local_14[0]);
      pcVar1 = *(code **)*local_14[0];
      if (pcVar1 == FUN_00410d20) {
        pcVar2 = (char *)FUN_00410d20((int)local_14[0],(int *)&LAB_00406bb0,&DAT_0046ce6c);
      }
      else {
        (*(code *)PTR_guard_check_icall_0046e528)();
        pcVar2 = (char *)(*pcVar1)();
      }
      if ((int)pcVar2 < 0) {
        FUN_0045eec7(unaff_retaddr,0x46,0x406b30,(uint)pcVar2);
        FUN_0041045e((int *)local_14);
        goto LAB_00410c51;
      }
      FUN_0041045e((int *)local_14);
      goto LAB_00410bbd;
    }
    pcVar5 = "onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrutil.cxx";
    iVar4 = 0x43;
    pcVar6 = pcVar2;
  }
  else {
LAB_00410bbd:
    if (DAT_0046c548 == (int *)0x0) {
      pcVar5 = (char *)0x44;
      piVar3 = (int *)FUN_0041ea6a(0x44);
      local_8._0_1_ = 1;
      local_14[0] = piVar3;
      if (piVar3 == (int *)0x0) {
        DAT_0046c548 = (int *)0x0;
      }
      else {
        pcVar5 = (char *)0x11;
        FUN_00410f45(piVar3,FUN_0041b100,FUN_0041b1a0,0x11,0,3);
        FUN_00424910((LPCRITICAL_SECTION)(piVar3 + 10));
        DAT_0046c548 = piVar3;
      }
      local_8 = (uint)local_8._1_3_ << 8;
      if (DAT_0046c548 == (int *)0x0) {
        pcVar2 = (char *)0x8007000e;
        iVar4 = 0x4c;
        pcVar6 = "onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrutil.cxx";
        goto LAB_00410c44;
      }
    }
    piVar3 = (int *)0x0;
    _Copy_construct_from<>(&stack0xffffffd4,(undefined4 *)&stack0x00000004);
    pcVar2 = (char *)FUN_00410da0(piVar3);
    if (-1 < (int)pcVar2) {
      pcVar2 = (char *)0x0;
      goto LAB_00410c51;
    }
    pcVar5 = "onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrutil.cxx";
    iVar4 = 0x4f;
    pcVar6 = pcVar2;
  }
LAB_00410c44:
  FUN_0045eec7(unaff_retaddr,iVar4,(int)pcVar5,(uint)pcVar6);
LAB_00410c51:
  FUN_004254f4((int)&stack0x00000004);
  return pcVar2;
}



/* Function: FUN_00410c69 */

undefined4 __fastcall FUN_00410c69(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_004550fc;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (param_1 == (undefined4 *)0x0) {
    uVar1 = 0x80004003;
  }
  else {
    *param_1 = 0;
    local_8 = 0;
    puVar2 = (undefined4 *)operator_new(0x10);
    puVar2 = FUN_00410d42(puVar2);
    if (puVar2 != (undefined4 *)0x0) {
      uVar1 = FUN_00410ce0();
      return uVar1;
    }
    *param_1 = 0;
    uVar1 = 0x8007000e;
  }
  ExceptionList = local_10;
  return uVar1;
}



/* Function: Catch_All@00410cd1 */

undefined * Catch_All_00410cd1(void)

{
  return &DAT_00410cd7;
}



/* Function: FUN_00410ce0 */

void FUN_00410ce0(void)

{
  undefined4 in_EAX;
  int unaff_EBP;
  undefined4 *unaff_ESI;
  
  *unaff_ESI = in_EAX;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



/* Function: FUN_00410cff */

undefined4 __thiscall FUN_00410cff(void *this,undefined4 *param_1)

{
  undefined4 extraout_ECX;
  
  *(undefined4 *)this = 0;
  *(undefined4 *)((int)this + 4) = 0;
  _Copy_construct_from<>(this,param_1);
  return extraout_ECX;
}



/* Function: FUN_00410d20 */

void FUN_00410d20(int param_1,int *param_2,undefined4 *param_3)

{
  FUN_00410e1c(param_1,0x401cac,param_2,param_3);
  return;
}



/* Function: FUN_00410d42 */

undefined4 * __fastcall FUN_00410d42(undefined4 *param_1)

{
  code *pcVar1;
  int *piVar2;
  
  piVar2 = DAT_0046c368;
  param_1[1] = 0;
  param_1[3] = 0;
  *param_1 = &PTR_FUN_00401000;
  pcVar1 = *(code **)(*piVar2 + 4);
  if (pcVar1 == FUN_00410d90) {
    FUN_00410d90((int)piVar2);
  }
  else {
    (*(code *)PTR_guard_check_icall_0046e528)();
    (*pcVar1)();
  }
  return param_1;
}



/* Function: FUN_00410d90 */

int __fastcall FUN_00410d90(int param_1)

{
  int *piVar1;
  int iVar2;
  
  LOCK();
  piVar1 = (int *)(param_1 + 8);
  iVar2 = *piVar1;
  *piVar1 = *piVar1 + 1;
  UNLOCK();
  return iVar2 + 1;
}



/* Function: FUN_00410da0 */

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */

void FUN_00410da0(int *param_1)

{
  code *pcVar1;
  uint uVar2;
  undefined4 extraout_ECX;
  int unaff_retaddr;
  undefined4 local_40;
  int local_3c [13];
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x30;
  local_8 = 0;
  pcVar1 = *(code **)(*param_1 + 4);
  local_40 = DAT_0046c548;
  FUN_00440107(local_3c,&local_40);
  local_8 = CONCAT31(local_8._1_3_,1);
  (*(code *)PTR_guard_check_icall_0046e528)(extraout_ECX);
  uVar2 = (*pcVar1)();
  FUN_004401fd(local_3c);
  if ((int)uVar2 < 0) {
    FUN_0045eec7(unaff_retaddr,0x130,0x406c80,uVar2);
  }
  thunk_FUN_004254f4((int)&param_1);
  FUN_00453ee6();
  return;
}



/* Function: FUN_00410e1c */

int __fastcall FUN_00410e1c(int param_1,int param_2,int *param_3,undefined4 *param_4)

{
  code *pcVar1;
  bool bVar2;
  int iVar3;
  int *piVar4;
  
  if ((param_1 == 0) || (param_2 == 0)) {
    iVar3 = -0x7ff8ffa9;
  }
  else if (param_4 == (undefined4 *)0x0) {
    iVar3 = -0x7fffbffd;
  }
  else {
    *param_4 = 0;
    if ((((*param_3 == 0) && (param_3[1] == 0)) && (param_3[2] == 0xc0)) &&
       (param_3[3] == 0x46000000)) {
      piVar4 = (int *)(*(int *)(param_2 + 4) + param_1);
      pcVar1 = *(code **)(*piVar4 + 4);
      (*(code *)PTR_guard_check_icall_0046e528)(piVar4);
      (*pcVar1)();
      *param_4 = piVar4;
LAB_00410ea2:
      iVar3 = 0;
    }
    else {
      piVar4 = (int *)(param_2 + 8);
      iVar3 = *piVar4;
      while (iVar3 != 0) {
        if ((int *)piVar4[-2] == (int *)0x0) {
          bVar2 = true;
LAB_00410e76:
          pcVar1 = (code *)*piVar4;
          if (pcVar1 == (code *)0x1) {
            piVar4 = (int *)(piVar4[-1] + param_1);
            pcVar1 = *(code **)(*piVar4 + 4);
            if (pcVar1 == FUN_00410f00) {
              FUN_00410f00((int)piVar4);
            }
            else {
              (*(code *)PTR_guard_check_icall_0046e528)();
              (*pcVar1)();
            }
            *param_4 = piVar4;
            goto LAB_00410ea2;
          }
          (*(code *)PTR_guard_check_icall_0046e528)(param_1,param_3,param_4,piVar4[-1]);
          iVar3 = (*pcVar1)();
          if (iVar3 == 0) {
            return 0;
          }
          if ((!bVar2) && (iVar3 < 0)) {
            return iVar3;
          }
        }
        else {
          bVar2 = false;
          iVar3 = FUN_00410f1a((int *)piVar4[-2],param_3);
          if (iVar3 != 0) goto LAB_00410e76;
        }
        piVar4 = piVar4 + 3;
        iVar3 = *piVar4;
      }
      iVar3 = -0x7fffbffe;
    }
  }
  return iVar3;
}



/* Function: FUN_00410ec8 */

undefined4 * __thiscall FUN_00410ec8(void *this,int *param_1)

{
  code *pcVar1;
  
  *(int **)this = param_1;
  if (param_1 != (int *)0x0) {
    pcVar1 = *(code **)(*param_1 + 4);
    if (pcVar1 == FUN_00410f00) {
      FUN_00410f00((int)param_1);
    }
    else {
      (*(code *)PTR_guard_check_icall_0046e528)();
      (*pcVar1)();
    }
  }
  return (undefined4 *)this;
}



/* Function: FUN_00410f00 */

void FUN_00410f00(int param_1)

{
  FUN_00432cca((int *)(param_1 + 4));
  return;
}



/* Function: FUN_00410f1a */

undefined4 __fastcall FUN_00410f1a(int *param_1,int *param_2)

{
  if ((((*param_1 == *param_2) && (param_1[1] == param_2[1])) && (param_1[2] == param_2[2])) &&
     (param_1[3] == param_2[3])) {
    return 1;
  }
  return 0;
}



/* Function: FUN_00410f45 */

undefined4 * __thiscall
FUN_00410f45(void *this,undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5)

{
  *(undefined4 *)((int)this + 4) = param_1;
  *(undefined4 *)((int)this + 8) = param_2;
  *(undefined4 *)((int)this + 0x14) = param_3;
  *(undefined4 *)((int)this + 0x1c) = param_5;
  *(undefined ***)this = &PTR_FUN_00401014;
  *(undefined4 *)((int)this + 0x20) = param_4;
  FUN_0041008e((int)this);
  return (undefined4 *)this;
}



/* Function: FUN_00410f83 */

uint * __fastcall FUN_00410f83(uint *param_1)

{
  HANDLE hProcess;
  bool bVar1;
  DWORD dwPriorityClass;
  
  if (DAT_0046bda8 != 0) {
    DAT_0046bdac = FUN_00410fd7((int)param_1);
    DAT_0046bda8 = 0;
  }
  bVar1 = DAT_0046bdac != 0;
  if (bVar1) {
    dwPriorityClass = 0x100000;
    hProcess = GetCurrentProcess();
    SetPriorityClass(hProcess,dwPriorityClass);
    param_1[1] = 0x200000;
  }
  *param_1 = (uint)bVar1;
  return param_1;
}



/* Function: FUN_00410fd7 */

undefined4 __fastcall FUN_00410fd7(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  int local_c [2];
  
  local_c[1] = 4;
  uVar2 = 1;
  local_c[0] = param_1;
  iVar1 = FUN_00445acf(param_1,L"SOFTWARE\\Microsoft\\Windows Search",L"UseLowPriorityConfiguration"
                       ,0x10,param_1,local_c,(LPDWORD)(local_c + 1));
  if ((iVar1 == 0) && (local_c[0] == 0)) {
    uVar2 = 0;
  }
  return uVar2;
}



/* Function: FUN_00411018 */

undefined4 * __fastcall FUN_00411018(undefined4 *param_1)

{
  *param_1 = 0;
  *(undefined1 *)(param_1 + 1) = 0;
  *(undefined1 *)(param_1 + 0xd) = 0;
  param_1[10] = 0;
  param_1[0xb] = "HostProcessExecution";
  param_1[0xc] = 0;
  param_1[0xe] = 0;
  param_1[0x25] = 0;
  param_1[0x26] = 0;
  memset(param_1 + 0xf,0,0x58);
  param_1[0x27] = 1;
  param_1[0x28] = 0;
  return param_1;
}



/* Function: FUN_0041106a */

uint __fastcall FUN_0041106a(LPVOID param_1)

{
  HANDLE pvVar1;
  DWORD DVar2;
  
  if (*(int *)((int)param_1 + 8) == 0) {
    *(undefined4 *)((int)param_1 + 0x14) = 0;
    pvVar1 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_0041add0,param_1,0,
                          (LPDWORD)((int)param_1 + 0x1c));
    *(HANDLE *)((int)param_1 + 8) = pvVar1;
    if (pvVar1 == (HANDLE)0x0) {
      DVar2 = GetLastError();
      if ((int)DVar2 < 1) {
        return DVar2;
      }
      return DVar2 & 0xffff | 0x80070000;
    }
  }
  return 0;
}



/* Function: FUN_004110a3 */

uint __fastcall FUN_004110a3(LPVOID param_1)

{
  HANDLE pvVar1;
  DWORD DVar2;
  
  if (*(int *)((int)param_1 + 8) == 0) {
    *(undefined4 *)((int)param_1 + 0x14) = 0;
    pvVar1 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_00414e80,param_1,0,
                          (LPDWORD)((int)param_1 + 0x1c));
    *(HANDLE *)((int)param_1 + 8) = pvVar1;
    if (pvVar1 == (HANDLE)0x0) {
      DVar2 = GetLastError();
      if ((int)DVar2 < 1) {
        return DVar2;
      }
      return DVar2 & 0xffff | 0x80070000;
    }
  }
  return 0;
}



/* Function: FUN_004110dc */

undefined4 * __fastcall FUN_004110dc(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_004011d0;
  FUN_00411018(param_1 + 1);
  param_1[0x2b] = 0;
  param_1[0x2a] = param_1 + 1;
  FUN_0041111f(param_1 + 0x2c,param_1,param_1 + 0xb,'\0');
  return param_1;
}



/* Function: FUN_0041111f */

undefined4 * __thiscall FUN_0041111f(void *this,undefined4 param_1,undefined4 param_2,char param_3)

{
  void *local_10;
  undefined1 *puStack_c;
  undefined4 uStack_8;
  
  uStack_8 = 0xffffffff;
  puStack_c = &LAB_00455170;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  *(undefined4 *)((int)this + 4) = param_1;
  *(undefined4 *)this = 0;
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 0x10) = param_2;
  if (param_3 != '\0') {
    FUN_00410147((undefined4 *)this);
  }
  ExceptionList = local_10;
  return (undefined4 *)this;
}



/* Function: FUN_00411185 */

void __fastcall FUN_00411185(PVOID param_1,undefined4 param_2,undefined4 param_3)

{
  PREGHANDLE RegHandle;
  int iVar1;
  code *pcVar2;
  ULONG UVar3;
  undefined4 extraout_EDX;
  GUID local_1c;
  uint local_c;
  
  local_c = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  iVar1 = *(int *)((int)param_1 + 4);
  local_1c.Data1 = *(ulong *)(iVar1 + -0x10);
  local_1c._4_4_ = *(undefined4 *)(iVar1 + -0xc);
  local_1c.Data4._0_4_ = *(undefined4 *)(iVar1 + -8);
  local_1c.Data4._4_4_ = *(undefined4 *)(iVar1 + -4);
  RegHandle = (PREGHANDLE)((int)param_1 + 0x18);
  if (*(int *)RegHandle != 0 || *(int *)((int)param_1 + 0x1c) != 0) {
    pcVar2 = (code *)swi(0x29);
    (*pcVar2)();
    param_2 = extraout_EDX;
  }
  *(undefined4 *)((int)param_1 + 0x24) = param_3;
  *(undefined4 *)((int)param_1 + 0x20) = param_2;
  UVar3 = EventRegister(&local_1c,FUN_0041d200,param_1,RegHandle);
  if (UVar3 == 0) {
    EventSetInformation(*(undefined4 *)RegHandle,*(undefined4 *)((int)param_1 + 0x1c),2,
                        *(undefined2 **)((int)param_1 + 4),**(undefined2 **)((int)param_1 + 4));
  }
  FUN_0041e590(local_c ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_00411213 */

/* WARNING: Function: __EH_prolog3 replaced with injection: EH_prolog3 */
/* WARNING: Function: __EH_epilog3 replaced with injection: EH_epilog3 */

undefined4 * __fastcall FUN_00411213(undefined4 *param_1)

{
  HANDLE pvVar1;
  
  param_1[1] = 0;
  *param_1 = &PTR_FUN_00401290;
  param_1[2] = 0;
  param_1[4] = 0;
  param_1[5] = 1;
  param_1[6] = 0;
  pvVar1 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
  param_1[3] = pvVar1;
  if (pvVar1 == (HANDLE)0x0) {
    FUN_00461d49();
  }
  return param_1;
}



/* Function: FUN_00411266 */

ULONG FUN_00411266(void)

{
  ULONG UVar1;
  
  if (DAT_0046b468 == 0 && DAT_0046b46c == 0) {
    UVar1 = EventRegister((LPCGUID)&DAT_00402b9c,FUN_00460e70,&DAT_0046b468,
                          (PREGHANDLE)&DAT_0046b468);
  }
  else {
    UVar1 = 0;
  }
  return UVar1;
}



/* Function: FUN_00411297 */

/* WARNING: Function: __EH_prolog3 replaced with injection: EH_prolog3 */
/* WARNING: Function: __EH_epilog3 replaced with injection: EH_epilog3 */

DWORD __thiscall FUN_00411297(void *this,undefined4 *param_1)

{
  DWORD DVar1;
  undefined4 *puVar2;
  undefined4 *this_00;
  undefined4 local_1c;
  int local_18;
  int local_14 [3];
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x10;
  local_8 = 0x4112a3;
  DVar1 = FUN_0041270c((int)this);
  this_00 = (undefined4 *)0x0;
  local_18 = 0;
  local_14[0] = 0;
  local_1c = 0;
  puVar2 = (undefined4 *)FUN_0041ea6a(0x254);
  if (puVar2 != (undefined4 *)0x0) {
    this_00 = FUN_00413cae(puVar2);
  }
  local_8 = 0;
  if (this_00 == (undefined4 *)0x0) {
    DVar1 = 0x8007000e;
  }
  else {
    if (-1 < (int)DVar1) {
      DVar1 = FUN_0043ce1d(this,&local_18,local_14);
      if (-1 < (int)DVar1) {
        FUN_0043d014(this_00,local_18,local_14[0]);
        DVar1 = FUN_0043ce1d(this,&local_18,local_14);
        if (-1 < (int)DVar1) {
          FUN_0043d06f(this_00,local_18,local_14[0]);
          DVar1 = FUN_0043ce1d(this,&local_18,local_14);
          if (-1 < (int)DVar1) {
            FUN_0043d09e(this_00,local_18,local_14[0]);
            DVar1 = FUN_0041c730((void *)((int)this + 0x9d4),&local_1c);
            if (-1 < (int)DVar1) {
              this_00[0x8f] = local_1c;
              *param_1 = this_00;
              this_00 = (undefined4 *)0x0;
            }
          }
        }
      }
    }
    if (this_00 != (undefined4 *)0x0) {
      FUN_0041a5a4(this_00);
      FUN_0041ee80(this_00);
    }
  }
  return DVar1;
}



/* Function: FUN_004113a8 */

int __thiscall FUN_004113a8(void *this,undefined2 *param_1,uint param_2,undefined4 param_3)

{
  int iVar1;
  int extraout_EDX;
  
  iVar1 = FUN_0043346b(this,param_2);
  if (iVar1 < 0) {
    if (extraout_EDX != 0) {
      *param_1 = 0;
    }
  }
  else {
    iVar1 = FUN_00433426((int)param_1,extraout_EDX,iVar1,param_3,&stack0x00000010);
  }
  return iVar1;
}



/* Function: FUN_004113dc */

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */

void __fastcall FUN_004113dc(void *param_1)

{
  code *pcVar1;
  void *pvVar2;
  undefined4 uVar3;
  int iVar4;
  undefined4 unaff_retaddr;
  short *local_70;
  int local_6c;
  undefined **local_68;
  undefined4 local_64;
  int local_5c;
  undefined1 local_58 [80];
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x60;
  local_8 = 0x4113e8;
  pvVar2 = (void *)FUN_0041270c((int)param_1);
  if ((int)pvVar2 < 0) {
    iVar4 = 0x607;
LAB_004114f2:
    FUN_0045fe0e(unaff_retaddr,iVar4,0x4065a0,pvVar2);
  }
  else {
    local_70 = (short *)0x0;
    local_6c = 0;
    FUN_00418305(&local_68);
    local_8 = 0;
    pvVar2 = (void *)FUN_0043ce1d(param_1,(int *)&local_70,&local_6c);
    if ((int)pvVar2 < 0) {
      iVar4 = 0x60e;
      goto LAB_004114f2;
    }
    FUN_00444340(&local_68,local_70,0,local_6c);
    if (local_5c != 0) {
      uVar3 = o__wtoi(local_64);
      FUN_0041151b(&DAT_0046cab8,uVar3);
      pvVar2 = (void *)FUN_0043ce1d(param_1,(int *)&local_70,&local_6c);
      if (-1 < (int)pvVar2) {
        FUN_00444340(&local_68,local_70,0,local_6c);
        if (local_5c != 0) {
          uVar3 = o__wtoi(local_64);
          FUN_0041151b(&DAT_0046cadc,uVar3);
          local_8 = 1;
          local_68 = &PTR_FUN_0040101c;
          FUN_00427759(&local_68,(int)local_58);
          FUN_00453ee6();
          return;
        }
        pvVar2 = (void *)FUN_0045a8e2(0x80070057);
        iVar4 = 0x620;
        goto LAB_0041150c;
      }
      iVar4 = 0x61b;
      goto LAB_004114f2;
    }
  }
  pvVar2 = (void *)FUN_0045a8e2(0x80070057);
  iVar4 = 0x613;
LAB_0041150c:
  FUN_0045fe0e(unaff_retaddr,iVar4,0x4065a0,pvVar2);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: FUN_0041151b */

void __thiscall FUN_0041151b(void *this,undefined4 param_1)

{
  HANDLE pvVar1;
  
                    /* WARNING: Load size is inaccurate */
  pvVar1 = *this;
  if ((pvVar1 != (HANDLE)0x0) && (pvVar1 != (HANDLE)0xffffffff)) {
    FUN_00438dd5(pvVar1);
  }
  *(undefined4 *)this = param_1;
  return;
}



/* Function: FUN_00411543 */

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00411543(int param_1,int param_2)

{
  short sVar1;
  code *pcVar2;
  bool bVar3;
  undefined1 uVar4;
  char cVar5;
  HANDLE pvVar6;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  DWORD DVar10;
  PHANDLE TokenHandle;
  BOOL BVar11;
  int *piVar12;
  uint uVar13;
  HRESULT HVar14;
  void *pvVar15;
  uint uVar16;
  undefined4 extraout_ECX;
  short *psVar17;
  undefined4 extraout_ECX_00;
  void *this;
  void *this_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  void *extraout_ECX_03;
  void *extraout_ECX_04;
  void *extraout_ECX_05;
  LPCWSTR pWVar19;
  void *unaff_retaddr;
  undefined4 uVar20;
  undefined1 *puVar21;
  undefined4 uVar22;
  undefined1 *puVar23;
  undefined1 *puVar24;
  undefined1 *puVar25;
  undefined1 *puVar26;
  undefined1 *puVar27;
  undefined1 *puVar28;
  undefined1 *puVar29;
  char *pcVar30;
  undefined4 uVar31;
  undefined4 uVar32;
  uint uStack_3538;
  undefined1 local_3524 [116];
  undefined *local_34b0;
  _SECURITY_ATTRIBUTES local_34ac;
  PSECURITY_DESCRIPTOR local_34a0;
  undefined4 uStack_349c;
  undefined4 uStack_3498;
  undefined4 uStack_3494;
  undefined4 local_3490;
  undefined4 *local_348c;
  uint local_3488;
  DWORD local_3484;
  DWORD local_3480;
  HRESULT local_347c;
  int local_3478;
  uint local_3474;
  uint local_3470;
  PVOID local_346c;
  uint local_3468;
  int local_3464;
  PSID local_3460;
  LPCWSTR local_345c;
  uint local_3458;
  uint local_3454;
  short *local_3450;
  void *local_344c;
  uint local_3448;
  LPCWSTR local_3444;
  undefined4 *local_3440;
  PACL local_343c;
  char local_3435;
  undefined4 local_3434 [262];
  undefined ***local_301c;
  undefined4 local_2a40 [40];
  undefined4 local_29a0 [40];
  undefined **local_2900 [2];
  HANDLE local_28f8;
  HANDLE local_28f4;
  uint *local_28d8;
  undefined4 local_28b4;
  undefined **local_27d8;
  LPCWSTR local_27d4;
  int local_27cc;
  undefined1 local_27c8 [132];
  undefined1 local_2744 [16];
  undefined1 local_2734 [16];
  undefined1 local_2724 [16];
  undefined1 local_2714 [16];
  undefined1 local_2704 [16];
  undefined1 local_26f4 [16];
  undefined1 local_26e4 [16];
  undefined **local_26d4 [49];
  undefined **local_2610;
  undefined4 local_260c;
  int local_2604;
  undefined1 local_2600 [68];
  undefined **local_25bc [9];
  undefined4 local_2598 [21];
  undefined **local_2544;
  LPCWSTR local_2540;
  undefined1 local_2534 [68];
  undefined1 local_24f0 [16];
  undefined4 local_24e0 [4];
  uint local_24d0;
  undefined1 local_24c8 [12];
  undefined2 local_24bc [12];
  undefined4 local_24a4;
  undefined4 local_24a0;
  undefined4 local_249c;
  undefined1 local_2498 [20];
  undefined4 local_2484 [2331];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  void *pvVar18;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_0045537f;
  local_10 = ExceptionList;
  uStack_3538 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_3538;
  ExceptionList = &local_10;
  local_18 = uStack_3538;
  HeapSetInformation((HANDLE)0x0,HeapEnableTerminationOnCorruption,(PVOID)0x0,0);
  uVar31 = 1;
  _set_error_mode(1);
  cVar5 = FUN_0041fb74((uint3)uVar31);
  if (cVar5 != '\0') {
    ImmDisableIME(0xffffffff);
  }
  FUN_004110dc(local_26d4);
  local_26d4[0] = &PTR_FUN_00401468;
  FUN_00410352(local_26d4);
  local_8 = 0;
  local_3474 = 1;
  local_3468 = WerSetFlags(2);
  if ((int)local_3468 < 0) {
    if (local_3468 != 0x80004001) {
      FUN_0045d1d7(unaff_retaddr,0x43f,
                   "onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",
                   local_3468);
    }
    SetErrorMode(3);
  }
  else {
    SetErrorMode(1);
  }
  local_347c = CoInitializeEx((LPVOID)0x0,0);
  local_8._0_1_ = 2;
  local_3470 = 0;
  _eh_vector_constructor_iterator_(local_2498,0x124,0x20,FUN_0041c790,FUN_0045af70);
  local_8._0_1_ = 3;
  FUN_00411213(local_25bc);
  local_25bc[0] = &PTR__scalar_deleting_destructor__004013b8;
  FUN_00418305(local_2598);
  local_8 = CONCAT31(local_8._1_3_,4);
  FUN_00411266();
  if ((DAT_0046d1c1 & 0x10) != 0) {
    GetCurrentProcessId();
    FUN_00461004(extraout_ECX,(PCEVENT_DESCRIPTOR)&DAT_004061e0);
  }
  FUN_00432d87();
  local_346c = (PVOID)0x0;
  FUN_00410226();
  local_24a4 = 1;
  local_24a0 = 1;
  local_249c = 1;
  puVar8 = &local_24a4;
  uVar32 = 0xc;
  uVar31 = 4;
  pvVar6 = GetCurrentProcess();
  SetProcessInformation(pvVar6,uVar31,puVar8,uVar32);
  local_344c = (void *)FUN_0041ea6a(0x28);
  local_8._0_1_ = 6;
  if (local_344c == (void *)0x0) {
    DAT_0046c328 = (undefined4 *)0x0;
  }
  else {
    DAT_0046c328 = FUN_00410f45(local_344c,FUN_0041a320,FUN_0041a320,0x11,0,3);
  }
  local_8._0_1_ = 5;
  uVar4 = (undefined1)local_8;
  local_8._0_1_ = 5;
  if (DAT_0046c328 == (undefined4 *)0x0) {
    local_8._0_1_ = uVar4;
    puVar8 = (undefined4 *)FUN_0045a8e2(0x8007000e);
    iVar7 = 0x468;
LAB_0041260d:
    FUN_0045fe0e(unaff_retaddr,iVar7,0x4049e0,puVar8);
    pvVar18 = extraout_ECX_03;
LAB_00412615:
    FUN_0045fdf4((int)pvVar18,0x4b9,0x4049e0);
    pvVar18 = extraout_ECX_04;
LAB_00412620:
    puVar8 = (undefined4 *)0x8000ffff;
    iVar7 = 0x4be;
LAB_0041262b:
    FUN_0045fe0e(pvVar18,iVar7,0x4049e0,puVar8);
    pvVar18 = extraout_ECX_05;
LAB_00412630:
    FUN_00437f4c(pvVar18);
LAB_00412637:
    GetLastError();
    FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x54e,
                 L"[SrchFilterDaemon] Failed to open shutdown event! (LastErr = %d) Exiting...");
    iVar7 = 0x54f;
    pcVar30 = "onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx";
  }
  else {
    if ((param_2 == 0) || (param_1 == 0)) {
      local_8._0_1_ = uVar4;
      puVar8 = (undefined4 *)FUN_0045a8e2(0x80070057);
      iVar7 = 0x46d;
      goto LAB_0041260d;
    }
    if ((param_1 < 9) ||
       (iVar7 = o__wcsicmp(*(undefined4 *)(param_2 + 0x20),L"DownLevelDaemon"),
       uVar4 = (undefined1)local_8, iVar7 != 0)) {
      local_8._0_1_ = uVar4;
      puVar8 = (undefined4 *)FUN_0045a8e2(0x80070057);
      iVar7 = 0x472;
      goto LAB_0041260d;
    }
    local_3450 = *(short **)(param_2 + 4);
    if (local_3450 == (short *)0x0) {
LAB_00412338:
      puVar8 = (undefined4 *)FUN_0045a8e2(0x80070057);
      iVar7 = 0x478;
      goto LAB_0041260d;
    }
    psVar17 = local_3450;
    do {
      sVar1 = *psVar17;
      psVar17 = psVar17 + 1;
    } while (sVar1 != 0);
    if ((int)psVar17 - (int)(local_3450 + 1) >> 1 == 0) goto LAB_00412338;
    FUN_00424330(&local_27d8,*(short **)(param_2 + 8));
    local_8._0_1_ = 7;
    if (local_27cc == 0) {
      puVar8 = (undefined4 *)FUN_0045a8e2(0x80070057);
      iVar7 = 0x47e;
      goto LAB_0041260d;
    }
    local_3470 = o__wtoi(*(undefined4 *)(param_2 + 0xc));
    local_3458 = local_3470;
    if ((local_3470 == 0) || (0x20 < local_3470)) {
      puVar8 = (undefined4 *)FUN_0045a8e2(0x80070057);
      iVar7 = 0x484;
      goto LAB_0041260d;
    }
    DAT_0046c360 = (uint)(1 < local_3470);
    DAT_0046c2e8 = (HKEY)o__wtoi(*(undefined4 *)(param_2 + 0x10));
    if ((((DAT_0046c2e8 != (HKEY)0x80000002) && (DAT_0046c2e8 != (HKEY)0x80000000)) &&
        (DAT_0046c2e8 != (HKEY)0x80000001)) &&
       ((DAT_0046c2e8 != (HKEY)0x80000003 && (DAT_0046c2e8 != (HKEY)0x80000005)))) {
      puVar8 = (undefined4 *)FUN_0045a8e2(0x80070057);
      iVar7 = 0x48f;
      goto LAB_0041260d;
    }
    local_3444 = *(LPCWSTR *)(param_2 + 0x14);
    FUN_00443a1f(local_29a0,DAT_0046c2e8,local_3444);
    local_8._0_1_ = 8;
    FUN_00443ac1(local_2a40,(int)local_29a0,L"Gathering Manager",0x20019);
    local_8._0_1_ = 9;
    iVar7 = FUN_0044409d(local_2a40,L"DebugFilters",&local_3454);
    if ((iVar7 != 0) && (local_3454 != 0)) {
      DAT_0046c2f8 = 1;
    }
    FUN_004242f3(&local_2610,*(short **)(param_2 + 0x18));
    local_8._0_1_ = 10;
    if (local_2604 == 0) {
      puVar8 = (undefined4 *)FUN_0045a8e2(0x80070057);
      iVar7 = 0x4a0;
      goto LAB_0041260d;
    }
    local_3435 = '\0';
    pvVar18 = unaff_retaddr;
    if (9 < param_1) {
      puVar9 = (undefined4 *)o__wtoi(*(undefined4 *)(param_2 + 0x24));
      local_3440 = puVar9;
      if ((puVar9 != (undefined4 *)0x1) && (puVar9 != (undefined4 *)0x2)) goto LAB_0041198d;
      DVar10 = FUN_0040fabb();
      if (((int)DVar10 < 0) || (DAT_0046c49c == 0)) {
        puVar8 = (undefined4 *)FUN_0045a8e2(DVar10);
        iVar7 = 0x4b3;
        goto LAB_0041260d;
      }
      if (puVar9 != (undefined4 *)0x2) goto LAB_0041198d;
      local_343c = (PACL)0x0;
      local_8._0_1_ = 0xb;
      TokenHandle = (PHANDLE)thunk_FUN_0043a79f(&local_343c);
      pvVar6 = GetCurrentProcess();
      BVar11 = OpenProcessToken(pvVar6,8,TokenHandle);
      if (BVar11 == 0) goto LAB_00412615;
      iVar7 = FUN_0045c9ad(local_343c);
      if (iVar7 == 0x1f0001) {
        local_3435 = '\x01';
        local_8._0_1_ = 10;
        FUN_0041d8d0((int *)&local_343c);
        puVar9 = local_3440;
        goto LAB_0041198d;
      }
      goto LAB_00412620;
    }
    puVar9 = (undefined4 *)0x0;
LAB_0041198d:
    puVar8 = (undefined4 *)FUN_00410506();
    if ((int)puVar8 < 0) {
      iVar7 = 0x4c6;
      goto LAB_0041262b;
    }
    local_3490 = 0;
    local_34a0 = (PSECURITY_DESCRIPTOR)0x0;
    uStack_349c = 0;
    uStack_3498 = 0;
    uStack_3494 = 0;
    local_8._0_1_ = 0xc;
    FUN_00410763((int *)&local_34a0);
    local_345c = (LPCWSTR)0x0;
    local_8._0_1_ = 0xd;
    piVar12 = FUN_00425d4f((int *)&local_345c);
    puVar8 = (undefined4 *)FUN_00442653(extraout_ECX_00,(DWORD)piVar12);
    if ((int)puVar8 < 0) {
      iVar7 = 0x4ce;
      goto LAB_0041262b;
    }
    FUN_0042699f(&local_34a0,local_345c);
    FUN_00418e9c(&local_3460);
    local_8._0_1_ = 0xe;
    puVar8 = (undefined4 *)0x411a1b;
    uVar13 = FUN_0043308b();
    if ((char)uVar13 != '\0') {
      puVar8 = thunk_FUN_0043a88b(&local_3460);
      ConvertStringSidToSidW
                (
                L"S-1-15-2-2922806004-2201342939-3402379583-417094435-271215634-1891370830-1688951784"
                );
      FUN_0041cfb0(&local_34a0,local_3460);
    }
    if (puVar9 == (undefined4 *)0x0) {
      DVar10 = 2;
    }
    else {
      DVar10 = 3;
    }
    HVar14 = CoInitializeSecurity
                       (local_34a0,-1,(SOLE_AUTHENTICATION_SERVICE *)0x0,(void *)0x0,5,DVar10,
                        (void *)0x0,0,(void *)0x0);
    pWVar19 = local_3444;
    if (HVar14 < 0) {
      iVar7 = 0x4ef;
      goto LAB_0041262b;
    }
    FUN_0042d3ab(local_3444);
    if (local_3435 == '\0') {
      pcVar30 = (char *)FUN_0043f151(pWVar19);
    }
    else {
      pcVar30 = FUN_0046170b();
    }
    if (((int)pcVar30 < 0) && (pcVar30 != (char *)0x80040d37)) {
      FUN_0045a8e2(pcVar30);
      iVar7 = 0x505;
      goto LAB_0041260d;
    }
    iVar7 = FUN_0042d7f4(pWVar19);
    if ((iVar7 < 0) || (DAT_0046c2e0 == 0)) {
      DAT_0046c2e0 = 4;
      DAT_0046bda0 = 1;
    }
    else {
      DAT_0046bda0 = 0;
    }
    DAT_0046c2f0 = 1;
    FUN_0041deb0(local_24e0,local_3450);
    local_8._0_1_ = 0xf;
    uVar31 = FUN_004424e9(local_24e0);
    if ((char)uVar31 != '\0') {
      iVar7 = FUN_0043acb6(local_24e0);
      if ((iVar7 == -1) || (local_24d0 <= iVar7 + 1U)) {
        bVar3 = true;
      }
      else {
        bVar3 = false;
      }
      if (bVar3) {
        iVar7 = 0x525;
        goto LAB_0041262b;
      }
      FUN_0043b7c7(local_24e0,local_24bc,iVar7 + 1U);
      puVar29 = local_2744;
      local_8._0_1_ = 0x10;
      puVar28 = local_2734;
      puVar27 = local_2714;
      puVar26 = local_2724;
      puVar25 = local_2704;
      puVar24 = local_26f4;
      puVar23 = local_26e4;
      iVar7 = FUN_0044221c(local_24bc);
      if (iVar7 < 0) {
        iVar7 = 0x53c;
        goto LAB_0041262b;
      }
      puVar21 = local_24f0;
      uVar22 = 0;
      uVar20 = 0;
      uVar32 = 0;
      uVar31 = 0x1f0003;
      pvVar15 = thunk_FUN_0043a79f(&DAT_0046caac);
      iVar7 = NtCreateCrossVmEvent
                        (pvVar15,uVar31,uVar32,uVar20,puVar21,uVar22,puVar23,puVar24,puVar25,puVar26
                         ,puVar27,puVar28,puVar29);
      if (-1 < iVar7) {
        local_8._0_1_ = 0xf;
        puVar8 = (undefined4 *)0x411c00;
        FUN_00425360(local_24bc);
        goto LAB_00411c89;
      }
      goto LAB_00412630;
    }
    FUN_00418305(&local_2544);
    local_8 = CONCAT31(local_8._1_3_,0x11);
    FUN_00425a4f(this,(int)&local_27d8);
    FUN_00425ff3(&local_2544,&DAT_00404b08);
    pvVar6 = OpenEventW(0x1f0003,0,local_2540);
    if ((DAT_0046caac != (HANDLE)0x0) && (DAT_0046caac != (HANDLE)0xffffffff)) {
      FUN_00438dd5(DAT_0046caac);
    }
    local_8._0_1_ = 0x12;
    local_2544 = &PTR_FUN_0040101c;
    DAT_0046caac = pvVar6;
    FUN_00427759(&local_2544,(int)local_2534);
    local_8._0_1_ = 0xf;
    pWVar19 = local_3444;
LAB_00411c89:
    cVar5 = thunk_FUN_00439ccf((int *)&DAT_0046caac);
    if (cVar5 == '\0') goto LAB_00412637;
    _DAT_0046c2e4 = 3;
    FUN_0042d87c(pWVar19);
    DAT_0046c2ec = GetCurrentProcessId();
    FUN_00418e0a(local_2900);
    local_2900[0] = &PTR_FUN_00401134;
    local_8._0_1_ = 0x13;
    iVar7 = FUN_00444787(local_2900,local_27d4);
    uVar13 = DAT_0046c2ec;
    if (iVar7 < 0) {
      FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x565,
                   L"[SrchFilterDaemon] Failed to open control pipe! (hr = 0x%x) Exiting...");
      uVar31 = 0x80070002;
      if (iVar7 == -0x7ff8fffe) goto LAB_00412663;
      FUN_0045a8e2(iVar7);
      iVar7 = 0x56a;
      goto LAB_0041260d;
    }
    local_28f8 = DAT_0046caac;
    if (DAT_0046c2f8 != 0) {
      local_28b4 = 30000;
    }
    *local_28d8 = DAT_0046c2ec;
    local_28d8[1] = ~uVar13;
    DVar10 = FUN_00412ada(local_2900);
    if ((int)DVar10 < 0) {
      FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x57c,
                   L"[SrchFilterDaemon] Control Pipe Connect Failed\n");
      FUN_0045a8e2(DVar10);
      iVar7 = 0x57d;
      goto LAB_0041260d;
    }
    local_28b4 = 30000;
    FUN_004189ce(local_3434);
    local_301c = local_2900;
    local_8._0_1_ = 0x14;
    do {
      iVar7 = FUN_004113dc(local_3434);
      if (-1 < iVar7) break;
    } while (iVar7 == -0x7ff8fa4c);
    if (iVar7 < 0) {
      iVar7 = 0x591;
      goto LAB_0041262b;
    }
    local_28b4 = 0xffffffff;
    local_3480 = 0;
    BVar11 = GetHandleInformation(DAT_0046cab8,&local_3480);
    if (BVar11 == 0) {
      pcVar30 = "onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx";
      iVar7 = 0x599;
    }
    else {
      local_28f4 = DAT_0046cab8;
      pvVar6 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
      if ((DAT_0046cabc != (HANDLE)0x0) && (DAT_0046cabc != (HANDLE)0xffffffff)) {
        FUN_00438dd5(DAT_0046cabc);
      }
      DAT_0046cabc = pvVar6;
      cVar5 = thunk_FUN_00439ccf((int *)&DAT_0046cabc);
      if (cVar5 == '\0') {
        pcVar30 = "onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx";
        iVar7 = 0x5a0;
      }
      else {
        pvVar6 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
        if ((DAT_0046cab0 != (HANDLE)0x0) && (DAT_0046cab0 != (HANDLE)0xffffffff)) {
          FUN_00438dd5(DAT_0046cab0);
        }
        DAT_0046cab0 = pvVar6;
        cVar5 = thunk_FUN_00439ccf((int *)&DAT_0046cab0);
        if (cVar5 != '\0') {
          local_346c = AddVectoredExceptionHandler(1,FUN_0045c1f0);
          if (local_346c == (PVOID)0x0) {
            iVar7 = 0x5ac;
          }
          else {
            FUN_00410633();
            FUN_004439c8();
            FUN_00432e24(local_25bc,local_260c);
            uVar13 = FUN_0041106a(local_25bc);
            if ((int)uVar13 < 0) {
              iVar7 = 0x5b3;
            }
            else {
              GetCurrentProcessId();
              iVar7 = FUN_0043331a(this_00,(undefined2 *)&DAT_0046c858,0x104,
                                   L"Global\\FilterThreadStopped_%08x");
              if (iVar7 < 0) {
                iVar7 = 0x5bb;
              }
              else {
                local_343c = (PACL)FUN_0041ee96(8);
                BVar11 = InitializeAcl(local_343c,8,2);
                if (BVar11 == 0) {
                  pcVar30 = 
                  "onecoreuap\\base\\appmodel\\Search\\common\\include\\secutil_common.hxx";
                  iVar7 = 0x16a;
                  goto LAB_0041265b;
                }
                local_8._0_1_ = 0x15;
                FUN_00412692(&local_3448,(PSID_IDENTIFIER_AUTHORITY)&DAT_0046bdc8,1,0x46bdd8);
                local_8._0_1_ = 0x16;
                FUN_00412692(&local_3478,(PSID_IDENTIFIER_AUTHORITY)&DAT_0046bdc0,1,0x46ce80);
                uVar13 = local_3448;
                local_8._0_1_ = 0x17;
                FUN_0045bced(&local_343c);
                FUN_0045bced(&local_343c);
                FUN_00418e9c(&local_3464);
                local_8 = CONCAT31(local_8._1_3_,0x18);
                uVar16 = FUN_0043308b();
                if ((char)uVar16 != '\0') {
                  puVar9 = thunk_FUN_0043a88b(&local_3464);
                  ConvertStringSidToSidW
                            (L"S-1-15-2-2922806004-2201342939-3402379583-417094435-271215634-1891370830-1688951784"
                             ,puVar9);
                  FUN_0045bced(&local_343c);
                }
                FUN_0041a78a(local_24c8);
                local_8._0_1_ = 0x19;
                FUN_0041a81d(local_24c8,extraout_ECX_01,local_343c);
                local_3444 = (LPCWSTR)0x0;
                local_34ac.lpSecurityDescriptor = local_24c8;
                local_34ac.nLength = 0xc;
                local_34ac.bInheritHandle = 1;
                local_8._0_1_ = 0x1a;
                FUN_00439043(&local_3444,extraout_ECX_02,extraout_ECX_02,&local_34ac);
                FUN_00410f83(&local_3488);
                local_8._0_1_ = 0x1b;
                uVar16 = 0;
                local_3454 = local_3488;
                local_3474 = local_3488;
                while( true ) {
                  if (local_3458 <= uVar16) {
                    do {
                      local_3440 = (undefined4 *)0x0;
                      local_8._0_1_ = 0x1c;
                      local_3450 = (short *)FUN_00411297(local_3434,&local_3440);
                      if ((int)local_3450 < 0) {
                        puVar8 = local_3440;
                        if (local_3450 == (short *)0x800705b4) {
                          local_3450 = (short *)0x0;
                        }
                      }
                      else {
                        local_34b0 = &DAT_0046ca60;
                        EnterCriticalSection((LPCRITICAL_SECTION)&DAT_0046ca60);
                        puVar8 = local_3440;
                        local_8._0_1_ = 0x1d;
                        local_348c = DAT_0046c328;
                        local_344c = (void *)DAT_0046c328[9];
                        pcVar2 = (code *)DAT_0046c328[2];
                        (*(code *)PTR_guard_check_icall_0046e528)(local_3440);
                        (*pcVar2)();
                        piVar12 = FUN_00419f25((int)puVar8);
                        if (*piVar12 != 0) {
                          FUN_00461213(*piVar12);
                        }
                        LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_0046ca60);
                      }
                      if (puVar8 != (undefined4 *)0x0) {
                        FUN_0041a5a4(puVar8);
                        FUN_0041ee80(puVar8);
                      }
                    } while (-1 < (int)local_3450);
                    FUN_00432cfa(&local_3444);
                    if (local_3458 != 0) {
                      puVar8 = local_2484;
                      local_3448 = local_3458;
                      do {
                        if (puVar8[-3] != 0) {
                          *puVar8 = 1;
                          SetEvent((HANDLE)puVar8[-2]);
                        }
                        puVar8 = puVar8 + 0x49;
                        local_3448 = local_3448 - 1;
                      } while (local_3448 != 0);
                    }
                    if (local_3488 != 0) {
                      pvVar6 = GetCurrentProcess();
                      SetPriorityClass(pvVar6,local_3484);
                    }
                    thunk_FUN_0042570f((int *)&local_3444);
                    FUN_0041ab14((int)local_24c8);
                    thunk_FUN_0042568a(&local_3464);
                    if (local_3478 != 0) {
                      o_free(local_3478);
                    }
                    if (uVar13 != 0) {
                      o_free(uVar13);
                    }
                    o_free(local_343c);
                    FUN_0041a00a(local_3434);
                    FUN_00462467(local_2900);
                    FUN_00425360((undefined2 *)local_24e0);
                    thunk_FUN_0042568a((int *)&local_3460);
                    FUN_004252cd((int *)&local_345c);
                    FUN_0045b11d(&local_34a0);
                    local_8._0_1_ = 0x1e;
                    local_2610 = &PTR_FUN_0040101c;
                    FUN_00427759(&local_2610,(int)local_2600);
                    local_2610 = &PTR_o__purecall_004011dc;
                    FUN_00418c23(local_2a40);
                    FUN_00418c23(local_29a0);
                    local_8 = CONCAT31(local_8._1_3_,0x1f);
                    local_27d8 = &PTR_FUN_004010ac;
                    FUN_00427759(&local_27d8,(int)local_27c8);
                    local_27d8 = &PTR_o__purecall_004011dc;
                    local_8 = 4;
                    FUN_0041241e();
                    return;
                  }
                  FUN_00432d73(local_2498 + uVar16 * 0x124,local_3450);
                  uVar13 = FUN_004110a3(local_2498 + uVar16 * 0x124);
                  if ((int)uVar13 < 0) break;
                  uVar16 = uVar16 + 1;
                  uVar13 = local_3448;
                }
                iVar7 = 0x5e3;
              }
            }
          }
          goto LAB_0041262b;
        }
        pcVar30 = "onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx";
        iVar7 = 0x5a6;
      }
    }
  }
LAB_0041265b:
  uVar31 = FUN_0045fdf4((int)unaff_retaddr,iVar7,(int)pcVar30);
LAB_00412663:
  FUN_0045ab5e(local_3524,uVar31);
                    /* WARNING: Subroutine does not return */
  _CxxThrowException(local_3524,(ThrowInfo *)&DAT_0046585c);
}



/* Function: Catch_All@0041237a */

undefined * Catch_All_0041237a(void)

{
  char cVar1;
  undefined4 uVar2;
  int unaff_EBP;
  
  uVar2 = FUN_004239ac();
  cVar1 = thunk_FUN_00439ccf((int *)&DAT_0046caac);
  if (cVar1 != '\0') {
    cVar1 = thunk_FUN_00439ccf((int *)&DAT_0046cadc);
    if (cVar1 != '\0') {
      SetEvent(DAT_0046cadc);
    }
    SetEvent(DAT_0046caac);
  }
  *(undefined4 *)(unaff_EBP + -0x24a4) = uVar2;
  FUN_00425d0f((void *)(unaff_EBP + -0x24bc));
  FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x617,
               L"[SrchFilterDaemon] Exception caught in filter daemon (main): %ws\n");
  *(undefined4 *)(unaff_EBP + -0x3448) = uVar2;
  return &DAT_004123f7;
}



/* Function: FUN_0041241e */

void FUN_0041241e(void)

{
  code *pcVar1;
  LPVOID lpMem;
  HANDLE pvVar2;
  undefined4 extraout_ECX;
  int *unaff_EBX;
  uint unaff_EBP;
  int *piVar3;
  int unaff_EDI;
  undefined4 uStack0000000c;
  
  if (unaff_EDI != 0) {
    piVar3 = (int *)(unaff_EBP - 0x2494);
    do {
      FUN_00460190(piVar3);
      piVar3 = piVar3 + 0x49;
      unaff_EDI = unaff_EDI + -1;
    } while (unaff_EDI != 0);
  }
  if (*(int *)(unaff_EBP - 0x25b0) != 0) {
    pvVar2 = *(HANDLE *)(unaff_EBP - 0x25ac);
    *(undefined4 *)(unaff_EBP - 0x25a4) = 1;
    SetEvent(pvVar2);
  }
  FUN_00460190((int *)(unaff_EBP - 0x25b8));
  FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x625,
               L"[UtilCommon] MSSDMN: Main thread is terminating.");
  if (DAT_0046c2f4 != (int *)0x0) {
    pcVar1 = *(code **)(*DAT_0046c2f4 + 8);
    (*(code *)PTR_guard_check_icall_0046e528)(DAT_0046c2f4);
    (*pcVar1)();
    DAT_0046c2f4 = unaff_EBX;
  }
  if (DAT_0046c328 != (int *)0x0) {
    pcVar1 = *(code **)*DAT_0046c328;
    (*(code *)PTR_guard_check_icall_0046e528)(1);
    (*pcVar1)();
    DAT_0046c328 = unaff_EBX;
  }
  o_free(DAT_0046c49c);
  DAT_0046c49c = unaff_EBX;
  LocalFree(DAT_0046c31c);
  DAT_0046c31c = unaff_EBX;
  if (*(PVOID *)(unaff_EBP - 0x3468) != (PVOID)0x0) {
    RemoveVectoredExceptionHandler(*(PVOID *)(unaff_EBP - 0x3468));
  }
  if ((DAT_0046d1c1 & 0x10) != 0) {
    GetCurrentProcessId();
    FUN_00461004(extraout_ECX,(PCEVENT_DESCRIPTOR)&DAT_00406208);
  }
  FUN_00460f81();
  FUN_0045f707((void *)(unaff_EBP - 0x26d0),*(undefined **)(unaff_EBP - 0x3464),
               *(int *)(unaff_EBP - 0x3450) != 0);
  FUN_0045b034((int *)(unaff_EBP - 0x25b8));
  *(undefined1 *)(unaff_EBP - 4) = 2;
  _eh_vector_destructor_iterator_((void *)(unaff_EBP - 0x2494),0x124,0x20,FUN_0045af70);
  *(undefined1 *)(unaff_EBP - 4) = 0x21;
  FUN_004617ad();
  if (-1 < *(int *)(unaff_EBP - 0x3478)) {
    CoUninitialize();
  }
  *(undefined ***)(unaff_EBP - 0x26d0) = &PTR_FUN_00401468;
  FUN_0045c31c((int *)(unaff_EBP - 0x26d0));
  if (*(int *)(unaff_EBP - 0x2614) != 0) {
    FUN_0045fb3d((undefined4 *)(unaff_EBP - 0x2620));
  }
  FUN_00460a9b((int *)(unaff_EBP - 0x2624));
  FUN_00460b8e((undefined4 *)(unaff_EBP - 0x2638));
  if (*(char *)(unaff_EBP - 0x2698) != '\0') {
    lpMem = *(LPVOID *)(unaff_EBP - 0x269c);
    pvVar2 = GetProcessHeap();
    HeapFree(pvVar2,(DWORD)unaff_EBX,lpMem);
    *(char *)(unaff_EBP - 0x2698) = (char)unaff_EBX;
  }
  *(int **)(unaff_EBP - 0x269c) = unaff_EBX;
  FUN_0045aeca((int *)(unaff_EBP - 0x26cc));
  ExceptionList = *(void **)(unaff_EBP - 0xc);
  uStack0000000c = 0x4125fa;
  FUN_0041e590(*(uint *)(unaff_EBP - 0x14) ^ unaff_EBP);
  return;
}



/* Function: thunk_FUN_00439ccf */

undefined1 __fastcall thunk_FUN_00439ccf(int *param_1)

{
  if ((*param_1 != 0) && (*param_1 != -1)) {
    return 1;
  }
  return 0;
}



/* Function: FUN_00412692 */

/* WARNING: Function: __EH_prolog3 replaced with injection: EH_prolog3 */
/* WARNING: Function: __EH_epilog3 replaced with injection: EH_epilog3 */

undefined4 * __thiscall
FUN_00412692(void *this,PSID_IDENTIFIER_AUTHORITY param_1,uint param_2,int param_3)

{
  DWORD DVar1;
  PSID Sid;
  BOOL BVar2;
  PDWORD pDVar3;
  DWORD nSubAuthority;
  
  nSubAuthority = 0;
  *(undefined4 *)this = 0;
  DVar1 = GetSidLengthRequired((UCHAR)param_2);
  Sid = (PSID)FUN_0041ee96(DVar1);
  BVar2 = InitializeSid(Sid,param_1,(UCHAR)param_2);
  if (BVar2 == 0) {
    FUN_0041ee80(Sid);
  }
  else {
    if (param_2 != 0) {
      do {
        DVar1 = *(DWORD *)(param_3 + nSubAuthority * 4);
        pDVar3 = GetSidSubAuthority(Sid,nSubAuthority);
        nSubAuthority = nSubAuthority + 1;
        *pDVar3 = DVar1;
      } while (nSubAuthority < param_2);
    }
    *(PSID *)this = Sid;
  }
  return (undefined4 *)this;
}



/* Function: FUN_0041270c */

DWORD __fastcall FUN_0041270c(int param_1)

{
  uint uVar1;
  DWORD DVar2;
  int iVar3;
  uint local_8;
  
  if (*(void **)(param_1 + 0x418) == (void *)0x0) {
    DVar2 = 0x80004005;
  }
  else {
    local_8 = 0;
    DVar2 = FUN_0041278a(*(void **)(param_1 + 0x418),(int)&local_8,4);
    uVar1 = local_8;
    if (-1 < (int)DVar2) {
      if (*(uint *)(param_1 + 0x40c) < local_8) {
        if (*(int *)(param_1 + 0x404) == *(int *)(param_1 + 0x408)) {
          FUN_0041ee80(*(int *)(param_1 + 0x404));
          *(undefined4 *)(param_1 + 0x408) = 0;
        }
        iVar3 = FUN_0041eea7(uVar1);
        *(int *)(param_1 + 0x404) = iVar3;
        if (iVar3 == 0) {
          return 0x8007000e;
        }
        *(int *)(param_1 + 0x408) = iVar3;
        *(uint *)(param_1 + 0x40c) = uVar1;
      }
      DVar2 = FUN_0041278a(*(void **)(param_1 + 0x418),*(int *)(param_1 + 0x404),uVar1);
    }
    *(undefined4 *)(param_1 + 0x9d8) = 0;
    *(undefined4 *)(param_1 + 0x9d4) = *(undefined4 *)(param_1 + 0x404);
    *(uint *)(param_1 + 0x410) = uVar1;
    *(uint *)(param_1 + 0x9dc) = uVar1;
  }
  return DVar2;
}



/* Function: FUN_0041278a */

DWORD __thiscall FUN_0041278a(void *this,int param_1,uint param_2)

{
  DWORD DVar1;
  void *local_c [2];
  
  if (param_2 == 0) {
    DVar1 = 0x80070057;
  }
  else {
    DVar1 = 0;
    local_c[0] = this;
    do {
      if ((int)DVar1 < 0) {
        return DVar1;
      }
      DVar1 = FUN_004127d6(this,param_1,param_2,(int *)local_c);
      param_1 = param_1 + (int)local_c[0];
      param_2 = param_2 - (int)local_c[0];
    } while (param_2 != 0);
  }
  return DVar1;
}



/* Function: FUN_004127d6 */

DWORD __thiscall FUN_004127d6(void *this,int param_1,uint param_2,int *param_3)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint _Size;
  uint _Size_00;
  int *piVar5;
  DWORD DVar6;
  uint uVar7;
  int local_c;
  uint local_8;
  
  DVar6 = 0;
  if (param_3 != (int *)0x0) {
    *param_3 = 0;
  }
  if (*(int *)(*(int *)((int)this + 0x28) + 0x80) < 0) {
    if ((*(short *)((int)this + 6) == 0) && (DVar6 = FUN_0046257d(this), (int)DVar6 < 0)) {
      return DVar6;
    }
    piVar5 = (int *)((int)this + 0x28);
    local_c = 0;
    local_8 = param_2;
    uVar3 = *(uint *)(*(int *)((int)this + 0x28) + 0x80) & 0x3fffffff;
    if (param_2 != 0) {
      do {
        uVar1 = *(uint *)(*piVar5 + 0x88);
        uVar7 = *(uint *)(*piVar5 + 0x90);
        iVar2 = *piVar5;
        if (-1 < (int)*(uint *)(iVar2 + 0x80)) {
          return 0x80040db4;
        }
        uVar4 = uVar1 - uVar7;
        if (uVar1 < uVar7) {
          uVar4 = uVar4 + uVar3;
        }
        if (uVar4 == 0) {
          if ((*(uint *)(iVar2 + 0x80) & 0x40000000) == 0) {
            DVar6 = FUN_00412933(this);
            if (DVar6 != 0) break;
          }
          else if (*(int *)(iVar2 + 0x88) == *(int *)(*piVar5 + 0x90)) {
            DVar6 = 1;
            break;
          }
        }
        else {
          _Size = local_8;
          if (uVar4 <= local_8) {
            _Size = uVar4;
          }
          if (uVar7 < uVar1) {
            memcpy((void *)(local_c + param_1),(void *)(iVar2 + 0x98 + uVar7),_Size);
            uVar7 = uVar7 + _Size;
          }
          else {
            uVar4 = uVar3 - uVar7;
            _Size_00 = -(uint)(uVar4 < _Size) & _Size - uVar4;
            if (_Size <= uVar4) {
              uVar4 = _Size;
            }
            if (uVar4 != 0) {
              memcpy((void *)(local_c + param_1),(void *)(iVar2 + 0x98 + uVar7),uVar4);
              uVar7 = uVar7 + uVar4;
              if (uVar7 == uVar3) {
                uVar7 = 0;
              }
            }
            if (_Size_00 != 0) {
              memcpy((void *)(local_c + uVar4 + param_1),(void *)(*piVar5 + 0x98),_Size_00);
              uVar7 = uVar7 + _Size_00;
            }
          }
          local_8 = local_8 - _Size;
          local_c = local_c + _Size;
          *(uint *)(*piVar5 + 0x90) = uVar7;
          uVar4 = uVar7 - uVar1;
          if (uVar7 <= uVar1) {
            uVar4 = uVar4 + uVar3;
          }
          if (*(uint *)((int)this + 0x48) <= uVar4) {
            SetEvent(*(HANDLE *)((int)this + 0x30));
          }
        }
      } while (local_8 != 0);
    }
    if (param_3 != (int *)0x0) {
      *param_3 = param_2 - local_8;
    }
    if (*(int *)(*(int *)((int)this + 0x28) + 0x80) < 0) {
      return DVar6;
    }
  }
  return 0x80040db4;
}



/* Function: FUN_00412933 */

DWORD __fastcall FUN_00412933(void *param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  DWORD DVar4;
  uint uVar5;
  uint uVar6;
  
  uVar1 = FUN_00419d16(param_1,*(int *)((int)param_1 + 0x2c));
  uVar6 = 10000;
  if ((*(int *)((int)param_1 + 0x4c) != -1) && (*(uint *)((int)param_1 + 0x4c) < 10000)) {
    uVar6 = *(uint *)((int)param_1 + 0x4c);
  }
  uVar5 = 0;
  do {
    iVar2 = FUN_00444c93(uVar1,(HANDLE *)((int)param_1 + 0x14),uVar6,*(char *)((int)param_1 + 0x124)
                        );
    uVar3 = *(uint *)(*(int *)((int)param_1 + 0x28) + 0x80);
    if (-1 < (int)uVar3) {
      return 0x80040db4;
    }
    if (iVar2 != 0x102) {
      DVar4 = FUN_00419d78(iVar2);
      return DVar4;
    }
    if ((uVar3 & 0x40000000) != 0) {
      return (uint)(*(int *)(*(int *)((int)param_1 + 0x28) + 0x88) ==
                   *(int *)(*(int *)((int)param_1 + 0x28) + 0x90));
    }
    uVar3 = uVar5 + uVar6;
    if (*(int *)((int)param_1 + 0x4c) == -1) {
      uVar3 = uVar5;
    }
    uVar5 = uVar3;
  } while (uVar3 < *(uint *)((int)param_1 + 0x4c));
  return 0x800705b4;
}



/* Function: FUN_004129c4 */

void __fastcall FUN_004129c4(void *param_1,int param_2)

{
  int iVar1;
  undefined2 local_4c [4];
  undefined4 local_44;
  int local_3c [5];
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined8 local_14;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_3c[0] = 0;
  local_3c[3] = 0;
  local_c = 0;
  local_3c[1] = 2;
  local_3c[2] = 2;
  local_14 = 0;
  local_3c[4] = DAT_00409b30;
  local_4c[0] = 0x1f;
  local_44 = *(undefined4 *)(param_2 + 4);
  uStack_28 = DAT_00409b34;
  uStack_24 = DAT_00409b38;
  uStack_20 = DAT_00409b3c;
  local_1c = 1;
  local_18 = 3;
  iVar1 = FUN_004176b0(param_1,local_3c);
  if (-1 < iVar1) {
    FUN_00414560(param_1,(PROPVARIANT *)local_4c);
  }
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_00412a4b */

uint __thiscall FUN_00412a4b(void *this,int *param_1,uint param_2)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  DWORD DVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint local_8;
  
  if (param_1 == (int *)0x0) {
    uVar6 = 0x80004003;
  }
  else {
    uVar2 = FUN_00419d16(this,*(int *)((int)this + 0x2c));
    uVar6 = 10000;
    if ((*(int *)((int)this + 0x4c) != -1) && (*(uint *)((int)this + 0x4c) < 10000)) {
      uVar6 = *(uint *)((int)this + 0x4c);
    }
    if (param_2 < uVar6) {
      param_2 = uVar6;
    }
    local_8 = 0;
    uVar7 = 0;
    do {
      iVar3 = FUN_00444c93(uVar2,(HANDLE *)((int)this + 0x14),uVar6,*(char *)((int)this + 0x124));
      uVar5 = *(uint *)(*(int *)((int)this + 0x28) + 0x80);
      if (-1 < (int)uVar5) {
        return 0x80040db4;
      }
      if (iVar3 != 0x102) {
        DVar4 = FUN_00419d78(iVar3);
        return DVar4;
      }
      if ((uVar5 & 0x40000000) != 0) {
        return (uint)(*(int *)(*(int *)((int)this + 0x28) + 0x88) ==
                     *(int *)(*(int *)((int)this + 0x28) + 0x90));
      }
      uVar7 = uVar7 + uVar6;
      if (param_2 <= uVar7) {
        pcVar1 = *(code **)(*param_1 + 0xc);
        (*(code *)PTR_guard_check_icall_0046e528)(param_1,uVar7);
        (*pcVar1)();
        uVar7 = 0;
      }
      uVar5 = local_8 + uVar6;
      if (*(int *)((int)this + 0x4c) == -1) {
        uVar5 = local_8;
      }
      local_8 = uVar5;
    } while (uVar5 < *(uint *)((int)this + 0x4c));
    uVar6 = 0x800705b4;
  }
  return uVar6;
}



/* Function: FUN_00412ada */

DWORD __fastcall FUN_00412ada(void *param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  uint uVar3;
  int iVar4;
  int unaff_retaddr;
  
  if (*(short *)((int)param_1 + 4) == 0) {
    uVar3 = FUN_00419d16(param_1,*(int *)((int)param_1 + 0x2c));
    iVar4 = FUN_00444c93(uVar3,(HANDLE *)((int)param_1 + 0x14),*(uint *)((int)param_1 + 0x4c),
                         *(char *)((int)param_1 + 0x124));
    DVar2 = FUN_00419d78(iVar4);
    if (-1 < (int)DVar2) {
      uVar3 = FUN_00419d16(param_1,*(int *)((int)param_1 + 0x3c));
      iVar4 = FUN_00444c93(uVar3,(HANDLE *)((int)param_1 + 0x14),*(uint *)((int)param_1 + 0x4c),
                           *(char *)((int)param_1 + 0x124));
      DVar2 = FUN_00419d78(iVar4);
      if (-1 < (int)DVar2) {
        *(undefined2 *)((int)param_1 + 6) = 1;
        BVar1 = SetEvent(*(HANDLE *)((int)param_1 + 0x30));
        if (BVar1 != 0) {
          return 0;
        }
        iVar4 = *(int *)((int)param_1 + 0x28);
        goto LAB_00412b59;
      }
    }
    iVar4 = *(int *)((int)param_1 + 0x28);
  }
  else {
    FUN_0041a426((uint *)(*(int *)((int)param_1 + 0x28) + 0x80),0x80000000);
    *(undefined4 *)(*(int *)((int)param_1 + 0x28) + 0x88) = 0;
    *(undefined4 *)(*(int *)((int)param_1 + 0x28) + 0x90) = 0;
    if ((*(char *)((int)param_1 + 0x124) != '\0') &&
       (BVar1 = SetEvent(*(HANDLE *)((int)param_1 + 0x3c)), BVar1 == 0)) {
      DVar2 = FUN_0045ee7b(unaff_retaddr,0x28d,0x407760);
      return DVar2;
    }
    BVar1 = SetEvent(*(HANDLE *)((int)param_1 + 0x2c));
    if (BVar1 == 0) {
      iVar4 = *(int *)((int)param_1 + 0x28);
LAB_00412b59:
      FUN_00419d59((uint *)(iVar4 + 0x80),0x80000000);
      DVar2 = GetLastError();
      if ((int)DVar2 < 1) {
        return DVar2;
      }
      return DVar2 & 0xffff | 0x80070000;
    }
    uVar3 = FUN_00419d16(param_1,*(int *)((int)param_1 + 0x30));
    iVar4 = FUN_00444c93(uVar3,(HANDLE *)((int)param_1 + 0x14),*(uint *)((int)param_1 + 0x4c),
                         *(char *)((int)param_1 + 0x124));
    DVar2 = FUN_00419d78(iVar4);
    if (-1 < (int)DVar2) {
      return DVar2;
    }
    iVar4 = *(int *)((int)param_1 + 0x28);
  }
  FUN_00419d59((uint *)(iVar4 + 0x80),0x80000000);
  return DVar2;
}



/* Function: FUN_00412c49 */

void __fastcall FUN_00412c49(void *param_1,int *param_2)

{
  code *pcVar1;
  int iVar2;
  undefined2 local_4c [4];
  undefined2 local_44;
  int local_3c [5];
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined8 local_14;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_3c[0] = 0;
  local_3c[3] = 0;
  local_c = 0;
  local_3c[1] = 2;
  local_3c[2] = 2;
  local_14 = 0;
  local_3c[4] = DAT_00409b30;
  uStack_28 = DAT_00409b34;
  uStack_24 = DAT_00409b38;
  uStack_20 = DAT_00409b3c;
  pcVar1 = *(code **)(*param_2 + 0x1c);
  local_1c = 1;
  local_18 = 7;
  (*(code *)PTR_guard_check_icall_0046e528)(param_2);
  iVar2 = (*pcVar1)();
  if (-1 < iVar2) {
    local_4c[0] = 0xb;
    if (iVar2 == 0) {
      local_44 = 0xffff;
    }
    else {
      local_44 = 0;
    }
    iVar2 = FUN_004176b0(param_1,local_3c);
    if (-1 < iVar2) {
      FUN_00414560(param_1,(PROPVARIANT *)local_4c);
    }
  }
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_00412ced */

void __fastcall FUN_00412ced(void *param_1,int *param_2)

{
  code *pcVar1;
  int iVar2;
  undefined2 local_4c [4];
  uint local_44;
  undefined4 local_40;
  int local_3c [5];
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined8 local_14;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_3c[0] = 0;
  local_3c[3] = 0;
  local_c = 0;
  local_3c[1] = 2;
  local_3c[2] = 2;
  local_14 = 0;
  local_3c[4] = DAT_00409b30;
  uStack_28 = DAT_00409b34;
  uStack_24 = DAT_00409b38;
  uStack_20 = DAT_00409b3c;
  pcVar1 = *(code **)(*param_2 + 0x44);
  local_1c = 1;
  local_18 = 0x16;
  (*(code *)PTR_guard_check_icall_0046e528)(param_2);
  iVar2 = (*pcVar1)();
  if (-1 < iVar2) {
    local_4c[0] = 0x14;
    local_44 = (uint)(iVar2 == 0);
    local_40 = 0;
    iVar2 = FUN_004176b0(param_1,local_3c);
    if (-1 < iVar2) {
      FUN_00414560(param_1,(PROPVARIANT *)local_4c);
    }
  }
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_00412d94 */

void __fastcall FUN_00412d94(void *param_1,int *param_2)

{
  code *pcVar1;
  int iVar2;
  undefined4 uStack_5c;
  undefined2 local_58 [6];
  undefined4 uStack_4c;
  int aiStack_48 [2];
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined8 local_18;
  undefined4 local_10;
  uint local_c;
  
  local_c = DAT_0046bd40 ^ (uint)&uStack_5c;
  local_40 = 0;
  local_34 = 0;
  local_10 = 0;
  local_3c = 2;
  local_38 = 2;
  local_18 = 0;
  local_30 = DAT_00409b30;
  uStack_2c = DAT_00409b34;
  uStack_28 = DAT_00409b38;
  uStack_24 = DAT_00409b3c;
  pcVar1 = *(code **)(*param_2 + 0x24);
  local_20 = 1;
  local_1c = 0x10;
  (*(code *)PTR_guard_check_icall_0046e528)(param_2,local_58);
  iVar2 = (*pcVar1)();
  if (-1 < iVar2) {
    local_58[0] = 0x40;
    uStack_4c = uStack_5c;
    iVar2 = FUN_004176b0(param_1,aiStack_48);
    if (-1 < iVar2) {
      FUN_00414560(param_1,(PROPVARIANT *)local_58);
    }
  }
  FUN_0041e590(local_18._4_4_ ^ (uint)&stack0xffffff9c);
  return;
}



/* Function: FUN_00412e60 */

/* WARNING: Removing unreachable block (ram,0x004134bd) */

void __fastcall FUN_00412e60(void *param_1,int *param_2)

{
  code *pcVar1;
  undefined1 *puVar2;
  int iVar3;
  undefined4 *puVar4;
  int iVar5;
  BOOL BVar6;
  void *pvVar7;
  undefined4 extraout_ECX;
  int extraout_ECX_00;
  int unaff_retaddr;
  undefined4 in_stack_fffffb14;
  int *pSecurityDescriptor;
  undefined4 uVar8;
  wchar_t *pwVar9;
  uint uStack_4d8;
  undefined2 auStack_4c8 [4];
  uint uStack_4c0;
  undefined1 *puStack_4bc;
  int local_4b8 [7];
  PACL local_49c [2];
  void *local_494;
  undefined4 local_490;
  code *local_48c;
  void *local_488;
  uint local_484;
  undefined1 *local_480;
  undefined1 *local_47c;
  undefined1 *local_478;
  code *local_474;
  DWORD local_470;
  undefined1 local_46c [4];
  int *local_468;
  uint local_464;
  undefined1 *local_460;
  int local_45c [5];
  undefined4 uStack_448;
  undefined4 uStack_444;
  undefined4 uStack_440;
  undefined4 local_43c;
  undefined4 local_438;
  undefined8 local_434;
  undefined4 local_42c;
  wchar_t *local_428 [4];
  undefined1 local_418 [1024];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_0045541c;
  local_10 = ExceptionList;
  uStack_4d8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_4d8;
  ExceptionList = &local_10;
  local_434 = 0;
  local_45c[0] = 0;
  local_45c[3] = 0;
  local_42c = 0;
  local_45c[1] = 2;
  local_45c[2] = 2;
  local_45c[4] = DAT_00409b30;
  uStack_448 = DAT_00409b34;
  uStack_444 = DAT_00409b38;
  uStack_440 = DAT_00409b3c;
  local_43c = 1;
  local_438 = 6;
  local_47c = (undefined1 *)0x0;
  local_478 = (undefined1 *)0x0;
  local_8 = 1;
  local_480 = local_418;
  local_464 = 0x400;
  local_484 = 0;
  local_470 = 0;
  local_494 = param_1;
  local_488 = param_1;
  local_468 = param_2;
  local_460 = local_480;
  local_18 = uStack_4d8;
  puVar2 = local_47c;
LAB_00412f46:
  do {
    while (DAT_0046c49c != (void *)0x0) {
      local_484 = DAT_0046c788;
      if (DAT_0046c788 <= local_464) {
        pSecurityDescriptor = (int *)0x413044;
        memcpy(local_460,DAT_0046c49c,DAT_0046c788);
        goto LAB_00413047;
      }
    }
    local_474 = *(code **)(*local_468 + 0x2c);
    pSecurityDescriptor = local_468;
    (*(code *)PTR_guard_check_icall_0046e528)(local_468,local_460,local_464,&local_484);
    in_stack_fffffb14 = 0x412f91;
    local_474 = (code *)(*local_474)();
    if (local_474 == (code *)0x0) {
LAB_00413047:
      uStack_4c0 = GetSecurityDescriptorLength(local_460);
LAB_00413053:
      local_470 = uStack_4c0;
      if (uStack_4c0 == 0) {
        puStack_4bc = local_460;
        auStack_4c8[0] = 0x41;
        local_480 = (undefined1 *)FUN_004176b0(local_488,local_45c);
        if (-1 < (int)local_480) {
          local_480 = (undefined1 *)FUN_00414560(local_488,(PROPVARIANT *)auStack_4c8);
        }
        if (puVar2 != (undefined1 *)0x0) {
          FUN_004203a7(puVar2);
        }
        goto LAB_004134d3;
      }
      local_8._0_1_ = 2;
      FUN_0041a78a(local_4b8);
      local_8._0_1_ = 3;
      FUN_0041abae(local_4b8,local_460);
      if (local_49c[0] == (PACL)0x0) goto LAB_00413335;
      if (*(int *)((int)local_488 + 0x5f4) != 0) {
        FUN_00412692(&local_468,(PSID_IDENTIFIER_AUTHORITY)&DAT_0046bdd0,2,0x46bddc);
        local_8._0_1_ = 4;
        FUN_0040fa23(local_49c,local_468);
        iVar3 = FUN_0040fa73((int *)local_49c);
        if (iVar3 == 0) {
          pvVar7 = (void *)FUN_0045a8e2(0x80040daa);
          FUN_0045fe0e(unaff_retaddr,0x844,0x4049e0,pvVar7);
          iVar3 = extraout_ECX_00;
          goto LAB_0041350c;
        }
        pSecurityDescriptor = (int *)0x413227;
        FUN_0041a81d(local_4b8,extraout_ECX,local_49c[0]);
        local_8._0_1_ = 3;
        if (local_468 != (int *)0x0) {
          o_free(local_468);
        }
      }
      local_428[0] = 
      L"S-1-15-3-1024-1822509804-4202500280-131100095-208896226-3924139855-286224443-1964377501-2274755015"
      ;
      local_468 = (int *)0x0;
      local_428[1] = 
      L"S-1-15-3-1024-724741592-1210917904-489960769-637019204-3345707629-3097053430-1727148295-85063603"
      ;
      local_428[2] = 
      L"S-1-15-3-128907917-1049808183-3772720920-2589851895-2273257875-2082631859-2896883434";
      local_428[3] = 
      L"S-1-15-3-1861897761-1695161497-2927542615-642690995-327840285-2659745135-2630312742";
      break;
    }
    if ((local_474 == (code *)0x41210) || (local_474 == (code *)0x80004001)) {
      if (DAT_0046c31c == (void *)0x0) {
        in_stack_fffffb14 = 0x4131a9;
        iVar3 = ConvertStringSecurityDescriptorToSecurityDescriptorW
                          (L"O:WDG:AUD:P(A;NP;FR;;;WD)",1,&DAT_0046c31c,&DAT_0046c850);
        if (iVar3 == 0) {
          GetLastError();
          if (puVar2 != (undefined1 *)0x0) {
            FUN_004203a7(puVar2);
          }
          goto LAB_004134d3;
        }
      }
      if (DAT_0046c850 <= local_464) {
        pSecurityDescriptor = (int *)0x413207;
        memcpy(local_460,DAT_0046c31c,DAT_0046c850);
        uStack_4c0 = DAT_0046c850;
        goto LAB_00413053;
      }
      if (puVar2 != (undefined1 *)0x0) {
        FUN_004203a7(puVar2);
      }
      goto LAB_004134d3;
    }
    if (local_474 == (code *)0x8007007a) {
      if (local_464 == 0x400) {
        if (0x400 < local_484) {
          if (0xffff < local_484) {
            FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",
                         0x813,L"[SrchFilterDaemon] Fltrdmn: ACL is too big 0x%08x");
            if (puVar2 != (undefined1 *)0x0) {
              FUN_004203a7(puVar2);
            }
            goto LAB_004134d3;
          }
          iVar3 = FUN_0041ee96(local_484);
          FUN_0042398b(&local_47c,iVar3);
          local_480 = local_47c;
          local_464 = local_484;
          local_460 = local_47c;
          puVar2 = local_47c;
          goto LAB_00412f46;
        }
        pwVar9 = L"[SrchFilterDaemon] Fltrdmn: PH wants smaller buffer 0x%08x";
        uVar8 = 0x809;
      }
      else {
        pwVar9 = L"[SrchFilterDaemon] Fltrdmn: gave bigger buffer but it was not big enough! 0x%08x"
        ;
        uVar8 = 0x7ff;
      }
      FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",uVar8,
                   pwVar9);
      if (puVar2 != (undefined1 *)0x0) {
        FUN_004203a7(puVar2);
      }
      goto LAB_004134d3;
    }
    if ((int)local_474 < 0) {
      FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x82b,
                   L"[SrchFilterDaemon] Fltrdmn: failure reading ACL 0x%08x");
      if (puVar2 != (undefined1 *)0x0) {
        FUN_004203a7(puVar2);
      }
LAB_004134d3:
      ExceptionList = local_10;
      FUN_0041e590(local_18 ^ (uint)&stack0xfffffffc);
      return;
    }
  } while( true );
LAB_00413268:
  if ((int *)0x3 < local_468) {
LAB_00413335:
    FUN_0041ab59(local_4b8);
    local_464 = FUN_0041a719(local_4b8,local_460,local_464,&local_470);
    if (local_464 == 0x8007007a) {
      iVar3 = FUN_0041ee96(local_470);
      FUN_0042398b(&local_478,iVar3);
      local_460 = local_478;
      local_464 = FUN_0041a719(local_4b8,local_478,local_470,&local_470);
    }
    FUN_0041ab14((int)local_4b8);
    local_8 = 1;
    FUN_00413422(local_464);
    return;
  }
  local_474 = (code *)0x0;
  local_8._0_1_ = 5;
  puVar4 = FUN_0043a88b(&local_474);
  iVar5 = ConvertStringSidToSidW(local_428[(int)local_468],puVar4);
  iVar3 = unaff_retaddr;
  if (iVar5 == 0) {
LAB_0041350c:
    FUN_0045fdf4(iVar3,0x852,0x4049e0);
LAB_0041351b:
    pvVar7 = (void *)GetLastError();
    FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\common\\secutil\\secutil.cxx",0xc4,
                 L"[UtilSecurity] SetSecurityDescriptorDacl failed. 0x%08x");
    FUN_0045fe2a(unaff_retaddr,0xc5,0x407140,pvVar7);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  local_48c = local_474;
  local_46c[0] = 0;
  local_490 = 0x1f0081;
  FUN_0041c500(local_49c,in_stack_fffffb14,pSecurityDescriptor,&local_48c,(int)&local_490,
               (int)local_46c);
  pSecurityDescriptor = local_4b8;
  in_stack_fffffb14 = 0x413306;
  BVar6 = SetSecurityDescriptorDacl(pSecurityDescriptor,1,local_49c[0],0);
  if (BVar6 == 0) goto LAB_0041351b;
  local_8._0_1_ = 3;
  FUN_0042568a((int *)&local_474);
  local_468 = (int *)((int)local_468 + 1);
  goto LAB_00413268;
}



/* Function: Catch_All@004133cd */

undefined * Catch_All_004133cd(void)

{
  undefined4 uVar1;
  int unaff_EBP;
  
  uVar1 = FUN_004239ac();
  *(undefined4 *)(unaff_EBP + -0x488) = uVar1;
  return &DAT_004133eb;
}



/* Function: FUN_00413422 */

void __fastcall FUN_00413422(uint param_1)

{
  int iVar1;
  undefined4 uVar2;
  uint unaff_EBP;
  int unaff_ESI;
  int unaff_EDI;
  undefined4 uStack0000000c;
  
  if ((int)param_1 < 0) {
    FUN_0045eec7(*(int *)(unaff_EBP + 4),0x86c,0x4049e0,param_1);
    if (*(int *)(unaff_EBP - 0x474) != 0) {
      FUN_004203a7(*(int *)(unaff_EBP - 0x474));
    }
    if (*(int *)(unaff_EBP - 0x478) != 0) {
      FUN_004203a7(*(int *)(unaff_EBP - 0x478));
    }
  }
  else {
    *(undefined4 *)(unaff_EBP - 0x4bc) = *(undefined4 *)(unaff_EBP - 0x46c);
    *(undefined4 *)(unaff_EBP - 0x4b8) = *(undefined4 *)(unaff_EBP - 0x45c);
    *(undefined2 *)(unaff_EBP - 0x4c4) = 0x41;
    iVar1 = FUN_004176b0(*(void **)(unaff_EBP - 0x484),(int *)(unaff_EBP - 0x458));
    *(int *)(unaff_EBP - 0x47c) = iVar1;
    if (-1 < iVar1) {
      uVar2 = FUN_00414560(*(void **)(unaff_EBP - 0x484),(PROPVARIANT *)(unaff_EBP - 0x4c4));
      *(undefined4 *)(unaff_EBP - 0x47c) = uVar2;
    }
    if (unaff_EDI != 0) {
      FUN_004203a7(unaff_EDI);
    }
    if (unaff_ESI != 0) {
      FUN_004203a7(unaff_ESI);
    }
  }
  ExceptionList = *(void **)(unaff_EBP - 0xc);
  uStack0000000c = 0x4134eb;
  FUN_0041e590(*(uint *)(unaff_EBP - 0x14) ^ unaff_EBP);
  return;
}



/* Function: FUN_00413555 */

void __fastcall FUN_00413555(void *param_1,int *param_2,void *param_3)

{
  code *pcVar1;
  void *this;
  undefined4 uVar2;
  int iVar3;
  undefined2 local_58 [4];
  undefined4 local_50;
  void *local_48;
  void *local_44;
  uint local_40 [6];
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined8 local_14;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_40[2] = 2;
  local_40[3] = 2;
  local_40[1] = 0;
  local_40[4] = 0;
  local_14 = 0;
  local_c = 0;
  local_40[5] = DAT_00402bac;
  local_44 = param_3;
  uStack_28 = DAT_00402bb0;
  local_40[0] = 0;
  uStack_24 = DAT_00402bb4;
  uStack_20 = DAT_00402bb8;
  pcVar1 = *(code **)(*param_2 + 0x10);
  local_1c = 1;
  local_18 = 5;
  local_48 = param_1;
  uVar2 = FUN_00428976(param_3,0x400);
  (*(code *)PTR_guard_check_icall_0046e528)(param_2,uVar2,0x400,local_40);
  iVar3 = (*pcVar1)();
  if (-1 < iVar3) {
    FUN_00418dde(local_44,local_40[0]);
    local_58[0] = 0x1f;
    local_50 = FUN_00428976(local_44,0);
    this = local_48;
    iVar3 = FUN_004176b0(local_48,(int *)(local_40 + 1));
    if (-1 < iVar3) {
      FUN_00414560(this,(PROPVARIANT *)local_58);
    }
  }
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_00413626 */

void __thiscall FUN_00413626(void *this,undefined4 param_1,PROPVARIANT *param_2,uint *param_3)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int local_3c [5];
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined8 local_14;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_3c[1] = 2;
  local_3c[2] = 2;
  local_3c[0] = 0;
  local_14 = 0;
  local_c = 0;
  local_3c[3] = 0;
  local_3c[4] = DAT_00402bac;
  uStack_28 = DAT_00402bb0;
  uStack_24 = DAT_00402bb4;
  uStack_20 = DAT_00402bb8;
  local_1c = 1;
  local_18 = 10;
  iVar2 = FUN_004176b0(this,local_3c);
  if (-1 < iVar2) {
    FUN_00414560(this,param_2);
    uVar3 = FUN_00418330((ushort *)param_2);
    uVar1 = *param_3;
    *param_3 = *param_3 + uVar3;
    param_3[1] = param_3[1] + (uint)CARRY4(uVar1,uVar3);
  }
  FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



/* Function: FUN_004136c7 */

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */

void __fastcall FUN_004136c7(void *param_1,int *param_2)

{
  void *this;
  code *pcVar1;
  int iVar2;
  int *extraout_EAX;
  int *piVar3;
  int *extraout_EAX_00;
  void *this_00;
  undefined2 local_bc4 [4];
  undefined4 local_bbc;
  undefined4 local_bb4 [3];
  undefined1 local_ba8 [4];
  void *local_ba4;
  undefined **local_ba0;
  undefined4 local_b9c;
  undefined4 local_b94 [101];
  short local_a00;
  undefined4 local_9e0;
  undefined **local_9dc [4];
  undefined1 local_9cc [388];
  int local_848 [5];
  undefined4 uStack_834;
  undefined4 uStack_830;
  undefined4 uStack_82c;
  undefined4 local_828;
  undefined4 local_824;
  undefined8 local_820;
  undefined4 local_818;
  undefined1 local_814 [2060];
  uint local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xbb4;
  local_8 = 0x4136d6;
  local_848[0] = 0;
  local_848[3] = 0;
  local_818 = 0;
  local_820 = 0;
  local_848[1] = 2;
  local_848[2] = 2;
  local_848[4] = DAT_00409b30;
  uStack_834 = DAT_00409b34;
  uStack_830 = DAT_00409b38;
  uStack_82c = DAT_00409b3c;
  local_828 = 1;
  local_824 = 4;
  local_ba4 = param_1;
  FUN_00418b0e(local_9dc);
  local_8 = 0;
  pcVar1 = *(code **)(*param_2 + 0x18);
  (*(code *)PTR_guard_check_icall_0046e528)(param_2,local_814,0x400,local_ba8);
  iVar2 = (*pcVar1)();
  this_00 = local_ba4;
  if (iVar2 == -0x7ffbf2db) {
    this = (void *)((int)local_ba4 + 0x41c);
    FUN_0040f9af((int)this,local_bb4);
    pcVar1 = (code *)local_9dc[0][4];
    (*(code *)PTR_guard_check_icall_0046e528)
              (*(int *)(extraout_EAX[2] + 4) + *extraout_EAX * 2,0,extraout_EAX[1]);
    (*pcVar1)();
    FUN_004269df(local_9dc,&DAT_00403c4c,0xffffffff);
    piVar3 = FUN_0040fde1(this,local_bb4);
    FUN_004269df(local_9dc,*(int *)(piVar3[2] + 4) + *piVar3 * 2,piVar3[1]);
  }
  else {
    if (iVar2 < 0) goto LAB_00413952;
    local_ba0 = &PTR_o__purecall_00401070;
    local_b9c = 0;
    FUN_00418b0e(local_b94);
    local_ba0 = &PTR_FUN_00401054;
    local_9e0 = 0;
    local_8 = CONCAT31(local_8._1_3_,1);
    FUN_004456af(&local_ba0,local_814);
    FUN_0041bf6e((int)&local_ba0);
    this_00 = local_ba4;
    if (local_a00 == 3) {
      iVar2 = (int)local_ba4 + 0x41c;
      FUN_0041bf6e(iVar2);
      if (*(short *)((int)this_00 + 0x5bc) == 0) {
        FUN_00425a80(local_9dc,L"file:\\\\");
      }
      else {
        FUN_0040f9af(iVar2,local_bb4);
        pcVar1 = (code *)local_9dc[0][4];
        (*(code *)PTR_guard_check_icall_0046e528)
                  (*(int *)(extraout_EAX_00[2] + 4) + *extraout_EAX_00 * 2,0,extraout_EAX_00[1]);
        (*pcVar1)();
        FUN_00425ff3(local_9dc,&DAT_00403c4c);
      }
      FUN_00425ff3(local_9dc,local_814);
    }
    else {
      FUN_00425a80(local_9dc,local_814);
      this_00 = local_ba4;
    }
    local_8 = local_8 & 0xffffff00;
    FUN_0041a518(&local_ba0);
  }
  local_bc4[0] = 0x1f;
  local_bbc = FUN_00428976(local_9dc,0);
  iVar2 = FUN_004176b0(this_00,local_848);
  if (-1 < iVar2) {
    FUN_00414560(this_00,(PROPVARIANT *)local_bc4);
  }
LAB_00413952:
  local_8 = 2;
  local_9dc[0] = &PTR_FUN_00401038;
  FUN_00427759(local_9dc,(int)local_9cc);
  FUN_00453ee6();
  return;
}



/* Function: FUN_00413983 */

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */

void __fastcall FUN_00413983(void *param_1,int *param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  int iVar3;
  void *this;
  undefined2 local_1f4 [4];
  undefined4 local_1ec;
  uint local_1e4;
  int *local_1e0;
  undefined **local_1dc [2];
  undefined4 local_1d4;
  undefined1 local_1cc [388];
  int local_48 [5];
  undefined4 uStack_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined8 local_20;
  undefined4 local_18;
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x1e4;
  local_8 = 0x413992;
  local_48[0] = 0;
  local_48[3] = 0;
  local_18 = 0;
  local_20 = 0;
  local_48[1] = 2;
  local_48[2] = 2;
  local_48[4] = DAT_00409b30;
  uStack_34 = DAT_00409b34;
  uStack_30 = DAT_00409b38;
  uStack_2c = DAT_00409b3c;
  local_28 = 1;
  local_24 = 5;
  local_1e0 = param_2;
  FUN_00418b0e(local_1dc);
  local_8 = 0;
  pcVar1 = *(code **)(*local_1e0 + 0x30);
  uVar2 = FUN_00428976(this,0);
  (*(code *)PTR_guard_check_icall_0046e528)(local_1e0,uVar2,local_1d4,&local_1e4);
  iVar3 = (*pcVar1)();
  if (iVar3 == -0x7ff8ff86) {
    pcVar1 = *(code **)(*local_1e0 + 0x30);
    uVar2 = FUN_00428976(local_1dc,local_1e4);
    (*(code *)PTR_guard_check_icall_0046e528)(local_1e0,uVar2,local_1e4,&local_1e4);
    iVar3 = (*pcVar1)();
  }
  if (-1 < iVar3) {
    FUN_0041ad32((int)local_1dc);
    local_1f4[0] = 0x1f;
    local_1ec = FUN_00428976(local_1dc,0);
    iVar3 = FUN_004176b0(param_1,local_48);
    if (-1 < iVar3) {
      FUN_00414560(param_1,(PROPVARIANT *)local_1f4);
    }
  }
  local_8 = 1;
  local_1dc[0] = &PTR_FUN_00401038;
  FUN_00427759(local_1dc,(int)local_1cc);
  FUN_00453ee6();
  return;
}



/* Function: FUN_00413ad1 */

void __thiscall FUN_00413ad1(void *this,undefined4 *param_1)

{
  FUN_00418b33(this,(int *)*param_1);
  return;
}



/* Function: FUN_00413aea */

undefined4 * __thiscall FUN_00413aea(void *this,int param_1,undefined4 *param_2)

{
  FUN_004248c8(this,0x21,(int)this + 0x10,*(short **)(param_1 + 4));
  *(undefined ***)this = &PTR_FUN_0040101c;
  *(undefined4 *)((int)this + 0x54) = *param_2;
  *(undefined4 *)((int)this + 0x58) = param_2[1];
  *(undefined4 *)((int)this + 0x5c) = param_2[2];
  *(undefined4 *)((int)this + 0x60) = param_2[3];
  *(undefined4 *)((int)this + 100) = 0;
  *(undefined4 *)((int)this + 0x68) = 0;
  *(undefined4 *)((int)this + 0x6c) = 0;
  *(undefined4 *)((int)this + 0x70) = 0;
  *(undefined4 *)((int)this + 0x74) = 0;
  *(undefined4 *)((int)this + 0x78) = 0;
  *(undefined4 *)((int)this + 0x7c) = 0;
  *(undefined4 *)((int)this + 0x80) = 0;
  return (undefined4 *)this;
}



/* Function: FUN_00413b45 */

/* WARNING: Function: __EH_prolog3 replaced with injection: EH_prolog3 */
/* WARNING: Function: __EH_epilog3 replaced with injection: EH_epilog3 */

int __thiscall FUN_00413b45(void *this,int param_1)

{
  code *pcVar1;
  int iVar2;
  void *pvVar3;
  undefined4 extraout_EDX;
  undefined4 uVar4;
  undefined4 extraout_EDX_00;
  uint uVar5;
  int iVar6;
  undefined4 unaff_retaddr;
  undefined2 *puVar7;
  uint uVar8;
  int local_1c;
  int *local_18;
  undefined2 *local_14 [3];
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xc;
  iVar6 = 0;
  local_18 = (int *)0x0;
  local_14[0] = (undefined2 *)0x0;
  local_8 = 1;
  uVar5 = 0;
  iVar2 = Ordinal_200(0,&local_18);
  if (iVar2 == 0) {
    FUN_0043d0d0(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrsink.cxx",0x227,
                 L"[SrchFilterDaemon] FLTRDMN: Got an Error Info - now grabbing it");
    pcVar1 = *(code **)(*local_18 + 0x14);
    (*(code *)PTR_guard_check_icall_0046e528)(local_18,local_14);
    iVar2 = (*pcVar1)();
    if (iVar2 < 0) {
      FUN_0043731b(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrsink.cxx",0x22c,
                   L"[SrchFilterDaemon] FLTRDMN: Could not retrieve error description 0x%08x");
    }
    else {
      FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrsink.cxx",0x230,
                   L"[SrchFilterDaemon] FLTRDMN: Errorinfo is \"%ls\"");
      uVar5 = Ordinal_7(local_14[0]);
      if (1000 < uVar5) {
        uVar5 = 1000;
      }
    }
  }
  FUN_00418860((undefined4 *)((int)this + 0x9b8));
  local_1c = 2;
  uVar4 = extraout_EDX;
  do {
    if ((-1 < iVar6) && (iVar6 = FUN_00417420(this,uVar4,param_1,5), -1 < iVar6)) {
      puVar7 = local_14[0];
      uVar8 = uVar5;
      if (uVar5 == 0) {
        puVar7 = &DAT_0040352c;
        uVar8 = 0;
      }
      iVar6 = FUN_0043cf82(this,puVar7,uVar8);
    }
    FUN_00417f40((undefined4 *)((int)this + 0x9b8));
    local_1c = local_1c + -1;
    uVar4 = extraout_EDX_00;
  } while (local_1c != 0);
  if (param_1 == -0x7ff8fff2) {
    pvVar3 = (void *)FUN_0045a8e2(0x8007000e);
    FUN_0045fe0e(unaff_retaddr,600,0x4065a0,pvVar3);
    pcVar1 = (code *)swi(3);
    iVar2 = (*pcVar1)();
    return iVar2;
  }
  Ordinal_6(local_14[0]);
  local_8 = 2;
  if (local_18 != (int *)0x0) {
    pcVar1 = *(code **)(*local_18 + 8);
    (*(code *)PTR_guard_check_icall_0046e528)(local_18);
    (*pcVar1)();
  }
  return iVar6;
}



/* Function: FUN_00413cae */

undefined4 * __fastcall FUN_00413cae(undefined4 *param_1)

{
  undefined4 *puVar1;
  
  FUN_00418305(param_1);
  FUN_00418305(param_1 + 0x15);
  FUN_00418b0e(param_1 + 0x2a);
  param_1[0x8f] = 0;
  param_1[0x94] = 0;
  puVar1 = param_1 + 0x92;
  *puVar1 = puVar1;
  param_1[0x91] = puVar1;
  param_1[0x93] = param_1 + 0x91;
  param_1[0x90] = &PTR__scalar_deleting_destructor__0040108c;
  return param_1;
}



/* Function: FUN_00413d00 */

/* WARNING: Function: __EH_prolog3_catch_GS replaced with injection: EH_prolog3 */

void __thiscall FUN_00413d00(void *this,void *param_1)

{
  code *pcVar1;
  int iVar2;
  LPCWSTR pWVar3;
  void *extraout_ECX;
  int iVar4;
  DWORD DVar5;
  DWORD DVar6;
  undefined4 unaff_retaddr;
  undefined4 local_304 [40];
  undefined4 local_264 [40];
  undefined4 local_1c4 [40];
  undefined **local_124;
  LPCOLESTR local_120;
  undefined1 local_114 [68];
  undefined **local_d0;
  LPCWSTR local_cc;
  undefined1 local_c0 [68];
  undefined **local_7c;
  LPCWSTR local_78;
  undefined1 local_6c [68];
  CLSID local_28 [2];
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x2f8;
  local_8 = 0;
  FUN_00443a1f(local_1c4,*(HKEY *)((int)this + 4),*(LPCWSTR *)((int)this + 8));
  iVar4 = 0;
  FUN_00418305(&local_d0);
  local_8._0_1_ = 2;
  DVar6 = 0;
  while( true ) {
    iVar2 = FUN_00418950(local_1c4,DVar6,&local_d0);
    if (iVar2 == 0) break;
    FUN_00443ac1(local_264,(int)local_1c4,local_cc,0x20019);
    FUN_00418305(&local_7c);
    local_8._0_1_ = 4;
    DVar5 = 0;
    while( true ) {
      iVar2 = FUN_00418950(local_264,DVar5,&local_7c);
      if (iVar2 == 0) break;
      FUN_00443ac1(local_304,(int)local_264,local_78,0x20019);
      FUN_00418305(&local_124);
      local_8 = CONCAT31(local_8._1_3_,6);
      iVar2 = FUN_00443eab(local_304,L"ProgID",extraout_ECX);
      if (iVar2 != 0) {
        iVar2 = FUN_00440e9c(local_120,local_28);
        if (-1 < iVar2) {
          iVar2 = FUN_0044037f(param_1,&local_d0,local_28);
          if (-1 < iVar2) {
            iVar4 = iVar4 + 1;
          }
        }
      }
      local_8._0_1_ = 7;
      local_124 = &PTR_FUN_0040101c;
      FUN_00427759(&local_124,(int)local_114);
      local_124 = &PTR_o__purecall_004011dc;
      local_8._0_1_ = 4;
      FUN_00418c23(local_304);
      DVar5 = DVar5 + 1;
    }
    local_8._0_1_ = 8;
    local_7c = &PTR_FUN_0040101c;
    FUN_00427759(&local_7c,(int)local_6c);
    local_7c = &PTR_o__purecall_004011dc;
    local_8._0_1_ = 2;
    FUN_00418c23(local_264);
    DVar6 = DVar6 + 1;
  }
  DVar6 = 0;
  while( true ) {
    iVar2 = FUN_00419500(local_1c4,DVar6,&local_d0);
    if (iVar2 == 0) break;
    FUN_00418305(&local_7c);
    local_8 = CONCAT31(local_8._1_3_,9);
    pWVar3 = (LPCWSTR)FUN_00428976(&local_d0,0);
    iVar2 = FUN_00443eab(local_1c4,pWVar3,&local_7c);
    if (iVar2 != 0) {
      iVar2 = FUN_00440e9c(local_78,local_28);
      if (-1 < iVar2) {
        iVar2 = FUN_0044037f(param_1,&local_d0,local_28);
        if (-1 < iVar2) {
          iVar4 = iVar4 + 1;
        }
      }
    }
    local_8._0_1_ = 10;
    local_7c = &PTR_FUN_0040101c;
    FUN_00427759(&local_7c,(int)local_6c);
    local_8._0_1_ = 2;
    DVar6 = DVar6 + 1;
  }
  if (iVar4 != 0) {
    local_8 = CONCAT31(local_8._1_3_,0xb);
    local_d0 = &PTR_FUN_0040101c;
    FUN_00427759(&local_d0,(int)local_c0);
    local_d0 = &PTR_o__purecall_004011dc;
    FUN_00418c23(local_1c4);
    FUN_00413f77();
    return;
  }
  FUN_0045fe0e(unaff_retaddr,0xd3,0x406c80,(void *)0x80040d37);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



/* Function: Catch_All@00413f53 */

undefined * Catch_All_00413f53(void)

{
  undefined4 uVar1;
  int unaff_EBP;
  
  uVar1 = FUN_004239ac();
  *(undefined4 *)(unaff_EBP + -0x304) = uVar1;
  return &DAT_00413f71;
}



/* Function: FUN_00413f77 */

void FUN_00413f77(void)

{
  FUN_00453efb();
  return;
}



/* Function: FUN_00413f9a */

undefined4 __fastcall FUN_00413f9a(void *param_1)

{
  bool bVar1;
  undefined3 extraout_var;
  
  if (*(int *)((int)param_1 + 0x10) == DAT_0040321c) {
    bVar1 = FUN_004188dc(param_1,&DAT_0040320c);
    if (CONCAT31(extraout_var,bVar1) != 0) {
      return 1;
    }
  }
  return 0;
}



/* Function: FUN_00413fc0 */

void __fastcall
FUN_00413fc0(void *param_1,undefined8 *param_2,PROPVARIANT *param_3,uint *param_4,uint *param_5)

{
  uint uVar1;
  void *this;
  bool bVar2;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  int iVar3;
  DWORD DVar4;
  uint uVar5;
  ulonglong uVar6;
  void *local_64;
  uint *local_60;
  int local_5c [4];
  undefined8 local_4c;
  undefined8 local_44;
  undefined4 local_3c;
  int iStack_38;
  undefined8 local_34;
  undefined4 local_2c;
  undefined1 auStack_28 [24];
  DWORD DStack_10;
  uint local_c;
  
  local_c = DAT_0046bd40 ^ (uint)&local_64;
  local_60 = param_4;
  local_5c[0] = 0;
  local_4c = 0;
  local_44 = 0;
  local_34 = 0;
  local_2c = 0;
  local_5c[1] = 2;
  local_5c[2] = 2;
  local_3c = 1;
  local_64 = param_1;
  local_5c[3] = GetSystemDefaultLCID();
  iVar3 = *(int *)(param_2 + 2);
  if (((iVar3 == DAT_004030bc) &&
      (bVar2 = FUN_004188dc(param_2,&DAT_004030ac), CONCAT31(extraout_var,bVar2) != 0)) ||
     ((iVar3 == DAT_0040310c &&
      (bVar2 = FUN_004188dc(param_2,&DAT_004030fc), CONCAT31(extraout_var_00,bVar2) != 0)))) {
    local_5c[3] = 0;
  }
  local_4c = *param_2;
  local_44 = param_2[1];
  iStack_38 = iVar3;
  uVar6 = FUN_00414170((ushort *)param_3,(int *)&local_4c,1);
  if (((int)uVar6 != 0) &&
     ((*(short *)param_3 != 3 || (iVar3 = FUN_0040fd9d((ushort *)param_3), -1 < iVar3)))) {
    DVar4 = FUN_00417f70(param_3);
    if ((int)DVar4 < 0) {
      DStack_10 = DVar4;
      FUN_00425d0f(auStack_28);
      FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x17b5,
                   L"[SrchFilterDaemon] PropvarCvt::PropVariantConvertStrToWStr failed with %ws, PROPVARIANT is being ignored"
                  );
      PropVariantClear(param_3);
    }
    this = local_64;
    iVar3 = FUN_004176b0(local_64,local_5c);
    if (-1 < iVar3) {
      FUN_00414560(this,param_3);
      uVar5 = FUN_00418330((ushort *)param_3);
      uVar1 = *local_60;
      *local_60 = *local_60 + uVar5;
      local_60[1] = local_60[1] + (uint)CARRY4(uVar1,uVar5);
      if ((param_5[1] <= local_60[1]) && ((param_5[1] < local_60[1] || (*param_5 <= *local_60)))) {
        FUN_0041e590(local_c ^ (uint)&local_64);
        return;
      }
      FUN_0041e590(local_c ^ (uint)&local_64);
      return;
    }
  }
  FUN_0041e590(local_c ^ (uint)&local_64);
  return;
}



/* Function: FUN_00414170 */

ulonglong __fastcall FUN_00414170(ushort *param_1,int *param_2,int param_3)

{
  ushort uVar1;
  bool bVar2;
  ushort uVar3;
  undefined4 uVar4;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  int iVar5;
  undefined3 extraout_var_01;
  int *piVar6;
  undefined3 extraout_var_02;
  int *piVar7;
  int extraout_ECX;
  uint *puVar8;
  uint extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  int *extraout_EDX_03;
  int *extraout_EDX_04;
  int *extraout_EDX_05;
  uint uVar9;
  
  if (((((*param_2 != DAT_00403220) || (param_2[1] != DAT_00403224)) || (param_2[2] != DAT_00403228)
       ) || ((param_2[3] != DAT_0040322c || (param_2[4] != 1)))) || (param_2[5] != 0x11)) {
    if (((param_3 == 0) || (*param_2 != -0x48da0ed0)) ||
       ((param_2[1] != 0x101a47ef ||
        (((param_2[2] != 0x6002f1a5 || (param_2[3] != -0x53146174)) || (param_2[4] != 1)))))) {
      if ((param_2[4] == 0) &&
         (((short *)param_2[5] == (short *)0x0 || (*(short *)param_2[5] == 0)))) {
        FUN_0042e4e1(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x232
                     ,
                     L"[SrchFilterDaemon] pfps->psProperty.ulKind is LPWSTR but psProperty.lpwstr is NULL or empty"
                    );
        return (ulonglong)extraout_EDX << 0x20;
      }
    }
    else {
      iVar5 = param_2[5];
      if (((iVar5 == 0xc) || (iVar5 == 0xd)) ||
         ((iVar5 == 0xe || (((iVar5 == 0xf || (iVar5 == 0x10)) || (iVar5 == 0x11))))))
      goto switchD_004142a8_caseD_0;
    }
    uVar1 = *param_1;
    piVar7 = (int *)(uint)uVar1;
    if ((((uVar1 & 0x2000) == 0) && (uVar3 = uVar1 & 0xfff, uVar3 != 0x43)) &&
       ((uVar3 != 0x42 && ((uVar3 != 0x45 && (uVar3 != 0x44)))))) {
      param_2 = piVar7;
      switch(piVar7) {
      case (int *)0x0:
        break;
      default:
        param_2 = (int *)(((uint)piVar7 & 0xfff) - 8);
        switch((uint)piVar7 & 0xfff) {
        case 8:
          if (((uVar1 & 0x1000) != 0) && (uVar9 = 0, *(int *)(param_1 + 4) != 0)) {
            while (bVar2 = FUN_00433067(*(undefined4 *)(*(int *)(param_1 + 6) + uVar9 * 4)),
                  param_2 = extraout_EDX_04, CONCAT31(extraout_var_01,bVar2) == 0) {
              uVar9 = uVar9 + 1;
              if (*(uint *)(param_1 + 4) <= uVar9) {
                return ZEXT48(extraout_EDX_04) << 0x20;
              }
            }
            goto switchD_00414342_caseD_9;
          }
          break;
        default:
switchD_00414342_caseD_9:
          return CONCAT44(param_2,1);
        case 0x1e:
          if ((uVar1 & 0x1000) != 0) {
            param_2 = *(int **)(param_1 + 4);
            piVar7 = (int *)0x0;
            if (param_2 != (int *)0x0) {
              piVar6 = *(int **)(param_1 + 6);
              while (*piVar6 == 0) {
                piVar7 = (int *)((int)piVar7 + 1);
                piVar6 = piVar6 + 1;
                if (param_2 <= piVar7) {
                  return ZEXT48(param_2) << 0x20;
                }
              }
              goto switchD_00414342_caseD_9;
            }
          }
          break;
        case 0x1f:
          if ((uVar1 & 0x1000) != 0) {
            uVar9 = *(uint *)(param_1 + 4);
            param_2 = (int *)0x0;
            if (uVar9 != 0) {
              piVar7 = *(int **)(param_1 + 6);
              while (bVar2 = FUN_0043307d(*piVar7), param_2 = extraout_EDX_05,
                    CONCAT31(extraout_var_02,bVar2) == 0) {
                piVar7 = piVar7 + 1;
                if (uVar9 <= (int)extraout_EDX_05 + 1U) {
                  return (ulonglong)((int)extraout_EDX_05 + 1U) << 0x20;
                }
              }
              goto switchD_00414342_caseD_9;
            }
          }
          break;
        case 0x47:
          if ((uVar1 & 0x1000) != 0) {
            uVar9 = *(uint *)(param_1 + 4);
            param_2 = (int *)0x0;
            if (uVar9 != 0) {
              puVar8 = *(uint **)(param_1 + 6);
              while (iVar5 = FUN_0045f606(puVar8), param_2 = extraout_EDX_03, iVar5 == 0) {
                puVar8 = (uint *)(extraout_ECX + 0xc);
                if (uVar9 <= (int)extraout_EDX_03 + 1U) {
                  return (ulonglong)((int)extraout_EDX_03 + 1U) << 0x20;
                }
              }
              goto switchD_00414342_caseD_9;
            }
          }
        }
        break;
      case (int *)0x8:
        bVar2 = FUN_00433067(*(undefined4 *)(param_1 + 4));
        return CONCAT44(extraout_EDX_01,CONCAT31(extraout_var,bVar2));
      case (int *)0x1e:
        return (ulonglong)CONCAT24(uVar1,(uint)(*(int *)(param_1 + 4) != 0));
      case (int *)0x1f:
        bVar2 = FUN_0043307d(*(int *)(param_1 + 4));
        return CONCAT44(extraout_EDX_02,CONCAT31(extraout_var_00,bVar2));
      case (int *)0x47:
        uVar4 = FUN_0045f606(*(uint **)(param_1 + 4));
        return CONCAT44(extraout_EDX_00,uVar4);
      }
    }
  }
switchD_004142a8_caseD_0:
  return ZEXT48(param_2) << 0x20;
}



/* Function: FUN_00414500 */

undefined4 __fastcall FUN_00414500(int param_1,int param_2,undefined4 param_3,int *param_4)

{
  bool bVar1;
  undefined3 extraout_var;
  undefined4 uVar2;
  
  uVar2 = 0;
  bVar1 = FUN_00417340(param_2,param_1,param_4);
  if (CONCAT31(extraout_var,bVar1) != 0) {
    FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrdaemon.cxx",0x1636,
                 L"[SrchPHFile] Oplock broken\n");
    return 0x80070020;
  }
  if (*(int *)(param_1 + 0x14) != 0) {
    uVar2 = 0x80040d23;
  }
  return uVar2;
}



/* Function: FUN_00414560 */

void __thiscall FUN_00414560(void *this,PROPVARIANT *param_1)

{
  code *pcVar1;
  DWORD DVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  undefined4 unaff_retaddr;
  uint local_38;
  uint local_34;
  PROPVARIANT *local_30;
  int local_2c;
  uint local_28;
  undefined1 local_24 [8];
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  int local_10;
  DWORD local_c;
  uint local_8;
  
  local_8 = DAT_0046bd40 ^ (uint)&stack0xfffffffc;
  local_30 = param_1;
  switch(*(ushort *)param_1 & 0xfff) {
  case 0:
  case 1:
  case 2:
  case 3:
  case 4:
  case 5:
  case 6:
  case 7:
  case 8:
  case 10:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0x10:
  case 0x11:
  case 0x12:
  case 0x13:
  case 0x14:
  case 0x15:
  case 0x16:
  case 0x17:
  case 0x1e:
  case 0x1f:
  case 0x40:
  case 0x41:
  case 0x42:
  case 0x43:
  case 0x44:
  case 0x45:
  case 0x46:
  case 0x47:
  case 0x48:
    break;
  default:
    *(undefined2 *)param_1 = 0;
  }
  DVar2 = FUN_00417f70(param_1);
  if ((int)DVar2 < 0) {
    local_c = DVar2;
    FUN_00425d0f(local_24);
    FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrsink.cxx",0x198,
                 L"[SrchFilterDaemon] PropvarCvt::PropVariantConvertStrToWStr failed with %ws, PROPVARIANT is being ignored"
                );
    PropVariantClear(param_1);
    *(undefined2 *)param_1 = 0;
  }
  else if ((*(short *)param_1 == 0x1f) && (*(int *)(param_1 + 8) == 0)) {
    *(undefined2 **)(param_1 + 8) = &DAT_0040352c;
  }
  local_28 = 0;
  if (*(int *)((int)this + 0x9c4) == 0) {
    *(undefined4 *)((int)this + 0x9c0) = 0;
    *(undefined4 *)((int)this + 0x9bc) = *(undefined4 *)((int)this + 0x9b8);
    *(undefined4 *)((int)this + 0x9b8) = 0;
    *(undefined4 *)((int)this + 0x9c4) = 1;
  }
  uVar5 = 0;
  local_2c = 2;
  do {
    if (-1 < (int)uVar5) {
      local_10 = *(int *)((int)this + 0x990);
      *(int *)((int)this + 0x990) = local_10 + 1;
      local_c = 0;
      local_1c = 0x52485447;
      local_18 = 0;
      local_14 = 2;
      if (*(int *)((int)this + 0x9c0) == 0) {
        iVar3 = *(int *)((int)this + 0x9b8);
      }
      else {
        *(undefined4 *)((int)this + 0x9b8) = 0;
        pcVar1 = *(code **)(**(int **)((int)this + 0x9c8) + 4);
        local_34 = local_28;
        (*(code *)PTR_guard_check_icall_0046e528)(&local_34,4,0);
        uVar5 = (*pcVar1)();
        if ((int)uVar5 < 0) {
          FUN_00437dfd(unaff_retaddr,0x7b,
                       "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx"
                       ,uVar5);
          uVar4 = 0xe0;
LAB_0041477e:
          FUN_00437dfd(unaff_retaddr,uVar4,
                       "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx"
                       ,uVar5);
        }
        else {
          uVar5 = 0;
          *(int *)((int)this + 0x9b8) = *(int *)((int)this + 0x9b8) + 4;
          local_38 = ~local_28;
          local_28 = (*(int *)((int)this + 0x9b8) + 3U & 0xfffffffc) - *(int *)((int)this + 0x9b8);
          if ((local_28 != 0) && (*(int *)((int)this + 0x9c0) != 0)) {
            pcVar1 = *(code **)(**(int **)((int)this + 0x9c8) + 4);
            (*(code *)PTR_guard_check_icall_0046e528)(s_padpadpa_0046bde4,local_28,0);
            uVar5 = (*pcVar1)();
            if (-1 < (int)uVar5) goto LAB_00414721;
            FUN_00437dfd(unaff_retaddr,0x72,
                         "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx"
                         ,uVar5);
LAB_00414778:
            uVar4 = 0xe4;
            goto LAB_0041477e;
          }
LAB_00414721:
          *(int *)((int)this + 0x9b8) = *(int *)((int)this + 0x9b8) + local_28;
          if (*(int *)((int)this + 0x9c0) == 0) {
            if ((int)uVar5 < 0) goto LAB_00414778;
          }
          else {
            pcVar1 = *(code **)(**(int **)((int)this + 0x9c8) + 4);
            (*(code *)PTR_guard_check_icall_0046e528)(&local_38,4,0);
            uVar5 = (*pcVar1)();
            if ((int)uVar5 < 0) {
              FUN_00437dfd(unaff_retaddr,0x7b,
                           "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx"
                           ,uVar5);
              goto LAB_00414778;
            }
          }
        }
        iVar3 = 0;
        *(undefined4 *)((int)this + 0x9b8) = 0;
        param_1 = local_30;
        if ((int)uVar5 < 0) goto LAB_00414862;
      }
      local_28 = (iVar3 + 7U & 0xfffffff8) - iVar3;
      if ((local_28 != 0) && (*(int *)((int)this + 0x9c0) != 0)) {
        pcVar1 = *(code **)(**(int **)((int)this + 0x9c8) + 4);
        (*(code *)PTR_guard_check_icall_0046e528)(s_padpadpa_0046bde4,local_28,0);
        uVar5 = (*pcVar1)();
        if ((int)uVar5 < 0) {
          FUN_00437dfd(unaff_retaddr,0xf2,
                       "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx"
                       ,uVar5);
          param_1 = local_30;
          goto LAB_00414862;
        }
      }
      *(int *)((int)this + 0x9b8) = *(int *)((int)this + 0x9b8) + local_28;
      if (*(int *)((int)this + 0x9c0) != 0) {
        pcVar1 = *(code **)(**(int **)((int)this + 0x9c8) + 4);
        (*(code *)PTR_guard_check_icall_0046e528)(&local_1c,0x14,0);
        uVar5 = (*pcVar1)();
        if ((int)uVar5 < 0) {
          FUN_00437dfd(unaff_retaddr,0xfd,
                       "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx"
                       ,uVar5);
          param_1 = local_30;
          goto LAB_00414862;
        }
      }
      param_1 = local_30;
      *(int *)((int)this + 0x9b8) = *(int *)((int)this + 0x9b8) + 0x14;
      uVar5 = FUN_00414930(this,(ushort *)local_30);
    }
LAB_00414862:
    local_28 = *(uint *)((int)this + 0x9b8);
    if (*(int *)((int)this + 0x9c4) != 0) {
      *(undefined4 *)((int)this + 0x9b8) = *(undefined4 *)((int)this + 0x9bc);
      *(undefined4 *)((int)this + 0x9c0) = 1;
      *(undefined4 *)((int)this + 0x9bc) = 0;
      *(undefined4 *)((int)this + 0x9c4) = 0;
    }
    local_2c = local_2c + -1;
    if (local_2c == 0) {
      if ((*(short *)param_1 == 0x1f) && (*(undefined2 **)(param_1 + 8) == &DAT_0040352c)) {
        *(undefined4 *)(param_1 + 8) = 0;
      }
      FUN_0041e590(local_8 ^ (uint)&stack0xfffffffc);
      return;
    }
  } while( true );
}



/* Function: FUN_00414930 */

uint __thiscall FUN_00414930(void *this,ushort *param_1)

{
  int *this_00;
  code *pcVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  bool bVar5;
  undefined4 unaff_retaddr;
  int iVar6;
  undefined4 uVar7;
  int local_3c;
  int local_38;
  uint local_34;
  undefined4 local_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined8 local_20;
  
  if (param_1 == (ushort *)0x0) {
    return 0x80004003;
  }
  uVar2 = *param_1;
  switch(uVar2 & 0xfff) {
  case 0x42:
  case 0x43:
  case 0x44:
  case 0x45:
  case 0x46:
  case 0x49:
    return 0x80040d13;
  }
  if (uVar2 == 0x1041) {
    return 0x80040d13;
  }
  if (uVar2 == 0x1048) {
    return 0x80040d13;
  }
  bVar5 = (uVar2 & 0xfff) == 8;
  if (bVar5) {
    *param_1 = uVar2 & 0xf01f | 0x1f;
  }
  this_00 = (int *)((int)this + 0x9b8);
  uVar3 = 0;
  iVar4 = (*(int *)((int)this + 0x9b8) + 7U & 0xfffffff8) - *(int *)((int)this + 0x9b8);
  if ((iVar4 != 0) && (*(int *)((int)this + 0x9c0) != 0)) {
    pcVar1 = *(code **)(**(int **)((int)this + 0x9c8) + 4);
    (*(code *)PTR_guard_check_icall_0046e528)(s_padpadpa_0046bde4,iVar4,0);
    uVar3 = (*pcVar1)();
    if ((int)uVar3 < 0) {
      FUN_00437dfd(unaff_retaddr,0x122,
                   "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx",
                   uVar3);
      return uVar3;
    }
  }
  *this_00 = *this_00 + iVar4;
  if (*(int *)((int)this + 0x9c0) == 0) {
    if ((int)uVar3 < 0) {
      return uVar3;
    }
  }
  else if (*(int *)((int)this + 0x9d0) == 0) {
    pcVar1 = *(code **)(**(int **)((int)this + 0x9c8) + 4);
    (*(code *)PTR_guard_check_icall_0046e528)(param_1,0x10,0);
    uVar3 = (*pcVar1)();
    if ((int)uVar3 < 0) {
      FUN_00437dfd(unaff_retaddr,0x138,
                   "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx",
                   uVar3);
      return uVar3;
    }
  }
  else {
    local_20 = 0;
    local_30 = *(undefined4 *)param_1;
    uStack_2c = *(undefined4 *)(param_1 + 2);
    uStack_28 = *(undefined4 *)(param_1 + 4);
    uStack_24 = *(undefined4 *)(param_1 + 6);
    pcVar1 = *(code **)(**(int **)((int)this + 0x9c8) + 4);
    (*(code *)PTR_guard_check_icall_0046e528)(&local_30,0x18);
    uVar3 = (*pcVar1)();
    if ((int)uVar3 < 0) {
      FUN_00437dfd(unaff_retaddr,0x133,
                   "onecoreuap\\base\\appmodel\\search\\mssrch\\gather\\pipeserdeser\\pipeser.cxx",
                   uVar3);
      return uVar3;
    }
  }
  if (*(int *)((int)this + 0x9d0) == 0) {
    iVar4 = *this_00 + 0x10;
  }
  else {
    iVar4 = *this_00 + 0x18;
  }
  *this_00 = iVar4;
  if ((int)uVar3 < 0) {
    return uVar3;
  }
  switch(*param_1) {
  case 0x1e:
    uVar7 = 0x4b5;
    goto LAB_00414bb5;
  case 0x1f:
    uVar3 = FUN_0043cfbc(this,*(short **)(param_1 + 4));
    goto LAB_00414b69;
  case 0x41:
    iVar4 = *(int *)(param_1 + 6);
    iVar6 = *(int *)(param_1 + 4);
    goto LAB_00414b64;
  case 0x47:
    uVar3 = FUN_004173b0(this_00,0xc,*(undefined4 *)(param_1 + 4));
    if ((int)uVar3 < 0) goto LAB_00414d37;
    iVar6 = **(int **)(param_1 + 4) + -4;
    if (iVar6 != 0) {
      iVar4 = (*(int **)(param_1 + 4))[2];
      goto LAB_00414b64;
    }
    break;
  case 0x48:
    iVar4 = *(int *)(param_1 + 4);
    iVar6 = 0x10;
LAB_00414b64:
    uVar3 = FUN_004173b0(this_00,iVar6,iVar4);
LAB_00414b69:
    if ((int)uVar3 < 0) goto LAB_00414d37;
  }
  if ((*param_1 & 0x1000) != 0) {
    uVar2 = *param_1 & 0xfff;
    switch(uVar2) {
    case 0xc:
      local_34 = 0;
      if (*(int *)(param_1 + 4) != 0) {
        local_3c = 0;
        do {
          if ((int)uVar3 < 0) break;
          uVar3 = FUN_00414930(this,(ushort *)(*(int *)(param_1 + 6) + local_3c));
          local_3c = local_3c + 0x10;
          local_34 = local_34 + 1;
        } while (local_34 < *(uint *)(param_1 + 4));
      }
      break;
    default:
      switch(uVar2) {
      case 2:
      case 0xb:
      case 0x12:
        iVar4 = 2;
        break;
      case 3:
      case 4:
      case 10:
      case 0x13:
      case 0x16:
      case 0x17:
        iVar4 = 4;
        break;
      case 5:
      case 6:
      case 7:
      case 0x14:
      case 0x15:
      case 0x40:
        iVar4 = 8;
        break;
      default:
        FUN_004285d3(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrsink.cxx",0x532,
                     L"[SrchFilterDaemon] Unhandled vt in CFilterSink::PutVariant, %lu");
        iVar4 = 0;
        break;
      case 0xe:
      case 0x48:
        iVar4 = 0x10;
        break;
      case 0x10:
      case 0x11:
        iVar4 = 1;
      }
      uVar3 = FUN_004173b0(this_00,*(int *)(param_1 + 4) * iVar4,*(undefined4 *)(param_1 + 6));
      break;
    case 0x1e:
      uVar7 = 0x4d4;
LAB_00414bb5:
      FUN_0043cd5c(L"onecoreuap\\base\\appmodel\\search\\searchprotocolhost\\fltrsink.cxx",uVar7,
                   L"[SrchFilterDaemon] No LPSTR should be here!! E_UNEXPECTED");
      uVar3 = 0x8000ffff;
      break;
    case 0x1f:
      local_34 = 0;
      if (*(int *)(param_1 + 4) != 0) {
        do {
          if ((int)uVar3 < 0) break;
          uVar3 = FUN_0043cfbc(this,*(short **)(*(int *)(param_1 + 6) + local_34 * 4));
          local_34 = local_34 + 1;
        } while (local_34 < *(uint *)(param_1 + 4));
      }
      break;
    case 0x47:
      uVar3 = FUN_004173b0(this_00,*(int *)(param_1 + 4) * 0xc,*(undefined4 *)(param_1 + 6));
      if ((-1 < (int)uVar3) && (local_34 = 0, *(int *)(param_1 + 4) != 0)) {
        local_38 = 0;
        do {
          if ((int)uVar3 < 0) break;
          uVar3 = FUN_004173b0(this_00,*(int *)(*(int *)(param_1 + 6) + local_38),
                               *(undefined4 *)(*(int *)(param_1 + 6) + 8 + local_38));
          local_38 = local_38 + 0xc;
          local_34 = local_34 + 1;
        } while (local_34 < *(uint *)(param_1 + 4));
      }
    }
  }
LAB_00414d37:
  if (bVar5) {
    *param_1 = *param_1 & 0xf008 | 8;
  }
  return uVar3;
}



/* Function: FUN_00414e80 */
