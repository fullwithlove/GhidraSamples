/* Function: FUN_00401000 */

LRESULT FUN_00401000(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  int iVar1;
  LONG LVar2;
  LRESULT LVar3;
  HDC hDC;
  HBRUSH hbr;
  HFONT h;
  HGDIOBJ h_00;
  int iVar4;
  tagPAINTSTRUCT local_60;
  tagRECT local_20;
  LOGBRUSH local_10;
  
  iVar1 = DAT_0042a250;
  if (param_2 == 0xf) {
    hDC = BeginPaint(param_1,&local_60);
    local_10.lbStyle = 0;
    GetClientRect(param_1,&local_20);
    LVar2 = local_20.bottom;
    local_20.bottom = 0;
    for (; local_20.top < LVar2; local_20.top = local_20.top + 4) {
      iVar4 = LVar2 - local_20.top;
      local_10.lbColor =
           (uint)CONCAT11((char)((int)((uint)*(byte *)(iVar1 + 0x52) * iVar4 +
                                      (uint)*(byte *)(iVar1 + 0x56) * local_20.top) / LVar2),
                          (char)((int)((uint)*(byte *)(iVar1 + 0x51) * iVar4 +
                                      (uint)*(byte *)(iVar1 + 0x55) * local_20.top) / LVar2)) << 8 |
           (int)((uint)*(byte *)(iVar1 + 0x50) * iVar4 +
                (uint)*(byte *)(iVar1 + 0x54) * local_20.top) / LVar2 & 0xffU;
      hbr = CreateBrushIndirect(&local_10);
      local_20.bottom = local_20.bottom + 4;
      FillRect(hDC,&local_20,hbr);
      DeleteObject(hbr);
    }
    if (*(int *)(iVar1 + 0x58) != -1) {
      h = CreateFontIndirectW(*(LOGFONTW **)(iVar1 + 0x34));
      if (h != (HFONT)0x0) {
        local_20.left = 0x10;
        local_20.top = 8;
        SetBkMode(hDC,1);
        SetTextColor(hDC,*(COLORREF *)(iVar1 + 0x58));
        h_00 = SelectObject(hDC,h);
        DrawTextW(hDC,(LPCWSTR)&DAT_00429240,-1,&local_20,0x820);
        SelectObject(hDC,h_00);
        DeleteObject(h);
      }
    }
    EndPaint(param_1,&local_60);
    LVar3 = 0;
  }
  else {
    if (param_2 == 0x46) {
      *(uint *)(param_4 + 0x18) = *(uint *)(param_4 + 0x18) | 0x10;
      *(undefined4 *)(param_4 + 4) = DAT_0042a248;
    }
    LVar3 = DefWindowProcW(param_1,param_2,param_3,param_4);
  }
  return LVar3;
}



/* Function: FUN_0040117d */

void FUN_0040117d(int param_1)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  
  uVar1 = *(uint *)(param_1 * 0x818 + 8 + DAT_0042a268);
  if ((uVar1 & 2) != 0) {
    uVar4 = param_1 + 1;
    if (uVar4 < DAT_0042a26c) {
      puVar3 = (uint *)(uVar4 * 0x818 + 8 + DAT_0042a268);
      iVar5 = 0;
      do {
        uVar2 = *puVar3;
        if ((uVar2 & 2) == 0) {
          if ((uVar2 & 4) == 0) {
            iVar6 = iVar5;
            if ((uVar2 & 0x10) == 0) {
              *puVar3 = (uVar2 ^ uVar1) & 1 ^ uVar2;
            }
          }
          else {
            iVar6 = iVar5 + -1;
            if (iVar5 == 0) {
              return;
            }
          }
        }
        else {
          iVar6 = iVar5 + 1;
        }
        uVar4 = uVar4 + 1;
        puVar3 = puVar3 + 0x206;
        iVar5 = iVar6;
      } while (uVar4 < DAT_0042a26c);
    }
  }
  return;
}



/* Function: FUN_004011ef */

uint FUN_004011ef(uint param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int local_c;
  int local_8;
  
  iVar2 = DAT_0042a268;
  iVar5 = param_1 * 0x818 + DAT_0042a268;
  local_8 = 0;
  local_c = 0;
  if (((*(uint *)(iVar5 + 8) & 2) != 0) && (param_2 != 0)) {
    param_1 = param_1 + 1;
    *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) & 0xffffffbe;
  }
  if (param_1 < DAT_0042a26c) {
    do {
      puVar1 = (uint *)(param_1 * 0x818 + 8 + iVar2);
      uVar3 = param_1 + 1;
      uVar4 = *puVar1;
      if ((uVar4 & 2) != 0) {
        uVar3 = FUN_004011ef(param_1,1);
        uVar4 = *puVar1;
      }
      if ((uVar4 & 4) != 0) {
        if (local_8 == 0) {
          return uVar3;
        }
        if (local_c != 0) {
          *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) | 0x40;
          return uVar3;
        }
        *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) & 0xffffff7f | 1;
        return uVar3;
      }
      if ((uVar4 & 0x40) != 0) {
        local_8 = local_8 + 1;
      }
      if ((uVar4 & 1) == 0) {
        local_c = local_c + 1;
      }
      else {
        local_8 = local_8 + 1;
      }
      param_1 = uVar3;
    } while (uVar3 < DAT_0042a26c);
  }
  return 0;
}



/* Function: FUN_00401299 */

void FUN_00401299(uint param_1)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  
  uVar3 = 0;
  if ((param_1 < 0x20) && (DAT_0042a26c != 0)) {
    puVar2 = (uint *)(DAT_0042a268 + 8);
    do {
      uVar1 = *puVar2;
      if ((uVar1 & 6) == 0) {
        if ((puVar2[-1] & 1 << ((byte)param_1 & 0x1f)) == 0) {
          uVar1 = uVar1 & 0xfffffffe;
        }
        else {
          uVar1 = uVar1 | 1;
        }
        *puVar2 = uVar1;
      }
      uVar3 = uVar3 + 1;
      puVar2 = puVar2 + 0x206;
    } while (uVar3 < DAT_0042a26c);
  }
  return;
}



/* Function: FUN_004012e2 */

uint FUN_004012e2(int param_1)

{
  uint uVar1;
  uint *puVar2;
  bool bVar3;
  int *local_c;
  uint local_8;
  
  local_8 = 0;
  local_c = (int *)(DAT_0042a250 + 0x94);
  do {
    uVar1 = 0;
    if (*local_c != 0) {
      bVar3 = DAT_0042a26c == 0;
      if (DAT_0042a26c != 0) {
        puVar2 = (uint *)(DAT_0042a268 + 8);
        do {
          if (((*puVar2 & 6) == 0) &&
             (((param_1 == 0 || (*(int *)(param_1 + uVar1 * 4) != 0)) &&
              ((puVar2[-1] & 1 << ((byte)local_8 & 0x1f)) != (*puVar2 & 1) << ((byte)local_8 & 0x1f)
              )))) break;
          uVar1 = uVar1 + 1;
          puVar2 = puVar2 + 0x206;
        } while (uVar1 < DAT_0042a26c);
        bVar3 = uVar1 == DAT_0042a26c;
      }
      if (bVar3) {
        return local_8;
      }
    }
    local_8 = local_8 + 1;
    local_c = local_c + 1;
    if (0x1f < local_8) {
      return local_8;
    }
  } while( true );
}



/* Function: FUN_0040136d */

void FUN_0040136d(int param_1)

{
  if (param_1 < 0) {
    FUN_004060de((ushort *)(&DAT_0042b000 + (param_1 + 1) * -0x800));
  }
  return;
}



/* Function: FUN_00401389 */

undefined4 FUN_00401389(int param_1,HWND param_2)

{
  HMODULE pHVar1;
  LPCWSTR pWVar2;
  int iVar3;
  int iVar4;
  WPARAM wParam;
  LPARAM lParam;
  
  while ((-1 < param_1 && (pHVar1 = (HMODULE)(param_1 * 0x1c + DAT_0042a270), pHVar1->unused != 1)))
  {
    pWVar2 = FUN_00401434(pHVar1);
    if (pWVar2 == (LPCWSTR)0x7fffffff) {
      return 0x7fffffff;
    }
    iVar3 = FUN_0040136d((int)pWVar2);
    if (iVar3 == 0) {
      iVar4 = 1;
      iVar3 = param_1 + 1;
    }
    else {
      iVar3 = iVar3 + -1;
      iVar4 = iVar3 - param_1;
    }
    param_1 = iVar3;
    if (param_2 != (HWND)0x0) {
      DAT_0042922c = DAT_0042922c + iVar4;
      lParam = 0;
      wParam = MulDiv(DAT_0042922c,30000,DAT_00429214);
      SendMessageW(param_2,0x402,wParam,lParam);
    }
  }
  return 0;
}



/* Function: FUN_0040140b */

void FUN_0040140b(int param_1)

{
  FUN_00401389(*(int *)(DAT_0042a250 + 0x6c + param_1 * 4),(HWND)0x0);
  return;
}



/* Function: FUN_00401423 */

void FUN_00401423(int param_1)

{
  FUN_004052dd(param_1,(LPCWSTR)&DAT_0040add8);
  return;
}



/* Function: FUN_00401434 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

LPCWSTR FUN_00401434(HMODULE param_1)

{
  short sVar1;
  short *psVar2;
  uint uVar3;
  undefined4 uVar4;
  LRESULT LVar5;
  HGDIOBJ ho;
  HDC hdc;
  HINSTANCE pHVar6;
  SIZE_T dwBytes;
  HRESULT HVar7;
  undefined *puVar8;
  LPCWSTR lpFileName;
  LPCWSTR pWVar9;
  HKEY pHVar10;
  DWORD DVar11;
  LSTATUS LVar12;
  HMODULE pHVar13;
  HANDLE pvVar14;
  LPWSTR pWVar15;
  BOOL BVar16;
  int iVar17;
  LONG lDistanceToMove;
  FARPROC pFVar18;
  HGLOBAL hMem;
  uint uVar19;
  HWND pHVar20;
  int iVar21;
  LPCWSTR pWVar22;
  HMODULE pHVar23;
  WCHAR *pWVar24;
  int *piVar25;
  LPCWSTR pWVar26;
  bool bVar27;
  UINT UVar28;
  PLONG lpDistanceToMoveHigh;
  UINT fuLoad;
  int nDenominator;
  LPCWSTR *ppWVar29;
  _WIN32_FIND_DATAW local_2b4;
  undefined1 local_64 [16];
  FILEOP_FLAGS local_54;
  int local_50;
  undefined2 local_4c;
  short sStack_4a;
  undefined2 uStack_48;
  HWND local_44;
  FARPROC local_40;
  FARPROC local_3c;
  LPCWSTR local_38;
  int local_34;
  LPCWSTR local_30 [2];
  LPCWSTR local_28;
  FILETIME local_24;
  LPCWSTR local_1c;
  HWND local_18;
  HMODULE local_14;
  HWND local_10;
  HWND local_c;
  LPCWSTR local_8;
  
  pHVar13 = DAT_0040cddc;
  pHVar23 = param_1;
  piVar25 = &local_34;
  for (iVar21 = 7; iVar21 != 0; iVar21 = iVar21 + -1) {
    *piVar25 = pHVar23->unused;
    pHVar23 = pHVar23 + 1;
    piVar25 = piVar25 + 1;
  }
  local_10 = DAT_0042a248;
  pWVar22 = (LPCWSTR)0x0;
  local_14 = (HMODULE)(&DAT_0042b000 + (int)local_30[1] * 0x800);
  DAT_0040cdd8 = local_30;
  iVar21 = (int)local_30[0] * 0x800;
  pHVar23 = (HMODULE)(&DAT_0042b000 + iVar21);
  local_8 = (LPCWSTR)0x0;
  switch(local_34) {
  case 2:
    goto switchD_0040148a_caseD_2;
  case 3:
    pWVar22 = (LPCWSTR)0x0;
LAB_00401493:
    FUN_004052dd((int)local_30[0],pWVar22);
    return (LPCWSTR)0x7fffffff;
  case 4:
    DAT_0042920c = DAT_0042920c + 1;
    if (DAT_0042a248 == (HWND)0x0) {
      return (LPCWSTR)0x7fffffff;
    }
    PostQuitMessage(0);
    return (LPCWSTR)0x7fffffff;
  case 5:
    iVar21 = FUN_0040136d((int)local_30[0]);
    pWVar22 = (LPCWSTR)FUN_00401389(iVar21 + -1,(HWND)0x0);
    return pWVar22;
  case 6:
    FUN_004052dd((int)local_30[0],(LPCWSTR)0x0);
    break;
  case 7:
    DVar11 = FUN_00402ba2(0);
    if ((int)DVar11 < 2) {
      DVar11 = 1;
    }
    Sleep(DVar11);
    break;
  case 8:
    SetForegroundWindow(DAT_0042a248);
    break;
  case 9:
    if (DAT_00429210 != (HWND)0x0) {
      ShowWindow(DAT_00429210,(int)local_30[1]);
    }
    if (DAT_00429224 != (HWND)0x0) {
      ShowWindow(DAT_00429224,(int)local_30[0]);
    }
    break;
  case 10:
    pWVar22 = FUN_00402bbf(0xfffffff0);
    pWVar15 = (LPWSTR)SetFileAttributesW(pWVar22,(DWORD)local_30[1]);
    goto LAB_004015ac;
  case 0xb:
    param_1 = (HMODULE)FUN_00402bbf(0xfffffff0);
    pWVar15 = FUN_00405bdd((LPCWSTR)param_1);
    if (pWVar15 != (LPWSTR)0x0) {
      do {
        psVar2 = (short *)FUN_00405b5f(pWVar15,L'\\');
        sVar1 = *psVar2;
        *psVar2 = 0;
        if (((sVar1 == 0) && (local_28 != (LPCWSTR)0x0)) && (iVar21 = FUN_00405846(), iVar21 != 0))
        {
          DVar11 = FUN_004057ac((LPCWSTR)param_1);
        }
        else {
          DVar11 = FUN_00405829((LPCWSTR)param_1);
        }
        if ((DVar11 != 0) &&
           ((DVar11 != 0xb7 || (DVar11 = GetFileAttributesW((LPCWSTR)param_1), (DVar11 & 0x10) == 0)
            ))) {
          local_8 = (LPCWSTR)((int)local_8 + 1);
        }
        *psVar2 = sVar1;
        pWVar15 = psVar2 + 1;
      } while (sVar1 != 0);
    }
    if (local_30[1] == (LPCWSTR)0x0) {
      iVar21 = -0xb;
      goto LAB_004021dc;
    }
    FUN_00401423(-0x1a);
    FUN_0040617e((LPWSTR)&DAT_00436000,(LPCWSTR)param_1);
    BVar16 = SetCurrentDirectoryW((LPCWSTR)param_1);
    if (BVar16 == 0) {
      local_8 = (LPCWSTR)((int)local_8 + 1);
    }
    break;
  case 0xc:
    pWVar22 = FUN_00402bbf(0);
    puVar8 = FUN_004064c1(pWVar22);
    local_24.dwLowDateTime = (DWORD)local_30[1];
    goto joined_r0x00401a03;
  case 0xd:
    if (local_28 == (LPCWSTR)0x0) {
      *(undefined4 *)(&DAT_0042a300 + (int)local_30[0] * 4) = (&DAT_0042a2c0)[(int)local_30[0]];
      uVar4 = FUN_00402ba2(1);
      (&DAT_0042a2c0)[(int)local_30[0]] = uVar4;
    }
    else {
      (&DAT_0042a2c0)[(int)local_30[0]] = *(undefined4 *)(&DAT_0042a300 + (int)local_30[0] * 4);
    }
    break;
  case 0xe:
    uVar19 = (&DAT_0042a2c0)[(int)local_28];
    pWVar22 = local_30[uVar19 == 0];
    (&DAT_0042a2c0)[(int)local_28] = uVar19 & local_24.dwLowDateTime;
    return pWVar22;
  case 0xf:
    pHVar20 = (HWND)(&DAT_0042a2c0)[(int)local_30[1]];
    goto switchD_00401aa3_default;
  case 0x10:
    pWVar22 = FUN_00402bbf(0xffffffd0);
    pWVar9 = FUN_00402bbf(0xffffffdf);
    FUN_00402bbf(0x13);
    BVar16 = MoveFileW(pWVar22,pWVar9);
    if (BVar16 == 0) {
      if ((local_28 == (LPCWSTR)0x0) || (puVar8 = FUN_004064c1(pWVar22), puVar8 == (undefined *)0x0)
         ) goto LAB_0040281e;
      FUN_0040601f(pWVar22,pWVar9);
      iVar21 = -0x1c;
    }
    else {
      iVar21 = -0x1d;
    }
    goto LAB_004021dc;
  case 0x11:
    pHVar23 = (HMODULE)FUN_00402bbf(0);
    pHVar13 = local_14;
    DVar11 = GetFullPathNameW((LPCWSTR)pHVar23,0x400,(LPWSTR)local_14,(LPWSTR *)&param_1);
    if (DVar11 == 0) {
LAB_00401708:
      local_8 = (LPCWSTR)0x1;
      *(undefined2 *)&pHVar13->unused = 0;
    }
    else if ((pHVar23 < param_1) && ((short)param_1->unused != 0)) {
      puVar8 = FUN_004064c1((LPCWSTR)pHVar23);
      if (puVar8 == (undefined *)0x0) goto LAB_00401708;
      FUN_0040617e((LPWSTR)param_1,(LPCWSTR)(puVar8 + 0x2c));
    }
    if (local_28 == (LPCWSTR)0x0) {
      GetShortPathNameW((LPCWSTR)pHVar13,(LPWSTR)pHVar13,0x400);
    }
    break;
  case 0x12:
    pWVar22 = FUN_00402bbf(0xffffffff);
    DVar11 = SearchPathW((LPCWSTR)0x0,pWVar22,(LPCWSTR)0x0,0x400,(LPWSTR)pHVar23,(LPWSTR *)&param_1)
    ;
    bVar27 = DVar11 == 0;
    goto LAB_00401749;
  case 0x13:
    pWVar22 = FUN_00402bbf(0xffffffef);
    pWVar15 = FUN_00405d82((LPWSTR)pHVar23,pWVar22);
    goto LAB_004015ac;
  case 0x14:
    local_10 = (HWND)FUN_00402bbf(0x31);
    param_1 = (HMODULE)((uint)local_30[0] & 7);
    iVar21 = FUN_00405ba9((ushort *)local_10);
    if (iVar21 == 0) {
      pHVar20 = local_10;
      pWVar22 = (LPCWSTR)FUN_0040617e((LPWSTR)&DAT_0040a5d8,(LPCWSTR)&DAT_00436000);
      pWVar22 = FUN_00405b32(pWVar22);
      lstrcatW(pWVar22,(LPCWSTR)pHVar20);
    }
    else {
      FUN_0040617e((LPWSTR)&DAT_0040a5d8,(LPCWSTR)local_10);
    }
    FUN_00406412((LPCWSTR)&DAT_0040a5d8);
    do {
      if (2 < (int)param_1) {
        puVar8 = FUN_004064c1((LPCWSTR)&DAT_0040a5d8);
        uVar19 = 0;
        if (puVar8 != (undefined *)0x0) {
          uVar19 = CompareFileTime((FILETIME *)(puVar8 + 0x14),&local_24);
        }
        param_1 = (HMODULE)(uint)((((uint)((int)&param_1[-1].unused + 1U) | 0x80000000) & uVar19) ==
                                 0);
      }
      if (param_1 == (HMODULE)0x0) {
        FUN_00405d2e((LPCWSTR)&DAT_0040a5d8);
      }
      local_c = (HWND)FUN_00405d53((LPCWSTR)&DAT_0040a5d8,0x40000000,(param_1 != (HMODULE)0x1) + 1);
      if (local_c != (HWND)0xffffffff) {
        FUN_004052dd(-0x16,(LPCWSTR)local_10);
        DAT_0042a2f4 = DAT_0042a2f4 + 1;
        iVar21 = FUN_004030e7((DWORD)local_28,local_c,(LPVOID)0x0,0);
        DAT_0042a2f4 = DAT_0042a2f4 + -1;
        if (((LPCWSTR)local_24.dwLowDateTime != (LPCWSTR)0xffffffff) ||
           ((LPCWSTR)local_24.dwHighDateTime != (LPCWSTR)0xffffffff)) {
          SetFileTime(local_c,&local_24,(FILETIME *)0x0,&local_24);
        }
        CloseHandle(local_c);
        if (-1 < iVar21) goto switchD_0040148a_caseD_41;
        if (iVar21 == -2) {
          FUN_004061a0((LPWSTR)&DAT_0040a5d8,-0x17);
          lstrcatW((LPWSTR)&DAT_0040a5d8,(LPCWSTR)local_10);
        }
        else {
          FUN_004061a0((LPWSTR)&DAT_0040a5d8,-0x12);
        }
        uVar19 = 0x200010;
        puVar8 = &DAT_0040a5d8;
        goto LAB_00402283;
      }
      if (param_1 != (HMODULE)0x0) {
        FUN_004052dd(-0x1e,(LPCWSTR)local_10);
        bVar27 = param_1 == (HMODULE)0x2;
        goto LAB_004015ae;
      }
      FUN_0040617e((LPWSTR)&DAT_0040b5d8,(LPCWSTR)&DAT_0042b000);
      FUN_0040617e((LPWSTR)&DAT_0042b000,(LPCWSTR)&DAT_0040a5d8);
      FUN_004061a0((LPWSTR)&DAT_0040add8,(int)local_1c);
      FUN_0040617e((LPWSTR)&DAT_0042b000,(LPCWSTR)&DAT_0040b5d8);
      iVar21 = FUN_004058c3(&DAT_0040add8,(int)local_30[0] >> 3);
    } while (iVar21 == 4);
    if (iVar21 != 5) {
      pWVar22 = (LPCWSTR)&DAT_0040a5d8;
      local_30[0] = (LPCWSTR)0xfffffffa;
      goto LAB_00401493;
    }
    _DAT_0042a2c8 = _DAT_0042a2c8 + 1;
    goto LAB_00402a55;
  case 0x15:
    uVar19 = 0;
    goto LAB_0040193b;
  case 0x16:
    pWVar22 = FUN_00402bbf(0x31);
    pWVar22 = (LPCWSTR)FUN_004058c3(pWVar22,(uint)local_30[0]);
    if (pWVar22 == (LPCWSTR)0x0) goto LAB_0040281e;
    if (pWVar22 == local_28) {
      return (LPCWSTR)local_24.dwLowDateTime;
    }
    if (pWVar22 == (LPCWSTR)local_24.dwHighDateTime) {
      return local_1c;
    }
    break;
  case 0x17:
    uVar19 = 0xfffffff0;
LAB_0040193b:
    pWVar22 = FUN_00402bbf(uVar19);
    FUN_0040596f(pWVar22,(uint)local_30[1]);
    break;
  case 0x18:
    pWVar22 = FUN_00402bbf(1);
    pHVar20 = (HWND)lstrlenW(pWVar22);
    goto switchD_00401aa3_default;
  case 0x19:
    param_1 = (HMODULE)FUN_00402ba2(2);
    iVar21 = FUN_00402ba2(3);
    local_c = (HWND)FUN_00402bbf(1);
    *(undefined2 *)&pHVar23->unused = 0;
    if (((local_28 == (LPCWSTR)0x0) || (param_1 != (HMODULE)0x0)) &&
       ((iVar17 = lstrlenW((LPCWSTR)local_c), -1 < iVar21 || (iVar21 = iVar21 + iVar17, -1 < iVar21)
        ))) {
      if (iVar17 < iVar21) {
        iVar21 = iVar17;
      }
      FUN_0040617e((LPWSTR)pHVar23,(LPCWSTR)((int)&local_c->unused + iVar21 * 2));
      pHVar13 = param_1;
      if (param_1 != (HMODULE)0x0) {
        if ((int)param_1 < 0) {
          iVar21 = lstrlenW((LPCWSTR)pHVar23);
          param_1 = (HMODULE)((int)&pHVar13->unused + iVar21);
          if ((int)param_1 < 0) {
            param_1 = (HMODULE)0x0;
          }
        }
        if ((int)param_1 < 0x400) {
          *(undefined2 *)((int)&pHVar23->unused + (int)param_1 * 2) = 0;
        }
      }
    }
    break;
  case 0x1a:
    pWVar22 = FUN_00402bbf(0x20);
    pWVar9 = FUN_00402bbf(0x31);
    if ((LPCWSTR)local_24.dwHighDateTime == (LPCWSTR)0x0) {
      puVar8 = (undefined *)lstrcmpiW(pWVar22,pWVar9);
    }
    else {
      puVar8 = (undefined *)lstrcmpW(pWVar22,pWVar9);
    }
    goto joined_r0x00401a03;
  case 0x1b:
    param_1 = (HMODULE)FUN_00402bbf(1);
    DVar11 = ExpandEnvironmentStringsW((LPCWSTR)param_1,(LPWSTR)pHVar23,0x400);
    if ((DVar11 == 0) ||
       ((local_28 != (LPCWSTR)0x0 &&
        (iVar17 = lstrcmpW((LPCWSTR)param_1,(LPCWSTR)pHVar23), iVar17 == 0)))) {
      local_8 = (LPCWSTR)0x1;
      *(undefined2 *)&pHVar23->unused = 0;
    }
    *(undefined2 *)(&DAT_0042b7fe + iVar21) = 0;
    break;
  case 0x1c:
    uVar19 = FUN_00402ba2(0);
    uVar3 = FUN_00402ba2(1);
    if (local_1c != (LPCWSTR)0x0) {
      if (uVar19 < uVar3) {
        return (LPCWSTR)local_24.dwLowDateTime;
      }
      if (uVar19 <= uVar3) {
        return local_28;
      }
      return (LPCWSTR)local_24.dwHighDateTime;
    }
    if ((int)uVar19 < (int)uVar3) {
      return (LPCWSTR)local_24.dwLowDateTime;
    }
    if ((int)uVar19 <= (int)uVar3) {
      return local_28;
    }
    return (LPCWSTR)local_24.dwHighDateTime;
  case 0x1d:
    pHVar20 = (HWND)FUN_00402ba2(1);
    uVar19 = FUN_00402ba2(2);
    switch(local_24.dwLowDateTime) {
    case 0:
      pHVar20 = (HWND)((int)&pHVar20->unused + uVar19);
      break;
    case 1:
      pHVar20 = (HWND)((int)pHVar20 - uVar19);
      break;
    case 2:
      pHVar20 = (HWND)(uVar19 * (int)pHVar20);
      break;
    case 3:
      if (uVar19 == 0) {
LAB_00401aff:
        pHVar20 = (HWND)0x0;
        local_8 = (LPCWSTR)0x1;
      }
      else {
        pHVar20 = (HWND)((int)pHVar20 / (int)uVar19);
      }
      break;
    case 4:
      pHVar20 = (HWND)((uint)pHVar20 | uVar19);
      break;
    case 5:
      pHVar20 = (HWND)((uint)pHVar20 & uVar19);
      break;
    case 6:
      pHVar20 = (HWND)((uint)pHVar20 ^ uVar19);
      break;
    case 7:
      pHVar20 = (HWND)(uint)(pHVar20 == (HWND)0x0);
      break;
    case 8:
      if (pHVar20 == (HWND)0x0) {
LAB_00401ae9:
        if (uVar19 == 0) goto LAB_00401ae1;
      }
      pHVar20 = (HWND)0x1;
      break;
    case 9:
      if (pHVar20 != (HWND)0x0) goto LAB_00401ae9;
LAB_00401ae1:
      pHVar20 = (HWND)0x0;
      break;
    case 10:
      if (uVar19 == 0) goto LAB_00401aff;
      pHVar20 = (HWND)((int)pHVar20 % (int)uVar19);
      break;
    case 0xb:
      pHVar20 = (HWND)((int)pHVar20 << ((byte)uVar19 & 0x1f));
      break;
    case 0xc:
      pHVar20 = (HWND)((int)pHVar20 >> ((byte)uVar19 & 0x1f));
    }
    goto switchD_00401aa3_default;
  case 0x1e:
    pWVar22 = FUN_00402bbf(1);
    uVar4 = FUN_00402ba2(2);
    wsprintfW((LPWSTR)pHVar23,pWVar22,uVar4);
    break;
  case 0x1f:
    if (local_28 == (LPCWSTR)0x0) {
      if (local_30[1] != (LPCWSTR)0x0) {
        if (DAT_0040cddc != (HMODULE)0x0) {
          FUN_0040617e((LPWSTR)pHVar23,(LPCWSTR)(DAT_0040cddc + 1));
          DAT_0040cddc = (HMODULE)pHVar13->unused;
          goto LAB_00401ba7;
        }
        goto LAB_0040281e;
      }
      pHVar13 = (HMODULE)GlobalAlloc(0x40,0x804);
      FUN_004061a0((LPWSTR)(pHVar13 + 1),(int)local_30[0]);
      pHVar13->unused = (int)DAT_0040cddc;
      DAT_0040cddc = pHVar13;
    }
    else {
      do {
        local_28 = (LPCWSTR)((int)local_28 - 1);
        if (pHVar13 == (HMODULE)0x0) goto LAB_00402275;
        pHVar13 = (HMODULE)pHVar13->unused;
      } while (local_28 != (LPCWSTR)0x0);
      if (pHVar13 == (HMODULE)0x0) goto LAB_00402275;
      FUN_0040617e((LPWSTR)&DAT_0040a5d8,(LPCWSTR)(pHVar13 + 1));
      FUN_0040617e((LPWSTR)(pHVar13 + 1),(LPCWSTR)(DAT_0040cddc + 1));
      pWVar24 = (WCHAR *)&DAT_0040a5d8;
      pHVar23 = DAT_0040cddc + 1;
LAB_00402970:
      FUN_0040617e((LPWSTR)pHVar23,pWVar24);
    }
    break;
  case 0x20:
  case 0x21:
    local_18 = (HWND)FUN_00402ba2(3);
    param_1 = (HMODULE)FUN_00402ba2(4);
    if (((uint)local_1c & 1) != 0) {
      local_18 = (HWND)FUN_00402bbf(0x33);
    }
    if (((uint)local_1c & 2) != 0) {
      param_1 = (HMODULE)FUN_00402bbf(0x44);
    }
    if (local_34 == 0x21) {
      pHVar20 = (HWND)FUN_00402ba2(1);
      UVar28 = FUN_00402ba2(2);
      if ((int)local_1c >> 2 == 0) {
        pHVar20 = (HWND)SendMessageW(pHVar20,UVar28,(WPARAM)local_18,(LPARAM)param_1);
        local_c = pHVar20;
        local_30[1] = local_30[0];
      }
      else {
        LVar5 = SendMessageTimeoutW(pHVar20,UVar28,(WPARAM)local_18,(LPARAM)param_1,0,
                                    (int)local_1c >> 2,(PDWORD_PTR)&local_c);
        local_8 = (LPCWSTR)(uint)(LVar5 == 0);
        pHVar20 = local_c;
        local_30[1] = local_30[0];
      }
    }
    else {
      pWVar22 = FUN_00402bbf(1);
      pWVar9 = FUN_00402bbf(0x12);
      pHVar20 = FindWindowExW(local_18,(HWND)param_1,
                              (LPCWSTR)(-(uint)(*pWVar22 != L'\0') & (uint)pWVar22),
                              (LPCWSTR)(-(uint)(*pWVar9 != L'\0') & (uint)pWVar9));
      local_c = pHVar20;
      local_30[1] = local_30[0];
    }
joined_r0x004027a9:
    if (-1 < (int)local_30[1]) goto switchD_00401aa3_default;
    break;
  case 0x22:
    pHVar20 = (HWND)FUN_00402ba2(0);
    puVar8 = (undefined *)IsWindow(pHVar20);
    local_24.dwLowDateTime = (DWORD)local_30[1];
joined_r0x00401a03:
    if (puVar8 == (undefined *)0x0) {
      return local_28;
    }
    return (LPCWSTR)local_24.dwLowDateTime;
  case 0x23:
    iVar21 = FUN_00402ba2(2);
    pHVar20 = (HWND)FUN_00402ba2(1);
    pHVar20 = GetDlgItem(pHVar20,iVar21);
    goto switchD_00401aa3_default;
  case 0x24:
    iVar21 = DAT_0042a288 + (int)local_30[1];
    iVar17 = -0x15;
    pHVar20 = (HWND)FUN_00402ba2(0);
    SetWindowLongW(pHVar20,iVar17,iVar21);
    break;
  case 0x25:
    pHVar20 = GetDlgItem(DAT_0042a248,(int)local_30[1]);
    GetClientRect(pHVar20,(LPRECT)(local_64 + 0xc));
    fuLoad = 0x10;
    iVar21 = CONCAT22(sStack_4a,local_4c) * (int)local_28;
    iVar17 = local_50 * (int)local_28;
    UVar28 = 0;
    pWVar22 = FUN_00402bbf(0);
    pvVar14 = LoadImageW((HINSTANCE)0x0,pWVar22,UVar28,iVar17,iVar21,fuLoad);
    ho = (HGDIOBJ)SendMessageW(pHVar20,0x172,0,(LPARAM)pvVar14);
    if (ho != (HGDIOBJ)0x0) {
      DeleteObject(ho);
    }
    break;
  case 0x26:
    hdc = GetDC(DAT_0042a248);
    nDenominator = 0x48;
    iVar21 = GetDeviceCaps(hdc,0x5a);
    iVar17 = FUN_00402ba2(2);
    _DAT_0040cde0 = MulDiv(iVar17,iVar21,nDenominator);
    _DAT_0040cde0 = -_DAT_0040cde0;
    ReleaseDC(local_10,hdc);
    _DAT_0040cdf0 = FUN_00402ba2(3);
    DAT_0040cdf4 = (byte)local_24.dwHighDateTime & 1;
    DAT_0040cdf7 = 1;
    DAT_0040cdf5 = (byte)local_24.dwHighDateTime & 2;
    DAT_0040cdf6 = (byte)local_24.dwHighDateTime & 4;
    FUN_004061a0((LPWSTR)&DAT_0040cdfc,(int)local_30[1]);
    pHVar20 = (HWND)CreateFontIndirectW((LOGFONTW *)&DAT_0040cde0);
    goto switchD_00401aa3_default;
  case 0x27:
    pHVar20 = (HWND)FUN_00402ba2(0);
    iVar21 = FUN_00402ba2(1);
    if ((LPCWSTR)local_24.dwLowDateTime == (LPCWSTR)0x0) {
      ShowWindow(pHVar20,iVar21);
    }
    else {
      EnableWindow(pHVar20,iVar21);
    }
    break;
  case 0x28:
    pWVar22 = FUN_00402bbf(0);
    pWVar9 = FUN_00402bbf(0x31);
    pWVar26 = FUN_00402bbf(0x22);
    FUN_00402bbf(0x15);
    FUN_00401423(-0x14);
    pHVar6 = ShellExecuteW(local_10,(LPCWSTR)(-(uint)(*pWVar22 != L'\0') & (uint)pWVar22),pWVar9,
                           (LPCWSTR)(-(uint)(*pWVar26 != L'\0') & (uint)pWVar26),
                           (LPCWSTR)&DAT_00436000,local_24.dwLowDateTime);
    if ((int)pHVar6 < 0x21) goto LAB_0040281e;
    break;
  case 0x29:
    pWVar22 = FUN_00402bbf(0);
    FUN_004052dd(-0x15,pWVar22);
    param_1 = (HMODULE)FUN_0040585e(pWVar22);
    if (param_1 == (HMODULE)0x0) goto LAB_0040281e;
    pHVar13 = param_1;
    if (local_28 != (LPCWSTR)0x0) {
      DVar11 = WaitForSingleObject(param_1,100);
      while (DVar11 == 0x102) {
        FUN_00406594(0xf);
        DVar11 = WaitForSingleObject(param_1,100);
      }
      GetExitCodeProcess(param_1,(LPDWORD)&local_c);
      if ((int)local_30[1] < 0) {
        pHVar13 = param_1;
        if (local_c != (HWND)0x0) {
          local_8 = (LPCWSTR)0x1;
        }
      }
      else {
        FUN_004060c5((LPWSTR)local_14,local_c);
        pHVar13 = param_1;
      }
    }
LAB_00401ede:
    CloseHandle(pHVar13);
    break;
  case 0x2a:
    pWVar22 = FUN_00402bbf(2);
    puVar8 = FUN_004064c1(pWVar22);
    if (puVar8 != (undefined *)0x0) {
      FUN_004060c5((LPWSTR)local_14,*(undefined4 *)(puVar8 + 0x14));
      pHVar20 = *(HWND *)(puVar8 + 0x18);
      goto switchD_00401aa3_default;
    }
    *(undefined2 *)&pHVar23->unused = 0;
    *(undefined2 *)&local_14->unused = 0;
    goto LAB_0040281e;
  case 0x2b:
    pWVar22 = FUN_00402bbf(0xffffffee);
    ppWVar29 = &local_38;
    local_4c = SUB42(pWVar22,0);
    sStack_4a = (short)((uint)pWVar22 >> 0x10);
    pFVar18 = FUN_00406558(8);
    dwBytes = (*pFVar18)(pWVar22,ppWVar29);
    *(undefined2 *)&pHVar23->unused = 0;
    *(undefined2 *)&local_14->unused = 0;
    local_8 = (LPCWSTR)0x1;
    if ((dwBytes != 0) && (param_1 = (HMODULE)GlobalAlloc(0x40,dwBytes), param_1 != (HMODULE)0x0)) {
      local_3c = FUN_00406558(9);
      local_18 = (HWND)FUN_00406558(10);
      iVar21 = (*local_3c)(CONCAT22(sStack_4a,local_4c),0,dwBytes,param_1);
      pHVar13 = param_1;
      if ((iVar21 != 0) &&
         (iVar21 = (*(code *)local_18)(param_1,&DAT_0040a014,&local_c,&local_40), pHVar13 = param_1,
         iVar21 != 0)) {
        FUN_004060c5((LPWSTR)pHVar23,local_c[2].unused);
        FUN_004060c5((LPWSTR)local_14,local_c[3].unused);
        local_8 = (LPCWSTR)0x0;
        pHVar13 = param_1;
      }
LAB_00401ba7:
      GlobalFree(pHVar13);
    }
    break;
  case 0x2c:
    local_8 = (LPCWSTR)0x1;
    if (DAT_0042a2f8 < 0) {
      iVar21 = -0x19;
    }
    else {
      pWVar22 = FUN_00402bbf(0xfffffff0);
      local_c = (HWND)FUN_00402bbf(1);
      if ((((LPCWSTR)local_24.dwHighDateTime != (LPCWSTR)0x0) &&
          (param_1 = GetModuleHandleW(pWVar22), param_1 != (HMODULE)0x0)) ||
         (param_1 = LoadLibraryExW(pWVar22,(HANDLE)0x0,8), param_1 != (HMODULE)0x0)) {
        pFVar18 = FUN_004065c7(param_1,(LPCWSTR)local_c);
        if (pFVar18 == (FARPROC)0x0) {
          FUN_004052dd(-9,(LPCWSTR)local_c);
        }
        else {
          local_8 = (LPCWSTR)0x0;
          if (local_28 == (LPCWSTR)0x0) {
            (*pFVar18)(local_10,0x400,&DAT_0042b000,&DAT_0040cddc,&PTR_DAT_0040a000);
          }
          else {
            FUN_00401423((int)local_28);
            iVar21 = (*pFVar18)();
            if (iVar21 != 0) {
              local_8 = (LPCWSTR)0x1;
            }
          }
        }
        if (((LPCWSTR)local_24.dwLowDateTime == (LPCWSTR)0x0) &&
           (iVar21 = FUN_00403967((int)param_1), iVar21 != 0)) {
          FreeLibrary(param_1);
        }
        break;
      }
      iVar21 = -10;
      param_1 = (HMODULE)0x0;
    }
    goto LAB_004021dc;
  case 0x2d:
    local_38 = FUN_00402bbf(0xfffffff0);
    local_c = (HWND)FUN_00402bbf(0xffffffdf);
    local_10 = (HWND)FUN_00402bbf(2);
    local_40 = (FARPROC)FUN_00402bbf(0xffffffcd);
    local_14 = (HMODULE)FUN_00402bbf(0x45);
    local_44 = (HWND)(local_24.dwHighDateTime & 0xfff);
    local_3c = (FARPROC)((int)local_24.dwHighDateTime >> 0x10 & 0xffff);
    uVar19 = (int)local_24.dwHighDateTime >> 0xc & 7;
    iVar21 = FUN_00405ba9((ushort *)local_c);
    if (iVar21 == 0) {
      FUN_00402bbf(0x21);
    }
    HVar7 = CoCreateInstance((IID *)&DAT_004084e4,(LPUNKNOWN)0x0,1,(IID *)&DAT_004084d4,&param_1);
    if (-1 < HVar7) {
      local_18 = (HWND)(**(code **)param_1->unused)(param_1,&DAT_004084f4,&local_4c);
      if (-1 < (int)local_18) {
        local_18 = (HWND)(**(code **)(param_1->unused + 0x50))(param_1,local_c);
        if ((local_24.dwHighDateTime & 0x8000) == 0) {
          (**(code **)(param_1->unused + 0x24))(param_1,&DAT_00436000);
        }
        if (uVar19 != 0) {
          (**(code **)(param_1->unused + 0x3c))(param_1,uVar19);
        }
        (**(code **)(param_1->unused + 0x34))(param_1,local_3c);
        if (*(WCHAR *)local_40 != L'\0') {
          (**(code **)(param_1->unused + 0x44))(param_1,local_40,local_44);
        }
        (**(code **)(param_1->unused + 0x2c))(param_1,local_10);
        (**(code **)(param_1->unused + 0x1c))(param_1,local_14);
        if (-1 < (int)local_18) {
          local_18 = (HWND)(**(code **)(*(int *)CONCAT22(sStack_4a,local_4c) + 0x18))
                                     ((int *)CONCAT22(sStack_4a,local_4c),local_38,1);
        }
        (**(code **)(*(int *)CONCAT22(sStack_4a,local_4c) + 8))((int *)CONCAT22(sStack_4a,local_4c))
        ;
      }
      (**(code **)(param_1->unused + 8))(param_1);
      if (-1 < (int)local_18) {
        iVar21 = -0xc;
        goto LAB_004021dc;
      }
    }
    local_8 = (LPCWSTR)0x1;
    iVar21 = -0x10;
    goto LAB_004021dc;
  case 0x2e:
    pWVar22 = FUN_00402bbf(0);
    pWVar9 = FUN_00402bbf(0x11);
    param_1 = (HMODULE)FUN_00402bbf(0x23);
    puVar8 = FUN_004064c1(pWVar22);
    if (puVar8 != (undefined *)0x0) {
      local_64._0_4_ = local_10;
      local_64._4_4_ = 2;
      iVar21 = lstrlenW(pWVar22);
      pWVar22[iVar21 + 1] = L'\0';
      iVar21 = lstrlenW(pWVar9);
      pWVar9[iVar21 + 1] = L'\0';
      sStack_4a = (short)param_1;
      uStack_48 = (undefined2)((uint)param_1 >> 0x10);
      local_54 = (FILEOP_FLAGS)local_28;
      local_64._8_4_ = pWVar22;
      local_64._12_4_ = pWVar9;
      FUN_004052dd(0,(LPCWSTR)param_1);
      iVar21 = SHFileOperationW((LPSHFILEOPSTRUCTW)local_64);
      if (iVar21 == 0) break;
    }
    FUN_004052dd(-7,(LPCWSTR)0x0);
    goto LAB_0040281e;
  case 0x2f:
    if (local_30[0] != (LPCWSTR)0xbadf00d) {
LAB_00402275:
      uVar19 = 0x200010;
      puVar8 = (undefined *)FUN_004061a0((LPWSTR)0x0,-0x18);
LAB_00402283:
      FUN_004058c3(puVar8,uVar19);
      return (LPCWSTR)0x7fffffff;
    }
    DAT_0042a2d4 = DAT_0042a2d4 + 1;
    break;
  case 0x30:
    pWVar9 = (LPCWSTR)0x0;
    pWVar26 = (LPCWSTR)0x0;
    if (local_30[0] != (LPCWSTR)0x0) {
      pWVar9 = FUN_00402bbf(0);
    }
    if (local_30[1] != (LPCWSTR)0x0) {
      pWVar26 = FUN_00402bbf(0x11);
    }
    if ((LPCWSTR)local_24.dwHighDateTime != (LPCWSTR)0x0) {
      pWVar22 = FUN_00402bbf(0x22);
    }
    lpFileName = FUN_00402bbf(0xffffffcd);
    pWVar15 = (LPWSTR)WritePrivateProfileStringW(pWVar9,pWVar26,pWVar22,lpFileName);
LAB_004015ac:
    bVar27 = pWVar15 == (LPWSTR)0x0;
LAB_004015ae:
    if (bVar27) goto LAB_0040281e;
    break;
  case 0x31:
    param_1 = DAT_0040a010;
    pWVar22 = FUN_00402bbf(1);
    local_38 = FUN_00402bbf(0x12);
    pWVar9 = FUN_00402bbf(0xffffffdd);
    GetPrivateProfileStringW(pWVar22,local_38,(LPCWSTR)&param_1,(LPWSTR)pHVar23,0x3ff,pWVar9);
    bVar27 = (short)pHVar23->unused == 10;
LAB_00401749:
    if (bVar27) {
LAB_004027ec:
      local_8 = (LPCWSTR)0x1;
      *(undefined2 *)&pHVar23->unused = 0;
    }
    break;
  case 0x32:
    if ((LPCWSTR)local_24.dwHighDateTime == (LPCWSTR)0x0) {
      pHVar10 = (HKEY)FUN_00402cc9((HKEY)0x2);
      if (pHVar10 == (HKEY)0x0) goto LAB_0040281e;
      pWVar22 = FUN_00402bbf(0x33);
      LVar12 = RegDeleteValueW(pHVar10,pWVar22);
      RegCloseKey(pHVar10);
    }
    else {
      pWVar22 = FUN_00402bbf(0x22);
      uVar19 = local_24.dwHighDateTime & 2;
      pHVar10 = (HKEY)FUN_00402cb4((int)local_30[1]);
      LVar12 = FUN_00402bff(pHVar10,pWVar22,uVar19);
    }
    if (LVar12 != 0) goto LAB_0040281e;
    break;
  case 0x33:
    pHVar10 = (HKEY)FUN_00402cb4((int)local_30[0]);
    local_38 = local_1c;
    local_c = (HWND)FUN_00402bbf(2);
    pWVar22 = FUN_00402bbf(0x11);
    local_8 = (LPCWSTR)0x1;
    LVar12 = RegCreateKeyExW(pHVar10,pWVar22,0,(LPWSTR)0x0,0,DAT_0042a2f0 | 2,
                             (LPSECURITY_ATTRIBUTES)0x0,(PHKEY)&param_1,(LPDWORD)0x0);
    if (LVar12 == 0) {
      DVar11 = 0;
      if ((LPCWSTR)local_24.dwHighDateTime == (LPCWSTR)0x1) {
        FUN_00402bbf(0x23);
        iVar21 = lstrlenW((LPCWSTR)&DAT_0040b5d8);
        DVar11 = iVar21 * 2 + 2;
      }
      if ((LPCWSTR)local_24.dwHighDateTime == (LPCWSTR)0x4) {
        _DAT_0040b5d8 = FUN_00402ba2(3);
        DVar11 = 4;
      }
      if ((LPCWSTR)local_24.dwHighDateTime == (LPCWSTR)0x3) {
        DVar11 = FUN_004030e7(local_24.dwLowDateTime,(HANDLE)0x0,&DAT_0040b5d8,0x1800);
      }
      LVar12 = RegSetValueExW((HKEY)param_1,(LPCWSTR)local_c,0,(DWORD)local_38,&DAT_0040b5d8,DVar11)
      ;
      pHVar10 = (HKEY)param_1;
      if (LVar12 == 0) {
        local_8 = (LPCWSTR)0x0;
      }
LAB_004024f6:
      RegCloseKey(pHVar10);
    }
    break;
  case 0x34:
    pHVar10 = (HKEY)FUN_00402cc9((HKEY)0x20019);
    pWVar22 = FUN_00402bbf(0x33);
    *(undefined2 *)&pHVar23->unused = 0;
    if (pHVar10 != (HKEY)0x0) {
      local_38 = (LPCWSTR)0x800;
      LVar12 = RegQueryValueExW(pHVar10,pWVar22,(LPDWORD)0x0,(LPDWORD)&param_1,(LPBYTE)pHVar23,
                                (LPDWORD)&local_38);
      if (LVar12 == 0) {
        if (param_1 == (HMODULE)0x4) {
          local_8 = (LPCWSTR)(uint)((LPCWSTR)local_24.dwHighDateTime == (LPCWSTR)0x0);
          FUN_004060c5((LPWSTR)pHVar23,pHVar23->unused);
          goto LAB_004024f6;
        }
        if ((param_1 == (HMODULE)0x1) || (param_1 == (HMODULE)0x2)) {
          local_8 = (LPCWSTR)local_24.dwHighDateTime;
          goto LAB_004024ee;
        }
      }
      *(undefined2 *)&pHVar23->unused = 0;
      local_8 = (LPCWSTR)0x1;
      goto LAB_004024f6;
    }
    goto LAB_0040281e;
  case 0x35:
    pHVar10 = (HKEY)FUN_00402cc9((HKEY)0x20019);
    DVar11 = FUN_00402ba2(3);
    *(undefined2 *)&pHVar23->unused = 0;
    if (pHVar10 != (HKEY)0x0) {
      param_1 = (HMODULE)0x3ff;
      if ((LPCWSTR)local_24.dwHighDateTime == (LPCWSTR)0x0) {
        LVar12 = RegEnumValueW(pHVar10,DVar11,(LPWSTR)pHVar23,(LPDWORD)&param_1,(LPDWORD)0x0,
                               (LPDWORD)0x0,(LPBYTE)0x0,(LPDWORD)0x0);
        if (LVar12 != 0) goto LAB_0040281e;
      }
      else {
        RegEnumKeyW(pHVar10,DVar11,(LPWSTR)pHVar23,0x3ff);
      }
LAB_004024ee:
      *(undefined2 *)(&DAT_0042b7fe + iVar21) = 0;
      goto LAB_004024f6;
    }
    goto LAB_0040281e;
  case 0x36:
    pHVar13 = (HMODULE)FUN_004060de((ushort *)pHVar23);
    if (pHVar13 != (HMODULE)0x0) goto LAB_00401ede;
    break;
  case 0x37:
    pWVar22 = FUN_00402bbf(0xffffffed);
    pHVar20 = (HWND)FUN_00405d53(pWVar22,(DWORD)local_30[1],(DWORD)local_28);
    if (pHVar20 == (HWND)0xffffffff) goto LAB_0040281b;
switchD_00401aa3_default:
    FUN_004060c5((LPWSTR)pHVar23,pHVar20);
    break;
  case 0x38:
  case 0x44:
    local_38 = local_28;
    if (local_28 == (LPCWSTR)0x0) {
      if (local_34 == 0x38) {
        FUN_00402bbf(0x21);
        WideCharToMultiByte(0,0,(LPCWSTR)&DAT_0040b5d8,-1,&DAT_0040add8,0x400,(LPCSTR)0x0,
                            (LPBOOL)0x0);
        param_1 = (HMODULE)lstrlenA(&DAT_0040add8);
      }
      else {
        pWVar22 = FUN_00402bbf(0x11);
        iVar21 = lstrlenW(pWVar22);
        param_1 = (HMODULE)(iVar21 * 2);
      }
    }
    else {
      _DAT_0040add8 = FUN_00402ba2(1);
      param_1 = (HMODULE)((local_34 != 0x38) + 1);
    }
    if (((short)pHVar23->unused != 0) &&
       (((pvVar14 = (HANDLE)FUN_004060de((ushort *)pHVar23),
         local_34 == 0x38 || local_38 != (LPCWSTR)0x0 ||
         ((LPCWSTR)local_24.dwLowDateTime == (LPCWSTR)0x0)) ||
        (iVar21 = FUN_00405e34(pvVar14,(int)pvVar14), -1 < iVar21)))) {
      pWVar15 = (LPWSTR)FUN_00405e05(pvVar14,&DAT_0040add8,(DWORD)param_1);
      goto LAB_004015ac;
    }
    goto LAB_0040281e;
  case 0x39:
  case 0x45:
    local_10 = (HWND)0x0;
    local_40 = (FARPROC)0x2;
    iVar21 = FUN_00402ba2(2);
    local_4c = (undefined2)iVar21;
    sStack_4a = (short)((uint)iVar21 >> 0x10);
    if (iVar21 < 1) break;
    if (0x3ff < iVar21) {
      local_4c = 0x3ff;
      sStack_4a = 0;
    }
    if ((short)pHVar23->unused != 0) {
      local_c = (HWND)0x0;
      local_18 = (HWND)FUN_004060de((ushort *)pHVar23);
      if (0 < CONCAT22(sStack_4a,local_4c)) {
        do {
          if (local_34 == 0x39) {
            BVar16 = ReadFile(local_18,(LPVOID)((int)&param_1 + 2),2 - local_24.dwLowDateTime,
                              (LPDWORD)&local_3c,(LPOVERLAPPED)0x0);
            if ((BVar16 != 0) && (local_3c != (FARPROC)0x0)) {
              local_44 = (HWND)CONCAT22((short)((uint)BVar16 >> 0x10),(ushort)param_1._2_1_);
              local_40 = local_3c;
              if ((LPCWSTR)local_24.dwLowDateTime == (LPCWSTR)0x0) {
                iVar21 = MultiByteToWideChar(0,8,(LPCSTR)((int)&param_1 + 2),(int)local_3c,
                                             (LPWSTR)&local_44,1);
                if (iVar21 == 0) {
                  iVar21 = -(int)local_40;
                  do {
                    local_3c = local_3c + -1;
                    local_44 = (HWND)0xfffd;
                    if (local_3c == (FARPROC)0x0) break;
                    local_40 = local_40 + -1;
                    iVar21 = iVar21 + 1;
                    SetFilePointer(local_18,iVar21,(PLONG)0x0,1);
                    iVar17 = MultiByteToWideChar(0,8,(LPCSTR)((int)&param_1 + 2),(int)local_3c,
                                                 (LPWSTR)&local_44,1);
                  } while (iVar17 == 0);
                }
                goto LAB_004026f9;
              }
LAB_0040272f:
              FUN_004060c5((LPWSTR)local_14,(uint)local_44 & 0xffff);
              goto LAB_00402a55;
            }
            break;
          }
          if (((((LPCWSTR)local_24.dwLowDateTime == (LPCWSTR)0x0) && (local_10 == (HWND)0x0)) &&
              (iVar21 = FUN_00405e34(local_18,0), iVar21 < 0)) ||
             (iVar21 = FUN_00405dd6(local_18,&local_44,2), iVar21 == 0)) break;
LAB_004026f9:
          if ((LPCWSTR)local_24.dwLowDateTime != (LPCWSTR)0x0) goto LAB_0040272f;
          sVar1 = (short)local_44;
          if (((short)local_c == 0xd) || ((short)local_c == 10)) {
            if (((short)local_c == sVar1) || ((sVar1 != 0xd && (sVar1 != 10)))) {
              SetFilePointer(local_18,-(int)local_40,(PLONG)0x0,1);
            }
            else {
              *(short *)((int)&local_14->unused + (int)local_10 * 2) = sVar1;
              local_10 = (HWND)((int)local_10 + 1);
            }
            break;
          }
          iVar21 = (int)local_10 + 1;
          *(short *)((int)&local_14->unused + (int)local_10 * 2) = sVar1;
          local_10 = (HWND)iVar21;
          if ((sVar1 == 0) || (local_c = local_44, CONCAT22(sStack_4a,local_4c) <= iVar21)) break;
        } while( true );
      }
    }
    bVar27 = local_10 == (HWND)0x0;
    *(undefined2 *)((int)&local_14->unused + (int)local_10 * 2) = 0;
    goto LAB_004015ae;
  case 0x3a:
    if ((short)pHVar23->unused != 0) {
      lpDistanceToMoveHigh = (PLONG)0x0;
      lDistanceToMove = FUN_00402ba2(2);
      pvVar14 = (HANDLE)FUN_004060de((ushort *)pHVar23);
      pHVar20 = (HWND)SetFilePointer(pvVar14,lDistanceToMove,lpDistanceToMoveHigh,
                                     local_24.dwLowDateTime);
      pHVar23 = local_14;
      goto joined_r0x004027a9;
    }
    break;
  case 0x3b:
    pvVar14 = (HANDLE)FUN_004060de((ushort *)pHVar23);
    if (pvVar14 != (HANDLE)0x0) {
      FindClose(pvVar14);
    }
    break;
  case 0x3c:
    pvVar14 = (HANDLE)FUN_004060de((ushort *)local_14);
    if ((pvVar14 != (HANDLE)0x0) && (BVar16 = FindNextFileW(pvVar14,&local_2b4), BVar16 != 0)) {
LAB_00402833:
      pWVar24 = local_2b4.cFileName;
      goto LAB_00402970;
    }
    goto LAB_004027ec;
  case 0x3d:
    pWVar22 = FUN_00402bbf(2);
    pvVar14 = FindFirstFileW(pWVar22,&local_2b4);
    if (pvVar14 != (HANDLE)0xffffffff) {
      FUN_004060c5((LPWSTR)local_14,pvVar14);
      goto LAB_00402833;
    }
    *(undefined2 *)&local_14->unused = 0;
LAB_0040281b:
    *(undefined2 *)&pHVar23->unused = 0;
LAB_0040281e:
    local_8 = (LPCWSTR)0x1;
    break;
  case 0x3e:
    local_4c = 0xfd66;
    sStack_4a = -1;
    pFVar18 = (FARPROC)FUN_00402bbf(0xfffffff0);
    local_3c = pFVar18;
    iVar21 = FUN_00405ba9((ushort *)pFVar18);
    if (iVar21 == 0) {
      FUN_00402bbf(0xffffffed);
    }
    FUN_00405d2e((LPCWSTR)pFVar18);
    param_1 = (HMODULE)FUN_00405d53((LPCWSTR)pFVar18,0x40000000,2);
    if (param_1 != (HMODULE)0xffffffff) {
      local_c = DAT_0042a254;
      hMem = GlobalAlloc(0x40,(SIZE_T)DAT_0042a254);
      if (hMem != (HGLOBAL)0x0) {
        FUN_0040336e(0);
        FUN_00403358(hMem,(DWORD)local_c);
        pWVar22 = (LPCWSTR)GlobalAlloc(0x40,(SIZE_T)local_28);
        local_38 = pWVar22;
        if (pWVar22 != (LPCWSTR)0x0) {
          FUN_004030e7((DWORD)local_30[1],(HANDLE)0x0,pWVar22,(DWORD)local_28);
          for (; (char)*pWVar22 != '\0'; pWVar22 = (LPCWSTR)((int)(pWVar22 + 4) + local_50)) {
            local_50 = *(int *)pWVar22;
            FUN_00405d0e((undefined1 *)(*(int *)(pWVar22 + 2) + (int)hMem),(int)(pWVar22 + 4),
                         local_50);
          }
          GlobalFree(local_38);
        }
        FUN_00405e05(param_1,hMem,(DWORD)local_c);
        GlobalFree(hMem);
        iVar21 = FUN_004030e7(0xffffffff,param_1,(LPVOID)0x0,0);
        local_4c = (undefined2)iVar21;
        sStack_4a = (short)((uint)iVar21 >> 0x10);
      }
      CloseHandle(param_1);
    }
    iVar21 = -0xd;
    if (sStack_4a < 0) {
      iVar21 = -0x11;
      DeleteFileW((LPCWSTR)local_3c);
      local_8 = (LPCWSTR)0x1;
    }
LAB_004021dc:
    FUN_00401423(iVar21);
    break;
  case 0x3f:
    uVar19 = FUN_00402ba2(0);
    if (DAT_0042a26c <= uVar19) goto LAB_0040281e;
    iVar21 = uVar19 * 0x818 + DAT_0042a268;
    if (-1 < (int)local_28) {
      pHVar20 = *(HWND *)(iVar21 + (int)local_28 * 4);
      pHVar23 = local_14;
      if (local_28 == (LPCWSTR)0x0) {
        pWVar24 = (WCHAR *)(iVar21 + 0x18);
        goto LAB_00402970;
      }
      goto switchD_00401aa3_default;
    }
    local_28 = (LPCWSTR)(-1 - (int)local_28);
    if (local_28 == (LPCWSTR)0x0) {
      FUN_004061a0((LPWSTR)(iVar21 + 0x18),local_24.dwHighDateTime);
      *(byte *)(iVar21 + 9) = *(byte *)(iVar21 + 9) | 1;
    }
    else {
      local_30[1] = (LPCWSTR)FUN_00402ba2(1);
    }
    *(LPCWSTR *)(iVar21 + (int)local_28 * 4) = local_30[1];
    if ((LPCWSTR)local_24.dwLowDateTime != (LPCWSTR)0x0) {
      FUN_0040117d(uVar19);
    }
    break;
  case 0x40:
    uVar19 = FUN_00402ba2(0);
    if (0x1f < uVar19) goto LAB_0040281e;
    if ((LPCWSTR)local_24.dwLowDateTime == (LPCWSTR)0x0) {
      if (local_28 == (LPCWSTR)0x0) {
        FUN_004061a0((LPWSTR)local_14,*(int *)(DAT_0042a250 + 0x94 + uVar19 * 4));
      }
      else {
        *(LPCWSTR *)(DAT_0042a250 + 0x94 + uVar19 * 4) = local_30[1];
      }
    }
    else {
      if (local_28 == (LPCWSTR)0x0) {
        pHVar20 = (HWND)FUN_004012e2(0);
        pHVar23 = local_14;
        goto switchD_00401aa3_default;
      }
      FUN_00401299(uVar19);
      FUN_004011ef(0,0);
    }
    break;
  case 0x43:
    SendMessageW(DAT_0042a248,0xb,DAT_00425728 & (uint)local_30[0],0);
    if (local_30[0] != (LPCWSTR)0x0) {
      InvalidateRect(local_10,(RECT *)0x0,0);
    }
  }
switchD_0040148a_caseD_41:
  _DAT_0042a2c8 = _DAT_0042a2c8 + (int)local_8;
LAB_00402a55:
  local_30[0] = (LPCWSTR)0x0;
switchD_0040148a_caseD_2:
  return local_30[0];
}



/* Function: FUN_00402ba2 */

void FUN_00402ba2(int param_1)

{
  ushort *puVar1;
  
  puVar1 = (ushort *)FUN_004061a0((LPWSTR)0x0,*(int *)(DAT_0040cdd8 + param_1 * 4));
  FUN_004060de(puVar1);
  return;
}



/* Function: FUN_00402bbf */

LPCWSTR FUN_00402bbf(uint param_1)

{
  uint uVar1;
  LPCWSTR pWVar2;
  
  uVar1 = param_1;
  if ((int)param_1 < 0) {
    uVar1 = -param_1;
  }
  pWVar2 = (LPCWSTR)FUN_004061a0((LPWSTR)(&DAT_0040a5d8 + ((int)uVar1 >> 4) * 0x800),
                                 *(int *)(DAT_0040cdd8 + (uVar1 & 0xf) * 4));
  if ((int)param_1 < 0) {
    FUN_00406412(pWVar2);
  }
  return pWVar2;
}



/* Function: FUN_00402bff */

LSTATUS FUN_00402bff(HKEY param_1,LPCWSTR param_2,int param_3)

{
  LSTATUS LVar1;
  FARPROC pFVar2;
  WCHAR local_214 [262];
  HKEY local_8;
  
  LVar1 = RegOpenKeyExW(param_1,param_2,0,DAT_0042a2f0 | 8,&local_8);
  if (LVar1 == 0) {
    do {
      LVar1 = RegEnumKeyW(local_8,0,local_214,0x105);
      if (LVar1 != 0) break;
      if (param_3 != 0) {
        RegCloseKey(local_8);
        goto LAB_00402c90;
      }
      LVar1 = FUN_00402bff(local_8,local_214,0);
    } while (LVar1 == 0);
    RegCloseKey(local_8);
    pFVar2 = FUN_00406558(3);
    if (pFVar2 == (FARPROC)0x0) {
      if ((DAT_0042a2f0 == 0) && (LVar1 = RegDeleteKeyW(param_1,param_2), LVar1 == 0)) {
        LVar1 = 0;
      }
      else {
LAB_00402c90:
        LVar1 = 1;
      }
    }
    else {
      LVar1 = (*pFVar2)(param_1,param_2,DAT_0042a2f0,0);
    }
  }
  return LVar1;
}



/* Function: FUN_00402cb4 */

int FUN_00402cb4(int param_1)

{
  if (param_1 == 0) {
    param_1 = DAT_0042a2c4 + -0x7fffffff;
  }
  return param_1;
}



/* Function: FUN_00402cc9 */

uint FUN_00402cc9(HKEY param_1)

{
  uint samDesired;
  LPCWSTR lpSubKey;
  HKEY hKey;
  LSTATUS LVar1;
  DWORD ulOptions;
  HKEY *phkResult;
  
  phkResult = &param_1;
  samDesired = DAT_0042a2f0 | (uint)param_1;
  ulOptions = 0;
  lpSubKey = FUN_00402bbf(0x22);
  hKey = (HKEY)FUN_00402cb4(*(int *)(DAT_0040cdd8 + 4));
  LVar1 = RegOpenKeyExW(hKey,lpSubKey,ulOptions,samDesired,phkResult);
  return ~-(uint)(LVar1 != 0) & (uint)param_1;
}



/* Function: FUN_00402d04 */

undefined4 FUN_00402d04(HWND param_1,int param_2)

{
  undefined4 uVar1;
  wchar_t *pwVar2;
  WCHAR local_84 [64];
  
  if (param_2 == 0x110) {
    SetTimer(param_1,1,0xfa,(TIMERPROC)0x0);
    param_2 = 0x113;
  }
  if (param_2 == 0x113) {
    uVar1 = FUN_00402d83();
    pwVar2 = u_unpacking_data___d___0040a054;
    if (DAT_0042a250 == 0) {
      pwVar2 = u_verifying_installer___d___0040a020;
    }
    wsprintfW(local_84,pwVar2,uVar1);
    SetWindowTextW(param_1,local_84);
    SetDlgItemTextW(param_1,0x406,local_84);
  }
  return 0;
}



/* Function: FUN_00402d83 */

void FUN_00402d83(void)

{
  int nNumber;
  
  nNumber = DAT_00418ed0;
  if (DAT_00418ee0 <= DAT_00418ed0) {
    nNumber = DAT_00418ee0;
  }
  MulDiv(nNumber,100,DAT_00418ee0);
  return;
}



/* Function: FUN_00402d9f */

void __cdecl FUN_00402d9f(int param_1)

{
  DWORD DVar1;
  undefined4 uVar2;
  WCHAR local_84 [64];
  
  if (param_1 == 0) {
    if (DAT_00418edc == (HWND)0x0) {
      DVar1 = GetTickCount();
      if (DAT_0042a24c < DVar1) {
        if (DAT_0042a248 == 0) {
          DAT_00418edc = CreateDialogParamW(DAT_0042a240,(LPCWSTR)0x6f,(HWND)0x0,FUN_00402d04,0);
          ShowWindow(DAT_00418edc,5);
        }
        else if (((byte)DAT_0042a2f4 & 1) != 0) {
          uVar2 = FUN_00402d83();
          wsprintfW(local_84,u______d___0040a080,uVar2);
          FUN_004052dd(0,local_84);
        }
      }
    }
    else {
      FUN_00406594(0);
    }
  }
  else {
    if (DAT_00418edc != (HWND)0x0) {
      DestroyWindow(DAT_00418edc);
    }
    DAT_00418edc = (HWND)0x0;
  }
  return;
}



/* Function: FUN_00402e41 */

wchar_t * FUN_00402e41(uint param_1)

{
  DWORD DVar1;
  HANDLE hFile;
  LPCWSTR pWVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  undefined4 *puVar6;
  int *piVar7;
  uint uVar8;
  WCHAR local_230 [260];
  uint local_28;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  SIZE_T local_14;
  int local_10;
  int local_c;
  uint local_8;
  
  local_8 = 0;
  local_c = 0;
  DVar1 = GetTickCount();
  DAT_0042a24c = DVar1 + 1000;
  GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_00438800,0x400);
  hFile = (HANDLE)FUN_00405d53((LPCWSTR)&DAT_00438800,0x80000000,3);
  if (hFile == (HANDLE)0xffffffff) {
    DAT_0040a018 = hFile;
    return u_Error_launching_installer_0040a2b8;
  }
  DAT_0040a018 = hFile;
  FUN_0040617e((LPWSTR)&DAT_00436800,(LPCWSTR)&DAT_00438800);
  pWVar2 = FUN_00405b7e((LPCWSTR)&DAT_00436800);
  FUN_0040617e((LPWSTR)&DAT_00439000,pWVar2);
  uVar3 = GetFileSize(hFile,(LPDWORD)0x0);
  DAT_00418ee0 = uVar3;
  for (; 0 < (int)uVar3; uVar3 = uVar3 - uVar8) {
    uVar4 = (-(uint)(DAT_0042a254 != 0) & 0x7e00) + 0x200;
    uVar8 = uVar3;
    if ((int)uVar4 <= (int)uVar3) {
      uVar8 = uVar4;
    }
    iVar5 = FUN_00403358(&DAT_00418ee8,uVar8);
    if (iVar5 == 0) {
      FUN_00402d9f(1);
      goto LAB_00403098;
    }
    if (DAT_0042a254 == 0) {
      FUN_00405d0e((undefined1 *)&local_28,0x418ee8,0x1c);
      if (((((local_28 & 0xfffffff0) == 0) && (local_24 == -0x21524111)) && (local_18 == 0x74736e49)
          ) && ((local_1c == 0x74666f73 && (local_20 == 0x6c6c754e)))) {
        param_1 = param_1 | local_28;
        DAT_0042a2e0 = DAT_0042a2e0 | param_1 & 2;
        DAT_0042a254 = DAT_00418ed0;
        if ((int)uVar3 < local_10) goto LAB_00403098;
        if (((param_1 & 8) == 0) && ((param_1 & 4) != 0)) break;
        local_c = local_c + 1;
        uVar3 = local_10 - 4;
        if (uVar3 < uVar8) {
          uVar8 = uVar3;
        }
      }
    }
    else if ((param_1 & 2) == 0) {
      FUN_00402d9f(0);
    }
    if ((int)uVar3 < (int)DAT_00418ee0) {
      local_8 = FUN_00406609(local_8,&DAT_00418ee8,uVar8);
    }
    DAT_00418ed0 = DAT_00418ed0 + uVar8;
  }
  FUN_00402d9f(1);
  if (DAT_0042a254 != 0) {
    if (local_c != 0) {
      FUN_0040336e(DAT_00418ed0);
      iVar5 = FUN_00403358(&param_1,4);
      if ((iVar5 == 0) || (local_8 != param_1)) goto LAB_00403098;
    }
    puVar6 = (undefined4 *)GlobalAlloc(0x40,local_14);
    FUN_00406677(0x40ce48);
    FUN_00405d82(local_230,(LPCWSTR)&DAT_00437800);
    DAT_0040a01c = CreateFileW(local_230,0xc0000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x4000100,
                               (HANDLE)0x0);
    if (DAT_0040a01c == (HANDLE)0xffffffff) {
      return u_Error_writing_temporary_file__Ma_0040a230;
    }
    DAT_00418ee4 = FUN_0040336e(DAT_0042a254 + 0x1c);
    DAT_00418ed8 = (DAT_00418ee4 - (~local_28 & 4)) + -0x1c + local_10;
    DVar1 = FUN_004030e7(0xffffffff,(HANDLE)0x0,puVar6,local_14);
    if (DVar1 == local_14) {
      DAT_0042a258 = *puVar6;
      if ((local_28 & 1) != 0) {
        DAT_0042a25c = DAT_0042a25c + 1;
      }
      piVar7 = puVar6 + 0x11;
      iVar5 = 8;
      DAT_0042a250 = puVar6;
      do {
        piVar7 = piVar7 + -2;
        *piVar7 = *piVar7 + (int)puVar6;
        iVar5 = iVar5 + -1;
      } while (iVar5 != 0);
      puVar6[0xf] = DAT_00418ed4;
      FUN_00405d0e(&DAT_0042a260,(int)(puVar6 + 1),0x40);
      return (wchar_t *)0x0;
    }
  }
LAB_00403098:
  return u_Installer_integrity_check_has_fa_0040a098;
}



/* Function: FUN_004030e7 */

int FUN_004030e7(DWORD param_1,HANDLE param_2,LPVOID param_3,DWORD param_4)

{
  int iVar1;
  int iVar2;
  DWORD nNumberOfBytesToRead;
  BOOL BVar3;
  DWORD local_8;
  
  if (-1 < (int)param_1) {
    DAT_00418ed4 = param_1 + DAT_0042a298;
    SetFilePointer(DAT_0040a01c,DAT_00418ed4,(PLONG)0x0,0);
  }
  iVar1 = FUN_004031ef(4);
  if (iVar1 < 0) {
    return iVar1;
  }
  iVar1 = FUN_00405dd6(DAT_0040a01c,&param_1,4);
  if (iVar1 != 0) {
    DAT_00418ed4 = DAT_00418ed4 + 4;
    iVar1 = FUN_004031ef(param_1);
    if (iVar1 < 0) {
      return iVar1;
    }
    if (param_3 == (LPVOID)0x0) {
      param_3 = (LPVOID)0x0;
      while( true ) {
        if ((int)param_1 < 1) {
          return iVar1;
        }
        local_8 = param_1;
        if (0x3fff < (int)param_1) {
          local_8 = 0x4000;
        }
        iVar2 = FUN_00405dd6(DAT_0040a01c,&DAT_00414ed0,local_8);
        if (iVar2 == 0) break;
        iVar2 = FUN_00405e05(param_2,&DAT_00414ed0,local_8);
        if (iVar2 == 0) {
          return -2;
        }
        param_1 = param_1 - local_8;
        DAT_00418ed4 = DAT_00418ed4 + local_8;
        iVar1 = iVar1 + local_8;
      }
    }
    else {
      nNumberOfBytesToRead = param_1;
      if ((int)param_4 <= (int)param_1) {
        nNumberOfBytesToRead = param_4;
      }
      BVar3 = ReadFile(DAT_0040a01c,param_3,nNumberOfBytesToRead,&local_8,(LPOVERLAPPED)0x0);
      if (BVar3 != 0) {
        DAT_00418ed4 = DAT_00418ed4 + local_8;
        return local_8;
      }
    }
  }
  return -3;
}



/* Function: FUN_004031ef */

/* WARNING: Type propagation algorithm not settling */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_004031ef(int param_1)

{
  DWORD DVar1;
  int iVar2;
  undefined *puVar3;
  
  iVar2 = (DAT_00418ed4 - DAT_0040ce40) + param_1;
  DVar1 = GetTickCount();
  DAT_0042a24c = DVar1 + 500;
  if (0 < iVar2) {
    FUN_0040336e(DAT_00418ee4);
    SetFilePointer(DAT_0040a01c,DAT_0040ce40,(PLONG)0x0,0);
    DAT_00418ed0 = 0;
    DAT_00418ee0 = iVar2;
    do {
      DVar1 = 0x4000;
      if (DAT_00418ed8 - DAT_00418ee4 < 0x4001) {
        DVar1 = DAT_00418ed8 - DAT_00418ee4;
      }
      iVar2 = FUN_00403358(&DAT_00414ed0,DVar1);
      if (iVar2 == 0) {
        return 0xffffffff;
      }
      DAT_00418ee4 = DAT_00418ee4 + DVar1;
      _DAT_0040ce60 = &DAT_00414ed0;
      DAT_0040ce64 = DVar1;
      do {
        if ((DAT_0042a250 != 0) && (DAT_0042a2e0 == 0)) {
          DAT_00418ed0 = DAT_0040ce40 + ((DAT_00418ee0 - DAT_00418ed4) - param_1);
          FUN_00402d9f(0);
        }
        DAT_0040ce68 = &DAT_0040ced0;
        _DAT_0040ce6c = 0x8000;
        iVar2 = FUN_00406697((SIZE_T *)&DAT_0040ce48);
        if (iVar2 < 0) {
          return 0xfffffffd;
        }
        puVar3 = DAT_0040ce68 + -0x40ced0;
        if (puVar3 == (undefined *)0x0) {
          if (DAT_0040ce64 != 0) {
            return 0xfffffffd;
          }
          if (DVar1 == 0) {
            return 0xfffffffd;
          }
          break;
        }
        iVar2 = FUN_00405e05(DAT_0040a01c,&DAT_0040ced0,(DWORD)puVar3);
        if (iVar2 == 0) {
          return 0xfffffffe;
        }
        DAT_0040ce40 = DAT_0040ce40 + (int)puVar3;
      } while (DAT_0040ce64 != 0);
    } while (0 < (DAT_00418ed4 - DAT_0040ce40) + param_1);
    SetFilePointer(DAT_0040a01c,DAT_00418ed4,(PLONG)0x0,0);
  }
  FUN_00402d9f(1);
  return 0;
}



/* Function: FUN_00403358 */

void FUN_00403358(LPVOID param_1,DWORD param_2)

{
  FUN_00405dd6(DAT_0040a018,param_1,param_2);
  return;
}



/* Function: FUN_0040336e */

void FUN_0040336e(LONG param_1)

{
  SetFilePointer(DAT_0040a018,param_1,(PLONG)0x0,0);
  return;
}



/* Function: FUN_00403385 */

void FUN_00403385(void)

{
  int iVar1;
  
  FUN_00406412((LPCWSTR)&DAT_00437800);
  iVar1 = FUN_00405ba9((ushort *)&DAT_00437800);
  if (iVar1 == 0) {
    return;
  }
  FUN_00405b32((LPCWSTR)&DAT_00437800);
  FUN_00405829((LPCWSTR)&DAT_00437800);
  FUN_00405d82((LPWSTR)&DAT_00437000,(LPCWSTR)&DAT_00437800);
  return;
}



/* Function: entry */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void entry(void)

{
  bool bVar1;
  DWORD DVar2;
  FARPROC pFVar3;
  int iVar4;
  LPWSTR pWVar5;
  short *psVar6;
  LPCWSTR pWVar7;
  WCHAR *pWVar8;
  int *piVar9;
  undefined3 extraout_var;
  int iVar10;
  HANDLE pvVar11;
  BOOL BVar12;
  WCHAR *pWVar13;
  WCHAR WVar14;
  char *lpString;
  WCHAR WVar15;
  LPWSTR *TokenHandle;
  wchar_t *local_2d4;
  UINT local_2d0;
  LPWSTR pWStack_2cc;
  uint local_2c8;
  _TOKEN_PRIVILEGES _Stack_2c4;
  SHFILEINFOW SStack_2b4;
  
  WVar15 = L' ';
  local_2d0 = 0;
  local_2d4 = u_Error_writing_temporary_file__Ma_0040a230;
  local_2c8 = 0;
  SetErrorMode(0x8001);
  DVar2 = GetVersion();
  if (((short)DVar2 != 6) && (pFVar3 = FUN_00406558(0), pFVar3 != (FARPROC)0x0)) {
    (*pFVar3)(0xc00);
  }
  lpString = "UXTHEME";
  do {
    FUN_004064e8(lpString);
    iVar4 = lstrlenA(lpString);
    lpString = lpString + iVar4 + 1;
  } while (*lpString != '\0');
  FUN_00406558(9);
  DAT_0042a244 = FUN_00406558(7);
  Ordinal_17();
  DAT_0042a2f8 = OleInitialize((LPVOID)0x0);
  SHGetFileInfoW((LPCWSTR)&DAT_004216e8,0,&SStack_2b4,0x2b4,0);
  FUN_0040617e((LPWSTR)&DAT_00429240,u_NSIS_Error_0040a384);
  pWVar5 = GetCommandLineW();
  FUN_0040617e(&DAT_00435000,pWVar5);
  DAT_0042a240 = GetModuleHandleW((LPCWSTR)0x0);
  psVar6 = &DAT_00435000;
  if (DAT_00435000 == 0x22) {
    psVar6 = (short *)&DAT_00435002;
    WVar15 = L'\"';
  }
  pWVar7 = (LPCWSTR)FUN_00405b5f(psVar6,WVar15);
  pWVar8 = CharNextW(pWVar7);
  WVar15 = *pWVar8;
  pWStack_2cc = pWVar8;
  while (WVar15 != L'\0') {
    WVar14 = L' ';
    while (WVar15 == L' ') {
      pWVar8 = pWVar8 + 1;
      WVar15 = *pWVar8;
    }
    if (*pWVar8 == L'\"') {
      pWVar8 = pWVar8 + 1;
      WVar14 = L'\"';
    }
    pWVar13 = pWVar8;
    if (*pWVar8 == L'/') {
      pWVar13 = pWVar8 + 1;
      if ((*pWVar13 == L'S') && ((pWVar8[2] == L' ' || (pWVar8[2] == L'\0')))) {
        DAT_0042a2e0 = 1;
      }
      if (((*(int *)pWVar13 == CONCAT22(DAT_0040a37a,DAT_0040a378)) &&
          (*(uint *)(pWVar8 + 3) == (CONCAT22(DAT_0040a37e,DAT_0040a37c) | (int)DAT_0040a37a >> 0xf)
          )) && ((pWVar8[5] == L' ' || (pWVar8[5] == L'\0')))) {
        local_2c8 = local_2c8 | 4;
      }
      if ((*(int *)(pWVar8 + -1) == CONCAT22(DAT_0040a36e,DAT_0040a36c)) &&
         (*(uint *)pWVar13 == (CONCAT22(DAT_0040a372,DAT_0040a370) | (int)DAT_0040a36e >> 0xf))) {
        pWVar8[-1] = L'\0';
        FUN_0040617e(&DAT_00435800,pWVar8 + 3);
        break;
      }
    }
    pWVar8 = (WCHAR *)FUN_00405b5f(pWVar13,WVar14);
    if (*pWVar8 == L'\"') {
      pWVar8 = pWVar8 + 1;
    }
    WVar15 = *pWVar8;
  }
  GetTempPathW(0x400,(LPWSTR)&DAT_00437800);
  iVar4 = FUN_00403385();
  if (iVar4 == 0) {
    GetWindowsDirectoryW((LPWSTR)&DAT_00437800,0x3fb);
    lstrcatW((LPWSTR)&DAT_00437800,u__Temp_0040a360);
    iVar4 = FUN_00403385();
    if (iVar4 == 0) {
      GetTempPathW(0x3fc,(LPWSTR)&DAT_00437800);
      lstrcatW((LPWSTR)&DAT_00437800,(LPCWSTR)&DAT_0040a358);
      SetEnvironmentVariableW(u_TEMP_0040a34c,(LPCWSTR)&DAT_00437800);
      SetEnvironmentVariableW((LPCWSTR)&DAT_0040a344,(LPCWSTR)&DAT_00437800);
      iVar4 = FUN_00403385();
      if (iVar4 == 0) goto LAB_00403703;
    }
  }
  DeleteFileW((LPCWSTR)&DAT_00437000);
  local_2d4 = FUN_00402e41(local_2c8);
  if (local_2d4 != (wchar_t *)0x0) goto LAB_00403703;
  if (DAT_0042a25c != 0) {
    piVar9 = (int *)FUN_00405b5f(&DAT_00435000,L'\0');
    if ((int *)0x434fff < piVar9) {
      do {
        if ((*piVar9 == CONCAT22(DAT_0040a33a,DAT_0040a338)) &&
           (piVar9[1] == (CONCAT22(DAT_0040a33e,DAT_0040a33c) | (int)DAT_0040a33a >> 0xf))) break;
        piVar9 = (int *)((int)piVar9 + -2);
      } while ((int *)0x434fff < piVar9);
    }
    local_2d4 = u_Error_launching_installer_0040a2b8;
    if (piVar9 < &DAT_00435000) {
      iVar4 = FUN_00405846();
      lstrcatW((LPWSTR)&DAT_00437800,u__nsu_0040a32c);
      if (iVar4 != 0) {
        lstrcatW((LPWSTR)&DAT_00437800,(LPCWSTR)&DAT_0040a328);
      }
      lstrcatW((LPWSTR)&DAT_00437800,u__tmp_0040a31c);
      iVar10 = lstrcmpiW((LPCWSTR)&DAT_00437800,(LPCWSTR)&DAT_00436800);
      if (iVar10 != 0) {
        if (iVar4 == 0) {
          FUN_00405829((LPCWSTR)&DAT_00437800);
        }
        else {
          FUN_004057ac((LPCWSTR)&DAT_00437800);
        }
        SetCurrentDirectoryW((LPCWSTR)&DAT_00437800);
        if (DAT_00435800 == 0) {
          FUN_0040617e(&DAT_00435800,(LPCWSTR)&DAT_00436800);
        }
        FUN_0040617e((LPWSTR)&DAT_0042b000,pWStack_2cc);
        _DAT_0042b800 = CONCAT22(DAT_0040a316,DAT_0040a314);
        iVar4 = 0x1a;
        do {
          FUN_004061a0((LPWSTR)&DAT_00420ee8,*(int *)(DAT_0042a250 + 0x120));
          DeleteFileW((LPCWSTR)&DAT_00420ee8);
          if ((local_2d4 != (wchar_t *)0x0) &&
             (BVar12 = CopyFileW((LPCWSTR)&DAT_00438800,(LPCWSTR)&DAT_00420ee8,1), BVar12 != 0)) {
            FUN_0040601f((LPCWSTR)&DAT_00420ee8,(LPCWSTR)0x0);
            FUN_004061a0((LPWSTR)&DAT_00420ee8,*(int *)(DAT_0042a250 + 0x124));
            pvVar11 = FUN_0040585e((LPWSTR)&DAT_00420ee8);
            if (pvVar11 != (HANDLE)0x0) {
              CloseHandle(pvVar11);
              local_2d4 = (wchar_t *)0x0;
            }
          }
          _DAT_0042b800 = _DAT_0042b800 + 1;
          iVar4 = iVar4 + -1;
        } while (iVar4 != 0);
        FUN_0040601f((LPCWSTR)&DAT_00437800,(LPCWSTR)0x0);
      }
      goto LAB_00403703;
    }
    *(undefined2 *)piVar9 = 0;
    pWVar7 = (LPCWSTR)(piVar9 + 2);
    bVar1 = FUN_00405c3a(pWVar7);
    if (CONCAT31(extraout_var,bVar1) == 0) goto LAB_00403703;
    FUN_0040617e(&DAT_00435800,pWVar7);
    FUN_0040617e((LPWSTR)&DAT_00436000,pWVar7);
    local_2d4 = (wchar_t *)0x0;
  }
  DAT_0042a2ec = -1;
  local_2d0 = FUN_004039c7();
LAB_00403703:
  FUN_004038d5();
  OleUninitialize();
  if (local_2d4 == (wchar_t *)0x0) {
    if (DAT_0042a2d4 != 0) {
      TokenHandle = &pWStack_2cc;
      DVar2 = 0x28;
      pvVar11 = GetCurrentProcess();
      BVar12 = OpenProcessToken(pvVar11,DVar2,TokenHandle);
      if (BVar12 != 0) {
        LookupPrivilegeValueW
                  ((LPCWSTR)0x0,u_SeShutdownPrivilege_0040a2ec,&_Stack_2c4.Privileges[0].Luid);
        _Stack_2c4.PrivilegeCount = 1;
        _Stack_2c4.Privileges[0].Attributes = 2;
        AdjustTokenPrivileges(pWStack_2cc,0,&_Stack_2c4,0,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0);
      }
      pFVar3 = FUN_00406558(4);
      if (((pFVar3 != (FARPROC)0x0) && (iVar4 = (*pFVar3)(0,0,0,0x25,0x80040002), iVar4 == 0)) ||
         (BVar12 = ExitWindowsEx(2,0x80040002), BVar12 == 0)) {
        FUN_0040140b(9);
      }
    }
    if (DAT_0042a2ec != -1) {
      local_2d0 = DAT_0042a2ec;
    }
                    /* WARNING: Subroutine does not return */
    ExitProcess(local_2d0);
  }
  FUN_004058c3(local_2d4,0x200010);
                    /* WARNING: Subroutine does not return */
  ExitProcess(2);
}



/* Function: FUN_004038d5 */

void FUN_004038d5(void)

{
  if (DAT_0040a018 != (HANDLE)0xffffffff) {
    CloseHandle(DAT_0040a018);
    DAT_0040a018 = (HANDLE)0xffffffff;
  }
  if (DAT_0040a01c != (HANDLE)0xffffffff) {
    CloseHandle(DAT_0040a01c);
    DAT_0040a01c = (HANDLE)0xffffffff;
  }
  FUN_00403932();
  FUN_0040596f((LPCWSTR)&DAT_00438000,7);
  return;
}



/* Function: FUN_00403917 */

void FUN_00403917(undefined4 param_1)

{
  undefined4 *puVar1;
  
  for (puVar1 = DAT_004216ec; puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1) {
    (*(code *)puVar1[1])(param_1);
  }
  return;
}



/* Function: FUN_00403932 */

void FUN_00403932(void)

{
  int *piVar1;
  int *hMem;
  
  hMem = DAT_004216ec;
  FUN_00403917(0);
  if (hMem != (int *)0x0) {
    do {
      piVar1 = (int *)*hMem;
      FreeLibrary((HMODULE)hMem[2]);
      GlobalFree(hMem);
      hMem = piVar1;
    } while (piVar1 != (int *)0x0);
  }
  DAT_004216ec = (int *)0x0;
  return;
}



/* Function: FUN_00403967 */

undefined4 FUN_00403967(int param_1)

{
  undefined4 *puVar1;
  
  puVar1 = DAT_004216ec;
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 1;
    }
    if (puVar1[2] == param_1) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  return 0;
}



/* Function: FUN_00403985 */

undefined4 FUN_00403985(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  iVar1 = FUN_00403967(param_1);
  if (iVar1 == 0) {
    uVar2 = 1;
  }
  else {
    puVar3 = (undefined4 *)GlobalAlloc(0x40,0xc);
    if (puVar3 == (undefined4 *)0x0) {
      uVar2 = 0xffffffff;
    }
    else {
      puVar3[2] = param_1;
      puVar3[1] = param_2;
      *puVar3 = DAT_004216ec;
      uVar2 = 0;
      DAT_004216ec = puVar3;
    }
  }
  return uVar2;
}



/* Function: FUN_004039c7 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

INT_PTR FUN_004039c7(void)

{
  bool bVar1;
  ATOM AVar2;
  FARPROC pFVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined2 *puVar5;
  int iVar6;
  DWORD DVar7;
  LPCWSTR pWVar8;
  undefined3 extraout_var_00;
  int iVar9;
  BOOL BVar10;
  INT_PTR IVar11;
  short *lpString;
  int iStack_10;
  int iStack_c;
  int iStack_8;
  int iStack_4;
  
  iVar9 = DAT_0042a250;
  pFVar3 = FUN_00406558(2);
  if (pFVar3 == (FARPROC)0x0) {
    _DAT_00437000 = 0x30;
    _DAT_00437002 = 0x78;
    _DAT_00437004 = 0;
    FUN_0040604b((HKEY)0x80000001,L"Control Panel\\Desktop\\ResourceLocale",(LPCWSTR)0x0,
                 (LPBYTE)&DAT_00423728,(HKEY)0x0);
    if (DAT_00423728 == 0) {
      FUN_0040604b((HKEY)0x80000003,L".DEFAULT\\Control Panel\\International",L"Locale",
                   (LPBYTE)&DAT_00423728,(HKEY)0x0);
    }
    lstrcatW((LPWSTR)&DAT_00437000,&DAT_00423728);
  }
  else {
    uVar4 = (*pFVar3)();
    FUN_004060c5((LPWSTR)&DAT_00437000,uVar4 & 0xffff);
  }
  FUN_00403c9d();
  DAT_0042a2c0 = DAT_0042a258 & 0x20;
  _DAT_0042a2dc = 0x10000;
  bVar1 = FUN_00405c3a(&DAT_00435800);
  if ((CONCAT31(extraout_var,bVar1) == 0) && (*(int *)(iVar9 + 0x48) != 0)) {
    lpString = &DAT_004281e0;
    FUN_0040604b(*(HKEY *)(iVar9 + 0x44),(LPCWSTR)(DAT_0042a278 + *(int *)(iVar9 + 0x48) * 2),
                 (LPCWSTR)(DAT_0042a278 + *(int *)(iVar9 + 0x4c) * 2),(LPBYTE)&DAT_004281e0,
                 (HKEY)0x0);
    if (DAT_004281e0 != 0) {
      if (DAT_004281e0 == 0x22) {
        lpString = (short *)&DAT_004281e2;
        puVar5 = (undefined2 *)FUN_00405b5f((LPCWSTR)&DAT_004281e2,L'\"');
        *puVar5 = 0;
      }
      iVar6 = lstrlenW(lpString);
      if (((lpString < lpString + iVar6 + -4) &&
          (iVar6 = lstrcmpiW(lpString + iVar6 + -4,u__exe_0040a3bc), iVar6 == 0)) &&
         ((DVar7 = GetFileAttributesW(lpString), DVar7 == 0xffffffff || ((DVar7 & 0x10) == 0)))) {
        FUN_00405b7e(lpString);
      }
      pWVar8 = FUN_00405b32(lpString);
      FUN_0040617e(&DAT_00435800,pWVar8);
    }
  }
  bVar1 = FUN_00405c3a(&DAT_00435800);
  if (CONCAT31(extraout_var_00,bVar1) == 0) {
    FUN_004061a0(&DAT_00435800,*(int *)(iVar9 + 0x118));
  }
  DAT_00429228 = LoadImageW(DAT_0042a240,(LPCWSTR)0x67,1,0,0,0x8040);
  if (*(int *)(iVar9 + 0x50) == -1) {
LAB_00403bc4:
    iVar9 = FUN_0040140b(0);
    if (iVar9 == 0) {
      FUN_00403c9d();
      if (DAT_0042a2e0 == 0) {
        ShowWindow(DAT_00423708,5);
        iVar9 = FUN_004064e8("RichEd20");
        if (iVar9 == 0) {
          FUN_004064e8("RichEd32");
        }
        BVar10 = GetClassInfoW((HINSTANCE)0x0,L"RichEdit20W",(LPWNDCLASSW)&DAT_004291e0);
        if (BVar10 == 0) {
          GetClassInfoW((HINSTANCE)0x0,L"RichEdit",(LPWNDCLASSW)&DAT_004291e0);
          _DAT_00429204 = L"RichEdit20W";
          RegisterClassW((WNDCLASSW *)&DAT_004291e0);
        }
        IVar11 = DialogBoxParamW(DAT_0042a240,(LPCWSTR)(DAT_00429220 + 0x69U & 0xffff),(HWND)0x0,
                                 (DLGPROC)&LAB_00403d6a,0);
        FUN_0040140b(5);
        FUN_00403917(1);
        return IVar11;
      }
      iVar9 = FUN_004053b0((HWND)0x0);
      if (iVar9 == 0) {
        FUN_0040140b(1);
        goto LAB_00403c93;
      }
      if (DAT_0042920c == 0) {
        FUN_0040140b(2);
      }
    }
    IVar11 = 2;
  }
  else {
    _DAT_004291e4 = FUN_00401000;
    _DAT_004291f0 = DAT_0042a240;
    _DAT_00429204 = (wchar_t *)&DAT_0040a3b4;
    _DAT_004291f4 = DAT_00429228;
    AVar2 = RegisterClassW((WNDCLASSW *)&DAT_004291e0);
    if (AVar2 != 0) {
      SystemParametersInfoW(0x30,0,&iStack_10,0);
      DAT_00423708 = CreateWindowExW(0x80,(LPCWSTR)&DAT_0040a3b4,(LPCWSTR)0x0,0x80000000,iStack_10,
                                     iStack_c,iStack_8 - iStack_10,iStack_4 - iStack_c,(HWND)0x0,
                                     (HMENU)0x0,DAT_0042a240,(LPVOID)0x0);
      goto LAB_00403bc4;
    }
LAB_00403c93:
    IVar11 = 0;
  }
  return IVar11;
}



/* Function: FUN_00403c9d */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00403c9d(void)

{
  int iVar1;
  LPCWSTR lpString;
  ushort *puVar2;
  ushort uVar3;
  int iVar4;
  int *piVar5;
  
  uVar3 = 0xffff;
  iVar1 = FUN_004060de((ushort *)&DAT_00437000);
  do {
    if (DAT_0042a284 != 0) {
      puVar2 = (ushort *)(*(int *)(DAT_0042a250 + 100) * DAT_0042a284 + _DAT_0042a280);
      iVar4 = DAT_0042a284;
      do {
        puVar2 = (ushort *)((int)puVar2 - *(int *)(DAT_0042a250 + 100));
        iVar4 = iVar4 + -1;
        if (((*puVar2 ^ (ushort)iVar1) & uVar3) == 0) {
          DAT_00429220 = *(undefined4 *)(puVar2 + 1);
          DAT_0042a2e8 = *(undefined4 *)(puVar2 + 3);
          DAT_0042921c = puVar2 + 5;
          if (DAT_0042921c != (ushort *)0x0) {
            FUN_004060c5((LPWSTR)&DAT_00437000,(uint)*puVar2);
            lpString = (LPCWSTR)FUN_004061a0((LPWSTR)&DAT_00429240,-2);
            SetWindowTextW(DAT_00423708,lpString);
            piVar5 = DAT_0042a268;
            for (iVar1 = DAT_0042a26c; iVar1 != 0; iVar1 = iVar1 + -1) {
              if (*piVar5 != 0) {
                FUN_004061a0((LPWSTR)(piVar5 + 6),*piVar5);
              }
              piVar5 = piVar5 + 0x206;
            }
            return;
          }
          break;
        }
      } while (iVar4 != 0);
    }
    if (uVar3 == 0xffff) {
      uVar3 = 0x3ff;
    }
    else {
      uVar3 = 0;
    }
  } while( true );
}



/* Function: FUN_0040421b */

void FUN_0040421b(WPARAM param_1)

{
  if (param_1 == 0x78) {
    DAT_0042920c = DAT_0042920c + 1;
  }
  SendMessageW(DAT_0042a248,0x408,param_1,0);
  return;
}



/* Function: FUN_00404242 */

void FUN_00404242(HWND param_1,int param_2,int param_3)

{
  LPCWSTR lpString;
  
  lpString = (LPCWSTR)FUN_004061a0((LPWSTR)0x0,param_3);
  SetDlgItemTextW(param_1,param_2 + 1000,lpString);
  return;
}



/* Function: FUN_00404264 */

void FUN_00404264(BOOL param_1)

{
  EnableWindow(DAT_00423724,param_1);
  return;
}



/* Function: FUN_00404277 */

void FUN_00404277(WPARAM param_1)

{
  SendMessageW(DAT_0042a248,0x28,param_1,1);
  return;
}



/* Function: FUN_0040428e */

void FUN_0040428e(UINT param_1)

{
  if (DAT_00429218 != (HWND)0x0) {
    SendMessageW(DAT_00429218,param_1,0,0);
  }
  return;
}



/* Function: FUN_004042a9 */

COLORREF FUN_004042a9(int param_1,HDC param_2,HWND param_3)

{
  COLORREF *pCVar1;
  COLORREF color;
  HBRUSH pHVar2;
  LOGBRUSH local_10;
  
  if ((param_1 - 0x133U < 6) &&
     (pCVar1 = (COLORREF *)GetWindowLongW(param_3,-0x15), pCVar1 != (COLORREF *)0x0)) {
    color = *pCVar1;
    if ((pCVar1[5] & 2) != 0) {
      color = GetSysColor(color);
    }
    if ((pCVar1[5] & 1) != 0) {
      SetTextColor(param_2,color);
    }
    SetBkMode(param_2,pCVar1[4]);
    local_10.lbColor = pCVar1[1];
    if ((pCVar1[5] & 8) != 0) {
      local_10.lbColor = GetSysColor(local_10.lbColor);
    }
    if ((pCVar1[5] & 4) != 0) {
      SetBkColor(param_2,local_10.lbColor);
    }
    if ((pCVar1[5] & 0x10) != 0) {
      local_10.lbStyle = pCVar1[2];
      if ((HGDIOBJ)pCVar1[3] != (HGDIOBJ)0x0) {
        DeleteObject((HGDIOBJ)pCVar1[3]);
      }
      pHVar2 = CreateBrushIndirect(&local_10);
      pCVar1[3] = (COLORREF)pHVar2;
    }
    return pCVar1[3];
  }
  return 0;
}



/* Function: FUN_00404356 */

undefined4 FUN_00404356(int param_1,LPWSTR param_2,uint param_3,int *param_4)

{
  int iVar1;
  
  lstrcpynW(param_2,(LPCWSTR)(DAT_004216f4 + param_1),param_3 >> 1);
  iVar1 = lstrlenW(param_2);
  *param_4 = iVar1 * 2;
  DAT_004216f4 = DAT_004216f4 + iVar1 * 2;
  return 0;
}



/* Function: FUN_00404390 */

undefined4 FUN_00404390(int param_1,LPSTR param_2,uint param_3,int *param_4)

{
  uint cchWideChar;
  int iVar1;
  
  cchWideChar = lstrlenW((LPCWSTR)(param_1 + DAT_004216f4 * 2));
  if (param_3 >> 1 <= cchWideChar) {
    cchWideChar = param_3 >> 1;
  }
  iVar1 = WideCharToMultiByte(0,0,(LPCWSTR)(param_1 + DAT_004216f4 * 2),cchWideChar,param_2,param_3,
                              (LPCSTR)0x0,(LPBOOL)0x0);
  *param_4 = iVar1;
  DAT_004216f4 = DAT_004216f4 + iVar1;
  return 0;
}



/* Function: FUN_004043df */

COLORREF FUN_004043df(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  uint *puVar1;
  ushort *puVar2;
  LPCWSTR lpString;
  HWND pHVar3;
  DWORD lParam;
  int iVar4;
  HCURSOR pHVar5;
  COLORREF CVar6;
  uint uVar7;
  uint uVar8;
  UINT Msg;
  WPARAM wParam;
  LPARAM lParam_00;
  LPCWSTR local_10;
  int local_c;
  code *local_8;
  
  if (param_2 == 0x110) {
    iVar4 = param_4[0xc].unused;
    if (iVar4 < 0) {
      iVar4 = *(int *)(DAT_0042921c - (iVar4 * 4 + 4));
    }
    puVar2 = (ushort *)(DAT_0042a278 + iVar4 * 2);
    uVar7 = (uint)*puVar2;
    lpString = (LPCWSTR)(puVar2 + 1);
    local_c = 0;
    local_8 = FUN_00404390;
    if (uVar7 != 2) {
      local_8 = FUN_00404356;
    }
    uVar8 = (uint)~param_4[5].unused >> 5 & 1 | param_4[5].unused & 1U;
    local_10 = lpString;
    FUN_00404242(param_1,0x22,param_4[0xd].unused);
    FUN_00404242(param_1,0x23,param_4[0xe].unused);
    CheckDlgButton(param_1,(uVar8 == 0) + 0x40a,1);
    FUN_00404264(uVar8);
    pHVar3 = GetDlgItem(param_1,1000);
    FUN_00404277((WPARAM)pHVar3);
    SendMessageW(pHVar3,0x45b,1,0);
    lParam = *(DWORD *)(DAT_0042a250 + 0x68);
    if ((int)lParam < 0) {
      lParam = GetSysColor(-lParam);
    }
    SendMessageW(pHVar3,0x443,0,lParam);
    SendMessageW(pHVar3,0x445,0,0x4010000);
    iVar4 = lstrlenW(lpString);
    SendMessageW(pHVar3,0x435,0,iVar4);
    DAT_004216f4 = 0;
    SendMessageW(pHVar3,0x449,uVar7,(LPARAM)&local_10);
    DAT_004216f4 = 0;
    return 0;
  }
  if (param_2 == 0x111) {
    if ((((short)((uint)param_3 >> 0x10) != 0) || (DAT_004216f4 != 0)) ||
       (puVar1 = (uint *)(DAT_00422700 + 0x14), (*(byte *)puVar1 & 0x20) == 0)) goto LAB_0040465f;
    lParam_00 = 0;
    wParam = 0;
    Msg = 0xf0;
    pHVar3 = GetDlgItem(param_1,0x40a);
    uVar7 = SendMessageW(pHVar3,Msg,wParam,lParam_00);
    *puVar1 = *puVar1 & 0xfffffffe | uVar7 & 1;
    FUN_00404264(uVar7 & 1);
    FUN_00404672();
  }
  if (param_2 == 0x4e) {
    pHVar3 = GetDlgItem(param_1,1000);
    if ((param_4[2].unused == 0x70b) && (param_4[3].unused == 0x201)) {
      local_c = param_4[7].unused;
      local_10 = (LPCWSTR)param_4[6].unused;
      local_8 = (code *)&DAT_004281e0;
      if ((uint)(local_c - (int)local_10) < 0x800) {
        SendMessageW(pHVar3,1099,0,(LPARAM)&local_10);
        pHVar5 = LoadCursorW((HINSTANCE)0x0,(LPCWSTR)0x7f02);
        SetCursor(pHVar5);
        ShellExecuteW(param_1,u_open_0040a3c8,(LPCWSTR)local_8,(LPCWSTR)0x0,(LPCWSTR)0x0,1);
        pHVar5 = LoadCursorW((HINSTANCE)0x0,(LPCWSTR)0x7f00);
        SetCursor(pHVar5);
      }
    }
    if ((param_4[2].unused == 0x700) && (param_4[3].unused == 0x100)) {
      if (param_4[4].unused == 0xd) {
        SendMessageW(DAT_0042a248,0x111,1,0);
      }
      if (param_4[4].unused == 0x1b) {
        SendMessageW(DAT_0042a248,0x10,0,0);
      }
      return 1;
    }
  }
  else if (param_2 == 0x40b) {
    DAT_004216f4 = DAT_004216f4 + 1;
  }
LAB_0040465f:
  CVar6 = FUN_004042a9(param_2,param_3,param_4);
  return CVar6;
}



/* Function: FUN_00404672 */

void FUN_00404672(void)

{
  HWND hWnd;
  
  hWnd = DAT_004216f0;
  if (DAT_0042a2cc == 0) {
    hWnd = DAT_00423724;
  }
  SendMessageW(hWnd,0xf4,1,1);
  return;
}



/* Function: FUN_00404696 */

void FUN_00404696(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  if (param_2 == 0x110) {
    FUN_00404242(param_1,0x1d,param_4[0xc].unused);
    SetDlgItemTextW(param_1,1000,(LPCWSTR)(&DAT_0042b000 + param_4[0xf].unused * 0x800));
  }
  FUN_004042a9(param_2,param_3,param_4);
  return;
}



/* Function: FUN_004046dd */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_004046dd(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  bool bVar1;
  HWND hWnd;
  int iVar2;
  LPWSTR pWVar3;
  FARPROC pFVar4;
  LPITEMIDLIST pv;
  undefined3 extraout_var;
  BOOL BVar5;
  uint uVar6;
  int iVar7;
  LPCWSTR lpString;
  LPCITEMIDLIST *ppIVar8;
  LPCWSTR pWVar9;
  _browseinfoW local_50;
  uint local_30;
  uint local_2c;
  undefined1 local_28 [4];
  DWORD local_24;
  int local_20;
  undefined1 local_1c [4];
  DWORD local_18;
  DWORD local_14;
  FARPROC local_10;
  int local_c;
  int local_8;
  
  local_20 = DAT_00422700;
  local_c = *(int *)(DAT_00422700 + 0x38);
  lpString = (LPCWSTR)(&DAT_0042b000 + *(int *)(DAT_00422700 + 0x3c) * 0x800);
  if (param_2 == 0x40b) {
    FUN_004058a7(0x3fb,lpString);
    FUN_00406412(lpString);
  }
  if (param_2 == 0x110) {
    hWnd = GetDlgItem(param_1,0x3fb);
    iVar2 = FUN_00405ba9((ushort *)lpString);
    if ((iVar2 != 0) && (pWVar3 = FUN_00405bdd(lpString), pWVar3 == (LPWSTR)0x0)) {
      FUN_00405b32(lpString);
    }
    DAT_00429218 = param_1;
    SetWindowTextW(hWnd,lpString);
    FUN_00404242(param_1,1,param_4[0xd].unused);
    FUN_00404242(param_1,0x14,param_4[0xc].unused);
    FUN_00404277((WPARAM)hWnd);
    pFVar4 = FUN_00406558(6);
    if (pFVar4 == (FARPROC)0x0) goto LAB_00404a1e;
    (*pFVar4)(hWnd,1);
  }
  iVar2 = local_c;
  if (param_2 == 0x111) {
    if (((uint)param_3 & 0xffff) == 0x3fb) {
      if ((short)((uint)param_3 >> 0x10) != 0x300) goto LAB_00404a1e;
      param_2 = 0x40f;
    }
    if (((uint)param_3 & 0xffff) == 0x3e9) {
      ppIVar8 = &local_50.pidlRoot;
      for (iVar7 = 7; iVar7 != 0; iVar7 = iVar7 + -1) {
        *ppIVar8 = (LPCITEMIDLIST)0x0;
        ppIVar8 = ppIVar8 + 1;
      }
      local_50.hwndOwner = param_1;
      local_50.pszDisplayName = &DAT_00423728;
      local_50.lpfn = FUN_00404a33;
      local_50.lParam = (LPARAM)lpString;
      local_50.lpszTitle = (LPCWSTR)FUN_004061a0((LPWSTR)&DAT_00421f00,iVar2);
      local_50.ulFlags = 0x41;
      pv = SHBrowseForFolderW(&local_50);
      if (pv == (LPITEMIDLIST)0x0) {
        param_2 = 0x40f;
      }
      else {
        CoTaskMemFree(pv);
        FUN_00405b32(lpString);
        if ((*(int *)(DAT_0042a250 + 0x11c) != 0) && (lpString == &DAT_00435800)) {
          FUN_004061a0((LPWSTR)0x0,*(int *)(DAT_0042a250 + 0x11c));
          iVar2 = lstrcmpiW(&DAT_004281e0,&DAT_00423728);
          if (iVar2 != 0) {
            lstrcatW(&DAT_00435800,&DAT_004281e0);
          }
        }
        DAT_00423718 = DAT_00423718 + 1;
        SetDlgItemTextW(param_1,0x3fb,lpString);
      }
    }
  }
  if ((param_2 == 0x40f) || (param_2 == 0x405)) {
    local_8 = 0;
    local_c = 0;
    FUN_004058a7(0x3fb,lpString);
    bVar1 = FUN_00405c3a(lpString);
    if (CONCAT31(extraout_var,bVar1) == 0) {
      local_8 = 1;
    }
    FUN_0040617e((LPWSTR)&DAT_004216f8,lpString);
    local_10 = FUN_00406558(1);
    if (local_10 != (FARPROC)0x0) {
      pWVar9 = (LPCWSTR)0x0;
      do {
        iVar2 = (*local_10)(&DAT_004216f8,&local_30,local_1c,local_28);
        if (iVar2 != 0) {
          local_30 = local_30 >> 10 | local_2c << 0x16;
          local_2c = local_2c >> 10;
          local_c = 1;
          goto LAB_00404977;
        }
        if (pWVar9 != (LPCWSTR)0x0) {
          *pWVar9 = L'\0';
        }
        pWVar9 = FUN_00405b7e((LPCWSTR)&DAT_004216f8);
        *pWVar9 = L'\0';
        pWVar9 = pWVar9 + -1;
        *pWVar9 = L'\\';
      } while (pWVar9 != (LPCWSTR)&DAT_004216f8);
    }
    FUN_0040617e((LPWSTR)&DAT_004216f8,lpString);
    pWVar3 = FUN_00405bdd((LPCWSTR)&DAT_004216f8);
    if (pWVar3 != (LPWSTR)0x0) {
      *pWVar3 = L'\0';
    }
    BVar5 = GetDiskFreeSpaceW((LPCWSTR)&DAT_004216f8,&local_14,&local_18,(LPDWORD)&local_10,
                              &local_24);
    if (BVar5 != 0) {
      local_30 = MulDiv(local_14 * local_18,(int)local_10,0x400);
      local_2c = (int)local_30 >> 0x1f;
      local_c = 1;
    }
LAB_00404977:
    uVar6 = FUN_00404b7a(5);
    if (((local_c != 0) && (local_2c == 0)) && (local_30 < uVar6)) {
      local_8 = 2;
    }
    if (*(int *)(DAT_0042921c + 0x10) != 0) {
      FUN_00404b62(0x3ff,-5,uVar6);
      if (local_c == 0) {
        SetDlgItemTextW(param_1,0x400,(LPCWSTR)&DAT_004216e8);
      }
      else {
        FUN_00404a99(0x400,-4,local_30,local_2c);
      }
    }
    _DAT_0042a2e4 = local_8;
    if (local_8 == 0) {
      local_8 = FUN_0040140b(7);
    }
    if ((*(uint *)(local_20 + 0x14) & 0x400) != 0) {
      local_8 = 0;
    }
    FUN_00404264((uint)(local_8 == 0));
    if ((local_8 == 0) && (DAT_00423718 == 0)) {
      FUN_00404672();
    }
    DAT_00423718 = 0;
  }
LAB_00404a1e:
  FUN_004042a9(param_2,param_3,param_4);
  return;
}



/* Function: FUN_00404a33 */

undefined4 FUN_00404a33(HWND param_1,int param_2,LPCITEMIDLIST param_3,LPWSTR param_4)

{
  BOOL BVar1;
  int iVar2;
  LPARAM lParam;
  
  if (param_2 == 1) {
    FUN_004058a7(0x3fb,param_4);
    SendMessageW(param_1,0x467,1,(LPARAM)param_4);
  }
  if (param_2 == 2) {
    BVar1 = SHGetPathFromIDListW(param_3,param_4);
    if ((BVar1 == 0) || (iVar2 = FUN_0040140b(7), iVar2 != 0)) {
      lParam = 0;
    }
    else {
      lParam = 1;
    }
    SendMessageW(param_1,0x465,0,lParam);
    return 0;
  }
  return 0;
}



/* Function: FUN_00404a99 */

void FUN_00404a99(int param_1,int param_2,uint param_3,int param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  sbyte sVar5;
  uint uVar6;
  uint uVar7;
  wchar_t *pwVar8;
  WCHAR local_84 [32];
  WCHAR local_44 [32];
  
  iVar3 = -0x24;
  if (param_4 == 0) {
    sVar5 = 0x14;
    if (param_3 < 0x100000) {
      sVar5 = 10;
      iVar3 = -0x23;
    }
    if (param_3 < 0x400) {
      sVar5 = 0;
      iVar3 = -0x22;
    }
    if (param_3 < 0xffff3333) {
      param_3 = (1 << sVar5) / 0x14 + param_3;
    }
    uVar6 = param_3 >> sVar5;
    uVar7 = ((param_3 & 0xffffff) * 10 >> sVar5) % 10;
  }
  else {
    uVar6 = param_3 >> 0x14 | param_4 << 0xc;
    uVar7 = 0;
  }
  uVar1 = FUN_004061a0(local_44,-0x21);
  uVar2 = FUN_004061a0(local_84,iVar3);
  pwVar8 = u__u__u_s_s_0040a3d4;
  iVar3 = FUN_004061a0(&DAT_00423728,param_2);
  iVar4 = lstrlenW(&DAT_00423728);
  wsprintfW((LPWSTR)(iVar3 + iVar4 * 2),pwVar8,uVar6,uVar7,uVar2,uVar1);
  SetDlgItemTextW(DAT_00429218,param_1,&DAT_00423728);
  return;
}



/* Function: FUN_00404b62 */

void FUN_00404b62(int param_1,int param_2,uint param_3)

{
  FUN_00404a99(param_1,param_2,param_3,0);
  return;
}



/* Function: FUN_00404b7a */

int FUN_00404b7a(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = 0;
  iVar2 = DAT_0042a268;
  iVar3 = DAT_0042a26c;
  if (DAT_0042a26c != 0) {
    do {
      if ((*(byte *)(iVar2 + 8) & 1) != 0) {
        iVar1 = iVar1 + *(int *)(iVar2 + param_1 * 4);
      }
      iVar3 = iVar3 + -1;
      iVar2 = iVar2 + 0x818;
    } while (iVar3 != 0);
  }
  return iVar1;
}



/* Function: FUN_00404ba7 */

undefined4 FUN_00404ba7(HWND param_1,int param_2)

{
  DWORD DVar1;
  undefined4 local_3c;
  LRESULT local_38;
  undefined4 local_18;
  tagPOINT local_14;
  byte local_c;
  LRESULT local_8;
  
  local_38 = SendMessageW(param_1,0x110a,9,0);
  if (param_2 != 0) {
    DVar1 = GetMessagePos();
    local_14.x = (LONG)(short)DVar1;
    local_14.y = (LONG)(short)(DVar1 >> 0x10);
    ScreenToClient(param_1,&local_14);
    SendMessageW(param_1,0x1111,0,(LPARAM)&local_14);
    local_38 = local_8;
    if ((local_c & 0x66) == 0) {
      return 0xffffffff;
    }
  }
  local_3c = 4;
  SendMessageW(param_1,0x113e,0,(LPARAM)&local_3c);
  return local_18;
}



/* Function: FUN_00404c27 */

void FUN_00404c27(int param_1,undefined4 param_2)

{
  FUN_0040617e(&DAT_00423728,(LPCWSTR)&DAT_0042b000);
  FUN_004060c5((LPWSTR)&DAT_0042b000,param_2);
  FUN_0040140b(param_1);
  FUN_0040617e((LPWSTR)&DAT_0042b000,&DAT_00423728);
  return;
}



/* Function: FUN_00404c59 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00404c59(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  int iVar1;
  uint uVar2;
  HBITMAP hbmImage;
  LRESULT LVar3;
  LPARAM lParam;
  WPARAM WVar4;
  LRESULT LVar5;
  uint uVar6;
  HDC pHVar7;
  HWND pHVar8;
  int iVar9;
  uint *puVar10;
  LPARAM local_54 [5];
  uint local_40;
  uint *local_3c;
  uint *local_38;
  undefined4 local_2c;
  int local_28;
  HGLOBAL local_20;
  uint *local_1c;
  int local_18;
  int local_14;
  HWND local_10;
  HWND local_c;
  HWND local_8;
  
  local_c = GetDlgItem(param_1,0x3f9);
  local_8 = GetDlgItem(param_1,0x408);
  local_14 = DAT_0042a268;
  local_18 = DAT_0042a250 + 0x94;
  if (param_2 == 0x110) {
    local_20 = (HGLOBAL)0x0;
    local_10 = (HWND)0x2;
    _DAT_0042a2a0 = param_1;
    DAT_00423720 = GlobalAlloc(0x40,DAT_0042a26c << 2);
    hbmImage = LoadBitmapW(DAT_0042a240,(LPCWSTR)0x6e);
    DAT_00423714 = 0xffffffff;
    DAT_0042371c = SetWindowLongW(local_8,-4,0x405251);
    DAT_0042370c = ImageList_Create(0x10,0x10,0x21,6,0);
    ImageList_AddMasked(DAT_0042370c,hbmImage,0xff00ff);
    SendMessageW(local_8,0x1109,2,(LPARAM)DAT_0042370c);
    LVar3 = SendMessageW(local_8,0x111c,0,0);
    if (LVar3 < 0x10) {
      SendMessageW(local_8,0x111b,0x10,0);
    }
    DeleteObject(hbmImage);
    iVar9 = 0;
    do {
      iVar1 = *(int *)(local_18 + iVar9 * 4);
      if (iVar1 != 0) {
        if (iVar9 != 0x20) {
          local_10 = (HWND)0x0;
        }
        lParam = FUN_004061a0((LPWSTR)0x0,iVar1);
        WVar4 = SendMessageW(local_c,0x143,0,lParam);
        SendMessageW(local_c,0x151,WVar4,iVar9);
      }
      pHVar8 = local_10;
      iVar9 = iVar9 + 1;
    } while (iVar9 < 0x21);
    FUN_00404242(param_1,0x15,param_4[(int)(local_10 + 3)].unused);
    FUN_00404242(param_1,0x16,param_4[(int)((int)&pHVar8[3].unused + 1)].unused);
    iVar9 = 0;
    LVar3 = 0;
    if (DAT_0042a26c < 1) {
LAB_00404e85:
      uVar6 = GetWindowLongW(local_8,-0x10);
      SetWindowLongW(local_8,-0x10,uVar6 & 0xfffffffb);
    }
    else {
      local_1c = (uint *)(local_14 + 8);
      do {
        puVar10 = local_1c + 4;
        if ((short)*puVar10 != 0) {
          uVar6 = *local_1c;
          local_54[4] = uVar6 & 0x20;
          local_54[1] = 0xffff0002;
          local_54[2] = 0xd;
          local_40 = 0x20;
          local_54[0] = LVar3;
          local_3c = puVar10;
          local_28 = iVar9;
          if ((uVar6 & 2) == 0) {
            if ((uVar6 & 4) == 0) {
              LVar5 = SendMessageW(local_8,0x1132,0,(LPARAM)local_54);
              *(LRESULT *)((int)DAT_00423720 + iVar9 * 4) = LVar5;
            }
            else {
              LVar3 = SendMessageW(local_8,0x110a,3,LVar3);
            }
          }
          else {
            local_54[2] = 0x4d;
            local_2c = 1;
            LVar3 = SendMessageW(local_8,0x1132,0,(LPARAM)local_54);
            local_20 = (HGLOBAL)0x1;
            *(LRESULT *)((int)DAT_00423720 + iVar9 * 4) = LVar3;
            LVar3 = *(LRESULT *)((int)DAT_00423720 + iVar9 * 4);
          }
        }
        iVar9 = iVar9 + 1;
        local_1c = local_1c + 0x206;
      } while (iVar9 < DAT_0042a26c);
      if (local_20 == (HGLOBAL)0x0) goto LAB_00404e85;
    }
    if (local_10 == (HWND)0x0) {
      ShowWindow(local_c,5);
      FUN_00404277((WPARAM)local_c);
      goto LAB_0040523c;
    }
    FUN_00404277((WPARAM)local_8);
  }
  if (param_2 == 0x405) {
    param_3 = (HDC)0x0;
    param_2 = 0x40f;
    param_4 = (HWND)0x1;
  }
  if (((param_2 == 0x4e) || (param_2 == 0x413)) &&
     ((local_10 = param_4, param_2 == 0x413 || (param_4[1].unused == 0x408)))) {
    if (((DAT_0042a258 & 0x200) == 0) &&
       (((param_2 == 0x413 || (param_4[2].unused == -2)) &&
        (iVar9 = FUN_00404ba7(local_8,(uint)(param_2 != 0x413)), -1 < iVar9)))) {
      puVar10 = (uint *)(iVar9 * 0x818 + 8 + local_14);
      uVar6 = *puVar10;
      if ((uVar6 & 0x10) == 0) {
        if ((uVar6 & 0x40) == 0) {
          uVar6 = uVar6 ^ 1;
        }
        else if ((char)((byte)uVar6 ^ 0x80) < '\0') {
          uVar6 = uVar6 ^ 0x80 | 1;
        }
        else {
          uVar6 = (uVar6 ^ 0x80) & 0xfffffffe;
        }
        *puVar10 = uVar6;
        FUN_0040117d(iVar9);
        param_3 = (HDC)(iVar9 + 1);
        param_4 = (HWND)(~DAT_0042a258 >> 8 & 1);
        param_2 = 0x40f;
      }
    }
    if (local_10 != (HWND)0x0) {
      if (local_10[2].unused == -0x1c3) {
        SendMessageW(local_8,0x419,0,local_10[0x17].unused);
      }
      if (local_10[2].unused == -0x1c7) {
        if (local_10[3].unused == 2) {
          puVar10 = (uint *)(local_10[0x17].unused * 0x818 + 8 + local_14);
          *puVar10 = *puVar10 | 0x20;
        }
        else {
          puVar10 = (uint *)(local_10[0x17].unused * 0x818 + 8 + local_14);
          *puVar10 = *puVar10 & 0xffffffdf;
        }
      }
    }
  }
  if (param_2 == 0x111) {
    if ((((short)param_3 != 0x3f9) || ((short)((uint)param_3 >> 0x10) != 1)) ||
       (WVar4 = SendMessageW(local_c,0x147,0,0), WVar4 == 0xffffffff)) goto LAB_0040523c;
    uVar6 = SendMessageW(local_c,0x150,WVar4,0);
    if ((uVar6 == 0xffffffff) || (*(int *)(local_18 + uVar6 * 4) == 0)) {
      uVar6 = 0x20;
    }
    FUN_00401299(uVar6);
    SendMessageW(param_1,0x420,0,uVar6);
    param_3 = (HDC)0xffffffff;
    param_4 = (HWND)0x0;
    param_2 = 0x40f;
  }
  if (param_2 == 0x200) {
    SendMessageW(local_8,0x200,0,0);
  }
  if (param_2 == 0x40b) {
    if (DAT_0042370c != (HIMAGELIST)0x0) {
      ImageList_Destroy(DAT_0042370c);
    }
    if (DAT_00423720 != (HGLOBAL)0x0) {
      GlobalFree(DAT_00423720);
    }
    DAT_0042370c = (HIMAGELIST)0x0;
    DAT_00423720 = (HGLOBAL)0x0;
    _DAT_0042a2a0 = (HWND)0x0;
  }
  if (param_2 == 0x40f) {
    FUN_004011ef(0,0);
    if (param_3 != (HDC)0x0) {
      pHVar7 = param_3;
      if (param_3 != (HDC)0xffffffff) {
        pHVar7 = (HDC)((int)&param_3[-1].unused + 3);
      }
      FUN_00404c27(8,pHVar7);
    }
    if (param_4 != (HWND)0x0) {
      param_4 = (HWND)FUN_004012e2((int)DAT_00423720);
      FUN_00401299((uint)param_4);
      iVar9 = 0;
      WVar4 = 0;
      if (0 < (int)param_4) {
        do {
          if (*(int *)(local_18 + iVar9 * 4) != 0) {
            WVar4 = WVar4 + 1;
          }
          iVar9 = iVar9 + 1;
        } while (iVar9 < (int)param_4);
      }
      SendMessageW(local_c,0x14e,WVar4,0);
      param_2 = 0x420;
    }
    FUN_004011ef(0,0);
    local_20 = DAT_00423720;
    local_3c = (uint *)0xf030;
    local_14 = 0;
    if (0 < DAT_0042a26c) {
      puVar10 = (uint *)(DAT_0042a268 + 8);
      do {
        uVar6 = *(uint *)((int)local_20 + local_14 * 4);
        if (uVar6 != 0) {
          uVar2 = *puVar10;
          local_54[3] = 8;
          if ((uVar2 & 0x100) != 0) {
            local_38 = puVar10 + 4;
            local_54[3] = 9;
            *(byte *)((int)puVar10 + 1) = *(byte *)((int)puVar10 + 1) & 0xfe;
          }
          if ((uVar2 & 0x40) == 0) {
            iVar9 = (uVar2 & 1) + 1;
            if ((uVar2 & 0x10) != 0) {
              iVar9 = (uVar2 & 1) + 4;
            }
          }
          else {
            iVar9 = 3;
          }
          local_40 = (iVar9 << 0xb | uVar2 & 8) * 2 | uVar2 & 0x20;
          local_54[4] = uVar6;
          SendMessageW(local_8,0x1102,((int)uVar2 >> 5 & 1U) + 1,uVar6);
          SendMessageW(local_8,0x113f,0,(LPARAM)(local_54 + 3));
        }
        local_14 = local_14 + 1;
        puVar10 = puVar10 + 0x206;
      } while (local_14 < DAT_0042a26c);
    }
    InvalidateRect(local_8,(RECT *)0x0,1);
    if (*(int *)(DAT_0042921c + 0x10) != 0) {
      uVar6 = FUN_00404b7a(5);
      FUN_00404b62(0x3ff,-5,uVar6);
    }
  }
  if ((param_2 == 0x420) && ((DAT_0042a258 & 0x100) != 0)) {
    iVar9 = (uint)(param_4 == (HWND)0x20) << 3;
    ShowWindow(local_8,iVar9);
    pHVar8 = GetDlgItem(param_1,0x3fe);
    ShowWindow(pHVar8,iVar9);
  }
LAB_0040523c:
  FUN_004042a9(param_2,param_3,param_4);
  return;
}



/* Function: FUN_00405251 */

LRESULT FUN_00405251(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  BOOL BVar1;
  LRESULT LVar2;
  
  if (param_2 == 0x102) {
    if (param_3 == 0x20) {
      FUN_0040428e(0x413);
      return 0;
    }
  }
  else {
    if (param_2 == 0x200) {
      BVar1 = IsWindowVisible(param_1);
      if (BVar1 == 0) goto LAB_004052c3;
      param_4 = FUN_00404ba7(param_1,1);
      param_2 = 0x419;
    }
    if ((param_2 == 0x419) && (DAT_00423714 != param_4)) {
      DAT_00423714 = param_4;
      FUN_00404c27(6,param_4);
    }
  }
LAB_004052c3:
  LVar2 = CallWindowProcW(DAT_0042371c,param_1,param_2,param_3,param_4);
  return LVar2;
}



/* Function: FUN_004052dd */

void FUN_004052dd(int param_1,LPCWSTR param_2)

{
  int iVar1;
  int iVar2;
  LRESULT LVar3;
  uint uVar4;
  undefined4 local_34;
  WPARAM local_30;
  undefined4 local_2c;
  undefined *local_20;
  uint local_c;
  HWND local_8;
  
  local_8 = DAT_00429224;
  if (DAT_00429224 != (HWND)0x0) {
    local_c = DAT_0042a2f4;
    uVar4 = DAT_0042a2f4 & 1;
    if (uVar4 == 0) {
      FUN_004061a0((LPWSTR)&DAT_00422708,param_1);
    }
    iVar1 = lstrlenW((LPCWSTR)&DAT_00422708);
    if (param_2 != (LPCWSTR)0x0) {
      iVar2 = lstrlenW(param_2);
      if (0xfff < (uint)(iVar2 + iVar1)) {
        return;
      }
      lstrcatW((LPWSTR)&DAT_00422708,param_2);
    }
    if ((local_c & 4) == 0) {
      SetWindowTextW(DAT_00429208,(LPCWSTR)&DAT_00422708);
    }
    if ((local_c & 2) == 0) {
      local_20 = &DAT_00422708;
      local_34 = 1;
      LVar3 = SendMessageW(local_8,0x1004,0,0);
      local_30 = LVar3 - uVar4;
      local_2c = 0;
      SendMessageW(local_8,0x104d - uVar4,0,(LPARAM)&local_34);
      SendMessageW(local_8,0x1013,local_30,0);
    }
    if (uVar4 != 0) {
      *(undefined2 *)(&DAT_00422708 + iVar1 * 2) = 0;
    }
  }
  return;
}



/* Function: FUN_004053b0 */

int FUN_004053b0(HWND param_1)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = DAT_0042a26c;
  iVar2 = DAT_0042a268;
  uVar1 = OleInitialize((LPVOID)0x0);
  DAT_0042a2f8 = DAT_0042a2f8 | uVar1;
  FUN_0040428e(0);
  if (iVar4 != 0) {
    piVar3 = (int *)(iVar2 + 0xc);
    do {
      iVar4 = iVar4 + -1;
      if (((*(byte *)(piVar3 + -1) & 1) != 0) && (iVar2 = FUN_00401389(*piVar3,param_1), iVar2 != 0)
         ) {
        DAT_0042a2cc = DAT_0042a2cc + 1;
        break;
      }
      piVar3 = piVar3 + 0x206;
    } while (iVar4 != 0);
  }
  FUN_0040428e(0x404);
  OleUninitialize();
  return DAT_0042a2cc;
}



/* Function: FUN_0040541c */

COLORREF FUN_0040541c(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  HWND pHVar1;
  HWND lpParameter;
  HANDLE hObject;
  HMENU hMenu;
  LPCWSTR lpNewItem;
  int iVar2;
  BOOL BVar3;
  LRESULT LVar4;
  HGLOBAL hMem;
  undefined2 *puVar5;
  COLORREF CVar6;
  int y;
  WPARAM wParam;
  int iVar7;
  DWORD dwCreationFlags;
  DWORD *lpThreadId;
  undefined1 local_44 [8];
  undefined4 local_3c;
  undefined4 local_38;
  int local_34;
  undefined2 *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 uStack_20;
  tagRECT local_1c;
  DWORD local_c;
  HWND local_8;
  
  pHVar1 = DAT_00429224;
  wParam = 0;
  local_8 = DAT_00429224;
  if (param_2 == 0x110) {
    local_34 = 0xffffffff;
    local_28 = 0xffffffff;
    local_3c = 2;
    local_38 = 0;
    local_30 = (undefined2 *)0x0;
    local_2c = 0;
    local_24 = 0;
    uStack_20 = 0;
    iVar7 = *(int *)(DAT_0042a250 + 0x5c);
    iVar2 = *(int *)(DAT_0042a250 + 0x60);
    DAT_00429210 = GetDlgItem(param_1,0x403);
    DAT_00429208 = GetDlgItem(param_1,0x3ee);
    DAT_00429224 = GetDlgItem(param_1,0x3f8);
    local_8 = DAT_00429224;
    FUN_00404277((WPARAM)DAT_00429210);
    DAT_00429214 = FUN_00404b7a(4);
    DAT_0042922c = 0;
    GetClientRect(local_8,&local_1c);
    local_34 = GetSystemMetrics(2);
    local_34 = local_1c.right - local_34;
    SendMessageW(local_8,0x1061,0,(LPARAM)&local_3c);
    SendMessageW(local_8,0x1036,0x4000,0x4000);
    if (-1 < iVar7) {
      SendMessageW(local_8,0x1001,0,iVar7);
      SendMessageW(local_8,0x1026,0,iVar7);
    }
    if (-1 < iVar2) {
      SendMessageW(local_8,0x1024,0,iVar2);
    }
    FUN_00404242(param_1,0x1b,param_4[0xc].unused);
    if (((byte)DAT_0042a258 & 3) != 0) {
      ShowWindow(DAT_00429210,0);
      if (((byte)DAT_0042a258 & 2) == 0) {
        ShowWindow(local_8,8);
      }
      else {
        DAT_00429210 = (HWND)0x0;
      }
      FUN_00404277((WPARAM)DAT_00429208);
    }
    pHVar1 = GetDlgItem(param_1,0x3ec);
    SendMessageW(pHVar1,0x401,0,0x75300000);
    if (((byte)DAT_0042a258 & 4) != 0) {
      SendMessageW(pHVar1,0x409,0,iVar2);
      SendMessageW(pHVar1,0x2001,0,iVar7);
    }
LAB_004057a5:
    CVar6 = 0;
  }
  else {
    if (param_2 == 0x405) {
      lpThreadId = &local_c;
      dwCreationFlags = 0;
      lpParameter = GetDlgItem(param_1,0x3ec);
      hObject = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_004053b0,lpParameter,dwCreationFlags,
                             lpThreadId);
      CloseHandle(hObject);
    }
    if (param_2 == 0x111) {
      if ((short)param_3 == 0x403) {
        ShowWindow(DAT_00429210,0);
        ShowWindow(pHVar1,8);
        FUN_00404277((WPARAM)pHVar1);
        goto LAB_00405622;
      }
    }
    else {
LAB_00405622:
      iVar7 = 1;
      if (param_2 == 0x404) {
        if (DAT_0042920c != 0) {
          DAT_00421ef8 = 2;
          FUN_0040421b(0x78);
          goto LAB_00405647;
        }
        ShowWindow(DAT_0042a248,8);
        if (DAT_0042a2cc == 0) {
          FUN_004052dd(*(int *)(DAT_00422700 + 0x34),(LPCWSTR)0x0);
        }
        FUN_0040421b(1);
      }
      if ((param_2 == 0x7b) && (param_3 == (HDC)local_8)) {
        pHVar1 = (HWND)SendMessageW(local_8,0x1004,0,0);
        if (0 < (int)pHVar1) {
          hMenu = CreatePopupMenu();
          lpNewItem = (LPCWSTR)FUN_004061a0((LPWSTR)0x0,-0x1f);
          AppendMenuW(hMenu,0,1,lpNewItem);
          iVar2 = (int)(short)param_4;
          y = (int)(short)((uint)param_4 >> 0x10);
          if (param_4 == (HWND)0xffffffff) {
            GetWindowRect(local_8,&local_1c);
            iVar2 = local_1c.left;
            y = local_1c.top;
          }
          BVar3 = TrackPopupMenu(hMenu,0x180,iVar2,y,0,param_1,(RECT *)0x0);
          if (BVar3 == 1) {
            local_3c = 0;
            local_30 = &DAT_00423728;
            local_2c = 0x1fff;
            param_1 = pHVar1;
            do {
              param_1 = (HWND)((int)&param_1[-1].unused + 3);
              LVar4 = SendMessageW(local_8,0x1073,(WPARAM)param_1,(LPARAM)local_44);
              iVar7 = iVar7 + 2 + LVar4;
            } while (param_1 != (HWND)0x0);
            OpenClipboard((HWND)0x0);
            EmptyClipboard();
            hMem = GlobalAlloc(0x42,iVar7 * 2);
            puVar5 = (undefined2 *)GlobalLock(hMem);
            do {
              local_30 = puVar5;
              LVar4 = SendMessageW(local_8,0x1073,wParam,(LPARAM)local_44);
              puVar5 = puVar5 + LVar4;
              *puVar5 = 0xd;
              puVar5[1] = 10;
              puVar5 = puVar5 + 2;
              wParam = wParam + 1;
            } while ((int)wParam < (int)pHVar1);
            GlobalUnlock(hMem);
            SetClipboardData(0xd,hMem);
            CloseClipboard();
          }
        }
        goto LAB_004057a5;
      }
    }
LAB_00405647:
    CVar6 = FUN_004042a9(param_2,param_3,param_4);
  }
  return CVar6;
}



/* Function: FUN_004057ac */

DWORD FUN_004057ac(LPCWSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  undefined1 local_24;
  undefined1 local_23;
  undefined2 local_22;
  undefined *local_20;
  undefined *local_1c;
  undefined4 local_18;
  undefined *local_14;
  _SECURITY_ATTRIBUTES local_10;
  
  local_23 = 0;
  local_20 = &DAT_004083f8;
  local_1c = &DAT_004083f8;
  local_10.lpSecurityDescriptor = &local_24;
  local_18 = 0;
  local_10.bInheritHandle = 0;
  local_24 = 1;
  local_22 = 4;
  local_14 = &DAT_004083e8;
  local_10.nLength = 0xc;
  BVar1 = CreateDirectoryW(param_1,&local_10);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 != 0xb7) {
      return DVar2;
    }
    BVar1 = SetFileSecurityW(param_1,0x80000007,&local_24);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      return DVar2;
    }
  }
  return 0;
}



/* Function: FUN_00405829 */

DWORD FUN_00405829(LPCWSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  
  BVar1 = CreateDirectoryW(param_1,(LPSECURITY_ATTRIBUTES)0x0);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
  }
  else {
    DVar2 = 0;
  }
  return DVar2;
}



/* Function: FUN_00405846 */

undefined4 FUN_00405846(void)

{
  FARPROC pFVar1;
  int iVar2;
  
  pFVar1 = FUN_00406558(5);
  if (pFVar1 != (FARPROC)0x0) {
    iVar2 = (*pFVar1)();
    if (iVar2 != 0) {
      return 1;
    }
  }
  return 0;
}



/* Function: FUN_0040585e */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

HANDLE FUN_0040585e(LPWSTR param_1)

{
  HANDLE pvVar1;
  _PROCESS_INFORMATION local_14;
  
  _DAT_00426730 = 0x44;
  pvVar1 = (HANDLE)CreateProcessW((LPCWSTR)0x0,param_1,(LPSECURITY_ATTRIBUTES)0x0,
                                  (LPSECURITY_ATTRIBUTES)0x0,0,0x4000000,(LPVOID)0x0,(LPCWSTR)0x0,
                                  (LPSTARTUPINFOW)&DAT_00426730,&local_14);
  if (pvVar1 != (HANDLE)0x0) {
    CloseHandle(local_14.hThread);
    pvVar1 = local_14.hProcess;
  }
  return pvVar1;
}



/* Function: SetDlgItemTextW */

BOOL SetDlgItemTextW(HWND hDlg,int nIDDlgItem,LPCWSTR lpString)

{
  BOOL BVar1;
  
                    /* WARNING: Could not recover jumptable at 0x004058a1. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  BVar1 = SetDlgItemTextW(hDlg,nIDDlgItem,lpString);
  return BVar1;
}



/* Function: FUN_004058a7 */

void FUN_004058a7(int param_1,LPWSTR param_2)

{
  GetDlgItemTextW(DAT_00429218,param_1,param_2,0x400);
  return;
}



/* Function: FUN_004058c3 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_004058c3(undefined4 param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = param_2 & 0x1fffff;
  if ((DAT_0042a2e0 == 0) || (param_2 >> 0x15 == 0)) {
    if (DAT_0042a2e8 != 0) {
      uVar1 = uVar1 ^ 0x180000;
    }
    _DAT_0040a3ec = DAT_0042a248;
    _DAT_0040a3f0 = DAT_0042a240;
    _DAT_0040a3f4 = param_1;
    _DAT_0040a3f8 = &DAT_00429240;
    _DAT_0040a3fc = uVar1;
    MessageBoxIndirectW((MSGBOXPARAMSW *)&DAT_0040a3e8);
  }
  return;
}



/* Function: FUN_00405927 */

undefined4 FUN_00405927(LPCWSTR param_1,byte param_2)

{
  DWORD dwFileAttributes;
  int iVar1;
  
  dwFileAttributes = FUN_00405d2e(param_1);
  if (dwFileAttributes != 0xffffffff) {
    if ((param_2 & 1) == 0) {
      iVar1 = DeleteFileW(param_1);
    }
    else {
      iVar1 = RemoveDirectoryW(param_1);
    }
    if (iVar1 != 0) {
      return 1;
    }
    if ((param_2 & 4) == 0) {
      SetFileAttributesW(param_1,dwFileAttributes);
    }
  }
  return 0;
}



/* Function: FUN_0040596f */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0040596f(LPCWSTR param_1,uint param_2)

{
  uint uVar1;
  bool bVar2;
  undefined3 extraout_var;
  BOOL BVar3;
  int iVar4;
  HANDLE hFindFile;
  int iVar5;
  undefined *puVar6;
  _WIN32_FIND_DATAW local_25c;
  int local_c;
  uint local_8;
  
  local_8 = param_2 & 4;
  bVar2 = FUN_00405c3a(param_1);
  local_c = CONCAT31(extraout_var,bVar2);
  if ((param_2 & 8) == 0) {
    uVar1 = param_2 & 1;
    if ((uVar1 == 0) || ((local_c != 0 && ((param_2 & 2) != 0)))) {
      FUN_0040617e(&DAT_00425730,param_1);
      if (uVar1 == 0) {
        FUN_00405b7e(param_1);
      }
      else {
        lstrcatW(&DAT_00425730,u______0040a574);
      }
      if ((*param_1 != L'\0') || (DAT_00425730 == 0x5c)) {
        lstrcatW(param_1,(LPCWSTR)&DAT_0040a014);
      }
      iVar4 = lstrlenW(param_1);
      hFindFile = FindFirstFileW(&DAT_00425730,&local_25c);
      if (hFindFile != (HANDLE)0xffffffff) {
        do {
          if ((local_25c.cFileName[0] != L'.') ||
             ((local_25c.cFileName[1] != L'\0' &&
              ((local_25c.cFileName[1] != L'.' || (local_25c.cFileName[2] != L'\0')))))) {
            FUN_0040617e(param_1 + iVar4,local_25c.cFileName);
            if (((byte)local_25c.dwFileAttributes & 0x10) == 0) {
              iVar5 = FUN_00405927(param_1,(byte)local_8);
              if (iVar5 == 0) {
                if (local_8 == 0) {
                  _DAT_0042a2c8 = _DAT_0042a2c8 + 1;
                }
                else {
                  FUN_004052dd(-0xf,param_1);
                  FUN_0040601f(param_1,(LPCWSTR)0x0);
                }
              }
              else {
                FUN_004052dd(-0xe,param_1);
              }
            }
            else if (((byte)param_2 & 3) == 3) {
              FUN_0040596f(param_1,param_2);
            }
          }
          BVar3 = FindNextFileW(hFindFile,&local_25c);
        } while (BVar3 != 0);
        FindClose(hFindFile);
      }
      if (uVar1 != 0) {
        (param_1 + iVar4)[-1] = L'\0';
      }
    }
    if (uVar1 != 0) {
      if (local_c != 0) {
        puVar6 = FUN_004064c1(param_1);
        if (puVar6 == (undefined *)0x0) {
          return;
        }
        FUN_00405b32(param_1);
        iVar4 = FUN_00405927(param_1,(byte)local_8 | 1);
        if (iVar4 != 0) {
          FUN_004052dd(-0x1b,param_1);
          return;
        }
        if (local_8 != 0) {
          FUN_004052dd(-0xf,param_1);
          FUN_0040601f(param_1,(LPCWSTR)0x0);
          return;
        }
      }
      _DAT_0042a2c8 = _DAT_0042a2c8 + 1;
    }
  }
  else {
    BVar3 = DeleteFileW(param_1);
    _DAT_0042a2c8 = _DAT_0042a2c8 + (uint)(BVar3 == 0);
  }
  return;
}



/* Function: FUN_00405b32 */

LPCWSTR FUN_00405b32(LPCWSTR param_1)

{
  int iVar1;
  LPWSTR pWVar2;
  
  iVar1 = lstrlenW(param_1);
  pWVar2 = CharPrevW(param_1,param_1 + iVar1);
  if (*pWVar2 != L'\\') {
    lstrcatW(param_1,(LPCWSTR)&DAT_0040a014);
  }
  return param_1;
}



/* Function: FUN_00405b5f */

void FUN_00405b5f(LPCWSTR param_1,WCHAR param_2)

{
  for (; (*param_1 != L'\0' && (*param_1 != param_2)); param_1 = CharNextW(param_1)) {
  }
  return;
}



/* Function: FUN_00405b7e */

LPCWSTR FUN_00405b7e(LPCWSTR param_1)

{
  int iVar1;
  LPCWSTR lpszCurrent;
  
  iVar1 = lstrlenW(param_1);
  lpszCurrent = param_1 + iVar1;
  do {
    if (*lpszCurrent == L'\\') break;
    lpszCurrent = CharPrevW(param_1,lpszCurrent);
  } while (param_1 < lpszCurrent);
  *lpszCurrent = L'\0';
  return lpszCurrent + 1;
}



/* Function: FUN_00405ba9 */

undefined4 FUN_00405ba9(ushort *param_1)

{
  ushort uVar1;
  undefined4 uVar2;
  
  uVar1 = *param_1 | 0x20;
  if (((*param_1 == 0x5c) && (param_1[1] == 0x5c)) ||
     ((0x60 < uVar1 && ((uVar1 < 0x7b && (param_1[1] == 0x3a)))))) {
    uVar2 = 1;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



/* Function: FUN_00405bdd */

LPWSTR FUN_00405bdd(LPCWSTR param_1)

{
  LPWSTR lpsz;
  LPWSTR lpsz_00;
  short *psVar1;
  int iVar2;
  
  lpsz = CharNextW(param_1);
  lpsz_00 = CharNextW(lpsz);
  if (((*param_1 == L'\0') || (*lpsz != L':')) || (lpsz[1] != L'\\')) {
    if ((*param_1 == L'\\') && (param_1[1] == L'\\')) {
      iVar2 = 2;
      do {
        iVar2 = iVar2 + -1;
        psVar1 = (short *)FUN_00405b5f(lpsz_00,L'\\');
        if (*psVar1 == 0) goto LAB_00405c32;
        lpsz_00 = psVar1 + 1;
      } while (iVar2 != 0);
    }
    else {
LAB_00405c32:
      lpsz_00 = (LPWSTR)0x0;
    }
  }
  else {
    lpsz_00 = CharNextW(lpsz_00);
  }
  return lpsz_00;
}



/* Function: FUN_00405c3a */

bool FUN_00405c3a(LPCWSTR param_1)

{
  LPWSTR pWVar1;
  byte *pbVar2;
  int iVar3;
  DWORD DVar4;
  
  FUN_0040617e((LPWSTR)&DAT_00425f30,param_1);
  pWVar1 = FUN_00405bdd((LPCWSTR)&DAT_00425f30);
  if ((pWVar1 != (LPWSTR)0x0) &&
     ((FUN_00406412(pWVar1), ((byte)DAT_0042a258 & 0x80) == 0 ||
      ((*pWVar1 != L'\0' && (*pWVar1 != L'\\')))))) {
    while( true ) {
      iVar3 = lstrlenW((LPCWSTR)&DAT_00425f30);
      if (iVar3 <= (int)(pWVar1 + -0x212f98) >> 1) {
        FUN_00405b32((LPCWSTR)&DAT_00425f30);
        DVar4 = GetFileAttributesW((LPCWSTR)&DAT_00425f30);
        return DVar4 != 0xffffffff;
      }
      pbVar2 = FUN_004064c1((LPCWSTR)&DAT_00425f30);
      if ((pbVar2 != (byte *)0x0) && ((*pbVar2 & 0x10) == 0)) break;
      FUN_00405b7e((LPCWSTR)&DAT_00425f30);
    }
  }
  return false;
}



/* Function: FUN_00405cb8 */

LPCSTR FUN_00405cb8(LPSTR param_1,LPCSTR param_2)

{
  CHAR CVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = lstrlenA(param_2);
  while( true ) {
    iVar3 = lstrlenA(param_1);
    if (iVar3 < iVar2) {
      return (LPCSTR)0x0;
    }
    CVar1 = param_1[iVar2];
    param_1[iVar2] = '\0';
    iVar3 = lstrcmpiA(param_1,param_2);
    param_1[iVar2] = CVar1;
    if (iVar3 == 0) break;
    param_1 = CharNextA(param_1);
  }
  return param_1;
}



/* Function: FUN_00405d0e */

void FUN_00405d0e(undefined1 *param_1,int param_2,int param_3)

{
  int iVar1;
  
  if (param_3 != 0) {
    iVar1 = param_2 - (int)param_1;
    do {
      *param_1 = param_1[iVar1];
      param_1 = param_1 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return;
}



/* Function: FUN_00405d2e */

DWORD FUN_00405d2e(LPCWSTR param_1)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesW(param_1);
  if (DVar1 != 0xffffffff) {
    SetFileAttributesW(param_1,DVar1 & 0xfffffffe);
  }
  return DVar1;
}



/* Function: FUN_00405d53 */

void FUN_00405d53(LPCWSTR param_1,DWORD param_2,DWORD param_3)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesW(param_1);
  CreateFileW(param_1,param_2,1,(LPSECURITY_ATTRIBUTES)0x0,param_3,
              -(uint)(DVar1 != 0xffffffff) & DVar1,(HANDLE)0x0);
  return;
}



/* Function: FUN_00405d82 */

LPWSTR FUN_00405d82(LPWSTR param_1,LPCWSTR param_2)

{
  DWORD DVar1;
  UINT UVar2;
  int iVar3;
  undefined4 local_c;
  undefined4 local_8;
  
  iVar3 = 100;
  do {
    iVar3 = iVar3 + -1;
    local_c = DAT_0040a580;
    local_8 = DAT_0040a584;
    DVar1 = GetTickCount();
    local_8 = CONCAT22(local_8._2_2_,(short)local_8 + (short)(DVar1 % 0x1a));
    UVar2 = GetTempFileNameW(param_2,(LPCWSTR)&local_c,0,param_1);
    if (UVar2 != 0) {
      return param_1;
    }
  } while (iVar3 != 0);
  *param_1 = L'\0';
  return (LPWSTR)0x0;
}



/* Function: FUN_00405dd6 */

undefined4 FUN_00405dd6(HANDLE param_1,LPVOID param_2,DWORD param_3)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  
  DVar1 = param_3;
  BVar2 = ReadFile(param_1,param_2,param_3,&param_3,(LPOVERLAPPED)0x0);
  if ((BVar2 == 0) || (DVar1 != param_3)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



/* Function: FUN_00405e05 */

undefined4 FUN_00405e05(HANDLE param_1,LPCVOID param_2,DWORD param_3)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  
  DVar1 = param_3;
  BVar2 = WriteFile(param_1,param_2,param_3,&param_3,(LPOVERLAPPED)0x0);
  if ((BVar2 == 0) || (DVar1 != param_3)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



/* Function: FUN_00405e34 */

int FUN_00405e34(HANDLE param_1,int param_2)

{
  HANDLE hFile;
  DWORD DVar1;
  int iVar2;
  
  hFile = param_1;
  DVar1 = SetFilePointer(param_1,0,(PLONG)0x0,1);
  if (DVar1 == 0) {
    iVar2 = FUN_00405dd6(hFile,(LPVOID)((int)&param_1 + 2),2);
    if (((iVar2 != 0) && (param_1._2_1_ == -1)) && (param_1._3_1_ == -2)) {
      return 0;
    }
    if ((param_2 != 0) && (DVar1 = SetFilePointer(hFile,0,(PLONG)0x0,1), DVar1 == 0)) {
      iVar2 = FUN_00405e05(hFile,&DAT_0040841c,2);
      return (-(uint)(iVar2 != 0) & 0x7fffbffb) + 0x80004005;
    }
    SetFilePointer(hFile,0,(PLONG)0x0,0);
  }
  return 1;
}



/* Function: FUN_00405ead */

void __cdecl FUN_00405ead(LPCWSTR param_1,LPCWSTR param_2)

{
  HANDLE pvVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR pCVar4;
  LPSTR hMem;
  int iVar5;
  LPCSTR pCVar6;
  LPCSTR pCVar7;
  CHAR *pCVar8;
  LPSTR pCVar9;
  
  lstrcpyW((LPWSTR)&DAT_00426dc8,(LPCWSTR)&DAT_0040a5a4);
  if (param_2 != (LPCWSTR)0x0) {
    pvVar1 = (HANDLE)FUN_00405d53(param_2,0,1);
    CloseHandle(pvVar1);
    DVar2 = GetShortPathNameW(param_2,(LPWSTR)&DAT_00426dc8,0x400);
    if (DVar2 == 0) {
      return;
    }
    if (0x400 < (int)DVar2) {
      return;
    }
  }
  DVar2 = GetShortPathNameW(param_1,(LPWSTR)&DAT_004275c8,0x400);
  if ((DVar2 != 0) && ((int)DVar2 < 0x401)) {
    iVar3 = wsprintfA(&DAT_004269c8,s__ls__ls_0040a598,&DAT_00426dc8,&DAT_004275c8);
    FUN_004061a0((LPWSTR)&DAT_004275c8,*(int *)(DAT_0042a250 + 0x128));
    pvVar1 = (HANDLE)FUN_00405d53((LPCWSTR)&DAT_004275c8,0xc0000000,4);
    if (pvVar1 != (HANDLE)0xffffffff) {
      pCVar4 = (LPCSTR)GetFileSize(pvVar1,(LPDWORD)0x0);
      hMem = (LPSTR)GlobalAlloc(0x40,(SIZE_T)(pCVar4 + iVar3 + 10));
      if ((hMem != (LPSTR)0x0) && (iVar5 = FUN_00405dd6(pvVar1,hMem,(DWORD)pCVar4), iVar5 != 0)) {
        pCVar6 = FUN_00405cb8(hMem,s__Rename__0040a58c);
        if (pCVar6 == (LPCSTR)0x0) {
          lstrcpyA(hMem + (int)pCVar4,s__Rename__0040a58c);
          pCVar4 = pCVar4 + 10;
          pCVar6 = pCVar4;
        }
        else {
          pCVar7 = FUN_00405cb8(pCVar6 + 10,&DAT_0040a588);
          pCVar6 = pCVar4;
          if (pCVar7 != (LPCSTR)0x0) {
            pCVar9 = hMem + (int)pCVar4;
            pCVar8 = pCVar9 + iVar3;
            for (; pCVar7 < pCVar9; pCVar9 = pCVar9 + -1) {
              *pCVar8 = *pCVar9;
              pCVar8 = pCVar8 + -1;
            }
            pCVar6 = pCVar7 + (1 - (int)hMem);
          }
        }
        FUN_00405d0e(hMem + (int)pCVar6,0x4269c8,iVar3);
        SetFilePointer(pvVar1,0,(PLONG)0x0,0);
        FUN_00405e05(pvVar1,hMem,(DWORD)(pCVar4 + iVar3));
        GlobalFree(hMem);
      }
      CloseHandle(pvVar1);
    }
  }
  return;
}



/* Function: FUN_0040601f */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0040601f(LPCWSTR param_1,LPCWSTR param_2)

{
  BOOL BVar1;
  
  BVar1 = MoveFileExW(param_1,param_2,5);
  if (BVar1 == 0) {
    FUN_00405ead(param_1,param_2);
  }
  _DAT_0042a2d0 = _DAT_0042a2d0 + 1;
  return;
}



/* Function: FUN_0040604b */

void FUN_0040604b(HKEY param_1,LPCWSTR param_2,LPCWSTR param_3,LPBYTE param_4,HKEY param_5)

{
  LPBYTE pBVar1;
  LSTATUS LVar2;
  
  pBVar1 = param_4;
  pBVar1[0] = '\0';
  pBVar1[1] = '\0';
  LVar2 = RegOpenKeyExW(param_1,param_2,0,-(uint)(param_5 != (HKEY)0x0) & 0x100 | 0x20019,&param_5);
  if (LVar2 == 0) {
    param_2 = (LPCWSTR)0x800;
    LVar2 = RegQueryValueExW(param_5,param_3,(LPDWORD)0x0,(LPDWORD)&param_4,pBVar1,(LPDWORD)&param_2
                            );
    if ((LVar2 != 0) || ((param_4 != (LPBYTE)0x1 && (param_4 != (LPBYTE)0x2)))) {
      pBVar1[0] = '\0';
      pBVar1[1] = '\0';
    }
    pBVar1[0x7fe] = '\0';
    pBVar1[0x7ff] = '\0';
    RegCloseKey(param_5);
  }
  return;
}



/* Function: FUN_004060c5 */

void FUN_004060c5(LPWSTR param_1,undefined4 param_2)

{
  wsprintfW(param_1,L"%d",param_2);
  return;
}



/* Function: FUN_004060de */

int FUN_004060de(ushort *param_1)

{
  ushort uVar1;
  ushort uVar2;
  ushort *puVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int local_c;
  int local_8;
  
  local_8 = 0;
  uVar2 = 10;
  local_c = 1;
  uVar6 = 0x39;
  if (*param_1 == 0x2d) {
    param_1 = param_1 + 1;
    local_c = -1;
  }
  puVar3 = param_1;
  if (*param_1 == 0x30) {
    puVar3 = param_1 + 1;
    uVar1 = *puVar3;
    if ((0x2f < uVar1) && (uVar1 < 0x38)) {
      uVar2 = 8;
      uVar6 = 0x37;
    }
    if ((uVar1 & 0xffdf) == 0x58) {
      uVar2 = 0x10;
      puVar3 = param_1 + 2;
    }
  }
  do {
    uVar4 = (uint)*puVar3;
    puVar3 = puVar3 + 1;
    if ((uVar4 < 0x30) || (uVar6 < uVar4)) {
      if ((uVar2 != 0x10) || (((uVar4 & 0xffffffdf) < 0x41 || (0x46 < (uVar4 & 0xffffffdf))))) {
        return local_c * local_8;
      }
      iVar5 = (uVar4 & 7) + 9;
    }
    else {
      iVar5 = uVar4 - 0x30;
    }
    local_8 = (uint)uVar2 * local_8 + iVar5;
  } while( true );
}



/* Function: FUN_0040617e */

void FUN_0040617e(LPWSTR param_1,LPCWSTR param_2)

{
  lstrcpynW(param_1,param_2,0x400);
  return;
}



/* Function: lstrlenW */

int lstrlenW(LPCWSTR lpString)

{
  int iVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00406194. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = lstrlenW(lpString);
  return iVar1;
}



/* Function: lstrcatW */

LPWSTR lstrcatW(LPWSTR lpString1,LPCWSTR lpString2)

{
  LPWSTR pWVar1;
  
                    /* WARNING: Could not recover jumptable at 0x0040619a. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  pWVar1 = lstrcatW(lpString1,lpString2);
  return pWVar1;
}



/* Function: FUN_004061a0 */

void FUN_004061a0(LPWSTR param_1,int param_2)

{
  byte bVar1;
  WCHAR WVar2;
  bool bVar3;
  LPWSTR pWVar4;
  DWORD DVar5;
  int iVar6;
  HRESULT HVar7;
  BOOL BVar8;
  int iVar9;
  WCHAR *pWVar10;
  uint uVar11;
  uint uVar12;
  LPWSTR lpBuffer;
  uint local_1c [4];
  LPCITEMIDLIST local_c;
  WCHAR *local_8;
  
  pWVar4 = param_1;
  if (param_2 < 0) {
    param_2 = *(int *)(DAT_0042921c - (param_2 * 4 + 4));
  }
  pWVar10 = (WCHAR *)(DAT_0042a278 + param_2 * 2);
  lpBuffer = &DAT_004281e0;
  if (((LPWSTR)0x4281df < param_1) && ((uint)((int)(param_1 + -0x2140f0) >> 1) < 0x800)) {
    param_1 = (LPWSTR)0x0;
    lpBuffer = pWVar4;
  }
  do {
    while( true ) {
      WVar2 = *pWVar10;
      if ((WVar2 == L'\0') || (0x7ff < (int)((uint)(lpBuffer + -0x2140f0) & 0xfffffffe))) {
        *lpBuffer = L'\0';
        if (param_1 != (LPWSTR)0x0) {
          FUN_0040617e(param_1,&DAT_004281e0);
        }
        return;
      }
      local_8 = pWVar10 + 1;
      if ((ushort)WVar2 < 4) break;
      if (WVar2 == L'\x04') {
        *lpBuffer = *local_8;
        lpBuffer = lpBuffer + 1;
        pWVar10 = pWVar10 + 2;
      }
      else {
        *lpBuffer = WVar2;
        lpBuffer = lpBuffer + 1;
        pWVar10 = local_8;
      }
    }
    bVar1 = (byte)*local_8;
    local_8 = pWVar10 + 2;
    uVar11 = (*(byte *)((int)pWVar10 + 3) & 0x7f) << 7 | bVar1 & 0x7f;
    uVar12 = (uint)bVar1;
    local_1c[3] = (uint)*(byte *)((int)pWVar10 + 3);
    local_1c[0] = uVar12 | 0x8000;
    local_1c[2] = local_1c[3] | 0x8000;
    local_1c[1] = uVar12;
    if (WVar2 == L'\x02') {
      iVar9 = 2;
      DVar5 = GetVersion();
      if (((((int)DVar5 < 0) && ((short)DVar5 != 0x5a04)) && (local_1c[3] != 0x23)) &&
         (local_1c[3] != 0x2e)) {
        bVar3 = false;
      }
      else {
        bVar3 = true;
      }
      if (DAT_0042a2c4 != 0) {
        iVar9 = 4;
      }
      if ((char)bVar1 < '\0') {
        FUN_0040604b((HKEY)0x80000002,L"Software\\Microsoft\\Windows\\CurrentVersion",
                     (LPCWSTR)(DAT_0042a278 + (uVar12 & 0x3f) * 2),(LPBYTE)lpBuffer,
                     (HKEY)(uVar12 & 0x40));
        if (*lpBuffer == L'\0') {
          FUN_004061a0(lpBuffer,local_1c[3]);
          goto LAB_0040635b;
        }
LAB_00406361:
        if (local_1c[3] == 0x1a) {
          lstrcatW(lpBuffer,L"\\Microsoft\\Internet Explorer\\Quick Launch");
        }
      }
      else {
        if (uVar12 == 0x25) {
          GetSystemDirectoryW(lpBuffer,0x400);
        }
        else {
          if (uVar12 == 0x24) {
            GetWindowsDirectoryW(lpBuffer,0x400);
            iVar9 = 0;
          }
          while ((iVar9 != 0 &&
                 (((iVar9 = iVar9 + -1, DAT_0042a244 == (code *)0x0 || (!bVar3)) ||
                  (iVar6 = (*DAT_0042a244)(DAT_0042a248,local_1c[iVar9],0,0,lpBuffer), iVar6 != 0)))
                 )) {
            HVar7 = SHGetSpecialFolderLocation(DAT_0042a248,local_1c[iVar9],&local_c);
            if (HVar7 == 0) {
              BVar8 = SHGetPathFromIDListW(local_c,lpBuffer);
              CoTaskMemFree(local_c);
              if (BVar8 != 0) break;
            }
            *lpBuffer = L'\0';
          }
        }
LAB_0040635b:
        if (*lpBuffer != L'\0') goto LAB_00406361;
      }
LAB_00406372:
      FUN_00406412(lpBuffer);
    }
    else if (WVar2 == L'\x03') {
      if (uVar11 == 0x1d) {
        FUN_004060c5(lpBuffer,DAT_0042a248);
      }
      else {
        FUN_0040617e(lpBuffer,(LPCWSTR)(&DAT_0042b000 + uVar11 * 0x800));
      }
      if (uVar11 - 0x15 < 7) goto LAB_00406372;
    }
    else if (WVar2 == L'\x01') {
      FUN_004061a0(lpBuffer,-1 - uVar11);
    }
    iVar9 = lstrlenW(lpBuffer);
    lpBuffer = lpBuffer + iVar9;
    pWVar10 = local_8;
  } while( true );
}



/* Function: FUN_00406412 */

void FUN_00406412(LPCWSTR param_1)

{
  WCHAR WVar1;
  int iVar2;
  short *psVar3;
  LPWSTR pWVar4;
  LPCWSTR lpsz;
  LPCWSTR lpsz_00;
  
  if ((((*param_1 == L'\\') && (param_1[1] == L'\\')) && (param_1[2] == L'?')) &&
     (param_1[3] == L'\\')) {
    param_1 = param_1 + 4;
  }
  if ((*param_1 != L'\0') && (iVar2 = FUN_00405ba9((ushort *)param_1), iVar2 != 0)) {
    param_1 = param_1 + 2;
  }
  WVar1 = *param_1;
  lpsz_00 = param_1;
  lpsz = param_1;
  while (WVar1 != L'\0') {
    if ((0x1f < (ushort)WVar1) &&
       (psVar3 = (short *)FUN_00405b5f(u____<>____0040a5ac,WVar1), *psVar3 == 0)) {
      pWVar4 = CharNextW(lpsz_00);
      FUN_00405d0e((undefined1 *)lpsz,(int)lpsz_00,(int)pWVar4 - (int)lpsz_00 >> 1);
      lpsz = CharNextW(lpsz);
    }
    lpsz_00 = CharNextW(lpsz_00);
    WVar1 = *lpsz_00;
  }
  *lpsz = L'\0';
  while( true ) {
    lpsz = CharPrevW(param_1,lpsz);
    if ((*lpsz != L' ') && (*lpsz != L'\\')) break;
    *lpsz = L'\0';
    if (lpsz <= param_1) {
      return;
    }
  }
  return;
}



/* Function: FUN_004064c1 */

undefined * FUN_004064c1(LPCWSTR param_1)

{
  HANDLE hFindFile;
  undefined *puVar1;
  
  hFindFile = FindFirstFileW(param_1,(LPWIN32_FIND_DATAW)&DAT_00426778);
  if (hFindFile == (HANDLE)0xffffffff) {
    puVar1 = (undefined *)0x0;
  }
  else {
    FindClose(hFindFile);
    puVar1 = &DAT_00426778;
  }
  return puVar1;
}



/* Function: FUN_004064e8 */

void FUN_004064e8(undefined4 param_1)

{
  UINT UVar1;
  int iVar2;
  WCHAR local_240 [286];
  
  UVar1 = GetSystemDirectoryW(local_240,0x104);
  if (0x104 < UVar1) {
    UVar1 = 0;
  }
  if ((UVar1 == 0) || (local_240[UVar1 - 1] == L'\\')) {
    iVar2 = 1;
  }
  else {
    iVar2 = 0;
  }
  wsprintfW(local_240 + UVar1,u__s_S_dll_0040a5c0,&DAT_0040a014 + iVar2 * 2,param_1);
  LoadLibraryExW(local_240,(HANDLE)0x0,8);
  return;
}



/* Function: FUN_00406558 */

FARPROC FUN_00406558(int param_1)

{
  LPCSTR lpModuleName;
  HMODULE hModule;
  FARPROC pFVar1;
  
  lpModuleName = (&PTR_s_KERNEL32_0040a410)[param_1 * 2];
  hModule = GetModuleHandleA(lpModuleName);
  if ((hModule == (HMODULE)0x0) &&
     (hModule = (HMODULE)FUN_004064e8(lpModuleName), hModule == (HMODULE)0x0)) {
    return (FARPROC)0x0;
  }
  pFVar1 = GetProcAddress(hModule,(&PTR_s_SetDefaultDllDirectories_0040a414)[param_1 * 2]);
  return pFVar1;
}



/* Function: FUN_00406594 */

void FUN_00406594(UINT param_1)

{
  BOOL BVar1;
  MSG local_20;
  
  while( true ) {
    BVar1 = PeekMessageW(&local_20,(HWND)0x0,param_1,param_1,1);
    if (BVar1 == 0) break;
    DispatchMessageW(&local_20);
  }
  return;
}



/* Function: FUN_004065c7 */

FARPROC FUN_004065c7(HMODULE param_1,LPCWSTR param_2)

{
  int iVar1;
  FARPROC pFVar2;
  CHAR local_104 [256];
  
  iVar1 = WideCharToMultiByte(0,0,param_2,-1,local_104,0x100,(LPCSTR)0x0,(LPBOOL)0x0);
  if (iVar1 == 0) {
    pFVar2 = (FARPROC)0x0;
  }
  else {
    pFVar2 = GetProcAddress(param_1,local_104);
  }
  return pFVar2;
}



/* Function: FUN_00406609 */

uint FUN_00406609(uint param_1,byte *param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  
  if (DAT_00427dcc == 0) {
    uVar2 = 0;
    do {
      iVar3 = 8;
      uVar1 = uVar2;
      do {
        uVar1 = uVar1 >> 1 ^ -(uint)((uVar1 & 1) != 0) & 0xedb88320;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
      (&DAT_00427dc8)[uVar2] = uVar1;
      uVar2 = uVar2 + 1;
    } while ((int)uVar2 < 0x100);
  }
  uVar2 = ~param_1;
  if (param_3 != 0) {
    do {
      uVar2 = uVar2 >> 8 ^ (&DAT_00427dc8)[uVar2 & 0xff ^ (uint)*param_2];
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return ~uVar2;
}



/* Function: FUN_00406677 */

void __fastcall FUN_00406677(int param_1)

{
  int iVar1;
  
  iVar1 = 0x80;
  do {
    iVar1 = iVar1 + -1;
    *(undefined1 *)(iVar1 + param_1) = 0;
  } while (iVar1 != 0);
  *(undefined4 *)(param_1 + 0x78) = 0xffffffff;
  *(undefined4 *)(param_1 + 0x68) = 1;
  *(undefined4 *)(param_1 + 100) = 1;
  *(undefined4 *)(param_1 + 0x60) = 1;
  *(undefined4 *)(param_1 + 0x5c) = 1;
  return;
}



/* Function: FUN_00406697 */

undefined4 __fastcall FUN_00406697(SIZE_T *param_1)

{
  byte bVar1;
  ushort uVar2;
  ulonglong uVar3;
  SIZE_T dwBytes;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  ushort *puVar11;
  SIZE_T *pSVar12;
  SIZE_T *pSVar13;
  bool bVar14;
  SIZE_T local_8c [5];
  uint local_78;
  byte *local_74;
  int local_70;
  byte *local_6c;
  int local_68;
  uint local_64;
  byte local_60;
  byte local_5f;
  ushort *local_5c;
  ushort *local_58;
  int local_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  undefined4 local_40;
  int local_3c;
  int local_38;
  int local_34;
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  uint local_10;
  HGLOBAL local_c;
  HGLOBAL local_8;
  
  pSVar12 = param_1;
  pSVar13 = local_8c;
  for (iVar9 = 0x22; iVar9 != 0; iVar9 = iVar9 + -1) {
    *pSVar13 = *pSVar12;
    pSVar12 = pSVar12 + 1;
    pSVar13 = pSVar13 + 1;
  }
  uVar10 = local_48;
  puVar11 = local_58;
  if (local_34 == -1) {
    return 1;
  }
LAB_004066ca:
  do {
    uVar6 = local_24;
    uVar8 = local_30;
    pbVar5 = local_6c;
    pbVar4 = local_74;
    switch(local_8c[0]) {
    case 0:
      if (local_70 == 0) goto LAB_004070cc;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      bVar1 = *pbVar4;
      if (0xe1 < bVar1) {
        return 0xffffffff;
      }
      uVar3 = (ulonglong)((uint)bVar1 % 0x2d) % 9;
      local_40 = (int)uVar3;
      local_20 = (1 << bVar1 / 0x2d) - 1;
      local_1c = (1 << (sbyte)((ulonglong)((uint)bVar1 % 0x2d) / 9)) - 1;
      iVar9 = (0x300 << (char)uVar3 + bVar1 / 0x2d) + 0x736;
      dwBytes = iVar9 * 2;
      if (dwBytes != local_8c[4]) {
        if (local_8 != (HGLOBAL)0x0) {
          GlobalFree(local_8);
        }
        local_8 = GlobalAlloc(0x40,dwBytes);
        if (local_8 == (HGLOBAL)0x0) {
          return 0xffffffff;
        }
        local_8c[4] = dwBytes;
      }
      while (iVar9 != 0) {
        iVar9 = iVar9 + -1;
        *(undefined2 *)((int)local_8 + iVar9 * 2) = 0x400;
      }
      local_44 = 0;
      for (local_4c = 0; (int)local_4c < 4; local_4c = local_4c + 1) {
switchD_004066d9_caseD_1:
        if (local_70 == 0) {
          local_8c[0] = 1;
          goto LAB_004070cc;
        }
        local_70 = local_70 + -1;
        local_44 = local_44 | (uint)*local_74 << ((byte)(local_4c << 3) & 0x1f);
        local_74 = local_74 + 1;
      }
      if (local_44 != local_78) {
        local_78 = local_44;
        if (local_c != (HGLOBAL)0x0) {
          GlobalFree(local_c);
        }
        local_c = GlobalAlloc(0x40,local_44);
        if (local_c == (HGLOBAL)0x0) {
          return 0xffffffff;
        }
      }
      local_4c = 5;
      *(undefined1 *)((int)local_c + (local_78 - 1)) = 0;
      while (uVar8 = local_4c, local_4c = local_4c - 1, uVar8 != 0) {
switchD_004066d9_caseD_3:
        if (local_70 == 0) {
          local_8c[0] = 3;
          goto LAB_004070cc;
        }
        local_70 = local_70 + -1;
        bVar1 = *local_74;
        local_74 = local_74 + 1;
        local_10 = local_10 << 8 | (uint)bVar1;
      }
    case 2:
      local_8c[1] = 6;
      local_50 = local_64 & local_20;
      puVar11 = (ushort *)((int)local_8 + (local_3c * 0x10 + (local_64 & local_20)) * 2);
      break;
    case 1:
      goto switchD_004066d9_caseD_1;
    case 3:
      goto switchD_004066d9_caseD_3;
    case 4:
      goto switchD_004066d9_caseD_4;
    case 5:
      goto switchD_004066d9_caseD_5;
    case 6:
      if (local_44 != 0) {
        local_38 = 1;
        local_8c[1] = 7;
        puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x180);
        break;
      }
      local_5c = (ushort *)
                 (((uint)(local_60 >> (8 - (byte)local_40 & 0x1f)) +
                  ((local_64 & local_1c) << ((byte)local_40 & 0x1f))) * 0x600 + 0xe6c + (int)local_8
                 );
      if (local_3c < 4) {
        local_3c = 0;
      }
      else if (local_3c < 10) {
        local_3c = local_3c + -3;
      }
      else {
        local_3c = local_3c + -6;
      }
      if (local_38 != 0) {
        uVar8 = local_18 - local_30;
        if (local_78 <= uVar8) {
          uVar8 = uVar8 + local_78;
        }
        uVar10 = 1;
        local_5f = *(byte *)(uVar8 + (int)local_c);
        do {
          bVar1 = local_5f;
          local_5f = local_5f << 1;
          local_4c = (uint)(bVar1 >> 7);
          puVar11 = local_5c + ((bVar1 >> 7) + 1) * 0x100 + uVar10;
          uVar2 = *puVar11;
          local_58 = puVar11;
          uVar8 = (local_14 >> 0xb) * (uint)uVar2;
          bVar14 = uVar8 <= local_10;
          if (bVar14) {
            local_14 = local_14 - uVar8;
            local_10 = local_10 - uVar8;
            local_44 = 1;
            uVar10 = uVar10 * 2 + 1;
            *puVar11 = uVar2 - (uVar2 >> 5);
          }
          else {
            local_44 = 0;
            local_14 = uVar8;
            uVar10 = uVar10 * 2;
            *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
          }
          local_44 = (uint)bVar14;
          local_48 = uVar10;
          if (local_14 < 0x1000000) {
switchD_004066d9_caseD_d:
            if (local_70 == 0) {
              local_8c[0] = 0xd;
              goto LAB_004070cc;
            }
            local_14 = local_14 << 8;
            bVar1 = *local_74;
            local_70 = local_70 + -1;
            local_74 = local_74 + 1;
            local_10 = local_10 << 8 | (uint)bVar1;
          }
          if (local_4c != local_44) goto LAB_004069bd;
        } while ((int)uVar10 < 0x100);
        goto LAB_00406a21;
      }
      uVar10 = 1;
      do {
        puVar11 = local_5c + uVar10;
        uVar2 = *puVar11;
        local_58 = puVar11;
        uVar8 = (local_14 >> 0xb) * (uint)uVar2;
        if (local_10 < uVar8) {
          local_14 = uVar8;
          uVar10 = uVar10 * 2;
          *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
        }
        else {
          local_14 = local_14 - uVar8;
          local_10 = local_10 - uVar8;
          uVar10 = uVar10 * 2 + 1;
          *puVar11 = uVar2 - (uVar2 >> 5);
        }
        local_48 = uVar10;
        if (local_14 < 0x1000000) {
switchD_004066d9_caseD_f:
          if (local_70 == 0) {
            local_8c[0] = 0xf;
            goto LAB_004070cc;
          }
          local_14 = local_14 << 8;
          bVar1 = *local_74;
          local_70 = local_70 + -1;
          local_74 = local_74 + 1;
          local_10 = local_10 << 8 | (uint)bVar1;
        }
      } while ((int)uVar10 < 0x100);
      goto LAB_00406a25;
    case 7:
      if (local_44 != 1) {
        local_8c[2] = 0x16;
        local_24 = local_28;
        local_28 = local_2c;
        local_2c = local_30;
        local_3c = ((6 < local_3c) - 1 & 0xfffffffd) + 10;
        local_5c = (ushort *)((int)local_8 + 0x664);
        goto switchD_004066d9_caseD_11;
      }
      local_8c[1] = 8;
      puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x198);
      break;
    case 8:
      if (local_44 == 0) {
        local_8c[1] = 9;
        puVar11 = (ushort *)((int)local_8 + ((local_3c + 0xf) * 0x10 + local_50) * 2);
      }
      else {
        local_8c[1] = 10;
        puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x1b0);
      }
      break;
    case 9:
      if (local_44 != 0) goto LAB_00406c4d;
      if (local_64 == 0) {
        return 0xffffffff;
      }
      local_3c = (uint)(6 < local_3c) * 2 + 9;
    case 0x1b:
      if (local_68 == 0) {
        local_8c[0] = 0x1b;
        goto LAB_004070cc;
      }
      uVar8 = local_18 - local_30;
      if (local_78 <= uVar8) {
        uVar8 = uVar8 + local_78;
      }
      local_60 = *(byte *)(uVar8 + (int)local_c);
      *(byte *)(local_18 + (int)local_c) = local_60;
      local_64 = local_64 + 1;
      local_6c = local_6c + 1;
      local_68 = local_68 + -1;
      *pbVar5 = local_60;
      goto LAB_00406bf1;
    case 10:
      if (local_44 == 0) goto LAB_00406c44;
      local_8c[1] = 0xb;
      puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x1c8);
      break;
    case 0xb:
      uVar7 = local_28;
      if (local_44 != 0) {
        local_24 = local_28;
        uVar7 = uVar6;
      }
      local_28 = local_2c;
      local_2c = uVar7;
LAB_00406c44:
      local_30 = local_2c;
      local_2c = uVar8;
LAB_00406c4d:
      local_8c[2] = 0x15;
      local_5c = (ushort *)((int)local_8 + 0xa68);
    case 0x11:
switchD_004066d9_caseD_11:
      local_8c[1] = 0x12;
      puVar11 = local_5c;
      break;
    case 0xc:
      while (local_70 != 0) {
        local_14 = local_14 << 8;
        bVar1 = *local_74;
        local_70 = local_70 + -1;
        local_74 = local_74 + 1;
        local_10 = local_10 << 8 | (uint)bVar1;
        uVar8 = local_30;
        do {
          local_4c = local_4c - 1;
LAB_00406d15:
          if ((int)local_4c < 1) {
            local_44 = 4;
            local_30 = uVar8 + uVar10 * 0x10;
            local_5c = (ushort *)((int)local_8 + 0x644);
            goto LAB_00406d59;
          }
          uVar10 = uVar10 * 2;
          local_14 = local_14 >> 1;
          local_48 = uVar10;
          if (local_14 <= local_10) {
            local_10 = local_10 - local_14;
            uVar10 = uVar10 | 1;
            local_48 = uVar10;
          }
        } while (0xffffff < local_14);
      }
      local_8c[0] = 0xc;
      goto LAB_004070cc;
    case 0xd:
      goto switchD_004066d9_caseD_d;
    case 0xe:
      goto switchD_004066d9_caseD_e;
    case 0xf:
      goto switchD_004066d9_caseD_f;
    case 0x10:
      goto switchD_004066d9_caseD_10;
    case 0x12:
      if (local_44 == 0) {
        local_34 = 0;
        iVar9 = local_50 * 8 + 2;
LAB_00406e93:
        local_5c = local_5c + iVar9;
        local_44 = 3;
        goto LAB_00406f70;
      }
      local_8c[1] = 0x13;
      puVar11 = local_5c + 1;
      break;
    case 0x13:
      if (local_44 == 0) {
        local_34 = 8;
        iVar9 = local_50 * 8 + 0x82;
        goto LAB_00406e93;
      }
      local_5c = local_5c + 0x102;
      local_34 = 0x10;
      local_44 = 8;
LAB_00406f70:
      local_8c[3] = 0x14;
    case 0x17:
switchD_004066d9_caseD_17:
      local_54 = 1;
      for (local_4c = local_44; 0 < (int)local_4c; local_4c = local_4c - 1) {
        puVar11 = local_5c + local_54;
        local_58 = puVar11;
        uVar2 = *puVar11;
        uVar10 = (local_14 >> 0xb) * (uint)uVar2;
        if (local_10 < uVar10) {
          local_14 = uVar10;
          local_54 = local_54 << 1;
          *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
        }
        else {
          local_14 = local_14 - uVar10;
          local_10 = local_10 - uVar10;
          *puVar11 = uVar2 - (uVar2 >> 5);
          local_54 = local_54 * 2 + 1;
        }
        if (local_14 < 0x1000000) {
switchD_004066d9_caseD_18:
          if (local_70 == 0) {
            local_8c[0] = 0x18;
            goto LAB_004070cc;
          }
          local_14 = local_14 << 8;
          bVar1 = *local_74;
          local_70 = local_70 + -1;
          local_74 = local_74 + 1;
          local_10 = local_10 << 8 | (uint)bVar1;
        }
      }
      uVar10 = local_54 - (1 << ((byte)local_44 & 0x1f));
      local_48 = uVar10;
      local_8c[0] = local_8c[3];
      goto LAB_00406f2e;
    case 0x14:
      local_34 = local_34 + uVar10;
      local_8c[0] = local_8c[2];
      goto LAB_00406f2e;
    case 0x15:
      local_3c = ((6 < local_3c) - 1 & 0xfffffffd) + 0xb;
      goto LAB_00406e15;
    case 0x16:
      iVar9 = local_34;
      if (3 < local_34) {
        iVar9 = 3;
      }
      local_44 = 6;
      local_8c[3] = 0x19;
      local_5c = (ushort *)(iVar9 * 0x80 + 0x360 + (int)local_8);
      goto switchD_004066d9_caseD_17;
    case 0x18:
      goto switchD_004066d9_caseD_18;
    case 0x19:
      local_30 = uVar10;
      if (3 < (int)uVar10) {
        iVar9 = (int)uVar10 >> 1;
        local_44 = iVar9 - 1;
        uVar8 = (uint)((byte)uVar10 & 1 | 2) << ((byte)local_44 & 0x1f);
        local_30 = uVar8;
        if (0xd < (int)uVar10) {
          uVar10 = 0;
          local_4c = iVar9 - 5;
          goto LAB_00406d15;
        }
        local_5c = (ushort *)((int)local_8 + (uVar8 - uVar10) * 2 + 0x55e);
LAB_00406d59:
        uVar10 = 0;
        local_54 = 1;
        local_48 = 0;
        for (local_4c = 0; (int)local_4c < (int)local_44; local_4c = local_4c + 1) {
          puVar11 = local_5c + local_54;
          local_58 = puVar11;
          uVar2 = *puVar11;
          uVar8 = (local_14 >> 0xb) * (uint)uVar2;
          if (local_10 < uVar8) {
            local_14 = uVar8;
            local_54 = local_54 << 1;
            *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
          }
          else {
            local_14 = local_14 - uVar8;
            local_10 = local_10 - uVar8;
            uVar10 = local_48 | 1 << ((byte)local_4c & 0x1f);
            local_48 = uVar10;
            *puVar11 = uVar2 - (uVar2 >> 5);
            local_54 = local_54 * 2 + 1;
          }
          if (local_14 < 0x1000000) {
switchD_004066d9_caseD_10:
            if (local_70 == 0) {
              local_8c[0] = 0x10;
              goto LAB_004070cc;
            }
            local_14 = local_14 << 8;
            bVar1 = *local_74;
            local_70 = local_70 + -1;
            local_74 = local_74 + 1;
            local_10 = local_10 << 8 | (uint)bVar1;
          }
        }
        local_30 = local_30 + uVar10;
      }
      local_30 = local_30 + 1;
LAB_00406e15:
      if (local_30 == 0) {
        local_34 = 0xffffffff;
        goto LAB_004070cc;
      }
      if (local_64 < local_30) {
        return 0xffffffff;
      }
      local_34 = local_34 + 2;
      local_64 = local_64 + local_34;
switchD_004066d9_caseD_1c:
      do {
        pbVar4 = local_6c;
        if (local_68 == 0) {
          local_8c[0] = 0x1c;
          goto LAB_004070cc;
        }
        uVar8 = local_18 - local_30;
        if (local_78 <= uVar8) {
          uVar8 = uVar8 + local_78;
        }
        local_60 = *(byte *)(uVar8 + (int)local_c);
        *(byte *)(local_18 + (int)local_c) = local_60;
        local_6c = local_6c + 1;
        local_68 = local_68 + -1;
        local_34 = local_34 + -1;
        *pbVar4 = local_60;
        local_18 = (local_18 + 1) % local_78;
      } while (0 < local_34);
      goto LAB_00406bf4;
    case 0x1a:
      goto switchD_004066d9_caseD_1a;
    case 0x1c:
      goto switchD_004066d9_caseD_1c;
    default:
      return 0xffffffff;
    }
    local_58 = puVar11;
switchD_004066d9_caseD_4:
    uVar2 = *puVar11;
    uVar8 = (local_14 >> 0xb) * (uint)uVar2;
    bVar14 = uVar8 <= local_10;
    if (bVar14) {
      local_14 = local_14 - uVar8;
      local_10 = local_10 - uVar8;
      local_44 = 1;
      *puVar11 = uVar2 - (uVar2 >> 5);
    }
    else {
      local_14 = uVar8;
      local_44 = 0;
      *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
    }
    local_44 = (uint)bVar14;
    local_8c[0] = local_8c[1];
    if (local_14 < 0x1000000) {
switchD_004066d9_caseD_5:
      if (local_70 == 0) {
        local_8c[0] = 5;
        goto LAB_004070cc;
      }
      local_14 = local_14 << 8;
      bVar1 = *local_74;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      local_10 = local_10 << 8 | (uint)bVar1;
      local_8c[0] = local_8c[1];
    }
LAB_00406f2e:
  } while( true );
LAB_004069bd:
  if ((int)uVar10 < 0x100) {
    puVar11 = local_5c + uVar10;
    uVar2 = *puVar11;
    local_58 = puVar11;
    uVar8 = (local_14 >> 0xb) * (uint)uVar2;
    if (local_10 < uVar8) {
      local_14 = uVar8;
      uVar10 = uVar10 * 2;
      *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
    }
    else {
      local_14 = local_14 - uVar8;
      local_10 = local_10 - uVar8;
      uVar10 = uVar10 * 2 + 1;
      *puVar11 = uVar2 - (uVar2 >> 5);
    }
    local_48 = uVar10;
    if (local_14 < 0x1000000) {
switchD_004066d9_caseD_e:
      if (local_70 == 0) {
        local_8c[0] = 0xe;
        goto LAB_004070cc;
      }
      local_14 = local_14 << 8;
      bVar1 = *local_74;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      local_10 = local_10 << 8 | (uint)bVar1;
    }
    goto LAB_004069bd;
  }
LAB_00406a21:
  local_38 = 0;
LAB_00406a25:
  local_60 = (byte)local_48;
switchD_004066d9_caseD_1a:
  if (local_68 == 0) {
    local_8c[0] = 0x1a;
LAB_004070cc:
    pSVar12 = local_8c;
    for (iVar9 = 0x22; iVar9 != 0; iVar9 = iVar9 + -1) {
      *param_1 = *pSVar12;
      pSVar12 = pSVar12 + 1;
      param_1 = param_1 + 1;
    }
    return 0;
  }
  local_64 = local_64 + 1;
  local_6c = local_6c + 1;
  local_68 = local_68 + -1;
  *pbVar5 = local_60;
  *(byte *)(local_18 + (int)local_c) = local_60;
LAB_00406bf1:
  local_18 = (local_18 + 1) % local_78;
LAB_00406bf4:
  local_8c[0] = 2;
  goto LAB_004066ca;
}



