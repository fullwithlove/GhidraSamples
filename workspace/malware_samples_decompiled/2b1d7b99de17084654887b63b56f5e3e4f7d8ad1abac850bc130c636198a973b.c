/* Function: FUN_00401219 */

/* WARNING: Control flow encountered bad instruction data */

void __fastcall FUN_00401219(int param_1,undefined4 *param_2)

{
  uint *puVar1;
  undefined4 uVar2;
  int in_EAX;
  short sVar3;
  int unaff_EBP;
  undefined4 unaff_ESI;
  byte *pbVar4;
  undefined4 unaff_EDI;
  undefined2 in_CS;
  byte abStack_b5 [113];
  
  puVar1 = (uint *)((int)param_2 + 0xe);
  *puVar1 = *puVar1 >> 0x16 | *puVar1 << 10;
  pbVar4 = (byte *)(CONCAT22((short)((uint)unaff_EDI >> 0x10),in_CS) + -1);
  *pbVar4 = *pbVar4 ^ (byte)((uint)param_1 >> 8);
  LOCK();
  uVar2 = *param_2;
  *param_2 = unaff_ESI;
  UNLOCK();
  sVar3 = (short)uVar2 + -1;
  if (param_1 != 0) {
    out(sVar3,CONCAT31((int3)(in_EAX + 0xe577ac79U >> 8),
                       *(byte *)((int)param_2 + (in_EAX + 0xe577ac79U & 0xff)) |
                       abStack_b5[unaff_EBP]));
    out(*pbVar4,sVar3);
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}



/* Function: entry */

/* WARNING: Unable to track spacebase fully for stack */

void entry(void)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  int *piVar4;
  uint *puVar5;
  short sVar6;
  undefined2 in_SS;
  int *piVar7;
  
  sVar6 = (short)&stack0xffffffe0 + -4;
  piVar7 = (int *)CONCAT22((short)((uint)&stack0xffffffe0 >> 0x10),sVar6);
  puVar3 = (undefined4 *)segment(in_SS,sVar6);
  *puVar3 = 0x43300c;
  piVar4 = (int *)(*piVar7 + 0x5a);
  do {
    puVar5 = (uint *)*piVar4;
    iVar1 = piVar4[1];
    uVar2 = piVar4[2];
    do {
      *puVar5 = *puVar5 ^ uVar2;
      puVar5 = puVar5 + 1;
    } while ((int)puVar5 < iVar1);
    piVar4 = piVar4 + 3;
  } while (*piVar4 != 0);
  FUN_00401219(piVar7[7],(undefined4 *)piVar7[6]);
  return;
}



