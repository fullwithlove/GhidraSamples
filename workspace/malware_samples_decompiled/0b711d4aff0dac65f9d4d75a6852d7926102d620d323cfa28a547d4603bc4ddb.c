/* Function: FUN_00401000 */

LRESULT FUN_00401000(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  int iVar1;
  LONG LVar2;
  LRESULT LVar3;
  HDC hDC;
  HBRUSH hbr;
  HFONT h;
  HGDIOBJ h_00;
  int iVar4;
  tagPAINTSTRUCT local_60;
  tagRECT local_20;
  LOGBRUSH local_10;
  
  iVar1 = DAT_00472ddc;
  if (param_2 == 0xf) {
    hDC = BeginPaint(param_1,&local_60);
    local_10.lbStyle = 0;
    GetClientRect(param_1,&local_20);
    LVar2 = local_20.bottom;
    local_20.bottom = 0;
    for (; local_20.top < LVar2; local_20.top = local_20.top + 4) {
      iVar4 = LVar2 - local_20.top;
      local_10.lbColor =
           (((int)((uint)*(byte *)(iVar1 + 0x52) * iVar4 +
                  (uint)*(byte *)(iVar1 + 0x56) * local_20.top) / LVar2 & 0xffU) << 8 |
           (int)((uint)*(byte *)(iVar1 + 0x51) * iVar4 +
                (uint)*(byte *)(iVar1 + 0x55) * local_20.top) / LVar2 & 0xffU) << 8 |
           (int)((uint)*(byte *)(iVar1 + 0x50) * iVar4 +
                (uint)*(byte *)(iVar1 + 0x54) * local_20.top) / LVar2 & 0xffU;
      hbr = CreateBrushIndirect(&local_10);
      local_20.bottom = local_20.bottom + 4;
      FillRect(hDC,&local_20,hbr);
      DeleteObject(hbr);
    }
    if (*(int *)(iVar1 + 0x58) != -1) {
      h = CreateFontIndirectW(*(LOGFONTW **)(iVar1 + 0x34));
      if (h != (HFONT)0x0) {
        local_20.left = 0x10;
        local_20.top = 8;
        SetBkMode(hDC,1);
        SetTextColor(hDC,*(COLORREF *)(iVar1 + 0x58));
        h_00 = SelectObject(hDC,h);
        DrawTextW(hDC,(LPCWSTR)&DAT_0046adc0,-1,&local_20,0x820);
        SelectObject(hDC,h_00);
        DeleteObject(h);
      }
    }
    EndPaint(param_1,&local_60);
    LVar3 = 0;
  }
  else {
    if (param_2 == 0x46) {
      *(uint *)(param_4 + 0x18) = *(uint *)(param_4 + 0x18) | 0x10;
      *(undefined4 *)(param_4 + 4) = DAT_00472dd4;
    }
    LVar3 = DefWindowProcW(param_1,param_2,param_3,param_4);
  }
  return LVar3;
}



/* Function: FUN_00401186 */

void FUN_00401186(int param_1)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  
  uVar1 = *(uint *)(param_1 * 0x4020 + 8 + DAT_00472de8);
  if ((uVar1 & 2) != 0) {
    uVar4 = param_1 + 1;
    if (uVar4 < DAT_00472dec) {
      puVar3 = (uint *)(uVar4 * 0x4020 + 8 + DAT_00472de8);
      iVar5 = 0;
      do {
        uVar2 = *puVar3;
        if ((uVar2 & 2) == 0) {
          if ((uVar2 & 4) == 0) {
            iVar6 = iVar5;
            if ((uVar2 & 0x10) == 0) {
              *puVar3 = (uVar2 ^ uVar1) & 1 ^ uVar2;
            }
          }
          else {
            iVar6 = iVar5 + -1;
            if (iVar5 == 0) {
              return;
            }
          }
        }
        else {
          iVar6 = iVar5 + 1;
        }
        uVar4 = uVar4 + 1;
        puVar3 = puVar3 + 0x1008;
        iVar5 = iVar6;
      } while (uVar4 < DAT_00472dec);
    }
  }
  return;
}



/* Function: FUN_004011f8 */

uint FUN_004011f8(uint param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int local_c;
  int local_8;
  
  iVar2 = DAT_00472de8;
  iVar5 = param_1 * 0x4020 + DAT_00472de8;
  local_8 = 0;
  local_c = 0;
  if (((*(uint *)(iVar5 + 8) & 2) != 0) && (param_2 != 0)) {
    *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) & 0xffffffbe;
    param_1 = param_1 + 1;
  }
  if (param_1 < DAT_00472dec) {
    do {
      puVar1 = (uint *)(param_1 * 0x4020 + 8 + iVar2);
      uVar4 = *puVar1;
      uVar3 = param_1 + 1;
      if ((uVar4 & 2) != 0) {
        uVar3 = FUN_004011f8(param_1,1);
        uVar4 = *puVar1;
      }
      if ((uVar4 & 4) != 0) {
        if (local_8 == 0) {
          return uVar3;
        }
        if (local_c != 0) {
          *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) | 0x40;
          return uVar3;
        }
        *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) & 0xffffff7f | 1;
        return uVar3;
      }
      if ((uVar4 & 0x40) != 0) {
        local_8 = local_8 + 1;
      }
      if ((uVar4 & 1) == 0) {
        local_c = local_c + 1;
      }
      else {
        local_8 = local_8 + 1;
      }
      param_1 = uVar3;
    } while (uVar3 < DAT_00472dec);
  }
  return 0;
}



/* Function: FUN_004012a6 */

void FUN_004012a6(uint param_1)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  
  uVar3 = 0;
  if ((param_1 < 0x20) && (DAT_00472dec != 0)) {
    puVar2 = (uint *)(DAT_00472de8 + 8);
    do {
      uVar1 = *puVar2;
      if ((uVar1 & 6) == 0) {
        if ((puVar2[-1] & 1 << ((byte)param_1 & 0x1f)) == 0) {
          uVar1 = uVar1 & 0xfffffffe;
        }
        else {
          uVar1 = uVar1 | 1;
        }
        *puVar2 = uVar1;
      }
      uVar3 = uVar3 + 1;
      puVar2 = puVar2 + 0x1008;
    } while (uVar3 < DAT_00472dec);
  }
  return;
}



/* Function: FUN_004012f1 */

uint FUN_004012f1(int param_1)

{
  uint uVar1;
  uint *puVar2;
  bool bVar3;
  int *local_c;
  uint local_8;
  
  local_8 = 0;
  local_c = (int *)(DAT_00472ddc + 0x94);
  do {
    uVar1 = 0;
    if (*local_c != 0) {
      bVar3 = DAT_00472dec == 0;
      if (DAT_00472dec != 0) {
        puVar2 = (uint *)(DAT_00472de8 + 8);
        do {
          if (((*puVar2 & 6) == 0) &&
             (((param_1 == 0 || (*(int *)(param_1 + uVar1 * 4) != 0)) &&
              ((puVar2[-1] & 1 << ((byte)local_8 & 0x1f)) != (*puVar2 & 1) << ((byte)local_8 & 0x1f)
              )))) break;
          uVar1 = uVar1 + 1;
          puVar2 = puVar2 + 0x1008;
        } while (uVar1 < DAT_00472dec);
        bVar3 = uVar1 == DAT_00472dec;
      }
      if (bVar3) {
        return local_8;
      }
    }
    local_8 = local_8 + 1;
    local_c = local_c + 1;
    if (0x1f < local_8) {
      return local_8;
    }
  } while( true );
}



/* Function: FUN_0040137e */

void FUN_0040137e(int param_1)

{
  if (param_1 < 0) {
    FUN_004060cb((ushort *)(&DAT_00473000 + (param_1 + 1) * -0x4008));
  }
  return;
}



/* Function: FUN_0040139d */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_0040139d(int param_1,HWND param_2)

{
  HMODULE pHVar1;
  HKEY pHVar2;
  int iVar3;
  int iVar4;
  WPARAM wParam;
  LPARAM lParam;
  
  while ((-1 < param_1 && (pHVar1 = (HMODULE)(param_1 * 0x1c + _DAT_00472df0), pHVar1->unused != 1))
        ) {
    pHVar2 = FUN_004015a0(pHVar1);
    if (pHVar2 == (HKEY)0x7fffffff) {
      return 0x7fffffff;
    }
    iVar3 = FUN_0040137e((int)pHVar2);
    if (iVar3 == 0) {
      iVar4 = 1;
      iVar3 = param_1 + 1;
    }
    else {
      iVar3 = iVar3 + -1;
      iVar4 = iVar3 - param_1;
    }
    param_1 = iVar3;
    if (param_2 != (HWND)0x0) {
      DAT_0046adac = DAT_0046adac + iVar4;
      lParam = 0;
      wParam = MulDiv(DAT_0046adac,30000,DAT_0046ada4);
      SendMessageW(param_2,0x402,wParam,lParam);
    }
  }
  return 0;
}



/* Function: FUN_0040141d */

void FUN_0040141d(int param_1)

{
  FUN_0040139d(*(int *)(DAT_00472ddc + 0x6c + param_1 * 4),(HWND)0x0);
  return;
}



/* Function: FUN_00401435 */

void FUN_00401435(int param_1)

{
  FUN_004050d2(param_1,(LPCWSTR)&DAT_0040f0d0);
  return;
}



/* Function: FUN_00401446 */

void __fastcall FUN_00401446(int param_1)

{
  ushort *puVar1;
  
  puVar1 = (ushort *)FUN_00406966((LPWSTR)0x0,*(int *)(DAT_0040b0c4 + param_1 * 4));
  FUN_004060cb(puVar1);
  return;
}



/* Function: FUN_0040145c */

LPCWSTR FUN_0040145c(uint param_1)

{
  uint uVar1;
  LPCWSTR pWVar2;
  
  uVar1 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  pWVar2 = (LPCWSTR)FUN_00406966((LPWSTR)(&DAT_0040b0c8 + ((int)uVar1 >> 4) * 0x4008),
                                 *(int *)(DAT_0040b0c4 + (uVar1 & 0xf) * 4));
  if ((int)param_1 < 0) {
    FUN_00406199(pWVar2);
  }
  return pWVar2;
}



/* Function: FUN_0040149d */

LSTATUS FUN_0040149d(HKEY param_1,LPCWSTR param_2,int param_3)

{
  LSTATUS LVar1;
  code *pcVar2;
  WCHAR local_214 [262];
  HKEY local_8;
  
  LVar1 = RegOpenKeyExW(param_1,param_2,0,DAT_00472eb0 | 8,&local_8);
  if (LVar1 == 0) {
    do {
      LVar1 = RegEnumKeyW(local_8,0,local_214,0x105);
      if (LVar1 != 0) break;
      if (param_3 != 0) {
        RegCloseKey(local_8);
        goto LAB_0040152f;
      }
      LVar1 = FUN_0040149d(local_8,local_214,0);
    } while (LVar1 == 0);
    RegCloseKey(local_8);
    pcVar2 = (code *)FUN_0040645d(2);
    if (pcVar2 == (code *)0x0) {
      if ((DAT_00472eb0 == 0) && (LVar1 = RegDeleteKeyW(param_1,param_2), LVar1 == 0)) {
        LVar1 = 0;
      }
      else {
LAB_0040152f:
        LVar1 = 1;
      }
    }
    else {
      LVar1 = (*pcVar2)(param_1,param_2,DAT_00472eb0,0);
    }
  }
  return LVar1;
}



/* Function: FUN_00401553 */

uint FUN_00401553(HKEY param_1)

{
  uint samDesired;
  LPCWSTR lpSubKey;
  LSTATUS LVar1;
  HKEY hKey;
  DWORD ulOptions;
  HKEY *phkResult;
  
  hKey = *(HKEY *)(DAT_0040b0c4 + 4);
  if (hKey == (HKEY)0x0) {
    hKey = (HKEY)(DAT_00472e84 + -0x7fffffff);
  }
  phkResult = &param_1;
  samDesired = DAT_00472eb0 | (uint)param_1;
  ulOptions = 0;
  lpSubKey = FUN_0040145c(0x22);
  LVar1 = RegOpenKeyExW(hKey,lpSubKey,ulOptions,samDesired,phkResult);
  return ~-(uint)(LVar1 != 0) & (uint)param_1;
}



/* Function: FUN_004015a0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

HKEY FUN_004015a0(HMODULE param_1)

{
  undefined1 uVar1;
  short sVar2;
  short *psVar3;
  uint uVar4;
  undefined4 uVar5;
  LRESULT LVar6;
  HGDIOBJ ho;
  HDC hdc;
  int iVar7;
  HINSTANCE pHVar8;
  FARPROC pFVar9;
  HRESULT HVar10;
  LPCWSTR pWVar11;
  LPCWSTR pWVar12;
  LSTATUS LVar13;
  HMODULE pHVar14;
  DWORD DVar15;
  LONG LVar16;
  BOOL BVar17;
  HANDLE pvVar18;
  HKEY pHVar19;
  HGLOBAL lpBuffer;
  uint uVar20;
  LPCWSTR pWVar21;
  HWND pHVar22;
  int iVar23;
  void *this;
  HMODULE pHVar24;
  LPWSTR pWVar25;
  WCHAR *pWVar26;
  int *piVar27;
  HMODULE lpBuffer_00;
  UINT UVar28;
  undefined *puVar29;
  LPDWORD lpNumberOfBytesWritten;
  HMODULE *lpNumberOfBytesWritten_00;
  PLONG lpDistanceToMoveHigh;
  wchar_t *pwVar30;
  UINT fuLoad;
  int nDenominator;
  LPOVERLAPPED p_Var31;
  _WIN32_FIND_DATAW *lpFindFileData;
  _WIN32_FIND_DATAW local_3b0;
  WCHAR local_160 [128];
  undefined1 local_60 [16];
  FILEOP_FLAGS local_50;
  undefined *local_4c;
  undefined2 local_48;
  undefined2 uStack_46;
  undefined2 uStack_44;
  char local_3d;
  int local_3c;
  HWND local_38;
  int local_34;
  HKEY local_30 [2];
  HKEY local_28;
  FILETIME local_24;
  HKEY local_1c;
  HKEY local_18;
  HKEY local_14;
  HWND local_10;
  HWND local_c;
  HKEY local_8;
  
  pHVar14 = DAT_0040b0c0;
  pHVar24 = param_1;
  piVar27 = &local_34;
  for (iVar23 = 7; iVar23 != 0; iVar23 = iVar23 + -1) {
    *piVar27 = pHVar24->unused;
    pHVar24 = pHVar24 + 1;
    piVar27 = piVar27 + 1;
  }
  iVar23 = (int)local_30[0] * 0x4008;
  local_10 = DAT_00472dd4;
  pHVar24 = (HMODULE)(&DAT_00473000 + iVar23);
  lpBuffer_00 = (HMODULE)(&DAT_00473000 + (int)local_30[1] * 0x4008);
  DAT_0040b0c4 = local_30;
  local_8 = (HKEY)0x0;
  switch(local_34) {
  case 2:
    FUN_00406404(L"Jump: %d");
    return local_30[0];
  case 3:
    FUN_0040145c(0);
    FUN_00406404(L"Aborting: \"%s\"");
    pWVar21 = (LPCWSTR)0x0;
    goto LAB_0040162d;
  case 4:
    DAT_0046ad94 = DAT_0046ad94 + 1;
    if (DAT_00472dd4 == (HWND)0x0) {
      return (HKEY)0x7fffffff;
    }
    PostQuitMessage(0);
    return (HKEY)0x7fffffff;
  case 5:
    iVar23 = FUN_0040137e((int)local_30[0]);
    FUN_00406404(L"Call: %d");
    pHVar19 = (HKEY)FUN_0040139d(iVar23 + -1,(HWND)0x0);
    return pHVar19;
  case 6:
    FUN_0040145c(0);
    FUN_00406404(L"detailprint: %s");
    pWVar21 = (LPCWSTR)0x0;
    goto LAB_00401689;
  case 7:
    DVar15 = FUN_00401446(0);
    FUN_00406404(L"Sleep(%d)");
    if ((int)DVar15 < 2) {
      DVar15 = 1;
    }
    Sleep(DVar15);
    break;
  case 8:
    FUN_00406404(L"BringToFront");
    SetForegroundWindow(local_10);
    break;
  case 9:
    if (DAT_0046ada0 != (HWND)0x0) {
      ShowWindow(DAT_0046ada0,(int)local_30[1]);
    }
    if (DAT_0046ad8c != (HWND)0x0) {
      ShowWindow(DAT_0046ad8c,(int)local_30[0]);
    }
    break;
  case 10:
    pWVar21 = FUN_0040145c(0xfffffff0);
    FUN_00406404(L"SetFileAttributes: \"%s\":%08X");
    BVar17 = SetFileAttributesW(pWVar21,(DWORD)local_30[1]);
    if (BVar17 != 0) break;
    local_8 = (HKEY)0x1;
    pwVar30 = L"SetFileAttributes failed.";
    goto LAB_004017a6;
  case 0xb:
    param_1 = (HMODULE)FUN_0040145c(0xfffffff0);
    FUN_00406404(L"CreateDirectory: \"%s\" (%d)");
    pWVar25 = FUN_00405eb9((LPCWSTR)param_1);
    if (pWVar25 != (LPWSTR)0x0) {
      do {
        psVar3 = (short *)FUN_00405e66(pWVar25,L'\\');
        sVar2 = *psVar3;
        *psVar3 = 0;
        BVar17 = CreateDirectoryW((LPCWSTR)param_1,(LPSECURITY_ATTRIBUTES)0x0);
        if (BVar17 == 0) {
          DVar15 = GetLastError();
          if (DVar15 == 0xb7) {
            DVar15 = GetFileAttributesW((LPCWSTR)param_1);
            if ((DVar15 & 0x10) == 0) {
              FUN_00406404(L"CreateDirectory: can\'t create \"%s\" - a file already exists");
              local_8 = (HKEY)((int)&local_8->unused + 1);
            }
          }
          else {
            GetLastError();
            FUN_00406404(L"CreateDirectory: can\'t create \"%s\" (err=%d)");
            local_8 = (HKEY)((int)&local_8->unused + 1);
          }
        }
        else {
          FUN_00406404(L"CreateDirectory: \"%s\" created");
        }
        *psVar3 = sVar2;
        pWVar25 = psVar3 + 1;
      } while (sVar2 != 0);
    }
    pWVar21 = (LPCWSTR)&DAT_0040f0d0;
    if (local_30[1] != (HKEY)0x0) {
      FUN_004050d2(-0x1a,(LPCWSTR)&DAT_0040f0d0);
      FUN_0040616a((LPWSTR)&DAT_004cb0b0,(LPCWSTR)param_1);
      SetCurrentDirectoryW((LPCWSTR)param_1);
      break;
    }
    local_30[0] = (HKEY)0xfffffff5;
    goto LAB_00401689;
  case 0xc:
    pWVar21 = FUN_0040145c(0);
    puVar29 = FUN_00406436(pWVar21);
    if (puVar29 == (undefined *)0x0) {
      FUN_00406404(L"IfFileExists: file \"%s\" does not exist, jumping %d");
      return local_28;
    }
    FUN_00406404(L"IfFileExists: file \"%s\" exists, jumping %d");
    return local_30[1];
  case 0xd:
    if (local_28 == (HKEY)0x0) {
      *(undefined4 *)(&DAT_00472e40 + (int)local_30[0] * 4) = (&DAT_00472e80)[(int)local_30[0]];
      uVar5 = FUN_00401446(1);
      (&DAT_00472e80)[(int)local_30[0]] = uVar5;
    }
    else {
      (&DAT_00472e80)[(int)local_30[0]] = *(undefined4 *)(&DAT_00472e40 + (int)local_30[0] * 4);
    }
    break;
  case 0xe:
    uVar20 = (&DAT_00472e80)[(int)local_28];
    (&DAT_00472e80)[(int)local_28] = uVar20 & local_24.dwLowDateTime;
    return local_30[uVar20 == 0];
  case 0xf:
    pHVar22 = (HWND)(&DAT_00472e80)[(int)local_30[1]];
    goto switchD_00401e2b_default;
  case 0x10:
    pWVar21 = FUN_0040145c(0xffffffd0);
    param_1 = (HMODULE)FUN_0040145c(0xffffffdf);
    FUN_0040145c(0x13);
    FUN_00406404(L"Rename: %s");
    BVar17 = MoveFileW(pWVar21,(LPCWSTR)param_1);
    if (BVar17 == 0) {
      if ((local_28 == (HKEY)0x0) || (puVar29 = FUN_00406436(pWVar21), puVar29 == (undefined *)0x0))
      {
        pwVar30 = L"Rename failed: %s";
        goto LAB_00401950;
      }
      FUN_00406dc9(pWVar21,(LPCWSTR)param_1);
      FUN_004050d2(-0x1c,(LPCWSTR)&DAT_0040f0d0);
      pwVar30 = L"Rename on reboot: %s";
      goto LAB_00401957;
    }
    pWVar21 = (LPCWSTR)&DAT_0040f0d0;
    local_30[0] = (HKEY)0xffffffe3;
    goto LAB_00401689;
  case 0x11:
    pHVar14 = (HMODULE)FUN_0040145c(0);
    DVar15 = GetFullPathNameW((LPCWSTR)pHVar14,0x2004,(LPWSTR)lpBuffer_00,(LPWSTR *)&param_1);
    if (DVar15 == 0) {
LAB_004019a3:
      *(undefined2 *)&lpBuffer_00->unused = 0;
      local_8 = (HKEY)0x1;
    }
    else if ((pHVar14 < param_1) && ((short)param_1->unused != 0)) {
      puVar29 = FUN_00406436((LPCWSTR)pHVar14);
      if (puVar29 == (undefined *)0x0) goto LAB_004019a3;
      FUN_0040616a((LPWSTR)param_1,(LPCWSTR)(puVar29 + 0x2c));
    }
    if (local_28 == (HKEY)0x0) {
      GetShortPathNameW((LPCWSTR)lpBuffer_00,(LPWSTR)lpBuffer_00,0x2004);
    }
    break;
  case 0x12:
    pWVar21 = FUN_0040145c(0xffffffff);
    DVar15 = SearchPathW((LPCWSTR)0x0,pWVar21,(LPCWSTR)0x0,0x2004,(LPWSTR)pHVar24,(LPWSTR *)&param_1
                        );
    goto LAB_004019e4;
  case 0x13:
    pWVar21 = FUN_0040145c(0xffffffef);
    pWVar25 = FUN_00405fe0((LPWSTR)pHVar24,pWVar21);
    goto LAB_00401a0d;
  case 0x14:
    pHVar22 = (HWND)FUN_0040145c(0x31);
    param_1 = (HMODULE)((uint)local_30[0] & 7);
    local_38 = pHVar22;
    FUN_00406404(L"File: overwriteflag=%d, allowskipfilesflag=%d, name=\"%s\"");
    iVar23 = FUN_00405e85((ushort *)pHVar22);
    if (iVar23 == 0) {
      pWVar21 = (LPCWSTR)FUN_0040616a((LPWSTR)&DAT_0040b0c8,(LPCWSTR)&DAT_004cb0b0);
      pWVar21 = FUN_00406883(pWVar21);
      lstrcatW(pWVar21,(LPCWSTR)pHVar22);
    }
    else {
      FUN_0040616a((LPWSTR)&DAT_0040b0c8,(LPCWSTR)pHVar22);
    }
    FUN_00406199((LPCWSTR)&DAT_0040b0c8);
    while( true ) {
      if (2 < (int)param_1) {
        puVar29 = FUN_00406436((LPCWSTR)&DAT_0040b0c8);
        uVar20 = 0;
        if (puVar29 != (undefined *)0x0) {
          uVar20 = CompareFileTime((FILETIME *)(puVar29 + 0x14),&local_24);
        }
        param_1 = (HMODULE)(uint)((((uint)((int)&param_1[-1].unused + 1U) | 0x80000000) & uVar20) ==
                                 0);
      }
      if (param_1 == (HMODULE)0x0) {
        FUN_00405f90((LPCWSTR)&DAT_0040b0c8);
      }
      local_c = (HWND)FUN_00405fb0((LPCWSTR)&DAT_0040b0c8,0x40000000,(param_1 != (HMODULE)0x1) + 1);
      if (local_c != (HWND)0xffffffff) {
        FUN_004050d2(-0x16,(LPCWSTR)local_38);
        DAT_00472eb4 = DAT_00472eb4 + 1;
        DVar15 = FUN_00403550((DWORD)local_28,local_c,(LPVOID)0x0,0);
        DAT_00472eb4 = DAT_00472eb4 + -1;
        FUN_00406404(L"File: wrote %d to \"%s\"");
        if (((HKEY)local_24.dwLowDateTime != (HKEY)0xffffffff) ||
           ((HKEY)local_24.dwHighDateTime != (HKEY)0xffffffff)) {
          SetFileTime(local_c,&local_24,(FILETIME *)0x0,&local_24);
        }
        CloseHandle(local_c);
        if (-1 < (int)DVar15) goto switchD_004015fa_caseD_46;
        if (DVar15 == 0xfffffffe) {
          FUN_00406966((LPWSTR)&DAT_0040b0c8,-0x17);
          lstrcatW((LPWSTR)&DAT_0040b0c8,(LPCWSTR)local_38);
        }
        else {
          FUN_00406966((LPWSTR)&DAT_0040b0c8,-0x12);
        }
        FUN_00406404(L"%s");
        uVar20 = 0x200010;
        puVar29 = &DAT_0040b0c8;
        goto LAB_00401c3c;
      }
      if (param_1 != (HMODULE)0x0) {
        FUN_004050d2(-0x1e,(LPCWSTR)local_38);
        if (param_1 == (HMODULE)0x2) {
          local_8 = (HKEY)0x1;
        }
        pwVar30 = L"File: skipped: \"%s\" (overwriteflag=%d)";
        goto LAB_00401b86;
      }
      FUN_00406404(L"File: error creating \"%s\"");
      FUN_0040616a((LPWSTR)&DAT_004130d8,(LPCWSTR)&DAT_00473000);
      FUN_0040616a((LPWSTR)&DAT_00473000,(LPCWSTR)&DAT_0040b0c8);
      FUN_00406966((LPWSTR)&DAT_0040f0d0,(int)local_1c);
      FUN_0040616a((LPWSTR)&DAT_00473000,(LPCWSTR)&DAT_004130d8);
      iVar23 = FUN_00405e00(&DAT_0040f0d0,(int)local_30[0] >> 3);
      if (iVar23 != 4) break;
      FUN_00406404(L"File: error, user retry");
    }
    if (iVar23 == 5) {
      FUN_00406404(L"File: error, user cancel");
      _DAT_00472e88 = _DAT_00472e88 + 1;
      return (HKEY)0x0;
    }
    FUN_00406404(L"File: error, user abort");
    pWVar21 = (LPCWSTR)&DAT_0040b0c8;
    local_30[0] = (HKEY)0xfffffffa;
LAB_0040162d:
    FUN_004050d2((int)local_30[0],pWVar21);
    return (HKEY)0x7fffffff;
  case 0x15:
    pWVar21 = FUN_0040145c(0);
    pwVar30 = L"Delete: \"%s\"";
    goto LAB_00401c54;
  case 0x16:
    pWVar21 = FUN_0040145c(0x31);
    FUN_00406404(L"MessageBox: %d,\"%s\"");
    pHVar19 = (HKEY)FUN_00405e00(pWVar21,(uint)local_30[0]);
    if (pHVar19 != (HKEY)0x0) {
      if (pHVar19 == local_28) {
        return (HKEY)local_24.dwLowDateTime;
      }
      if (pHVar19 == (HKEY)local_24.dwHighDateTime) {
        return local_1c;
      }
      break;
    }
    goto LAB_00401a13;
  case 0x17:
    pWVar21 = FUN_0040145c(0xfffffff0);
    pwVar30 = L"RMDir: \"%s\"";
LAB_00401c54:
    FUN_00406404(pwVar30);
    FUN_00406dfc(pWVar21,(uint)local_30[1]);
    break;
  case 0x18:
    pWVar21 = FUN_0040145c(1);
    pHVar22 = (HWND)lstrlenW(pWVar21);
    goto switchD_00401e2b_default;
  case 0x19:
    param_1 = (HMODULE)FUN_00401446(2);
    iVar23 = FUN_00401446(3);
    pWVar21 = FUN_0040145c(1);
    local_48 = SUB42(pWVar21,0);
    uStack_46 = (undefined2)((uint)pWVar21 >> 0x10);
    *(undefined2 *)&pHVar24->unused = 0;
    if (((local_28 == (HKEY)0x0) || (param_1 != (HMODULE)0x0)) &&
       ((iVar7 = lstrlenW(pWVar21), -1 < iVar23 || (iVar23 = iVar23 + iVar7, -1 < iVar23)))) {
      if (iVar7 < iVar23) {
        iVar23 = iVar7;
      }
      FUN_0040616a((LPWSTR)pHVar24,(LPCWSTR)(CONCAT22(uStack_46,local_48) + iVar23 * 2));
      pHVar14 = param_1;
      if (param_1 != (HMODULE)0x0) {
        if ((int)param_1 < 0) {
          iVar23 = lstrlenW((LPCWSTR)pHVar24);
          param_1 = (HMODULE)((int)&pHVar14->unused + iVar23);
          if ((int)param_1 < 0) {
            param_1 = (HMODULE)0x0;
          }
        }
        if ((int)param_1 < 0x2004) {
          *(undefined2 *)((int)&pHVar24->unused + (int)param_1 * 2) = 0;
        }
      }
    }
    break;
  case 0x1a:
    pWVar21 = FUN_0040145c(0x20);
    pWVar11 = FUN_0040145c(0x31);
    if ((HKEY)local_24.dwHighDateTime == (HKEY)0x0) {
      iVar23 = lstrcmpiW(pWVar21,pWVar11);
      local_30[1] = (HKEY)local_24.dwLowDateTime;
    }
    else {
      iVar23 = lstrcmpW(pWVar21,pWVar11);
      local_30[1] = (HKEY)local_24.dwLowDateTime;
    }
    goto joined_r0x0040205a;
  case 0x1b:
    pWVar21 = FUN_0040145c(1);
    DVar15 = ExpandEnvironmentStringsW(pWVar21,(LPWSTR)pHVar24,0x2004);
    if ((DVar15 == 0) ||
       ((local_28 != (HKEY)0x0 && (iVar7 = lstrcmpW(pWVar21,(LPCWSTR)pHVar24), iVar7 == 0)))) {
      local_8 = (HKEY)0x1;
      *(undefined2 *)&pHVar24->unused = 0;
    }
    *(undefined2 *)(&DAT_00477006 + iVar23) = 0;
    break;
  case 0x1c:
    uVar20 = FUN_00401446(0);
    uVar4 = FUN_00401446(1);
    if (local_1c != (HKEY)0x0) {
      if (uVar20 < uVar4) {
        return (HKEY)local_24.dwLowDateTime;
      }
      if (uVar20 <= uVar4) {
        return local_28;
      }
      return (HKEY)local_24.dwHighDateTime;
    }
    if ((int)uVar20 < (int)uVar4) {
      return (HKEY)local_24.dwLowDateTime;
    }
    if ((int)uVar20 <= (int)uVar4) {
      return local_28;
    }
    return (HKEY)local_24.dwHighDateTime;
  case 0x1d:
    pHVar22 = (HWND)FUN_00401446(1);
    uVar20 = FUN_00401446(2);
    switch(local_24.dwLowDateTime) {
    case 0:
      pHVar22 = (HWND)((int)&pHVar22->unused + uVar20);
      break;
    case 1:
      pHVar22 = (HWND)((int)pHVar22 - uVar20);
      break;
    case 2:
      pHVar22 = (HWND)((int)pHVar22 * uVar20);
      break;
    case 3:
      if (uVar20 == 0) {
LAB_00401e4a:
        pHVar22 = (HWND)0x0;
        local_8 = (HKEY)0x1;
      }
      else {
        pHVar22 = (HWND)((int)pHVar22 / (int)uVar20);
      }
      break;
    case 4:
      pHVar22 = (HWND)((uint)pHVar22 | uVar20);
      break;
    case 5:
      pHVar22 = (HWND)((uint)pHVar22 & uVar20);
      break;
    case 6:
      pHVar22 = (HWND)((uint)pHVar22 ^ uVar20);
      break;
    case 7:
      pHVar22 = (HWND)(uint)(pHVar22 == (HWND)0x0);
      break;
    case 8:
      if (pHVar22 == (HWND)0x0) {
LAB_00401e70:
        if (uVar20 == 0) goto LAB_00401e7d;
      }
      pHVar22 = (HWND)0x1;
      break;
    case 9:
      if (pHVar22 != (HWND)0x0) goto LAB_00401e70;
LAB_00401e7d:
      pHVar22 = (HWND)0x0;
      break;
    case 10:
      if (uVar20 == 0) goto LAB_00401e4a;
      pHVar22 = (HWND)((int)pHVar22 % (int)uVar20);
      break;
    case 0xb:
      pHVar22 = (HWND)((int)pHVar22 << ((byte)uVar20 & 0x1f));
      break;
    case 0xc:
      pHVar22 = (HWND)((int)pHVar22 >> ((byte)uVar20 & 0x1f));
    }
    goto switchD_00401e2b_default;
  case 0x1e:
    pWVar21 = FUN_0040145c(1);
    uVar5 = FUN_00401446(2);
    wsprintfW((LPWSTR)pHVar24,pWVar21,uVar5);
    break;
  case 0x1f:
    if (local_28 != (HKEY)0x0) {
      do {
        local_28 = (HKEY)((int)&local_28[-1].unused + 3);
        if (pHVar14 == (HMODULE)0x0) goto LAB_00401ed5;
        pHVar14 = (HMODULE)pHVar14->unused;
      } while (local_28 != (HKEY)0x0);
      if (pHVar14 == (HMODULE)0x0) {
LAB_00401ed5:
        FUN_00406404(L"Exch: stack < %d elements");
        goto LAB_00401ee4;
      }
      FUN_0040616a((LPWSTR)&DAT_0040b0c8,(LPCWSTR)(pHVar14 + 1));
      FUN_0040616a((LPWSTR)(pHVar14 + 1),(LPCWSTR)(DAT_0040b0c0 + 1));
      pWVar26 = (WCHAR *)&DAT_0040b0c8;
      pHVar24 = DAT_0040b0c0 + 1;
      goto LAB_00402e4b;
    }
    if (local_30[1] == (HKEY)0x0) {
      pHVar14 = (HMODULE)GlobalAlloc(0x40,0x400c);
      FUN_00406966((LPWSTR)(pHVar14 + 1),(int)local_30[0]);
      pHVar14->unused = (int)DAT_0040b0c0;
      DAT_0040b0c0 = pHVar14;
      break;
    }
    if (DAT_0040b0c0 != (HMODULE)0x0) {
      FUN_0040616a((LPWSTR)pHVar24,(LPCWSTR)(DAT_0040b0c0 + 1));
      DAT_0040b0c0 = (HMODULE)pHVar14->unused;
      goto LAB_00402387;
    }
    FUN_00406404(L"Pop: stack empty");
    goto LAB_00401a13;
  case 0x20:
  case 0x21:
    local_38 = (HWND)FUN_00401446(3);
    param_1 = (HMODULE)FUN_00401446(4);
    if (((uint)local_1c & 1) != 0) {
      local_38 = (HWND)FUN_0040145c(0x33);
    }
    if (((uint)local_1c & 2) != 0) {
      param_1 = (HMODULE)FUN_0040145c(0x44);
    }
    if (local_34 == 0x21) {
      pHVar22 = (HWND)FUN_00401446(1);
      UVar28 = FUN_00401446(2);
      if ((int)local_1c >> 2 == 0) {
        pHVar22 = (HWND)SendMessageW(pHVar22,UVar28,(WPARAM)local_38,(LPARAM)param_1);
        local_c = pHVar22;
        local_30[1] = local_30[0];
      }
      else {
        LVar6 = SendMessageTimeoutW(pHVar22,UVar28,(WPARAM)local_38,(LPARAM)param_1,0,
                                    (int)local_1c >> 2,(PDWORD_PTR)&local_c);
        local_8 = (HKEY)(uint)(LVar6 == 0);
        pHVar22 = local_c;
        local_30[1] = local_30[0];
      }
    }
    else {
      pWVar21 = FUN_0040145c(1);
      pWVar11 = FUN_0040145c(0x12);
      pHVar22 = FindWindowExW(local_38,(HWND)param_1,
                              (LPCWSTR)(-(uint)(*pWVar21 != L'\0') & (uint)pWVar21),
                              (LPCWSTR)(-(uint)(*pWVar11 != L'\0') & (uint)pWVar11));
      local_c = pHVar22;
      local_30[1] = local_30[0];
    }
    goto joined_r0x00402dc9;
  case 0x22:
    pHVar22 = (HWND)FUN_00401446(0);
    iVar23 = IsWindow(pHVar22);
joined_r0x0040205a:
    if (iVar23 == 0) {
      return local_28;
    }
    return local_30[1];
  case 0x23:
    iVar23 = FUN_00401446(2);
    pHVar22 = (HWND)FUN_00401446(1);
    pHVar22 = GetDlgItem(pHVar22,iVar23);
    goto switchD_00401e2b_default;
  case 0x24:
    iVar23 = (int)&local_30[1]->unused + DAT_00472e08;
    iVar7 = -0x15;
    pHVar22 = (HWND)FUN_00401446(0);
    SetWindowLongW(pHVar22,iVar7,iVar23);
    break;
  case 0x25:
    pHVar22 = GetDlgItem(DAT_00472dd4,(int)local_30[1]);
    GetClientRect(pHVar22,(LPRECT)(local_60 + 0xc));
    iVar23 = CONCAT22(uStack_46,local_48) * (int)local_28;
    fuLoad = 0x10;
    iVar7 = (int)local_4c * (int)local_28;
    UVar28 = 0;
    pWVar21 = FUN_0040145c(0);
    pvVar18 = LoadImageW((HINSTANCE)0x0,pWVar21,UVar28,iVar7,iVar23,fuLoad);
    ho = (HGDIOBJ)SendMessageW(pHVar22,0x172,0,(LPARAM)pvVar18);
    if (ho != (HGDIOBJ)0x0) {
      DeleteObject(ho);
    }
    break;
  case 0x26:
    nDenominator = 0x48;
    iVar23 = 0x5a;
    hdc = GetDC(DAT_00472dd4);
    iVar23 = GetDeviceCaps(hdc,iVar23);
    iVar7 = FUN_00401446(2);
    _DAT_0041f0f0 = MulDiv(iVar7,iVar23,nDenominator);
    _DAT_0041f0f0 = -_DAT_0041f0f0;
    _DAT_0041f100 = FUN_00401446(3);
    DAT_0041f104 = (byte)local_24.dwHighDateTime & 1;
    DAT_0041f105 = (byte)local_24.dwHighDateTime & 2;
    DAT_0041f106 = (byte)local_24.dwHighDateTime & 4;
    DAT_0041f107 = 1;
    FUN_00406966((LPWSTR)&DAT_0041f10c,(int)local_30[1]);
    pHVar22 = (HWND)CreateFontIndirectW((LOGFONTW *)&DAT_0041f0f0);
    goto switchD_00401e2b_default;
  case 0x27:
    pHVar22 = (HWND)FUN_00401446(0);
    iVar23 = FUN_00401446(1);
    if (local_28 != (HKEY)0x0) {
      FUN_00406404(L"HideWindow");
    }
    if ((HKEY)local_24.dwLowDateTime == (HKEY)0x0) {
      ShowWindow(pHVar22,iVar23);
    }
    else {
      EnableWindow(pHVar22,iVar23);
    }
    break;
  case 0x28:
    pWVar21 = FUN_0040145c(0);
    pWVar11 = FUN_0040145c(0x31);
    pWVar12 = FUN_0040145c(0x22);
    FUN_0040145c(0x15);
    FUN_004050d2(-0x14,(LPCWSTR)&DAT_0040f0d0);
    pHVar8 = ShellExecuteW(local_10,(LPCWSTR)(-(uint)(*pWVar21 != L'\0') & (uint)pWVar21),pWVar11,
                           (LPCWSTR)(-(uint)(*pWVar12 != L'\0') & (uint)pWVar12),
                           (LPCWSTR)&DAT_004cb0b0,local_24.dwLowDateTime);
    if (0x20 < (int)pHVar8) {
      FUN_00406404(L"ExecShell: success (\"%s\": file:\"%s\" params:\"%s\")");
      break;
    }
    FUN_00406404(L"ExecShell: warning: error (\"%s\": file:\"%s\" params:\"%s\")=%d");
    goto LAB_00401a13;
  case 0x29:
    pWVar21 = FUN_0040145c(0);
    FUN_00406404(L"Exec: command=\"%s\"");
    FUN_004050d2(-0x15,pWVar21);
    param_1 = (HMODULE)FUN_00405d9f(pWVar21);
    if (param_1 != (HMODULE)0x0) {
      FUN_00406404(L"Exec: success (\"%s\")");
      pHVar14 = param_1;
      if (local_28 != (HKEY)0x0) {
        while (DVar15 = WaitForSingleObject(param_1,100), DVar15 == 0x102) {
          FUN_00406493(0xf);
        }
        GetExitCodeProcess(param_1,(LPDWORD)&local_14);
        if ((int)local_30[1] < 0) {
          pHVar14 = param_1;
          if (local_14 != (HKEY)0x0) {
            local_8 = (HKEY)0x1;
          }
        }
        else {
          FUN_004060b2((LPWSTR)lpBuffer_00,local_14);
          pHVar14 = param_1;
        }
      }
      goto LAB_00402af2;
    }
    pwVar30 = L"Exec: failed createprocess (\"%s\")";
    param_1 = (HMODULE)0x0;
LAB_00401950:
    local_8 = (HKEY)0x1;
    goto LAB_00401957;
  case 0x2a:
    pWVar21 = FUN_0040145c(2);
    puVar29 = FUN_00406436(pWVar21);
    if (puVar29 == (undefined *)0x0) {
      *(undefined2 *)&pHVar24->unused = 0;
      *(undefined2 *)&lpBuffer_00->unused = 0;
      goto LAB_00401a13;
    }
    FUN_004060b2((LPWSTR)lpBuffer_00,*(undefined4 *)(puVar29 + 0x14));
    pHVar22 = *(HWND *)(puVar29 + 0x18);
    goto switchD_00401e2b_default;
  case 0x2b:
    pWVar21 = FUN_0040145c(0xffffffee);
    local_48 = SUB42(pWVar21,0);
    uStack_46 = (undefined2)((uint)pWVar21 >> 0x10);
    local_14 = (HKEY)GetFileVersionInfoSizeW(pWVar21,(LPDWORD)&local_18);
    *(undefined2 *)&pHVar24->unused = 0;
    *(undefined2 *)&lpBuffer_00->unused = 0;
    local_8 = (HKEY)0x1;
    if ((local_14 == (HKEY)0x0) ||
       (param_1 = (HMODULE)GlobalAlloc(0x40,(SIZE_T)local_14), param_1 == (HMODULE)0x0)) break;
    BVar17 = GetFileVersionInfoW((LPCWSTR)CONCAT22(uStack_46,local_48),0,(DWORD)local_14,param_1);
    pHVar14 = param_1;
    if ((BVar17 != 0) &&
       (BVar17 = VerQueryValueW(param_1,L"\\",&local_c,(PUINT)&local_48), pHVar14 = param_1,
       BVar17 != 0)) {
      FUN_004060b2((LPWSTR)pHVar24,local_c[2].unused);
      FUN_004060b2((LPWSTR)lpBuffer_00,local_c[3].unused);
      local_8 = (HKEY)0x0;
      pHVar14 = param_1;
    }
    goto LAB_00402387;
  case 0x2c:
    pWVar21 = FUN_0040145c(0x11);
    iVar23 = FUN_00407359(pWVar21,(LPWSTR)pHVar24,0x2004);
    if (iVar23 == 0) {
      local_8 = (HKEY)0x1;
    }
    pwVar30 = L"GetTTFVersionString(%s) returned %s";
    goto LAB_00401b86;
  case 0x2d:
    pWVar21 = FUN_0040145c(0x11);
    iVar23 = FUN_004073cb(pWVar21,(LPWSTR)pHVar24,0x2004);
    if (iVar23 == 0) {
      local_8 = (HKEY)0x1;
    }
    pwVar30 = L"GetTTFFontName(%s) returned %s";
    goto LAB_00401b86;
  case 0x2e:
    local_8 = (HKEY)0x1;
    if (-1 < DAT_00472eb8) {
      pWVar21 = FUN_0040145c(0xfffffff0);
      local_c = (HWND)FUN_0040145c(1);
      if ((((HKEY)local_24.dwHighDateTime != (HKEY)0x0) &&
          (param_1 = GetModuleHandleW(pWVar21), param_1 != (HMODULE)0x0)) ||
         (param_1 = LoadLibraryExW(pWVar21,(HANDLE)0x0,8), param_1 != (HMODULE)0x0)) {
        pFVar9 = FUN_004064c6(param_1,(LPCWSTR)local_c);
        if (pFVar9 == (FARPROC)0x0) {
          FUN_004050d2(-9,(LPCWSTR)local_c);
          FUN_00406404(L"Error registering DLL: %s not found in %s");
        }
        else {
          local_8 = (HKEY)0x0;
          if (local_28 == (HKEY)0x0) {
            (*pFVar9)(local_10,0x2004,&DAT_00473000,&DAT_0040b0c0,&PTR_DAT_0040b000);
          }
          else {
            FUN_00401435((int)local_28);
            iVar23 = (*pFVar9)();
            if (iVar23 != 0) {
              local_8 = (HKEY)0x1;
            }
          }
        }
        if (((HKEY)local_24.dwLowDateTime == (HKEY)0x0) &&
           (iVar23 = FUN_00403e18((int)param_1), iVar23 != 0)) {
          FreeLibrary(param_1);
        }
        break;
      }
      FUN_004050d2(-10,(LPCWSTR)&DAT_0040f0d0);
      pwVar30 = L"Error registering DLL: Could not load %s";
      goto LAB_00401957;
    }
    FUN_004050d2(-0x19,(LPCWSTR)&DAT_0040f0d0);
    pwVar30 = L"Error registering DLL: Could not initialize OLE";
LAB_004017a6:
    FUN_00406404(pwVar30);
    break;
  case 0x2f:
    local_10 = (HWND)FUN_0040145c(0xfffffff0);
    pWVar21 = FUN_0040145c(0xffffffdf);
    local_c = (HWND)FUN_0040145c(2);
    local_14 = (HKEY)FUN_0040145c(0xffffffcd);
    pWVar11 = FUN_0040145c(0x45);
    local_48 = SUB42(pWVar11,0);
    uStack_46 = (undefined2)((uint)pWVar11 >> 0x10);
    iVar23 = FUN_00405e85((ushort *)pWVar21);
    if (iVar23 == 0) {
      FUN_0040145c(0x21);
    }
    FUN_00406404(L"CreateShortCut: out: \"%s\", in: \"%s %s\", icon: %s,%d, sw=%d, hk=%d");
    HVar10 = CoCreateInstance((IID *)&DAT_00409b54,(LPUNKNOWN)0x0,1,(IID *)&DAT_00409b34,&param_1);
    if (-1 < HVar10) {
      local_38 = (HWND)(**(code **)param_1->unused)(param_1,&DAT_00409b44,&local_18);
      if (-1 < (int)local_38) {
        local_38 = (HWND)(**(code **)(param_1->unused + 0x50))(param_1,pWVar21);
        (**(code **)(param_1->unused + 0x24))(param_1,&DAT_004cb0b0);
        uVar20 = (int)local_24.dwHighDateTime >> 8 & 0xff;
        if (uVar20 != 0) {
          (**(code **)(param_1->unused + 0x3c))(param_1,uVar20);
        }
        (**(code **)(param_1->unused + 0x34))(param_1,(int)local_24.dwHighDateTime >> 0x10);
        if ((WCHAR)local_14->unused != L'\0') {
          (**(code **)(param_1->unused + 0x44))(param_1,local_14,local_24.dwHighDateTime & 0xff);
        }
        (**(code **)(param_1->unused + 0x2c))(param_1,local_c);
        (**(code **)(param_1->unused + 0x1c))(param_1,CONCAT22(uStack_46,local_48));
        if (-1 < (int)local_38) {
          local_38 = (HWND)(**(code **)(local_18->unused + 0x18))(local_18,local_10,1);
        }
        (**(code **)(local_18->unused + 8))(local_18);
      }
      (**(code **)(param_1->unused + 8))(param_1);
      if (-1 < (int)local_38) {
        pWVar21 = (LPCWSTR)&DAT_0040f0d0;
        local_30[0] = (HKEY)0xfffffff4;
        goto LAB_00401689;
      }
    }
    pWVar21 = (LPCWSTR)&DAT_0040f0d0;
    local_8 = (HKEY)0x1;
    local_30[0] = (HKEY)0xfffffff0;
LAB_00401689:
    FUN_004050d2((int)local_30[0],pWVar21);
    break;
  case 0x30:
    pWVar21 = FUN_0040145c(0);
    pWVar11 = FUN_0040145c(0x11);
    param_1 = (HMODULE)FUN_0040145c(0x23);
    FUN_00406404(L"CopyFiles \"%s\"->\"%s\"");
    puVar29 = FUN_00406436(pWVar21);
    if (puVar29 != (undefined *)0x0) {
      local_60._0_4_ = local_10;
      local_60._4_4_ = 2;
      iVar23 = lstrlenW(pWVar21);
      pWVar21[iVar23 + 1] = L'\0';
      iVar23 = lstrlenW(pWVar11);
      pWVar11[iVar23 + 1] = L'\0';
      uStack_46 = SUB42(param_1,0);
      uStack_44 = (undefined2)((uint)param_1 >> 0x10);
      local_50 = (FILEOP_FLAGS)local_28;
      local_60._8_4_ = pWVar21;
      local_60._12_4_ = pWVar11;
      FUN_004050d2(0,(LPCWSTR)param_1);
      iVar23 = SHFileOperationW((LPSHFILEOPSTRUCTW)local_60);
      if (iVar23 == 0) break;
    }
    FUN_004050d2(-7,(LPCWSTR)0x0);
    goto LAB_00401a13;
  case 0x31:
    if (local_30[0] != (HKEY)0xbadf00d) {
LAB_00401ee4:
      uVar20 = 0x200010;
      puVar29 = (undefined *)FUN_00406966((LPWSTR)0x0,-0x18);
LAB_00401c3c:
      FUN_00405e00(puVar29,uVar20);
      return (HKEY)0x7fffffff;
    }
    DAT_00472e94 = DAT_00472e94 + 1;
    break;
  case 0x32:
    local_14 = (HKEY)0x0;
    local_18 = (HKEY)0x0;
    param_1 = (HMODULE)0x0;
    FUN_0040616a((LPWSTR)&DAT_0040f0d0,L"<RM>");
    FUN_0040616a((LPWSTR)&DAT_004130d8,(LPCWSTR)&DAT_0040f0d0);
    if (local_30[0] != (HKEY)0x0) {
      local_14 = (HKEY)FUN_0040145c(0);
    }
    if (local_30[1] != (HKEY)0x0) {
      local_18 = (HKEY)FUN_0040145c(0x11);
    }
    if ((HKEY)local_24.dwHighDateTime != (HKEY)0x0) {
      param_1 = (HMODULE)FUN_0040145c(0x22);
    }
    pWVar21 = FUN_0040145c(0xffffffcd);
    FUN_00406404(L"WriteINIStr: wrote [%s] %s=%s in %s");
    pWVar25 = (LPWSTR)WritePrivateProfileStringW
                                ((LPCWSTR)local_14,(LPCWSTR)local_18,(LPCWSTR)param_1,pWVar21);
    goto LAB_00401a0d;
  case 0x33:
    local_4c = PTR_DAT_0040858c;
    local_48 = (undefined2)DAT_00408590;
    uStack_46 = (undefined2)((uint)DAT_00408590 >> 0x10);
    pWVar21 = FUN_0040145c(1);
    pWVar11 = FUN_0040145c(0x12);
    pWVar12 = FUN_0040145c(0xffffffdd);
    GetPrivateProfileStringW(pWVar21,pWVar11,(LPCWSTR)&local_4c,(LPWSTR)pHVar24,0x2003,pWVar12);
    DVar15 = lstrcmpW((LPCWSTR)pHVar24,(LPCWSTR)&local_4c);
LAB_004019e4:
    if (DVar15 == 0) {
LAB_004019ec:
      local_8 = (HKEY)0x1;
      *(undefined2 *)&pHVar24->unused = 0;
    }
    break;
  case 0x34:
    param_1 = (HMODULE)FUN_00406321((int)local_30[1]);
    if ((HKEY)local_24.dwHighDateTime == (HKEY)0x0) {
      pHVar19 = (HKEY)FUN_00401553((HKEY)0x2);
      if (pHVar19 == (HKEY)0x0) goto LAB_00401a13;
      pWVar21 = FUN_0040145c(0x33);
      local_18 = (HKEY)RegDeleteValueW(pHVar19,pWVar21);
      FUN_00406404(L"DeleteRegValue: \"%s\\%s\" \"%s\"");
      RegCloseKey(pHVar19);
    }
    else {
      pWVar21 = FUN_0040145c(0x22);
      FUN_00406404(L"DeleteRegKey: \"%s\\%s\"");
      if (local_30[1] == (HKEY)0x0) {
        local_30[1] = (HKEY)(DAT_00472e84 + -0x7fffffff);
      }
      local_18 = (HKEY)FUN_0040149d(local_30[1],pWVar21,local_24.dwHighDateTime & 2);
    }
    if (local_18 == (HKEY)0x0) break;
    goto LAB_00401a13;
  case 0x35:
    pHVar19 = local_30[0];
    if (local_30[0] == (HKEY)0x0) {
      pHVar19 = (HKEY)(DAT_00472e84 + -0x7fffffff);
    }
    local_14 = (HKEY)local_24.dwHighDateTime;
    local_18 = local_1c;
    local_10 = (HWND)FUN_0040145c(2);
    param_1 = (HMODULE)FUN_0040145c(0x11);
    local_38 = (HWND)FUN_00406321((int)pHVar19);
    local_8 = (HKEY)0x1;
    LVar13 = RegCreateKeyExW(pHVar19,(LPCWSTR)param_1,0,(LPWSTR)0x0,0,DAT_00472eb0 | 2,
                             (LPSECURITY_ATTRIBUTES)0x0,(PHKEY)&local_48,(LPDWORD)0x0);
    if (LVar13 == 0) {
      local_c = (HWND)0x0;
      if (local_14 == (HKEY)0x1) {
        FUN_0040145c(0x23);
        iVar23 = lstrlenW((LPCWSTR)&DAT_004130d8);
        local_c = (HWND)(iVar23 * 2 + 2);
        if (local_18 != (HKEY)0x1) {
          FUN_00406404(L"WriteRegExpandStr: \"%s\\%s\" \"%s\"=\"%s\"");
          goto LAB_00402937;
        }
        FUN_00406404(L"WriteRegStr: \"%s\\%s\" \"%s\"=\"%s\"");
      }
      else {
LAB_00402937:
        if (local_14 == (HKEY)0x4) {
          _DAT_004130d8 = FUN_00401446(3);
          local_c = (HWND)0x4;
          FUN_00406404(L"WriteRegDWORD: \"%s\\%s\" \"%s\"=\"0x%08x\"");
        }
        if (local_14 == (HKEY)0x3) {
          local_c = (HWND)FUN_00403550(local_24.dwLowDateTime,(HANDLE)0x0,&DAT_004130d8,0xc018);
          FUN_00406385(local_160,0x100,0x4130d8,(uint)local_c);
          FUN_00406404(L"WriteRegBin: \"%s\\%s\" \"%s\"=\"%s\"");
        }
      }
      LVar13 = RegSetValueExW((HKEY)CONCAT22(uStack_46,local_48),(LPCWSTR)local_10,0,(DWORD)local_18
                              ,&DAT_004130d8,(DWORD)local_c);
      if (LVar13 == 0) {
        local_8 = (HKEY)0x0;
      }
      else {
        FUN_00406404(L"WriteReg: error writing into \"%s\\%s\" \"%s\"");
      }
      pHVar19 = (HKEY)CONCAT22(uStack_46,local_48);
LAB_004029e4:
      RegCloseKey(pHVar19);
      break;
    }
    pwVar30 = L"WriteReg: error creating key \"%s\\%s\"";
LAB_00401b86:
    FUN_00406404(pwVar30);
    break;
  case 0x36:
    pHVar19 = (HKEY)FUN_00401553((HKEY)0x20019);
    pWVar21 = FUN_0040145c(0x33);
    *(undefined2 *)&pHVar24->unused = 0;
    if (pHVar19 != (HKEY)0x0) {
      local_48 = 0x4008;
      uStack_46 = 0;
      LVar13 = RegQueryValueExW(pHVar19,pWVar21,(LPDWORD)0x0,(LPDWORD)&param_1,(LPBYTE)pHVar24,
                                (LPDWORD)&local_48);
      if (LVar13 == 0) {
        if (param_1 == (HMODULE)0x4) {
          local_8 = (HKEY)(uint)((HKEY)local_24.dwHighDateTime == (HKEY)0x0);
          FUN_004060b2((LPWSTR)pHVar24,pHVar24->unused);
        }
        else {
          if ((param_1 != (HMODULE)0x1) && (param_1 != (HMODULE)0x2)) goto LAB_00402a76;
          local_8 = (HKEY)local_24.dwHighDateTime;
          *(undefined2 *)((int)&pHVar24->unused + CONCAT22(uStack_46,local_48) * 2) = 0;
        }
      }
      else {
LAB_00402a76:
        *(undefined2 *)&pHVar24->unused = 0;
        local_8 = (HKEY)0x1;
      }
      goto LAB_004029e4;
    }
    goto LAB_00401a13;
  case 0x37:
    pHVar19 = (HKEY)FUN_00401553((HKEY)0x20019);
    DVar15 = FUN_00401446(3);
    *(undefined2 *)&pHVar24->unused = 0;
    if (pHVar19 != (HKEY)0x0) {
      param_1 = (HMODULE)0x2003;
      if ((HKEY)local_24.dwHighDateTime == (HKEY)0x0) {
        LVar13 = RegEnumValueW(pHVar19,DVar15,(LPWSTR)pHVar24,(LPDWORD)&param_1,(LPDWORD)0x0,
                               (LPDWORD)0x0,(LPBYTE)0x0,(LPDWORD)0x0);
        if (LVar13 != 0) goto LAB_00401a13;
      }
      else {
        RegEnumKeyW(pHVar19,DVar15,(LPWSTR)pHVar24,0x2003);
      }
      *(undefined2 *)(&DAT_00477006 + iVar23) = 0;
      goto LAB_004029e4;
    }
    goto LAB_00401a13;
  case 0x38:
    if ((short)pHVar24->unused == 0) break;
    pHVar14 = (HMODULE)FUN_004060cb((ushort *)pHVar24);
LAB_00402af2:
    CloseHandle(pHVar14);
    break;
  case 0x39:
    pWVar21 = FUN_0040145c(0xffffffed);
    pHVar22 = (HWND)FUN_00405fb0(pWVar21,(DWORD)local_30[1],(DWORD)local_28);
    if (pHVar22 == (HWND)0xffffffff) {
LAB_00402b19:
      *(undefined2 *)&pHVar24->unused = 0;
      goto LAB_00401a13;
    }
    goto switchD_00401e2b_default;
  case 0x3a:
    param_1 = (HMODULE)GlobalAlloc(0x40,0x2004);
    if (local_28 == (HKEY)0x0) {
      FUN_0040145c(0x11);
      WideCharToMultiByte(0,0,(LPCWSTR)&DAT_0040f0d0,-1,(LPSTR)param_1,0x2004,(LPCSTR)0x0,
                          (LPBOOL)0x0);
      DVar15 = lstrlenA((LPCSTR)param_1);
    }
    else {
      uVar1 = FUN_00401446(1);
      *(undefined1 *)&param_1->unused = uVar1;
      DVar15 = 1;
    }
    if ((short)pHVar24->unused != 0) {
      p_Var31 = (LPOVERLAPPED)0x0;
      lpNumberOfBytesWritten = (LPDWORD)&local_48;
      pHVar14 = param_1;
      pvVar18 = (HANDLE)FUN_004060cb((ushort *)pHVar24);
      BVar17 = WriteFile(pvVar18,pHVar14,DVar15,lpNumberOfBytesWritten,p_Var31);
      pHVar14 = param_1;
      if (BVar17 != 0) goto LAB_00402387;
    }
    local_8 = (HKEY)0x1;
    pHVar14 = param_1;
LAB_00402387:
    GlobalFree(pHVar14);
    break;
  case 0x3b:
    local_c = (HWND)FUN_00401446(2);
    if ((int)local_c < 1) break;
    if (0x2003 < (int)local_c) {
      local_c = (HWND)0x2003;
    }
    if ((short)pHVar24->unused != 0) {
      local_3d = '\0';
      iVar23 = FUN_004060cb((ushort *)pHVar24);
      local_48 = (undefined2)iVar23;
      uStack_46 = (undefined2)((uint)iVar23 >> 0x10);
      if (0 < (int)local_c) {
        pWVar25 = (LPWSTR)0x0;
LAB_00402bdf:
        BVar17 = ReadFile((HANDLE)CONCAT22(uStack_46,local_48),(LPVOID)((int)&param_1 + 3),1,
                          (LPDWORD)&local_18,(LPOVERLAPPED)0x0);
        if ((BVar17 != 0) && (local_18 == (HKEY)0x1)) {
          if ((HKEY)local_24.dwLowDateTime != (HKEY)0x0) {
            uVar20 = (uint)param_1 >> 0x18;
LAB_00402c43:
            FUN_004060b2((LPWSTR)lpBuffer_00,uVar20);
            return (HKEY)0x0;
          }
          MultiByteToWideChar(0,0,(LPCSTR)((int)&param_1 + 3),1,(LPWSTR)&local_10,2);
          if ((local_3d != '\r') && (local_3d != '\n')) goto code_r0x00402c25;
          if ((local_3d == param_1._3_1_) ||
             ((sVar2 = (short)local_10, param_1._3_1_ != '\r' && (param_1._3_1_ != '\n')))) {
            LVar16 = -1;
LAB_00402c70:
            SetFilePointer((HANDLE)CONCAT22(uStack_46,local_48),LVar16,(PLONG)0x0,1);
          }
          else {
LAB_00402c64:
            *(short *)((int)&lpBuffer_00->unused + (int)pWVar25 * 2) = sVar2;
            pWVar25 = (LPWSTR)((int)pWVar25 + 1);
          }
        }
        goto LAB_00402c7d;
      }
    }
    goto LAB_00402c7b;
  case 0x3c:
    if (local_28 == (HKEY)0x0) {
      pWVar21 = FUN_0040145c(0x11);
      iVar23 = lstrlenW(pWVar21);
    }
    else {
      _DAT_0040f0d0 = FUN_00401446(1);
      iVar23 = 1;
    }
    if ((short)pHVar24->unused != 0) {
      p_Var31 = (LPOVERLAPPED)0x0;
      lpNumberOfBytesWritten_00 = &param_1;
      DVar15 = iVar23 * 2;
      puVar29 = &DAT_0040f0d0;
      pvVar18 = (HANDLE)FUN_004060cb((ushort *)pHVar24);
      pWVar25 = (LPWSTR)WriteFile(pvVar18,puVar29,DVar15,(LPDWORD)lpNumberOfBytesWritten_00,p_Var31)
      ;
      goto LAB_00401a0d;
    }
    goto LAB_00401a13;
  case 0x3d:
    local_c = (HWND)FUN_00401446(2);
    if ((int)local_c < 1) break;
    if (0x2003 < (int)local_c) {
      local_c = (HWND)0x2003;
    }
    if ((short)pHVar24->unused == 0) {
LAB_00402c7b:
      pWVar25 = (LPWSTR)0x0;
    }
    else {
      local_38 = (HWND)0x0;
      iVar23 = FUN_004060cb((ushort *)pHVar24);
      local_48 = (undefined2)iVar23;
      uStack_46 = (undefined2)((uint)iVar23 >> 0x10);
      if ((int)local_c < 1) goto LAB_00402c7b;
      pWVar25 = (LPWSTR)0x0;
      while ((BVar17 = ReadFile((HANDLE)CONCAT22(uStack_46,local_48),&param_1,2,(LPDWORD)&local_18,
                                (LPOVERLAPPED)0x0), BVar17 != 0 && (local_18 == (HKEY)0x2))) {
        if ((HKEY)local_24.dwLowDateTime != (HKEY)0x0) {
          uVar20 = (uint)param_1 & 0xffff;
          goto LAB_00402c43;
        }
        if (((short)local_38 == 0xd) || ((short)local_38 == 10)) {
          if (((short)local_38 != (short)param_1) &&
             ((sVar2 = (short)param_1, (short)param_1 == 0xd || ((short)param_1 == 10))))
          goto LAB_00402c64;
          LVar16 = -2;
          goto LAB_00402c70;
        }
        local_38 = (HWND)((uint)param_1 & 0xffff);
        *(short *)((int)&lpBuffer_00->unused + (int)pWVar25 * 2) = (short)param_1;
        pWVar25 = (LPWSTR)((int)pWVar25 + 1);
        if (((short)param_1 == 0) || ((int)local_c <= (int)pWVar25)) break;
      }
    }
LAB_00402c7d:
    *(undefined2 *)((int)&lpBuffer_00->unused + (int)pWVar25 * 2) = 0;
LAB_00401a0d:
    if (pWVar25 != (LPWSTR)0x0) break;
LAB_00401a13:
    local_8 = (HKEY)0x1;
    break;
  case 0x3e:
    if ((short)pHVar24->unused == 0) break;
    lpDistanceToMoveHigh = (PLONG)0x0;
    LVar16 = FUN_00401446(2);
    pvVar18 = (HANDLE)FUN_004060cb((ushort *)pHVar24);
    pHVar22 = (HWND)SetFilePointer(pvVar18,LVar16,lpDistanceToMoveHigh,local_24.dwLowDateTime);
    pHVar24 = lpBuffer_00;
joined_r0x00402dc9:
    if ((int)local_30[1] < 0) break;
    goto switchD_00401e2b_default;
  case 0x3f:
    if ((short)pHVar24->unused != 0) {
      pvVar18 = (HANDLE)FUN_004060cb((ushort *)pHVar24);
      FindClose(pvVar18);
    }
    break;
  case 0x40:
    if ((short)lpBuffer_00->unused != 0) {
      lpFindFileData = &local_3b0;
      pvVar18 = (HANDLE)FUN_004060cb((ushort *)lpBuffer_00);
      BVar17 = FindNextFileW(pvVar18,lpFindFileData);
      if (BVar17 != 0) goto LAB_00402e43;
    }
    goto LAB_004019ec;
  case 0x41:
    pWVar21 = FUN_0040145c(2);
    pvVar18 = FindFirstFileW(pWVar21,&local_3b0);
    if (pvVar18 == (HANDLE)0xffffffff) {
      *(undefined2 *)&lpBuffer_00->unused = 0;
      goto LAB_00402b19;
    }
    FUN_004060b2((LPWSTR)lpBuffer_00,pvVar18);
LAB_00402e43:
    pWVar26 = local_3b0.cFileName;
LAB_00402e4b:
    FUN_0040616a((LPWSTR)pHVar24,pWVar26);
    break;
  case 0x42:
    local_14 = (HKEY)0xfffffd66;
    pHVar19 = (HKEY)FUN_0040145c(0xfffffff0);
    local_18 = pHVar19;
    iVar23 = FUN_00405e85((ushort *)pHVar19);
    if (iVar23 == 0) {
      FUN_0040145c(0xffffffed);
    }
    FUN_00405f90((LPCWSTR)pHVar19);
    param_1 = (HMODULE)FUN_00405fb0((LPCWSTR)pHVar19,0x40000000,2);
    if (param_1 != (HMODULE)0xffffffff) {
      local_48 = (undefined2)DAT_00472e2c;
      uStack_46 = (undefined2)(DAT_00472e2c >> 0x10);
      lpBuffer = GlobalAlloc(0x40,DAT_00472e2c);
      if (lpBuffer != (HGLOBAL)0x0) {
        FUN_004033bb(0);
        FUN_00403389(lpBuffer,CONCAT22(uStack_46,local_48));
        pHVar19 = (HKEY)GlobalAlloc(0x40,(SIZE_T)local_28);
        local_14 = pHVar19;
        if (pHVar19 != (HKEY)0x0) {
          FUN_00403550((DWORD)local_30[1],(HANDLE)0x0,pHVar19,(DWORD)local_28);
          for (; (char)pHVar19->unused != '\0'; pHVar19 = (HKEY)((int)&pHVar19[2].unused + local_3c)
              ) {
            local_3c = pHVar19->unused;
            FUN_00405f6c((undefined1 *)(pHVar19[1].unused + (int)lpBuffer),(int)(pHVar19 + 2),
                         local_3c);
          }
          GlobalFree(local_14);
        }
        WriteFile(param_1,lpBuffer,CONCAT22(uStack_46,local_48),(LPDWORD)&local_c,(LPOVERLAPPED)0x0)
        ;
        GlobalFree(lpBuffer);
        local_14 = (HKEY)FUN_00403550(0xffffffff,param_1,(LPVOID)0x0,0);
      }
      CloseHandle(param_1);
    }
    FUN_00406404(L"created uninstaller: %d, \"%s\"");
    iVar23 = -0xd;
    if ((int)local_14 < 0) {
      iVar23 = -0x11;
      DeleteFileW((LPCWSTR)local_18);
      local_8 = (HKEY)0x1;
    }
    FUN_00401435(iVar23);
    break;
  case 0x43:
    if (local_30[0] != (HKEY)0x0) {
      FUN_00406404(L"settings logging to %d");
      DAT_00461530 = local_30[1];
      FUN_00406404(L"logging set to %d");
      if (local_30[1] == (HKEY)0x0) {
        FUN_00406248(this,1);
      }
      else {
        FUN_00403fd4();
      }
      break;
    }
    FUN_0040145c(1);
    pwVar30 = L"%s";
LAB_00401957:
    FUN_00406404(pwVar30);
    break;
  case 0x44:
    param_1 = (HMODULE)FUN_00401446(0);
    if (DAT_00472dec <= param_1) goto LAB_00401a13;
    iVar23 = (int)param_1 * 0x4020 + DAT_00472de8;
    if ((int)local_28 < 0) {
      local_28 = (HKEY)(-1 - (int)local_28);
      if (local_28 == (HKEY)0x0) {
        FUN_00406966((LPWSTR)(iVar23 + 0x18),local_24.dwHighDateTime);
        *(uint *)(iVar23 + 8) = *(uint *)(iVar23 + 8) | 0x100;
      }
      else {
        local_30[1] = (HKEY)FUN_00401446(1);
      }
      *(HKEY *)(iVar23 + (int)local_28 * 4) = local_30[1];
      if ((HKEY)local_24.dwLowDateTime != (HKEY)0x0) {
        FUN_00401186((int)param_1);
      }
      break;
    }
    pHVar22 = *(HWND *)(iVar23 + (int)local_28 * 4);
    pHVar24 = lpBuffer_00;
    if (local_28 == (HKEY)0x0) {
      pWVar26 = (WCHAR *)(iVar23 + 0x18);
      goto LAB_00402e4b;
    }
    goto switchD_00401e2b_default;
  case 0x45:
    uVar20 = FUN_00401446(0);
    if (0x1f < uVar20) goto LAB_00401a13;
    if ((HKEY)local_24.dwLowDateTime == (HKEY)0x0) {
      if (local_28 == (HKEY)0x0) {
        FUN_00406966((LPWSTR)lpBuffer_00,*(int *)(DAT_00472ddc + 0x94 + uVar20 * 4));
      }
      else {
        *(HKEY *)(DAT_00472ddc + 0x94 + uVar20 * 4) = local_30[1];
      }
      break;
    }
    if (local_28 != (HKEY)0x0) {
      FUN_004012a6(uVar20);
      FUN_004011f8(0,0);
      break;
    }
    pHVar22 = (HWND)FUN_004012f1(0);
    pHVar24 = lpBuffer_00;
    goto switchD_00401e2b_default;
  case 0x48:
    SendMessageW(DAT_00472dd4,0xb,DAT_00457284 & (uint)local_30[0],0);
    if (local_30[0] != (HKEY)0x0) {
      InvalidateRect(local_10,(RECT *)0x0,0);
    }
    break;
  case 0x49:
    pWVar21 = FUN_0040145c(1);
    pHVar22 = (HWND)FUN_0040650d(pWVar21);
switchD_00401e2b_default:
    FUN_004060b2((LPWSTR)pHVar24,pHVar22);
  }
switchD_004015fa_caseD_46:
  _DAT_00472e88 = (int)&local_8->unused + _DAT_00472e88;
  return (HKEY)0x0;
code_r0x00402c25:
  *(short *)((int)&lpBuffer_00->unused + (int)pWVar25 * 2) = (short)local_10;
  local_3d = param_1._3_1_;
  pWVar25 = (LPWSTR)((int)pWVar25 + 1);
  if ((param_1._3_1_ == '\0') || ((int)local_c <= (int)pWVar25)) goto LAB_00402c7d;
  goto LAB_00402bdf;
}



/* Function: FUN_0040324c */

void FUN_0040324c(void)

{
  int nNumber;
  
  nNumber = DAT_0041f154;
  if (DAT_0042f1e0 <= DAT_0041f154) {
    nNumber = DAT_0042f1e0;
  }
  MulDiv(nNumber,100,DAT_0042f1e0);
  return;
}



/* Function: FUN_00403268 */

undefined4 FUN_00403268(HWND param_1,int param_2)

{
  undefined4 uVar1;
  wchar_t *pwVar2;
  WCHAR local_84 [64];
  
  if (param_2 == 0x110) {
    SetTimer(param_1,1,0xfa,(TIMERPROC)0x0);
    param_2 = 0x113;
  }
  if (param_2 == 0x113) {
    uVar1 = FUN_0040324c();
    pwVar2 = L"unpacking data: %d%%";
    if (DAT_00472ddc == 0) {
      pwVar2 = L"verifying installer: %d%%";
    }
    wsprintfW(local_84,pwVar2,uVar1);
    SetWindowTextW(param_1,local_84);
    SetDlgItemTextW(param_1,0x406,local_84);
  }
  return 0;
}



/* Function: FUN_004032e7 */

void __cdecl FUN_004032e7(int param_1)

{
  DWORD DVar1;
  undefined4 uVar2;
  WCHAR local_84 [64];
  
  if (param_1 == 0) {
    if (DAT_0041f150 == (HWND)0x0) {
      DVar1 = GetTickCount();
      if (DAT_00472e20 < DVar1) {
        if (DAT_00472dd4 == 0) {
          DAT_0041f150 = CreateDialogParamW(DAT_00472dd8,(LPCWSTR)0x6f,(HWND)0x0,FUN_00403268,0);
          ShowWindow(DAT_0041f150,5);
        }
        else if (((byte)DAT_00472eb4 & 1) != 0) {
          uVar2 = FUN_0040324c();
          wsprintfW(local_84,L"... %d%%",uVar2);
          FUN_004050d2(0,local_84);
        }
      }
    }
    else {
      FUN_00406493(0);
    }
  }
  else {
    if (DAT_0041f150 != (HWND)0x0) {
      DestroyWindow(DAT_0041f150);
    }
    DAT_0041f150 = (HWND)0x0;
  }
  return;
}



/* Function: FUN_00403389 */

undefined4 FUN_00403389(LPVOID param_1,DWORD param_2)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  
  DVar1 = param_2;
  BVar2 = ReadFile(DAT_0040b010,param_1,param_2,&param_2,(LPOVERLAPPED)0x0);
  if ((BVar2 == 0) || (param_2 != DVar1)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



/* Function: FUN_004033bb */

void FUN_004033bb(LONG param_1)

{
  SetFilePointer(DAT_0040b010,param_1,(PLONG)0x0,0);
  return;
}



/* Function: FUN_004033d2 */

/* WARNING: Type propagation algorithm not settling */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_004033d2(int param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  int iVar3;
  undefined *nNumberOfBytesToWrite;
  undefined *puStack_4;
  
  iVar3 = (DAT_0042f1e4 - DAT_004331f0) + param_1;
  DVar1 = GetTickCount();
  DAT_00472e20 = DVar1 + 500;
  if (0 < iVar3) {
    FUN_004033bb(DAT_004331ec);
    SetFilePointer(DAT_0040b014,DAT_004331f0,(PLONG)0x0,0);
    DAT_0041f154 = 0;
    DAT_0042f1e0 = iVar3;
    do {
      DVar1 = 0x4000;
      if (DAT_004331e8 - DAT_004331ec < 0x4001) {
        DVar1 = DAT_004331e8 - DAT_004331ec;
      }
      iVar3 = FUN_00403389(&DAT_0042f1e8,DVar1);
      if (iVar3 == 0) {
        return 0xffffffff;
      }
      DAT_004331ec = DAT_004331ec + DVar1;
      _DAT_00427170 = &DAT_0042f1e8;
      DAT_00427174 = DVar1;
      do {
        if ((DAT_00472ddc != 0) && (DAT_00472ea0 == 0)) {
          DAT_0041f154 = DAT_004331f0 + ((DAT_0042f1e0 - DAT_0042f1e4) - param_1);
          FUN_004032e7(0);
        }
        DAT_00427178 = &DAT_004271e0;
        _DAT_0042717c = 0x8000;
        iVar3 = FUN_00407473((SIZE_T *)&DAT_00427158);
        if (iVar3 < 0) {
          return 0xfffffffd;
        }
        nNumberOfBytesToWrite = DAT_00427178 + -0x4271e0;
        if (nNumberOfBytesToWrite == (undefined *)0x0) {
          if (DAT_00427174 != 0) {
            return 0xfffffffd;
          }
          if (DVar1 == 0) {
            return 0xfffffffd;
          }
          break;
        }
        BVar2 = WriteFile(DAT_0040b014,&DAT_004271e0,(DWORD)nNumberOfBytesToWrite,
                          (LPDWORD)&puStack_4,(LPOVERLAPPED)0x0);
        if ((BVar2 == 0) || (nNumberOfBytesToWrite != puStack_4)) {
          return 0xfffffffe;
        }
        DAT_004331f0 = DAT_004331f0 + (int)nNumberOfBytesToWrite;
      } while (DAT_00427174 != 0);
    } while (0 < (DAT_0042f1e4 - DAT_004331f0) + param_1);
    SetFilePointer(DAT_0040b014,DAT_0042f1e4,(PLONG)0x0,0);
  }
  FUN_004032e7(1);
  return 0;
}



/* Function: FUN_00403550 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

DWORD FUN_00403550(DWORD param_1,HANDLE param_2,LPVOID param_3,DWORD param_4)

{
  DWORD DVar1;
  BOOL BVar2;
  DWORD nNumberOfBytesToRead;
  DWORD local_8;
  
  if (-1 < (int)param_1) {
    DAT_0042f1e4 = param_1 + _DAT_00472e18;
    SetFilePointer(DAT_0040b014,DAT_0042f1e4,(PLONG)0x0,0);
  }
  DVar1 = FUN_004033d2(4);
  if ((int)DVar1 < 0) {
    return DVar1;
  }
  BVar2 = ReadFile(DAT_0040b014,&param_1,4,&local_8,(LPOVERLAPPED)0x0);
  if ((BVar2 != 0) && (local_8 == 4)) {
    DAT_0042f1e4 = DAT_0042f1e4 + 4;
    DVar1 = FUN_004033d2(param_1);
    if ((int)DVar1 < 0) {
      return DVar1;
    }
    if (param_3 == (LPVOID)0x0) {
      param_3 = (LPVOID)0x0;
      while( true ) {
        if ((int)param_1 < 1) {
          return DVar1;
        }
        nNumberOfBytesToRead = 0x4000;
        if ((int)param_1 < 0x4000) {
          nNumberOfBytesToRead = param_1;
        }
        BVar2 = ReadFile(DAT_0040b014,&DAT_0042f1e8,nNumberOfBytesToRead,&local_8,(LPOVERLAPPED)0x0)
        ;
        if ((BVar2 == 0) || (nNumberOfBytesToRead != local_8)) break;
        BVar2 = WriteFile(param_2,&DAT_0042f1e8,local_8,&param_4,(LPOVERLAPPED)0x0);
        if ((BVar2 == 0) || (param_4 != nNumberOfBytesToRead)) {
          return 0xfffffffe;
        }
        DVar1 = DVar1 + local_8;
        param_1 = param_1 - local_8;
        DAT_0042f1e4 = DAT_0042f1e4 + local_8;
      }
    }
    else {
      DVar1 = param_1;
      if ((int)param_4 <= (int)param_1) {
        DVar1 = param_4;
      }
      BVar2 = ReadFile(DAT_0040b014,param_3,DVar1,&local_8,(LPOVERLAPPED)0x0);
      if (BVar2 != 0) {
        DAT_0042f1e4 = DAT_0042f1e4 + local_8;
        return local_8;
      }
    }
  }
  return 0xfffffffd;
}



/* Function: FUN_00403679 */

wchar_t * FUN_00403679(uint param_1)

{
  DWORD DVar1;
  HANDLE hFile;
  LPCWSTR pWVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  undefined4 *puVar6;
  int *piVar7;
  uint uVar8;
  WCHAR local_230 [260];
  uint local_28;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  SIZE_T local_14;
  int local_10;
  int local_c;
  uint local_8;
  
  local_8 = 0;
  local_c = 0;
  DVar1 = GetTickCount();
  DAT_00472e20 = DVar1 + 1000;
  GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_004df0d8,0x2004);
  hFile = (HANDLE)FUN_00405fb0((LPCWSTR)&DAT_004df0d8,0x80000000,3);
  if (hFile == (HANDLE)0xffffffff) {
    DAT_0040b010 = hFile;
    return L"Error launching installer";
  }
  DAT_0040b010 = hFile;
  FUN_0040616a((LPWSTR)&DAT_004cf0b8,(LPCWSTR)&DAT_004df0d8);
  pWVar2 = FUN_004068b2((LPCWSTR)&DAT_004cf0b8);
  FUN_0040616a((LPWSTR)&DAT_004e30e0,pWVar2);
  uVar3 = GetFileSize(hFile,(LPDWORD)0x0);
  DAT_0042f1e0 = uVar3;
  for (; 0 < (int)uVar3; uVar3 = uVar3 - uVar8) {
    uVar4 = (-(uint)(DAT_00472e2c != 0) & 0x7e00) + 0x200;
    uVar8 = uVar3;
    if ((int)uVar4 <= (int)uVar3) {
      uVar8 = uVar4;
    }
    iVar5 = FUN_00403389(&DAT_0041f158,uVar8);
    if (iVar5 == 0) {
      FUN_004032e7(1);
      goto LAB_00403889;
    }
    if (DAT_00472e2c == 0) {
      FUN_00405f6c((undefined1 *)&local_28,0x41f158,0x1c);
      if (((((local_28 & 0xfffffff0) == 0) && (local_24 == -0x21524111)) && (local_18 == 0x74736e49)
          ) && ((local_1c == 0x74666f73 && (local_20 == 0x6c6c754e)))) {
        param_1 = param_1 | local_28;
        DAT_00472ea0 = DAT_00472ea0 | param_1 & 2;
        DAT_00472e2c = DAT_0041f154;
        if ((int)uVar3 < local_10) goto LAB_00403889;
        if (((param_1 & 8) == 0) && ((param_1 & 4) != 0)) break;
        local_c = local_c + 1;
        uVar3 = local_10 - 4;
        if (uVar3 < uVar8) {
          uVar8 = uVar3;
        }
      }
    }
    else if ((param_1 & 2) == 0) {
      FUN_004032e7(0);
    }
    if ((int)uVar3 < (int)DAT_0042f1e0) {
      local_8 = FUN_004073e2(local_8,&DAT_0041f158,uVar8);
    }
    DAT_0041f154 = DAT_0041f154 + uVar8;
  }
  FUN_004032e7(1);
  if (DAT_00472e2c != 0) {
    if (local_c != 0) {
      FUN_004033bb(DAT_0041f154);
      iVar5 = FUN_00403389(&param_1,4);
      if ((iVar5 == 0) || (local_8 != param_1)) goto LAB_00403889;
    }
    puVar6 = (undefined4 *)GlobalAlloc(0x40,local_14);
    FUN_00407453(0x427158);
    FUN_00405fe0(local_230,(LPCWSTR)&DAT_004d70c8);
    DAT_0040b014 = CreateFileW(local_230,0xc0000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x4000100,
                               (HANDLE)0x0);
    if (DAT_0040b014 == (HANDLE)0xffffffff) {
      return L"Error writing temporary file. Make sure your temp folder is valid.";
    }
    DAT_004331ec = FUN_004033bb(DAT_00472e2c + 0x1c);
    DAT_004331e8 = (DAT_004331ec - (~local_28 & 4)) + -0x1c + local_10;
    DVar1 = FUN_00403550(0xffffffff,(HANDLE)0x0,puVar6,local_14);
    if (DVar1 == local_14) {
      DAT_00472e28 = *puVar6;
      if ((local_28 & 1) != 0) {
        DAT_00472e24 = DAT_00472e24 + 1;
      }
      iVar5 = 8;
      piVar7 = puVar6 + 0x11;
      DAT_00472ddc = puVar6;
      do {
        piVar7 = piVar7 + -2;
        *piVar7 = *piVar7 + (int)puVar6;
        iVar5 = iVar5 + -1;
      } while (iVar5 != 0);
      puVar6[0xf] = DAT_0042f1e4;
      FUN_00405f6c(&DAT_00472de0,(int)(puVar6 + 1),0x40);
      return (wchar_t *)0x0;
    }
  }
LAB_00403889:
  return 
  L"Installer integrity check has failed. Common causes include\nincomplete download and damaged media. Contact the\ninstaller\'s author to obtain a new copy.\n\nMore information at:\nhttp://nsis.sf.net/NSIS_Error"
  ;
}



/* Function: FUN_00403914 */

void FUN_00403914(void)

{
  int iVar1;
  
  FUN_00406199((LPCWSTR)&DAT_004d70c8);
  iVar1 = FUN_00405e85((ushort *)&DAT_004d70c8);
  if (iVar1 == 0) {
    return;
  }
  FUN_00406883((LPCWSTR)&DAT_004d70c8);
  CreateDirectoryW((LPCWSTR)&DAT_004d70c8,(LPSECURITY_ATTRIBUTES)0x0);
  FUN_00405fe0((LPWSTR)&DAT_004d30c0,(LPCWSTR)&DAT_004d70c8);
  return;
}



/* Function: FUN_00403948 */

int __cdecl FUN_00403948(int param_1,ushort *param_2,int param_3)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = 0;
  iVar4 = param_1 - (int)param_2;
  while( true ) {
    uVar1 = *(ushort *)(iVar4 + (int)param_2);
    uVar2 = *param_2;
    param_2 = param_2 + 1;
    param_3 = param_3 + -1;
    if (uVar1 >= uVar2 && uVar1 != uVar2) {
      iVar3 = 1;
      goto LAB_00403984;
    }
    if (uVar1 < uVar2) break;
    if (((uVar1 == 0) || (uVar2 == 0)) || (param_3 == 0)) goto LAB_00403984;
  }
  iVar3 = -1;
LAB_00403984:
  if (((param_3 != 0) && (iVar3 == 0)) && (uVar1 != uVar2)) {
    iVar3 = (uint)(uVar1 != 0) * 2 + -1;
  }
  return iVar3;
}



/* Function: FUN_004039a1 */

void FUN_004039a1(void)

{
  if (DAT_0040b010 != (HANDLE)0xffffffff) {
    CloseHandle(DAT_0040b010);
    DAT_0040b010 = (HANDLE)0xffffffff;
  }
  if (DAT_0040b014 != (HANDLE)0xffffffff) {
    CloseHandle(DAT_0040b014);
    DAT_0040b014 = (HANDLE)0xffffffff;
  }
  FUN_00403de3();
  FUN_00406dfc((LPCWSTR)&DAT_004db0d0,7);
  return;
}



/* Function: entry */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void entry(void)

{
  bool bVar1;
  LPWSTR pWVar2;
  short *psVar3;
  LPCWSTR pWVar4;
  WCHAR *pWVar5;
  int iVar6;
  undefined3 extraout_var;
  code *pcVar7;
  code *pcVar8;
  code *pcVar9;
  HANDLE pvVar10;
  BOOL BVar11;
  void *this;
  WCHAR WVar12;
  WCHAR WVar13;
  WCHAR *pWVar14;
  undefined4 uVar15;
  UINT uExitCode;
  LPWSTR *ppWVar16;
  wchar_t *local_2d4;
  uint local_2d0;
  UINT local_2cc;
  LPWSTR pWStack_2c8;
  undefined4 uStack_2c4;
  undefined1 auStack_2c0 [12];
  SHFILEINFOW SStack_2b4;
  
  WVar13 = L' ';
  local_2cc = 0;
  local_2d4 = L"Error writing temporary file. Make sure your temp folder is valid.";
  local_2d0 = 0;
  Ordinal_17();
  SetErrorMode(0x8001);
  DAT_00472eb8 = OleInitialize((LPVOID)0x0);
  DAT_00472dd0 = FUN_0040645d(8);
  SHGetFileInfoW(L"",0,&SStack_2b4,0x2b4,0);
  FUN_0040616a((LPWSTR)&DAT_0046adc0,L"NSIS Error");
  pWVar2 = GetCommandLineW();
  FUN_0040616a(&DAT_004c30a0,pWVar2);
  DAT_00472dd8 = GetModuleHandleW((LPCWSTR)0x0);
  psVar3 = &DAT_004c30a0;
  if (DAT_004c30a0 == 0x22) {
    WVar13 = L'\"';
    psVar3 = (short *)&DAT_004c30a2;
  }
  pWVar4 = (LPCWSTR)FUN_00405e66(psVar3,WVar13);
  pWVar5 = CharNextW(pWVar4);
  pWStack_2c8 = pWVar5;
  while (WVar13 = *pWVar5, WVar13 != L'\0') {
    WVar12 = L' ';
    while (WVar13 == L' ') {
      pWVar5 = pWVar5 + 1;
      WVar13 = *pWVar5;
    }
    if (*pWVar5 == L'\"') {
      pWVar5 = pWVar5 + 1;
      WVar12 = L'\"';
    }
    pWVar14 = pWVar5;
    if (*pWVar5 == L'/') {
      pWVar14 = pWVar5 + 1;
      if ((*pWVar14 == L'S') && ((pWVar5[2] == L' ' || (pWVar5[2] == L'\0')))) {
        local_2d0 = local_2d0 | 2;
      }
      iVar6 = FUN_00403948((int)pWVar14,(ushort *)L"NCRC",4);
      if ((iVar6 == 0) && ((pWVar5[5] == L' ' || (pWVar5[5] == L'\0')))) {
        local_2d0 = local_2d0 | 4;
      }
      iVar6 = FUN_00403948((int)(pWVar5 + -1),(ushort *)L" /D=",4);
      if (iVar6 == 0) {
        FUN_00407ecf((int *)(pWVar5 + -1),0,8);
        FUN_0040616a(&DAT_004c70a8,pWVar5 + 3);
        break;
      }
    }
    pWVar5 = (WCHAR *)FUN_00405e66(pWVar14,WVar12);
    if (*pWVar5 == L'\"') {
      pWVar5 = pWVar5 + 1;
    }
  }
  GetTempPathW(0x2004,(LPWSTR)&DAT_004d70c8);
  iVar6 = FUN_00403914();
  if (iVar6 == 0) {
    GetWindowsDirectoryW((LPWSTR)&DAT_004d70c8,0x1fff);
    lstrcatW((LPWSTR)&DAT_004d70c8,L"\\Temp");
    iVar6 = FUN_00403914();
    if (iVar6 == 0) goto LAB_00403c2c;
  }
  DeleteFileW((LPCWSTR)&DAT_004d30c0);
  local_2d4 = FUN_00403679(local_2d0);
  if (local_2d4 != (wchar_t *)0x0) goto LAB_00403c2c;
  if (DAT_00472e24 != 0) {
    psVar3 = (short *)FUN_00405e66(&DAT_004c30a0,L'\0');
    while (((short *)0x4c309f < psVar3 &&
           (iVar6 = FUN_00403948((int)psVar3,(ushort *)L" _?=",4), iVar6 != 0))) {
      psVar3 = psVar3 + -1;
    }
    local_2d4 = L"Error launching installer";
    if (psVar3 < &DAT_004c30a0) {
      lstrcatW((LPWSTR)&DAT_004d70c8,L"~nsu.tmp");
      iVar6 = lstrcmpiW((LPCWSTR)&DAT_004d70c8,(LPCWSTR)&DAT_004cf0b8);
      if (iVar6 != 0) {
        CreateDirectoryW((LPCWSTR)&DAT_004d70c8,(LPSECURITY_ATTRIBUTES)0x0);
        SetCurrentDirectoryW((LPCWSTR)&DAT_004d70c8);
        if (DAT_004c70a8 == 0) {
          FUN_0040616a(&DAT_004c70a8,(LPCWSTR)&DAT_004cf0b8);
        }
        FUN_0040616a((LPWSTR)&DAT_00473000,pWStack_2c8);
        FUN_0040616a((LPWSTR)&DAT_00477008,L"A");
        iVar6 = 0x1a;
        do {
          FUN_00406966((LPWSTR)&DAT_004331f8,*(int *)(DAT_00472ddc + 0x120));
          DeleteFileW((LPCWSTR)&DAT_004331f8);
          if ((local_2d4 != (wchar_t *)0x0) &&
             (BVar11 = CopyFileW((LPCWSTR)&DAT_004df0d8,(LPCWSTR)&DAT_004331f8,1), BVar11 != 0)) {
            FUN_00406dc9((LPCWSTR)&DAT_004331f8,(LPCWSTR)0x0);
            FUN_00406966((LPWSTR)&DAT_004331f8,*(int *)(DAT_00472ddc + 0x124));
            pvVar10 = FUN_00405d9f((LPWSTR)&DAT_004331f8);
            if (pvVar10 != (HANDLE)0x0) {
              CloseHandle(pvVar10);
              local_2d4 = (wchar_t *)0x0;
            }
          }
          _DAT_00477008 = _DAT_00477008 + 1;
          iVar6 = iVar6 + -1;
        } while (iVar6 != 0);
        FUN_00406dc9((LPCWSTR)&DAT_004d70c8,(LPCWSTR)0x0);
      }
      goto LAB_00403c2c;
    }
    *psVar3 = 0;
    pWVar4 = psVar3 + 4;
    bVar1 = FUN_004068df(pWVar4);
    if (CONCAT31(extraout_var,bVar1) == 0) goto LAB_00403c2c;
    FUN_0040616a(&DAT_004c70a8,pWVar4);
    FUN_0040616a((LPWSTR)&DAT_004cb0b0,pWVar4);
    local_2d4 = (wchar_t *)0x0;
  }
  DAT_00472eac = -1;
  local_2cc = FUN_00405a8c();
  FUN_00406248(this,1);
LAB_00403c2c:
  FUN_004039a1();
  OleUninitialize();
  if (local_2d4 == (wchar_t *)0x0) {
    if (DAT_00472e94 != 0) {
      pcVar7 = (code *)FUN_0040645d(3);
      pcVar8 = (code *)FUN_0040645d(4);
      pcVar9 = (code *)FUN_0040645d(5);
      if (((pcVar7 != (code *)0x0) && (pcVar8 != (code *)0x0)) && (pcVar9 != (code *)0x0)) {
        ppWVar16 = &pWStack_2c8;
        uVar15 = 0x28;
        pvVar10 = GetCurrentProcess();
        iVar6 = (*pcVar7)(pvVar10,uVar15,ppWVar16);
        if (iVar6 != 0) {
          (*pcVar8)(0,L"SeShutdownPrivilege",auStack_2c0);
          local_2d0 = 1;
          uStack_2c4 = 2;
          (*pcVar9)(0,0,&local_2d0,0,0,0);
        }
      }
      BVar11 = ExitWindowsEx(2,0);
      if (BVar11 == 0) {
        FUN_0040141d(9);
      }
    }
    uExitCode = local_2cc;
    if (DAT_00472eac != -1) {
      local_2cc = DAT_00472eac;
      uExitCode = DAT_00472eac;
    }
  }
  else {
    FUN_00405e00(local_2d4,0x200010);
    uExitCode = 2;
  }
                    /* WARNING: Subroutine does not return */
  ExitProcess(uExitCode);
}



/* Function: FUN_00403dc8 */

void FUN_00403dc8(undefined4 param_1)

{
  undefined4 *puVar1;
  
  for (puVar1 = DAT_00437200; puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1) {
    (*(code *)puVar1[1])(param_1);
  }
  return;
}



/* Function: FUN_00403de3 */

void FUN_00403de3(void)

{
  int *piVar1;
  int *hMem;
  
  hMem = DAT_00437200;
  FUN_00403dc8(0);
  if (hMem != (int *)0x0) {
    do {
      piVar1 = (int *)*hMem;
      FreeLibrary((HMODULE)hMem[2]);
      GlobalFree(hMem);
      hMem = piVar1;
    } while (piVar1 != (int *)0x0);
  }
  DAT_00437200 = (int *)0x0;
  return;
}



/* Function: FUN_00403e18 */

undefined4 FUN_00403e18(int param_1)

{
  undefined4 *puVar1;
  
  puVar1 = DAT_00437200;
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 1;
    }
    if (puVar1[2] == param_1) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  return 0;
}



/* Function: FUN_00403e36 */

undefined4 FUN_00403e36(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  iVar1 = FUN_00403e18(param_1);
  if (iVar1 == 0) {
    uVar2 = 1;
  }
  else {
    puVar3 = (undefined4 *)GlobalAlloc(0x40,0xc);
    if (puVar3 == (undefined4 *)0x0) {
      uVar2 = 0xffffffff;
    }
    else {
      puVar3[1] = param_2;
      puVar3[2] = param_1;
      *puVar3 = DAT_00437200;
      uVar2 = 0;
      DAT_00437200 = puVar3;
    }
  }
  return uVar2;
}



/* Function: FUN_00403e78 */

void FUN_00403e78(WPARAM param_1)

{
  if (param_1 == 0x78) {
    DAT_0046ad94 = DAT_0046ad94 + 1;
  }
  SendMessageW(DAT_00472dd4,0x408,param_1,0);
  return;
}



/* Function: FUN_00403e9f */

void FUN_00403e9f(HWND param_1,int param_2,int param_3)

{
  LPCWSTR lpString;
  
  lpString = (LPCWSTR)FUN_00406966((LPWSTR)0x0,param_3);
  SetDlgItemTextW(param_1,param_2 + 1000,lpString);
  return;
}



/* Function: FUN_00403ec1 */

void FUN_00403ec1(void)

{
  HWND hWnd;
  
  hWnd = DAT_0043721c;
  if (DAT_00472e8c == 0) {
    hWnd = DAT_0043722c;
  }
  SendMessageW(hWnd,0xf4,1,1);
  return;
}



/* Function: FUN_00403ee5 */

void FUN_00403ee5(BOOL param_1)

{
  EnableWindow(DAT_0043722c,param_1);
  return;
}



/* Function: FUN_00403ef8 */

void FUN_00403ef8(WPARAM param_1)

{
  SendMessageW(DAT_00472dd4,0x28,param_1,1);
  return;
}



/* Function: FUN_00403f0f */

void FUN_00403f0f(UINT param_1)

{
  if (DAT_0046ad88 != (HWND)0x0) {
    SendMessageW(DAT_0046ad88,param_1,0,0);
  }
  return;
}



/* Function: FUN_00403f2a */

COLORREF FUN_00403f2a(HDC param_1,HWND param_2)

{
  int in_EAX;
  COLORREF *pCVar1;
  COLORREF color;
  HBRUSH pHVar2;
  LOGBRUSH local_10;
  
  if ((in_EAX - 0x133U < 6) &&
     (pCVar1 = (COLORREF *)GetWindowLongW(param_2,-0x15), pCVar1 != (COLORREF *)0x0)) {
    color = *pCVar1;
    if ((pCVar1[5] & 2) != 0) {
      color = GetSysColor(color);
    }
    if ((pCVar1[5] & 1) != 0) {
      SetTextColor(param_1,color);
    }
    SetBkMode(param_1,pCVar1[4]);
    local_10.lbColor = pCVar1[1];
    if ((pCVar1[5] & 8) != 0) {
      local_10.lbColor = GetSysColor(local_10.lbColor);
    }
    if ((pCVar1[5] & 4) != 0) {
      SetBkColor(param_1,local_10.lbColor);
    }
    if ((pCVar1[5] & 0x10) != 0) {
      local_10.lbStyle = pCVar1[2];
      if ((HGDIOBJ)pCVar1[3] != (HGDIOBJ)0x0) {
        DeleteObject((HGDIOBJ)pCVar1[3]);
      }
      pHVar2 = CreateBrushIndirect(&local_10);
      pCVar1[3] = (COLORREF)pHVar2;
    }
    return pCVar1[3];
  }
  return 0;
}



/* Function: FUN_00403fd4 */

void FUN_00403fd4(void)

{
  LPCWSTR pWVar1;
  wchar_t *lpString2;
  
  lpString2 = L"install.log";
  pWVar1 = (LPCWSTR)FUN_0040616a(&DAT_0046a560,&DAT_004c70a8);
  pWVar1 = FUN_00406883(pWVar1);
  lstrcatW(pWVar1,lpString2);
  return;
}



/* Function: FUN_00403ff5 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00403ff5(void)

{
  int iVar1;
  ushort *puVar2;
  LPCWSTR lpString;
  int iVar3;
  ushort uVar4;
  int *piVar5;
  
  uVar4 = 0xffff;
  iVar1 = FUN_004060cb((ushort *)&DAT_004d30c0);
  do {
    if (DAT_00472e04 != 0) {
      puVar2 = (ushort *)(*(int *)(DAT_00472ddc + 100) * DAT_00472e04 + _DAT_00472e00);
      iVar3 = DAT_00472e04;
      do {
        puVar2 = (ushort *)((int)puVar2 - *(int *)(DAT_00472ddc + 100));
        iVar3 = iVar3 + -1;
        if ((uVar4 & (*puVar2 ^ (ushort)iVar1)) == 0) {
          DAT_0046ad9c = *(undefined4 *)(puVar2 + 1);
          DAT_00472ea8 = *(undefined4 *)(puVar2 + 3);
          DAT_0046ada8 = puVar2 + 5;
          if (DAT_0046ada8 != (ushort *)0x0) {
            FUN_004060b2((LPWSTR)&DAT_004d30c0,(uint)*puVar2);
            lpString = (LPCWSTR)FUN_00406966((LPWSTR)&DAT_0046adc0,-2);
            SetWindowTextW(DAT_00437228,lpString);
            piVar5 = DAT_00472de8;
            iVar1 = DAT_00472dec;
            while (iVar1 != 0) {
              iVar1 = iVar1 + -1;
              if (*piVar5 != 0) {
                FUN_00406966((LPWSTR)(piVar5 + 6),*piVar5);
              }
              piVar5 = piVar5 + 0x1008;
            }
            return;
          }
          break;
        }
      } while (iVar3 != 0);
    }
    if (uVar4 == 0xffff) {
      uVar4 = 0x3ff;
    }
    else {
      uVar4 = 0;
    }
  } while( true );
}



/* Function: FUN_004040c4 */

undefined4 FUN_004040c4(HWND param_1,int param_2,LPCITEMIDLIST param_3,LPWSTR param_4)

{
  BOOL BVar1;
  int iVar2;
  LPARAM lParam;
  
  if (param_2 == 1) {
    FUN_00405de4(0x3fb,param_4);
    SendMessageW(param_1,0x467,1,(LPARAM)param_4);
  }
  if (param_2 == 2) {
    BVar1 = SHGetPathFromIDListW(param_3,param_4);
    if ((BVar1 == 0) || (iVar2 = FUN_0040141d(7), iVar2 != 0)) {
      lParam = 0;
    }
    else {
      lParam = 1;
    }
    SendMessageW(param_1,0x465,0,lParam);
    return 0;
  }
  return 0;
}



/* Function: FUN_0040412a */

LPSTR __cdecl FUN_0040412a(LPCWSTR param_1)

{
  int iVar1;
  LPSTR lpMultiByteStr;
  
  iVar1 = WideCharToMultiByte(0,0,param_1,-1,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
  lpMultiByteStr = (LPSTR)0x0;
  if (iVar1 != 0) {
    lpMultiByteStr = (LPSTR)GlobalAlloc(0x40,iVar1 + 1U);
    WideCharToMultiByte(0,0,param_1,-1,lpMultiByteStr,iVar1 + 1U,(LPCSTR)0x0,(LPBOOL)0x0);
  }
  return lpMultiByteStr;
}



/* Function: FUN_0040416d */

undefined4 FUN_0040416d(HGLOBAL param_1,LPSTR param_2,int param_3,int *param_4)

{
  int iVar1;
  
  if (DAT_00457274 == 0) {
    lstrcpynA(param_2,(LPCSTR)(DAT_00437208 + (int)param_1),param_3);
    iVar1 = lstrlenA(param_2);
    DAT_00437208 = DAT_00437208 + iVar1;
    *param_4 = iVar1;
    if (((0 < param_3) && (iVar1 == 0)) && (DAT_00437218 != 0)) {
      GlobalFree(param_1);
      DAT_00457274 = 1;
    }
  }
  else {
    *param_4 = 0;
  }
  return 0;
}



/* Function: FUN_004041d7 */

undefined4 FUN_004041d7(int param_1,LPWSTR param_2,uint param_3,int *param_4)

{
  uint iMaxLength;
  int iVar1;
  
  iMaxLength = param_3 >> 1;
  if (iMaxLength == 0) {
    iMaxLength = 1;
  }
  lstrcpynW(param_2,(LPCWSTR)(param_1 + DAT_00437208 * 2),iMaxLength);
  iVar1 = lstrlenW(param_2);
  DAT_00437208 = DAT_00437208 + iVar1;
  *param_4 = iVar1 * 2;
  return 0;
}



/* Function: FUN_00404218 */

COLORREF FUN_00404218(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  ushort *puVar1;
  ushort uVar2;
  LPCWSTR lpString;
  HWND pHVar3;
  DWORD lParam;
  int iVar4;
  HCURSOR pHVar5;
  COLORREF CVar6;
  uint uVar7;
  UINT Msg;
  WPARAM wParam;
  LPARAM lParam_00;
  int local_1c;
  int local_18;
  LPCWSTR local_14;
  LPCWSTR local_10;
  undefined4 local_c;
  code *local_8;
  
  iVar4 = DAT_00457270;
  local_c = 0;
  if (param_2 == 0x110) {
    iVar4 = param_4[0xc].unused;
    if (iVar4 < 0) {
      iVar4 = *(int *)(DAT_0046ada8 - (iVar4 * 4 + 4));
    }
    puVar1 = (ushort *)(DAT_00472df8 + iVar4 * 2);
    uVar2 = *puVar1;
    lpString = (LPCWSTR)(puVar1 + 1);
    DAT_00457274 = 0;
    if ((uVar2 & 0x10) == 0) {
      local_8 = FUN_0040416d;
      local_10 = (LPCWSTR)FUN_0040412a(lpString);
      DAT_00437218 = 1;
    }
    else {
      local_8 = FUN_004041d7;
      local_10 = lpString;
    }
    uVar7 = (~((uint)param_4[5].unused >> 5) | param_4[5].unused) & 1;
    FUN_00403e9f(param_1,0x22,param_4[0xd].unused);
    FUN_00403e9f(param_1,0x23,param_4[0xe].unused);
    CheckDlgButton(param_1,(uVar7 == 0) + 0x40a,1);
    FUN_00403ee5(uVar7);
    pHVar3 = GetDlgItem(param_1,1000);
    FUN_00403ef8((WPARAM)pHVar3);
    SendMessageW(pHVar3,0x45b,1,0);
    lParam = *(DWORD *)(DAT_00472ddc + 0x68);
    if ((int)lParam < 0) {
      lParam = GetSysColor(-lParam);
    }
    SendMessageW(pHVar3,0x443,0,lParam);
    SendMessageW(pHVar3,0x445,0,0x4010000);
    DAT_00437208 = 0;
    iVar4 = lstrlenW(lpString);
    SendMessageW(pHVar3,0x435,0,iVar4);
    SendMessageW(pHVar3,0x449,(uint)uVar2,(LPARAM)&local_10);
    DAT_0045727c = 0;
    return 0;
  }
  if (param_2 == 0x111) {
    if ((((short)((uint)param_3 >> 0x10) != 0) || (DAT_0045727c != 0)) ||
       ((*(byte *)(DAT_00457270 + 0x14) & 0x20) == 0)) goto LAB_004044b0;
    lParam_00 = 0;
    wParam = 0;
    Msg = 0xf0;
    pHVar3 = GetDlgItem(param_1,0x40a);
    uVar7 = SendMessageW(pHVar3,Msg,wParam,lParam_00);
    *(uint *)(iVar4 + 0x14) = *(uint *)(iVar4 + 0x14) & 0xfffffffe | uVar7 & 1;
    FUN_00403ee5(uVar7 & 1);
    FUN_00403ec1();
  }
  if (param_2 == 0x4e) {
    pHVar3 = GetDlgItem(param_1,1000);
    if ((param_4[2].unused == 0x70b) && (param_4[3].unused == 0x201)) {
      local_18 = param_4[7].unused;
      local_1c = param_4[6].unused;
      local_14 = &DAT_00462540;
      if ((uint)(local_18 - local_1c) < 0x8010) {
        SendMessageW(pHVar3,1099,0,(LPARAM)&local_1c);
        pHVar5 = LoadCursorW((HINSTANCE)0x0,(LPCWSTR)0x7f02);
        SetCursor(pHVar5);
        ShellExecuteW(param_1,L"open",local_14,(LPCWSTR)0x0,(LPCWSTR)0x0,1);
        pHVar5 = LoadCursorW((HINSTANCE)0x0,(LPCWSTR)0x7f00);
        SetCursor(pHVar5);
      }
    }
    if ((param_4[2].unused == 0x700) && (param_4[3].unused == 0x100)) {
      if (param_4[4].unused == 0xd) {
        SendMessageW(DAT_00472dd4,0x111,1,0);
      }
      if (param_4[4].unused == 0x1b) {
        SendMessageW(DAT_00472dd4,0x10,0,0);
      }
      return 1;
    }
  }
  else if (param_2 == 0x40b) {
    DAT_0045727c = DAT_0045727c + 1;
  }
LAB_004044b0:
  CVar6 = FUN_00403f2a(param_3,param_4);
  return CVar6;
}



/* Function: FUN_004044c3 */

void FUN_004044c3(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  if (param_2 == 0x110) {
    FUN_00403e9f(param_1,0x1d,param_4[0xc].unused);
    SetDlgItemTextW(param_1,1000,(LPCWSTR)(&DAT_00473000 + param_4[0xf].unused * 0x4008));
  }
  FUN_00403f2a(param_3,param_4);
  return;
}



/* Function: FUN_0040450d */

void FUN_0040450d(int param_1,int param_2)

{
  uint in_EAX;
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  sbyte sVar5;
  uint uVar6;
  wchar_t *pwVar7;
  WCHAR local_88 [32];
  WCHAR local_48 [32];
  int local_8;
  
  sVar5 = 0x14;
  local_8 = -0x24;
  if (in_EAX < 0x100000) {
    sVar5 = 10;
    local_8 = -0x23;
  }
  if (in_EAX < 0x400) {
    sVar5 = 0;
    local_8 = -0x22;
  }
  if (in_EAX < 0xffff3333) {
    in_EAX = in_EAX + (1 << sVar5) / 0x14;
  }
  FUN_00406966(&DAT_00447250,param_2);
  uVar1 = FUN_00406966(local_48,-0x21);
  uVar2 = FUN_00406966(local_88,local_8);
  uVar4 = ((in_EAX & 0xffffff) * 10 >> sVar5) % 10;
  uVar6 = in_EAX >> sVar5;
  pwVar7 = L"%u.%u%s%s";
  iVar3 = lstrlenW(&DAT_00447250);
  wsprintfW(&DAT_00447250 + iVar3,pwVar7,uVar6,uVar4,uVar2,uVar1);
  SetDlgItemTextW(DAT_0046ad88,param_1,&DAT_00447250);
  return;
}



/* Function: FUN_004045d6 */

int FUN_004045d6(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = 0;
  iVar2 = DAT_00472de8;
  iVar3 = DAT_00472dec;
  if (DAT_00472dec != 0) {
    do {
      iVar3 = iVar3 + -1;
      if ((*(byte *)(iVar2 + 8) & 1) != 0) {
        iVar1 = iVar1 + *(int *)(iVar2 + param_1 * 4);
      }
      iVar2 = iVar2 + 0x4020;
    } while (iVar3 != 0);
  }
  return iVar1;
}



/* Function: FUN_00404605 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00404605(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  bool bVar1;
  ushort uVar2;
  HWND pHVar3;
  int iVar4;
  LPWSTR pWVar5;
  code *pcVar6;
  LPITEMIDLIST pv;
  undefined3 extraout_var;
  BOOL BVar7;
  HWND pHVar8;
  int iVar9;
  LPCWSTR pWVar10;
  LPCWSTR lpString;
  LPCITEMIDLIST *ppIVar11;
  _browseinfoW local_4c;
  uint local_2c;
  DWORD local_28;
  int local_24;
  undefined1 local_20 [4];
  DWORD local_1c;
  undefined1 local_18 [4];
  DWORD local_14;
  code *local_10;
  HWND local_c;
  int local_8;
  
  local_24 = DAT_00457270;
  local_8 = *(int *)(DAT_00457270 + 0x38);
  lpString = (LPCWSTR)(&DAT_00473000 + *(int *)(DAT_00457270 + 0x3c) * 0x4008);
  if (param_2 == 0x40b) {
    FUN_00405de4(0x3fb,lpString);
    FUN_00406199(lpString);
    FUN_00403fd4();
    pHVar3 = GetDlgItem(param_1,0x3f0);
    if (pHVar3 == (HWND)0x0) goto LAB_00404999;
    DAT_00461530 = IsDlgButtonChecked(param_1,0x3f0);
  }
  if (param_2 == 0x110) {
    local_c = GetDlgItem(param_1,0x3fb);
    uVar2 = GetAsyncKeyState(0x10);
    if ((uVar2 & 0x8000) != 0) {
      pHVar3 = GetDlgItem(param_1,0x3f0);
      FUN_00403e9f(param_1,8,-0x20);
      ShowWindow(pHVar3,8);
    }
    iVar4 = FUN_00405e85((ushort *)lpString);
    if ((iVar4 != 0) && (pWVar5 = FUN_00405eb9(lpString), pWVar5 == (LPWSTR)0x0)) {
      FUN_00406883(lpString);
    }
    DAT_0046ad88 = param_1;
    SetWindowTextW(local_c,lpString);
    FUN_00403e9f(param_1,1,param_4[0xd].unused);
    FUN_00403e9f(param_1,0x14,param_4[0xc].unused);
    FUN_00403ef8((WPARAM)local_c);
    pcVar6 = (code *)FUN_0040645d(7);
    if (pcVar6 == (code *)0x0) goto LAB_00404999;
    (*pcVar6)(local_c,1);
  }
  iVar4 = local_8;
  if (param_2 == 0x111) {
    if (((uint)param_3 & 0xffff) == 0x3fb) {
      if ((short)((uint)param_3 >> 0x10) != 0x300) goto LAB_00404999;
      param_2 = 0x40f;
    }
    if (((uint)param_3 & 0xffff) == 0x3e9) {
      ppIVar11 = &local_4c.pidlRoot;
      for (iVar9 = 7; iVar9 != 0; iVar9 = iVar9 + -1) {
        *ppIVar11 = (LPCITEMIDLIST)0x0;
        ppIVar11 = ppIVar11 + 1;
      }
      local_4c.hwndOwner = param_1;
      local_4c.pszDisplayName = &DAT_00447250;
      local_4c.lpfn = FUN_004040c4;
      local_4c.lParam = (LPARAM)lpString;
      local_4c.lpszTitle = (LPCWSTR)FUN_00406966((LPWSTR)&DAT_00437230,iVar4);
      local_4c.ulFlags = 0x41;
      pv = SHBrowseForFolderW(&local_4c);
      if (pv == (LPITEMIDLIST)0x0) {
        param_2 = 0x40f;
      }
      else {
        CoTaskMemFree(pv);
        FUN_00406883(lpString);
        if ((*(int *)(DAT_00472ddc + 0x11c) != 0) && (lpString == &DAT_004c70a8)) {
          FUN_00406966((LPWSTR)0x0,*(int *)(DAT_00472ddc + 0x11c));
          iVar4 = lstrcmpiW(&DAT_00462540,&DAT_00447250);
          if (iVar4 != 0) {
            lstrcatW(&DAT_004c70a8,&DAT_00462540);
          }
        }
        DAT_00437214 = DAT_00437214 + 1;
        SetDlgItemTextW(param_1,0x3fb,lpString);
      }
    }
  }
  if ((param_2 == 0x40f) || (param_2 == 0x405)) {
    local_8 = 0;
    local_c = (HWND)0x0;
    FUN_00405de4(0x3fb,lpString);
    bVar1 = FUN_004068df(lpString);
    if (CONCAT31(extraout_var,bVar1) == 0) {
      local_8 = 1;
    }
    FUN_0040616a((LPWSTR)&DAT_00443248,lpString);
    pWVar10 = (LPCWSTR)0x0;
    local_10 = (code *)FUN_0040645d(0);
    if (local_10 != (code *)0x0) {
      do {
        iVar4 = (*local_10)(&DAT_00443248,&local_2c,local_18,local_20);
        if (iVar4 != 0) {
          local_c = (HWND)0x1;
          pHVar3 = (HWND)(local_2c >> 10 | local_28 << 0x16);
          goto LAB_00404905;
        }
        if (pWVar10 != (LPCWSTR)0x0) {
          *pWVar10 = L'\0';
        }
        pWVar10 = FUN_004068b2((LPCWSTR)&DAT_00443248);
        *pWVar10 = L'\0';
        pWVar10 = pWVar10 + -1;
        *pWVar10 = L'\\';
      } while (pWVar10 != (LPCWSTR)&DAT_00443248);
    }
    FUN_0040616a((LPWSTR)&DAT_00443248,lpString);
    pWVar5 = FUN_00405eb9((LPCWSTR)&DAT_00443248);
    if (pWVar5 != (LPWSTR)0x0) {
      *pWVar5 = L'\0';
    }
    BVar7 = GetDiskFreeSpaceW((LPCWSTR)&DAT_00443248,&local_14,&local_1c,(LPDWORD)&local_10,
                              &local_28);
    pHVar3 = param_1;
    if (BVar7 != 0) {
      pHVar3 = (HWND)MulDiv(local_14 * local_1c,(int)local_10,0x400);
      local_c = (HWND)0x1;
    }
LAB_00404905:
    pHVar8 = (HWND)FUN_004045d6(5);
    if ((local_c != (HWND)0x0) && (pHVar3 < pHVar8)) {
      local_8 = 2;
    }
    if (*(int *)(DAT_0046ada8 + 0x10) != 0) {
      FUN_0040450d(0x3ff,-5);
      if (local_c == (HWND)0x0) {
        SetDlgItemTextW(param_1,0x400,L"");
      }
      else {
        FUN_0040450d(0x400,-4);
      }
    }
    _DAT_00472ea4 = local_8;
    if (local_8 == 0) {
      local_8 = FUN_0040141d(7);
    }
    if ((*(uint *)(local_24 + 0x14) & 0x400) != 0) {
      local_8 = 0;
    }
    FUN_00403ee5((uint)(local_8 == 0));
    if ((local_8 == 0) && (DAT_00437214 == 0)) {
      FUN_00403ec1();
    }
    DAT_00437214 = 0;
  }
LAB_00404999:
  FUN_00403f2a(param_3,param_4);
  return;
}



/* Function: FUN_004049ae */

undefined4 FUN_004049ae(HWND param_1,int param_2)

{
  DWORD DVar1;
  undefined4 local_3c;
  LRESULT local_38;
  undefined4 local_18;
  tagPOINT local_14;
  byte local_c;
  LRESULT local_8;
  
  local_38 = SendMessageW(param_1,0x110a,9,0);
  if (param_2 != 0) {
    DVar1 = GetMessagePos();
    local_14.x = (LONG)(short)DVar1;
    local_14.y = (LONG)(short)(DVar1 >> 0x10);
    ScreenToClient(param_1,&local_14);
    SendMessageW(param_1,0x1111,0,(LPARAM)&local_14);
    local_38 = local_8;
    if ((local_c & 0x66) == 0) {
      return 0xffffffff;
    }
  }
  local_3c = 4;
  SendMessageW(param_1,0x113e,0,(LPARAM)&local_3c);
  return local_18;
}



/* Function: FUN_00404a2c */

LRESULT FUN_00404a2c(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  BOOL BVar1;
  LRESULT LVar2;
  
  if (param_2 == 0x102) {
    if (param_3 == 0x20) {
      FUN_00403f0f(0x413);
      return 0;
    }
  }
  else {
    if (param_2 == 0x200) {
      BVar1 = IsWindowVisible(param_1);
      if (BVar1 == 0) goto LAB_00404ac0;
      param_4 = FUN_004049ae(param_1,1);
      param_2 = 0x419;
    }
    if ((param_2 == 0x419) && (DAT_00457280 != param_4)) {
      DAT_00457280 = param_4;
      FUN_0040616a(&DAT_00447250,(LPCWSTR)&DAT_00473000);
      FUN_004060b2((LPWSTR)&DAT_00473000,param_4);
      FUN_0040141d(6);
      FUN_0040616a((LPWSTR)&DAT_00473000,&DAT_00447250);
    }
  }
LAB_00404ac0:
  LVar2 = CallWindowProcW(DAT_00437210,param_1,param_2,param_3,param_4);
  return LVar2;
}



/* Function: FUN_00404adc */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00404adc(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  HBITMAP pHVar1;
  LRESULT LVar2;
  LPARAM lParam;
  WPARAM WVar3;
  uint uVar4;
  int iVar5;
  HWND pHVar6;
  int iVar7;
  uint *puVar8;
  LPARAM local_5c [4];
  uint local_4c;
  int local_48;
  HBITMAP local_44;
  undefined4 local_40;
  uint *local_3c;
  undefined4 local_34;
  int local_30;
  HGLOBAL local_24;
  int local_20;
  int local_1c;
  int local_18;
  HBITMAP local_14;
  LRESULT local_10;
  HWND local_c;
  HWND local_8;
  
  local_c = GetDlgItem(param_1,0x3f9);
  local_8 = GetDlgItem(param_1,0x408);
  local_1c = DAT_00472de8;
  local_20 = DAT_00472ddc + 0x94;
  if (param_2 == 0x110) {
    _DAT_00472e30 = param_1;
    local_24 = (HGLOBAL)0x0;
    local_18 = 2;
    DAT_00437224 = GlobalAlloc(0x40,DAT_00472dec << 2);
    local_14 = LoadBitmapW(DAT_00472dd8,(LPCWSTR)0x6e);
    DAT_00457280 = 0xffffffff;
    DAT_00437210 = SetWindowLongW(local_8,-4,0x404a2c);
    DAT_00437220 = ImageList_Create(0x10,0x10,0x21,6,0);
    ImageList_AddMasked(DAT_00437220,local_14,0xff00ff);
    SendMessageW(local_8,0x1109,2,(LPARAM)DAT_00437220);
    LVar2 = SendMessageW(local_8,0x111c,0,0);
    if (LVar2 < 0x10) {
      SendMessageW(local_8,0x111b,0x10,0);
    }
    DeleteObject(local_14);
    iVar7 = 0;
    do {
      iVar5 = *(int *)(local_20 + iVar7 * 4);
      if (iVar5 != 0) {
        if (iVar7 != 0x20) {
          local_18 = 0;
        }
        lParam = FUN_00406966((LPWSTR)0x0,iVar5);
        WVar3 = SendMessageW(local_c,0x143,0,lParam);
        SendMessageW(local_c,0x151,WVar3,iVar7);
      }
      iVar7 = iVar7 + 1;
    } while (iVar7 < 0x21);
    FUN_00403e9f(param_1,0x15,param_4[local_18 + 0xc].unused);
    FUN_00403e9f(param_1,0x16,param_4[local_18 + 0xd].unused);
    iVar7 = 0;
    local_10 = 0;
    if (DAT_00472dec < 1) {
LAB_00404d0a:
      uVar4 = GetWindowLongW(local_8,-0x10);
      SetWindowLongW(local_8,-0x10,uVar4 & 0xfffffffb);
    }
    else {
      local_14 = (HBITMAP)(local_1c + 8);
      do {
        pHVar1 = local_14 + 4;
        if ((short)pHVar1->unused != 0) {
          local_5c[0] = local_10;
          local_4c = local_14->unused & 0x20;
          local_5c[1] = 0xffff0002;
          local_5c[2] = 0xd;
          local_48 = 0x20;
          local_44 = pHVar1;
          local_30 = iVar7;
          if ((local_14->unused & 2U) == 0) {
            if ((local_14->unused & 4) != 0) {
              local_10 = SendMessageW(local_8,0x110a,3,local_10);
              goto LAB_00404cf0;
            }
            LVar2 = SendMessageW(local_8,0x1132,0,(LPARAM)local_5c);
          }
          else {
            local_5c[2] = 0x4d;
            local_34 = 1;
            LVar2 = SendMessageW(local_8,0x1132,0,(LPARAM)local_5c);
            local_24 = (HGLOBAL)0x1;
            local_10 = LVar2;
          }
          *(LRESULT *)((int)DAT_00437224 + iVar7 * 4) = LVar2;
        }
LAB_00404cf0:
        local_14 = local_14 + 0x1008;
        iVar7 = iVar7 + 1;
      } while (iVar7 < DAT_00472dec);
      if (local_24 == (HGLOBAL)0x0) goto LAB_00404d0a;
    }
    if (local_18 == 0) {
      ShowWindow(local_c,5);
      FUN_00403ef8((WPARAM)local_c);
      goto LAB_004050bd;
    }
    FUN_00403ef8((WPARAM)local_8);
  }
  if (param_2 == 0x405) {
    param_3 = (HDC)0x0;
    param_4 = (HWND)0x1;
    param_2 = 0x40f;
  }
  pHVar6 = param_4;
  if (((param_2 == 0x4e) || (param_2 == 0x413)) &&
     ((param_2 == 0x413 || (param_4[1].unused == 0x408)))) {
    if (((DAT_00472e28 & 0x200) == 0) && ((param_2 == 0x413 || (param_4[2].unused == -2)))) {
      iVar7 = FUN_004049ae(local_8,(uint)(param_2 != 0x413));
      if (-1 < iVar7) {
        puVar8 = (uint *)(iVar7 * 0x4020 + 8 + local_1c);
        uVar4 = *puVar8;
        if ((uVar4 & 0x10) == 0) {
          if ((uVar4 & 0x40) == 0) {
            uVar4 = uVar4 ^ 1;
          }
          else {
            uVar4 = uVar4 ^ 0x80;
            if ((char)uVar4 < '\0') {
              uVar4 = uVar4 | 1;
            }
            else {
              uVar4 = uVar4 & 0xfffffffe;
            }
          }
          *puVar8 = uVar4;
          FUN_00401186(iVar7);
          param_4 = (HWND)(~(DAT_00472e28 >> 8) & 1);
          param_3 = (HDC)0x1;
          param_2 = 0x40f;
        }
      }
    }
    if (pHVar6 != (HWND)0x0) {
      if (pHVar6[2].unused == -0x1c3) {
        SendMessageW(local_8,0x419,0,pHVar6[0x17].unused);
      }
      if (pHVar6[2].unused == -0x1c7) {
        puVar8 = (uint *)(pHVar6[0x17].unused * 0x4020 + 8 + local_1c);
        if (pHVar6[3].unused == 2) {
          *puVar8 = *puVar8 | 0x20;
        }
        else {
          *puVar8 = *puVar8 & 0xffffffdf;
        }
      }
    }
  }
  if (param_2 == 0x111) {
    if (((short)param_3 != 0x3f9) || ((short)((uint)param_3 >> 0x10) != 1)) goto LAB_004050bd;
    WVar3 = SendMessageW(local_c,0x147,0,0);
    if (WVar3 == 0xffffffff) goto LAB_004050bd;
    uVar4 = SendMessageW(local_c,0x150,WVar3,0);
    if ((uVar4 == 0xffffffff) || (*(int *)(local_20 + uVar4 * 4) == 0)) {
      uVar4 = 0x20;
    }
    FUN_004012a6(uVar4);
    SendMessageW(param_1,0x420,0,uVar4);
    param_3 = (HDC)0x1;
    param_4 = (HWND)0x0;
    param_2 = 0x40f;
  }
  if (param_2 == 0x200) {
    SendMessageW(local_8,0x200,0,0);
  }
  if (param_2 == 0x40b) {
    if (DAT_00437220 != (HIMAGELIST)0x0) {
      ImageList_Destroy(DAT_00437220);
    }
    if (DAT_00437224 != (HGLOBAL)0x0) {
      GlobalFree(DAT_00437224);
    }
    DAT_00437220 = (HIMAGELIST)0x0;
    DAT_00437224 = (HGLOBAL)0x0;
    _DAT_00472e30 = (HWND)0x0;
  }
  if (param_2 == 0x40f) {
    FUN_004011f8(0,0);
    if (param_3 != (HDC)0x0) {
      FUN_0040141d(8);
    }
    if (param_4 != (HWND)0x0) {
      param_4 = (HWND)FUN_004012f1((int)DAT_00437224);
      FUN_004012a6((uint)param_4);
      iVar7 = 0;
      WVar3 = 0;
      if (0 < (int)param_4) {
        do {
          if (*(int *)(local_20 + iVar7 * 4) != 0) {
            WVar3 = WVar3 + 1;
          }
          iVar7 = iVar7 + 1;
        } while (iVar7 < (int)param_4);
      }
      SendMessageW(local_c,0x14e,WVar3,0);
      param_2 = 0x420;
    }
    FUN_004011f8(0,0);
    local_24 = DAT_00437224;
    local_40 = 0xf030;
    local_1c = 0;
    if (0 < DAT_00472dec) {
      puVar8 = (uint *)(DAT_00472de8 + 8);
      do {
        iVar7 = *(int *)((int)local_24 + local_1c * 4);
        if (iVar7 != 0) {
          uVar4 = *puVar8;
          local_4c = 8;
          if ((uVar4 & 0x100) != 0) {
            local_3c = puVar8 + 4;
            local_4c = 9;
            *puVar8 = *puVar8 & 0xfffffeff;
          }
          if ((uVar4 & 0x40) == 0) {
            iVar5 = (uVar4 & 1) + 1;
            if ((uVar4 & 0x10) != 0) {
              iVar5 = (uVar4 & 1) + 4;
            }
          }
          else {
            iVar5 = 3;
          }
          local_44 = (HBITMAP)((iVar5 << 0xb | uVar4 & 8) * 2 | uVar4 & 0x20);
          local_48 = iVar7;
          SendMessageW(local_8,0x1102,((int)uVar4 >> 5 & 1U) + 1,iVar7);
          SendMessageW(local_8,0x113f,0,(LPARAM)&local_4c);
        }
        local_1c = local_1c + 1;
        puVar8 = puVar8 + 0x1008;
      } while (local_1c < DAT_00472dec);
    }
    InvalidateRect(local_8,(RECT *)0x0,1);
    if (*(int *)(DAT_0046ada8 + 0x10) != 0) {
      FUN_004045d6(5);
      FUN_0040450d(0x3ff,-5);
    }
  }
  if ((param_2 == 0x420) && ((DAT_00472e28 & 0x100) != 0)) {
    iVar7 = (uint)(param_4 == (HWND)0x20) << 3;
    ShowWindow(local_8,iVar7);
    pHVar6 = GetDlgItem(param_1,0x3fe);
    ShowWindow(pHVar6,iVar7);
  }
LAB_004050bd:
  FUN_00403f2a(param_3,param_4);
  return;
}



/* Function: FUN_004050d2 */

void FUN_004050d2(int param_1,LPCWSTR param_2)

{
  int iVar1;
  int iVar2;
  LRESULT LVar3;
  uint uVar4;
  undefined4 local_48;
  WPARAM local_44;
  undefined4 local_40;
  undefined *local_34;
  uint local_c;
  HWND local_8;
  
  local_8 = DAT_0046ad8c;
  if (DAT_0046ad8c != (HWND)0x0) {
    local_c = DAT_00472eb4;
    uVar4 = DAT_00472eb4 & 1;
    if (uVar4 == 0) {
      FUN_00406966((LPWSTR)&DAT_0043b238,param_1);
    }
    iVar1 = lstrlenW((LPCWSTR)&DAT_0043b238);
    if (param_2 != (LPCWSTR)0x0) {
      iVar2 = lstrlenW(param_2);
      if (0x800f < (uint)(iVar2 + iVar1)) {
        return;
      }
      lstrcatW((LPWSTR)&DAT_0043b238,param_2);
    }
    if ((local_c & 4) == 0) {
      SetWindowTextW(DAT_0046ad98,(LPCWSTR)&DAT_0043b238);
    }
    if ((local_c & 2) == 0) {
      local_34 = &DAT_0043b238;
      local_48 = 1;
      LVar3 = SendMessageW(local_8,0x1004,0,0);
      local_44 = LVar3 - uVar4;
      local_40 = 0;
      SendMessageW(local_8,0x104d - uVar4,0,(LPARAM)&local_48);
      SendMessageW(local_8,0x1013,local_44,0);
    }
    if (uVar4 != 0) {
      *(undefined2 *)(&DAT_0043b238 + iVar1 * 2) = 0;
    }
  }
  return;
}



/* Function: FUN_004051a7 */

int FUN_004051a7(HWND param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = DAT_00472dec;
  iVar3 = DAT_00472de8;
  uVar1 = OleInitialize((LPVOID)0x0);
  DAT_00472eb8 = DAT_00472eb8 | uVar1;
  FUN_00403f0f(0);
  if (iVar4 != 0) {
    iVar3 = iVar3 + 0x18;
    do {
      iVar4 = iVar4 + -1;
      if ((*(byte *)(iVar3 + -0x10) & 1) == 0) {
        FUN_00406404(L"Skipping section: \"%s\"");
      }
      else {
        FUN_00406404(L"Section: \"%s\"");
        iVar2 = FUN_0040139d(*(int *)(iVar3 + -0xc),param_1);
        if (iVar2 != 0) {
          DAT_00472e8c = DAT_00472e8c + 1;
          break;
        }
      }
      iVar3 = iVar3 + 0x4020;
    } while (iVar4 != 0);
  }
  FUN_00403f0f(0x404);
  OleUninitialize();
  return DAT_00472e8c;
}



/* Function: FUN_0040522d */

COLORREF FUN_0040522d(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  int lParam;
  HWND pHVar1;
  COLORREF CVar2;
  HWND pHVar3;
  HANDLE hObject;
  HMENU hMenu;
  LPCWSTR lpNewItem;
  BOOL BVar4;
  LRESULT LVar5;
  HGLOBAL hMem;
  undefined2 *puVar6;
  WPARAM wParam;
  int iVar7;
  DWORD dwCreationFlags;
  DWORD *lpThreadId;
  undefined1 local_58 [8];
  undefined4 local_50;
  undefined4 local_48;
  undefined2 *local_44;
  int local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  tagRECT local_1c;
  DWORD local_c;
  HWND local_8;
  
  pHVar1 = DAT_0046ad8c;
  wParam = 0;
  local_8 = DAT_0046ad8c;
  if (param_2 == 0x110) {
    local_40 = 0xffffffff;
    local_34 = 0xffffffff;
    local_48 = 2;
    local_44 = (undefined2 *)0x0;
    local_3c = 0;
    local_38 = 0;
    local_30 = 0;
    uStack_2c = 0;
    uStack_28 = 0;
    uStack_24 = 0;
    uStack_20 = 0;
    iVar7 = *(int *)(DAT_00472ddc + 0x5c);
    lParam = *(int *)(DAT_00472ddc + 0x60);
    DAT_0046ada0 = GetDlgItem(param_1,0x403);
    DAT_0046ad98 = GetDlgItem(param_1,0x3ee);
    DAT_0046ad8c = GetDlgItem(param_1,0x3f8);
    local_8 = DAT_0046ad8c;
    FUN_00403ef8((WPARAM)DAT_0046ada0);
    DAT_0046ada4 = FUN_004045d6(4);
    DAT_0046adac = 0;
    FUN_00406966((LPWSTR)0x0,-3);
    FUN_00406404(L"New install of \"%s\" to \"%s\"");
    GetClientRect(local_8,&local_1c);
    local_40 = GetSystemMetrics(0x15);
    local_40 = local_1c.right - local_40;
    SendMessageW(local_8,0x1061,0,(LPARAM)&local_48);
    SendMessageW(local_8,0x1036,0x4000,0x4000);
    if (-1 < iVar7) {
      SendMessageW(local_8,0x1001,0,iVar7);
      SendMessageW(local_8,0x1026,0,iVar7);
    }
    if (-1 < lParam) {
      SendMessageW(local_8,0x1024,0,lParam);
    }
    FUN_00403e9f(param_1,0x1b,param_4[0xc].unused);
    if (((byte)DAT_00472e28 & 3) != 0) {
      ShowWindow(DAT_0046ada0,0);
      if (((byte)DAT_00472e28 & 2) == 0) {
        ShowWindow(local_8,8);
      }
      else {
        DAT_0046ada0 = (HWND)0x0;
      }
      FUN_00403ef8((WPARAM)DAT_0046ad98);
    }
    pHVar1 = GetDlgItem(param_1,0x3ec);
    SendMessageW(pHVar1,0x401,0,0x75300000);
    if (((byte)DAT_00472e28 & 4) != 0) {
      SendMessageW(pHVar1,0x409,0,lParam);
      SendMessageW(pHVar1,0x2001,0,iVar7);
    }
LAB_004053ee:
    CVar2 = 0;
  }
  else {
    if (param_2 == 0x405) {
      lpThreadId = &local_c;
      dwCreationFlags = 0;
      pHVar3 = GetDlgItem(param_1,0x3ec);
      hObject = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_004051a7,pHVar3,dwCreationFlags,
                             lpThreadId);
      CloseHandle(hObject);
    }
    if (param_2 == 0x111) {
      if ((short)param_3 == 0x403) {
        ShowWindow(DAT_0046ada0,0);
        ShowWindow(pHVar1,8);
        FUN_00403ef8((WPARAM)pHVar1);
        goto LAB_00405454;
      }
    }
    else {
LAB_00405454:
      if (param_2 == 0x404) {
        if (DAT_0046ad94 != 0) {
          DAT_00457278 = 2;
          FUN_00403e78(0x78);
          goto LAB_00405476;
        }
        ShowWindow(DAT_00472dd4,8);
        if (DAT_00472e8c == 0) {
          FUN_004050d2(*(int *)(DAT_00457270 + 0x34),(LPCWSTR)0x0);
        }
        FUN_00403e78(1);
      }
      if ((param_2 == 0x7b) && (param_3 == (HDC)pHVar1)) {
        pHVar3 = (HWND)SendMessageW(pHVar1,0x1004,0,0);
        if (0 < (int)pHVar3) {
          hMenu = CreatePopupMenu();
          lpNewItem = (LPCWSTR)FUN_00406966((LPWSTR)0x0,-0x1f);
          AppendMenuW(hMenu,0,1,lpNewItem);
          if (param_4 == (HWND)0xffffffff) {
            GetWindowRect(pHVar1,&local_1c);
          }
          else {
            local_1c.left = (LONG)(short)param_4;
            local_1c.top = (LONG)(short)((uint)param_4 >> 0x10);
          }
          BVar4 = TrackPopupMenu(hMenu,0x180,local_1c.left,local_1c.top,0,param_1,(RECT *)0x0);
          iVar7 = 1;
          if (BVar4 == 1) {
            local_50 = 0;
            local_44 = &DAT_00447250;
            local_40 = 0x1001f;
            param_1 = pHVar3;
            do {
              param_1 = (HWND)((int)&param_1[-1].unused + 3);
              LVar5 = SendMessageW(local_8,0x1073,(WPARAM)param_1,(LPARAM)local_58);
              iVar7 = iVar7 + 2 + LVar5;
            } while (param_1 != (HWND)0x0);
            OpenClipboard((HWND)0x0);
            EmptyClipboard();
            hMem = GlobalAlloc(0x42,iVar7 * 2);
            puVar6 = (undefined2 *)GlobalLock(hMem);
            do {
              local_44 = puVar6;
              LVar5 = SendMessageW(local_8,0x1073,wParam,(LPARAM)local_58);
              puVar6 = puVar6 + LVar5;
              *puVar6 = 0xd;
              puVar6[1] = 10;
              puVar6 = puVar6 + 2;
              wParam = wParam + 1;
            } while ((int)wParam < (int)pHVar3);
            GlobalUnlock(hMem);
            SetClipboardData(0xd,hMem);
            CloseClipboard();
          }
        }
        goto LAB_004053ee;
      }
    }
LAB_00405476:
    CVar2 = FUN_00403f2a(param_3,param_4);
  }
  return CVar2;
}



/* Function: FUN_00405a8c */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

INT_PTR FUN_00405a8c(void)

{
  bool bVar1;
  ATOM AVar2;
  code *pcVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined2 *puVar5;
  int iVar6;
  DWORD DVar7;
  undefined3 extraout_var_00;
  int iVar8;
  HMODULE pHVar9;
  BOOL BVar10;
  INT_PTR IVar11;
  LPCWSTR pWVar12;
  undefined *puStack_18;
  undefined4 uStack_14;
  int iStack_10;
  int iStack_c;
  int iStack_8;
  int iStack_4;
  
  iVar8 = DAT_00472ddc;
  pcVar3 = (code *)FUN_0040645d(6);
  if (pcVar3 == (code *)0x0) {
    _DAT_004d30c0 = 0x30;
    _DAT_004d30c2 = 0x78;
    _DAT_004d30c4 = 0;
    FUN_00406034((HKEY)0x80000001,L"Control Panel\\Desktop\\ResourceLocale",(LPCWSTR)0x0,
                 (LPBYTE)&DAT_00447250,(HKEY)0x0);
    if (DAT_00447250 == 0) {
      FUN_00406034((HKEY)0x80000003,L".DEFAULT\\Control Panel\\International",L"Locale",
                   (LPBYTE)&DAT_00447250,(HKEY)0x0);
    }
    lstrcatW((LPWSTR)&DAT_004d30c0,&DAT_00447250);
  }
  else {
    uVar4 = (*pcVar3)();
    FUN_004060b2((LPWSTR)&DAT_004d30c0,uVar4 & 0xffff);
  }
  FUN_00403ff5();
  DAT_00472e80 = DAT_00472e28 & 0x20;
  _DAT_00472e9c = 0x10000;
  bVar1 = FUN_004068df(&DAT_004c70a8);
  if ((CONCAT31(extraout_var,bVar1) == 0) && (*(int *)(iVar8 + 0x48) != 0)) {
    pWVar12 = &DAT_00462540;
    FUN_00406034(*(HKEY *)(iVar8 + 0x44),(LPCWSTR)(DAT_00472df8 + *(int *)(iVar8 + 0x48) * 2),
                 (LPCWSTR)(DAT_00472df8 + *(int *)(iVar8 + 0x4c) * 2),(LPBYTE)&DAT_00462540,
                 (HKEY)0x0);
    if (DAT_00462540 != 0) {
      if (DAT_00462540 == 0x22) {
        pWVar12 = (LPCWSTR)&DAT_00462542;
        puVar5 = (undefined2 *)FUN_00405e66((LPCWSTR)&DAT_00462542,L'\"');
        *puVar5 = 0;
      }
      iVar6 = lstrlenW(pWVar12);
      if (((pWVar12 < pWVar12 + iVar6 + -4) &&
          (iVar6 = lstrcmpiW(pWVar12 + iVar6 + -4,L".exe"), iVar6 == 0)) &&
         ((DVar7 = GetFileAttributesW(pWVar12), DVar7 == 0xffffffff || ((DVar7 & 0x10) == 0)))) {
        FUN_004068b2(pWVar12);
      }
      pWVar12 = FUN_00406883(pWVar12);
      FUN_0040616a(&DAT_004c70a8,pWVar12);
    }
  }
  bVar1 = FUN_004068df(&DAT_004c70a8);
  if (CONCAT31(extraout_var_00,bVar1) == 0) {
    FUN_00406966(&DAT_004c70a8,*(int *)(iVar8 + 0x118));
  }
  if (((DAT_00472e28 & 0x10) != 0) && (DAT_00472e24 == 0)) {
    FUN_00403fd4();
    DAT_00461530 = 1;
  }
  DAT_0046ad90 = LoadImageW(DAT_00472dd8,(LPCWSTR)0x67,1,0,0,0x8040);
  if (*(int *)(iVar8 + 0x50) == -1) {
LAB_00405cc6:
    iVar8 = FUN_0040141d(0);
    if (iVar8 == 0) {
      FUN_00403ff5();
      if (DAT_00472ea0 == 0) {
        ShowWindow(DAT_00437228,5);
        pHVar9 = LoadLibraryW(L"RichEd20");
        if (pHVar9 == (HMODULE)0x0) {
          LoadLibraryW(L"RichEd32");
        }
        BVar10 = GetClassInfoW((HINSTANCE)0x0,L"RichEdit20A",(LPWNDCLASSW)&DAT_0046ad60);
        if (BVar10 == 0) {
          GetClassInfoW((HINSTANCE)0x0,L"RichEdit",(LPWNDCLASSW)&DAT_0046ad60);
          _DAT_0046ad84 = L"RichEdit20A";
          RegisterClassW((WNDCLASSW *)&DAT_0046ad60);
        }
        IVar11 = DialogBoxParamW(DAT_00472dd8,(LPCWSTR)(DAT_0046ad9c + 0x69U & 0xffff),(HWND)0x0,
                                 (DLGPROC)&LAB_004055d9,0);
        FUN_0040141d(5);
        FUN_00403dc8(1);
        return IVar11;
      }
      iVar8 = FUN_004051a7((HWND)0x0);
      if (iVar8 == 0) {
        FUN_0040141d(1);
        goto LAB_00405d95;
      }
      if (DAT_0046ad94 == 0) {
        FUN_0040141d(2);
      }
    }
    IVar11 = 2;
  }
  else {
    puStack_18 = PTR_DAT_00409430;
    uStack_14 = DAT_00409434;
    _DAT_0046ad84 = (wchar_t *)&puStack_18;
    _DAT_0046ad64 = FUN_00401000;
    _DAT_0046ad70 = DAT_00472dd8;
    _DAT_0046ad74 = DAT_0046ad90;
    AVar2 = RegisterClassW((WNDCLASSW *)&DAT_0046ad60);
    if (AVar2 != 0) {
      SystemParametersInfoW(0x30,0,&iStack_10,0);
      DAT_00437228 = CreateWindowExW(0x80,(LPCWSTR)&puStack_18,(LPCWSTR)0x0,0x80000000,iStack_10,
                                     iStack_c,iStack_8 - iStack_10,iStack_4 - iStack_c,(HWND)0x0,
                                     (HMENU)0x0,DAT_00472dd8,(LPVOID)0x0);
      goto LAB_00405cc6;
    }
LAB_00405d95:
    IVar11 = 0;
  }
  return IVar11;
}



/* Function: FUN_00405d9f */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

HANDLE FUN_00405d9f(LPWSTR param_1)

{
  HANDLE pvVar1;
  _PROCESS_INFORMATION local_14;
  
  _DAT_00457288 = 0x44;
  pvVar1 = (HANDLE)CreateProcessW((LPCWSTR)0x0,param_1,(LPSECURITY_ATTRIBUTES)0x0,
                                  (LPSECURITY_ATTRIBUTES)0x0,0,0,(LPVOID)0x0,(LPCWSTR)0x0,
                                  (LPSTARTUPINFOW)&DAT_00457288,&local_14);
  if (pvVar1 != (HANDLE)0x0) {
    CloseHandle(local_14.hThread);
    pvVar1 = local_14.hProcess;
  }
  return pvVar1;
}



/* Function: SetDlgItemTextW */

BOOL SetDlgItemTextW(HWND hDlg,int nIDDlgItem,LPCWSTR lpString)

{
  BOOL BVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00405dde. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  BVar1 = SetDlgItemTextW(hDlg,nIDDlgItem,lpString);
  return BVar1;
}



/* Function: FUN_00405de4 */

void FUN_00405de4(int param_1,LPWSTR param_2)

{
  GetDlgItemTextW(DAT_0046ad88,param_1,param_2,0x2004);
  return;
}



/* Function: FUN_00405e00 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00405e00(undefined4 param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = param_2 & 0x1fffff;
  if ((DAT_00472ea0 == 0) || (param_2 >> 0x15 == 0)) {
    if (DAT_00472ea8 != 0) {
      uVar1 = uVar1 ^ 0x180000;
    }
    _DAT_0040b034 = DAT_00472dd4;
    _DAT_0040b038 = DAT_00472dd8;
    _DAT_0040b03c = param_1;
    _DAT_0040b040 = &DAT_0046adc0;
    _DAT_0040b044 = uVar1;
    MessageBoxIndirectW((MSGBOXPARAMSW *)&DAT_0040b030);
  }
  return;
}



/* Function: FUN_00405e66 */

void FUN_00405e66(LPCWSTR param_1,WCHAR param_2)

{
  for (; (*param_1 != L'\0' && (*param_1 != param_2)); param_1 = CharNextW(param_1)) {
  }
  return;
}



/* Function: FUN_00405e85 */

undefined4 FUN_00405e85(ushort *param_1)

{
  undefined4 uVar1;
  
  if (((*param_1 == 0x5c) && (param_1[1] == 0x5c)) ||
     (((ushort)((*param_1 | 0x20) - 0x61) < 0x1a && (param_1[1] == 0x3a)))) {
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



/* Function: FUN_00405eb9 */

LPWSTR FUN_00405eb9(LPCWSTR param_1)

{
  LPWSTR lpsz;
  LPWSTR lpsz_00;
  short *psVar1;
  int iVar2;
  
  lpsz = CharNextW(param_1);
  lpsz_00 = CharNextW(lpsz);
  if (((*param_1 == L'\0') || (*lpsz != L':')) || (lpsz[1] != L'\\')) {
    if ((*param_1 == L'\\') && (param_1[1] == L'\\')) {
      iVar2 = 2;
      do {
        iVar2 = iVar2 + -1;
        psVar1 = (short *)FUN_00405e66(lpsz_00,L'\\');
        if (*psVar1 == 0) goto LAB_00405f0e;
        lpsz_00 = psVar1 + 1;
      } while (iVar2 != 0);
    }
    else {
LAB_00405f0e:
      lpsz_00 = (LPWSTR)0x0;
    }
  }
  else {
    lpsz_00 = CharNextW(lpsz_00);
  }
  return lpsz_00;
}



/* Function: FUN_00405f16 */

LPCSTR FUN_00405f16(LPSTR param_1,LPCSTR param_2)

{
  CHAR CVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = lstrlenA(param_2);
  while( true ) {
    iVar3 = lstrlenA(param_1);
    if (iVar3 < iVar2) {
      return (LPCSTR)0x0;
    }
    CVar1 = param_1[iVar2];
    param_1[iVar2] = '\0';
    iVar3 = lstrcmpiA(param_1,param_2);
    param_1[iVar2] = CVar1;
    if (iVar3 == 0) break;
    param_1 = CharNextA(param_1);
  }
  return param_1;
}



/* Function: FUN_00405f6c */

void FUN_00405f6c(undefined1 *param_1,int param_2,int param_3)

{
  int iVar1;
  
  if (0 < param_3) {
    iVar1 = param_2 - (int)param_1;
    do {
      param_3 = param_3 + -1;
      *param_1 = param_1[iVar1];
      param_1 = param_1 + 1;
    } while (0 < param_3);
  }
  return;
}



/* Function: FUN_00405f90 */

void FUN_00405f90(LPCWSTR param_1)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesW(param_1);
  if (DVar1 != 0xffffffff) {
    SetFileAttributesW(param_1,DVar1 & 0xfffffffe);
  }
  return;
}



/* Function: FUN_00405fb0 */

void FUN_00405fb0(LPCWSTR param_1,DWORD param_2,DWORD param_3)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesW(param_1);
  CreateFileW(param_1,param_2,1,(LPSECURITY_ATTRIBUTES)0x0,param_3,
              -(uint)(DVar1 != 0xffffffff) & DVar1,(HANDLE)0x0);
  return;
}



/* Function: FUN_00405fe0 */

LPWSTR FUN_00405fe0(LPWSTR param_1,LPCWSTR param_2)

{
  DWORD DVar1;
  UINT UVar2;
  int iVar3;
  undefined4 local_c;
  undefined4 local_8;
  
  iVar3 = 100;
  do {
    local_c = DAT_0040968c;
    iVar3 = iVar3 + -1;
    local_8 = DAT_00409690;
    DVar1 = GetTickCount();
    local_8 = CONCAT22(local_8._2_2_,(short)local_8 + (short)(DVar1 % 0x1a));
    UVar2 = GetTempFileNameW(param_2,(LPCWSTR)&local_c,0,param_1);
    if (UVar2 != 0) {
      return param_1;
    }
  } while (iVar3 != 0);
  *param_1 = L'\0';
  return (LPWSTR)0x0;
}



/* Function: FUN_00406034 */

void FUN_00406034(HKEY param_1,LPCWSTR param_2,LPCWSTR param_3,LPBYTE param_4,HKEY param_5)

{
  LPBYTE pBVar1;
  LSTATUS LVar2;
  
  pBVar1 = param_4;
  pBVar1[0] = '\0';
  pBVar1[1] = '\0';
  LVar2 = RegOpenKeyExW(param_1,param_2,0,-(uint)(param_5 != (HKEY)0x0) & 0x100 | 0x20019,&param_5);
  if (LVar2 == 0) {
    param_2 = (LPCWSTR)0x4008;
    LVar2 = RegQueryValueExW(param_5,param_3,(LPDWORD)0x0,(LPDWORD)&param_4,pBVar1,(LPDWORD)&param_2
                            );
    if ((LVar2 != 0) || ((param_4 != (LPBYTE)0x1 && (param_4 != (LPBYTE)0x2)))) {
      pBVar1[0] = '\0';
      pBVar1[1] = '\0';
    }
    pBVar1[0x4006] = '\0';
    pBVar1[0x4007] = '\0';
    RegCloseKey(param_5);
  }
  return;
}



/* Function: FUN_004060b2 */

void FUN_004060b2(LPWSTR param_1,undefined4 param_2)

{
  wsprintfW(param_1,L"%d",param_2);
  return;
}



/* Function: FUN_004060cb */

int FUN_004060cb(ushort *param_1)

{
  ushort uVar1;
  ushort uVar2;
  ushort *puVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int local_c;
  int local_8;
  
  local_8 = 0;
  uVar2 = 10;
  local_c = 1;
  uVar6 = 0x39;
  if (*param_1 == 0x2d) {
    param_1 = param_1 + 1;
    local_c = -1;
  }
  puVar3 = param_1;
  if (*param_1 == 0x30) {
    puVar3 = param_1 + 1;
    uVar1 = *puVar3;
    if ((0x2f < uVar1) && (uVar1 < 0x38)) {
      uVar2 = 8;
      uVar6 = 0x37;
    }
    if ((uVar1 & 0xffdf) == 0x58) {
      uVar2 = 0x10;
      puVar3 = param_1 + 2;
    }
  }
  do {
    uVar4 = (uint)*puVar3;
    puVar3 = puVar3 + 1;
    if ((uVar4 < 0x30) || (uVar6 < uVar4)) {
      if ((uVar2 != 0x10) || (((uVar4 & 0xffffffdf) < 0x41 || (0x46 < (uVar4 & 0xffffffdf))))) {
        return local_c * local_8;
      }
      iVar5 = (uVar4 & 7) + 9;
    }
    else {
      iVar5 = uVar4 - 0x30;
    }
    local_8 = (uint)uVar2 * local_8 + iVar5;
  } while( true );
}



/* Function: FUN_0040616a */

void FUN_0040616a(LPWSTR param_1,LPCWSTR param_2)

{
  lstrcpynW(param_1,param_2,0x2004);
  return;
}



/* Function: lstrlenW */

int lstrlenW(LPCWSTR lpString)

{
  int iVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00406180. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = lstrlenW(lpString);
  return iVar1;
}



/* Function: lstrcatW */

LPWSTR lstrcatW(LPWSTR lpString1,LPCWSTR lpString2)

{
  LPWSTR pWVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00406186. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  pWVar1 = lstrcatW(lpString1,lpString2);
  return pWVar1;
}



/* Function: FUN_0040618c */

void __cdecl FUN_0040618c(ushort param_1)

{
  CharUpperW((LPWSTR)(uint)param_1);
  return;
}



/* Function: FUN_00406199 */

void FUN_00406199(LPCWSTR param_1)

{
  WCHAR WVar1;
  int iVar2;
  short *psVar3;
  LPWSTR pWVar4;
  LPCWSTR lpsz;
  LPCWSTR lpsz_00;
  
  if ((((*param_1 == L'\\') && (param_1[1] == L'\\')) && (param_1[2] == L'?')) &&
     (param_1[3] == L'\\')) {
    param_1 = param_1 + 4;
  }
  if ((*param_1 != L'\0') && (iVar2 = FUN_00405e85((ushort *)param_1), iVar2 != 0)) {
    param_1 = param_1 + 2;
  }
  WVar1 = *param_1;
  lpsz_00 = param_1;
  lpsz = param_1;
  while (WVar1 != L'\0') {
    if ((0x1f < (ushort)WVar1) && (psVar3 = (short *)FUN_00405e66(L"*?|<>/\":",WVar1), *psVar3 == 0)
       ) {
      pWVar4 = CharNextW(lpsz_00);
      FUN_00405f6c((undefined1 *)lpsz,(int)lpsz_00,(int)pWVar4 - (int)lpsz_00 >> 1);
      lpsz = CharNextW(lpsz);
    }
    lpsz_00 = CharNextW(lpsz_00);
    WVar1 = *lpsz_00;
  }
  *lpsz = L'\0';
  while( true ) {
    lpsz = CharPrevW(param_1,lpsz);
    if ((*lpsz != L' ') && (*lpsz != L'\\')) break;
    *lpsz = L'\0';
    if (lpsz <= param_1) {
      return;
    }
  }
  return;
}



/* Function: FUN_00406248 */

void __thiscall FUN_00406248(void *this,DWORD param_1)

{
  int iVar1;
  void *local_8;
  
  local_8 = this;
  if (param_1 != 0) {
    if (DAT_0040b058 != (HANDLE)0xffffffff) {
      CloseHandle(DAT_0040b058);
    }
    DAT_0040b058 = (HANDLE)0xffffffff;
    return;
  }
  if (DAT_00461530 == 0) {
    return;
  }
  if (DAT_0046a560 != 0) {
    if (DAT_0040b058 != (HANDLE)0xffffffff) goto LAB_004062f1;
    param_1 = GetFileAttributesW(&DAT_0046a560);
    DAT_0040b058 = (HANDLE)FUN_00405fb0(&DAT_0046a560,0x40000000,4);
    if (DAT_0040b058 == (HANDLE)0xffffffff) {
      return;
    }
    if (param_1 == 0xffffffff) {
      param_1 = 0xfeff;
      WriteFile(DAT_0040b058,&param_1,2,(LPDWORD)&local_8,(LPOVERLAPPED)0x0);
    }
    SetFilePointer(DAT_0040b058,0,(PLONG)0x0,2);
  }
  if (DAT_0040b058 == (HANDLE)0xffffffff) {
    return;
  }
LAB_004062f1:
  lstrcatW((LPWSTR)&DAT_00461540,L"\r\n");
  iVar1 = lstrlenW((LPCWSTR)&DAT_00461540);
  WriteFile(DAT_0040b058,&DAT_00461540,iVar1 * 2,&param_1,(LPOVERLAPPED)0x0);
  return;
}



/* Function: FUN_00406321 */

wchar_t * __cdecl FUN_00406321(int param_1)

{
  wchar_t *pwVar1;
  
  if (param_1 == -0x80000000) {
    return L"HKEY_CLASSES_ROOT";
  }
  if (param_1 == -0x7fffffff) {
    return L"HKEY_CURRENT_USER";
  }
  if (param_1 == -0x7ffffffe) {
    return L"HKEY_LOCAL_MACHINE";
  }
  if (param_1 == -0x7ffffffd) {
    return L"HKEY_USERS";
  }
  if (param_1 == -0x7ffffffc) {
    return L"HKEY_PERFORMANCE_DATA";
  }
  if (param_1 == -0x7ffffffb) {
    return L"HKEY_CURRENT_CONFIG";
  }
  pwVar1 = L"HKEY_DYN_DATA";
  if (param_1 != -0x7ffffffa) {
    pwVar1 = L"invalid registry key";
  }
  return pwVar1;
}



/* Function: FUN_00406385 */

void __cdecl FUN_00406385(LPWSTR param_1,uint param_2,int param_3,uint param_4)

{
  bool bVar1;
  uint uVar2;
  uint uVar3;
  LPWSTR local_8;
  
  local_8 = param_1;
  uVar2 = param_2 / 3;
  uVar3 = 0;
  bVar1 = uVar2 < param_4;
  if (bVar1) {
    param_4 = uVar2 - 1;
  }
  if (param_4 != 0) {
    do {
      wsprintfW(local_8,L"%02x%c",(uint)*(byte *)(uVar3 + param_3),
                -(uint)(uVar3 != param_4 - 1) & 0x20);
      local_8 = local_8 + 3;
      uVar3 = uVar3 + 1;
    } while (uVar3 < param_4);
  }
  if (bVar1) {
    lstrcatW(param_1,L"...");
  }
  return;
}



/* Function: FUN_00406404 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_00406404(LPCWSTR param_1)

{
  int iVar1;
  void *this;
  
  _DAT_00461540 = 0;
  iVar1 = lstrlenW((LPCWSTR)&DAT_00461540);
  wvsprintfW((LPWSTR)(&DAT_00461540 + iVar1 * 2),param_1,&stack0x00000008);
  FUN_00406248(this,0);
  return;
}



/* Function: FUN_00406436 */

undefined * FUN_00406436(LPCWSTR param_1)

{
  HANDLE hFindFile;
  undefined *puVar1;
  
  hFindFile = FindFirstFileW(param_1,(LPWIN32_FIND_DATAW)&DAT_0045bed8);
  if (hFindFile == (HANDLE)0xffffffff) {
    puVar1 = (undefined *)0x0;
  }
  else {
    FindClose(hFindFile);
    puVar1 = &DAT_0045bed8;
  }
  return puVar1;
}



/* Function: FUN_0040645d */

void FUN_0040645d(int param_1)

{
  LPCSTR lpModuleName;
  HMODULE hModule;
  
  lpModuleName = (&PTR_s_KERNEL32_0040b060)[param_1 * 2];
  hModule = GetModuleHandleA(lpModuleName);
  if ((hModule == (HMODULE)0x0) && (hModule = LoadLibraryA(lpModuleName), hModule == (HMODULE)0x0))
  {
    return;
  }
  GetProcAddress(hModule,(&PTR_s_GetDiskFreeSpaceExW_0040b064)[param_1 * 2]);
  return;
}



/* Function: FUN_00406493 */

void FUN_00406493(UINT param_1)

{
  BOOL BVar1;
  MSG local_20;
  
  while( true ) {
    BVar1 = PeekMessageW(&local_20,(HWND)0x0,param_1,param_1,1);
    if (BVar1 == 0) break;
    DispatchMessageW(&local_20);
  }
  return;
}



/* Function: FUN_004064c6 */

FARPROC FUN_004064c6(HMODULE param_1,LPCWSTR param_2)

{
  LPCSTR lpMultiByteStr;
  int iVar1;
  FARPROC pFVar2;
  
  lpMultiByteStr = (LPCSTR)GlobalAlloc(0x40,0x2004);
  pFVar2 = (FARPROC)0x0;
  iVar1 = WideCharToMultiByte(0,0,param_2,-1,lpMultiByteStr,0x2004,(LPCSTR)0x0,(LPBOOL)0x0);
  if (iVar1 != 0) {
    pFVar2 = GetProcAddress(param_1,lpMultiByteStr);
  }
  GlobalFree(lpMultiByteStr);
  return pFVar2;
}



/* Function: FUN_0040650d */

undefined4 FUN_0040650d(LPCWSTR param_1)

{
  WCHAR WVar1;
  int iVar2;
  BOOL BVar3;
  LPWSTR lpString1;
  HMODULE hModule;
  FARPROC pFVar4;
  HANDLE pvVar5;
  undefined4 uVar6;
  int iVar7;
  undefined4 local_b9c [8];
  WCHAR local_b7c [516];
  WCHAR local_774 [260];
  undefined4 local_56c [2];
  undefined4 local_564;
  WCHAR local_340 [260];
  _OSVERSIONINFOW local_138;
  FARPROC local_24;
  undefined4 local_20;
  FARPROC local_1c;
  uint local_18;
  HMODULE local_14;
  FARPROC local_10;
  FARPROC local_c;
  HGLOBAL local_8;
  
  local_8 = GlobalAlloc(0x40,4000);
  iVar2 = lstrlenW(param_1);
  if (0x103 < iVar2 - 1U) {
    return 0x278;
  }
  iVar7 = 0;
  if (0 < iVar2) {
    do {
      WVar1 = FUN_0040618c(param_1[iVar7]);
      local_340[iVar7] = WVar1;
      iVar7 = iVar7 + 1;
    } while (iVar7 < iVar2);
  }
  local_340[iVar2] = L'\0';
  local_138.dwOSVersionInfoSize = 0x114;
  BVar3 = GetVersionExW(&local_138);
  if (BVar3 == 0) {
    return 0x25e;
  }
  if (local_138.dwPlatformId == 2) {
    hModule = LoadLibraryA("PSAPI.DLL");
    if (hModule != (HMODULE)0x0) {
      local_14 = hModule;
      pFVar4 = GetProcAddress(hModule,"EnumProcesses");
      local_c = GetProcAddress(hModule,"EnumProcessModules");
      local_10 = GetProcAddress(hModule,"GetModuleBaseNameW");
      if (((pFVar4 != (FARPROC)0x0) && (local_c != (FARPROC)0x0)) && (local_10 != (FARPROC)0x0)) {
        iVar2 = (*pFVar4)(local_8,1000,&local_18);
        if (iVar2 == 0) {
          uVar6 = 0x25d;
LAB_00406634:
          FreeLibrary(hModule);
          GlobalFree(local_8);
          return uVar6;
        }
        param_1 = (LPCWSTR)0x0;
        if ((LPCWSTR)(local_18 >> 2) != (LPCWSTR)0x0) {
          do {
            lstrcpyW(local_774,L"Unknown");
            pvVar5 = OpenProcess(0x410,0,*(DWORD *)((int)local_8 + (int)param_1 * 4));
            if ((pvVar5 != (HANDLE)0x0) &&
               (iVar2 = (*local_c)(pvVar5,&local_20,4,&local_18), iVar2 != 0)) {
              (*local_10)(pvVar5,local_20,local_774,0x104);
            }
            CloseHandle(pvVar5);
            lpString1 = CharUpperW(local_774);
            iVar2 = lstrcmpW(lpString1,local_340);
            if (iVar2 == 0) {
              uVar6 = 1;
              hModule = local_14;
              goto LAB_00406634;
            }
            param_1 = (LPCWSTR)((int)param_1 + 1);
          } while (param_1 < (LPCWSTR)(local_18 >> 2));
        }
        goto LAB_004066e6;
      }
LAB_004067b2:
      FreeLibrary(hModule);
    }
LAB_004065d9:
    uVar6 = 0x25d;
  }
  else {
    if (local_138.dwPlatformId != 1) {
      return 0x25f;
    }
LAB_004066e6:
    GlobalFree(local_8);
    if (local_138.dwPlatformId == 1) {
      hModule = LoadLibraryA("Kernel32.DLL");
      if (hModule == (HMODULE)0x0) goto LAB_004065d9;
      local_14 = hModule;
      pFVar4 = GetProcAddress(hModule,"CreateToolhelp32Snapshot");
      local_c = GetProcAddress(hModule,"Process32FirstW");
      local_10 = GetProcAddress(hModule,"Process32NextW");
      local_1c = GetProcAddress(hModule,"Module32FirstW");
      local_24 = GetProcAddress(hModule,"Module32NextW");
      if (((local_10 == (FARPROC)0x0) || (local_c == (FARPROC)0x0)) ||
         ((local_24 == (FARPROC)0x0 ||
          (((local_1c == (FARPROC)0x0 || (pFVar4 == (FARPROC)0x0)) ||
           (local_8 = (HGLOBAL)(*pFVar4)(2,0), local_8 == (HGLOBAL)0xffffffff))))))
      goto LAB_004067b2;
      local_56c[0] = 0x22c;
      iVar2 = (*local_c)(local_8,local_56c);
      while (iVar2 != 0) {
        pvVar5 = (HANDLE)(*pFVar4)(8,local_564);
        if (pvVar5 == (HANDLE)0xffffffff) {
          uVar6 = 0x25d;
LAB_00406850:
          CloseHandle(local_8);
          FreeLibrary(hModule);
          return uVar6;
        }
        local_b9c[0] = 0x428;
        iVar2 = (*local_1c)(pvVar5,local_b9c);
        while (iVar2 != 0) {
          iVar2 = lstrcmpW(local_b7c,local_340);
          if (iVar2 == 0) {
            CloseHandle(pvVar5);
            uVar6 = 1;
            goto LAB_00406850;
          }
          local_b9c[0] = 0x428;
          iVar2 = (*local_24)(pvVar5,local_b9c);
        }
        CloseHandle(pvVar5);
        local_56c[0] = 0x22c;
        iVar2 = (*local_10)(local_8,local_56c);
      }
      CloseHandle(local_8);
    }
    FreeLibrary(local_14);
    uVar6 = 0;
  }
  return uVar6;
}



/* Function: FUN_00406883 */

LPCWSTR FUN_00406883(LPCWSTR param_1)

{
  int iVar1;
  LPWSTR pWVar2;
  
  iVar1 = lstrlenW(param_1);
  pWVar2 = CharPrevW(param_1,param_1 + iVar1);
  if (*pWVar2 != L'\\') {
    lstrcatW(param_1,L"\\");
  }
  return param_1;
}



/* Function: FUN_004068b2 */

LPCWSTR FUN_004068b2(LPCWSTR param_1)

{
  int iVar1;
  LPCWSTR lpszCurrent;
  
  iVar1 = lstrlenW(param_1);
  lpszCurrent = param_1 + iVar1;
  do {
    if (*lpszCurrent == L'\\') break;
    lpszCurrent = CharPrevW(param_1,lpszCurrent);
  } while (param_1 < lpszCurrent);
  *lpszCurrent = L'\0';
  return lpszCurrent + 1;
}



/* Function: FUN_004068df */

bool FUN_004068df(LPCWSTR param_1)

{
  LPWSTR pWVar1;
  byte *pbVar2;
  int iVar3;
  DWORD DVar4;
  bool bVar5;
  
  FUN_0040616a((LPWSTR)&DAT_004572d0,param_1);
  pWVar1 = FUN_00405eb9((LPCWSTR)&DAT_004572d0);
  if ((pWVar1 == (LPWSTR)0x0) ||
     ((FUN_00406199(pWVar1), ((byte)DAT_00472e28 & 0x80) != 0 &&
      ((*pWVar1 == L'\0' || (*pWVar1 == L'\\')))))) {
    bVar5 = false;
  }
  else {
    while (iVar3 = lstrlenW((LPCWSTR)&DAT_004572d0), (int)(pWVar1 + -0x22b968) >> 1 < iVar3) {
      pbVar2 = FUN_00406436((LPCWSTR)&DAT_004572d0);
      if ((pbVar2 != (byte *)0x0) && ((*pbVar2 & 0x10) == 0)) {
        return false;
      }
      FUN_004068b2((LPCWSTR)&DAT_004572d0);
    }
    FUN_00406883((LPCWSTR)&DAT_004572d0);
    DVar4 = GetFileAttributesW((LPCWSTR)&DAT_004572d0);
    bVar5 = DVar4 != 0xffffffff;
  }
  return bVar5;
}



/* Function: FUN_00406966 */

void FUN_00406966(LPWSTR param_1,int param_2)

{
  WCHAR *pWVar1;
  WCHAR WVar2;
  WCHAR WVar3;
  bool bVar4;
  LPWSTR pWVar5;
  uint uVar6;
  DWORD DVar7;
  int iVar8;
  HRESULT HVar9;
  BOOL BVar10;
  int iVar11;
  WCHAR *pWVar12;
  uint uVar13;
  uint uVar14;
  LPWSTR lpBuffer;
  uint local_1c [4];
  WCHAR *local_c;
  LPCITEMIDLIST local_8;
  
  pWVar5 = param_1;
  if (param_2 < 0) {
    param_2 = *(int *)(DAT_0046ada8 - (param_2 * 4 + 4));
  }
  pWVar1 = (WCHAR *)(DAT_00472df8 + param_2 * 2);
  lpBuffer = &DAT_00462540;
  if (((LPWSTR)0x46253f < param_1) && ((uint)((int)(param_1 + -0x2312a0) >> 1) < 0x4008)) {
    param_1 = (LPWSTR)0x0;
    lpBuffer = pWVar5;
  }
  WVar2 = *pWVar1;
  do {
    if ((WVar2 == L'\0') || (0x4007 < (int)((uint)(lpBuffer + -0x2312a0) & 0xfffffffe))) {
      *lpBuffer = L'\0';
      if (param_1 != (LPWSTR)0x0) {
        FUN_0040616a(param_1,&DAT_00462540);
      }
      return;
    }
    pWVar12 = pWVar1 + 1;
    if (((WVar2 & 0xe000U) == 0) || ((ushort)WVar2 < 0xe001)) {
      if (WVar2 == L'\xe000') {
        *lpBuffer = *pWVar12;
        lpBuffer = lpBuffer + 1;
        pWVar12 = pWVar1 + 2;
      }
      else {
        *lpBuffer = WVar2;
        lpBuffer = lpBuffer + 1;
      }
    }
    else {
      WVar3 = *pWVar12;
      uVar6 = (uint)(ushort)WVar3;
      local_1c[3] = (uint)((ushort)WVar3 >> 8);
      uVar13 = uVar6 & 0xff;
      local_1c[2] = local_1c[3] | 0x8000;
      local_1c[0] = uVar13 | 0x8000;
      local_c = pWVar1 + 2;
      uVar14 = uVar6 & 0x7fff;
      local_1c[1] = uVar13;
      if (WVar2 == L'\xe002') {
        iVar11 = 2;
        DVar7 = GetVersion();
        if (((((int)DVar7 < 0) && ((short)DVar7 != 0x5a04)) && (local_1c[3] != 0x23)) &&
           (local_1c[3] != 0x2e)) {
          bVar4 = false;
        }
        else {
          bVar4 = true;
        }
        if (DAT_00472e84 != 0) {
          iVar11 = 4;
        }
        if ((char)WVar3 < '\0') {
          FUN_00406034((HKEY)0x80000002,L"Software\\Microsoft\\Windows\\CurrentVersion",
                       (LPCWSTR)(DAT_00472df8 + (uVar6 & 0x3f) * 2),(LPBYTE)lpBuffer,
                       (HKEY)(uVar6 & 0x40));
          if (*lpBuffer == L'\0') {
            FUN_00406966(lpBuffer,local_1c[3]);
            goto LAB_00406b34;
          }
LAB_00406b3a:
          if (local_1c[3] == 0x1a) {
            lstrcatW(lpBuffer,L"\\Microsoft\\Internet Explorer\\Quick Launch");
          }
        }
        else {
          if (uVar13 == 0x25) {
            GetSystemDirectoryW(lpBuffer,0x2004);
          }
          else {
            if (uVar13 == 0x24) {
              GetWindowsDirectoryW(lpBuffer,0x2004);
              iVar11 = 0;
            }
            while ((iVar11 != 0 &&
                   (((iVar11 = iVar11 + -1, DAT_00472dd0 == (code *)0x0 || (!bVar4)) ||
                    (iVar8 = (*DAT_00472dd0)(DAT_00472dd4,local_1c[iVar11],0,0,lpBuffer), iVar8 != 0
                    ))))) {
              HVar9 = SHGetSpecialFolderLocation(DAT_00472dd4,local_1c[iVar11],&local_8);
              if (HVar9 == 0) {
                BVar10 = SHGetPathFromIDListW(local_8,lpBuffer);
                CoTaskMemFree(local_8);
                if (BVar10 != 0) break;
              }
              *lpBuffer = L'\0';
            }
          }
LAB_00406b34:
          if (*lpBuffer != L'\0') goto LAB_00406b3a;
        }
LAB_00406b88:
        FUN_00406199(lpBuffer);
      }
      else if (WVar2 == L'\xe001') {
        if (uVar14 == 0x1d) {
          FUN_004060b2(lpBuffer,DAT_00472dd4);
        }
        else {
          FUN_0040616a(lpBuffer,(LPCWSTR)(&DAT_00473000 + uVar14 * 0x4008));
        }
        if (uVar14 - 0x15 < 7) goto LAB_00406b88;
      }
      else if (WVar2 == L'\xe003') {
        FUN_00406966(lpBuffer,-1 - uVar14);
      }
      iVar11 = lstrlenW(lpBuffer);
      lpBuffer = lpBuffer + iVar11;
      pWVar12 = local_c;
    }
    WVar2 = *pWVar12;
    pWVar1 = pWVar12;
  } while( true );
}



/* Function: FUN_00406bfa */

void __cdecl FUN_00406bfa(LPCWSTR param_1,LPCWSTR param_2)

{
  HANDLE pvVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR nNumberOfBytesToRead;
  LPSTR lpBuffer;
  BOOL BVar4;
  LPCSTR pCVar5;
  LPCSTR pCVar6;
  LPSTR pCVar7;
  LPCSTR pCStack_4;
  
  lstrcpyW((LPWSTR)&DAT_0045b2d8,L"NUL");
  if (param_2 != (LPCWSTR)0x0) {
    pvVar1 = (HANDLE)FUN_00405fb0(param_2,0,1);
    CloseHandle(pvVar1);
    DVar2 = GetShortPathNameW(param_2,(LPWSTR)&DAT_0045b2d8,0x400);
    if (DVar2 == 0) {
      return;
    }
    if (0x400 < (int)DVar2) {
      return;
    }
  }
  DVar2 = GetShortPathNameW(param_1,(LPWSTR)&DAT_00460930,0x400);
  if ((((DVar2 != 0) && ((int)DVar2 < 0x401)) &&
      (iVar3 = WideCharToMultiByte(0,0,(LPCWSTR)&DAT_0045b2d8,-1,&DAT_0045bad8,0x400,(LPCSTR)0x0,
                                   (LPBOOL)0x0), iVar3 != 0)) &&
     (iVar3 = WideCharToMultiByte(0,0,(LPCWSTR)&DAT_00460930,-1,&DAT_0045c128,0x400,(LPCSTR)0x0,
                                  (LPBOOL)0x0), iVar3 != 0)) {
    iVar3 = wsprintfA(&DAT_0045c528,"%s=%s\r\n",&DAT_0045bad8,&DAT_0045c128);
    FUN_00406966((LPWSTR)&DAT_00460930,*(int *)(DAT_00472ddc + 0x128));
    pvVar1 = (HANDLE)FUN_00405fb0((LPCWSTR)&DAT_00460930,0xc0000000,4);
    if (pvVar1 != (HANDLE)0xffffffff) {
      nNumberOfBytesToRead = (LPCSTR)GetFileSize(pvVar1,(LPDWORD)0x0);
      lpBuffer = (LPSTR)GlobalAlloc(0x40,(SIZE_T)(nNumberOfBytesToRead + iVar3 + 10));
      if (((lpBuffer != (LPSTR)0x0) &&
          (BVar4 = ReadFile(pvVar1,lpBuffer,(DWORD)nNumberOfBytesToRead,(LPDWORD)&pCStack_4,
                            (LPOVERLAPPED)0x0), BVar4 != 0)) && (nNumberOfBytesToRead == pCStack_4))
      {
        pCVar5 = FUN_00405f16(lpBuffer,"[Rename]\r\n");
        if (pCVar5 == (LPCSTR)0x0) {
          lstrcpyA(lpBuffer + (int)nNumberOfBytesToRead,"[Rename]\r\n");
          nNumberOfBytesToRead = nNumberOfBytesToRead + 10;
          pCVar5 = nNumberOfBytesToRead;
        }
        else {
          pCVar6 = FUN_00405f16(pCVar5 + 10,"\n[");
          pCVar5 = nNumberOfBytesToRead;
          if (pCVar6 != (LPCSTR)0x0) {
            for (pCVar7 = lpBuffer + (int)nNumberOfBytesToRead; pCVar6 < pCVar7;
                pCVar7 = pCVar7 + -1) {
              pCVar7[iVar3] = *pCVar7;
            }
            pCVar5 = pCVar6 + (1 - (int)lpBuffer);
          }
        }
        FUN_00405f6c(lpBuffer + (int)pCVar5,0x45c528,iVar3);
        SetFilePointer(pvVar1,0,(PLONG)0x0,0);
        WriteFile(pvVar1,lpBuffer,(DWORD)(nNumberOfBytesToRead + iVar3),(LPDWORD)&pCStack_4,
                  (LPOVERLAPPED)0x0);
        GlobalFree(lpBuffer);
      }
      CloseHandle(pvVar1);
    }
  }
  return;
}



/* Function: FUN_00406dc9 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00406dc9(LPCWSTR param_1,LPCWSTR param_2)

{
  code *pcVar1;
  int iVar2;
  
  pcVar1 = (code *)FUN_0040645d(1);
  if (pcVar1 != (code *)0x0) {
    iVar2 = (*pcVar1)(param_1,param_2,5);
    if (iVar2 != 0) goto LAB_00406df3;
  }
  FUN_00406bfa(param_1,param_2);
LAB_00406df3:
  _DAT_00472e90 = _DAT_00472e90 + 1;
  return;
}



/* Function: FUN_00406dfc */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00406dfc(LPCWSTR param_1,uint param_2)

{
  bool bVar1;
  undefined3 extraout_var;
  BOOL BVar2;
  int iVar3;
  HANDLE hFindFile;
  short *psVar4;
  undefined *puVar5;
  uint uVar6;
  WCHAR *pWVar7;
  wchar_t *pwVar8;
  _WIN32_FIND_DATAW local_260;
  int local_10;
  LPCWSTR local_c;
  uint local_8;
  
  bVar1 = FUN_004068df(param_1);
  local_10 = CONCAT31(extraout_var,bVar1);
  if ((param_2 & 8) == 0) {
    uVar6 = param_2 & 1;
    local_8 = uVar6;
    if ((uVar6 == 0) || ((local_10 != 0 && ((param_2 & 2) != 0)))) {
      FUN_0040616a(&DAT_0045c928,param_1);
      if (uVar6 == 0) {
        FUN_004068b2(param_1);
      }
      else {
        lstrcatW(&DAT_0045c928,L"\\*.*");
      }
      if ((*param_1 != L'\0') || (DAT_0045c928 == 0x5c)) {
        lstrcatW(param_1,L"\\");
      }
      iVar3 = lstrlenW(param_1);
      local_c = param_1 + iVar3;
      hFindFile = FindFirstFileW(&DAT_0045c928,&local_260);
      if (hFindFile != (HANDLE)0xffffffff) {
        do {
          pWVar7 = local_260.cFileName;
          psVar4 = (short *)FUN_00405e66(pWVar7,L'?');
          if ((*psVar4 != 0) && (local_260.cAlternateFileName[0] != L'\0')) {
            pWVar7 = local_260.cAlternateFileName;
          }
          if ((*pWVar7 != L'.') ||
             ((pWVar7[1] != L'\0' && ((pWVar7[1] != L'.' || (pWVar7[2] != L'\0')))))) {
            FUN_0040616a(local_c,pWVar7);
            if (((byte)local_260.dwFileAttributes & 0x10) == 0) {
              FUN_00406404(L"Delete: DeleteFile(\"%s\")");
              FUN_00405f90(param_1);
              BVar2 = DeleteFileW(param_1);
              if (BVar2 == 0) {
                if ((param_2 & 4) == 0) {
                  FUN_00406404(L"Delete: DeleteFile failed(\"%s\")");
                  _DAT_00472e88 = _DAT_00472e88 + 1;
                }
                else {
                  FUN_00406404(L"Delete: DeleteFile on Reboot(\"%s\")");
                  FUN_004050d2(-0xf,param_1);
                  FUN_00406dc9(param_1,(LPCWSTR)0x0);
                }
              }
              else {
                FUN_004050d2(-0xe,param_1);
              }
            }
            else if (((byte)param_2 & 3) == 3) {
              FUN_00406dfc(param_1,param_2);
            }
          }
          BVar2 = FindNextFileW(hFindFile,&local_260);
        } while (BVar2 != 0);
        FindClose(hFindFile);
      }
      if (local_8 != 0) {
        local_c[-1] = L'\0';
      }
    }
    if (local_8 != 0) {
      if (local_10 == 0) {
        pwVar8 = L"RMDir: RemoveDirectory invalid input(\"%s\")";
      }
      else {
        puVar5 = FUN_00406436(param_1);
        if (puVar5 == (undefined *)0x0) {
          return;
        }
        FUN_00406883(param_1);
        FUN_00406404(L"RMDir: RemoveDirectory(\"%s\")");
        FUN_00405f90(param_1);
        BVar2 = RemoveDirectoryW(param_1);
        if (BVar2 != 0) {
          FUN_004050d2(-0x1b,param_1);
          return;
        }
        if ((param_2 & 4) != 0) {
          FUN_00406404(L"RMDir: RemoveDirectory on Reboot(\"%s\")");
          FUN_004050d2(-0xf,param_1);
          FUN_00406dc9(param_1,(LPCWSTR)0x0);
          return;
        }
        pwVar8 = L"RMDir: RemoveDirectory failed(\"%s\")";
      }
      FUN_00406404(pwVar8);
      _DAT_00472e88 = _DAT_00472e88 + 1;
    }
  }
  else {
    BVar2 = DeleteFileW(param_1);
    _DAT_00472e88 = _DAT_00472e88 + (uint)(BVar2 == 0);
  }
  return;
}



/* Function: FUN_00407033 */

undefined4 __cdecl FUN_00407033(LPCWSTR param_1,uint param_2,LPWSTR param_3,int param_4)

{
  LPCWSTR pWVar1;
  undefined1 uVar2;
  undefined1 uVar3;
  undefined1 uVar4;
  undefined1 uVar5;
  char cVar6;
  char cVar7;
  LPCWSTR hMem;
  short sVar8;
  ushort uVar9;
  int iVar10;
  ushort uVar11;
  ushort uVar12;
  int iVar13;
  ushort uVar14;
  uint uVar15;
  CHAR local_50 [8];
  uint local_48;
  uint local_44;
  ushort local_40 [2];
  undefined1 local_3c;
  undefined1 uStack_3b;
  undefined1 uStack_3a;
  undefined1 uStack_39;
  undefined1 uStack_38;
  undefined1 uStack_37;
  undefined1 uStack_36;
  undefined1 uStack_35;
  undefined1 local_30;
  undefined1 uStack_2f;
  undefined1 uStack_2e;
  undefined1 uStack_2d;
  char local_2c;
  char cStack_2b;
  undefined1 local_24 [2];
  undefined1 local_22;
  undefined1 uStack_21;
  undefined1 uStack_20;
  undefined1 uStack_1f;
  CHAR local_1c [4];
  undefined1 local_18;
  undefined4 local_14;
  DWORD local_10;
  HANDLE local_c;
  LPCWSTR local_8;
  
  iVar13 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = CreateFileW(param_1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (local_c == (HANDLE)0xffffffff) {
    FUN_00406404(L"%s: failed opening file \"%s\"\n");
  }
  else {
    ReadFile(local_c,&local_30,0xc,&local_10,(LPOVERLAPPED)0x0);
    cVar7 = cStack_2b;
    cVar6 = local_2c;
    local_2c = cStack_2b;
    cStack_2b = cVar6;
    if ((CONCAT11(local_30,uStack_2f) == 1) && (CONCAT11(uStack_2e,uStack_2d) == 0)) {
      local_8 = (LPCWSTR)0x0;
      if (cVar7 != '\0' || cVar6 != '\0') {
        do {
          ReadFile(local_c,local_50,0x10,&local_10,(LPOVERLAPPED)0x0);
          lstrcpynA(local_1c,local_50,5);
          local_18 = 0;
          iVar10 = lstrcmpA("name",local_1c);
          if (iVar10 == 0) {
            local_44 = ((local_44 & 0xff) << 8 | local_44 >> 8 & 0xff) << 0x10 |
                       (uint)(ushort)((short)(local_44 >> 0x10) << 8) | local_44 >> 0x18;
            local_48 = ((local_48 & 0xff) << 8 | local_48 >> 8 & 0xff) << 0x10 |
                       (uint)(ushort)((short)(local_48 >> 0x10) << 8) | local_48 >> 0x18;
            SetFilePointer(local_c,local_48,(PLONG)0x0,0);
            ReadFile(local_c,local_24,6,&local_10,(LPOVERLAPPED)0x0);
            uVar3 = uStack_20;
            uVar2 = uStack_21;
            sVar8 = CONCAT11(local_22,uStack_21);
            uStack_20 = uStack_1f;
            uStack_1f = uVar3;
            uStack_21 = local_22;
            local_8 = (LPCWSTR)0x0;
            local_22 = uVar2;
            if (sVar8 != 0) goto LAB_00407209;
            break;
          }
          local_8 = (LPCWSTR)((int)local_8 + 1);
        } while ((int)local_8 < (int)(uint)CONCAT11(cStack_2b,local_2c));
      }
LAB_00407344:
      CloseHandle(local_c);
    }
    else {
      local_14 = 0;
    }
  }
  return local_14;
LAB_00407209:
  ReadFile(local_c,local_40,0xc,&local_10,(LPOVERLAPPED)0x0);
  uVar5 = uStack_36;
  uVar2 = uStack_39;
  uVar9 = CONCAT11(uStack_3a,uStack_39);
  uVar11 = local_40._1_2_ & 0xff | (ushort)(byte)local_40[0] << 8;
  local_40[0] = uVar11;
  uStack_39 = uStack_3a;
  uVar3 = uStack_3b;
  sVar8 = CONCAT11(local_3c,uStack_3b);
  uStack_3b = local_3c;
  uVar4 = uStack_37;
  uVar14 = CONCAT11(uStack_38,uStack_37);
  uVar12 = CONCAT11(uStack_36,uStack_35);
  uStack_37 = uStack_38;
  uStack_36 = uStack_35;
  uStack_35 = uVar5;
  uStack_38 = uVar4;
  if (((uVar9 != param_2) || (uVar11 != 3)) || (sVar8 != 0x409)) goto LAB_004072ab;
  uVar15 = (uint)(uVar14 >> 1);
  SetFilePointer(local_c,(uint)CONCAT11(uStack_1f,uStack_20) + uVar12 + local_48,(PLONG)0x0,0);
  local_8 = (LPCWSTR)GlobalAlloc(0x40,CONCAT11(uStack_37,uStack_38) + 2);
  ReadFile(local_c,local_8,(uint)CONCAT11(uStack_37,uStack_38),&local_10,(LPOVERLAPPED)0x0);
  hMem = local_8;
  if (uVar15 != 0) {
    do {
      pWVar1 = local_8 + iVar13;
      iVar13 = iVar13 + 1;
      *pWVar1 = CONCAT11((char)*pWVar1,*(undefined1 *)((int)pWVar1 + 1));
    } while (iVar13 < (int)uVar15);
  }
  local_8[uVar15] = L'\0';
  lstrcpynW(param_3,local_8,param_4);
  local_14 = 1;
  GlobalFree(hMem);
  goto LAB_00407344;
LAB_004072ab:
  local_8 = (LPCWSTR)((int)local_8 + 1);
  local_3c = uVar3;
  uStack_3a = uVar2;
  if ((int)(uint)CONCAT11(uStack_21,local_22) <= (int)local_8) goto LAB_00407344;
  goto LAB_00407209;
}



/* Function: FUN_00407359 */

int __cdecl FUN_00407359(LPCWSTR param_1,LPWSTR param_2,int param_3)

{
  int iVar1;
  int iVar2;
  LPCWSTR lpString2;
  WCHAR local_118 [8];
  WCHAR local_108 [120];
  WCHAR local_18 [8];
  undefined2 local_8;
  
  iVar1 = FUN_00407033(param_1,5,local_118,0x80);
  if (iVar1 == 1) {
    lpString2 = local_118;
    lstrcpynW(local_18,lpString2,9);
    local_8 = 0;
    iVar2 = lstrcmpW(local_18,L"Version ");
    if (iVar2 == 0) {
      lpString2 = local_108;
    }
    lstrcpynW(param_2,lpString2,param_3);
  }
  return iVar1;
}



/* Function: FUN_004073cb */

void __cdecl FUN_004073cb(LPCWSTR param_1,LPWSTR param_2,int param_3)

{
  FUN_00407033(param_1,4,param_2,param_3);
  return;
}



/* Function: FUN_004073e2 */

uint FUN_004073e2(uint param_1,byte *param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  
  if (DAT_00461134 == 0) {
    uVar2 = 0;
    do {
      iVar3 = 8;
      uVar1 = uVar2;
      do {
        uVar1 = uVar1 >> 1 ^ -(uint)((uVar1 & 1) != 0) & 0xedb88320;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
      (&DAT_00461130)[uVar2] = uVar1;
      uVar2 = uVar2 + 1;
    } while ((int)uVar2 < 0x100);
  }
  uVar2 = ~param_1;
  if (param_3 != 0) {
    do {
      param_3 = param_3 + -1;
      uVar2 = uVar2 >> 8 ^ (&DAT_00461130)[(*param_2 ^ uVar2) & 0xff];
      param_2 = param_2 + 1;
    } while (param_3 != 0);
  }
  return ~uVar2;
}



/* Function: FUN_00407453 */

void __fastcall FUN_00407453(int param_1)

{
  int iVar1;
  
  iVar1 = 0x80;
  do {
    iVar1 = iVar1 + -1;
    *(undefined1 *)(iVar1 + param_1) = 0;
  } while (iVar1 != 0);
  *(undefined4 *)(param_1 + 0x78) = 0xffffffff;
  *(undefined4 *)(param_1 + 0x68) = 1;
  *(undefined4 *)(param_1 + 100) = 1;
  *(undefined4 *)(param_1 + 0x60) = 1;
  *(undefined4 *)(param_1 + 0x5c) = 1;
  return;
}



/* Function: FUN_00407473 */

undefined4 __fastcall FUN_00407473(SIZE_T *param_1)

{
  byte bVar1;
  ushort uVar2;
  ulonglong uVar3;
  SIZE_T dwBytes;
  byte *pbVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  HGLOBAL pvVar8;
  uint uVar9;
  ushort *puVar10;
  SIZE_T *pSVar11;
  SIZE_T *pSVar12;
  bool bVar13;
  SIZE_T local_8c [5];
  uint local_78;
  byte *local_74;
  int local_70;
  byte *local_6c;
  int local_68;
  uint local_64;
  byte local_60;
  byte local_5f;
  ushort *local_5c;
  ushort *local_58;
  int local_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  undefined4 local_40;
  int local_3c;
  int local_38;
  int local_34;
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  uint local_10;
  HGLOBAL local_c;
  HGLOBAL local_8;
  
  pSVar11 = param_1;
  pSVar12 = local_8c;
  for (iVar7 = 0x22; iVar7 != 0; iVar7 = iVar7 + -1) {
    *pSVar12 = *pSVar11;
    pSVar11 = pSVar11 + 1;
    pSVar12 = pSVar12 + 1;
  }
  pvVar8 = local_8;
  uVar9 = local_48;
  puVar10 = local_58;
  if (local_34 == -1) {
    return 1;
  }
LAB_004074a5:
  do {
    uVar6 = local_24;
    pbVar4 = local_6c;
    switch(local_8c[0]) {
    case 0:
      if (local_70 == 0) goto LAB_00407e3e;
      local_70 = local_70 + -1;
      bVar1 = *local_74;
      local_74 = local_74 + 1;
      if (0xe1 < bVar1) {
        return 0xffffffff;
      }
      uVar3 = (ulonglong)((uint)bVar1 % 0x2d) % 9;
      local_40 = (int)uVar3;
      local_20 = (1 << bVar1 / 0x2d) - 1;
      local_1c = (1 << (sbyte)((ulonglong)((uint)bVar1 % 0x2d) / 9)) - 1;
      iVar7 = (0x300 << (char)uVar3 + bVar1 / 0x2d) + 0x736;
      dwBytes = iVar7 * 2;
      if (dwBytes != local_8c[4]) {
        if (local_8 != (HGLOBAL)0x0) {
          GlobalFree(local_8);
        }
        local_8 = GlobalAlloc(0x40,dwBytes);
        if (local_8 == (HGLOBAL)0x0) {
          return 0xffffffff;
        }
        local_8c[4] = dwBytes;
      }
      while (iVar7 != 0) {
        iVar7 = iVar7 + -1;
        *(undefined2 *)((int)local_8 + iVar7 * 2) = 0x400;
      }
      local_44 = 0;
      for (local_4c = 0; (int)local_4c < 4; local_4c = local_4c + 1) {
switchD_004074b1_caseD_1:
        if (local_70 == 0) {
          local_8c[0] = 1;
          goto LAB_00407e3e;
        }
        local_70 = local_70 + -1;
        local_44 = local_44 | (uint)*local_74 << ((byte)(local_4c << 3) & 0x1f);
        local_74 = local_74 + 1;
      }
      if (local_44 != local_78) {
        local_78 = local_44;
        if (local_c != (HGLOBAL)0x0) {
          GlobalFree(local_c);
        }
        local_c = GlobalAlloc(0x40,local_44);
        if (local_c == (HGLOBAL)0x0) {
          return 0xffffffff;
        }
      }
      *(undefined1 *)((int)local_c + (local_78 - 1)) = 0;
      local_4c = 5;
      while (uVar6 = local_4c, local_4c = local_4c - 1, pvVar8 = local_8, uVar6 != 0) {
switchD_004074b1_caseD_3:
        if (local_70 == 0) {
          local_8c[0] = 3;
          goto LAB_00407e3e;
        }
        bVar1 = *local_74;
        local_70 = local_70 + -1;
        local_74 = local_74 + 1;
        local_10 = local_10 << 8 | (uint)bVar1;
      }
    case 2:
      local_50 = local_64 & local_20;
      puVar10 = (ushort *)((int)pvVar8 + (local_3c * 0x10 + (local_64 & local_20)) * 2);
      local_8c[1] = 6;
      break;
    case 1:
      goto switchD_004074b1_caseD_1;
    case 3:
      goto switchD_004074b1_caseD_3;
    case 4:
      goto switchD_004074b1_caseD_4;
    case 5:
      goto switchD_004074b1_caseD_5;
    case 6:
      if (local_44 != 0) {
        local_38 = 1;
        puVar10 = (ushort *)((int)pvVar8 + local_3c * 2 + 0x180);
        local_8c[1] = 7;
        break;
      }
      local_5c = (ushort *)
                 (((uint)(local_60 >> (8 - (byte)local_40 & 0x1f)) +
                  ((local_64 & local_1c) << ((byte)local_40 & 0x1f))) * 0x600 + 0xe6c + (int)pvVar8)
      ;
      if (local_3c < 4) {
        local_3c = 0;
      }
      else if (local_3c < 10) {
        local_3c = local_3c + -3;
      }
      else {
        local_3c = local_3c + -6;
      }
      if (local_38 != 0) {
        uVar9 = local_18 - local_30;
        if (local_78 <= uVar9) {
          uVar9 = uVar9 + local_78;
        }
        local_5f = *(byte *)(uVar9 + (int)local_c);
        uVar9 = 1;
        do {
          bVar1 = local_5f;
          local_5f = local_5f << 1;
          local_4c = (uint)(bVar1 >> 7);
          puVar10 = local_5c + ((bVar1 >> 7) + 1) * 0x100 + uVar9;
          uVar2 = *puVar10;
          uVar6 = (local_14 >> 0xb) * (uint)uVar2;
          local_58 = puVar10;
          bVar13 = uVar6 <= local_10;
          if (bVar13) {
            local_14 = local_14 - uVar6;
            local_10 = local_10 - uVar6;
            local_44 = 1;
            *puVar10 = uVar2 - (uVar2 >> 5);
            uVar9 = uVar9 * 2 + 1;
          }
          else {
            local_44 = 0;
            local_14 = uVar6;
            *puVar10 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
            uVar9 = uVar9 * 2;
          }
          local_44 = (uint)bVar13;
          local_48 = uVar9;
          if (local_14 < 0x1000000) {
switchD_004074b1_caseD_d:
            if (local_70 == 0) {
              local_8c[0] = 0xd;
              goto LAB_00407e3e;
            }
            bVar1 = *local_74;
            local_14 = local_14 << 8;
            local_70 = local_70 + -1;
            local_74 = local_74 + 1;
            local_10 = local_10 << 8 | (uint)bVar1;
          }
          if (local_4c != local_44) goto LAB_0040778b;
        } while ((int)uVar9 < 0x100);
        goto LAB_004077ef;
      }
      uVar9 = 1;
      do {
        puVar10 = local_5c + uVar9;
        uVar2 = *puVar10;
        uVar6 = (local_14 >> 0xb) * (uint)uVar2;
        local_58 = puVar10;
        if (local_10 < uVar6) {
          local_14 = uVar6;
          *puVar10 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
          uVar9 = uVar9 * 2;
        }
        else {
          local_14 = local_14 - uVar6;
          local_10 = local_10 - uVar6;
          *puVar10 = uVar2 - (uVar2 >> 5);
          uVar9 = uVar9 * 2 + 1;
        }
        local_48 = uVar9;
        if (local_14 < 0x1000000) {
switchD_004074b1_caseD_f:
          if (local_70 == 0) {
            local_8c[0] = 0xf;
            goto LAB_00407e3e;
          }
          bVar1 = *local_74;
          local_14 = local_14 << 8;
          local_70 = local_70 + -1;
          local_74 = local_74 + 1;
          local_10 = local_10 << 8 | (uint)bVar1;
        }
      } while ((int)uVar9 < 0x100);
      goto LAB_004077f3;
    case 7:
      if (local_44 != 1) {
        local_24 = local_28;
        local_28 = local_2c;
        local_2c = local_30;
        local_8c[2] = 0x16;
        local_3c = ((6 < local_3c) - 1 & 0xfffffffd) + 10;
        local_5c = (ushort *)((int)pvVar8 + 0x664);
        goto switchD_004074b1_caseD_11;
      }
      puVar10 = (ushort *)((int)pvVar8 + local_3c * 2 + 0x198);
      local_8c[1] = 8;
      break;
    case 8:
      if (local_44 == 0) {
        local_8c[1] = 9;
        puVar10 = (ushort *)((int)pvVar8 + ((local_3c + 0xf) * 0x10 + local_50) * 2);
      }
      else {
        puVar10 = (ushort *)((int)pvVar8 + local_3c * 2 + 0x1b0);
        local_8c[1] = 10;
      }
      break;
    case 9:
      if (local_44 != 0) goto LAB_004079f9;
      if (local_64 == 0) {
        return 0xffffffff;
      }
      local_3c = (uint)(6 < local_3c) * 2 + 9;
    case 0x1b:
      if (local_68 == 0) {
        local_8c[0] = 0x1b;
        goto LAB_00407e3e;
      }
      uVar6 = local_18 - local_30;
      if (local_78 <= uVar6) {
        uVar6 = uVar6 + local_78;
      }
      local_60 = *(byte *)(uVar6 + (int)local_c);
      *(byte *)(local_18 + (int)local_c) = local_60;
      local_64 = local_64 + 1;
      local_6c = local_6c + 1;
      local_68 = local_68 + -1;
      *pbVar4 = local_60;
      goto LAB_004079a6;
    case 10:
      uVar5 = local_2c;
      if (local_44 == 0) goto LAB_004079f0;
      puVar10 = (ushort *)((int)pvVar8 + local_3c * 2 + 0x1c8);
      local_8c[1] = 0xb;
      break;
    case 0xb:
      uVar5 = local_28;
      if (local_44 != 0) {
        local_24 = local_28;
        uVar5 = uVar6;
      }
      local_28 = local_2c;
LAB_004079f0:
      local_2c = local_30;
      local_30 = uVar5;
LAB_004079f9:
      local_5c = (ushort *)((int)pvVar8 + 0xa68);
      local_8c[2] = 0x15;
    case 0x11:
switchD_004074b1_caseD_11:
      local_8c[1] = 0x12;
      puVar10 = local_5c;
      break;
    case 0xc:
      while (local_70 != 0) {
        bVar1 = *local_74;
        local_14 = local_14 << 8;
        local_70 = local_70 + -1;
        local_74 = local_74 + 1;
        local_10 = local_10 << 8 | (uint)bVar1;
        do {
          local_4c = local_4c - 1;
LAB_00407abe:
          if ((int)local_4c < 1) {
            local_30 = local_30 + uVar9 * 0x10;
            local_5c = (ushort *)((int)pvVar8 + 0x644);
            local_44 = 4;
            goto LAB_00407b03;
          }
          local_14 = local_14 >> 1;
          uVar9 = uVar9 * 2;
          local_48 = uVar9;
          if (local_14 <= local_10) {
            uVar9 = uVar9 | 1;
            local_10 = local_10 - local_14;
            local_48 = uVar9;
          }
        } while (0xffffff < local_14);
      }
      local_8c[0] = 0xc;
      goto LAB_00407e3e;
    case 0xd:
      goto switchD_004074b1_caseD_d;
    case 0xe:
      goto switchD_004074b1_caseD_e;
    case 0xf:
      goto switchD_004074b1_caseD_f;
    case 0x10:
      goto switchD_004074b1_caseD_10;
    case 0x12:
      if (local_44 == 0) {
        local_34 = 0;
        iVar7 = local_50 * 8 + 2;
LAB_00407ce6:
        local_5c = local_5c + iVar7;
        local_44 = 3;
        goto LAB_00407d07;
      }
      local_8c[1] = 0x13;
      puVar10 = local_5c + 1;
      break;
    case 0x13:
      if (local_44 == 0) {
        local_34 = 8;
        iVar7 = local_50 * 8 + 0x82;
        goto LAB_00407ce6;
      }
      local_5c = local_5c + 0x102;
      local_34 = 0x10;
      local_44 = 8;
LAB_00407d07:
      local_8c[3] = 0x14;
    case 0x17:
switchD_004074b1_caseD_17:
      local_54 = 1;
      for (local_4c = local_44; 0 < (int)local_4c; local_4c = local_4c - 1) {
        puVar10 = local_5c + local_54;
        uVar2 = *puVar10;
        uVar9 = (local_14 >> 0xb) * (uint)uVar2;
        local_58 = puVar10;
        if (local_10 < uVar9) {
          local_14 = uVar9;
          local_54 = local_54 << 1;
          *puVar10 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
        }
        else {
          local_14 = local_14 - uVar9;
          local_10 = local_10 - uVar9;
          *puVar10 = uVar2 - (uVar2 >> 5);
          local_54 = local_54 * 2 + 1;
        }
        if (local_14 < 0x1000000) {
switchD_004074b1_caseD_18:
          if (local_70 == 0) {
            local_8c[0] = 0x18;
            goto LAB_00407e3e;
          }
          bVar1 = *local_74;
          local_14 = local_14 << 8;
          local_70 = local_70 + -1;
          local_74 = local_74 + 1;
          local_10 = local_10 << 8 | (uint)bVar1;
        }
        pvVar8 = local_8;
      }
      uVar9 = local_54 - (1 << ((byte)local_44 & 0x1f));
      local_48 = uVar9;
      local_8c[0] = local_8c[3];
      goto LAB_00407dc6;
    case 0x14:
      local_34 = local_34 + uVar9;
      local_8c[0] = local_8c[2];
      goto LAB_00407dc6;
    case 0x15:
      local_3c = ((6 < local_3c) - 1 & 0xfffffffd) + 0xb;
      goto LAB_00407bbd;
    case 0x16:
      iVar7 = local_34;
      if (3 < local_34) {
        iVar7 = 3;
      }
      local_5c = (ushort *)(iVar7 * 0x80 + 0x360 + (int)pvVar8);
      local_44 = 6;
      local_8c[3] = 0x19;
      goto switchD_004074b1_caseD_17;
    case 0x18:
      goto switchD_004074b1_caseD_18;
    case 0x19:
      local_30 = uVar9;
      if (3 < (int)uVar9) {
        iVar7 = (int)uVar9 >> 1;
        local_44 = iVar7 - 1;
        local_30 = (uVar9 & 1 | 2) << ((byte)local_44 & 0x1f);
        if (0xd < (int)uVar9) {
          uVar9 = 0;
          local_4c = iVar7 - 5;
          goto LAB_00407abe;
        }
        local_5c = (ushort *)((int)pvVar8 + (local_30 - uVar9) * 2 + 0x55e);
LAB_00407b03:
        uVar9 = 0;
        local_54 = 1;
        local_48 = 0;
        for (local_4c = 0; (int)local_4c < (int)local_44; local_4c = local_4c + 1) {
          puVar10 = local_5c + local_54;
          uVar2 = *puVar10;
          uVar6 = (local_14 >> 0xb) * (uint)uVar2;
          local_58 = puVar10;
          if (local_10 < uVar6) {
            local_14 = uVar6;
            local_54 = local_54 << 1;
            *puVar10 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
          }
          else {
            local_14 = local_14 - uVar6;
            local_10 = local_10 - uVar6;
            uVar9 = local_48 | 1 << ((byte)local_4c & 0x1f);
            local_48 = uVar9;
            *puVar10 = uVar2 - (uVar2 >> 5);
            local_54 = local_54 * 2 + 1;
          }
          if (local_14 < 0x1000000) {
switchD_004074b1_caseD_10:
            if (local_70 == 0) {
              local_8c[0] = 0x10;
              goto LAB_00407e3e;
            }
            bVar1 = *local_74;
            local_14 = local_14 << 8;
            local_70 = local_70 + -1;
            local_74 = local_74 + 1;
            local_10 = local_10 << 8 | (uint)bVar1;
          }
        }
        local_30 = local_30 + uVar9;
      }
      local_30 = local_30 + 1;
LAB_00407bbd:
      if (local_30 == 0) {
        local_34 = 0xffffffff;
        goto LAB_00407e3e;
      }
      if (local_64 < local_30) {
        return 0xffffffff;
      }
      local_34 = local_34 + 2;
      local_64 = local_64 + local_34;
switchD_004074b1_caseD_1c:
      do {
        pbVar4 = local_6c;
        if (local_68 == 0) {
          local_8c[0] = 0x1c;
          goto LAB_00407e3e;
        }
        uVar6 = local_18 - local_30;
        if (local_78 <= uVar6) {
          uVar6 = uVar6 + local_78;
        }
        local_60 = *(byte *)(uVar6 + (int)local_c);
        *(byte *)(local_18 + (int)local_c) = local_60;
        local_6c = local_6c + 1;
        local_68 = local_68 + -1;
        local_34 = local_34 + -1;
        *pbVar4 = local_60;
        local_18 = (local_18 + 1) % local_78;
      } while (0 < local_34);
      goto LAB_004079a9;
    case 0x1a:
      goto switchD_004074b1_caseD_1a;
    case 0x1c:
      goto switchD_004074b1_caseD_1c;
    default:
      return 0xffffffff;
    }
    local_58 = puVar10;
switchD_004074b1_caseD_4:
    uVar2 = *puVar10;
    uVar6 = (local_14 >> 0xb) * (uint)uVar2;
    bVar13 = uVar6 <= local_10;
    if (bVar13) {
      local_14 = local_14 - uVar6;
      local_10 = local_10 - uVar6;
      *puVar10 = uVar2 - (uVar2 >> 5);
      local_44 = 1;
    }
    else {
      local_14 = uVar6;
      local_44 = 0;
      *puVar10 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
    }
    local_44 = (uint)bVar13;
    local_8c[0] = local_8c[1];
    if (local_14 < 0x1000000) {
switchD_004074b1_caseD_5:
      if (local_70 == 0) {
        local_8c[0] = 5;
        goto LAB_00407e3e;
      }
      bVar1 = *local_74;
      local_14 = local_14 << 8;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      local_10 = local_10 << 8 | (uint)bVar1;
      local_8c[0] = local_8c[1];
    }
LAB_00407dc6:
  } while( true );
LAB_0040778b:
  if ((int)uVar9 < 0x100) {
    puVar10 = local_5c + uVar9;
    uVar2 = *puVar10;
    uVar6 = (local_14 >> 0xb) * (uint)uVar2;
    local_58 = puVar10;
    if (local_10 < uVar6) {
      local_14 = uVar6;
      *puVar10 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
      uVar9 = uVar9 * 2;
    }
    else {
      local_14 = local_14 - uVar6;
      local_10 = local_10 - uVar6;
      *puVar10 = uVar2 - (uVar2 >> 5);
      uVar9 = uVar9 * 2 + 1;
    }
    local_48 = uVar9;
    if (local_14 < 0x1000000) {
switchD_004074b1_caseD_e:
      if (local_70 == 0) {
        local_8c[0] = 0xe;
        goto LAB_00407e3e;
      }
      bVar1 = *local_74;
      local_14 = local_14 << 8;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      local_10 = local_10 << 8 | (uint)bVar1;
    }
    goto LAB_0040778b;
  }
LAB_004077ef:
  local_38 = 0;
LAB_004077f3:
  local_60 = (byte)local_48;
switchD_004074b1_caseD_1a:
  if (local_68 == 0) {
    local_8c[0] = 0x1a;
LAB_00407e3e:
    pSVar11 = local_8c;
    for (iVar7 = 0x22; iVar7 != 0; iVar7 = iVar7 + -1) {
      *param_1 = *pSVar11;
      pSVar11 = pSVar11 + 1;
      param_1 = param_1 + 1;
    }
    return 0;
  }
  local_64 = local_64 + 1;
  local_6c = local_6c + 1;
  local_68 = local_68 + -1;
  *pbVar4 = local_60;
  *(byte *)(local_18 + (int)local_c) = local_60;
LAB_004079a6:
  local_18 = (local_18 + 1) % local_78;
LAB_004079a9:
  local_8c[0] = 2;
  pvVar8 = local_8;
  goto LAB_004074a5;
}



/* Function: FUN_00407ecf */

int * __cdecl FUN_00407ecf(int *param_1,byte param_2,uint param_3)

{
  uint uVar1;
  int *piVar2;
  
  if (param_3 != 0) {
    piVar2 = param_1;
    for (uVar1 = param_3 >> 2; uVar1 != 0; uVar1 = uVar1 - 1) {
      *piVar2 = (uint)param_2 * 0x1010101;
      piVar2 = piVar2 + 1;
    }
    for (uVar1 = param_3 & 3; uVar1 != 0; uVar1 = uVar1 - 1) {
      *(char *)piVar2 = (char)((uint)param_2 * 0x1010101);
      piVar2 = (int *)((int)piVar2 + 1);
    }
  }
  return param_1;
}



/* Function: VerQueryValueW */

BOOL VerQueryValueW(LPCVOID pBlock,LPCWSTR lpSubBlock,LPVOID *lplpBuffer,PUINT puLen)

{
  BOOL BVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00407efe. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  BVar1 = VerQueryValueW(pBlock,lpSubBlock,lplpBuffer,puLen);
  return BVar1;
}



/* Function: GetFileVersionInfoW */

BOOL GetFileVersionInfoW(LPCWSTR lptstrFilename,DWORD dwHandle,DWORD dwLen,LPVOID lpData)

{
  BOOL BVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00407f04. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  BVar1 = GetFileVersionInfoW(lptstrFilename,dwHandle,dwLen,lpData);
  return BVar1;
}



/* Function: GetFileVersionInfoSizeW */

DWORD GetFileVersionInfoSizeW(LPCWSTR lptstrFilename,LPDWORD lpdwHandle)

{
  DWORD DVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00407f0a. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  DVar1 = GetFileVersionInfoSizeW(lptstrFilename,lpdwHandle);
  return DVar1;
}



