/* Function: FUN_00401740 */

int __fastcall FUN_00401740(char *param_1,uint param_2,int param_3)

{
  int iVar1;
  
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
    if (param_2 != 0) {
      *param_1 = '\0';
    }
  }
  else {
    iVar1 = FUN_00401846(param_1,param_2,param_1,param_3);
  }
  return iVar1;
}



/* Function: FUN_00401773 */

int __fastcall FUN_00401773(char *param_1,uint param_2,int param_3)

{
  char *pcVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  
  if ((param_2 == 0) || (pcVar1 = param_1, uVar3 = param_2, 0x7fffffff < param_2)) {
    iVar2 = -0x7ff8ffa9;
  }
  else {
    do {
      if (*pcVar1 == '\0') break;
      uVar3 = uVar3 - 1;
      pcVar1 = pcVar1 + 1;
    } while (uVar3 != 0);
    iVar2 = (-(uint)(uVar3 != 0) & 0x7ff8ffa9) + 0x80070057;
    uVar4 = -(uint)(uVar3 != 0) & param_2 - uVar3;
    if (uVar3 != 0) {
      iVar2 = FUN_00401846(param_1 + uVar4,param_2 - uVar4,iVar2,param_3);
    }
  }
  return iVar2;
}



/* Function: FUN_004017e1 */

undefined4 __cdecl FUN_004017e1(char *param_1,uint param_2,char *param_3)

{
  uint _Count;
  uint uVar1;
  undefined4 uVar2;
  
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    uVar2 = 0x80070057;
    if (param_2 != 0) {
      *param_1 = '\0';
    }
  }
  else {
    _Count = param_2 - 1;
    uVar2 = 0;
    uVar1 = _vsnprintf(param_1,_Count,param_3,&stack0x00000010);
    if (((int)uVar1 < 0) || (_Count < uVar1)) {
      param_1[_Count] = '\0';
      uVar2 = 0x8007007a;
    }
    else if (uVar1 == _Count) {
      param_1[_Count] = '\0';
    }
  }
  return uVar2;
}



/* Function: FUN_00401846 */

int __fastcall FUN_00401846(char *param_1,int param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  int iVar2;
  
  if (param_2 != 0) {
    iVar2 = 0x7ffffffe;
    iVar1 = param_4 - (int)param_1;
    do {
      if (iVar2 == 0) goto LAB_00401874;
      if (param_1[iVar1] == '\0') break;
      *param_1 = param_1[iVar1];
      param_1 = param_1 + 1;
      iVar2 = iVar2 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_00401874;
  }
  param_1 = param_1 + -1;
LAB_00401874:
  *param_1 = '\0';
  return (-(uint)(param_2 != 0) & 0x7ff8ff86) + 0x8007007a;
}



/* Function: FUN_00401893 */

int __thiscall FUN_00401893(void *this,uint param_1)

{
  int iVar1;
  
  if ((param_1 < this) || (0x400 < param_1 - (int)this)) {
    iVar1 = 0;
  }
  else {
    iVar1 = (int)this + (0x400 - param_1);
  }
  return iVar1;
}



/* Function: FUN_004018bf */

/* WARNING: Removing unreachable block (ram,0x0040194a) */

void __fastcall FUN_004018bf(undefined4 *param_1)

{
  HMODULE hModule;
  BOOL BVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  PSID local_18;
  FARPROC local_14;
  _SID_IDENTIFIER_AUTHORITY local_10;
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  local_10.Value[4] = '\0';
  local_10.Value[5] = '\x05';
  local_10.Value[0] = '\0';
  local_10.Value[1] = '\0';
  local_10.Value[2] = '\0';
  local_10.Value[3] = '\0';
  hModule = LoadLibraryA("advapi32.dll");
  uVar2 = extraout_EDX;
  if (hModule != (HMODULE)0x0) {
    local_14 = GetProcAddress(hModule,"CheckTokenMembership");
    if (local_14 != (FARPROC)0x0) {
      *param_1 = 0;
      BVar1 = AllocateAndInitializeSid(&local_10,'\x02',0x20,0x220,0,0,0,0,0,0,&local_18);
      if (BVar1 != 0) {
        (*(code *)PTR_guard_check_icall_0040a288)(0,local_18,param_1);
        (*local_14)();
        FreeSid(local_18);
      }
    }
    FreeLibrary(hModule);
    uVar2 = extraout_EDX_00;
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



/* Function: FUN_00401978 */

void __fastcall FUN_00401978(undefined4 param_1,undefined4 param_2)

{
  HANDLE ProcessHandle;
  BOOL BVar1;
  uint *TokenInformation;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  uint uVar2;
  uint *puVar3;
  undefined8 uVar4;
  DWORD DVar5;
  HANDLE *TokenHandle;
  PSID local_20;
  HANDLE local_1c;
  SIZE_T local_18;
  int local_14;
  _SID_IDENTIFIER_AUTHORITY local_10;
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  uVar2 = 0;
  local_10.Value[4] = '\0';
  local_10.Value[5] = '\x05';
  local_10.Value[0] = '\0';
  local_10.Value[1] = '\0';
  local_10.Value[2] = '\0';
  local_10.Value[3] = '\0';
  local_14 = 0;
  if (DAT_00408128 == 2) {
    uVar4 = FUN_004018bf(&local_14);
    param_2 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if ((int)uVar4 == 0) {
      TokenHandle = &local_1c;
      DVar5 = 8;
      ProcessHandle = GetCurrentProcess();
      BVar1 = OpenProcessToken(ProcessHandle,DVar5,TokenHandle);
      param_2 = extraout_EDX;
      if (BVar1 != 0) {
        BVar1 = GetTokenInformation(local_1c,TokenGroups,(LPVOID)0x0,0,&local_18);
        if (((BVar1 == 0) && (DVar5 = GetLastError(), DVar5 == 0x7a)) &&
           (TokenInformation = (uint *)LocalAlloc(0,local_18), TokenInformation != (uint *)0x0)) {
          BVar1 = GetTokenInformation(local_1c,TokenGroups,TokenInformation,local_18,&local_18);
          if ((BVar1 != 0) &&
             (BVar1 = AllocateAndInitializeSid(&local_10,'\x02',0x20,0x220,0,0,0,0,0,0,&local_20),
             BVar1 != 0)) {
            if (*TokenInformation != 0) {
              puVar3 = TokenInformation + 1;
              do {
                BVar1 = EqualSid((PSID)*puVar3,local_20);
                if (BVar1 != 0) {
                  DAT_00408128 = 1;
                  local_14 = 1;
                  break;
                }
                uVar2 = uVar2 + 1;
                puVar3 = puVar3 + 2;
              } while (uVar2 < *TokenInformation);
            }
            FreeSid(local_20);
          }
          LocalFree(TokenInformation);
        }
        CloseHandle(local_1c);
        param_2 = extraout_EDX_00;
      }
    }
    else if (local_14 != 0) {
      DAT_00408128 = 1;
    }
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_00401ac0 */

void __fastcall
FUN_00401ac0(undefined4 param_1,undefined4 param_2,HWND param_3,int param_4,int param_5,UINT param_6
            )

{
  HWND pHVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  CHAR local_208 [512];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  if (param_4 == 0x110) {
    pHVar1 = GetDesktopWindow();
    FUN_004045da(param_3,pHVar1);
    local_208[0] = '\0';
    LoadStringA(DAT_00409a3c,param_6,local_208,0x200);
    SetDlgItemTextA(param_3,0x83f,local_208);
    MessageBeep(0xffffffff);
    param_2 = extraout_EDX_00;
  }
  else if ((param_4 == 0x111) && ((param_5 == 0x83d || (param_5 == 0x83e)))) {
    EndDialog(param_3,param_5);
    param_2 = extraout_EDX;
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_00401b6b */

char * __fastcall FUN_00401b6b(undefined4 *param_1,short *param_2)

{
  char cVar1;
  short *psVar2;
  char *pcVar3;
  int iVar4;
  
  iVar4 = 0;
  pcVar3 = (char *)*param_1;
  while( true ) {
    psVar2 = FUN_00406940(param_2,(short)*pcVar3);
    if (psVar2 == (short *)0x0) {
      cVar1 = *pcVar3;
      *param_1 = pcVar3;
      while ((psVar2 = FUN_00406940(param_2,(short)cVar1), psVar2 == (short *)0x0 &&
             (pcVar3[iVar4] != '\0'))) {
        iVar4 = iVar4 + 1;
        cVar1 = pcVar3[iVar4];
      }
      pcVar3 = pcVar3 + iVar4;
      if (*pcVar3 != '\0') {
        *pcVar3 = '\0';
        pcVar3 = pcVar3 + 1;
      }
      return pcVar3;
    }
    if (*pcVar3 == '\0') break;
    pcVar3 = pcVar3 + 1;
  }
  return (char *)0x0;
}



/* Function: FUN_00401bd3 */

void __thiscall FUN_00401bd3(void *this,undefined4 *param_1,undefined4 *param_2)

{
  char cVar1;
  short sVar2;
  short *psVar3;
  int iVar4;
  DWORD DVar5;
  BYTE *lpReturnedString;
  char *pcVar6;
  uint extraout_ECX;
  short *psVar7;
  uint uVar8;
  undefined4 extraout_ECX_00;
  short *psVar9;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  UINT UVar10;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar11;
  char *pcVar12;
  short *local_614;
  BYTE local_610 [1024];
  undefined1 local_210 [260];
  char local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  FUN_00401846(local_210,0x104,this,(int)this);
  if (local_210[0] == '\"') {
    psVar9 = (short *)&DAT_00401184;
    local_614 = (short *)(local_210 + 1);
  }
  else {
    psVar9 = (short *)&DAT_00401188;
    local_614 = (short *)local_210;
  }
  psVar3 = (short *)FUN_00401b6b(&local_614,psVar9);
  psVar9 = local_614;
  uVar8 = extraout_ECX;
  if (local_614 == (short *)0x0) {
LAB_00401c8e:
    FUN_00401846(local_10c,0x104,uVar8,0x4091e4);
    FUN_00406836(local_10c,0x104,(char *)psVar9);
  }
  else {
    psVar7 = local_614;
    do {
      sVar2 = *psVar7;
      psVar7 = (short *)((int)psVar7 + 1);
    } while ((char)sVar2 != '\0');
    uVar8 = (int)psVar7 - ((int)local_614 + 1);
    if ((uVar8 < 3) ||
       (((*(char *)((int)local_614 + 1) != ':' || ((char)local_614[1] != '\\')) &&
        (((char)*local_614 != '\\' || (*(char *)((int)local_614 + 1) != '\\'))))))
    goto LAB_00401c8e;
    FUN_00401846(local_10c,0x104,uVar8,(int)local_614);
  }
  psVar7 = FUN_00406995(psVar9,0x2e);
  if ((psVar7 == (short *)0x0) ||
     (iVar4 = CompareStringA(0x7f,1,(PCNZCH)psVar7,-1,".INF",-1), iVar4 != 2)) {
    psVar9 = FUN_00406995(psVar9,0x2e);
    if ((psVar9 == (short *)0x0) ||
       (iVar4 = CompareStringA(0x7f,1,(PCNZCH)psVar9,-1,".BAT",-1), iVar4 != 2)) {
      lpReturnedString = (BYTE *)LocalAlloc(0x40,0x400);
      if (lpReturnedString != (BYTE *)0x0) {
        DVar5 = GetFileAttributesA(local_10c);
        if ((DVar5 == 0xffffffff) || ((DVar5 & 0x10) != 0)) {
          FUN_00401846((char *)local_610,0x400,extraout_ECX_00,(int)this);
        }
        else {
          FUN_00401846((char *)local_610,0x400,extraout_ECX_00,(int)local_10c);
          if ((psVar3 != (short *)0x0) && ((char)*psVar3 != '\0')) {
            FUN_00401773((char *)local_610,0x400,0x401188);
            FUN_00401773((char *)local_610,0x400,(int)psVar3);
          }
        }
        FUN_00402c30(local_610,lpReturnedString);
        uVar11 = extraout_EDX_03;
        goto LAB_00401f79;
      }
    }
    else {
      pcVar12 = s_Command_com__c__s_00408114;
      do {
        pcVar6 = pcVar12;
        pcVar12 = pcVar6 + 1;
      } while (*pcVar6 != '\0');
      pcVar12 = local_10c;
      do {
        cVar1 = *pcVar12;
        pcVar12 = pcVar12 + 1;
      } while (cVar1 != '\0');
      lpReturnedString =
           (BYTE *)LocalAlloc(0x40,(SIZE_T)(pcVar6 + (int)(pcVar12 +
                                                          (-0x40810c - (int)(local_10c + 1)))));
      if (lpReturnedString != (BYTE *)0x0) {
        FUN_004017e1((char *)lpReturnedString,
                     (uint)(pcVar6 + (int)(pcVar12 + (-0x40810c - (int)(local_10c + 1)))),
                     s_Command_com__c__s_00408114);
        uVar11 = extraout_EDX_02;
LAB_00401f79:
        *param_1 = lpReturnedString;
        goto LAB_00401f84;
      }
    }
LAB_00401ec5:
    pcVar12 = (char *)0x0;
    UVar10 = 0x4b5;
  }
  else {
    DVar5 = GetFileAttributesA(local_10c);
    if ((DVar5 != 0xffffffff) && ((~(DVar5 >> 4) & 1) != 0)) {
      local_614 = psVar3;
      psVar9 = (short *)FUN_00401b6b(&local_614,(short *)&DAT_00401194);
      if (psVar9 != (short *)0x0) {
        if ((char)*psVar9 != '\0') {
          local_614 = psVar9;
        }
        FUN_00401b6b(&local_614,(short *)&DAT_00401198);
      }
      lpReturnedString = (BYTE *)LocalAlloc(0x40,0x200);
      pcVar12 = (char *)local_614;
      if (lpReturnedString != (BYTE *)0x0) {
        pcVar6 = (char *)local_614;
        if ((char)*local_614 == '\0') {
          pcVar6 = s_DefaultInstall_00408104;
        }
        DAT_00409120 = GetPrivateProfileIntA(pcVar6,"Reboot",0,local_10c);
        *param_2 = 1;
        DVar5 = GetPrivateProfileStringA
                          ("Version","AdvancedINF","",(LPSTR)lpReturnedString,8,local_10c);
        if (DVar5 == 0) {
          DAT_00409a34 = DAT_00409a34 & 0xfffffffb;
          if (DAT_00409a40 == 0) {
            GetShortPathNameA(local_10c,local_10c,0x104);
          }
          FUN_004017e1((char *)lpReturnedString,0x200,s_rundll32_exe__s_InstallHinfSecti_004080b8);
          uVar11 = extraout_EDX_00;
        }
        else {
          DAT_00409a34 = DAT_00409a34 | 4;
          if ((char)*(short *)pcVar12 == '\0') {
            pcVar12 = s_DefaultInstall_00408104;
          }
          FUN_00401740((char *)this,0x104,(int)pcVar12);
          FUN_00401740((char *)lpReturnedString,0x200,(int)local_10c);
          uVar11 = extraout_EDX;
        }
        goto LAB_00401f79;
      }
      goto LAB_00401ec5;
    }
    UVar10 = 0x525;
    pcVar12 = local_10c;
  }
  FUN_004046c7((HWND)0x0,UVar10,pcVar12,(char *)0x0,0x10,0);
  uVar11 = extraout_EDX_01;
LAB_00401f84:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar11);
  return;
}



/* Function: FUN_00401f9b */

void FUN_00401f9b(void)

{
  FUN_004046c7((HWND)0x0,0x521,"",(char *)0x0,0x40,0);
  return;
}



/* Function: FUN_00401fb9 */

undefined4 FUN_00401fb9(void)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = DAT_00409a44;
  if ((DAT_00409120 == 0) && (uVar2 = FUN_00402747(DAT_00409a40), uVar1 == uVar2)) {
    return 0xffffffff;
  }
  return 2;
}



/* Function: FUN_00401fed */

void FUN_00401fed(void)

{
  HANDLE ProcessHandle;
  BOOL BVar1;
  UINT UVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  DWORD DesiredAccess;
  HANDLE *TokenHandle;
  HANDLE local_1c;
  _TOKEN_PRIVILEGES local_18;
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  TokenHandle = &local_1c;
  DesiredAccess = 0x28;
  ProcessHandle = GetCurrentProcess();
  BVar1 = OpenProcessToken(ProcessHandle,DesiredAccess,TokenHandle);
  if (BVar1 == 0) {
    UVar2 = 0x4f5;
  }
  else {
    LookupPrivilegeValueA((LPCSTR)0x0,"SeShutdownPrivilege",&local_18.Privileges[0].Luid);
    local_18.PrivilegeCount = 1;
    local_18.Privileges[0].Attributes = 2;
    BVar1 = AdjustTokenPrivileges(local_1c,0,&local_18,0,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0);
    CloseHandle(local_1c);
    if (BVar1 == 0) {
      UVar2 = 0x4f6;
    }
    else {
      BVar1 = ExitWindowsEx(2,0);
      uVar3 = extraout_EDX_00;
      if (BVar1 != 0) goto LAB_0040208c;
      UVar2 = 0x4f7;
    }
  }
  FUN_004046c7((HWND)0x0,UVar2,(char *)0x0,(char *)0x0,0x10,0);
  uVar3 = extraout_EDX;
LAB_0040208c:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



/* Function: FUN_0040209f */

void __fastcall FUN_0040209f(uint param_1)

{
  int iVar1;
  
  if (((param_1 & 2) == 0) && (iVar1 = FUN_00401fb9(), iVar1 != 2)) {
    return;
  }
  if (((param_1 & 4) == 0) &&
     (iVar1 = FUN_004046c7((HWND)0x0,0x522,"",(char *)0x0,0x40,4), iVar1 != 6)) {
    return;
  }
  if (DAT_00409a40 == 0) {
    ExitWindowsEx(2,0);
    return;
  }
  FUN_00401fed();
  return;
}



/* Function: FUN_004020f6 */

void FUN_004020f6(void)

{
  LSTATUS LVar1;
  HKEY local_8;
  
  if (DAT_00408530 != '\0') {
    LVar1 = RegOpenKeyExA((HKEY)0x80000002,s_Software_Microsoft_Windows_Curre_00408070,0,0x20006,
                          &local_8);
    if (LVar1 == 0) {
      RegDeleteValueA(local_8,&DAT_00408530);
      RegCloseKey(local_8);
    }
  }
  return;
}



/* Function: FUN_00402143 */

void FUN_00402143(void)

{
  char cVar1;
  BYTE BVar2;
  LSTATUS LVar3;
  HMODULE hModule;
  FARPROC pFVar4;
  UINT UVar5;
  DWORD DVar6;
  BYTE *lpData;
  char *pcVar7;
  char *pcVar8;
  BYTE *pBVar9;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  char *pcVar10;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar11;
  uint uVar12;
  int iVar13;
  DWORD local_21c;
  DWORD local_218;
  HKEY local_214;
  CHAR local_210 [260];
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  memset(local_10c,0,0x104);
  memset(local_210,0,0x104);
  uVar12 = 0;
  LVar3 = RegCreateKeyExA((HKEY)0x80000002,s_Software_Microsoft_Windows_Curre_00408070,0,(LPSTR)0x0,
                          0,0x2001f,(LPSECURITY_ATTRIBUTES)0x0,&local_214,&local_218);
  uVar11 = extraout_EDX;
  if (LVar3 != 0) goto LAB_0040235d;
  iVar13 = 0;
  do {
    FUN_004017e1(&DAT_00408530,0x50,s_wextract_cleanup_d_004080a4);
    LVar3 = RegQueryValueExA(local_214,&DAT_00408530,(LPDWORD)0x0,(LPDWORD)0x0,(LPBYTE)0x0,
                             &local_21c);
    if (LVar3 != 0) goto LAB_0040220b;
    iVar13 = iVar13 + 1;
  } while (iVar13 < 200);
  if (iVar13 == 200) {
    RegCloseKey(local_214);
    DAT_00408530 = 0;
    uVar11 = extraout_EDX_00;
    goto LAB_0040235d;
  }
LAB_0040220b:
  GetSystemDirectoryA(local_210,0x104);
  FUN_00406836(local_210,0x104,"advpack.dll");
  hModule = LoadLibraryA(local_210);
  if (hModule == (HMODULE)0x0) {
LAB_00402284:
    DVar6 = GetModuleFileNameA(DAT_00409a3c,local_10c,0x104);
    if (DVar6 != 0) goto LAB_0040229c;
  }
  else {
    pFVar4 = GetProcAddress(hModule,"DelNodeRunDLL32");
    uVar12 = (uint)(pFVar4 != (FARPROC)0x0);
    FreeLibrary(hModule);
    if (uVar12 == 0) goto LAB_00402284;
    UVar5 = GetSystemDirectoryA(local_10c,0x104);
    if (UVar5 != 0) {
      FUN_00406836(local_10c,0x104,"");
    }
LAB_0040229c:
    pcVar8 = local_10c;
    do {
      cVar1 = *pcVar8;
      pcVar8 = pcVar8 + 1;
    } while (cVar1 != '\0');
    pcVar7 = &DAT_004091e4;
    do {
      pcVar10 = pcVar7;
      pcVar7 = pcVar10 + 1;
    } while (*pcVar10 != '\0');
    lpData = (BYTE *)LocalAlloc(0x40,(SIZE_T)(pcVar10 +
                                             (int)(pcVar8 + (-0x409194 - (int)(local_10c + 1)))));
    if (lpData != (BYTE *)0x0) {
      DAT_00408580 = uVar12 ^ 1;
      pcVar7 = s_rundll32_exe__sadvpack_dll_DelNo_00408040;
      if (uVar12 == 0) {
        pcVar7 = s__s__D__s_0040812c;
      }
      FUN_004017e1((char *)lpData,
                   (uint)(pcVar10 + (int)(pcVar8 + (-0x409194 - (int)(local_10c + 1)))),pcVar7);
      pBVar9 = lpData;
      do {
        BVar2 = *pBVar9;
        pBVar9 = pBVar9 + 1;
      } while (BVar2 != '\0');
      RegSetValueExA(local_214,&DAT_00408530,0,1,lpData,(DWORD)(pBVar9 + (1 - (int)(lpData + 1))));
      RegCloseKey(local_214);
      LocalFree(lpData);
      uVar11 = extraout_EDX_02;
      goto LAB_0040235d;
    }
    FUN_004046c7((HWND)0x0,0x4b5,(char *)0x0,(char *)0x0,0x10,0);
  }
  RegCloseKey(local_214);
  uVar11 = extraout_EDX_01;
LAB_0040235d:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar11);
  return;
}



/* Function: FUN_00402371 */

void __fastcall FUN_00402371(undefined4 param_1,undefined4 param_2)

{
  BYTE BVar1;
  LSTATUS LVar2;
  UINT UVar3;
  BYTE *pBVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  DWORD local_34c;
  HKEY local_348;
  BYTE local_344 [568];
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  if ((DAT_00408530 != '\0') &&
     (LVar2 = RegOpenKeyExA((HKEY)0x80000002,s_Software_Microsoft_Windows_Curre_00408070,0,0x2001f,
                            &local_348), param_2 = extraout_EDX, LVar2 == 0)) {
    local_34c = 0x238;
    LVar2 = RegQueryValueExA(local_348,&DAT_00408530,(LPDWORD)0x0,(LPDWORD)0x0,local_344,&local_34c)
    ;
    if (LVar2 == 0) {
      memset(local_10c,0,0x104);
      UVar3 = GetSystemDirectoryA(local_10c,0x104);
      if (UVar3 != 0) {
        FUN_00406836(local_10c,0x104,"");
      }
      FUN_004017e1((char *)local_344,0x238,s_rundll32_exe__sadvpack_dll_DelNo_00408040);
      pBVar4 = local_344;
      do {
        BVar1 = *pBVar4;
        pBVar4 = pBVar4 + 1;
      } while (BVar1 != '\0');
      RegSetValueExA(local_348,&DAT_00408530,0,1,local_344,
                     (DWORD)(pBVar4 + (1 - (int)(local_344 + 1))));
    }
    RegCloseKey(local_348);
    param_2 = extraout_EDX_00;
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_0040249e */

void __fastcall FUN_0040249e(LPCSTR param_1,undefined4 param_2)

{
  HANDLE hFindFile;
  int iVar1;
  BOOL BVar2;
  undefined4 extraout_ECX;
  undefined4 uVar3;
  undefined4 extraout_ECX_00;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined1 auStack_25c [4];
  _WIN32_FIND_DATAA local_258;
  char local_118 [268];
  uint local_c;
  
  local_c = DAT_00408004 ^ (uint)auStack_25c;
  if ((param_1 != (LPCSTR)0x0) && (*param_1 != '\0')) {
    FUN_00401846(local_118,0x104,param_1,(int)param_1);
    FUN_00401773(local_118,0x104,0x40120c);
    hFindFile = FindFirstFileA(local_118,&local_258);
    uVar3 = extraout_ECX;
    param_2 = extraout_EDX;
    if (hFindFile != (HANDLE)0xffffffff) {
      do {
        FUN_00401846(local_118,0x104,uVar3,(int)param_1);
        if (((byte)local_258.dwFileAttributes & 0x10) == 0) {
          FUN_00401773(local_118,0x104,(int)local_258.cFileName);
          SetFileAttributesA(local_118,0x80);
          DeleteFileA(local_118);
        }
        else {
          iVar1 = lstrcmpA(local_258.cFileName,".");
          if (iVar1 != 0) {
            iVar1 = lstrcmpA(local_258.cFileName,"..");
            if (iVar1 != 0) {
              FUN_00401773(local_118,0x104,(int)local_258.cFileName);
              FUN_00406836(local_118,0x104,"");
              FUN_0040249e(local_118,extraout_EDX_00);
            }
          }
        }
        BVar2 = FindNextFileA(hFindFile,&local_258);
        uVar3 = extraout_ECX_00;
      } while (BVar2 != 0);
      FindClose(hFindFile);
      RemoveDirectoryA(param_1);
      param_2 = extraout_EDX_01;
    }
  }
  FUN_00406ff0(local_c ^ (uint)auStack_25c,param_2);
  return;
}



/* Function: FUN_004025f8 */

void FUN_004025f8(void)

{
  UINT UVar1;
  HFILE hFile;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar2;
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  UVar1 = GetWindowsDirectoryA(local_10c,0x104);
  uVar2 = extraout_EDX;
  if (UVar1 != 0) {
    FUN_00406836(local_10c,0x104,"wininit.ini");
    WritePrivateProfileStringA((LPCSTR)0x0,(LPCSTR)0x0,(LPCSTR)0x0,local_10c);
    hFile = _lopen(local_10c,0x40);
    uVar2 = extraout_EDX_00;
    if (hFile != -1) {
      _llseek(hFile,0,2);
      _lclose(hFile);
      uVar2 = extraout_EDX_01;
    }
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



/* Function: FUN_00402689 */

uint FUN_00402689(void)

{
  LSTATUS LVar1;
  HKEY local_c;
  DWORD local_8;
  
  local_8 = 0;
  LVar1 = RegOpenKeyExA((HKEY)0x80000002,s_DSystem_CurrentControlSet_Contro_0040800b + 1,0,0x20019,
                        &local_c);
  if (LVar1 == 0) {
    LVar1 = RegQueryValueExA(local_c,s_PendingFileRenameOperations_004080e8,(LPDWORD)0x0,
                             (LPDWORD)0x0,(LPBYTE)0x0,&local_8);
    local_8 = local_8 & ~-(uint)(LVar1 != 0);
    RegCloseKey(local_c);
  }
  return local_8;
}



/* Function: FUN_004026e7 */

uint FUN_004026e7(void)

{
  LSTATUS LVar1;
  HKEY local_c;
  DWORD local_8;
  
  local_8 = 0;
  LVar1 = RegOpenKeyExA((HKEY)0x80000002,s_System_CurrentControlSet_Control_00408138,0,0x20019,
                        &local_c);
  if (LVar1 == 0) {
    LVar1 = RegQueryInfoKeyA(local_c,(LPSTR)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,
                             (LPDWORD)0x0,&local_8,(LPDWORD)0x0,(LPDWORD)0x0,(LPDWORD)0x0,
                             (PFILETIME)0x0);
    local_8 = local_8 & ~-(uint)(LVar1 != 0);
    RegCloseKey(local_c);
  }
  return local_8;
}



/* Function: FUN_00402747 */

uint __fastcall FUN_00402747(short param_1)

{
  uint uVar1;
  
  uVar1 = 0;
  if (param_1 == 0) {
    uVar1 = FUN_004025f8();
  }
  else if (param_1 == 1) {
    uVar1 = FUN_004026e7();
  }
  else if ((param_1 == 2) || (param_1 == 3)) {
    uVar1 = FUN_00402689();
  }
  return uVar1;
}



/* Function: FUN_0040277d */

void FUN_0040277d(void)

{
  UINT UVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  UVar1 = GetWindowsDirectoryA(local_10c,0x104);
  uVar2 = extraout_EDX;
  if (UVar1 == 0) {
    FUN_004046c7((HWND)0x0,0x4f0,(char *)0x0,(char *)0x0,0x10,0);
    uVar2 = extraout_EDX_00;
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



/* Function: FUN_004027dc */

void __fastcall FUN_004027dc(int param_1,undefined4 param_2,undefined4 param_3,char *param_4)

{
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined8 uVar1;
  char local_14 [12];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  DAT_00409124 = 0x70;
  if (param_1 == 1) {
    FUN_004017e1(local_14,10,"%lu");
    FUN_004046c7((HWND)0x0,0x4fa,local_14,(char *)0x0,0x10,0);
    param_2 = extraout_EDX;
  }
  else if (param_1 == 4) {
    FUN_004017e1(local_14,10,"%lu");
    FUN_004046c7((HWND)0x0,0x4bd,local_14,(char *)0x0,0x20,5);
    param_2 = extraout_EDX_00;
  }
  else if (param_1 == 2) {
    FUN_004017e1(local_14,10,"%lu");
    uVar1 = FUN_004046c7((HWND)0x0,0x4cc,local_14,param_4,0x40,0x104);
    param_2 = (undefined4)((ulonglong)uVar1 >> 0x20);
    if ((int)uVar1 == 6) {
      DAT_00409124 = 0;
    }
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_004028c8 */

void __thiscall FUN_004028c8(void *this,char *param_1)

{
  bool bVar1;
  LPSTR pCVar2;
  LSTATUS LVar3;
  DWORD DVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar5;
  undefined4 extraout_EDX_03;
  DWORD local_120;
  HKEY local_11c;
  DWORD local_118;
  char *local_114;
  char local_10d;
  char local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  bVar1 = false;
  local_114 = param_1;
  *(undefined1 *)this = 0;
  if (*param_1 == '#') {
    pCVar2 = CharUpperA((LPSTR)(int)param_1[1]);
    local_10d = (char)pCVar2;
    pCVar2 = CharNextA(param_1 + 1);
    local_114 = CharNextA(pCVar2);
    if (local_10d == 'A') {
LAB_00402953:
      local_120 = 0x104;
      FUN_00401846(local_10c,0x104,extraout_ECX,0x401228);
      FUN_00406836(local_10c,0x104,local_114);
      LVar3 = RegOpenKeyExA((HKEY)0x80000002,local_10c,0,0x20019,&local_11c);
      uVar5 = extraout_EDX_01;
      if (LVar3 == 0) {
        LVar3 = RegQueryValueExA(local_11c,"",(LPDWORD)0x0,&local_118,(LPBYTE)this,&local_120);
        if (LVar3 == 0) {
          if ((local_118 == 2) &&
             (DVar4 = ExpandEnvironmentStringsA((LPCSTR)this,local_10c,0x104), DVar4 != 0)) {
            FUN_00401740((char *)this,0x104,(int)local_10c);
          }
          else if (local_118 != 1) goto LAB_00402a0b;
          bVar1 = true;
        }
LAB_00402a0b:
        RegCloseKey(local_11c);
        uVar5 = extraout_EDX_02;
      }
    }
    else if (local_10d == 'S') {
      GetSystemDirectoryA((LPSTR)this,0x104);
      uVar5 = extraout_EDX_00;
    }
    else {
      if (local_10d != 'W') goto LAB_00402953;
      GetWindowsDirectoryA((LPSTR)this,0x104);
      uVar5 = extraout_EDX;
    }
    if (bVar1) goto LAB_00402a39;
  }
  else {
    GetSystemDirectoryA((LPSTR)this,0x104);
  }
  FUN_00406836((char *)this,0x104,local_114);
  uVar5 = extraout_EDX_03;
LAB_00402a39:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



/* Function: FUN_00402a53 */

int __fastcall FUN_00402a53(int param_1,LPCSTR param_2,undefined4 param_3,int *param_4)

{
  int iVar1;
  BOOL BVar2;
  uint *puVar3;
  uint uVar4;
  uint uVar5;
  uint extraout_ECX;
  uint extraout_ECX_00;
  DWORD DVar6;
  uint extraout_EDX;
  uint extraout_EDX_00;
  HGLOBAL hMem;
  int iVar7;
  int iVar8;
  uint local_40 [5];
  LPVOID local_2c;
  uint local_28;
  uint *local_24;
  DWORD local_20;
  DWORD local_1c;
  int local_18;
  int local_14;
  int local_10;
  LPCSTR local_c;
  int local_8;
  
  hMem = (HGLOBAL)0x0;
  local_14 = 0;
  local_10 = param_1;
  local_c = param_2;
  if (0 < *(int *)(param_1 + 0x7c)) {
    local_8 = 0;
    do {
      iVar8 = local_14;
      iVar7 = 0;
      local_18 = *(int *)(local_10 + 0x80);
      iVar1 = FUN_004028c8(local_c,(char *)(*(int *)(local_8 + local_10 + 0xbc + local_18) +
                                           local_10 + 0x84));
      if (iVar1 == 0) goto LAB_00402bd0;
      local_1c = GetFileVersionInfoSizeA(local_c,&local_20);
      if (local_1c == 0) {
        iVar8 = local_14;
        if ((*(int *)(local_8 + local_10 + 0x84 + local_18) != 0) ||
           (*(int *)(local_8 + local_10 + 0x88 + local_18) != 0)) goto LAB_00402bd0;
      }
      else {
        hMem = GlobalAlloc(0x42,local_1c);
        if (hMem == (HGLOBAL)0x0) {
          *param_4 = iVar8;
          return 0;
        }
        local_24 = (uint *)GlobalLock(hMem);
        if (local_24 == (uint *)0x0) {
LAB_00402bf0:
          iVar7 = 0;
          *param_4 = iVar8;
          goto LAB_00402bd9;
        }
        BVar2 = GetFileVersionInfoA(local_c,local_20,local_1c,local_24);
        if (((BVar2 != 0) && (BVar2 = VerQueryValueA(local_24,"\\",&local_2c,&local_28), BVar2 != 0)
            ) && (local_28 != 0)) {
          DVar6 = *(DWORD *)((int)local_2c + 0xc);
          uVar5 = *(uint *)((int)local_2c + 8);
          puVar3 = (uint *)(local_8 + local_10 + local_18 + 0x94);
          local_40[4] = uVar5;
          local_24 = puVar3;
          local_1c = DVar6;
          do {
            uVar4 = FUN_00402c04(uVar5,DVar6,puVar3[-4],puVar3[-3]);
            uVar5 = *puVar3;
            *(uint *)((int)local_40 + iVar7 + 8) = uVar4;
            uVar5 = FUN_00402c04(extraout_ECX,extraout_EDX,puVar3[-1],uVar5);
            iVar8 = local_14;
            *(uint *)((int)local_40 + iVar7) = uVar5;
            puVar3 = puVar3 + 6;
            iVar7 = iVar7 + 4;
            uVar5 = extraout_ECX_00;
            DVar6 = extraout_EDX_00;
          } while (iVar7 < 8);
          if ((((int)local_40[2] < 0) || (0 < (int)local_40[0])) &&
             (((int)local_40[3] < 0 || (0 < (int)local_40[1])))) {
            GlobalUnlock(hMem);
            goto LAB_00402bf0;
          }
        }
        GlobalUnlock(hMem);
        local_14 = iVar8;
      }
      local_14 = local_14 + 1;
      local_8 = local_8 + 0x3c;
    } while (local_14 < *(int *)(local_10 + 0x7c));
  }
  iVar7 = 1;
  iVar8 = local_14;
LAB_00402bd0:
  *param_4 = iVar8;
  if (hMem != (HGLOBAL)0x0) {
LAB_00402bd9:
    GlobalFree(hMem);
  }
  return iVar7;
}



/* Function: FUN_00402c04 */

uint __fastcall FUN_00402c04(uint param_1,uint param_2,uint param_3,uint param_4)

{
  if (param_3 <= param_1) {
    if (param_3 < param_1) {
      return 1;
    }
    if (param_4 <= param_2) {
      return (uint)(param_4 < param_2);
    }
  }
  return 0xffffffff;
}



/* Function: FUN_00402c30 */

void __fastcall FUN_00402c30(BYTE *param_1,BYTE *param_2)

{
  BYTE BVar1;
  LPCSTR pCVar2;
  BOOL BVar3;
  LPSTR pCVar4;
  uint uVar5;
  LPCSTR lpszCurrent;
  BYTE *lpsz;
  BYTE *extraout_EDX;
  BYTE *extraout_EDX_00;
  BYTE *pBVar6;
  CHAR *pCVar7;
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  *param_2 = '\0';
  pBVar6 = param_2;
  if ((param_1 != (BYTE *)0x0) && (*param_1 != '\0')) {
    GetModuleFileNameA(DAT_00409a3c,local_10c,0x104);
    BVar1 = *param_1;
    lpsz = param_2;
    pBVar6 = extraout_EDX;
    while (BVar1 != '\0') {
      BVar3 = IsDBCSLeadByte(BVar1);
      *lpsz = *param_1;
      if (BVar3 != 0) {
        lpsz[1] = param_1[1];
      }
      if (*param_1 == '#') {
        param_1 = (BYTE *)CharNextA((LPCSTR)param_1);
        pCVar4 = CharUpperA((LPSTR)(int)(char)*param_1);
        if ((char)pCVar4 == 'D') {
          FUN_0040689a(local_10c);
          pCVar2 = local_10c;
          do {
            lpszCurrent = pCVar2;
            pCVar2 = lpszCurrent + 1;
          } while (*lpszCurrent != '\0');
          pCVar4 = CharPrevA(local_10c,lpszCurrent);
          if ((pCVar4 != (LPSTR)0x0) && (*pCVar4 == '\\')) {
            *pCVar4 = '\0';
          }
          pCVar7 = local_10c;
          uVar5 = FUN_00401893(param_2,(uint)lpsz);
          FUN_00401740((char *)lpsz,uVar5,(int)pCVar7);
          do {
            BVar1 = *lpsz;
            lpsz = lpsz + 1;
          } while (BVar1 != '\0');
        }
        else {
          pCVar4 = CharUpperA((LPSTR)(int)(char)*param_1);
          if ((char)pCVar4 != 'E') {
            if (*param_1 == '#') goto LAB_00402d68;
            goto LAB_00402d71;
          }
          pCVar7 = local_10c;
          uVar5 = FUN_00401893(param_2,(uint)lpsz);
          FUN_00401740((char *)lpsz,uVar5,(int)pCVar7);
          do {
            BVar1 = *lpsz;
            lpsz = lpsz + 1;
          } while (BVar1 != '\0');
        }
        lpsz = lpsz + -1;
      }
      else {
LAB_00402d68:
        lpsz = (BYTE *)CharNextA((LPCSTR)lpsz);
      }
LAB_00402d71:
      param_1 = (BYTE *)CharNextA((LPCSTR)param_1);
      pBVar6 = extraout_EDX_00;
      BVar1 = *param_1;
    }
    *lpsz = '\0';
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,pBVar6);
  return;
}



/* Function: FUN_00402da4 */

/* WARNING: Removing unreachable block (ram,0x00402df2) */

undefined4 FUN_00402da4(HMODULE param_1,undefined4 param_2,char *param_3)

{
  DWORD DVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  int iVar3;
  undefined4 extraout_ECX;
  undefined8 uVar4;
  
  DVar1 = GetVersion();
  if ((((-1 < (int)DVar1) && (5 < (byte)DVar1)) &&
      (hModule = GetModuleHandleW(L"Kernel32.dll"), hModule != (HMODULE)0x0)) &&
     (pFVar2 = GetProcAddress(hModule,"HeapSetInformation"), pFVar2 != (FARPROC)0x0)) {
    (*(code *)PTR_guard_check_icall_0040a288)(0,1,0,0);
    (*pFVar2)();
  }
  DAT_00409124 = 0;
  iVar3 = FUN_00402e59(param_1,param_3);
  if (iVar3 != 0) {
    uVar4 = FUN_004030d6();
    FUN_004054e8(extraout_ECX,(int)((ulonglong)uVar4 >> 0x20));
    if ((((int)uVar4 != 0) && (DAT_00408a3a == '\0')) && ((DAT_00409a2c & 1) != 0)) {
      FUN_0040209f(DAT_00409a2c);
    }
  }
  if (DAT_00408588 != (HANDLE)0x0) {
    CloseHandle(DAT_00408588);
  }
  return DAT_00409124;
}



/* Function: FUN_00402e59 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall FUN_00402e59(HMODULE param_1,char *param_2)

{
  DWORD DVar1;
  HRSRC hResInfo;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  short *extraout_EDX;
  undefined4 extraout_EDX_00;
  short *extraout_EDX_01;
  short *extraout_EDX_02;
  undefined4 extraout_EDX_03;
  short *psVar2;
  UINT UVar3;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  undefined4 extraout_EDX_09;
  undefined4 uVar4;
  HGLOBAL pvVar5;
  undefined8 uVar6;
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  pvVar5 = (HGLOBAL)0x0;
  DAT_00409a3c = param_1;
  memset(&DAT_00409140,0,0x8fc);
  memset(&DAT_00408a20,0,0x32c);
  memset(&DAT_004088c0,0,0x104);
  _DAT_004093ec = 1;
  DVar1 = FUN_004048a1("TITLE",&DAT_00409154,0x7f);
  if ((DVar1 == 0) || (0x80 < DVar1)) {
    UVar3 = 0x4b1;
  }
  else {
    DAT_0040858c = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCSTR)0x0);
    SetEvent(DAT_0040858c);
    DVar1 = FUN_004048a1("EXTRACTOPT",&DAT_00409a34,4);
    if (DVar1 == 0) {
LAB_00402f0a:
      FUN_004046c7((HWND)0x0,0x4b1,(char *)0x0,(char *)0x0,0x10,0);
      DAT_00409124 = 0x80070714;
      uVar4 = extraout_EDX_00;
      goto LAB_004030bf;
    }
    psVar2 = extraout_EDX;
    if ((DAT_00409a34 & 0xc0) != 0) {
      DVar1 = FUN_004048a1("INSTANCECHECK",local_10c,0x104);
      if (DVar1 == 0) goto LAB_00402f0a;
      DAT_00408588 = CreateMutexA((LPSECURITY_ATTRIBUTES)0x0,1,local_10c);
      psVar2 = extraout_EDX_01;
      if ((DAT_00408588 != (HANDLE)0x0) &&
         (DVar1 = GetLastError(), psVar2 = extraout_EDX_02, DVar1 == 0xb7)) {
        if ((DAT_00409a34 & 0x80) == 0) {
          uVar6 = FUN_004046c7((HWND)0x0,0x524,&DAT_00409154,(char *)0x0,0x20,4);
          psVar2 = (short *)((ulonglong)uVar6 >> 0x20);
          if ((int)uVar6 == 6) goto LAB_00402fce;
        }
        else {
          FUN_004046c7((HWND)0x0,0x54b,&DAT_00409154,(char *)0x0,0x10,0);
        }
        CloseHandle(DAT_00408588);
        DAT_00409124 = 0x800700b7;
        uVar4 = extraout_EDX_03;
        goto LAB_004030bf;
      }
    }
LAB_00402fce:
    DAT_00409120 = 0;
    uVar6 = FUN_00405f17(param_2,psVar2);
    if ((int)uVar6 != 0) {
      if (DAT_00408a3a == '\0') {
        hResInfo = FindResourceA(param_1,"VERCHECK",(LPCSTR)0xa);
        uVar4 = extraout_EDX_05;
        if (hResInfo != (HRSRC)0x0) {
          pvVar5 = LoadResource(param_1,hResInfo);
          uVar4 = extraout_EDX_06;
        }
        if (DAT_00408184 != 0) {
          Ordinal_17();
          uVar4 = extraout_EDX_07;
        }
        if (DAT_00408a24 == 0) {
          uVar6 = FUN_004038c7((int)pvVar5);
          uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
          if ((((int)uVar6 != 0) &&
              (((DAT_00409a40 == 1 || (DAT_00409a40 == 2)) || (DAT_00409a40 == 3)))) &&
             (((DAT_00409a34 & 0x100) != 0 && (((byte)DAT_00408a38 & 1) == 0)))) {
            uVar6 = FUN_00401978(extraout_ECX,uVar4);
            uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
            if ((int)uVar6 == 0) {
              FUN_004067bf(extraout_ECX_00,(LPCSTR)0x7d6,(HWND)0x0,FUN_00401ac0,0x547,0x83e);
              uVar4 = extraout_EDX_08;
            }
          }
        }
      }
      else {
        FUN_0040249e(&DAT_00408a3a,(int)((ulonglong)uVar6 >> 0x20));
        uVar4 = extraout_EDX_04;
      }
      goto LAB_004030bf;
    }
    UVar3 = 0x520;
  }
  FUN_004046c7((HWND)0x0,UVar3,(char *)0x0,(char *)0x0,0x10,0);
  uVar4 = extraout_EDX_09;
LAB_004030bf:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



/* Function: FUN_004030d6 */

/* WARNING: Removing unreachable block (ram,0x004031a9) */

void FUN_004030d6(void)

{
  int iVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  BOOL BVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar4;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  uint uVar5;
  undefined8 uVar6;
  CHAR local_110 [264];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  if (DAT_00408a38 == 0) {
    if (DAT_00408a24 == 0) {
      iVar1 = FUN_00405411();
      uVar4 = extraout_EDX;
      if (iVar1 == 0) goto LAB_004031fc;
      if (DAT_00408a38 != 0) goto LAB_00403125;
    }
    iVar1 = FUN_00403c17();
    uVar4 = extraout_EDX_00;
    if (iVar1 == 0) goto LAB_004031fc;
  }
LAB_00403125:
  iVar1 = FUN_0040538a();
  uVar4 = extraout_EDX_01;
  if (iVar1 != 0) {
    uVar6 = FUN_004057ed();
    uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
    if ((int)uVar6 != 0) {
      GetSystemDirectoryA(local_110,0x105);
      FUN_00406836(local_110,0x105,"advapi32.dll");
      hModule = LoadLibraryA(local_110);
      uVar5 = 0;
      if ((hModule != (HMODULE)0x0) &&
         (pFVar2 = GetProcAddress(hModule,"DecryptFileA"), pFVar2 != (FARPROC)0x0)) {
        (*(code *)PTR_guard_check_icall_0040a288)(&DAT_004091e4,0);
        (*pFVar2)();
      }
      FreeLibrary(hModule);
      if ((DAT_00408a24 == 0) && (DAT_00409a30 == 0)) {
        uVar6 = FUN_004064a7();
        uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
        if ((int)uVar6 == 0) goto LAB_004031fc;
      }
      BVar3 = SetCurrentDirectoryA(&DAT_004091e4);
      if (BVar3 == 0) {
        FUN_004046c7((HWND)0x0,0x4bc,(char *)0x0,(char *)0x0,0x10,0);
        DAT_00409124 = FUN_00406512();
        uVar4 = extraout_EDX_03;
      }
      else {
        uVar4 = extraout_EDX_02;
        if ((DAT_00408a2c != 0) ||
           (iVar1 = FUN_00403d04(extraout_ECX), uVar4 = extraout_EDX_04, iVar1 != 0)) {
          if (((byte)DAT_00408d48 & 0xc0) == 0) {
            uVar5 = FUN_00402747(DAT_00409a40);
            uVar4 = extraout_EDX_05;
          }
          DAT_00409a44 = uVar5;
          if ((DAT_00408a24 == 0) && (DAT_00409a30 == 0)) {
            uVar6 = FUN_00403d86();
            uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
            if ((int)uVar6 == 0) goto LAB_004031fc;
          }
          if ((DAT_00408a38 == 0) && (DAT_00408a24 == 0)) {
            FUN_00404366();
            uVar4 = extraout_EDX_06;
          }
        }
      }
    }
  }
LAB_004031fc:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



/* Function: FUN_00403280 */

LRESULT FUN_00403280(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  LRESULT LVar1;
  
  if (((param_2 == 0xb1) && (param_3 == 0)) && (param_4 == -2)) {
    LVar1 = 0;
  }
  else {
    LVar1 = CallWindowProcA(DAT_004088b8,param_1,param_2,param_3,param_4);
  }
  return LVar1;
}



/* Function: FUN_004032c0 */

undefined4 FUN_004032c0(HWND param_1,int param_2,int param_3)

{
  undefined4 uVar1;
  HWND pHVar2;
  INT_PTR nResult;
  
  if (param_2 == 0xf) {
    if (DAT_00408590 == 0) {
      SendDlgItemMessageA(param_1,0x834,0xb1,0xffffffff,0);
      DAT_00408590 = 1;
    }
LAB_0040339a:
    uVar1 = 0;
  }
  else {
    if (param_2 == 0x10) {
LAB_004032f6:
      nResult = 0;
LAB_004032f8:
      EndDialog(param_1,nResult);
    }
    else {
      if (param_2 == 0x110) {
        pHVar2 = GetDesktopWindow();
        FUN_004045da(param_1,pHVar2);
        SetDlgItemTextA(param_1,0x834,DAT_00408d4c);
        SetWindowTextA(param_1,&DAT_00409154);
        SetForegroundWindow(param_1);
        pHVar2 = GetDlgItem(param_1,0x834);
        DAT_004088b8 = GetWindowLongA(pHVar2,-4);
        SetWindowLongA(pHVar2,-4,0x403280);
        return 1;
      }
      if (param_2 != 0x111) goto LAB_0040339a;
      if (param_3 == 6) {
        nResult = 1;
        goto LAB_004032f8;
      }
      if (param_3 == 7) goto LAB_004032f6;
    }
    uVar1 = 1;
  }
  return uVar1;
}



/* Function: FUN_004033a6 */

undefined4 __fastcall FUN_004033a6(char *param_1)

{
  char cVar1;
  char *pcVar2;
  
  if (param_1 != (char *)0x0) {
    pcVar2 = param_1;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    if ((2 < (uint)((int)pcVar2 - (int)(param_1 + 1))) &&
       ((param_1[1] == ':' || ((*param_1 == '\\' && (param_1[1] == '\\')))))) {
      return 1;
    }
  }
  return 0;
}



/* Function: FUN_004033e0 */

undefined4 FUN_004033e0(HWND param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  BOOL BVar3;
  UINT UVar4;
  DWORD DVar5;
  HWND pHVar6;
  uint uVar7;
  char *pcVar8;
  
  if (param_2 != 0x10) {
    if (param_2 == 0x110) {
      pHVar6 = GetDesktopWindow();
      FUN_004045da(param_1,pHVar6);
      SetWindowTextA(param_1,&DAT_00409154);
      SendDlgItemMessageA(param_1,0x835,0xc5,0x103,0);
      if (DAT_00409a40 != 1) {
        return 1;
      }
      BVar3 = 0;
      pHVar6 = GetDlgItem(param_1,0x836);
      EnableWindow(pHVar6,BVar3);
      return 1;
    }
    if (param_2 != 0x111) {
      return 0;
    }
    if (param_3 == 1) {
      UVar4 = GetDlgItemTextA(param_1,0x835,&DAT_004091e4,0x104);
      if ((UVar4 == 0) || (iVar2 = FUN_004033a6(&DAT_004091e4), iVar2 == 0)) {
        UVar4 = 0x4bf;
        pcVar8 = (char *)0x0;
      }
      else {
        DVar5 = GetFileAttributesA(&DAT_004091e4);
        uVar7 = 0;
        if (DVar5 == 0xffffffff) {
          iVar2 = FUN_004046c7(param_1,0x54a,&DAT_004091e4,(char *)0x0,0x20,4);
          if (iVar2 != 6) {
            return 1;
          }
          BVar3 = CreateDirectoryA(&DAT_004091e4,(LPSECURITY_ATTRIBUTES)0x0);
          if (BVar3 == 0) {
            pcVar8 = &DAT_004091e4;
            UVar4 = 0x4cb;
            goto LAB_00403537;
          }
        }
        FUN_00406836(&DAT_004091e4,0x104,"");
        iVar2 = FUN_00405b19(&DAT_004091e4);
        if (iVar2 != 0) {
          if ((DAT_004091e4 != '\\') || (DAT_004091e5 != '\\')) {
            uVar7 = 1;
          }
          iVar2 = FUN_00405bd2(&DAT_004091e4,uVar7,1);
          if (iVar2 != 0) {
            EndDialog(param_1,1);
          }
          return 1;
        }
        pcVar8 = (char *)0x0;
        UVar4 = 0x4be;
      }
LAB_00403537:
      FUN_004046c7(param_1,UVar4,pcVar8,(char *)0x0,0x10,0);
      return 1;
    }
    if (param_3 == 2) {
      EndDialog(param_1,0);
      DAT_00409124 = 0x800704c7;
      return 1;
    }
    if (param_3 != 0x836) {
      return 1;
    }
    iVar2 = LoadStringA(DAT_00409a3c,1000,&DAT_00408598,0x200);
    if (iVar2 == 0) {
      FUN_004046c7(param_1,0x4b1,(char *)0x0,(char *)0x0,0x10,0);
    }
    else {
      bVar1 = FUN_0040442a(param_1);
      if (CONCAT31(extraout_var,bVar1) == 0) {
        return 1;
      }
      BVar3 = SetDlgItemTextA(param_1,0x835,&DAT_004087a0);
      if (BVar3 != 0) {
        return 1;
      }
      FUN_004046c7(param_1,0x4c0,(char *)0x0,(char *)0x0,0x10,0);
    }
  }
  EndDialog(param_1,0);
  return 1;
}



/* Function: FUN_00403630 */

undefined4 FUN_00403630(HWND param_1,int param_2,INT_PTR param_3)

{
  HWND pHVar1;
  
  if (param_2 == 0x10) {
    EndDialog(param_1,2);
  }
  else {
    if (param_2 != 0x110) {
      if (param_2 != 0x111) {
        return 0;
      }
      if ((param_3 != 6) && (param_3 != 7)) {
        if (param_3 != 0x839) {
          return 1;
        }
        DAT_004091dc = 1;
      }
      EndDialog(param_1,param_3);
      return 1;
    }
    pHVar1 = GetDesktopWindow();
    FUN_004045da(param_1,pHVar1);
    SetWindowTextA(param_1,&DAT_00409154);
    SetDlgItemTextA(param_1,0x838,DAT_00409404);
    SetForegroundWindow(param_1);
  }
  return 1;
}



/* Function: FUN_004036d0 */

undefined4 FUN_004036d0(HWND param_1,int param_2,int param_3)

{
  int iVar1;
  HWND pHVar2;
  UINT UVar3;
  WPARAM WVar4;
  LPARAM LVar5;
  
  if (param_2 != 0x10) {
    if (param_2 != 0x102) {
      if (param_2 == 0x110) {
        DAT_00408584 = param_1;
        pHVar2 = GetDesktopWindow();
        FUN_004045da(param_1,pHVar2);
        if (DAT_00408184 != 0) {
          LVar5 = 0xbb9;
          WVar4 = 0;
          UVar3 = 0x464;
          pHVar2 = GetDlgItem(param_1,0x83b);
          SendMessageA(pHVar2,UVar3,WVar4,LVar5);
          LVar5 = -0x10000;
          WVar4 = 0xffffffff;
          UVar3 = 0x465;
          pHVar2 = GetDlgItem(param_1,0x83b);
          SendMessageA(pHVar2,UVar3,WVar4,LVar5);
        }
        SetWindowTextA(param_1,&DAT_00409154);
        DAT_0040879c = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_00405200,(LPVOID)0x0,0,
                                    (LPDWORD)&DAT_00408798);
        if (DAT_0040879c != (HANDLE)0x0) {
          return 1;
        }
        FUN_004046c7(param_1,0x4b8,(char *)0x0,(char *)0x0,0x10,0);
      }
      else {
        if (param_2 != 0x111) {
          if (param_2 == 0xfa1) {
            TerminateThread(DAT_0040879c,0);
            EndDialog(param_1,param_3);
            return 1;
          }
          return 0;
        }
        if (param_3 != 2) {
          return 1;
        }
        ResetEvent(DAT_0040858c);
        iVar1 = FUN_004046c7(DAT_00408584,0x4b2,"",(char *)0x0,0x20,4);
        if ((iVar1 != 6) && (iVar1 != 1)) {
          SetEvent(DAT_0040858c);
          return 1;
        }
        DAT_004091d8 = 1;
        SetEvent(DAT_0040858c);
        FUN_00403866(DAT_0040879c);
      }
      goto LAB_00403851;
    }
    if (param_3 != 0x1b) {
      return 1;
    }
  }
  DAT_004091d8 = 1;
LAB_00403851:
  EndDialog(param_1,0);
  return 1;
}



/* Function: FUN_00403866 */

void __fastcall FUN_00403866(HANDLE param_1)

{
  bool bVar1;
  DWORD DVar2;
  BOOL BVar3;
  MSG local_24;
  HANDLE local_8;
  
  bVar1 = false;
  local_8 = param_1;
  do {
    DVar2 = MsgWaitForMultipleObjects(1,&local_8,0,0xffffffff,0x4ff);
    if (DVar2 == 0) {
      return;
    }
    while (BVar3 = PeekMessageA(&local_24,(HWND)0x0,0,0,1), BVar3 != 0) {
      if (local_24.message == 0x12) {
        bVar1 = true;
      }
      else {
        DispatchMessageA(&local_24);
      }
    }
  } while (!bVar1);
  return;
}



/* Function: FUN_004038c7 */

void __fastcall FUN_004038c7(int param_1)

{
  BOOL BVar1;
  char *pcVar2;
  uint uVar3;
  uint extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  uint extraout_EDX;
  char *extraout_EDX_00;
  undefined4 extraout_EDX_01;
  char *extraout_EDX_02;
  char *extraout_EDX_03;
  UINT UVar4;
  int iVar5;
  bool bVar6;
  bool bVar7;
  char *pcVar8;
  char *pcVar9;
  uint uVar10;
  char *local_1a8;
  char *local_1a4;
  _OSVERSIONINFOA local_1a0;
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  local_1a0.dwOSVersionInfoSize = 0x94;
  BVar1 = GetVersionExA(&local_1a0);
  if (BVar1 == 0) {
    UVar4 = 0x4b4;
LAB_0040392b:
    uVar10 = 0x10;
    pcVar8 = (char *)0x0;
    pcVar9 = (char *)0x0;
  }
  else {
    if (local_1a0.dwPlatformId == 1) {
      DAT_00409a40 = 0;
LAB_00403991:
      DAT_00408184 = 1;
      DAT_00408180 = 1;
    }
    else {
      if (local_1a0.dwPlatformId != 2) {
        UVar4 = 0x4ca;
        goto LAB_0040392b;
      }
      DAT_00409a40 = 2;
      DAT_00408184 = 1;
      DAT_00408180 = 1;
      if (local_1a0.dwMajorVersion < (char *)0x4) {
        DAT_00409a40 = 1;
        if ((local_1a0.dwMajorVersion < (char *)0x3) ||
           (((char *)local_1a0.dwMajorVersion == (char *)0x3 && (local_1a0.dwMinorVersion < 0x33))))
        {
          DAT_00408184 = 0;
          DAT_00408180 = 0;
        }
      }
      else if ((char *)0x4 < local_1a0.dwMajorVersion) {
        DAT_00409a40 = 3;
        goto LAB_00403991;
      }
    }
    if ((DAT_00408a34 != 0) || (param_1 == 0)) goto LAB_00403bfb;
    iVar5 = param_1 + ((DAT_00409a40 != 0) - 1 & 0x3c) + 4;
    local_1a8 = (char *)0x0;
    do {
      pcVar9 = local_1a8;
      local_1a4 = (char *)((int)local_1a8 * 0x18);
      pcVar2 = (char *)FUN_00402c04(local_1a0.dwMajorVersion,local_1a0.dwMinorVersion,
                                    *(uint *)(local_1a4 + iVar5),*(uint *)(local_1a4 + iVar5 + 4));
      pcVar8 = (char *)FUN_00402c04(extraout_ECX,extraout_EDX,*(uint *)(local_1a4 + iVar5 + 0xc),
                                    *(uint *)(local_1a4 + iVar5 + 0x10));
      if (((int)pcVar2 < 0) || (0 < (int)pcVar8)) {
        if (pcVar9 == (char *)0x1) goto LAB_00403a94;
      }
      else {
        if (pcVar2 == (char *)0x0) {
          if (pcVar8 == (char *)0x0) {
            pcVar8 = (char *)(local_1a0.dwBuildNumber & 0xffff);
            if (*(char **)(local_1a4 + iVar5 + 8) <= pcVar8) {
              bVar6 = pcVar8 < *(char **)(local_1a4 + iVar5 + 0x14);
              bVar7 = pcVar8 == *(char **)(local_1a4 + iVar5 + 0x14);
              goto LAB_00403a84;
            }
          }
          else {
            pcVar8 = local_1a4;
            if (*(uint *)(local_1a4 + iVar5 + 8) <= (local_1a0.dwBuildNumber & 0xffff)) break;
          }
        }
        else {
          if (pcVar8 != (char *)0x0) break;
          bVar6 = (local_1a0.dwBuildNumber & 0xffff) < *(uint *)(local_1a4 + iVar5 + 0x14);
          bVar7 = (local_1a0.dwBuildNumber & 0xffff) == *(uint *)(local_1a4 + iVar5 + 0x14);
          pcVar8 = local_1a4;
LAB_00403a84:
          if (bVar6 || bVar7) break;
        }
        if (pcVar9 != (char *)0x0) {
LAB_00403a94:
          local_1a8 = (char *)0x0;
          UVar4 = 0x54c;
          goto LAB_00403aa4;
        }
      }
      local_1a8 = pcVar9 + 1;
      pcVar8 = local_1a8;
      pcVar2 = local_1a8;
    } while ((int)local_1a8 < 2);
    local_1a0.dwMajorVersion = (DWORD)pcVar2;
    if ((*(int *)(param_1 + 0x7c) == 0) ||
       (iVar5 = FUN_00402a53(param_1,local_10c,pcVar8,(int *)&local_1a8),
       local_1a0.dwMajorVersion = (DWORD)extraout_EDX_00, iVar5 != 0)) goto LAB_00403bfb;
    iVar5 = (int)local_1a8 * 0x3c;
    UVar4 = 0x54d;
    local_1a8 = local_10c;
    iVar5 = param_1 + 0x84 + *(int *)(param_1 + 0x80) + iVar5;
LAB_00403aa4:
    uVar10 = 0;
    local_1a4 = (char *)0x0;
    if (iVar5 != 0) {
      local_1a4 = (char *)(param_1 + 0x84 + *(int *)(iVar5 + 0x34));
      if ((*(uint *)(iVar5 + 0x30) & 1) == 0) {
        uVar10 = -(uint)((*(uint *)(iVar5 + 0x30) & 2) != 0) & 0x101;
      }
      else {
        uVar10 = 0x104;
      }
    }
    if (((((byte)DAT_00408a38 & 1) == 0) && (local_1a4 != (char *)0x0)) && (*local_1a4 != '\0')) {
      MessageBeep(0);
      iVar5 = FUN_00406b0d(extraout_ECX_00,extraout_EDX_01);
      if ((iVar5 == 0) || (iVar5 = FUN_00406ab3(extraout_ECX_01), iVar5 == 0)) {
        uVar3 = 0x30;
      }
      else {
        uVar3 = 0x180030;
      }
      MessageBoxA((HWND)0x0,local_1a4,&DAT_00409154,uVar3 | uVar10);
      local_1a0.dwMajorVersion = (DWORD)extraout_EDX_02;
      goto LAB_00403bfb;
    }
    uVar10 = 0x30;
    pcVar8 = &DAT_00409154;
    pcVar9 = local_1a8;
  }
  FUN_004046c7((HWND)0x0,UVar4,pcVar8,pcVar9,uVar10,0);
  local_1a0.dwMajorVersion = (DWORD)extraout_EDX_03;
LAB_00403bfb:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,local_1a0.dwMajorVersion);
  return;
}



/* Function: FUN_00403c17 */

undefined4 FUN_00403c17(void)

{
  DWORD DVar1;
  int iVar2;
  INT_PTR IVar3;
  undefined4 extraout_ECX;
  
  DVar1 = FUN_004048a1("LICENSE",(void *)0x0,0);
  DAT_00408d4c = (LPCSTR)LocalAlloc(0x40,DVar1 + 1);
  if (DAT_00408d4c == (LPCSTR)0x0) {
    FUN_004046c7((HWND)0x0,0x4b5,(char *)0x0,(char *)0x0,0x10,0);
    DAT_00409124 = FUN_00406512();
  }
  else {
    DVar1 = FUN_004048a1("LICENSE",DAT_00408d4c,DVar1);
    if (DVar1 != 0) {
      iVar2 = lstrcmpA(DAT_00408d4c,"<None>");
      if (iVar2 == 0) {
        LocalFree(DAT_00408d4c);
      }
      else {
        IVar3 = FUN_004067bf(extraout_ECX,(LPCSTR)0x7d1,(HWND)0x0,FUN_004032c0,0,0);
        LocalFree(DAT_00408d4c);
        if (IVar3 == 0) {
          DAT_00409124 = 0x800704c7;
          return 0;
        }
      }
      DAT_00409124 = 0;
      return 1;
    }
    FUN_004046c7((HWND)0x0,0x4b1,(char *)0x0,(char *)0x0,0x10,0);
    LocalFree(DAT_00408d4c);
    DAT_00409124 = 0x80070714;
  }
  return 0;
}



/* Function: FUN_00403d04 */

undefined4 __fastcall FUN_00403d04(undefined4 param_1)

{
  uint uVar1;
  LPVOID pvVar2;
  int iVar3;
  
  uVar1 = 0;
  do {
    *(undefined4 *)((int)&DAT_00408d60 + uVar1) = 1;
    uVar1 = uVar1 + 0x18;
  } while (uVar1 < 0x3c0);
  if ((((byte)DAT_00408a38 & 1) == 0) && (((byte)DAT_00409a34 & 1) == 0)) {
    pvVar2 = (LPVOID)FUN_004067bf(param_1,(LPCSTR)(0x7d5 - (uint)(DAT_00408184 != 0)),(HWND)0x0,
                                  FUN_004036d0,0,0);
  }
  else {
    pvVar2 = FUN_00405200();
  }
  if (pvVar2 == (LPVOID)0x0) {
    DAT_00409124 = 0x8007042b;
  }
  else {
    iVar3 = FUN_0040652b(FUN_00406660);
    if (iVar3 != 0) {
      DAT_00409124 = 0;
      return 1;
    }
  }
  return 0;
}



/* Function: FUN_00403d86 */

/* WARNING: Removing unreachable block (ram,0x004040db) */

void FUN_00403d86(void)

{
  FARPROC pFVar1;
  DWORD DVar2;
  int iVar3;
  HMODULE hModule;
  int iVar4;
  undefined4 extraout_ECX;
  char *pcVar5;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 uVar6;
  undefined4 extraout_ECX_04;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 uVar7;
  undefined4 extraout_EDX_07;
  uint uVar8;
  int iVar9;
  undefined8 uVar10;
  undefined1 auStack_19c [4];
  char *local_198;
  FARPROC local_194;
  int local_190;
  uint local_18c;
  int local_188;
  int local_184;
  undefined4 uStack_180;
  undefined *puStack_17c;
  char *pcStack_178;
  undefined1 *puStack_174;
  CHAR *pCStack_170;
  short sStack_16c;
  uint uStack_168;
  undefined4 uStack_164;
  _STARTUPINFOA local_160;
  CHAR local_118 [268];
  uint local_c;
  
  local_c = DAT_00408004 ^ (uint)auStack_19c;
  DAT_00409124 = 0;
  local_188 = 0;
  local_184 = 0;
  if ((DAT_00408a28 == 0) &&
     ((DVar2 = FUN_004048a1("REBOOT",&DAT_00409a2c,4), DVar2 == 0 || (4 < DVar2)))) {
LAB_00403f00:
    FUN_004046c7((HWND)0x0,0x4b1,(char *)0x0,(char *)0x0,0x10,0);
    DAT_00409124 = 0x80070714;
    uVar7 = extraout_EDX_00;
  }
  else {
    local_18c = 0;
    iVar4 = 0;
    iVar9 = 0;
    do {
      uVar8 = local_18c;
      local_194 = (FARPROC)0x0;
      memset(&local_160,0,0x44);
      local_160.cb = 0x44;
      if (DAT_00408c42 == '\0') {
        DVar2 = FUN_004048a1("SHOWWINDOW",&local_190,4);
        if ((DVar2 == 0) || (4 < DVar2)) goto LAB_00403f00;
        if (local_190 == 1) {
          local_160.wShowWindow = 0;
LAB_00403e52:
          local_160.dwFlags = 1;
        }
        else {
          if (local_190 == 2) {
            local_160.wShowWindow = 6;
            goto LAB_00403e52;
          }
          if (local_190 == 3) {
            local_160.dwFlags = 1;
            local_160.wShowWindow = 3;
          }
        }
        if (uVar8 != 0) goto LAB_00403f3a;
        if (DAT_00408a38 == 0) {
LAB_00403eda:
          if ((iVar4 == 0) && (DVar2 = FUN_004048a1("RUNPROGRAM",local_118,0x104), DVar2 == 0))
          goto LAB_00403f00;
        }
        else {
          if ((DAT_00408a38 & 1) == 0) {
            uVar7 = extraout_EDX;
            if ((DAT_00408a38 & 2) == 0) goto LAB_0040413c;
            pcVar5 = "USRQCMD";
          }
          else {
            pcVar5 = "ADMQCMD";
          }
          DVar2 = FUN_004048a1(pcVar5,local_118,0x104);
          if (DVar2 == 0) goto LAB_00403f00;
          iVar3 = CompareStringA(0x7f,1,local_118,-1,"<None>",-1);
          if (iVar3 == 0) goto LAB_00403eda;
          local_188 = 1;
        }
      }
      else {
        FUN_00401846(local_118,0x104,extraout_ECX,0x408c42);
LAB_00403f3a:
        if (uVar8 == 1) {
          DVar2 = FUN_004048a1("POSTRUNPROGRAM",local_118,0x104);
          if (DVar2 == 0) goto LAB_00403f00;
          uVar6 = extraout_ECX_00;
          uVar7 = extraout_EDX_01;
          if ((DAT_00408c42 != '\0') ||
             (iVar4 = CompareStringA(0x7f,1,local_118,-1,"<None>",-1), uVar6 = extraout_ECX_01,
             uVar7 = extraout_EDX_02, iVar4 == 2)) break;
        }
      }
      uVar10 = FUN_00401bd3(local_118,&local_198,&local_194);
      pFVar1 = local_194;
      uVar7 = (undefined4)((ulonglong)uVar10 >> 0x20);
      if ((int)uVar10 == 0) goto LAB_0040413c;
      uVar6 = extraout_ECX_02;
      if (((iVar9 == 0) && (DAT_00409a40 != 1)) && (DAT_00408a20 != 0)) {
        if (local_194 == (FARPROC)0x0) {
          local_184 = 1;
          FUN_00402143();
          uVar6 = extraout_ECX_03;
          goto LAB_00403fd3;
        }
LAB_00403fdb:
        if (DAT_00408180 == 0) {
          FUN_004046c7((HWND)0x0,0x4c7,(char *)0x0,(char *)0x0,0x10,0);
          LocalFree(local_198);
          DAT_00409124 = 0x8007042b;
          uVar7 = extraout_EDX_06;
        }
        else {
          if ((pFVar1 == (FARPROC)0x0) || ((DAT_00409a34 & 4) == 0)) goto LAB_004040f8;
          hModule = (HMODULE)FUN_00406739(uVar6);
          if (hModule == (HMODULE)0x0) {
            FUN_004046c7((HWND)0x0,0x4c8,"advpack.dll",(char *)0x0,0x10,0);
          }
          else {
            local_194 = GetProcAddress(hModule,s_DoInfInstall_00408194);
            pcVar5 = local_198;
            if (local_194 != (FARPROC)0x0) {
              uStack_180 = 0;
              pCStack_170 = local_118;
              sStack_16c = DAT_00409a40;
              uStack_168 = (uint)DAT_00408a38;
              puStack_17c = &DAT_00409154;
              pcStack_178 = local_198;
              puStack_174 = &DAT_004091e4;
              if (DAT_00408a30 != 0) {
                uStack_168 = uStack_168 | 0x10000;
              }
              if ((DAT_00409a34 & 8) != 0) {
                uStack_168 = uStack_168 | 0x20000;
              }
              if ((DAT_00409a34 & 0x10) != 0) {
                uStack_168 = uStack_168 | 0x40000;
              }
              if ((DAT_00408d48 & 0x40) != 0) {
                uStack_168 = uStack_168 | 0x80000;
              }
              if ((char)DAT_00408d48 < '\0') {
                uStack_168 = uStack_168 | 0x100000;
              }
              uStack_164 = DAT_00409a38;
              (*(code *)PTR_guard_check_icall_0040a288)(&uStack_180);
              DAT_00409124 = (*local_194)();
              if ((int)DAT_00409124 < 0) {
                FreeLibrary(hModule);
                goto LAB_00404133;
              }
              FreeLibrary(hModule);
              uVar8 = local_18c;
              goto LAB_0040410b;
            }
            FUN_004046c7((HWND)0x0,0x4c9,s_DoInfInstall_00408194,(char *)0x0,0x10,0);
            FreeLibrary(hModule);
          }
          LocalFree(local_198);
          DAT_00409124 = FUN_00406512();
          uVar7 = extraout_EDX_05;
        }
        goto LAB_0040413c;
      }
LAB_00403fd3:
      if (pFVar1 != (FARPROC)0x0) goto LAB_00403fdb;
LAB_004040f8:
      pcVar5 = local_198;
      iVar4 = FUN_004041e2(local_198,&local_160);
      if (iVar4 == 0) {
LAB_00404133:
        LocalFree(pcVar5);
        uVar7 = extraout_EDX_04;
        goto LAB_0040413c;
      }
LAB_0040410b:
      LocalFree(pcVar5);
      local_18c = uVar8 + 1;
      uVar6 = extraout_ECX_04;
      uVar7 = extraout_EDX_03;
      iVar4 = local_188;
      iVar9 = local_184;
    } while (local_18c < 2);
    if (DAT_00408580 != 0) {
      FUN_00402371(uVar6,uVar7);
      uVar7 = extraout_EDX_07;
    }
  }
LAB_0040413c:
  FUN_00406ff0(local_c ^ (uint)auStack_19c,uVar7);
  return;
}



/* Function: FUN_004041e2 */

void __fastcall FUN_004041e2(char *param_1,LPSTARTUPINFOA param_2)

{
  BOOL BVar1;
  DWORD dwMessageId;
  LPSTARTUPINFOA extraout_EDX;
  LPSTARTUPINFOA extraout_EDX_00;
  DWORD dwLanguageId;
  CHAR *lpBuffer;
  DWORD nSize;
  va_list *Arguments;
  _PROCESS_INFORMATION local_220;
  uint local_210;
  CHAR local_20c [516];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  if (param_1 != (char *)0x0) {
    local_220.hProcess = (HANDLE)0x0;
    local_220.hThread = (HANDLE)0x0;
    local_220.dwProcessId = 0;
    local_220.dwThreadId = 0;
    BVar1 = CreateProcessA((LPCSTR)0x0,param_1,(LPSECURITY_ATTRIBUTES)0x0,(LPSECURITY_ATTRIBUTES)0x0
                           ,0,0x20,(LPVOID)0x0,(LPCSTR)0x0,param_2,&local_220);
    if (BVar1 == 0) {
      DAT_00409124 = FUN_00406512();
      Arguments = (va_list *)0x0;
      lpBuffer = local_20c;
      nSize = 0x200;
      dwLanguageId = 0;
      dwMessageId = GetLastError();
      FormatMessageA(0x1000,(LPCVOID)0x0,dwMessageId,dwLanguageId,lpBuffer,nSize,Arguments);
      FUN_004046c7((HWND)0x0,0x4c4,param_1,local_20c,0x10,0);
      param_2 = extraout_EDX_00;
    }
    else {
      WaitForSingleObject(local_220.hProcess,0xffffffff);
      GetExitCodeProcess(local_220.hProcess,&local_210);
      if ((((DAT_00408a28 == 0) && ((DAT_00409a2c & 1) != 0)) && ((DAT_00409a2c & 2) == 0)) &&
         ((local_210 & 0xff000000) == 0xaa000000)) {
        DAT_00409a2c = local_210;
      }
      FUN_00404312(local_210);
      CloseHandle(local_220.hThread);
      CloseHandle(local_220.hProcess);
      param_2 = extraout_EDX;
    }
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_00404312 */

void __fastcall FUN_00404312(uint param_1)

{
  int iVar1;
  
  if ((DAT_00409a34 & 0x800) != 0) {
    DAT_00409124 = param_1;
    return;
  }
  iVar1 = FUN_00401fb9();
  if ((iVar1 == 2) || (((param_1 & 0xff000000) == 0xaa000000 && ((param_1 & 1) != 0)))) {
    DAT_00409124 = 0xbc2;
  }
  else if ((DAT_00409a34 & 0x200) != 0) {
    DAT_00409124 = param_1;
    return;
  }
  return;
}



/* Function: FUN_00404366 */

void FUN_00404366(void)

{
  DWORD DVar1;
  LPCSTR lpString1;
  int iVar2;
  UINT UVar3;
  char *pcVar4;
  uint uVar5;
  
  DVar1 = FUN_004048a1("FINISHMSG",(void *)0x0,0);
  lpString1 = (LPCSTR)LocalAlloc(0x40,DVar1 * 4 + 4);
  if (lpString1 == (LPCSTR)0x0) {
    FUN_004046c7((HWND)0x0,0x4b5,(char *)0x0,(char *)0x0,0x10,0);
    return;
  }
  DVar1 = FUN_004048a1("FINISHMSG",lpString1,DVar1);
  if (DVar1 == 0) {
    uVar5 = 0x10;
    UVar3 = 0x4b1;
    pcVar4 = (char *)0x0;
  }
  else {
    iVar2 = lstrcmpA(lpString1,"<None>");
    if (iVar2 == 0) goto LAB_004043e3;
    uVar5 = 0x40;
    UVar3 = 0x3e9;
    pcVar4 = lpString1;
  }
  FUN_004046c7((HWND)0x0,UVar3,pcVar4,(char *)0x0,uVar5,0);
LAB_004043e3:
  LocalFree(lpString1);
  return;
}



/* Function: FUN_00404400 */

undefined4 FUN_00404400(HWND param_1,int param_2,undefined4 param_3,LPARAM param_4)

{
  if (param_2 == 1) {
    SendMessageA(param_1,0x466,1,param_4);
  }
  return 0;
}



/* Function: FUN_0040442a */

bool __fastcall FUN_0040442a(HWND param_1)

{
  code *pcVar1;
  char *pcVar2;
  HMODULE hModule;
  FARPROC pFVar3;
  FARPROC pFVar4;
  FARPROC pFVar5;
  LPSTR lpszCurrent;
  LPSTR pCVar6;
  int iVar7;
  LPCSTR lpszCurrent_00;
  UINT UVar8;
  
  hModule = LoadLibraryA(s_SHELL32_DLL_00408188);
  if (hModule == (HMODULE)0x0) {
    UVar8 = 0x4c2;
  }
  else {
    pFVar3 = GetProcAddress(hModule,s_SHBrowseForFolder_004081a4);
    if (((pFVar3 != (FARPROC)0x0) &&
        (pFVar4 = GetProcAddress(hModule,(LPCSTR)0xc3), pFVar4 != (FARPROC)0x0)) &&
       (pFVar5 = GetProcAddress(hModule,s_SHGetPathFromIDList_004081b8), pFVar5 != (FARPROC)0x0)) {
      if (DAT_004088c0 == '\0') {
        GetTempPathA(0x104,&DAT_004088c0);
        pcVar2 = &DAT_004088c0;
        do {
          lpszCurrent_00 = pcVar2;
          pcVar2 = lpszCurrent_00 + 1;
        } while (*lpszCurrent_00 != '\0');
        lpszCurrent = CharPrevA(&DAT_004088c0,lpszCurrent_00);
        if ((*lpszCurrent == '\\') &&
           (pCVar6 = CharPrevA(&DAT_004088c0,lpszCurrent), *pCVar6 != ':')) {
          *lpszCurrent = '\0';
        }
      }
      DAT_004087a0 = '\0';
      (*(code *)PTR_guard_check_icall_0040a288)();
      iVar7 = (*pFVar3)();
      if (&stack0xffffffc0 != &stack0xffffffbc) {
        pcVar1 = (code *)swi(0x29);
        iVar7 = (*pcVar1)();
      }
      if (iVar7 != 0) {
        (*(code *)PTR_guard_check_icall_0040a288)();
        (*pFVar5)();
        if (&stack0xffffffbc != &stack0xffffffb4) {
          pcVar1 = (code *)swi(0x29);
          (*pcVar1)();
        }
        if (DAT_004088c0 != '\0') {
          FUN_00401740(&DAT_004087a0,0x104,0x4088c0);
        }
        (*(code *)PTR_guard_check_icall_0040a288)(iVar7);
        (*pFVar4)();
        if (&stack0xffffffb4 != &stack0xffffffbc) {
          pcVar1 = (code *)swi(0x29);
          (*pcVar1)();
        }
      }
      FreeLibrary(hModule);
      return DAT_004087a0 != '\0';
    }
    FreeLibrary(hModule);
    UVar8 = 0x4c1;
  }
  FUN_004046c7(param_1,UVar8,(char *)0x0,(char *)0x0,0x10,0);
  return false;
}



/* Function: FUN_004045da */

void __fastcall FUN_004045da(HWND param_1,HWND param_2)

{
  int iVar1;
  int iVar2;
  HDC hdc;
  int iVar3;
  int iVar4;
  undefined4 extraout_EDX;
  int iVar5;
  int iVar6;
  int X;
  int iVar7;
  tagRECT local_28;
  tagRECT local_18;
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  GetWindowRect(param_1,&local_28);
  iVar1 = local_28.right - local_28.left;
  iVar5 = local_28.bottom - local_28.top;
  GetWindowRect(param_2,&local_18);
  iVar2 = local_18.bottom - local_18.top;
  iVar7 = local_18.right - local_18.left;
  hdc = GetDC(param_1);
  iVar3 = GetDeviceCaps(hdc,8);
  iVar4 = GetDeviceCaps(hdc,10);
  ReleaseDC(param_1,hdc);
  iVar6 = (iVar7 - iVar1) / 2 + local_18.left;
  iVar7 = 0;
  X = iVar7;
  if ((-1 < iVar6) && (X = iVar6, iVar3 < iVar6 + iVar1)) {
    X = iVar3 - iVar1;
  }
  iVar1 = (iVar2 - iVar5) / 2 + local_18.top;
  if ((-1 < iVar1) && (iVar7 = iVar1, iVar4 < iVar1 + iVar5)) {
    iVar7 = iVar4 - iVar5;
  }
  SetWindowPos(param_1,(HWND)0x0,X,iVar7,0,0,5);
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



/* Function: FUN_004046c7 */

void __fastcall
FUN_004046c7(HWND param_1,UINT param_2,char *param_3,char *param_4,uint param_5,uint param_6)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  UINT uType;
  char *lpText;
  uint uVar4;
  int iVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  char *pcVar6;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_EDX;
  UINT extraout_EDX_00;
  UINT extraout_EDX_01;
  UINT extraout_EDX_02;
  UINT extraout_EDX_03;
  undefined4 extraout_EDX_04;
  UINT extraout_EDX_05;
  CHAR *pCVar7;
  CHAR local_240 [512];
  CHAR local_40 [56];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  pcVar6 = "LoadString() Error.  Could not load string resource.";
  pCVar7 = local_40;
  for (iVar5 = 0xd; iVar5 != 0; iVar5 = iVar5 + -1) {
    *(undefined4 *)pCVar7 = *(undefined4 *)pcVar6;
    pcVar6 = pcVar6 + 4;
    pCVar7 = pCVar7 + 4;
  }
  *pCVar7 = *pcVar6;
  if (((byte)DAT_00408a38 & 1) != 0) goto LAB_0040488a;
  local_240[0] = '\0';
  LoadStringA(DAT_00409a3c,param_2,local_240,0x200);
  if (local_240[0] != '\0') {
    pcVar6 = local_240;
    pCVar7 = local_240 + 1;
    do {
      cVar3 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar3 != '\0');
    if (param_4 == (char *)0x0) {
      if (param_3 == (char *)0x0) {
        lpText = (char *)LocalAlloc(0x40,(SIZE_T)(pcVar6 + (1 - (int)pCVar7)));
        param_2 = extraout_EDX_03;
        if (lpText == (char *)0x0) goto LAB_0040488a;
        FUN_00401740(lpText,(uint)(pcVar6 + (1 - (int)pCVar7)),(int)local_240);
      }
      else {
        pcVar1 = param_3 + 1;
        do {
          cVar3 = *param_3;
          param_3 = param_3 + 1;
        } while (cVar3 != '\0');
        lpText = (char *)LocalAlloc(0x40,(SIZE_T)(pcVar6 + (int)(param_3 +
                                                                ((100 - (int)pcVar1) - (int)pCVar7))
                                                 ));
        param_2 = extraout_EDX_02;
        if (lpText == (char *)0x0) goto LAB_0040488a;
        FUN_004017e1(lpText,(uint)(pcVar6 + (int)(param_3 + ((100 - (int)pcVar1) - (int)pCVar7))),
                     local_240);
      }
    }
    else {
      pcVar1 = param_3 + 1;
      do {
        cVar3 = *param_3;
        param_3 = param_3 + 1;
      } while (cVar3 != '\0');
      pcVar2 = param_4 + 1;
      do {
        cVar3 = *param_4;
        param_4 = param_4 + 1;
      } while (cVar3 != '\0');
      lpText = (char *)LocalAlloc(0x40,(SIZE_T)(param_3 +
                                               (int)(param_4 +
                                                    (int)(pcVar6 + (-(int)pcVar2 - (int)pcVar1) +
                                                                   (100 - (int)pCVar7)))));
      param_2 = extraout_EDX_01;
      if (lpText == (char *)0x0) goto LAB_0040488a;
      FUN_004017e1(lpText,(uint)(param_3 +
                                (int)(param_4 +
                                     (int)(pcVar6 + (-(int)pcVar2 - (int)pcVar1) +
                                                    (100 - (int)pCVar7)))),local_240);
    }
    MessageBeep(param_5);
    iVar5 = FUN_00406b0d(extraout_ECX_01,extraout_EDX_04);
    if (iVar5 == 0) {
LAB_0040485c:
      uVar4 = 0x10000;
    }
    else {
      iVar5 = FUN_00406ab3(extraout_ECX_02);
      uVar4 = 0x190000;
      if (iVar5 == 0) goto LAB_0040485c;
    }
    MessageBoxA(param_1,lpText,&DAT_00409154,uVar4 | param_5 | param_6);
    LocalFree(lpText);
    param_2 = extraout_EDX_05;
    goto LAB_0040488a;
  }
  iVar5 = FUN_00406b0d(extraout_ECX,extraout_EDX);
  if (iVar5 == 0) {
LAB_0040474d:
    uType = 0x10010;
  }
  else {
    iVar5 = FUN_00406ab3(extraout_ECX_00);
    uType = 0x190010;
    if (iVar5 == 0) goto LAB_0040474d;
  }
  MessageBoxA(param_1,local_40,&DAT_00409154,uType);
  param_2 = extraout_EDX_00;
LAB_0040488a:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_004048a1 */

DWORD __fastcall FUN_004048a1(LPCSTR param_1,void *param_2,uint param_3)

{
  HRSRC pHVar1;
  DWORD _MaxCount;
  HGLOBAL hResData;
  LPVOID _Src;
  
  pHVar1 = FindResourceA((HMODULE)0x0,param_1,(LPCSTR)0xa);
  _MaxCount = SizeofResource((HMODULE)0x0,pHVar1);
  if ((_MaxCount <= param_3) && (param_2 != (void *)0x0)) {
    if (_MaxCount != 0) {
      pHVar1 = FindResourceA((HMODULE)0x0,param_1,(LPCSTR)0xa);
      hResData = LoadResource((HMODULE)0x0,pHVar1);
      _Src = LockResource(hResData);
      if (_Src != (LPVOID)0x0) {
        memcpy_s(param_2,param_3,_Src,_MaxCount);
        FreeResource(_Src);
        return _MaxCount;
      }
    }
    _MaxCount = 0;
  }
  return _MaxCount;
}



/* Function: FUN_0040491a */

undefined4 __thiscall FUN_0040491a(void *this,char *param_1,char *param_2)

{
  char cVar1;
  int iVar2;
  undefined4 uVar3;
  char *pcVar4;
  char *pcVar5;
  
  pcVar5 = param_1;
  do {
    cVar1 = *pcVar5;
    pcVar5 = pcVar5 + 1;
  } while (cVar1 != '\0');
  pcVar4 = param_2;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  if ((int)(pcVar4 + (int)(pcVar5 + ((1 - (int)(param_1 + 1)) - (int)(param_2 + 1)))) < 0x104) {
    FUN_00401740((char *)this,0x104,(int)param_1);
    pcVar5 = (char *)this;
    do {
      cVar1 = *pcVar5;
      pcVar5 = pcVar5 + 1;
    } while (cVar1 != '\0');
    if ((pcVar5 + (-1 - ((int)this + 1)))[(int)this] != '\\') {
      pcVar5 = (char *)this;
      do {
        cVar1 = *pcVar5;
        pcVar5 = pcVar5 + 1;
      } while (cVar1 != '\0');
      if ((pcVar5 + (-1 - ((int)this + 1)))[(int)this] != '/') {
        iVar2 = FUN_00401773((char *)this,0x104,0x40125c);
        if (iVar2 < 0) goto LAB_004049a8;
      }
    }
    FUN_00401773((char *)this,0x104,(int)param_2);
    uVar3 = 1;
  }
  else {
LAB_004049a8:
    uVar3 = 0;
  }
  return uVar3;
}



/* Function: FUN_004049b6 */

undefined4 __fastcall FUN_004049b6(LPCSTR param_1)

{
  uint uVar1;
  INT_PTR IVar2;
  undefined4 extraout_ECX;
  
  uVar1 = FUN_00406975(param_1);
  if (uVar1 != 0) {
    if (((DAT_004091dc == 0) && (((byte)DAT_00408a38 & 1) == 0)) &&
       (DAT_00409404 = param_1,
       IVar2 = FUN_004067bf(extraout_ECX,(LPCSTR)0x7d3,DAT_00408584,FUN_00403630,0,6), IVar2 != 6))
    {
      if (IVar2 == 7) {
        return 0;
      }
      if (IVar2 == 0x839) {
        DAT_004091dc = 1;
      }
    }
    SetFileAttributesA(param_1,0x80);
  }
  return 1;
}



/* Function: FUN_00404a2a */

undefined4 __fastcall FUN_00404a2a(char *param_1)

{
  char cVar1;
  undefined4 *hMem;
  char *pcVar2;
  char *pcVar3;
  
  hMem = (undefined4 *)LocalAlloc(0x40,8);
  if (hMem == (undefined4 *)0x0) {
    FUN_004046c7(DAT_00408584,0x4b5,(char *)0x0,(char *)0x0,0x10,0);
  }
  else {
    pcVar2 = param_1;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    pcVar2 = (char *)LocalAlloc(0x40,(SIZE_T)(pcVar2 + (1 - (int)(param_1 + 1))));
    *hMem = pcVar2;
    if (pcVar2 != (char *)0x0) {
      pcVar3 = param_1;
      do {
        cVar1 = *pcVar3;
        pcVar3 = pcVar3 + 1;
      } while (cVar1 != '\0');
      FUN_00401740(pcVar2,(uint)(pcVar3 + (1 - (int)(param_1 + 1))),(int)param_1);
      hMem[1] = DAT_004091e0;
      DAT_004091e0 = hMem;
      return 1;
    }
    FUN_004046c7(DAT_00408584,0x4b5,(char *)0x0,(char *)0x0,0x10,0);
    LocalFree(hMem);
  }
  return 0;
}



/* Function: FUN_00404aca */

HANDLE __fastcall FUN_00404aca(LPCSTR param_1,uint param_2)

{
  HANDLE pvVar1;
  DWORD dwCreationDisposition;
  DWORD dwDesiredAccess;
  
  if ((param_2 & 8) == 0) {
    dwDesiredAccess = (-(uint)((param_2 & 3) != 0) & 0xc0000000) + 0x80000000;
    if ((param_2 & 0x100) == 0) {
      dwCreationDisposition = (-(uint)((param_2 & 0x200) != 0) & 2) + 3;
    }
    else if ((param_2 & 0x400) == 0) {
      dwCreationDisposition = (-(uint)((param_2 & 0x200) != 0) & 0xfffffffe) + 4;
    }
    else {
      dwCreationDisposition = 1;
    }
    pvVar1 = CreateFileA(param_1,dwDesiredAccess,0,(LPSECURITY_ATTRIBUTES)0x0,dwCreationDisposition,
                         0x80,(HANDLE)0x0);
    if ((pvVar1 == (HANDLE)0xffffffff) && (dwCreationDisposition != 3)) {
      FUN_00404b71(param_1);
      pvVar1 = CreateFileA(param_1,dwDesiredAccess,0,(LPSECURITY_ATTRIBUTES)0x0,
                           dwCreationDisposition,0x80,(HANDLE)0x0);
    }
  }
  else {
    pvVar1 = (HANDLE)0xffffffff;
  }
  return pvVar1;
}



/* Function: FUN_00404b71 */

void __fastcall FUN_00404b71(LPCSTR param_1)

{
  char cVar1;
  char *lpsz;
  int iVar2;
  
  if (*param_1 != '\0') {
    cVar1 = param_1[1];
    iVar2 = 0;
    lpsz = param_1 + 2;
    if ((cVar1 == ':') && (*lpsz == '\\')) {
      lpsz = param_1 + 3;
    }
    else {
      if ((*param_1 != '\\') || (cVar1 != '\\')) {
        lpsz = param_1 + 1;
        goto LAB_00404bd2;
      }
      iVar2 = 2;
    }
    while( true ) {
      cVar1 = *lpsz;
LAB_00404bd2:
      if (cVar1 == '\0') break;
      if ((cVar1 == '\\') && (lpsz[-1] != ':')) {
        if (iVar2 == 0) {
          *lpsz = '\0';
          CreateDirectoryA(param_1,(LPSECURITY_ATTRIBUTES)0x0);
          *lpsz = '\\';
        }
        else {
          iVar2 = iVar2 + -1;
        }
      }
      lpsz = CharNextA(lpsz);
    }
  }
  return;
}



/* Function: FUN_00404be0 */

int __cdecl FUN_00404be0(LPCSTR param_1,uint param_2)

{
  undefined4 uVar1;
  int *piVar2;
  int iVar3;
  HANDLE pvVar4;
  int iVar5;
  
  piVar2 = &DAT_00408d60;
  iVar5 = 0;
  do {
    if (*piVar2 == 1) break;
    piVar2 = piVar2 + 6;
    iVar5 = iVar5 + 1;
  } while ((int)piVar2 < 0x409120);
  if (iVar5 == 0x28) {
    FUN_004046c7(DAT_00408584,0x4bb,(char *)0x0,(char *)0x0,0x10,0);
  }
  else {
    iVar3 = lstrcmpA(param_1,s__MEMCAB_004081cc);
    if (iVar3 != 0) {
      pvVar4 = FUN_00404aca(param_1,param_2);
      *(HANDLE *)(&DAT_00408d74 + iVar5 * 0x18) = pvVar4;
      if (pvVar4 != (HANDLE)0xffffffff) {
        (&DAT_00408d60)[iVar5 * 6] = 0;
        *(undefined4 *)(&DAT_00408d64 + iVar5 * 0x18) = 0;
        return iVar5;
      }
      return -1;
    }
    if ((param_2 & 0x10b) == 0) {
      iVar3 = iVar5 * 0x18;
      *(undefined4 *)(&DAT_00408d68 + iVar3) = DAT_00409140;
      uVar1 = DAT_00409144;
      (&DAT_00408d60)[iVar5 * 6] = 0;
      *(undefined4 *)(&DAT_00408d64 + iVar3) = 1;
      *(undefined4 *)(&DAT_00408d70 + iVar3) = uVar1;
      *(undefined4 *)(&DAT_00408d6c + iVar3) = 0;
      return iVar5;
    }
  }
  return -1;
}



/* Function: FUN_00404cb0 */

uint __cdecl FUN_00404cb0(int param_1,void *param_2,uint param_3)

{
  uint uVar1;
  BOOL BVar2;
  uint _Size;
  int iVar3;
  
  iVar3 = param_1 * 0x18;
  if (*(int *)(&DAT_00408d64 + iVar3) == 0) {
    BVar2 = ReadFile(*(HANDLE *)(&DAT_00408d74 + iVar3),param_2,param_3,&param_3,(LPOVERLAPPED)0x0);
    if (BVar2 != 0) {
      return param_3;
    }
  }
  else if (*(int *)(&DAT_00408d64 + iVar3) == 1) {
    uVar1 = *(int *)(&DAT_00408d70 + iVar3) - *(int *)(&DAT_00408d6c + iVar3);
    _Size = param_3;
    if (uVar1 <= param_3) {
      _Size = uVar1;
    }
    memcpy(param_2,(void *)(*(int *)(&DAT_00408d68 + iVar3) + *(int *)(&DAT_00408d6c + iVar3)),_Size
          );
    *(uint *)(&DAT_00408d6c + iVar3) = *(int *)(&DAT_00408d6c + iVar3) + _Size;
    return _Size;
  }
  return 0xffffffff;
}



/* Function: FUN_00404d30 */

DWORD __cdecl FUN_00404d30(int param_1,LPCVOID param_2,DWORD param_3)

{
  BOOL BVar1;
  DWORD DVar2;
  
  FUN_00403866(DAT_0040858c);
  if (DAT_004091d8 != 0) {
    return 0xffffffff;
  }
  BVar1 = WriteFile(*(HANDLE *)(&DAT_00408d74 + param_1 * 0x18),param_2,param_3,&param_3,
                    (LPOVERLAPPED)0x0);
  DVar2 = param_3;
  if (BVar1 == 0) {
    DVar2 = 0xffffffff;
  }
  else if (param_3 != 0xffffffff) {
    DAT_00409400 = DAT_00409400 + param_3;
    if ((DAT_00408184 != 0) && (DAT_00408584 != (HWND)0x0)) {
      SendDlgItemMessageA(DAT_00408584,0x83a,0x402,(uint)(DAT_00409400 * 100) / DAT_004093f8,0);
    }
  }
  return DVar2;
}



/* Function: FUN_00404dd0 */

undefined4 __cdecl FUN_00404dd0(int param_1)

{
  undefined4 uVar1;
  BOOL BVar2;
  int iVar3;
  
  iVar3 = param_1 * 0x18;
  if (*(int *)(&DAT_00408d64 + iVar3) == 1) {
    uVar1 = 0;
    (&DAT_00408d60)[param_1 * 6] = 1;
    *(undefined4 *)(&DAT_00408d68 + iVar3) = 0;
    *(undefined4 *)(&DAT_00408d70 + iVar3) = 0;
    *(undefined4 *)(&DAT_00408d6c + iVar3) = 0;
  }
  else {
    BVar2 = CloseHandle(*(HANDLE *)(&DAT_00408d74 + iVar3));
    if (BVar2 == 0) {
      uVar1 = 0xffffffff;
    }
    else {
      uVar1 = 0;
      (&DAT_00408d60)[param_1 * 6] = 1;
    }
  }
  return uVar1;
}



/* Function: FUN_00404e30 */

DWORD __cdecl FUN_00404e30(int param_1,DWORD param_2,int param_3)

{
  DWORD DVar1;
  int iVar2;
  
  iVar2 = param_1 * 0x18;
  DVar1 = 1;
  if (*(int *)(&DAT_00408d64 + iVar2) == 1) {
    if (param_3 != 0) {
      if (param_3 == 1) {
        param_2 = param_2 + *(int *)(&DAT_00408d6c + iVar2);
      }
      else {
        if (param_3 != 2) {
          return 0xffffffff;
        }
        param_2 = param_2 + *(int *)(&DAT_00408d70 + iVar2);
      }
    }
    *(DWORD *)(&DAT_00408d6c + iVar2) = param_2;
    return param_2;
  }
  if (param_3 == 0) {
    DVar1 = 0;
  }
  else if (param_3 != 1) {
    if (param_3 != 2) {
      return 0xffffffff;
    }
    DVar1 = 2;
  }
  DVar1 = SetFilePointer(*(HANDLE *)(&DAT_00408d74 + iVar2),param_2,(PLONG)0x0,DVar1);
  if (DVar1 == 0xffffffff) {
    return 0xffffffff;
  }
  return DVar1;
}



/* Function: FUN_00404ead */

bool __fastcall FUN_00404ead(int param_1,WORD param_2,WORD param_3)

{
  BOOL BVar1;
  _FILETIME local_14;
  _FILETIME local_c;
  
  if (((*(int *)(&DAT_00408d64 + param_1 * 0x18) != 1) &&
      (BVar1 = DosDateTimeToFileTime(param_2,param_3,&local_14), BVar1 != 0)) &&
     (BVar1 = LocalFileTimeToFileTime(&local_14,&local_c), BVar1 != 0)) {
    BVar1 = SetFileTime(*(HANDLE *)(&DAT_00408d74 + param_1 * 0x18),&local_c,&local_c,&local_c);
    return BVar1 != 0;
  }
  return false;
}



/* Function: FUN_00404f10 */

void __cdecl FUN_00404f10(SIZE_T param_1)

{
  GlobalAlloc(0,param_1);
  return;
}



/* Function: FUN_00404f30 */

void __cdecl FUN_00404f30(HGLOBAL param_1)

{
  GlobalFree(param_1);
  return;
}



/* Function: FUN_00404f50 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall FUN_00404f50(undefined4 param_1,undefined4 param_2,int param_3,int param_4)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  DWORD dwFileAttributes;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  if (DAT_004091d8 == 0) {
    if (param_3 == 0) {
      FUN_004050b7(param_4);
      param_2 = extraout_EDX_07;
    }
    else if (param_3 != 1) {
      if (param_3 == 2) {
        if (DAT_00408584 != (HWND)0x0) {
          SetDlgItemTextA(DAT_00408584,0x837,*(LPCSTR *)(param_4 + 4));
        }
        iVar2 = FUN_0040491a(local_10c,&DAT_004091e4,*(char **)(param_4 + 4));
        param_2 = extraout_EDX_03;
        if ((((iVar2 != 0) &&
             (iVar2 = FUN_004049b6(local_10c), param_2 = extraout_EDX_04, iVar2 != 0)) &&
            (iVar2 = FUN_00404be0(local_10c,0x8302), param_2 = extraout_EDX_05, iVar2 != -1)) &&
           (iVar2 = FUN_00404a2a(local_10c), param_2 = extraout_EDX_06, iVar2 != 0)) {
          _DAT_004093f4 = _DAT_004093f4 + 1;
        }
      }
      else if (((param_3 == 3) &&
               (iVar2 = FUN_0040491a(local_10c,&DAT_004091e4,*(char **)(param_4 + 4)),
               param_2 = extraout_EDX_00, iVar2 != 0)) &&
              (bVar1 = FUN_00404ead(*(int *)(param_4 + 0x14),*(WORD *)(param_4 + 0x18),
                                    *(WORD *)(param_4 + 0x1a)), param_2 = extraout_EDX_01,
              CONCAT31(extraout_var,bVar1) != 0)) {
        FUN_00404dd0(*(int *)(param_4 + 0x14));
        if (*(ushort *)(param_4 + 0x1c) == 0) {
          dwFileAttributes = 0x80;
        }
        else {
          dwFileAttributes = *(ushort *)(param_4 + 0x1c) & 0x27;
        }
        SetFileAttributesA(local_10c,dwFileAttributes);
        param_2 = extraout_EDX_02;
      }
    }
  }
  else if (param_3 == 3) {
    FUN_00404dd0(*(int *)(param_4 + 0x14));
    param_2 = extraout_EDX;
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_004050b7 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 __fastcall FUN_004050b7(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  
  puVar2 = &DAT_0040971c;
  puVar3 = &DAT_0040940c;
  for (iVar1 = 0xc4; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  FUN_00401740((char *)&DAT_0040971c,0x104,*(int *)(param_1 + 0xc));
  FUN_00401740(&DAT_00409820,0x104,*(int *)(param_1 + 4));
  FUN_00401740(&DAT_00409924,0x104,*(int *)(param_1 + 8));
  _DAT_00409a28 = *(undefined2 *)(param_1 + 0x1e);
  _DAT_00409a2a = *(undefined2 *)(param_1 + 0x20);
  return 0;
}



/* Function: FUN_00405121 */

void FUN_00405121(void)

{
  int iVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  int *piVar4;
  undefined8 uVar5;
  undefined1 local_2c [12];
  int local_20 [4];
  int local_10;
  int local_c;
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  piVar4 = local_20;
  for (iVar2 = 6; iVar2 != 0; iVar2 = iVar2 + -1) {
    *piVar4 = 0;
    piVar4 = piVar4 + 1;
  }
  uVar5 = Ordinal_20(FUN_00404f10,FUN_00404f30,FUN_00404be0,FUN_00404cb0,FUN_00404d30,FUN_00404dd0,
                     FUN_00404e30,1,local_2c);
  uVar3 = (undefined4)((ulonglong)uVar5 >> 0x20);
  iVar2 = (int)uVar5;
  if ((iVar2 != 0) &&
     (iVar1 = FUN_00404be0(s__MEMCAB_004081cc,0x8000), uVar3 = extraout_EDX, iVar1 != -1)) {
    uVar5 = Ordinal_21(iVar2,iVar1,local_20);
    uVar3 = (undefined4)((ulonglong)uVar5 >> 0x20);
    if ((((int)uVar5 != 0) && (((local_20[0] == DAT_00409144 && (local_10 == 0)) && (local_c == 0)))
        ) && (iVar1 = FUN_00404dd0(iVar1), uVar3 = extraout_EDX_00, iVar1 != -1)) {
      uVar5 = Ordinal_23(iVar2);
      uVar3 = (undefined4)((ulonglong)uVar5 >> 0x20);
    }
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



/* Function: FUN_00405200 */

LPVOID FUN_00405200(void)

{
  HRSRC hResInfo;
  HGLOBAL hResData;
  LPVOID wParam;
  HWND pHVar1;
  int iVar2;
  
  DAT_00409144 = FUN_004048a1("CABINET",(void *)0x0,0);
  hResInfo = FindResourceA((HMODULE)0x0,"CABINET",(LPCSTR)0xa);
  hResData = LoadResource((HMODULE)0x0,hResInfo);
  wParam = LockResource(hResData);
  DAT_00409140 = wParam;
  if (wParam != (LPVOID)0x0) {
    if (DAT_00408584 != (HWND)0x0) {
      iVar2 = 0;
      pHVar1 = GetDlgItem(DAT_00408584,0x842);
      ShowWindow(pHVar1,iVar2);
      iVar2 = 5;
      pHVar1 = GetDlgItem(DAT_00408584,0x841);
      ShowWindow(pHVar1,iVar2);
    }
    iVar2 = FUN_00405121();
    if (iVar2 == 0) {
      FUN_004046c7(DAT_00408584,0x4ba,(char *)0x0,(char *)0x0,0x10,0);
      wParam = (LPVOID)0x0;
    }
    else {
      iVar2 = Ordinal_20(FUN_00404f10,FUN_00404f30,FUN_00404be0,FUN_00404cb0,FUN_00404d30,
                         FUN_00404dd0,FUN_00404e30,1,&DAT_00409148);
      if ((iVar2 == 0) ||
         ((wParam = (LPVOID)Ordinal_22(iVar2,s__MEMCAB_004081cc,&DAT_00401158,0,FUN_00404f50,0,
                                       &DAT_00409140), wParam != (LPVOID)0x0 &&
          (iVar2 = Ordinal_23(iVar2), iVar2 == 0)))) {
        FUN_004046c7(DAT_00408584,DAT_00409148 + 0x514,(char *)0x0,(char *)0x0,0x10,0);
        wParam = (LPVOID)0x0;
      }
    }
    if (DAT_00409140 != (HGLOBAL)0x0) {
      FreeResource(DAT_00409140);
      DAT_00409140 = (HGLOBAL)0x0;
    }
    if ((wParam == (LPVOID)0x0) && (DAT_004091d8 == 0)) {
      FUN_004046c7((HWND)0x0,0x4f8,(char *)0x0,(char *)0x0,0x10,0);
    }
    if ((((byte)DAT_00408a38 & 1) == 0) && (((byte)DAT_00409a34 & 1) == 0)) {
      SendMessageA(DAT_00408584,0xfa1,(WPARAM)wParam,0);
    }
  }
  return wParam;
}



/* Function: FUN_0040538a */

undefined4 FUN_0040538a(void)

{
  DWORD DVar1;
  int iVar2;
  UINT UVar3;
  
  DVar1 = FUN_004048a1("FILESIZES",&DAT_004089e0,0x24);
  if (DVar1 == 0x24) {
    DAT_004093f8 = DAT_00408a00;
    if (DAT_00408a00 != 0) {
      FUN_004048a1("PACKINSTSPACE",&DAT_00409a38,4);
      iVar2 = FUN_0040652b(FUN_00406620);
      if (iVar2 == 0) {
        FUN_004046c7((HWND)0x0,0x4c6,(char *)0x0,(char *)0x0,0x10,0);
        return 0;
      }
      return 1;
    }
    UVar3 = 0x4c6;
  }
  else {
    UVar3 = 0x4b1;
  }
  FUN_004046c7((HWND)0x0,UVar3,(char *)0x0,(char *)0x0,0x10,0);
  DAT_00409124 = 0x80070714;
  return 0;
}



/* Function: FUN_00405411 */

undefined4 FUN_00405411(void)

{
  DWORD DVar1;
  LPCSTR lpString1;
  int iVar2;
  
  DVar1 = FUN_004048a1("UPROMPT",(void *)0x0,0);
  lpString1 = (LPCSTR)LocalAlloc(0x40,DVar1 + 1);
  if (lpString1 == (LPCSTR)0x0) {
    FUN_004046c7((HWND)0x0,0x4b5,(char *)0x0,(char *)0x0,0x10,0);
    DAT_00409124 = FUN_00406512();
  }
  else {
    DVar1 = FUN_004048a1("UPROMPT",lpString1,DVar1);
    if (DVar1 != 0) {
      iVar2 = lstrcmpA(lpString1,"<None>");
      if (iVar2 == 0) {
        LocalFree(lpString1);
      }
      else {
        iVar2 = FUN_004046c7((HWND)0x0,0x3e9,lpString1,(char *)0x0,0x20,4);
        LocalFree(lpString1);
        if (iVar2 != 6) {
          DAT_00409124 = 0x800704c7;
          return 0;
        }
        DAT_00409124 = 0;
      }
      return 1;
    }
    FUN_004046c7((HWND)0x0,0x4b1,(char *)0x0,(char *)0x0,0x10,0);
    LocalFree(lpString1);
    DAT_00409124 = 0x80070714;
  }
  return 0;
}



/* Function: FUN_004054e8 */

void __fastcall FUN_004054e8(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 *hMem;
  char local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  hMem = DAT_004091e0;
  if (DAT_004091e0 != (undefined4 *)0x0) {
    do {
      if ((DAT_00408a24 == 0) && (DAT_00409a30 == 0)) {
        SetFileAttributesA((LPCSTR)*hMem,0x80);
        DeleteFileA((LPCSTR)*hMem);
      }
      puVar1 = (undefined4 *)hMem[1];
      LocalFree((HLOCAL)*hMem);
      LocalFree(hMem);
      param_1 = extraout_ECX;
      param_2 = extraout_EDX;
      hMem = puVar1;
    } while (puVar1 != (undefined4 *)0x0);
  }
  if (((DAT_00408a20 != 0) && (DAT_00408a24 == 0)) && (DAT_00409a30 == 0)) {
    FUN_00401846(local_10c,0x104,param_1,0x4091e4);
    if (((byte)DAT_00409a34 & 0x20) != 0) {
      FUN_0040689a(local_10c);
    }
    SetCurrentDirectoryA("..");
    FUN_0040249e(local_10c,extraout_EDX_00);
    param_2 = extraout_EDX_01;
  }
  if ((DAT_00409a40 != 1) && (DAT_00408a20 != 0)) {
    FUN_004020f6();
    param_2 = extraout_EDX_02;
  }
  DAT_00408a20 = 0;
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_004055d7 */

void __fastcall FUN_004055d7(LPCSTR param_1,char *param_2)

{
  DWORD DVar1;
  UINT UVar2;
  BOOL BVar3;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar4;
  undefined4 extraout_EDX_01;
  int iVar5;
  char local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  iVar5 = 0;
  do {
    FUN_004017e1(local_10c,0x104,"IXP%03d.TMP");
    iVar5 = iVar5 + 1;
    FUN_00401740(param_2,0x104,(int)param_1);
    FUN_00406836(param_2,0x104,local_10c);
    RemoveDirectoryA(param_2);
    DVar1 = GetFileAttributesA(param_2);
    if (DVar1 == 0xffffffff) {
      BVar3 = CreateDirectoryA(param_2,(LPSECURITY_ATTRIBUTES)0x0);
      if (BVar3 != 0) {
        DAT_00408a20 = 1;
        uVar4 = extraout_EDX_01;
        goto LAB_00405681;
      }
      break;
    }
  } while (iVar5 < 400);
  UVar2 = GetTempFileNameA(param_1,"IXP",0,param_2);
  uVar4 = extraout_EDX;
  if (UVar2 != 0) {
    DeleteFileA(param_2);
    CreateDirectoryA(param_2,(LPSECURITY_ATTRIBUTES)0x0);
    uVar4 = extraout_EDX_00;
  }
LAB_00405681:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



/* Function: FUN_004056b2 */

void __fastcall FUN_004056b2(LPCSTR param_1,int param_2,uint param_3)

{
  int iVar1;
  BOOL BVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  undefined8 uVar4;
  char *pcVar5;
  _union_530 local_130 [9];
  char local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  if (param_2 == 0) {
    FUN_00401846(&DAT_004091e4,0x104,param_1,(int)param_1);
  }
  else {
    uVar4 = FUN_004055d7(param_1,local_10c);
    uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if ((int)uVar4 == 0) goto LAB_004057d6;
    FUN_00401846(&DAT_004091e4,0x104,extraout_ECX,(int)local_10c);
    if (((byte)DAT_00409a34 & 0x20) != 0) {
      GetSystemInfo((LPSYSTEM_INFO)&local_130[0].s);
      if (local_130[0].s.wProcessorArchitecture == 0) {
        pcVar5 = "i386";
      }
      else if (local_130[0].s.wProcessorArchitecture == 1) {
        pcVar5 = "mips";
      }
      else if (local_130[0].s.wProcessorArchitecture == 2) {
        pcVar5 = "alpha";
      }
      else {
        if (local_130[0].s.wProcessorArchitecture != 3) goto LAB_00405757;
        pcVar5 = "ppc";
      }
      FUN_00406836(&DAT_004091e4,0x104,pcVar5);
    }
LAB_00405757:
    FUN_00406836(&DAT_004091e4,0x104,"");
  }
  iVar1 = FUN_00405b19(&DAT_004091e4);
  if (iVar1 == 0) {
    BVar2 = CreateDirectoryA(&DAT_004091e4,(LPSECURITY_ATTRIBUTES)0x0);
    if (BVar2 == 0) {
      DAT_00409124 = FUN_00406512();
      uVar3 = extraout_EDX;
      goto LAB_004057d6;
    }
    DAT_00408a20 = 1;
  }
  uVar4 = FUN_00405bd2(&DAT_004091e4,param_3,0);
  uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
  if ((int)uVar4 == 0) {
    if (DAT_00408a20 != 0) {
      DAT_00408a20 = 0;
      RemoveDirectoryA(&DAT_004091e4);
      uVar3 = extraout_EDX_00;
    }
  }
  else {
    DAT_00409124 = 0;
  }
LAB_004057d6:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



/* Function: FUN_004057ed */

void FUN_004057ed(void)

{
  DWORD DVar1;
  LPCSTR lpString1;
  int iVar2;
  UINT UVar3;
  uint uVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 uVar5;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar6;
  undefined8 uVar7;
  char local_10c [3];
  undefined1 local_109;
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  DVar1 = FUN_004048a1("RUNPROGRAM",(void *)0x0,0);
  lpString1 = (LPCSTR)LocalAlloc(0x40,DVar1 + 1);
  if (lpString1 == (LPCSTR)0x0) {
    FUN_004046c7((HWND)0x0,0x4b5,(char *)0x0,(char *)0x0,0x10,0);
    DAT_00409124 = FUN_00406512();
    uVar6 = extraout_EDX;
  }
  else {
    DVar1 = FUN_004048a1("RUNPROGRAM",lpString1,DVar1);
    if (DVar1 == 0) {
      FUN_004046c7((HWND)0x0,0x4b1,(char *)0x0,(char *)0x0,0x10,0);
      LocalFree(lpString1);
      DAT_00409124 = 0x80070714;
      uVar6 = extraout_EDX_00;
    }
    else {
      iVar2 = lstrcmpA(lpString1,"<None>");
      if (iVar2 == 0) {
        DAT_00409a30 = 1;
      }
      LocalFree(lpString1);
      if (DAT_00408b3e == '\0') {
        if ((DAT_00408a24 == 0) && (DAT_00409a30 == 0)) {
          DVar1 = GetTempPathA(0x104,&DAT_004091e4);
          uVar5 = extraout_ECX_00;
          if (DVar1 != 0) {
            uVar7 = FUN_004056b2(&DAT_004091e4,1,3);
            uVar6 = (undefined4)((ulonglong)uVar7 >> 0x20);
            if ((int)uVar7 != 0) goto LAB_00405b04;
            iVar2 = FUN_0040277d();
            uVar5 = extraout_ECX_01;
            if (iVar2 == 0) {
              uVar7 = FUN_004056b2(&DAT_004091e4,1,1);
              uVar6 = (undefined4)((ulonglong)uVar7 >> 0x20);
              uVar5 = extraout_ECX_02;
              if ((int)uVar7 != 0) goto LAB_00405b04;
            }
          }
          do {
            FUN_00401846(local_10c,0x104,uVar5,0x4013bc);
            while (local_10c[0] < '[') {
              UVar3 = GetDriveTypeA(local_10c);
              if (((((UVar3 == 6) || (UVar3 == 3)) &&
                   (DVar1 = GetFileAttributesA(local_10c), DVar1 != 0xffffffff)) ||
                  (((UVar3 == 2 && (local_10c[0] != 'A')) &&
                   ((local_10c[0] != 'B' &&
                    ((uVar4 = FUN_00406c44(local_10c), uVar4 != 0 && (0x18fff < uVar4)))))))) &&
                 ((iVar2 = FUN_00405bd2(local_10c,3,0), iVar2 != 0 ||
                  ((iVar2 = FUN_0040277d(), iVar2 == 0 &&
                   (iVar2 = FUN_00405bd2(local_10c,1,0), iVar2 != 0)))))) {
                iVar2 = FUN_0040277d();
                if (iVar2 != 0) {
                  GetWindowsDirectoryA(local_10c,0x104);
                }
                FUN_00406836(local_10c,0x104,"msdownld.tmp");
                DVar1 = GetFileAttributesA(local_10c);
                if (DVar1 == 0xffffffff) {
                  uVar4 = CreateDirectoryA(local_10c,(LPSECURITY_ATTRIBUTES)0x0);
                }
                else {
                  uVar4 = DVar1 & 0x10;
                }
                if (uVar4 == 0) {
                  local_10c[0] = local_10c[0] + '\x01';
                  local_109 = 0;
                }
                else {
                  SetFileAttributesA(local_10c,2);
                  FUN_00401846(&DAT_004091e4,0x104,extraout_ECX_03,(int)local_10c);
                  uVar7 = FUN_004056b2(&DAT_004091e4,1,0);
                  uVar6 = (undefined4)((ulonglong)uVar7 >> 0x20);
                  if ((int)uVar7 != 0) goto LAB_00405b04;
                }
              }
              else {
                local_10c[0] = local_10c[0] + '\x01';
              }
            }
            GetWindowsDirectoryA(local_10c,0x104);
            uVar7 = FUN_00405bd2(local_10c,3,4);
            uVar6 = (undefined4)((ulonglong)uVar7 >> 0x20);
            uVar5 = extraout_ECX_04;
          } while ((int)uVar7 != 0);
        }
        else {
          FUN_004067bf(extraout_ECX,(LPCSTR)0x7d2,(HWND)0x0,FUN_004033e0,0,0);
          uVar6 = extraout_EDX_02;
        }
      }
      else {
        if ((DAT_00408b3e != '\\') || (uVar4 = 0, DAT_00408b3f != '\\')) {
          uVar4 = 1;
        }
        uVar7 = FUN_004056b2(&DAT_00408b3e,0,uVar4);
        uVar6 = (undefined4)((ulonglong)uVar7 >> 0x20);
        if ((int)uVar7 == 0) {
          FUN_004046c7((HWND)0x0,0x4be,(char *)0x0,(char *)0x0,0x10,0);
          uVar6 = extraout_EDX_01;
        }
      }
    }
  }
LAB_00405b04:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return;
}



/* Function: FUN_00405b19 */

undefined4 __fastcall FUN_00405b19(LPCSTR param_1)

{
  char *uBytes;
  char cVar1;
  char *lpFileName;
  HANDLE hObject;
  DWORD DVar2;
  LPCSTR pCVar3;
  
  pCVar3 = param_1;
  do {
    cVar1 = *pCVar3;
    pCVar3 = pCVar3 + 1;
  } while (cVar1 != '\0');
  uBytes = pCVar3 + (0x14 - (int)(param_1 + 1));
  lpFileName = (char *)LocalAlloc(0x40,(SIZE_T)uBytes);
  if (lpFileName == (char *)0x0) {
    FUN_004046c7((HWND)0x0,0x4b5,(char *)0x0,(char *)0x0,0x10,0);
  }
  else {
    FUN_00401740(lpFileName,(uint)uBytes,(int)param_1);
    FUN_00406836(lpFileName,(uint)uBytes,"TMP4351$.TMP");
    hObject = CreateFileA(lpFileName,0x40000000,0,(LPSECURITY_ATTRIBUTES)0x0,1,0x4000080,(HANDLE)0x0
                         );
    LocalFree(lpFileName);
    if (hObject != (HANDLE)0xffffffff) {
      CloseHandle(hObject);
      DVar2 = GetFileAttributesA(param_1);
      if ((DVar2 != 0xffffffff) && ((DVar2 & 0x10) != 0)) {
        DAT_00409124 = 0;
        return 1;
      }
    }
  }
  DAT_00409124 = FUN_00406512();
  return 0;
}



/* Function: FUN_00405bd2 */

void __fastcall FUN_00405bd2(LPCSTR param_1,uint param_2,int param_3)

{
  ushort uVar1;
  BOOL BVar2;
  uint uVar3;
  DWORD DVar4;
  char *pcVar5;
  uint uVar6;
  uint extraout_EDX;
  UINT UVar7;
  int iVar8;
  uint extraout_EDX_00;
  uint uVar9;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  int iVar10;
  bool bVar11;
  bool bVar12;
  DWORD DVar13;
  CHAR *pCVar14;
  DWORD DVar15;
  va_list *ppcVar16;
  DWORD local_334;
  uint local_330;
  int local_32c;
  uint local_328;
  DWORD local_324;
  DWORD local_320;
  DWORD local_31c [2];
  CHAR local_314 [512];
  CHAR local_114 [260];
  char local_10 [8];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  local_328 = param_2;
  if (param_2 == 0) {
    uVar9 = 0;
    goto LAB_00405e7a;
  }
  GetCurrentDirectoryA(0x104,local_114);
  BVar2 = SetCurrentDirectoryA(param_1);
  if (BVar2 == 0) {
    FUN_004046c7((HWND)0x0,0x4bc,(char *)0x0,(char *)0x0,0x10,0);
    DAT_00409124 = FUN_00406512();
    uVar9 = extraout_EDX;
    goto LAB_00405e7a;
  }
  local_320 = 0;
  local_31c[0] = 0;
  local_324 = 0;
  local_31c[1] = 0;
  BVar2 = GetDiskFreeSpaceA((LPCSTR)0x0,&local_320,local_31c,&local_324,local_31c + 1);
  if (BVar2 == 0) {
LAB_00405e15:
    memset(local_314,0,0x200);
    DAT_00409124 = FUN_00406512();
    ppcVar16 = (va_list *)0x0;
    pCVar14 = local_314;
    DVar15 = 0x200;
    DVar13 = 0;
    DVar4 = GetLastError();
    FormatMessageA(0x1000,(LPCVOID)0x0,DVar4,DVar13,pCVar14,DVar15,ppcVar16);
    UVar7 = 0x4b0;
  }
  else {
    local_32c = local_31c[0] * local_320;
    uVar3 = MulDiv(local_32c,local_324,0x400);
    if (uVar3 == 0) goto LAB_00405e15;
    BVar2 = GetVolumeInformationA
                      ((LPCSTR)0x0,(LPSTR)0x0,0,(LPDWORD)0x0,&local_334,&local_330,(LPSTR)0x0,0);
    if (BVar2 != 0) {
      SetCurrentDirectoryA(local_114);
      pcVar5 = local_10;
      iVar8 = 6;
      iVar10 = (int)param_1 - (int)pcVar5;
      do {
        if (iVar8 == 4) goto LAB_00405d48;
        if (pcVar5[iVar10] == '\0') break;
        *pcVar5 = pcVar5[iVar10];
        pcVar5 = pcVar5 + 1;
        iVar8 = iVar8 + -1;
      } while (iVar8 != 0);
      if (iVar8 == 0) {
        pcVar5 = pcVar5 + -1;
      }
LAB_00405d48:
      *pcVar5 = '\0';
      iVar8 = 0x200;
      uVar1 = 0;
      local_31c[1] = 8;
      do {
        if (local_32c == iVar8) goto LAB_00405d94;
        iVar8 = iVar8 * 2;
        uVar1 = uVar1 + 1;
      } while (uVar1 < 8);
      if (uVar1 == 8) {
        FUN_004046c7((HWND)0x0,0x4c5,(char *)0x0,(char *)0x0,0x10,0);
        uVar9 = extraout_EDX_00;
      }
      else {
LAB_00405d94:
        if ((((byte)DAT_00409a34 & 8) == 0) || ((local_330 & 0x8000) == 0)) {
          uVar9 = (&DAT_004089e0)[uVar1];
          uVar6 = DAT_00409a38;
        }
        else {
          uVar9 = (&DAT_004089e0)[uVar1] * 2;
          uVar6 = (DAT_00409a38 >> 2) + DAT_00409a38;
        }
        if (((byte)local_328 & 3) == 3) {
          bVar11 = uVar6 + uVar9 < uVar3;
          bVar12 = uVar6 + uVar9 == uVar3;
        }
        else if ((local_328 & 1) == 0) {
          bVar11 = uVar6 < uVar3;
          bVar12 = uVar6 == uVar3;
        }
        else {
          bVar11 = uVar9 < uVar3;
          bVar12 = uVar9 == uVar3;
        }
        if (bVar11 || bVar12) {
          DAT_00409124 = 0;
        }
        else {
          FUN_004027dc(param_3,uVar9,uVar6,local_10);
          uVar9 = extraout_EDX_01;
        }
      }
      goto LAB_00405e7a;
    }
    memset(local_314,0,0x200);
    DAT_00409124 = FUN_00406512();
    ppcVar16 = (va_list *)0x0;
    pCVar14 = local_314;
    DVar15 = 0x200;
    DVar13 = 0;
    DVar4 = GetLastError();
    FormatMessageA(0x1000,(LPCVOID)0x0,DVar4,DVar13,pCVar14,DVar15,ppcVar16);
    UVar7 = 0x4f9;
  }
  FUN_004046c7((HWND)0x0,UVar7,param_1,local_314,0x10,0);
  SetCurrentDirectoryA(local_114);
  uVar9 = extraout_EDX_02;
LAB_00405e7a:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar9);
  return;
}



/* Function: FUN_00405e8f */

undefined4 __fastcall FUN_00405e8f(char *param_1,int *param_2)

{
  char cVar1;
  undefined4 uVar2;
  char *pcVar3;
  char *pcVar4;
  int iVar5;
  
  iVar5 = 0;
  cVar1 = *param_1;
  while ((cVar1 != '\0' &&
         ((((cVar1 == ' ' || (cVar1 == '\t')) || (cVar1 == '\r')) ||
          (((cVar1 == '\n' || (cVar1 == '\v')) || (cVar1 == '\f'))))))) {
    iVar5 = iVar5 + 1;
    cVar1 = param_1[iVar5];
  }
  pcVar3 = param_1 + iVar5;
  if (*pcVar3 == '\0') {
    uVar2 = 0;
  }
  else {
    pcVar4 = pcVar3 + 1;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    pcVar3 = pcVar3 + (-1 - (int)pcVar4);
    if (-1 < (int)pcVar3) {
      pcVar4 = param_1 + (int)(pcVar3 + iVar5);
      do {
        cVar1 = *pcVar4;
        if (((cVar1 != ' ') && (cVar1 != '\t')) &&
           ((cVar1 != '\r' && (((cVar1 != '\n' && (cVar1 != '\v')) && (cVar1 != '\f')))))) break;
        pcVar4 = pcVar4 + -1;
        pcVar3 = pcVar3 + -1;
      } while (-1 < (int)pcVar3);
    }
    *param_2 = iVar5;
    param_1[(int)(pcVar3 + iVar5 + 1)] = '\0';
    uVar2 = 1;
  }
  return uVar2;
}



/* Function: FUN_00405f17 */

void __fastcall FUN_00405f17(char *param_1,short *param_2)

{
  code *pcVar1;
  short sVar2;
  char cVar3;
  int iVar4;
  DWORD DVar5;
  short *psVar6;
  LPSTR pCVar7;
  uint uVar8;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  short *extraout_EDX;
  short *extraout_EDX_00;
  short *extraout_EDX_01;
  short *extraout_EDX_02;
  short *extraout_EDX_03;
  short *extraout_EDX_04;
  short *extraout_EDX_05;
  short *extraout_EDX_06;
  short *extraout_EDX_07;
  short *extraout_EDX_08;
  short *extraout_EDX_09;
  short *extraout_EDX_10;
  short *extraout_EDX_11;
  short *extraout_EDX_12;
  int iVar9;
  char *pcVar10;
  int iVar11;
  int iVar12;
  byte *pbVar13;
  short *psVar14;
  int iVar15;
  int local_118;
  char *local_114;
  int local_110;
  char local_10c [3];
  undefined4 local_109;
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  iVar9 = 1;
  local_110 = 1;
  if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
    do {
      if (iVar9 == 0) break;
      while ((((cVar3 = *param_1, cVar3 == ' ' || (cVar3 == '\t')) || (cVar3 == '\r')) ||
             (((cVar3 == '\n' || (cVar3 == '\v')) || (cVar3 == '\f'))))) {
        param_1 = CharNextA(param_1);
        param_2 = extraout_EDX;
      }
      local_114 = param_1;
      if (cVar3 == '\0') break;
      uVar8 = 0;
      iVar15 = 0;
      param_2 = (short *)0x1;
      iVar11 = 0;
      do {
        if (iVar15 == 0) {
          cVar3 = *local_114;
          if (((cVar3 == ' ') || (cVar3 == '\t')) ||
             ((cVar3 == '\r' || (((cVar3 == '\n' || (cVar3 == '\v')) || (cVar3 == '\f')))))) break;
        }
        else if (iVar11 != 0) break;
        iVar12 = iVar11;
        if (*local_114 == '\"') {
          if (local_114[1] == '\"') {
            if ((short *)0x103 < param_2) goto LAB_0040648c;
            local_10c[uVar8] = '\"';
            uVar8 = uVar8 + 1;
            param_2 = (short *)((int)param_2 + 1);
            iVar4 = 2;
          }
          else {
            iVar4 = 1;
            iVar12 = iVar4;
            if (iVar15 == 0) {
              iVar12 = iVar11;
              iVar15 = iVar4;
            }
          }
        }
        else {
          if ((short *)0x103 < param_2) goto LAB_0040648c;
          local_10c[uVar8] = *local_114;
          uVar8 = uVar8 + 1;
          param_2 = (short *)((int)param_2 + 1);
          iVar4 = 1;
        }
        local_114 = local_114 + iVar4;
        iVar11 = iVar12;
      } while (*local_114 != '\0');
      if (0x103 < uVar8) {
        FUN_0040714a(uVar8,param_2);
        pcVar1 = (code *)swi(3);
        (*pcVar1)();
        return;
      }
      local_10c[uVar8] = '\0';
      if (iVar15 == 0) {
        if (iVar11 != 0) break;
      }
      else if (iVar11 == 0) break;
      if ((local_10c[0] != '/') && (local_10c[0] != '-')) goto LAB_0040648c;
      pCVar7 = CharUpperA((LPSTR)(int)local_10c[1]);
      cVar3 = (char)pCVar7;
      if (cVar3 == '?') {
        FUN_00401f9b();
        if (DAT_00408588 != (HANDLE)0x0) {
          CloseHandle(DAT_00408588);
        }
                    /* WARNING: Subroutine does not return */
        ExitProcess(0);
      }
      param_2 = extraout_EDX_02;
      iVar11 = local_110;
      if (cVar3 == 'C') {
        if (local_10c[2] == '\0') {
          DAT_00408a24 = 1;
        }
        else {
          if (local_10c[2] == ':') {
            uVar8 = (uint)((byte)local_109 == 0x22);
            psVar14 = (short *)((int)&local_109 + uVar8);
            param_2 = (short *)((int)&local_109 + uVar8 + 1);
            psVar6 = psVar14;
            do {
              sVar2 = *psVar6;
              psVar6 = (short *)((int)psVar6 + 1);
            } while ((char)sVar2 != '\0');
            if ((((psVar6 != param_2) &&
                 ((psVar6 = FUN_00406940(psVar14,0x5b), psVar6 == (short *)0x0 ||
                  (psVar6 = FUN_00406940(psVar14,0x5d), param_2 = extraout_EDX_09,
                  psVar6 != (short *)0x0)))) &&
                ((psVar6 = FUN_00406940(psVar14,0x5d), psVar6 == (short *)0x0 ||
                 (psVar6 = FUN_00406940(psVar14,0x5b), param_2 = extraout_EDX_10,
                 psVar6 != (short *)0x0)))) &&
               (local_118 = uVar8 + 3, iVar9 = FUN_00405e8f((char *)psVar14,&local_118),
               param_2 = extraout_EDX_11, iVar9 != 0)) {
              FUN_00401846(&DAT_00408c42,0x104,extraout_ECX_00,
                           (int)&local_109 + local_118 + uVar8 + 3 + -3);
              param_2 = extraout_EDX_12;
              iVar9 = local_110;
              iVar11 = local_110;
              goto LAB_0040610b;
            }
          }
LAB_00406103:
          iVar9 = 0;
          iVar11 = iVar9;
        }
      }
      else if (cVar3 == 'D') {
LAB_004062d5:
        iVar9 = 0;
        iVar11 = iVar9;
        if (local_10c[2] == ':') {
          uVar8 = (uint)((byte)local_109 == 0x22);
          param_2 = (short *)((int)&local_109 + uVar8 + 1);
          psVar6 = (short *)((int)&local_109 + uVar8);
          do {
            sVar2 = *psVar6;
            psVar6 = (short *)((int)psVar6 + 1);
          } while ((char)sVar2 != '\0');
          if ((psVar6 == param_2) ||
             (local_118 = uVar8 + 3,
             iVar9 = FUN_00405e8f((char *)((int)&local_109 + uVar8),&local_118),
             param_2 = extraout_EDX_07, iVar9 == 0)) goto LAB_00406103;
          pCVar7 = CharUpperA((LPSTR)(int)local_10c[1]);
          if ((char)pCVar7 == 'T') {
            pcVar10 = &DAT_00408b3e;
          }
          else {
            pcVar10 = &DAT_00408a3a;
          }
          FUN_00401846(pcVar10,0x104,extraout_ECX,(int)&local_109 + local_118 + uVar8 + 3 + -3);
          FUN_00406836(pcVar10,0x104,"");
          iVar15 = FUN_004033a6(pcVar10);
          param_2 = extraout_EDX_08;
          iVar9 = local_110;
          iVar11 = local_110;
          if (iVar15 == 0) goto LAB_0040648c;
        }
      }
      else if (cVar3 == 'N') {
        if (local_10c[2] == '\0') {
          DAT_00408a2c = 1;
        }
        else {
          if (local_10c[2] != ':') goto LAB_00406103;
          if ((byte)local_109 != 0) {
            pbVar13 = (byte *)&local_109;
            uVar8 = local_109;
            do {
              pbVar13 = pbVar13 + 1;
              pCVar7 = CharUpperA((LPSTR)(int)(char)uVar8);
              cVar3 = (char)pCVar7;
              if (cVar3 == 'E') {
                DAT_00408a2c = 1;
              }
              else if (cVar3 == 'G') {
                DAT_00408a30 = 1;
              }
              else if (cVar3 == 'V') {
                DAT_00408a34 = 1;
              }
              else {
                iVar9 = 0;
              }
              uVar8 = (uint)*pbVar13;
              param_2 = extraout_EDX_06;
              iVar11 = iVar9;
            } while (*pbVar13 != 0);
          }
        }
      }
      else if (cVar3 == 'Q') {
        if (local_10c[2] != '\0') {
          if (local_10c[2] != ':') goto LAB_00406103;
          pCVar7 = CharUpperA((LPSTR)(int)(char)(byte)local_109);
          cVar3 = (char)pCVar7;
          param_2 = extraout_EDX_05;
          if (cVar3 != '1') {
            if (cVar3 == 'A') {
              DAT_00408a38 = 1;
              iVar11 = local_110;
              goto LAB_0040610b;
            }
            if (cVar3 != 'U') goto LAB_00406103;
          }
        }
        DAT_00408a38 = 2;
        iVar11 = local_110;
      }
      else {
        if (cVar3 != 'R') {
          if (cVar3 == 'T') goto LAB_004062d5;
          goto LAB_00406103;
        }
        if (local_10c[2] == '\0') {
          DAT_00409a2c = 3;
          DAT_00408a28 = 1;
        }
        else if (local_10c[2] == ':') {
          DAT_00409a2c = 1;
          if ((byte)local_109 != 0) {
            pbVar13 = (byte *)&local_109;
            uVar8 = local_109;
            do {
              pbVar13 = pbVar13 + 1;
              pCVar7 = CharUpperA((LPSTR)(int)(char)uVar8);
              cVar3 = (char)pCVar7;
              if (cVar3 == 'A') {
                DAT_00409a2c = DAT_00409a2c | 2;
                goto LAB_004061cc;
              }
              if (cVar3 == 'D') {
                DAT_00408d48 = DAT_00408d48 | 0x40;
                goto LAB_004061d2;
              }
              if (cVar3 == 'I') {
                DAT_00409a2c = DAT_00409a2c & 0xfffffffd;
LAB_004061cc:
                DAT_00408a28 = 1;
              }
              else {
                if (cVar3 == 'N') {
                  DAT_00409a2c = DAT_00409a2c & 0xfffffffe;
                  goto LAB_004061cc;
                }
                if (cVar3 == 'P') {
                  DAT_00408d48 = DAT_00408d48 | 0x80;
                }
                else {
                  if (cVar3 == 'S') {
                    DAT_00409a2c = DAT_00409a2c | 4;
                    goto LAB_004061cc;
                  }
                  iVar9 = 0;
                }
              }
LAB_004061d2:
              uVar8 = (uint)*pbVar13;
              param_2 = extraout_EDX_03;
              iVar11 = iVar9;
            } while (*pbVar13 != 0);
          }
        }
        else {
          iVar15 = CompareStringA(0x7f,1,"RegServer",-1,local_10c + 1,-1);
          param_2 = extraout_EDX_04;
          iVar11 = local_110;
          if (iVar15 != 2) goto LAB_00406103;
        }
      }
LAB_0040610b:
      local_110 = iVar11;
      param_1 = local_114;
    } while (*local_114 != '\0');
    if (((DAT_00408a2c != 0) && (DAT_00408b3e == '\0')) &&
       (DVar5 = GetModuleFileNameA(DAT_00409a3c,&DAT_00408b3e,0x104), param_2 = extraout_EDX_00,
       DVar5 != 0)) {
      psVar6 = FUN_00406995((short *)&DAT_00408b3e,0x5c);
      *(undefined1 *)((int)psVar6 + 1) = 0;
      param_2 = extraout_EDX_01;
    }
  }
LAB_0040648c:
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_004064a7 */

void FUN_004064a7(void)

{
  UINT UVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  UVar1 = GetWindowsDirectoryA(local_10c,0x104);
  if (UVar1 == 0) {
    FUN_004046c7((HWND)0x0,0x4f0,(char *)0x0,(char *)0x0,0x10,0);
    DAT_00409124 = FUN_00406512();
    uVar2 = extraout_EDX;
  }
  else {
    FUN_00405bd2(local_10c,2,2);
    uVar2 = extraout_EDX_00;
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



/* Function: FUN_00406512 */

DWORD FUN_00406512(void)

{
  DWORD DVar1;
  
  DVar1 = GetLastError();
  if (0 < (int)DVar1) {
    DVar1 = DVar1 & 0xffff | 0x80070000;
  }
  return DVar1;
}



/* Function: FUN_0040652b */

/* WARNING: Removing unreachable block (ram,0x004065a2) */

void __fastcall FUN_0040652b(undefined *param_1)

{
  char *pcVar1;
  char cVar2;
  HGLOBAL hResData;
  undefined4 *hResData_00;
  int iVar3;
  HRSRC hResInfo;
  char *pcVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar5;
  char local_1c [20];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  FUN_004017e1(local_1c,0x14,"UPDFILE%lu");
  do {
    hResInfo = FindResourceA((HMODULE)0x0,local_1c,(LPCSTR)0xa);
    uVar5 = extraout_EDX_00;
    if (hResInfo == (HRSRC)0x0) {
LAB_004065fe:
      FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar5);
      return;
    }
    hResData = LoadResource((HMODULE)0x0,hResInfo);
    hResData_00 = (undefined4 *)LockResource(hResData);
    if (hResData_00 == (undefined4 *)0x0) {
      DAT_00409124 = 0x80070714;
      uVar5 = extraout_EDX;
      goto LAB_004065fe;
    }
    pcVar1 = (char *)(hResData_00 + 2);
    pcVar4 = pcVar1;
    do {
      cVar2 = *pcVar4;
      pcVar4 = pcVar4 + 1;
    } while (cVar2 != '\0');
    (*(code *)PTR_guard_check_icall_0040a288)
              (*hResData_00,hResData_00[1],pcVar1,
               pcVar1 + (int)(pcVar4 + (1 - ((int)hResData_00 + 9))));
    iVar3 = (*(code *)param_1)();
    if (iVar3 == 0) {
      FreeResource(hResData_00);
      uVar5 = extraout_EDX_01;
      goto LAB_004065fe;
    }
    FreeResource(hResData_00);
    FUN_004017e1(local_1c,0x14,"UPDFILE%lu");
  } while( true );
}



/* Function: FUN_00406620 */

undefined4 FUN_00406620(uint param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  
  uVar4 = 0x200;
  uVar2 = 0;
  do {
    uVar3 = param_1 % uVar4;
    uVar1 = -(uint)(uVar3 != 0) & uVar4;
    uVar4 = uVar4 * 2;
    *(int *)((int)&DAT_004089e0 + uVar2) =
         *(int *)((int)&DAT_004089e0 + uVar2) + (uVar1 - uVar3) + param_1;
    uVar2 = uVar2 + 4;
  } while (uVar2 < 0x20);
  return 1;
}



/* Function: FUN_00406660 */

void __thiscall
FUN_00406660(void *this,DWORD param_1,undefined4 param_2,char *param_3,LPCVOID param_4)

{
  HANDLE hFile;
  BOOL BVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  DWORD local_110;
  char local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  local_110 = 0;
  FUN_00401846(local_10c,0x104,this,0x4091e4);
  FUN_00406836(local_10c,0x104,param_3);
  hFile = CreateFileA(local_10c,0x40000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,(HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffff) {
    DAT_00409124 = 0x80070052;
    uVar2 = extraout_EDX;
  }
  else {
    BVar1 = WriteFile(hFile,param_4,param_1,&local_110,(LPOVERLAPPED)0x0);
    if ((BVar1 == 0) || (param_1 != local_110)) {
      DAT_00409124 = 0x80070052;
    }
    CloseHandle(hFile);
    uVar2 = extraout_EDX_00;
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



/* Function: FUN_00406739 */

void __fastcall FUN_00406739(undefined4 param_1)

{
  DWORD DVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  char local_10c [260];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  FUN_00401846(local_10c,0x104,param_1,0x4091e4);
  FUN_00406836(local_10c,0x104,"advpack.dll");
  DVar1 = GetFileAttributesA(local_10c);
  if ((DVar1 == 0xffffffff) || ((DVar1 & 0x10) != 0)) {
    LoadLibraryA("advpack.dll");
    uVar2 = extraout_EDX_00;
  }
  else {
    LoadLibraryExA(local_10c,(HANDLE)0x0,8);
    uVar2 = extraout_EDX;
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



/* Function: FUN_004067bf */

INT_PTR __fastcall
FUN_004067bf(undefined4 param_1,LPCSTR param_2,HWND param_3,DLGPROC param_4,int param_5,
            INT_PTR param_6)

{
  HMODULE hModule;
  HRSRC hResInfo;
  LPCDLGTEMPLATEA hDialogTemplate;
  INT_PTR IVar1;
  
  hModule = DAT_00409a3c;
  hResInfo = FindResourceA(DAT_00409a3c,param_2,(LPCSTR)0x5);
  if ((hResInfo != (HRSRC)0x0) &&
     (hDialogTemplate = (LPCDLGTEMPLATEA)LoadResource(hModule,hResInfo),
     hDialogTemplate != (LPCDLGTEMPLATEA)0x0)) {
    if (param_5 == 0) {
      param_5 = 0;
    }
    IVar1 = DialogBoxIndirectParamA(hModule,hDialogTemplate,param_3,param_4,param_5);
    FreeResource(hDialogTemplate);
    if (IVar1 != -1) {
      return IVar1;
    }
  }
  FUN_004046c7((HWND)0x0,0x4fb,(char *)0x0,(char *)0x0,0x10,0);
  return param_6;
}



/* Function: FUN_00406836 */

int __fastcall FUN_00406836(char *param_1,uint param_2,char *param_3)

{
  char cVar1;
  int iVar2;
  LPSTR pCVar3;
  char *pcVar4;
  LPCSTR lpszCurrent;
  
  pcVar4 = param_1;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  if (((int)pcVar4 - (int)(param_1 + 1)) + 1U < param_2) {
    lpszCurrent = param_1 + ((int)pcVar4 - (int)(param_1 + 1));
    if (param_1 < lpszCurrent) {
      pCVar3 = CharPrevA(param_1,lpszCurrent);
      if (*pCVar3 != '\\') {
        *lpszCurrent = '\\';
        lpszCurrent = lpszCurrent + 1;
      }
    }
    *lpszCurrent = '\0';
    for (; *param_3 == ' '; param_3 = param_3 + 1) {
    }
    iVar2 = FUN_00401773(param_1,param_2,(int)param_3);
  }
  else {
    iVar2 = -0x7ff8ff86;
  }
  return iVar2;
}



/* Function: FUN_0040689a */

undefined4 __fastcall FUN_0040689a(LPCSTR param_1)

{
  char cVar1;
  LPSTR lpszCurrent;
  LPSTR pCVar2;
  LPCSTR pCVar3;
  
  pCVar3 = param_1;
  do {
    cVar1 = *pCVar3;
    pCVar3 = pCVar3 + 1;
  } while (cVar1 != '\0');
  lpszCurrent = CharPrevA(param_1,param_1 + ((int)pCVar3 - (int)(param_1 + 1)));
  do {
    lpszCurrent = CharPrevA(param_1,lpszCurrent);
    if (lpszCurrent <= param_1) {
      if (*lpszCurrent != '\\') {
        return 0;
      }
      if (lpszCurrent == param_1) goto LAB_004068ea;
      break;
    }
  } while (*lpszCurrent != '\\');
  pCVar2 = CharPrevA(param_1,lpszCurrent);
  if (*pCVar2 == ':') {
LAB_004068ea:
    lpszCurrent = CharNextA(lpszCurrent);
  }
  *lpszCurrent = '\0';
  return 1;
}



/* Function: FUN_00406905 */

bool __fastcall FUN_00406905(short param_1,short param_2)

{
  BOOL BVar1;
  bool bVar2;
  
  if ((BYTE)param_1 == (BYTE)param_2) {
    BVar1 = IsDBCSLeadByte((BYTE)param_1);
    if (BVar1 == 0) {
      bVar2 = false;
    }
    else {
      bVar2 = param_1 != param_2;
    }
  }
  else {
    bVar2 = true;
  }
  return bVar2;
}



/* Function: FUN_00406940 */

short * __fastcall FUN_00406940(short *param_1,short param_2)

{
  bool bVar1;
  undefined3 extraout_var;
  
  while( true ) {
    if ((char)*param_1 == '\0') {
      return (short *)0x0;
    }
    bVar1 = FUN_00406905(*param_1,param_2);
    if (CONCAT31(extraout_var,bVar1) == 0) break;
    param_1 = (short *)CharNextA((LPCSTR)param_1);
  }
  return param_1;
}



/* Function: FUN_00406975 */

uint __fastcall FUN_00406975(LPCSTR param_1)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesA(param_1);
  if (DVar1 == 0xffffffff) {
    return 0;
  }
  return ~(DVar1 >> 4) & 1;
}



/* Function: FUN_00406995 */

short * __fastcall FUN_00406995(short *param_1,short param_2)

{
  bool bVar1;
  undefined3 extraout_var;
  short *psVar2;
  
  psVar2 = (short *)0x0;
  for (; (char)*param_1 != '\0'; param_1 = (short *)CharNextA((LPCSTR)param_1)) {
    bVar1 = FUN_00406905(*param_1,param_2);
    if (CONCAT31(extraout_var,bVar1) == 0) {
      psVar2 = param_1;
    }
  }
  return psVar2;
}



/* Function: FUN_004069cc */

bool __fastcall FUN_004069cc(LPCSTR param_1,int *param_2)

{
  LPCSTR lpsz;
  char cVar1;
  int iVar2;
  
  iVar2 = 0;
  lpsz = param_1;
  do {
    cVar1 = *lpsz;
    if ((byte)(cVar1 - 0x30U) < 10) {
      iVar2 = (iVar2 + -3) * 0x10 + (int)cVar1;
    }
    else {
      if ('`' < cVar1) {
        cVar1 = cVar1 + -0x20;
      }
      if (5 < (int)cVar1 - 0x41U) {
        *param_2 = iVar2;
        return lpsz != param_1;
      }
      iVar2 = iVar2 * 0x10 + -0x37 + (int)cVar1;
    }
    lpsz = CharNextA(lpsz);
  } while( true );
}



/* Function: FUN_00406a40 */

undefined4
FUN_00406a40(undefined4 param_1,int param_2,undefined4 param_3,ushort param_4,ushort *param_5)

{
  undefined4 uVar1;
  
  uVar1 = 1;
  if ((param_2 == *(int *)(param_5 + 4)) && (*param_5 == (param_4 & 0x3ff))) {
    param_5[2] = 1;
    param_5[3] = 0;
    uVar1 = 0;
    *param_5 = param_4;
  }
  return uVar1;
}



/* Function: FUN_00406a79 */

undefined4 __thiscall FUN_00406a79(void *this,undefined4 param_1,undefined2 param_2)

{
  undefined2 local_10 [2];
  undefined4 local_c;
  undefined4 local_8;
  
  local_c = 0;
  local_10[0] = param_2;
  local_8 = 0x10;
  EnumResourceLanguagesA((HMODULE)this,(LPCSTR)0x10,(LPCSTR)0x1,FUN_00406a40,(LONG_PTR)local_10);
  return local_c;
}



/* Function: FUN_00406ab3 */

int __fastcall FUN_00406ab3(undefined4 param_1)

{
  void *this;
  int iVar1;
  undefined4 extraout_ECX;
  
  this = DAT_00409a3c;
  if (DAT_004081d4 == -2) {
    DAT_004081d4 = 0;
    iVar1 = FUN_00406a79(DAT_00409a3c,param_1,1);
    if ((iVar1 != 0) || (iVar1 = FUN_00406a79(this,extraout_ECX,0xd), iVar1 != 0)) {
      DAT_004081d4 = 1;
    }
  }
  return DAT_004081d4;
}



/* Function: FUN_00406b0d */

void __fastcall FUN_00406b0d(undefined4 param_1,undefined4 param_2)

{
  bool bVar1;
  BOOL BVar2;
  int iVar3;
  LSTATUS LVar4;
  undefined3 extraout_var;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  DWORD local_b8 [2];
  uint local_b0;
  HKEY local_ac;
  _OSVERSIONINFOA local_a8;
  BYTE local_14 [12];
  uint local_8;
  
  local_8 = DAT_00408004 ^ (uint)&stack0xfffffffc;
  local_b8[1] = 0xc;
  local_b0 = 0;
  if (DAT_004081d8 == -2) {
    DAT_004081d8 = 0;
    local_a8.dwOSVersionInfoSize = 0x94;
    BVar2 = GetVersionExA(&local_a8);
    param_2 = extraout_EDX;
    if (((((BVar2 != 0) && (local_a8.dwPlatformId == 1)) && (local_a8.dwMajorVersion == 4)) &&
        ((local_a8.dwMinorVersion < 10 &&
         (iVar3 = GetSystemMetrics(0x4a), param_2 = extraout_EDX_00, iVar3 != 0)))) &&
       (LVar4 = RegOpenKeyExA((HKEY)0x80000001,"Control Panel\\Desktop\\ResourceLocale",0,0x20019,
                              &local_ac), param_2 = extraout_EDX_01, LVar4 == 0)) {
      LVar4 = RegQueryValueExA(local_ac,"",(LPDWORD)0x0,local_b8,local_14,local_b8 + 1);
      RegCloseKey(local_ac);
      param_2 = extraout_EDX_02;
      if (((LVar4 == 0) &&
          (bVar1 = FUN_004069cc((LPCSTR)local_14,(int *)&local_b0), param_2 = extraout_EDX_03,
          CONCAT31(extraout_var,bVar1) != 0)) &&
         (((local_b0 & 0x3ff) == 1 || ((local_b0 & 0x3ff) == 0xd)))) {
        DAT_004081d8 = 1;
      }
    }
  }
  FUN_00406ff0(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



/* Function: FUN_00406c44 */

int __fastcall FUN_00406c44(LPCSTR param_1)

{
  BOOL BVar1;
  int iVar2;
  DWORD local_14;
  DWORD local_10;
  DWORD local_c;
  DWORD local_8;
  
  iVar2 = 0;
  local_c = 0;
  local_8 = 0;
  local_14 = 0;
  local_10 = 0;
  if (*param_1 != '\0') {
    BVar1 = GetDiskFreeSpaceA(param_1,&local_c,&local_8,&local_14,&local_10);
    if (BVar1 != 0) {
      iVar2 = MulDiv(local_8 * local_c,local_10,0x400);
    }
  }
  return iVar2;
}



/* Function: FUN_00406ca0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_00406ca0(void)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  undefined4 *puVar3;
  
  bVar1 = FUN_00406f7c();
  DAT_004081f8 = CONCAT31(extraout_var,bVar1);
  iVar2 = FUN_004072fa(2);
  __set_app_type(iVar2);
  _DAT_004088a4 = 0xffffffff;
  _DAT_004088a8 = 0xffffffff;
  puVar3 = (undefined4 *)__p__fmode();
  *puVar3 = DAT_00408528;
  puVar3 = (undefined4 *)__p__commode();
  *puVar3 = DAT_0040851c;
  FUN_00407350();
  if (DAT_00408000 == 0) {
    __setusermatherr(FUN_00407350);
  }
  FUN_00407557();
  return 0;
}



/* Function: FUN_00406d10 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00406d10(void)

{
  _DAT_004081fc = DAT_00408524;
  _DAT_004081f4 =
       __getmainargs((int *)&DAT_004081e8,(char ***)&DAT_004081ec,(char ***)&DAT_004081f0,
                     DAT_00408520,(_startupinfo *)&DAT_004081fc);
  return;
}



/* Function: entry */

/* WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4 */

int entry(void)

{
  bool bVar1;
  code *pcVar2;
  int iVar3;
  int iVar4;
  BOOL BVar5;
  uint uVar6;
  int iVar7;
  byte bVar8;
  byte *pbVar9;
  _STARTUPINFOW local_6c;
  uint local_24;
  byte *local_20;
  void *local_14;
  undefined4 uStack_c;
  undefined *local_8;
  
  FUN_004074b9();
  local_8 = &DAT_00407640;
  uStack_c = 0x406d6c;
  local_24 = 0;
  GetStartupInfoW(&local_6c);
  local_8 = (undefined *)0x0;
  iVar7 = *(int *)((int)Self + 4);
  bVar1 = false;
  while( true ) {
    iVar4 = 0;
    LOCK();
    iVar3 = iVar7;
    if (DAT_004088ac != 0) {
      iVar4 = DAT_004088ac;
      iVar3 = DAT_004088ac;
    }
    DAT_004088ac = iVar3;
    UNLOCK();
    if (iVar4 == 0) goto LAB_00406db5;
    if (iVar4 == iVar7) break;
    Sleep(1000);
  }
  bVar1 = true;
LAB_00406db5:
  if (DAT_004088b0 == 1) {
    _amsg_exit(0x1f);
  }
  else if (DAT_004088b0 == 0) {
    DAT_004088b0 = 1;
    iVar7 = FUN_00406f45((undefined4 *)&DAT_004010d4,(undefined4 *)&DAT_004010e0);
    if (iVar7 != 0) {
      ExceptionList = local_14;
      return 0xff;
    }
  }
  else {
    DAT_004081e4 = 1;
  }
  if (DAT_004088b0 == 1) {
    initterm(&DAT_004010c8,&DAT_004010d0);
    DAT_004088b0 = 2;
  }
  if (!bVar1) {
    LOCK();
    DAT_004088ac = 0;
    UNLOCK();
  }
  if ((DAT_004088b4 != (code *)0x0) &&
     (BVar5 = __IsNonwritableInCurrentImage((PBYTE)&DAT_004088b4), pcVar2 = DAT_004088b4, BVar5 != 0
     )) {
    (*(code *)PTR_guard_check_icall_0040a288)(0,2,0);
    (*pcVar2)();
  }
  pbVar9 = *(byte **)_acmdln_exref;
  uVar6 = local_24;
  do {
    bVar8 = *pbVar9;
    local_20 = pbVar9;
    if (bVar8 < 0x21) {
      if (bVar8 == 0) goto LAB_00406e8a;
      if (uVar6 == 0) {
        while ((bVar8 != 0 && (bVar8 < 0x21))) {
          local_20 = local_20 + 1;
          bVar8 = *local_20;
        }
LAB_00406e8a:
        DAT_004081e0 = FUN_00402da4((HMODULE)&IMAGE_DOS_HEADER_00400000,0,(char *)local_20);
        if (DAT_004081f8 != 0) {
          if (DAT_004081e4 == 0) {
            _cexit();
          }
          ExceptionList = local_14;
          return DAT_004081e0;
        }
                    /* WARNING: Subroutine does not return */
        exit(DAT_004081e0);
      }
    }
    if (bVar8 == 0x22) {
      uVar6 = (uint)(uVar6 == 0);
      local_24 = uVar6;
    }
    iVar7 = _ismbblead((uint)bVar8);
    if (iVar7 != 0) {
      pbVar9 = pbVar9 + 1;
    }
    pbVar9 = pbVar9 + 1;
  } while( true );
}



/* Function: FUN_00406f45 */

void __cdecl FUN_00406f45(undefined4 *param_1,undefined4 *param_2)

{
  code *pcVar1;
  int iVar2;
  
  iVar2 = 0;
  if (param_1 < param_2) {
    do {
      if (iVar2 != 0) {
        return;
      }
      pcVar1 = (code *)*param_1;
      if (pcVar1 != (code *)0x0) {
        (*(code *)PTR_guard_check_icall_0040a288)();
        iVar2 = (*pcVar1)();
      }
      param_1 = param_1 + 1;
    } while (param_1 < param_2);
  }
  return;
}



/* Function: FUN_00406f7c */

bool FUN_00406f7c(void)

{
  short sVar1;
  int iVar2;
  
  if ((IMAGE_DOS_HEADER_00400000.e_magic != (char  [2])0x5a4d) ||
     (*(int *)(IMAGE_DOS_HEADER_00400000.e_lfanew + 0x400000) != 0x4550)) {
    return false;
  }
  sVar1 = *(short *)((int)IMAGE_DOS_HEADER_00400000.e_res_4_ +
                    (IMAGE_DOS_HEADER_00400000.e_lfanew - 4));
  if (sVar1 == 0x10b) {
    if (*(uint *)(IMAGE_DOS_HEADER_00400000.e_program + IMAGE_DOS_HEADER_00400000.e_lfanew + 0x34) <
        0xf) {
      return false;
    }
    iVar2 = *(int *)(IMAGE_NT_HEADERS32_004000e8.Signature + IMAGE_DOS_HEADER_00400000.e_lfanew);
  }
  else {
    if (sVar1 != 0x20b) {
      return false;
    }
    if (*(uint *)(&UNK_00400080.field_0x4 + IMAGE_DOS_HEADER_00400000.e_lfanew) < 0xf) {
      return false;
    }
    iVar2 = *(int *)((int)(IMAGE_NT_HEADERS32_004000e8.OptionalHeader.DataDirectory + -0xd) +
                    IMAGE_DOS_HEADER_00400000.e_lfanew);
  }
  return iVar2 != 0;
}



/* Function: FUN_00406ff0 */

void __fastcall FUN_00406ff0(int param_1,undefined4 param_2)

{
  if (param_1 == DAT_00408004) {
    return;
  }
  FUN_00407036(param_1,param_2);
  return;
}



/* Function: FUN_00407006 */

void __cdecl FUN_00407006(_EXCEPTION_POINTERS *param_1)

{
  HANDLE hProcess;
  UINT uExitCode;
  
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
  UnhandledExceptionFilter(param_1);
  uExitCode = 0xc0000409;
  hProcess = GetCurrentProcess();
  TerminateProcess(hProcess,uExitCode);
  return;
}



/* Function: FUN_00407036 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall FUN_00407036(undefined4 param_1,undefined4 param_2)

{
  undefined4 in_EAX;
  undefined4 unaff_EBX;
  undefined4 unaff_EBP;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined2 in_ES;
  undefined2 in_CS;
  undefined2 in_SS;
  undefined2 in_DS;
  undefined2 in_FS;
  undefined2 in_GS;
  byte in_AF;
  byte in_TF;
  byte in_IF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  undefined4 unaff_retaddr;
  undefined1 local_328 [796];
  undefined4 uStack_c;
  undefined4 uStack_8;
  
  _DAT_00408310 =
       (uint)(in_NT & 1) * 0x4000 | (uint)SBORROW4((int)&stack0xfffffffc,0x324) * 0x800 |
       (uint)(in_IF & 1) * 0x200 | (uint)(in_TF & 1) * 0x100 | (uint)((int)local_328 < 0) * 0x80 |
       (uint)(&stack0x00000000 == (undefined1 *)0x328) * 0x40 | (uint)(in_AF & 1) * 0x10 |
       (uint)((POPCOUNT((uint)local_328 & 0xff) & 1U) == 0) * 4 |
       (uint)(&stack0xfffffffc < (undefined1 *)0x324) | (uint)(in_ID & 1) * 0x200000 |
       (uint)(in_VIP & 1) * 0x100000 | (uint)(in_VIF & 1) * 0x80000 | (uint)(in_AC & 1) * 0x40000;
  _DAT_00408314 = &stack0x00000004;
  _DAT_00408250 = 0x10001;
  _DAT_00408200 = 0xc0000409;
  _DAT_00408204 = 1;
  _DAT_00408210 = 3;
  DAT_00408214 = 2;
  DAT_00408218 = DAT_00408004;
  DAT_0040821c = _DAT_00408008;
  uStack_c = DAT_00408004;
  uStack_8 = _DAT_00408008;
  _DAT_0040820c = unaff_retaddr;
  _DAT_004082dc = in_GS;
  _DAT_004082e0 = in_FS;
  _DAT_004082e4 = in_ES;
  _DAT_004082e8 = in_DS;
  _DAT_004082ec = unaff_EDI;
  _DAT_004082f0 = unaff_ESI;
  _DAT_004082f4 = unaff_EBX;
  _DAT_004082f8 = param_2;
  _DAT_004082fc = param_1;
  _DAT_00408300 = in_EAX;
  _DAT_00408304 = unaff_EBP;
  DAT_00408308 = unaff_retaddr;
  _DAT_0040830c = in_CS;
  _DAT_00408318 = in_SS;
  FUN_00407006((_EXCEPTION_POINTERS *)&PTR_DAT_00401000);
  return;
}



/* Function: FUN_0040714a */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall FUN_0040714a(undefined4 param_1,undefined4 param_2)

{
  undefined4 in_EAX;
  undefined4 unaff_EBX;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined2 in_ES;
  undefined2 in_CS;
  undefined2 in_SS;
  undefined2 in_DS;
  undefined2 in_FS;
  undefined2 in_GS;
  byte in_CF;
  byte in_PF;
  byte in_AF;
  byte in_ZF;
  byte in_SF;
  byte in_TF;
  byte in_IF;
  byte in_OF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  undefined4 unaff_retaddr;
  
  _DAT_00408310 =
       (uint)(in_NT & 1) * 0x4000 | (uint)(in_OF & 1) * 0x800 | (uint)(in_IF & 1) * 0x200 |
       (uint)(in_TF & 1) * 0x100 | (uint)(in_SF & 1) * 0x80 | (uint)(in_ZF & 1) * 0x40 |
       (uint)(in_AF & 1) * 0x10 | (uint)(in_PF & 1) * 4 | (uint)(in_CF & 1) |
       (uint)(in_ID & 1) * 0x200000 | (uint)(in_VIP & 1) * 0x100000 | (uint)(in_VIF & 1) * 0x80000 |
       (uint)(in_AC & 1) * 0x40000;
  _DAT_00408250 = 0x10001;
  _DAT_00408314 = &stack0x00000004;
  _DAT_00408200 = 0xc0000409;
  _DAT_00408204 = 1;
  _DAT_00408210 = 1;
  DAT_00408214 = 8;
  _DAT_0040820c = unaff_retaddr;
  _DAT_004082dc = in_GS;
  _DAT_004082e0 = in_FS;
  _DAT_004082e4 = in_ES;
  _DAT_004082e8 = in_DS;
  _DAT_004082ec = unaff_EDI;
  _DAT_004082f0 = unaff_ESI;
  _DAT_004082f4 = unaff_EBX;
  _DAT_004082f8 = param_2;
  _DAT_004082fc = param_1;
  _DAT_00408300 = in_EAX;
  DAT_00408308 = unaff_retaddr;
  _DAT_0040830c = in_CS;
  _DAT_00408318 = in_SS;
  FUN_00407006((_EXCEPTION_POINTERS *)&PTR_DAT_00401000);
  return;
}



/* Function: FUN_00407210 */

undefined4 FUN_00407210(int *param_1)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)*param_1;
  if (((*piVar1 == -0x1f928c9d) && (piVar1[4] == 3)) &&
     ((iVar2 = piVar1[5], iVar2 == 0x19930520 ||
      (((iVar2 == 0x19930521 || (iVar2 == 0x19930522)) || (iVar2 == 0x1994000)))))) {
    terminate();
  }
  return 0;
}



/* Function: FUN_00407260 */

undefined4 FUN_00407260(void)

{
  SetUnhandledExceptionFilter(FUN_00407210);
  return 0;
}



/* Function: FUN_00407280 */

/* WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4 */

uint FUN_00407280(short *param_1)

{
  uint uVar1;
  uint uVar2;
  void *local_14;
  
  uVar2 = 0;
  if ((((param_1 != (short *)0x0) && (param_1 != (short *)0xffffffff)) && (*param_1 == 0x5a4d)) &&
     ((uVar1 = *(uint *)(param_1 + 0x1e), -1 < (int)uVar1 && (uVar1 < 0x10000000)))) {
    uVar2 = ~-(uint)(*(int *)((int)param_1 + uVar1) != 0x4550) & (int)param_1 + uVar1;
  }
  ExceptionList = local_14;
  return uVar2;
}



/* Function: FUN_004072fa */

undefined4 __cdecl FUN_004072fa(undefined4 param_1)

{
  HMODULE pHVar1;
  uint uVar2;
  undefined4 uVar3;
  
  pHVar1 = GetModuleHandleW((LPCWSTR)0x0);
  uVar3 = param_1;
  if ((pHVar1 != (HMODULE)0x0) && (uVar2 = FUN_00407280((short *)pHVar1), uVar2 != 0)) {
    uVar3 = 2;
    if ((*(short *)(uVar2 + 0x5c) != 2) && (uVar3 = param_1, *(short *)(uVar2 + 0x5c) == 3)) {
      return 1;
    }
  }
  return uVar3;
}



/* Function: _amsg_exit */

void __cdecl _amsg_exit(int param_1)

{
                    /* WARNING: Could not recover jumptable at 0x00407336. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  _amsg_exit(param_1);
  return;
}



/* Function: FUN_00407350 */

undefined4 FUN_00407350(void)

{
  return 0;
}



/* Function: __FindPESection */

/* Library Function - Single Match
    __FindPESection
   
   Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

PIMAGE_SECTION_HEADER __cdecl __FindPESection(PBYTE pImageBase,DWORD_PTR rva)

{
  int iVar1;
  PIMAGE_SECTION_HEADER p_Var2;
  uint uVar3;
  
  uVar3 = 0;
  iVar1 = *(int *)(pImageBase + 0x3c);
  p_Var2 = (PIMAGE_SECTION_HEADER)
           (pImageBase + *(ushort *)(pImageBase + iVar1 + 0x14) + 0x18 + iVar1);
  if (*(ushort *)(pImageBase + iVar1 + 6) != 0) {
    do {
      if ((p_Var2->VirtualAddress <= rva) &&
         (rva < (p_Var2->Misc).PhysicalAddress + p_Var2->VirtualAddress)) {
        return p_Var2;
      }
      uVar3 = uVar3 + 1;
      p_Var2 = p_Var2 + 1;
    } while (uVar3 < *(ushort *)(pImageBase + iVar1 + 6));
  }
  return (PIMAGE_SECTION_HEADER)0x0;
}



/* Function: __IsNonwritableInCurrentImage */

/* Library Function - Single Match
    __IsNonwritableInCurrentImage
   
   Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

BOOL __cdecl __IsNonwritableInCurrentImage(PBYTE pTarget)

{
  bool bVar1;
  undefined3 extraout_var;
  PIMAGE_SECTION_HEADER p_Var2;
  void *local_14;
  code *pcStack_10;
  uint local_c;
  undefined4 local_8;
  
  pcStack_10 = FUN_004075e0;
  local_14 = ExceptionList;
  local_c = DAT_00408004 ^ 0x407680;
  ExceptionList = &local_14;
  local_8 = 0;
  bVar1 = FUN_00407480((short *)&IMAGE_DOS_HEADER_00400000);
  if (CONCAT31(extraout_var,bVar1) != 0) {
    p_Var2 = __FindPESection((PBYTE)&IMAGE_DOS_HEADER_00400000,(DWORD_PTR)(pTarget + -0x400000));
    if (p_Var2 != (PIMAGE_SECTION_HEADER)0x0) {
      ExceptionList = local_14;
      return ~(p_Var2->Characteristics >> 0x1f) & 1;
    }
  }
  ExceptionList = local_14;
  return 0;
}



/* Function: FUN_00407480 */

bool __cdecl FUN_00407480(short *param_1)

{
  if ((*param_1 == 0x5a4d) && (*(int *)(*(int *)(param_1 + 0x1e) + (int)param_1) == 0x4550)) {
    return (short)((int *)(*(int *)(param_1 + 0x1e) + (int)param_1))[6] == 0x10b;
  }
  return false;
}



/* Function: FUN_004074b9 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_004074b9(void)

{
  uint uVar1;
  DWORD DVar2;
  LARGE_INTEGER local_18;
  _FILETIME local_10;
  uint local_8;
  
  local_10.dwLowDateTime = 0;
  local_10.dwHighDateTime = 0;
  if ((DAT_00408004 == 0xbb40e64e) || ((DAT_00408004 & 0xffff0000) == 0)) {
    GetSystemTimeAsFileTime(&local_10);
    local_8 = local_10.dwHighDateTime ^ local_10.dwLowDateTime;
    DVar2 = GetCurrentProcessId();
    local_8 = local_8 ^ DVar2;
    DVar2 = GetCurrentThreadId();
    local_8 = local_8 ^ DVar2;
    DVar2 = GetTickCount();
    local_8 = DVar2 ^ local_8 ^ (uint)&local_8;
    QueryPerformanceCounter(&local_18);
    local_8 = local_18.s.HighPart ^ local_18.s.LowPart ^ local_8;
    if ((local_8 == 0xbb40e64e) ||
       (uVar1 = DAT_00408004 & 0xffff0000, DAT_00408004 = local_8, uVar1 == 0)) {
      DAT_00408004 = 0xbb40e64f;
    }
  }
  _DAT_00408008 = ~DAT_00408004;
  return;
}



/* Function: FUN_00407557 */

void FUN_00407557(void)

{
  _controlfp(0x10000,0x30000);
  return;
}



/* Function: initterm */

void __cdecl initterm(void)

{
                    /* WARNING: Could not recover jumptable at 0x00407570. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  initterm();
  return;
}



/* Function: __SEH_prolog4 */

/* WARNING: This is an inlined function */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Variable defined which should be unmapped: param_2 */
/* Library Function - Single Match
    __SEH_prolog4
   
   Library: Visual Studio */

void __cdecl __SEH_prolog4(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 unaff_EBX;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined4 unaff_retaddr;
  uint auStack_1c [5];
  undefined1 local_8 [8];
  
  iVar1 = -param_2;
  *(undefined4 *)((int)auStack_1c + iVar1 + 0x10) = unaff_EBX;
  *(undefined4 *)((int)auStack_1c + iVar1 + 0xc) = unaff_ESI;
  *(undefined4 *)((int)auStack_1c + iVar1 + 8) = unaff_EDI;
  *(uint *)((int)auStack_1c + iVar1 + 4) = DAT_00408004 ^ (uint)&param_2;
  *(undefined4 *)((int)auStack_1c + iVar1) = unaff_retaddr;
  ExceptionList = local_8;
  return;
}



/* Function: __SEH_epilog4 */

/* WARNING: This is an inlined function */
/* Library Function - Single Match
    __SEH_epilog4
   
   Library: Visual Studio */

void __SEH_epilog4(void)

{
  undefined4 *unaff_EBP;
  undefined4 unaff_retaddr;
  
  ExceptionList = (void *)unaff_EBP[-4];
  *unaff_EBP = unaff_retaddr;
  return;
}



/* Function: FUN_004075e0 */

void __cdecl
FUN_004075e0(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  except_handler4_common(&DAT_00408004,FUN_00406ff0,param_1,param_2,param_3,param_4);
  return;
}



/* Function: except_handler4_common */

void __cdecl except_handler4_common(void)

{
                    /* WARNING: Could not recover jumptable at 0x0040760b. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  except_handler4_common();
  return;
}



/* Function: guard_check_icall */

/* guard_check_icall */

void __cdecl guard_check_icall(void)

{
  return;
}



/* Function: memcpy */

void * __cdecl memcpy(void *_Dst,void *_Src,size_t _Size)

{
  void *pvVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00407629. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  pvVar1 = memcpy(_Dst,_Src,_Size);
  return pvVar1;
}



/* Function: memset */

void * __cdecl memset(void *_Dst,int _Val,size_t _Size)

{
  void *pvVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00407635. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  pvVar1 = memset(_Dst,_Val,_Size);
  return pvVar1;
}



