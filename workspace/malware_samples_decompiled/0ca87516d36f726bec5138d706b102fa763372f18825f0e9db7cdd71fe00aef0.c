/* Function: FUN_00401000 */

LRESULT FUN_00401000(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  int iVar1;
  LONG LVar2;
  LRESULT LVar3;
  HDC hDC;
  HBRUSH hbr;
  HFONT h;
  HGDIOBJ h_00;
  int iVar4;
  tagPAINTSTRUCT local_60;
  tagRECT local_20;
  LOGBRUSH local_10;
  
  iVar1 = DAT_0042a214;
  if (param_2 == 0xf) {
    hDC = BeginPaint(param_1,&local_60);
    local_10.lbStyle = 0;
    GetClientRect(param_1,&local_20);
    LVar2 = local_20.bottom;
    local_20.bottom = 0;
    for (; local_20.top < LVar2; local_20.top = local_20.top + 4) {
      iVar4 = LVar2 - local_20.top;
      local_10.lbColor =
           (uint)CONCAT11((char)((int)((uint)*(byte *)(iVar1 + 0x52) * iVar4 +
                                      (uint)*(byte *)(iVar1 + 0x56) * local_20.top) / LVar2),
                          (char)((int)((uint)*(byte *)(iVar1 + 0x51) * iVar4 +
                                      (uint)*(byte *)(iVar1 + 0x55) * local_20.top) / LVar2)) << 8 |
           (int)((uint)*(byte *)(iVar1 + 0x50) * iVar4 +
                (uint)*(byte *)(iVar1 + 0x54) * local_20.top) / LVar2 & 0xffU;
      hbr = CreateBrushIndirect(&local_10);
      local_20.bottom = local_20.bottom + 4;
      FillRect(hDC,&local_20,hbr);
      DeleteObject(hbr);
    }
    if (*(int *)(iVar1 + 0x58) != -1) {
      h = CreateFontIndirectW(*(LOGFONTW **)(iVar1 + 0x34));
      if (h != (HFONT)0x0) {
        local_20.left = 0x10;
        local_20.top = 8;
        SetBkMode(hDC,1);
        SetTextColor(hDC,*(COLORREF *)(iVar1 + 0x58));
        h_00 = SelectObject(hDC,h);
        DrawTextW(hDC,(LPCWSTR)&DAT_00429200,-1,&local_20,0x820);
        SelectObject(hDC,h_00);
        DeleteObject(h);
      }
    }
    EndPaint(param_1,&local_60);
    LVar3 = 0;
  }
  else {
    if (param_2 == 0x46) {
      *(uint *)(param_4 + 0x18) = *(uint *)(param_4 + 0x18) | 0x10;
      *(undefined4 *)(param_4 + 4) = DAT_0042a208;
    }
    LVar3 = DefWindowProcW(param_1,param_2,param_3,param_4);
  }
  return LVar3;
}



/* Function: FUN_0040117d */

void FUN_0040117d(int param_1)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  
  uVar1 = *(uint *)(param_1 * 0x818 + 8 + DAT_0042a248);
  if ((uVar1 & 2) != 0) {
    uVar4 = param_1 + 1;
    if (uVar4 < DAT_0042a24c) {
      puVar3 = (uint *)(uVar4 * 0x818 + 8 + DAT_0042a248);
      iVar5 = 0;
      do {
        uVar2 = *puVar3;
        if ((uVar2 & 2) == 0) {
          if ((uVar2 & 4) == 0) {
            iVar6 = iVar5;
            if ((uVar2 & 0x10) == 0) {
              *puVar3 = (uVar2 ^ uVar1) & 1 ^ uVar2;
            }
          }
          else {
            iVar6 = iVar5 + -1;
            if (iVar5 == 0) {
              return;
            }
          }
        }
        else {
          iVar6 = iVar5 + 1;
        }
        uVar4 = uVar4 + 1;
        puVar3 = puVar3 + 0x206;
        iVar5 = iVar6;
      } while (uVar4 < DAT_0042a24c);
    }
  }
  return;
}



/* Function: FUN_004011ef */

uint FUN_004011ef(uint param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int local_c;
  int local_8;
  
  iVar2 = DAT_0042a248;
  iVar5 = param_1 * 0x818 + DAT_0042a248;
  local_8 = 0;
  local_c = 0;
  if (((*(uint *)(iVar5 + 8) & 2) != 0) && (param_2 != 0)) {
    param_1 = param_1 + 1;
    *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) & 0xffffffbe;
  }
  if (param_1 < DAT_0042a24c) {
    do {
      puVar1 = (uint *)(param_1 * 0x818 + 8 + iVar2);
      uVar3 = param_1 + 1;
      uVar4 = *puVar1;
      if ((uVar4 & 2) != 0) {
        uVar3 = FUN_004011ef(param_1,1);
        uVar4 = *puVar1;
      }
      if ((uVar4 & 4) != 0) {
        if (local_8 == 0) {
          return uVar3;
        }
        if (local_c != 0) {
          *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) | 0x40;
          return uVar3;
        }
        *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) & 0xffffff7f | 1;
        return uVar3;
      }
      if ((uVar4 & 0x40) != 0) {
        local_8 = local_8 + 1;
      }
      if ((uVar4 & 1) == 0) {
        local_c = local_c + 1;
      }
      else {
        local_8 = local_8 + 1;
      }
      param_1 = uVar3;
    } while (uVar3 < DAT_0042a24c);
  }
  return 0;
}



/* Function: FUN_00401299 */

void FUN_00401299(uint param_1)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  
  uVar3 = 0;
  if ((param_1 < 0x20) && (DAT_0042a24c != 0)) {
    puVar2 = (uint *)(DAT_0042a248 + 8);
    do {
      uVar1 = *puVar2;
      if ((uVar1 & 6) == 0) {
        if ((puVar2[-1] & 1 << ((byte)param_1 & 0x1f)) == 0) {
          uVar1 = uVar1 & 0xfffffffe;
        }
        else {
          uVar1 = uVar1 | 1;
        }
        *puVar2 = uVar1;
      }
      uVar3 = uVar3 + 1;
      puVar2 = puVar2 + 0x206;
    } while (uVar3 < DAT_0042a24c);
  }
  return;
}



/* Function: FUN_004012e2 */

uint FUN_004012e2(int param_1)

{
  uint uVar1;
  uint *puVar2;
  bool bVar3;
  int *local_c;
  uint local_8;
  
  local_8 = 0;
  local_c = (int *)(DAT_0042a214 + 0x94);
  do {
    uVar1 = 0;
    if (*local_c != 0) {
      bVar3 = DAT_0042a24c == 0;
      if (DAT_0042a24c != 0) {
        puVar2 = (uint *)(DAT_0042a248 + 8);
        do {
          if (((*puVar2 & 6) == 0) &&
             (((param_1 == 0 || (*(int *)(param_1 + uVar1 * 4) != 0)) &&
              ((puVar2[-1] & 1 << ((byte)local_8 & 0x1f)) != (*puVar2 & 1) << ((byte)local_8 & 0x1f)
              )))) break;
          uVar1 = uVar1 + 1;
          puVar2 = puVar2 + 0x206;
        } while (uVar1 < DAT_0042a24c);
        bVar3 = uVar1 == DAT_0042a24c;
      }
      if (bVar3) {
        return local_8;
      }
    }
    local_8 = local_8 + 1;
    local_c = local_c + 1;
    if (0x1f < local_8) {
      return local_8;
    }
  } while( true );
}



/* Function: FUN_0040136d */

void FUN_0040136d(int param_1)

{
  if (param_1 < 0) {
    FUN_004061ac((ushort *)(&DAT_0042b000 + (param_1 + 1) * -0x800));
  }
  return;
}



/* Function: FUN_00401389 */

undefined4 FUN_00401389(int param_1,HWND param_2)

{
  HWND pHVar1;
  int iVar2;
  int iVar3;
  WPARAM wParam;
  LPARAM lParam;
  
  while ((-1 < param_1 && (pHVar1 = (HWND)(param_1 * 0x1c + DAT_0042a250), pHVar1->unused != 1))) {
    pHVar1 = FUN_00401434(pHVar1);
    if (pHVar1 == (HWND)0x7fffffff) {
      return 0x7fffffff;
    }
    iVar2 = FUN_0040136d((int)pHVar1);
    if (iVar2 == 0) {
      iVar3 = 1;
      iVar2 = param_1 + 1;
    }
    else {
      iVar2 = iVar2 + -1;
      iVar3 = iVar2 - param_1;
    }
    param_1 = iVar2;
    if (param_2 != (HWND)0x0) {
      DAT_004291ec = DAT_004291ec + iVar3;
      lParam = 0;
      wParam = MulDiv(DAT_004291ec,30000,DAT_004291d4);
      SendMessageW(param_2,0x402,wParam,lParam);
    }
  }
  return 0;
}



/* Function: FUN_0040140b */

void FUN_0040140b(int param_1)

{
  FUN_00401389(*(int *)(DAT_0042a214 + 0x6c + param_1 * 4),(HWND)0x0);
  return;
}



/* Function: FUN_00401423 */

void FUN_00401423(int param_1)

{
  FUN_004052b0(param_1,(LPCWSTR)&DAT_0040ada8);
  return;
}



/* Function: FUN_00401434 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

HWND FUN_00401434(HWND param_1)

{
  short sVar1;
  undefined4 uVar2;
  short *psVar3;
  HWND pHVar4;
  uint uVar5;
  LRESULT LVar6;
  HGDIOBJ ho;
  HDC hdc;
  SIZE_T dwBytes;
  HRESULT HVar7;
  undefined *puVar8;
  LPCWSTR lpFileName;
  LPCWSTR pWVar9;
  DWORD DVar10;
  HKEY pHVar11;
  LSTATUS LVar12;
  HANDLE pvVar13;
  LPWSTR pWVar14;
  BOOL BVar15;
  int iVar16;
  FARPROC pFVar17;
  HGLOBAL hMem;
  int *piVar18;
  HWND pHVar19;
  int iVar20;
  LPCWSTR extraout_EDX;
  LPCWSTR pWVar21;
  HWND pHVar22;
  WCHAR *pWVar23;
  LPCWSTR pWVar24;
  bool bVar25;
  undefined8 uVar26;
  undefined8 uVar27;
  UINT type;
  LONG lDistanceToMove;
  PLONG lpDistanceToMoveHigh;
  UINT fuLoad;
  LONG *pLVar28;
  uint uVar29;
  _WIN32_FIND_DATAW local_2d8;
  undefined1 local_88 [32];
  HINSTANCE local_68;
  LPCWSTR local_64;
  LPCWSTR local_60;
  tagRECT local_5c;
  FARPROC local_4c;
  uint local_48 [2];
  LPCWSTR local_40;
  FARPROC local_3c;
  undefined8 local_38;
  int local_30;
  HWND local_2c [2];
  HWND local_24;
  FILETIME local_20;
  HWND local_18;
  HWND local_14;
  HWND local_10;
  HWND local_c;
  HWND local_8;
  
  pHVar19 = DAT_0040cdac;
  pHVar22 = param_1;
  piVar18 = &local_30;
  for (iVar20 = 7; iVar20 != 0; iVar20 = iVar20 + -1) {
    *piVar18 = pHVar22->unused;
    pHVar22 = pHVar22 + 1;
    piVar18 = piVar18 + 1;
  }
  local_c = DAT_0042a208;
  pWVar21 = (LPCWSTR)0x0;
  local_10 = (HWND)(&DAT_0042b000 + (int)local_2c[1] * 0x800);
  DAT_0040cda8 = local_2c;
  iVar20 = (int)local_2c[0] * 0x800;
  pHVar22 = (HWND)(&DAT_0042b000 + iVar20);
  local_8 = (HWND)0x0;
  switch(local_30) {
  case 2:
    goto switchD_0040148a_caseD_2;
  case 3:
    pWVar21 = (LPCWSTR)0x0;
LAB_00401493:
    FUN_004052b0((int)local_2c[0],pWVar21);
    return (HWND)0x7fffffff;
  case 4:
    DAT_004291cc = DAT_004291cc + 1;
    if (DAT_0042a208 == (HWND)0x0) {
      return (HWND)0x7fffffff;
    }
    PostQuitMessage(0);
    return (HWND)0x7fffffff;
  case 5:
    iVar20 = FUN_0040136d((int)local_2c[0]);
    pHVar19 = (HWND)FUN_00401389(iVar20 + -1,(HWND)0x0);
    return pHVar19;
  case 6:
    FUN_004052b0((int)local_2c[0],(LPCWSTR)0x0);
    break;
  case 7:
    uVar27 = FUN_00402c15(0);
    DVar10 = (DWORD)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    if ((int)DVar10 < 2) {
      DVar10 = 1;
    }
    Sleep(DVar10);
    break;
  case 8:
    SetForegroundWindow(DAT_0042a208);
    break;
  case 9:
    if (DAT_004291d0 != (HWND)0x0) {
      ShowWindow(DAT_004291d0,(int)local_2c[1]);
    }
    if (DAT_004291e4 != (HWND)0x0) {
      ShowWindow(DAT_004291e4,(int)local_2c[0]);
    }
    break;
  case 10:
    pWVar21 = FUN_00402c37(0xfffffff0);
    pWVar14 = (LPWSTR)SetFileAttributesW(pWVar21,(DWORD)local_2c[1]);
    goto LAB_004015b4;
  case 0xb:
    param_1 = (HWND)FUN_00402c37(0xfffffff0);
    pWVar14 = FUN_00405bc8((LPCWSTR)param_1);
    if (pWVar14 != (LPWSTR)0x0) {
      do {
        psVar3 = (short *)FUN_00405b4a(pWVar14,L'\\');
        sVar1 = *psVar3;
        *psVar3 = 0;
        if (((sVar1 == 0) && (local_24 != (HWND)0x0)) && (iVar20 = FUN_00405819(), iVar20 != 0)) {
          DVar10 = FUN_0040577f((LPCWSTR)param_1);
        }
        else {
          DVar10 = FUN_004057fc((LPCWSTR)param_1);
        }
        if ((DVar10 != 0) &&
           ((DVar10 != 0xb7 || (DVar10 = GetFileAttributesW((LPCWSTR)param_1), (DVar10 & 0x10) == 0)
            ))) {
          local_8 = (HWND)((int)&local_8->unused + 1);
        }
        *psVar3 = sVar1;
        pWVar14 = psVar3 + 1;
      } while (sVar1 != 0);
    }
    if (local_2c[1] == (HWND)0x0) {
      iVar20 = -0xb;
      goto LAB_00402245;
    }
    FUN_00401423(-0x1a);
    FUN_0040624c((LPWSTR)&DAT_00436000,(LPCWSTR)param_1);
    BVar15 = SetCurrentDirectoryW((LPCWSTR)param_1);
    if (BVar15 == 0) {
      local_8 = (HWND)((int)&local_8->unused + 1);
    }
    break;
  case 0xc:
    pWVar21 = FUN_00402c37(0);
    puVar8 = FUN_0040658f(pWVar21);
    local_20.dwLowDateTime = (DWORD)local_2c[1];
    goto joined_r0x00401a1e;
  case 0xd:
    if (local_24 == (HWND)0x0) {
      *(undefined4 *)(&DAT_0042a2e0 + (int)local_2c[0] * 4) = (&DAT_0042a2a0)[(int)local_2c[0]];
      uVar2 = FUN_00402c15(1);
      (&DAT_0042a2a0)[(int)local_2c[0]] = uVar2;
    }
    else {
      (&DAT_0042a2a0)[(int)local_2c[0]] = *(undefined4 *)(&DAT_0042a2e0 + (int)local_2c[0] * 4);
    }
    break;
  case 0xe:
    uVar29 = (&DAT_0042a2a0)[(int)local_24];
    pHVar19 = local_2c[uVar29 == 0];
    (&DAT_0042a2a0)[(int)local_24] = uVar29 & local_20.dwLowDateTime;
    return pHVar19;
  case 0xf:
    pHVar19 = (HWND)(&DAT_0042a2a0)[(int)local_2c[1]];
    goto switchD_00401ad5_default;
  case 0x10:
    pWVar21 = FUN_00402c37(0xffffffd0);
    pWVar9 = FUN_00402c37(0xffffffdf);
    FUN_00402c37(0x13);
    BVar15 = MoveFileW(pWVar21,pWVar9);
    if (BVar15 == 0) {
      if ((local_24 == (HWND)0x0) || (puVar8 = FUN_0040658f(pWVar21), puVar8 == (undefined *)0x0))
      goto LAB_00402885;
      FUN_00406012(pWVar21,pWVar9);
      iVar20 = -0x1c;
    }
    else {
      iVar20 = -0x1d;
    }
    goto LAB_00402245;
  case 0x11:
    pHVar22 = (HWND)FUN_00402c37(0);
    pHVar19 = local_10;
    DVar10 = GetFullPathNameW((LPCWSTR)pHVar22,0x400,(LPWSTR)local_10,(LPWSTR *)&param_1);
    if (DVar10 == 0) {
LAB_00401710:
      local_8 = (HWND)0x1;
      *(undefined2 *)&pHVar19->unused = 0;
    }
    else if ((pHVar22 < param_1) && ((short)param_1->unused != 0)) {
      puVar8 = FUN_0040658f((LPCWSTR)pHVar22);
      if (puVar8 == (undefined *)0x0) goto LAB_00401710;
      FUN_0040624c((LPWSTR)param_1,(LPCWSTR)(puVar8 + 0x2c));
    }
    if (local_24 == (HWND)0x0) {
      GetShortPathNameW((LPCWSTR)pHVar19,(LPWSTR)pHVar19,0x400);
    }
    break;
  case 0x12:
    pWVar21 = FUN_00402c37(0xffffffff);
    DVar10 = SearchPathW((LPCWSTR)0x0,pWVar21,(LPCWSTR)0x0,0x400,(LPWSTR)pHVar22,(LPWSTR *)&param_1)
    ;
    bVar25 = DVar10 == 0;
    goto LAB_00401751;
  case 0x13:
    pWVar21 = FUN_00402c37(0xffffffef);
    pWVar14 = FUN_00405d6d((LPWSTR)pHVar22,pWVar21);
    goto LAB_004015b4;
  case 0x14:
    local_c = (HWND)FUN_00402c37(0x31);
    param_1 = (HWND)((uint)local_2c[0] & 7);
    iVar20 = FUN_00405b94((ushort *)local_c);
    if (iVar20 == 0) {
      pHVar19 = local_c;
      pWVar21 = (LPCWSTR)FUN_0040624c((LPWSTR)&DAT_0040a5a8,(LPCWSTR)&DAT_00436000);
      pWVar21 = FUN_00405b1d(pWVar21);
      lstrcatW(pWVar21,(LPCWSTR)pHVar19);
    }
    else {
      FUN_0040624c((LPWSTR)&DAT_0040a5a8,(LPCWSTR)local_c);
    }
    FUN_004064e0((LPCWSTR)&DAT_0040a5a8);
    do {
      if (2 < (int)param_1) {
        puVar8 = FUN_0040658f((LPCWSTR)&DAT_0040a5a8);
        uVar29 = 0;
        if (puVar8 != (undefined *)0x0) {
          uVar29 = CompareFileTime((FILETIME *)(puVar8 + 0x14),&local_20);
        }
        param_1 = (HWND)(uint)((((uint)((int)&param_1[-1].unused + 1U) | 0x80000000) & uVar29) == 0)
        ;
      }
      if (param_1 == (HWND)0x0) {
        FUN_00405d19((LPCWSTR)&DAT_0040a5a8);
      }
      local_38._4_4_ =
           (HWND)FUN_00405d3e((LPCWSTR)&DAT_0040a5a8,0x40000000,(param_1 != (HWND)0x1) + 1);
      if (local_38._4_4_ != (HWND)0xffffffff) {
        FUN_004052b0(-0x16,(LPCWSTR)local_c);
        DAT_0042a2d4 = DAT_0042a2d4 + 1;
        DVar10 = FUN_004030fa((int)local_24,local_38._4_4_,(undefined *)0x0,0);
        DAT_0042a2d4 = DAT_0042a2d4 + -1;
        if (((HWND)local_20.dwLowDateTime != (HWND)0xffffffff) ||
           ((HWND)local_20.dwHighDateTime != (HWND)0xffffffff)) {
          SetFileTime(local_38._4_4_,&local_20,(FILETIME *)0x0,&local_20);
        }
        CloseHandle(local_38._4_4_);
        if (-1 < (int)DVar10) goto switchD_0040148a_caseD_41;
        if (DVar10 == 0xfffffffe) {
          FUN_0040626e((LPWSTR)&DAT_0040a5a8,-0x17);
          lstrcatW((LPWSTR)&DAT_0040a5a8,(LPCWSTR)local_c);
        }
        else {
          FUN_0040626e((LPWSTR)&DAT_0040a5a8,-0x12);
        }
        uVar29 = 0x200010;
        puVar8 = &DAT_0040a5a8;
        goto LAB_004022ec;
      }
      if (param_1 != (HWND)0x0) {
        FUN_004052b0(-0x1e,(LPCWSTR)local_c);
        bVar25 = param_1 == (HWND)0x2;
        goto LAB_004015b6;
      }
      FUN_0040624c((LPWSTR)&DAT_0040b5a8,(LPCWSTR)&DAT_0042b000);
      FUN_0040624c((LPWSTR)&DAT_0042b000,(LPCWSTR)&DAT_0040a5a8);
      FUN_0040626e((LPWSTR)&DAT_0040ada8,(int)local_18);
      FUN_0040624c((LPWSTR)&DAT_0042b000,(LPCWSTR)&DAT_0040b5a8);
      iVar20 = FUN_004058ae(&DAT_0040ada8,(int)local_2c[0] >> 3);
    } while (iVar20 == 4);
    if (iVar20 != 5) {
      pWVar21 = (LPCWSTR)&DAT_0040a5a8;
      local_2c[0] = (HWND)0xfffffffa;
      goto LAB_00401493;
    }
    _DAT_0042a2a8 = _DAT_0042a2a8 + 1;
    goto LAB_00402ac8;
  case 0x15:
    uVar29 = 0;
    goto LAB_00401943;
  case 0x16:
    pWVar21 = FUN_00402c37(0x31);
    pHVar19 = (HWND)FUN_004058ae(pWVar21,(uint)local_2c[0]);
    if (pHVar19 == (HWND)0x0) goto LAB_00402885;
    if (pHVar19 == local_24) {
      return (HWND)local_20.dwLowDateTime;
    }
    if (pHVar19 == (HWND)local_20.dwHighDateTime) {
      return local_18;
    }
    break;
  case 0x17:
    uVar29 = 0xfffffff0;
LAB_00401943:
    pWVar21 = FUN_00402c37(uVar29);
    FUN_0040595a(pWVar21,(uint)local_2c[1]);
    break;
  case 0x18:
    pWVar21 = FUN_00402c37(1);
    pHVar19 = (HWND)lstrlenW(pWVar21);
    goto switchD_00401ad5_default;
  case 0x19:
    uVar27 = FUN_00402c15(2);
    local_5c.right._0_2_ = (undefined2)uVar27;
    local_5c.right._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x10);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    local_38 = FUN_00402c15(3);
    pHVar19 = (HWND)local_38;
    param_1 = (HWND)CONCAT22(local_5c.right._2_2_,(undefined2)local_5c.right);
    local_40 = FUN_00402c37(1);
    pHVar4 = (HWND)lstrlenW(local_40);
    *(undefined2 *)&pHVar22->unused = 0;
    if (CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom) == 0) {
      param_1 = pHVar4;
    }
    if ((param_1 != (HWND)0x0) &&
       ((-1 < (int)local_38 ||
        (pHVar19 = (HWND)((int)local_38 + (int)&pHVar4->unused), -1 < (int)pHVar19)))) {
      if ((int)pHVar4 < (int)pHVar19) {
        pHVar19 = pHVar4;
      }
      FUN_0040624c((LPWSTR)pHVar22,local_40 + (int)pHVar19);
      if ((int)param_1 < 0) {
        iVar20 = lstrlenW((LPCWSTR)pHVar22);
        param_1 = (HWND)((int)&param_1->unused + iVar20);
        if ((int)param_1 < 0) {
          param_1 = (HWND)0x0;
        }
      }
      if ((int)param_1 < 0x400) {
        *(undefined2 *)((int)&pHVar22->unused + (int)param_1 * 2) = 0;
      }
    }
    break;
  case 0x1a:
    pWVar21 = FUN_00402c37(0x20);
    pWVar9 = FUN_00402c37(0x31);
    if ((HWND)local_20.dwHighDateTime == (HWND)0x0) {
      puVar8 = (undefined *)lstrcmpiW(pWVar21,pWVar9);
    }
    else {
      puVar8 = (undefined *)lstrcmpW(pWVar21,pWVar9);
    }
    goto joined_r0x00401a1e;
  case 0x1b:
    param_1 = (HWND)FUN_00402c37(1);
    DVar10 = ExpandEnvironmentStringsW((LPCWSTR)param_1,(LPWSTR)pHVar22,0x400);
    if ((DVar10 == 0) ||
       ((local_24 != (HWND)0x0 &&
        (iVar16 = lstrcmpW((LPCWSTR)param_1,(LPCWSTR)pHVar22), iVar16 == 0)))) {
      local_8 = (HWND)0x1;
      *(undefined2 *)&pHVar22->unused = 0;
    }
    *(undefined2 *)(&DAT_0042b7fe + iVar20) = 0;
    break;
  case 0x1c:
    uVar27 = FUN_00402c15(0);
    uVar29 = (uint)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    uVar5 = FUN_00402c15(1);
    if (local_18 != (HWND)0x0) {
      if (uVar29 < uVar5) {
        return (HWND)local_20.dwLowDateTime;
      }
      if (uVar29 <= uVar5) {
        return local_24;
      }
      return (HWND)local_20.dwHighDateTime;
    }
    if ((int)uVar29 < (int)uVar5) {
      return (HWND)local_20.dwLowDateTime;
    }
    if ((int)uVar29 <= (int)uVar5) {
      return local_24;
    }
    return (HWND)local_20.dwHighDateTime;
  case 0x1d:
    uVar27 = FUN_00402c15(1);
    pHVar4 = (HWND)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    param_1 = pHVar4;
    uVar27 = FUN_00402c15(2);
    uVar29 = (uint)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    pHVar19 = param_1;
    switch(local_20.dwLowDateTime) {
    case 0:
      pHVar19 = (HWND)((int)&pHVar4->unused + uVar29);
      break;
    case 1:
      pHVar19 = (HWND)((int)pHVar4 - uVar29);
      break;
    case 2:
      pHVar19 = (HWND)(uVar29 * (int)pHVar4);
      break;
    case 3:
      if (uVar29 == 0) {
LAB_00401b2f:
        local_8 = (HWND)0x1;
        pHVar19 = (HWND)0x0;
      }
      else {
        pHVar19 = (HWND)((int)pHVar4 / (int)uVar29);
      }
      break;
    case 4:
      pHVar19 = (HWND)(uVar29 | (uint)pHVar4);
      break;
    case 5:
      pHVar19 = (HWND)(uVar29 & (uint)pHVar4);
      break;
    case 6:
      pHVar19 = (HWND)(uVar29 ^ (uint)pHVar4);
      break;
    case 7:
      pHVar19 = (HWND)(uint)(pHVar4 == (HWND)0x0);
      break;
    case 8:
      if (pHVar4 == (HWND)0x0) {
LAB_00401b19:
        if (uVar29 == 0) goto LAB_00401b11;
      }
      pHVar19 = (HWND)0x1;
      break;
    case 9:
      if (pHVar4 != (HWND)0x0) goto LAB_00401b19;
LAB_00401b11:
      pHVar19 = (HWND)0x0;
      break;
    case 10:
      if (uVar29 == 0) goto LAB_00401b2f;
      pHVar19 = (HWND)((int)pHVar4 % (int)uVar29);
      break;
    case 0xb:
      pHVar19 = (HWND)((int)pHVar4 << ((byte)uVar27 & 0x1f));
      break;
    case 0xc:
      pHVar19 = (HWND)((int)pHVar4 >> ((byte)uVar27 & 0x1f));
    }
    goto switchD_00401ad5_default;
  case 0x1e:
    pWVar21 = FUN_00402c37(1);
    uVar27 = FUN_00402c15(2);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    wsprintfW((LPWSTR)pHVar22,pWVar21,(int)uVar27);
    break;
  case 0x1f:
    if (local_24 == (HWND)0x0) {
      if (local_2c[1] != (HWND)0x0) {
        if (DAT_0040cdac != (HWND)0x0) {
          FUN_0040624c((LPWSTR)pHVar22,(LPCWSTR)(DAT_0040cdac + 1));
          DAT_0040cdac = (HWND)pHVar19->unused;
          goto LAB_00401be1;
        }
        goto LAB_00402885;
      }
      pHVar19 = (HWND)GlobalAlloc(0x40,0x804);
      FUN_0040626e((LPWSTR)(pHVar19 + 1),(int)local_2c[0]);
      pHVar19->unused = (int)DAT_0040cdac;
      DAT_0040cdac = pHVar19;
    }
    else {
      do {
        local_24 = (HWND)((int)&local_24[-1].unused + 3);
        if (pHVar19 == (HWND)0x0) goto LAB_004022de;
        pHVar19 = (HWND)pHVar19->unused;
      } while (local_24 != (HWND)0x0);
      if (pHVar19 == (HWND)0x0) goto LAB_004022de;
      FUN_0040624c((LPWSTR)&DAT_0040a5a8,(LPCWSTR)(pHVar19 + 1));
      FUN_0040624c((LPWSTR)(pHVar19 + 1),(LPCWSTR)(DAT_0040cdac + 1));
      pWVar23 = (WCHAR *)&DAT_0040a5a8;
      pHVar22 = DAT_0040cdac + 1;
LAB_004029db:
      FUN_0040624c((LPWSTR)pHVar22,pWVar23);
    }
    break;
  case 0x20:
  case 0x21:
    uVar27 = FUN_00402c15(3);
    local_14 = (HWND)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    uVar27 = FUN_00402c15(4);
    param_1 = (HWND)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    if (((uint)local_18 & 1) != 0) {
      local_14 = (HWND)FUN_00402c37(0x33);
    }
    if (((uint)local_18 & 2) != 0) {
      param_1 = (HWND)FUN_00402c37(0x44);
    }
    if (local_30 == 0x21) {
      uVar27 = FUN_00402c15(1);
      local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
      local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
      uVar26 = FUN_00402c15(2);
      local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar26 >> 0x20);
      local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar26 >> 0x30);
      if ((int)local_18 >> 2 == 0) {
        pHVar19 = (HWND)SendMessageW((HWND)uVar27,(UINT)uVar26,(WPARAM)local_14,(LPARAM)param_1);
        local_38._4_4_ = pHVar19;
        local_2c[1] = local_2c[0];
      }
      else {
        LVar6 = SendMessageTimeoutW((HWND)uVar27,(UINT)uVar26,(WPARAM)local_14,(LPARAM)param_1,0,
                                    (int)local_18 >> 2,(PDWORD_PTR)((int)&local_38 + 4));
        local_8 = (HWND)(uint)(LVar6 == 0);
        pHVar19 = local_38._4_4_;
        local_2c[1] = local_2c[0];
      }
    }
    else {
      pWVar21 = FUN_00402c37(1);
      pWVar9 = FUN_00402c37(0x12);
      pHVar19 = FindWindowExW(local_14,param_1,(LPCWSTR)(-(uint)(*pWVar21 != L'\0') & (uint)pWVar21)
                              ,(LPCWSTR)(-(uint)(*pWVar9 != L'\0') & (uint)pWVar9));
      local_38._4_4_ = pHVar19;
      local_2c[1] = local_2c[0];
    }
joined_r0x00402810:
    if (-1 < (int)local_2c[1]) goto switchD_00401ad5_default;
    break;
  case 0x22:
    uVar27 = FUN_00402c15(0);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    puVar8 = (undefined *)IsWindow((HWND)uVar27);
    local_20.dwLowDateTime = (DWORD)local_2c[1];
joined_r0x00401a1e:
    if (puVar8 == (undefined *)0x0) {
      return local_24;
    }
    return (HWND)local_20.dwLowDateTime;
  case 0x23:
    uVar27 = FUN_00402c15(2);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    uVar26 = FUN_00402c15(1);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar26 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar26 >> 0x30);
    pHVar19 = GetDlgItem((HWND)uVar26,(int)uVar27);
    goto switchD_00401ad5_default;
  case 0x24:
    iVar20 = (int)&local_2c[1]->unused + DAT_0042a268;
    uVar27 = FUN_00402c15(0);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    SetWindowLongW((HWND)uVar27,-0x15,iVar20);
    break;
  case 0x25:
    pHVar19 = GetDlgItem(DAT_0042a208,(int)local_2c[1]);
    GetClientRect(pHVar19,&local_5c);
    fuLoad = 0x10;
    iVar20 = CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom) * (int)local_24;
    iVar16 = CONCAT22(local_5c.right._2_2_,(undefined2)local_5c.right) * (int)local_24;
    type = 0;
    pWVar21 = FUN_00402c37(0);
    pvVar13 = LoadImageW((HINSTANCE)0x0,pWVar21,type,iVar16,iVar20,fuLoad);
    ho = (HGDIOBJ)SendMessageW(pHVar19,0x172,0,(LPARAM)pvVar13);
    if (ho != (HGDIOBJ)0x0) {
      DeleteObject(ho);
    }
    break;
  case 0x26:
    hdc = GetDC(DAT_0042a208);
    uVar27 = FUN_00402c15(2);
    iVar16 = 0x48;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    iVar20 = GetDeviceCaps(hdc,0x5a);
    _DAT_0040cdb0 = MulDiv((int)uVar27,iVar20,iVar16);
    _DAT_0040cdb0 = -_DAT_0040cdb0;
    ReleaseDC(local_c,hdc);
    uVar27 = FUN_00402c15(3);
    _DAT_0040cdc0 = (undefined4)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    DAT_0040cdc4 = (byte)local_20.dwHighDateTime & 1;
    DAT_0040cdc7 = 1;
    DAT_0040cdc5 = (byte)local_20.dwHighDateTime & 2;
    DAT_0040cdc6 = (byte)local_20.dwHighDateTime & 4;
    FUN_0040626e((LPWSTR)&DAT_0040cdcc,(int)local_2c[1]);
    pHVar19 = (HWND)CreateFontIndirectW((LOGFONTW *)&DAT_0040cdb0);
    goto switchD_00401ad5_default;
  case 0x27:
    uVar27 = FUN_00402c15(0);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    uVar26 = FUN_00402c15(1);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar26 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar26 >> 0x30);
    if ((HWND)local_20.dwLowDateTime == (HWND)0x0) {
      ShowWindow((HWND)uVar27,(int)uVar26);
    }
    else {
      EnableWindow((HWND)uVar27,(int)uVar26);
    }
    break;
  case 0x28:
    pWVar21 = FUN_00402c37(0);
    pWVar9 = FUN_00402c37(0x31);
    pWVar24 = FUN_00402c37(0x22);
    FUN_00402c37(0x15);
    FUN_00401423(-0x14);
    local_88._4_4_ = local_20.dwHighDateTime;
    local_88._8_4_ = local_c;
    local_88._28_4_ = local_20.dwLowDateTime;
    local_88._12_4_ = -(uint)(*pWVar21 != L'\0') & (uint)pWVar21;
    local_88._24_4_ = &DAT_00436000;
    local_88._20_4_ = -(uint)(*pWVar24 != L'\0') & (uint)pWVar24;
    local_88._16_4_ = pWVar9;
    iVar20 = FUN_00405874((SHELLEXECUTEINFOW *)local_88);
    if (iVar20 == 0) goto LAB_00402885;
    if ((local_88._4_4_ & 0x40) != 0) {
      FUN_004066d7((HANDLE)CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom));
      pvVar13 = (HANDLE)CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom);
      goto LAB_00401f47;
    }
    break;
  case 0x29:
    pWVar21 = FUN_00402c37(0);
    FUN_004052b0(-0x15,pWVar21);
    pvVar13 = FUN_00405831(pWVar21);
    if (pvVar13 == (HANDLE)0x0) goto LAB_00402885;
    if (local_24 != (HWND)0x0) {
      DVar10 = FUN_004066d7(pvVar13);
      if ((int)local_2c[1] < 0) {
        if (DVar10 != 0) {
          local_8 = (HWND)0x1;
        }
      }
      else {
        FUN_00406193((LPWSTR)local_10,DVar10);
      }
    }
LAB_00401f47:
    CloseHandle(pvVar13);
    break;
  case 0x2a:
    pWVar21 = FUN_00402c37(2);
    puVar8 = FUN_0040658f(pWVar21);
    if (puVar8 != (undefined *)0x0) {
      FUN_00406193((LPWSTR)local_10,*(undefined4 *)(puVar8 + 0x14));
      pHVar19 = *(HWND *)(puVar8 + 0x18);
      goto switchD_00401ad5_default;
    }
    *(undefined2 *)&pHVar22->unused = 0;
    *(undefined2 *)&local_10->unused = 0;
    goto LAB_00402885;
  case 0x2b:
    pHVar19 = (HWND)FUN_00402c37(0xffffffee);
    pLVar28 = &local_5c.bottom;
    local_38._4_4_ = pHVar19;
    pFVar17 = FUN_00406626(9);
    dwBytes = (*pFVar17)(pHVar19,pLVar28);
    *(undefined2 *)&pHVar22->unused = 0;
    *(undefined2 *)&local_10->unused = 0;
    local_8 = (HWND)0x1;
    if ((dwBytes != 0) && (param_1 = (HWND)GlobalAlloc(0x40,dwBytes), param_1 != (HWND)0x0)) {
      local_3c = FUN_00406626(10);
      local_14 = (HWND)FUN_00406626(0xb);
      iVar20 = (*local_3c)(local_38._4_4_,0,dwBytes,param_1);
      pHVar19 = param_1;
      if ((iVar20 != 0) &&
         (iVar20 = (*(code *)local_14)(param_1,&DAT_0040a014,&local_40,&local_4c), pHVar19 = param_1
         , iVar20 != 0)) {
        FUN_00406193((LPWSTR)pHVar22,*(undefined4 *)(local_40 + 4));
        FUN_00406193((LPWSTR)local_10,*(undefined4 *)(local_40 + 6));
        local_8 = (HWND)0x0;
        pHVar19 = param_1;
      }
LAB_00401be1:
      GlobalFree(pHVar19);
    }
    break;
  case 0x2c:
    local_8 = (HWND)0x1;
    if (DAT_0042a2d8 < 0) {
      iVar20 = -0x19;
    }
    else {
      pWVar21 = FUN_00402c37(0xfffffff0);
      local_40 = FUN_00402c37(1);
      if ((((HWND)local_20.dwHighDateTime != (HWND)0x0) &&
          (param_1 = (HWND)GetModuleHandleW(pWVar21), param_1 != (HWND)0x0)) ||
         (param_1 = (HWND)LoadLibraryExW(pWVar21,(HANDLE)0x0,8), param_1 != (HWND)0x0)) {
        pFVar17 = FUN_00406695((HMODULE)param_1,local_40);
        if (pFVar17 == (FARPROC)0x0) {
          FUN_004052b0(-9,local_40);
        }
        else {
          local_8 = (HWND)0x0;
          if (local_24 == (HWND)0x0) {
            (*pFVar17)(local_c,0x400,&DAT_0042b000,&DAT_0040cdac,&PTR_DAT_0040a000);
          }
          else {
            FUN_00401423((int)local_24);
            iVar20 = (*pFVar17)();
            if (iVar20 != 0) {
              local_8 = (HWND)0x1;
            }
          }
        }
        if (((HWND)local_20.dwLowDateTime == (HWND)0x0) &&
           (iVar20 = FUN_004038fa((int)param_1), iVar20 != 0)) {
          FreeLibrary((HMODULE)param_1);
        }
        break;
      }
      iVar20 = -10;
      param_1 = (HWND)0x0;
    }
    goto LAB_00402245;
  case 0x2d:
    pWVar21 = FUN_00402c37(0xfffffff0);
    local_5c.bottom._0_2_ = SUB42(pWVar21,0);
    local_5c.bottom._2_2_ = (undefined2)((uint)pWVar21 >> 0x10);
    local_40 = FUN_00402c37(0xffffffdf);
    local_c = (HWND)FUN_00402c37(2);
    local_4c = (FARPROC)FUN_00402c37(0xffffffcd);
    local_10 = (HWND)FUN_00402c37(0x45);
    local_48[0] = local_20.dwHighDateTime & 0xfff;
    local_3c = (FARPROC)((int)local_20.dwHighDateTime >> 0x10 & 0xffff);
    uVar29 = (int)local_20.dwHighDateTime >> 0xc & 7;
    iVar20 = FUN_00405b94((ushort *)local_40);
    if (iVar20 == 0) {
      FUN_00402c37(0x21);
    }
    HVar7 = CoCreateInstance((IID *)&DAT_004084dc,(LPUNKNOWN)0x0,1,(IID *)&DAT_004084cc,&param_1);
    if (-1 < HVar7) {
      local_14 = (HWND)(**(code **)param_1->unused)(param_1,&DAT_004084ec,(int)&local_38 + 4);
      if (-1 < (int)local_14) {
        local_14 = (HWND)(**(code **)(param_1->unused + 0x50))(param_1,local_40);
        if ((local_20.dwHighDateTime & 0x8000) == 0) {
          (**(code **)(param_1->unused + 0x24))(param_1,&DAT_00436000);
        }
        if (uVar29 != 0) {
          (**(code **)(param_1->unused + 0x3c))(param_1,uVar29);
        }
        (**(code **)(param_1->unused + 0x34))(param_1,local_3c);
        if (*(WCHAR *)local_4c != L'\0') {
          (**(code **)(param_1->unused + 0x44))(param_1,local_4c,local_48[0]);
        }
        (**(code **)(param_1->unused + 0x2c))(param_1,local_c);
        (**(code **)(param_1->unused + 0x1c))(param_1,local_10);
        if (-1 < (int)local_14) {
          local_14 = (HWND)(**(code **)((local_38._4_4_)->unused + 0x18))
                                     (local_38._4_4_,
                                      CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom),1)
          ;
        }
        (**(code **)((local_38._4_4_)->unused + 8))(local_38._4_4_);
      }
      (**(code **)(param_1->unused + 8))(param_1);
      if (-1 < (int)local_14) {
        iVar20 = -0xc;
        goto LAB_00402245;
      }
    }
    local_8 = (HWND)0x1;
    iVar20 = -0x10;
    goto LAB_00402245;
  case 0x2e:
    pWVar21 = FUN_00402c37(0);
    pWVar9 = FUN_00402c37(0x11);
    param_1 = (HWND)FUN_00402c37(0x23);
    puVar8 = FUN_0040658f(pWVar21);
    if (puVar8 != (undefined *)0x0) {
      local_88._28_4_ = local_c;
      local_68 = (HINSTANCE)0x2;
      iVar20 = lstrlenW(pWVar21);
      pWVar21[iVar20 + 1] = L'\0';
      iVar20 = lstrlenW(pWVar9);
      pWVar9[iVar20 + 1] = L'\0';
      local_5c.right._2_2_ = SUB42(param_1,0);
      local_5c.bottom._0_2_ = (undefined2)((uint)param_1 >> 0x10);
      local_5c.left._0_2_ = local_24._0_2_;
      local_64 = pWVar21;
      local_60 = pWVar9;
      FUN_004052b0(0,(LPCWSTR)param_1);
      iVar20 = SHFileOperationW((LPSHFILEOPSTRUCTW)(local_88 + 0x1c));
      if (iVar20 == 0) break;
    }
    FUN_004052b0(-7,(LPCWSTR)0x0);
    goto LAB_00402885;
  case 0x2f:
    if (local_2c[0] != (HWND)0xbadf00d) {
LAB_004022de:
      uVar29 = 0x200010;
      puVar8 = (undefined *)FUN_0040626e((LPWSTR)0x0,-0x18);
LAB_004022ec:
      FUN_004058ae(puVar8,uVar29);
      return (HWND)0x7fffffff;
    }
    DAT_0042a2b4 = DAT_0042a2b4 + 1;
    break;
  case 0x30:
    pWVar9 = (LPCWSTR)0x0;
    pWVar24 = (LPCWSTR)0x0;
    if (local_2c[0] != (HWND)0x0) {
      pWVar9 = FUN_00402c37(0);
    }
    if (local_2c[1] != (HWND)0x0) {
      pWVar24 = FUN_00402c37(0x11);
    }
    if ((HWND)local_20.dwHighDateTime != (HWND)0x0) {
      pWVar21 = FUN_00402c37(0x22);
    }
    lpFileName = FUN_00402c37(0xffffffcd);
    pWVar14 = (LPWSTR)WritePrivateProfileStringW(pWVar9,pWVar24,pWVar21,lpFileName);
LAB_004015b4:
    bVar25 = pWVar14 == (LPWSTR)0x0;
LAB_004015b6:
    if (bVar25) goto LAB_00402885;
    break;
  case 0x31:
    param_1 = DAT_0040a010;
    pWVar21 = FUN_00402c37(1);
    pWVar9 = FUN_00402c37(0x12);
    local_5c.bottom._0_2_ = SUB42(pWVar9,0);
    local_5c.bottom._2_2_ = (undefined2)((uint)pWVar9 >> 0x10);
    pWVar9 = FUN_00402c37(0xffffffdd);
    GetPrivateProfileStringW
              (pWVar21,(LPCWSTR)CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom),
               (LPCWSTR)&param_1,(LPWSTR)pHVar22,0x3ff,pWVar9);
    bVar25 = (short)pHVar22->unused == 10;
LAB_00401751:
    if (bVar25) {
LAB_00402853:
      local_8 = (HWND)0x1;
      *(undefined2 *)&pHVar22->unused = 0;
    }
    break;
  case 0x32:
    if ((HWND)local_20.dwHighDateTime == (HWND)0x0) {
      pHVar11 = (HKEY)FUN_00402c77((HKEY)0x2);
      if (pHVar11 == (HKEY)0x0) goto LAB_00402885;
      pWVar21 = FUN_00402c37(0x33);
      LVar12 = RegDeleteValueW(pHVar11,pWVar21);
      RegCloseKey(pHVar11);
    }
    else {
      pWVar21 = FUN_00402c37(0x22);
      LVar12 = FUN_00402cf5((int)local_2c[1],pWVar21,(int)local_20.dwHighDateTime >> 1);
    }
    if (LVar12 != 0) goto LAB_00402885;
    break;
  case 0x33:
    local_5c.bottom._0_2_ = SUB42(local_18,0);
    local_5c.bottom._2_2_ = (undefined2)((uint)local_18 >> 0x10);
    local_40 = FUN_00402c37(2);
    pWVar21 = FUN_00402c37(0x11);
    local_8 = (HWND)0x1;
    param_1 = (HWND)FUN_00402cc7((int)local_2c[0],pWVar21,(HKEY)0x2);
    if (param_1 != (HWND)0x0) {
      DVar10 = 0;
      if ((HWND)local_20.dwHighDateTime == (HWND)0x1) {
        FUN_00402c37(0x23);
        iVar20 = lstrlenW((LPCWSTR)&DAT_0040b5a8);
        DVar10 = iVar20 * 2 + 2;
      }
      uVar27 = CONCAT44(local_38._4_4_,_DAT_0040b5a8);
      if ((HWND)local_20.dwHighDateTime == (HWND)0x4) {
        uVar27 = FUN_00402c15(3);
        DVar10 = 4;
      }
      local_38._4_4_ = (HWND)((ulonglong)uVar27 >> 0x20);
      _DAT_0040b5a8 = (undefined4)uVar27;
      if ((HWND)local_20.dwHighDateTime == (HWND)0x3) {
        DVar10 = FUN_004030fa(local_20.dwLowDateTime,(HANDLE)0x0,&DAT_0040b5a8,0x1800);
        uVar27 = CONCAT44(local_38._4_4_,_DAT_0040b5a8);
      }
      local_38._4_4_ = (HWND)((ulonglong)uVar27 >> 0x20);
      _DAT_0040b5a8 = (undefined4)uVar27;
      LVar12 = RegSetValueExW((HKEY)param_1,local_40,0,
                              CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom),
                              &DAT_0040b5a8,DVar10);
      pHVar11 = (HKEY)param_1;
      if (LVar12 == 0) {
        local_8 = (HWND)0x0;
      }
LAB_00402551:
      RegCloseKey(pHVar11);
    }
    break;
  case 0x34:
    pHVar11 = (HKEY)FUN_00402c77((HKEY)0x20019);
    pWVar21 = FUN_00402c37(0x33);
    *(undefined2 *)&pHVar22->unused = 0;
    if (pHVar11 != (HKEY)0x0) {
      local_5c.bottom._0_2_ = 0x800;
      local_5c.bottom._2_2_ = 0;
      LVar12 = RegQueryValueExW(pHVar11,pWVar21,(LPDWORD)0x0,(LPDWORD)&param_1,(LPBYTE)pHVar22,
                                (LPDWORD)&local_5c.bottom);
      if (LVar12 == 0) {
        if (param_1 == (HWND)0x4) {
          local_8 = (HWND)(uint)((HWND)local_20.dwHighDateTime == (HWND)0x0);
          FUN_00406193((LPWSTR)pHVar22,pHVar22->unused);
          goto LAB_00402551;
        }
        if ((param_1 == (HWND)0x1) || (param_1 == (HWND)0x2)) {
          local_8 = (HWND)local_20.dwHighDateTime;
          goto LAB_00402549;
        }
      }
      *(undefined2 *)&pHVar22->unused = 0;
      local_8 = (HWND)0x1;
      goto LAB_00402551;
    }
    goto LAB_00402885;
  case 0x35:
    pHVar11 = (HKEY)FUN_00402c77((HKEY)0x20019);
    uVar27 = FUN_00402c15(3);
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    *(undefined2 *)&pHVar22->unused = 0;
    if (pHVar11 != (HKEY)0x0) {
      param_1 = (HWND)0x3ff;
      if ((HWND)local_20.dwHighDateTime == (HWND)0x0) {
        LVar12 = RegEnumValueW(pHVar11,(DWORD)uVar27,(LPWSTR)pHVar22,(LPDWORD)&param_1,(LPDWORD)0x0,
                               (LPDWORD)0x0,(LPBYTE)0x0,(LPDWORD)0x0);
        if (LVar12 != 0) {
          local_8 = (HWND)0x1;
        }
      }
      else {
        RegEnumKeyW(pHVar11,(DWORD)uVar27,(LPWSTR)pHVar22,0x3ff);
      }
LAB_00402549:
      *(undefined2 *)(&DAT_0042b7fe + iVar20) = 0;
      goto LAB_00402551;
    }
    goto LAB_00402885;
  case 0x36:
    pvVar13 = (HANDLE)FUN_004061ac((ushort *)pHVar22);
    if (pvVar13 != (HANDLE)0x0) goto LAB_00401f47;
    break;
  case 0x37:
    pWVar21 = FUN_00402c37(0xffffffed);
    pHVar19 = (HWND)FUN_00405d3e(pWVar21,(DWORD)local_2c[1],(DWORD)local_24);
    if (pHVar19 == (HWND)0xffffffff) goto LAB_00402882;
switchD_00401ad5_default:
    FUN_00406193((LPWSTR)pHVar22,pHVar19);
    break;
  case 0x38:
  case 0x44:
    local_5c.bottom._0_2_ = SUB42(local_24,0);
    local_5c.bottom._2_2_ = (undefined2)((uint)local_24 >> 0x10);
    if (local_24 == (HWND)0x0) {
      if (local_30 == 0x38) {
        FUN_00402c37(0x21);
        WideCharToMultiByte(0,0,(LPCWSTR)&DAT_0040b5a8,-1,&DAT_0040ada8,0x400,(LPCSTR)0x0,
                            (LPBOOL)0x0);
        param_1 = (HWND)lstrlenA(&DAT_0040ada8);
      }
      else {
        pWVar21 = FUN_00402c37(0x11);
        iVar20 = lstrlenW(pWVar21);
        param_1 = (HWND)(iVar20 * 2);
      }
    }
    else {
      _DAT_0040ada8 = FUN_00402c15(1);
      param_1 = (HWND)((local_30 != 0x38) + 1);
      local_40 = extraout_EDX;
    }
    if (((short)pHVar22->unused != 0) &&
       (((pvVar13 = (HANDLE)FUN_004061ac((ushort *)pHVar22),
         local_30 == 0x38 || CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom) != 0 ||
         ((HWND)local_20.dwLowDateTime == (HWND)0x0)) ||
        (iVar20 = FUN_00405e1f(pvVar13,(int)pvVar13), -1 < iVar20)))) {
      pWVar14 = (LPWSTR)FUN_00405df0(pvVar13,&DAT_0040ada8,(DWORD)param_1);
      goto LAB_004015b4;
    }
    goto LAB_00402885;
  case 0x39:
  case 0x45:
    local_c = (HWND)0x0;
    local_4c = (FARPROC)0x2;
    uVar27 = FUN_00402c15(2);
    local_40 = (LPCWSTR)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    if ((int)local_40 < 1) break;
    if (0x3ff < (int)local_40) {
      local_40 = (LPCWSTR)0x3ff;
    }
    if ((short)pHVar22->unused != 0) {
      local_38._4_4_ = (HWND)0x0;
      local_14 = (HWND)FUN_004061ac((ushort *)pHVar22);
      if (0 < (int)local_40) {
        do {
          if (local_30 == 0x39) {
            BVar15 = ReadFile(local_14,(LPVOID)((int)&param_1 + 2),2 - local_20.dwLowDateTime,
                              (LPDWORD)&local_3c,(LPOVERLAPPED)0x0);
            if ((BVar15 != 0) && (local_3c != (FARPROC)0x0)) {
              local_48[0] = CONCAT22((short)((uint)BVar15 >> 0x10),(ushort)param_1._2_1_);
              local_4c = local_3c;
              if ((HWND)local_20.dwLowDateTime == (HWND)0x0) {
                iVar20 = MultiByteToWideChar(0,8,(LPCSTR)((int)&param_1 + 2),(int)local_3c,
                                             (LPWSTR)local_48,1);
                if (iVar20 == 0) {
                  iVar20 = -(int)local_4c;
                  do {
                    local_3c = local_3c + -1;
                    local_48[0] = 0xfffd;
                    if (local_3c == (FARPROC)0x0) break;
                    local_4c = local_4c + -1;
                    iVar20 = iVar20 + 1;
                    SetFilePointer(local_14,iVar20,(PLONG)0x0,1);
                    iVar16 = MultiByteToWideChar(0,8,(LPCSTR)((int)&param_1 + 2),(int)local_3c,
                                                 (LPWSTR)local_48,1);
                  } while (iVar16 == 0);
                }
                goto LAB_0040275c;
              }
LAB_00402792:
              FUN_00406193((LPWSTR)local_10,local_48[0] & 0xffff);
              goto LAB_00402ac8;
            }
            break;
          }
          if (((((HWND)local_20.dwLowDateTime == (HWND)0x0) && (local_c == (HWND)0x0)) &&
              (iVar20 = FUN_00405e1f(local_14,0), iVar20 < 0)) ||
             (iVar20 = FUN_00405dc1(local_14,local_48,2), iVar20 == 0)) break;
LAB_0040275c:
          if ((HWND)local_20.dwLowDateTime != (HWND)0x0) goto LAB_00402792;
          sVar1 = (short)local_48[0];
          if ((local_38._4_2_ == 0xd) || (local_38._4_2_ == 10)) {
            if ((local_38._4_2_ == sVar1) || ((sVar1 != 0xd && (sVar1 != 10)))) {
              SetFilePointer(local_14,-(int)local_4c,(PLONG)0x0,1);
            }
            else {
              *(short *)((int)&local_10->unused + (int)local_c * 2) = sVar1;
              local_c = (HWND)((int)local_c + 1);
            }
            break;
          }
          iVar20 = (int)local_c + 1;
          *(short *)((int)&local_10->unused + (int)local_c * 2) = sVar1;
          local_c = (HWND)iVar20;
          if ((sVar1 == 0) || (local_38._4_4_ = (HWND)local_48[0], (int)local_40 <= iVar20)) break;
        } while( true );
      }
    }
    bVar25 = local_c == (HWND)0x0;
    *(undefined2 *)((int)&local_10->unused + (int)local_c * 2) = 0;
    goto LAB_004015b6;
  case 0x3a:
    if ((short)pHVar22->unused != 0) {
      uVar27 = FUN_00402c15(2);
      lDistanceToMove = (LONG)uVar27;
      local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
      local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
      lpDistanceToMoveHigh = (PLONG)0x0;
      pvVar13 = (HANDLE)FUN_004061ac((ushort *)pHVar22);
      pHVar19 = (HWND)SetFilePointer(pvVar13,lDistanceToMove,lpDistanceToMoveHigh,
                                     local_20.dwLowDateTime);
      pHVar22 = local_10;
      goto joined_r0x00402810;
    }
    break;
  case 0x3b:
    pvVar13 = (HANDLE)FUN_004061ac((ushort *)pHVar22);
    if (pvVar13 != (HANDLE)0x0) {
      FindClose(pvVar13);
    }
    break;
  case 0x3c:
    pvVar13 = (HANDLE)FUN_004061ac((ushort *)local_10);
    if ((pvVar13 != (HANDLE)0x0) && (BVar15 = FindNextFileW(pvVar13,&local_2d8), BVar15 != 0)) {
LAB_0040289a:
      pWVar23 = local_2d8.cFileName;
      goto LAB_004029db;
    }
    goto LAB_00402853;
  case 0x3d:
    pWVar21 = FUN_00402c37(2);
    pvVar13 = FindFirstFileW(pWVar21,&local_2d8);
    if (pvVar13 != (HANDLE)0xffffffff) {
      FUN_00406193((LPWSTR)local_10,pvVar13);
      goto LAB_0040289a;
    }
    *(undefined2 *)&local_10->unused = 0;
LAB_00402882:
    *(undefined2 *)&pHVar22->unused = 0;
LAB_00402885:
    local_8 = (HWND)0x1;
    break;
  case 0x3e:
    local_38._4_4_ = (HWND)0xfffffd66;
    pFVar17 = (FARPROC)FUN_00402c37(0xfffffff0);
    local_3c = pFVar17;
    iVar20 = FUN_00405b94((ushort *)pFVar17);
    if (iVar20 == 0) {
      FUN_00402c37(0xffffffed);
    }
    FUN_00405d19((LPCWSTR)pFVar17);
    param_1 = (HWND)FUN_00405d3e((LPCWSTR)pFVar17,0x40000000,2);
    if (param_1 != (HWND)0xffffffff) {
      local_40 = DAT_0042a218;
      hMem = GlobalAlloc(0x40,(SIZE_T)DAT_0042a218);
      if (hMem != (HGLOBAL)0x0) {
        FUN_004032f5(0);
        FUN_004032df(hMem,(DWORD)local_40);
        piVar18 = (int *)GlobalAlloc(0x40,(SIZE_T)local_24);
        local_5c.bottom._0_2_ = SUB42(piVar18,0);
        local_5c.bottom._2_2_ = (undefined2)((uint)piVar18 >> 0x10);
        if (piVar18 != (int *)0x0) {
          FUN_004030fa((int)local_2c[1],(HANDLE)0x0,(undefined *)piVar18,(uint)local_24);
          for (; (char)*piVar18 != '\0'; piVar18 = (int *)((int)(piVar18 + 2) + (int)local_38)) {
            local_38._0_4_ = *piVar18;
            FUN_00405cf9((undefined1 *)(piVar18[1] + (int)hMem),(int)(piVar18 + 2),(int)local_38);
          }
          GlobalFree((HGLOBAL)CONCAT22(local_5c.bottom._2_2_,(undefined2)local_5c.bottom));
        }
        FUN_00405df0(param_1,hMem,(DWORD)local_40);
        GlobalFree(hMem);
        local_38._4_4_ = (HWND)FUN_004030fa(-1,param_1,(undefined *)0x0,0);
      }
      CloseHandle(param_1);
    }
    iVar20 = -0xd;
    if ((int)local_38._4_4_ < 0) {
      iVar20 = -0x11;
      DeleteFileW((LPCWSTR)local_3c);
      local_8 = (HWND)0x1;
    }
LAB_00402245:
    FUN_00401423(iVar20);
    break;
  case 0x3f:
    uVar27 = FUN_00402c15(0);
    uVar29 = (uint)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    if (DAT_0042a24c <= uVar29) goto LAB_00402885;
    iVar20 = uVar29 * 0x818 + DAT_0042a248;
    if (-1 < (int)local_24) {
      pHVar22 = local_10;
      pHVar19 = *(HWND *)(iVar20 + (int)local_24 * 4);
      if (local_24 == (HWND)0x0) {
        pWVar23 = (WCHAR *)(iVar20 + 0x18);
        goto LAB_004029db;
      }
      goto switchD_00401ad5_default;
    }
    local_24 = (HWND)(-1 - (int)local_24);
    if (local_24 == (HWND)0x0) {
      FUN_0040626e((LPWSTR)(iVar20 + 0x18),local_20.dwHighDateTime);
      *(byte *)(iVar20 + 9) = *(byte *)(iVar20 + 9) | 1;
    }
    else {
      uVar27 = FUN_00402c15(1);
      local_2c[1] = (HWND)uVar27;
      local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
      local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    }
    *(HWND *)(iVar20 + (int)local_24 * 4) = local_2c[1];
    if ((HWND)local_20.dwLowDateTime != (HWND)0x0) {
      FUN_0040117d(uVar29);
    }
    break;
  case 0x40:
    uVar27 = FUN_00402c15(0);
    uVar29 = (uint)uVar27;
    local_5c.bottom._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_5c.bottom._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    if (0x1f < uVar29) goto LAB_00402885;
    if ((HWND)local_20.dwLowDateTime == (HWND)0x0) {
      if (local_24 == (HWND)0x0) {
        FUN_0040626e((LPWSTR)local_10,*(int *)(DAT_0042a214 + 0x94 + uVar29 * 4));
      }
      else {
        *(HWND *)(DAT_0042a214 + 0x94 + uVar29 * 4) = local_2c[1];
      }
    }
    else {
      if (local_24 == (HWND)0x0) {
        pHVar19 = (HWND)FUN_004012e2(0);
        pHVar22 = local_10;
        goto switchD_00401ad5_default;
      }
      FUN_00401299(uVar29);
      FUN_004011ef(0,0);
    }
    break;
  case 0x43:
    SendMessageW(DAT_0042a208,0xb,DAT_004256e8 & (uint)local_2c[0],0);
    if (local_2c[0] != (HWND)0x0) {
      InvalidateRect(local_c,(RECT *)0x0,0);
    }
  }
switchD_0040148a_caseD_41:
  _DAT_0042a2a8 = (int)&local_8->unused + _DAT_0042a2a8;
LAB_00402ac8:
  local_2c[0] = (HWND)0x0;
switchD_0040148a_caseD_2:
  return local_2c[0];
}



/* Function: FUN_00402c15 */

void __cdecl FUN_00402c15(int param_1)

{
  ushort *puVar1;
  
  puVar1 = (ushort *)FUN_0040626e((LPWSTR)0x0,*(int *)(DAT_0040cda8 + param_1 * 4));
  FUN_004061ac(puVar1);
  return;
}



/* Function: FUN_00402c37 */

LPCWSTR FUN_00402c37(uint param_1)

{
  uint uVar1;
  LPCWSTR pWVar2;
  
  uVar1 = param_1;
  if ((int)param_1 < 0) {
    uVar1 = -param_1;
  }
  pWVar2 = (LPCWSTR)FUN_0040626e((LPWSTR)(&DAT_0040a5a8 + ((int)uVar1 >> 4) * 0x800),
                                 *(int *)(DAT_0040cda8 + (uVar1 & 0xf) * 4));
  if ((int)param_1 < 0) {
    FUN_004064e0(pWVar2);
  }
  return pWVar2;
}



/* Function: FUN_00402c77 */

uint FUN_00402c77(HKEY param_1)

{
  uint uVar1;
  LPCWSTR pWVar2;
  uint uVar3;
  LSTATUS LVar4;
  HKEY *ppHVar5;
  
  ppHVar5 = &param_1;
  uVar1 = (uint)param_1 | 0x100020;
  pWVar2 = FUN_00402c37(0x22);
  uVar3 = FUN_00402caf(*(int *)(DAT_0040cda8 + 4));
  LVar4 = FUN_004060b9(uVar3,pWVar2,uVar1,ppHVar5);
  return ~-(uint)(LVar4 != 0) & (uint)param_1;
}



/* Function: FUN_00402caf */

int FUN_00402caf(int param_1)

{
  if (-1 < param_1) {
    param_1 = DAT_0042a2a4 + -0x7fffffff + param_1;
  }
  return param_1;
}



/* Function: FUN_00402cc7 */

uint FUN_00402cc7(int param_1,LPCWSTR param_2,HKEY param_3)

{
  uint uVar1;
  uint uVar2;
  LSTATUS LVar3;
  HKEY *ppHVar4;
  
  ppHVar4 = &param_3;
  uVar1 = (uint)param_3 | 0x100020;
  uVar2 = FUN_00402caf(param_1);
  LVar3 = FUN_004060e7(uVar2,param_2,uVar1,ppHVar4);
  return ~-(uint)(LVar3 != 0) & (uint)param_3;
}



/* Function: FUN_00402cf5 */

LSTATUS FUN_00402cf5(int param_1,LPCWSTR param_2,uint param_3)

{
  uint uVar1;
  HKEY pHVar2;
  LSTATUS LVar3;
  uint *puVar4;
  
  param_3 = param_3 | 0x100020;
  puVar4 = &param_3;
  uVar1 = FUN_00402caf(param_1);
  pHVar2 = (HKEY)FUN_0040603e(uVar1,puVar4);
  if (pHVar2 == (HKEY)0x0) {
    LVar3 = 6;
  }
  else {
    LVar3 = FUN_00402d2a(pHVar2,param_2,param_3);
  }
  return LVar3;
}



/* Function: FUN_00402d2a */

LSTATUS FUN_00402d2a(HKEY param_1,LPCWSTR param_2,uint param_3)

{
  LSTATUS LVar1;
  FARPROC pFVar2;
  WCHAR local_214 [262];
  HKEY local_8;
  
  LVar1 = FUN_004060b9((uint)param_1,param_2,CONCAT31((int3)((param_3 & 0x300) >> 8),8),&local_8);
  if (LVar1 == 0) {
    do {
      LVar1 = RegEnumKeyW(local_8,0,local_214,0x105);
      if (LVar1 != 0) break;
      if ((param_3 & 1) != 0) {
        RegCloseKey(local_8);
        return 1;
      }
      LVar1 = FUN_00402d2a(local_8,local_214,param_3);
    } while (LVar1 == 0);
    RegCloseKey(local_8);
    pFVar2 = FUN_00406626(3);
    if (pFVar2 == (FARPROC)0x0) {
      LVar1 = RegDeleteKeyW(param_1,param_2);
    }
    else {
      LVar1 = (*pFVar2)(param_1,param_2,param_3 & 0x300,0);
    }
  }
  return LVar1;
}



/* Function: FUN_00402dd7 */

undefined4 FUN_00402dd7(HWND param_1,int param_2)

{
  int iVar1;
  WCHAR local_84 [64];
  
  if (param_2 == 0x110) {
    SetTimer(param_1,1,0xfa,(TIMERPROC)0x0);
    param_2 = 0x113;
  }
  if (param_2 == 0x113) {
    iVar1 = DAT_0040ce98;
    if (DAT_00418ea4 <= DAT_0040ce98) {
      iVar1 = DAT_00418ea4;
    }
    iVar1 = MulDiv(iVar1,100,DAT_00418ea4);
    wsprintfW(local_84,u_verifying_installer___d___0040a01c,iVar1);
    SetWindowTextW(param_1,local_84);
    SetDlgItemTextW(param_1,0x406,local_84);
  }
  return 0;
}



/* Function: FUN_00402e5d */

void __cdecl FUN_00402e5d(int param_1)

{
  DWORD DVar1;
  
  if (param_1 != 0) {
    if (DAT_00418ea0 != (HWND)0x0) {
      DestroyWindow(DAT_00418ea0);
    }
    DAT_00418ea0 = (HWND)0x0;
    return;
  }
  if (DAT_00418ea0 != (HWND)0x0) {
    FUN_00406662(0);
    return;
  }
  DVar1 = GetTickCount();
  if (DAT_0042a210 < DVar1) {
    DAT_00418ea0 = CreateDialogParamW(DAT_0042a200,(LPCWSTR)0x6f,(HWND)0x0,FUN_00402dd7,0);
    ShowWindow(DAT_00418ea0,5);
  }
  return;
}



/* Function: FUN_00402ec1 */

wchar_t * FUN_00402ec1(uint param_1)

{
  DWORD DVar1;
  HANDLE hFile;
  LPCWSTR pWVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  undefined4 *puVar6;
  int *piVar7;
  uint uVar8;
  uint local_2c;
  int local_28;
  int local_24;
  int local_20;
  int local_1c;
  SIZE_T local_18;
  int local_14;
  HANDLE local_10;
  uint local_c;
  int local_8;
  
  local_c = 0;
  local_8 = 0;
  DVar1 = GetTickCount();
  DAT_0042a210 = DVar1 + 1000;
  GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_00438800,0x400);
  hFile = (HANDLE)FUN_00405d3e((LPCWSTR)&DAT_00438800,0x80000000,3);
  if (hFile == (HANDLE)0xffffffff) {
    DAT_0040a018 = hFile;
    return u_Error_launching_installer_0040a1e8;
  }
  DAT_0040a018 = hFile;
  local_10 = hFile;
  FUN_0040624c((LPWSTR)&DAT_00436800,(LPCWSTR)&DAT_00438800);
  pWVar2 = FUN_00405b69((LPCWSTR)&DAT_00436800);
  FUN_0040624c((LPWSTR)&DAT_00439000,pWVar2);
  uVar3 = GetFileSize(hFile,(LPDWORD)0x0);
  DAT_00418ea4 = uVar3;
  for (; 0 < (int)uVar3; uVar3 = uVar3 - uVar8) {
    uVar4 = (-(uint)(DAT_0042a218 != 0) & 0x7e00) + 0x200;
    uVar8 = uVar3;
    if ((int)uVar4 <= (int)uVar3) {
      uVar8 = uVar4;
    }
    iVar5 = FUN_004032df(&DAT_00418ea8,uVar8);
    if (iVar5 == 0) {
      FUN_00402e5d(1);
      goto LAB_00403099;
    }
    if (DAT_0042a218 == 0) {
      FUN_00405cf9((undefined1 *)&local_2c,0x418ea8,0x1c);
      if (((((local_2c & 0xfffffff0) == 0) && (local_28 == -0x21524111)) && (local_1c == 0x74736e49)
          ) && ((local_20 == 0x74666f73 && (local_24 == 0x6c6c754e)))) {
        param_1 = param_1 | local_2c;
        DAT_0042a2c0 = DAT_0042a2c0 | param_1 & 2;
        DAT_0042a218 = DAT_0040ce98;
        if ((int)uVar3 < local_14) goto LAB_00403099;
        if (((param_1 & 8) == 0) && ((param_1 & 4) != 0)) break;
        local_8 = local_8 + 1;
        uVar3 = local_14 - 4;
        if (uVar3 < uVar8) {
          uVar8 = uVar3;
        }
      }
    }
    else if ((param_1 & 2) == 0) {
      FUN_00402e5d(0);
    }
    if ((int)uVar3 < (int)DAT_00418ea4) {
      local_c = FUN_00406719(local_c,&DAT_00418ea8,uVar8);
    }
    DAT_0040ce98 = DAT_0040ce98 + uVar8;
  }
  FUN_00402e5d(1);
  if (DAT_0042a218 != 0) {
    if (local_8 != 0) {
      FUN_004032f5(DAT_0040ce98);
      iVar5 = FUN_004032df(&param_1,4);
      if ((iVar5 == 0) || (local_c != param_1)) goto LAB_00403099;
    }
    puVar6 = (undefined4 *)GlobalAlloc(0x40,local_18);
    FUN_004032f5(DAT_0042a218 + 0x1c);
    DVar1 = FUN_004030fa(-1,(HANDLE)0x0,(undefined *)puVar6,local_18);
    if (DVar1 == local_18) {
      DAT_0042a21c = *puVar6;
      if ((local_2c & 1) != 0) {
        DAT_0042a220 = DAT_0042a220 + 1;
      }
      piVar7 = puVar6 + 0x11;
      iVar5 = 8;
      DAT_0042a214 = puVar6;
      do {
        piVar7 = piVar7 + -2;
        *piVar7 = *piVar7 + (int)puVar6;
        iVar5 = iVar5 + -1;
      } while (iVar5 != 0);
      DVar1 = SetFilePointer(local_10,0,(PLONG)0x0,1);
      puVar6[0xf] = DVar1;
      FUN_00405cf9(&DAT_0042a240,(int)(puVar6 + 1),0x40);
      return (wchar_t *)0x0;
    }
  }
LAB_00403099:
  return u_Installer_integrity_check_has_fa_0040a050;
}



/* Function: FUN_004030fa */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

DWORD FUN_004030fa(int param_1,HANDLE param_2,undefined *param_3,uint param_4)

{
  int iVar1;
  DWORD DVar2;
  undefined *puVar3;
  DWORD DVar4;
  uint uVar5;
  WCHAR local_94 [64];
  int local_14;
  DWORD local_10;
  DWORD local_c;
  DWORD local_8;
  
  uVar5 = param_4;
  local_c = param_4;
  if (param_3 == (undefined *)0x0) {
    local_c = 0x8000;
  }
  local_8 = 0;
  puVar3 = param_3;
  if (param_3 == (undefined *)0x0) {
    puVar3 = &DAT_00410ea0;
  }
  if (-1 < param_1) {
    FUN_004032f5(DAT_0042a278 + param_1);
  }
  iVar1 = FUN_004032df(&param_4,4);
  if (iVar1 != 0) {
    if ((param_4 & 0x80000000) == 0) {
      if (param_3 == (undefined *)0x0) {
        while( true ) {
          if ((int)param_4 < 1) {
            return local_8;
          }
          uVar5 = local_c;
          if ((int)param_4 < (int)local_c) {
            uVar5 = param_4;
          }
          iVar1 = FUN_004032df(&DAT_0040cea0,uVar5);
          if (iVar1 == 0) break;
          iVar1 = FUN_00405df0(param_2,&DAT_0040cea0,uVar5);
          if (iVar1 == 0) {
            return 0xfffffffe;
          }
          local_8 = local_8 + uVar5;
          param_4 = param_4 - uVar5;
        }
      }
      else {
        if ((int)param_4 < (int)uVar5) {
          uVar5 = param_4;
        }
        iVar1 = FUN_004032df(param_3,uVar5);
        if (iVar1 != 0) {
          return uVar5;
        }
      }
    }
    else {
      local_10 = GetTickCount();
      FUN_00406787(0x40ce10);
      uVar5 = param_4 & 0x7fffffff;
      param_4 = uVar5;
      if (uVar5 == 0) {
        return local_8;
      }
      while( true ) {
        DVar2 = 0x4000;
        if ((int)param_4 < 0x4000) {
          DVar2 = param_4;
        }
        iVar1 = FUN_004032df(&DAT_0040cea0,DVar2);
        if (iVar1 == 0) break;
        param_4 = param_4 - DVar2;
        _DAT_0040ce28 = &DAT_0040cea0;
        _DAT_0040ce2c = DVar2;
        while( true ) {
          _DAT_0040ce34 = local_c;
          DAT_0040ce30 = puVar3;
          local_14 = FUN_004067a7((SIZE_T *)&DAT_0040ce10);
          if (local_14 < 0) {
            return 0xfffffffc;
          }
          DVar4 = (int)DAT_0040ce30 - (int)puVar3;
          DVar2 = GetTickCount();
          if ((((byte)DAT_0042a2d4 & 1) != 0) && ((200 < DVar2 - local_10 || (param_4 == 0)))) {
            iVar1 = MulDiv(uVar5 - param_4,100,uVar5);
            wsprintfW(local_94,u______d___0040a21c,iVar1);
            FUN_004052b0(0,local_94);
            local_10 = DVar2;
          }
          if (DVar4 == 0) break;
          if (param_3 == (undefined *)0x0) {
            iVar1 = FUN_00405df0(param_2,puVar3,DVar4);
            if (iVar1 == 0) {
              return 0xfffffffe;
            }
          }
          else {
            local_c = local_c - DVar4;
            puVar3 = DAT_0040ce30;
          }
          local_8 = local_8 + DVar4;
          if (local_14 == 1) {
            return local_8;
          }
        }
        if ((int)param_4 < 1) {
          return local_8;
        }
      }
    }
  }
  return 0xfffffffd;
}



/* Function: FUN_004032df */

void FUN_004032df(LPVOID param_1,DWORD param_2)

{
  FUN_00405dc1(DAT_0040a018,param_1,param_2);
  return;
}



/* Function: FUN_004032f5 */

void FUN_004032f5(LONG param_1)

{
  SetFilePointer(DAT_0040a018,param_1,(PLONG)0x0,0);
  return;
}



/* Function: FUN_0040330c */

void FUN_0040330c(void)

{
  int iVar1;
  
  FUN_004064e0((LPCWSTR)&DAT_00437800);
  iVar1 = FUN_00405b94((ushort *)&DAT_00437800);
  if (iVar1 == 0) {
    return;
  }
  FUN_00405b1d((LPCWSTR)&DAT_00437800);
  FUN_004057fc((LPCWSTR)&DAT_00437800);
  FUN_00405d6d((LPWSTR)&DAT_00437000,(LPCWSTR)&DAT_00437800);
  return;
}



/* Function: entry */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void entry(void)

{
  bool bVar1;
  DWORD DVar2;
  FARPROC pFVar3;
  int iVar4;
  LPWSTR pWVar5;
  short *psVar6;
  LPCWSTR pWVar7;
  WCHAR *pWVar8;
  int *piVar9;
  undefined3 extraout_var;
  int iVar10;
  HANDLE pvVar11;
  BOOL BVar12;
  WCHAR *pWVar13;
  WCHAR WVar14;
  char *lpString;
  WCHAR WVar15;
  LPWSTR *TokenHandle;
  wchar_t *local_2d4;
  UINT local_2d0;
  LPWSTR pWStack_2cc;
  uint local_2c8;
  _TOKEN_PRIVILEGES _Stack_2c4;
  SHFILEINFOW SStack_2b4;
  
  WVar15 = L' ';
  local_2d0 = 0;
  local_2d4 = u_Error_writing_temporary_file__Ma_0040a2e0;
  local_2c8 = 0;
  SetErrorMode(0x8001);
  DVar2 = GetVersion();
  DAT_0042a20c = DVar2 & 0xbfffffff;
  if (((short)DAT_0042a20c != 6) && (pFVar3 = FUN_00406626(0), pFVar3 != (FARPROC)0x0)) {
    (*pFVar3)(0xc00);
  }
  lpString = "UXTHEME";
  do {
    FUN_004065b6(lpString);
    iVar4 = lstrlenA(lpString);
    lpString = lpString + iVar4 + 1;
  } while (*lpString != '\0');
  FUN_00406626(10);
  DAT_0042a204 = FUN_00406626(8);
  pFVar3 = FUN_00406626(6);
  if ((pFVar3 != (FARPROC)0x0) && (iVar4 = (*pFVar3)(0x1e), iVar4 != 0)) {
    DAT_0042a20c = DAT_0042a20c | 0x40000000;
  }
  Ordinal_17();
  DAT_0042a2d8 = OleInitialize((LPVOID)0x0);
  SHGetFileInfoW((LPCWSTR)&DAT_004216a8,0,&SStack_2b4,0x2b4,0);
  FUN_0040624c((LPWSTR)&DAT_00429200,u_NSIS_Error_0040a2c8);
  pWVar5 = GetCommandLineW();
  FUN_0040624c(&DAT_00435000,pWVar5);
  DAT_0042a200 = GetModuleHandleW((LPCWSTR)0x0);
  psVar6 = &DAT_00435000;
  if (DAT_00435000 == 0x22) {
    psVar6 = (short *)&DAT_00435002;
    WVar15 = L'\"';
  }
  pWVar7 = (LPCWSTR)FUN_00405b4a(psVar6,WVar15);
  pWVar8 = CharNextW(pWVar7);
  WVar15 = *pWVar8;
  pWStack_2cc = pWVar8;
  while (WVar15 != L'\0') {
    WVar14 = L' ';
    while (WVar15 == L' ') {
      pWVar8 = pWVar8 + 1;
      WVar15 = *pWVar8;
    }
    if (*pWVar8 == L'\"') {
      pWVar8 = pWVar8 + 1;
      WVar14 = L'\"';
    }
    pWVar13 = pWVar8;
    if (*pWVar8 == L'/') {
      pWVar13 = pWVar8 + 1;
      if ((*pWVar13 == L'S') && ((pWVar8[2] == L' ' || (pWVar8[2] == L'\0')))) {
        DAT_0042a2c0 = 1;
      }
      if (((*(int *)pWVar13 == CONCAT22(DAT_0040a2be,DAT_0040a2bc)) &&
          (*(uint *)(pWVar8 + 3) == (CONCAT22(DAT_0040a2c2,DAT_0040a2c0) | (int)DAT_0040a2be >> 0xf)
          )) && ((pWVar8[5] == L' ' || (pWVar8[5] == L'\0')))) {
        local_2c8 = local_2c8 | 4;
      }
      if ((*(int *)(pWVar8 + -1) == CONCAT22(DAT_0040a2b2,DAT_0040a2b0)) &&
         (*(uint *)pWVar13 == (CONCAT22(DAT_0040a2b6,DAT_0040a2b4) | (int)DAT_0040a2b2 >> 0xf))) {
        pWVar8[-1] = L'\0';
        FUN_0040624c(&DAT_00435800,pWVar8 + 3);
        break;
      }
    }
    pWVar8 = (WCHAR *)FUN_00405b4a(pWVar13,WVar14);
    if (*pWVar8 == L'\"') {
      pWVar8 = pWVar8 + 1;
    }
    WVar15 = *pWVar8;
  }
  GetTempPathW(0x400,(LPWSTR)&DAT_00437800);
  iVar4 = FUN_0040330c();
  if (iVar4 == 0) {
    GetWindowsDirectoryW((LPWSTR)&DAT_00437800,0x3fb);
    lstrcatW((LPWSTR)&DAT_00437800,u__Temp_0040a2a4);
    iVar4 = FUN_0040330c();
    if (iVar4 == 0) {
      GetTempPathW(0x3fc,(LPWSTR)&DAT_00437800);
      lstrcatW((LPWSTR)&DAT_00437800,(LPCWSTR)&DAT_0040a29c);
      SetEnvironmentVariableW(u_TEMP_0040a290,(LPCWSTR)&DAT_00437800);
      SetEnvironmentVariableW((LPCWSTR)&DAT_0040a288,(LPCWSTR)&DAT_00437800);
      iVar4 = FUN_0040330c();
      if (iVar4 == 0) goto LAB_004036ae;
    }
  }
  DeleteFileW((LPCWSTR)&DAT_00437000);
  local_2d4 = FUN_00402ec1(local_2c8);
  if (local_2d4 != (wchar_t *)0x0) goto LAB_004036ae;
  if (DAT_0042a220 != 0) {
    piVar9 = (int *)FUN_00405b4a(&DAT_00435000,L'\0');
    if ((int *)0x434fff < piVar9) {
      do {
        if ((*piVar9 == CONCAT22(DAT_0040a27e,DAT_0040a27c)) &&
           (piVar9[1] == (CONCAT22(DAT_0040a282,DAT_0040a280) | (int)DAT_0040a27e >> 0xf))) break;
        piVar9 = (int *)((int)piVar9 + -2);
      } while ((int *)0x434fff < piVar9);
    }
    local_2d4 = u_Error_launching_installer_0040a1e8;
    if (piVar9 < &DAT_00435000) {
      iVar4 = FUN_00405819();
      lstrcatW((LPWSTR)&DAT_00437800,u__nsu_0040a270);
      if (iVar4 != 0) {
        lstrcatW((LPWSTR)&DAT_00437800,(LPCWSTR)&DAT_0040a26c);
      }
      lstrcatW((LPWSTR)&DAT_00437800,u__tmp_0040a260);
      iVar10 = lstrcmpiW((LPCWSTR)&DAT_00437800,(LPCWSTR)&DAT_00436800);
      if (iVar10 != 0) {
        if (iVar4 == 0) {
          FUN_004057fc((LPCWSTR)&DAT_00437800);
        }
        else {
          FUN_0040577f((LPCWSTR)&DAT_00437800);
        }
        SetCurrentDirectoryW((LPCWSTR)&DAT_00437800);
        if (DAT_00435800 == 0) {
          FUN_0040624c(&DAT_00435800,(LPCWSTR)&DAT_00436800);
        }
        FUN_0040624c((LPWSTR)&DAT_0042b000,pWStack_2cc);
        _DAT_0042b800 = CONCAT22(DAT_0040a25a,DAT_0040a258);
        iVar4 = 0x1a;
        do {
          FUN_0040626e((LPWSTR)&DAT_00420ea8,*(int *)(DAT_0042a214 + 0x120));
          DeleteFileW((LPCWSTR)&DAT_00420ea8);
          if ((local_2d4 != (wchar_t *)0x0) &&
             (BVar12 = CopyFileW((LPCWSTR)&DAT_00438800,(LPCWSTR)&DAT_00420ea8,1), BVar12 != 0)) {
            FUN_00406012((LPCWSTR)&DAT_00420ea8,(LPCWSTR)0x0);
            FUN_0040626e((LPWSTR)&DAT_00420ea8,*(int *)(DAT_0042a214 + 0x124));
            pvVar11 = FUN_00405831((LPWSTR)&DAT_00420ea8);
            if (pvVar11 != (HANDLE)0x0) {
              CloseHandle(pvVar11);
              local_2d4 = (wchar_t *)0x0;
            }
          }
          _DAT_0042b800 = _DAT_0042b800 + 1;
          iVar4 = iVar4 + -1;
        } while (iVar4 != 0);
        FUN_00406012((LPCWSTR)&DAT_00437800,(LPCWSTR)0x0);
      }
      goto LAB_004036ae;
    }
    *(undefined2 *)piVar9 = 0;
    pWVar7 = (LPCWSTR)(piVar9 + 2);
    bVar1 = FUN_00405c25(pWVar7);
    if (CONCAT31(extraout_var,bVar1) == 0) goto LAB_004036ae;
    FUN_0040624c(&DAT_00435800,pWVar7);
    FUN_0040624c((LPWSTR)&DAT_00436000,pWVar7);
    local_2d4 = (wchar_t *)0x0;
  }
  DAT_0042a2cc = -1;
  local_2d0 = FUN_0040395a();
LAB_004036ae:
  FUN_00403880();
  OleUninitialize();
  if (local_2d4 == (wchar_t *)0x0) {
    if (DAT_0042a2b4 != 0) {
      TokenHandle = &pWStack_2cc;
      DVar2 = 0x28;
      pvVar11 = GetCurrentProcess();
      BVar12 = OpenProcessToken(pvVar11,DVar2,TokenHandle);
      if (BVar12 != 0) {
        LookupPrivilegeValueW
                  ((LPCWSTR)0x0,u_SeShutdownPrivilege_0040a230,&_Stack_2c4.Privileges[0].Luid);
        _Stack_2c4.PrivilegeCount = 1;
        _Stack_2c4.Privileges[0].Attributes = 2;
        AdjustTokenPrivileges(pWStack_2cc,0,&_Stack_2c4,0,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0);
      }
      pFVar3 = FUN_00406626(4);
      if (((pFVar3 != (FARPROC)0x0) && (iVar4 = (*pFVar3)(0,0,0,0x25,0x80040002), iVar4 == 0)) ||
         (BVar12 = ExitWindowsEx(2,0x80040002), BVar12 == 0)) {
        FUN_0040140b(9);
      }
    }
    if (DAT_0042a2cc != -1) {
      local_2d0 = DAT_0042a2cc;
    }
                    /* WARNING: Subroutine does not return */
    ExitProcess(local_2d0);
  }
  FUN_004058ae(local_2d4,0x200010);
                    /* WARNING: Subroutine does not return */
  ExitProcess(2);
}



/* Function: FUN_00403880 */

void FUN_00403880(void)

{
  if (DAT_0040a018 != (HANDLE)0xffffffff) {
    CloseHandle(DAT_0040a018);
    DAT_0040a018 = (HANDLE)0xffffffff;
  }
  FUN_004038c5();
  FUN_0040595a((LPCWSTR)&DAT_00438000,7);
  return;
}



/* Function: FUN_004038aa */

void FUN_004038aa(undefined4 param_1)

{
  undefined4 *puVar1;
  
  for (puVar1 = DAT_004216ac; puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1) {
    (*(code *)puVar1[1])(param_1);
  }
  return;
}



/* Function: FUN_004038c5 */

void FUN_004038c5(void)

{
  int *piVar1;
  int *hMem;
  
  hMem = DAT_004216ac;
  FUN_004038aa(0);
  if (hMem != (int *)0x0) {
    do {
      piVar1 = (int *)*hMem;
      FreeLibrary((HMODULE)hMem[2]);
      GlobalFree(hMem);
      hMem = piVar1;
    } while (piVar1 != (int *)0x0);
  }
  DAT_004216ac = (int *)0x0;
  return;
}



/* Function: FUN_004038fa */

undefined4 FUN_004038fa(int param_1)

{
  undefined4 *puVar1;
  
  puVar1 = DAT_004216ac;
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 1;
    }
    if (puVar1[2] == param_1) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  return 0;
}



/* Function: FUN_00403918 */

undefined4 FUN_00403918(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  iVar1 = FUN_004038fa(param_1);
  if (iVar1 == 0) {
    uVar2 = 1;
  }
  else {
    puVar3 = (undefined4 *)GlobalAlloc(0x40,0xc);
    if (puVar3 == (undefined4 *)0x0) {
      uVar2 = 0xffffffff;
    }
    else {
      puVar3[2] = param_1;
      puVar3[1] = param_2;
      *puVar3 = DAT_004216ac;
      uVar2 = 0;
      DAT_004216ac = puVar3;
    }
  }
  return uVar2;
}



/* Function: FUN_0040395a */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

INT_PTR FUN_0040395a(void)

{
  bool bVar1;
  ATOM AVar2;
  FARPROC pFVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined2 *puVar5;
  int iVar6;
  DWORD DVar7;
  LPCWSTR pWVar8;
  undefined3 extraout_var_00;
  int iVar9;
  BOOL BVar10;
  INT_PTR IVar11;
  short *lpString;
  int iStack_10;
  int iStack_c;
  int iStack_8;
  int iStack_4;
  
  iVar9 = DAT_0042a214;
  pFVar3 = FUN_00406626(2);
  if (pFVar3 == (FARPROC)0x0) {
    _DAT_00437000 = 0x30;
    _DAT_00437002 = 0x78;
    _DAT_00437004 = 0;
    FUN_0040611a(0x80000001,L"Control Panel\\Desktop\\ResourceLocale",(LPCWSTR)0x0,
                 (LPBYTE)&DAT_004236e8,(HKEY)0x0);
    if (DAT_004236e8 == 0) {
      FUN_0040611a(0x80000003,L".DEFAULT\\Control Panel\\International",L"Locale",
                   (LPBYTE)&DAT_004236e8,(HKEY)0x0);
    }
    lstrcatW((LPWSTR)&DAT_00437000,&DAT_004236e8);
  }
  else {
    uVar4 = (*pFVar3)();
    FUN_00406193((LPWSTR)&DAT_00437000,uVar4 & 0xffff);
  }
  FUN_00403c30();
  DAT_0042a2a0 = DAT_0042a21c & 0x20;
  _DAT_0042a2bc = 0x10000;
  bVar1 = FUN_00405c25(&DAT_00435800);
  if ((CONCAT31(extraout_var,bVar1) == 0) && (*(int *)(iVar9 + 0x48) != 0)) {
    lpString = &DAT_004281a0;
    FUN_0040611a(*(uint *)(iVar9 + 0x44),(LPCWSTR)(DAT_0042a258 + *(int *)(iVar9 + 0x48) * 2),
                 (LPCWSTR)(DAT_0042a258 + *(int *)(iVar9 + 0x4c) * 2),(LPBYTE)&DAT_004281a0,
                 (HKEY)0x0);
    if (DAT_004281a0 != 0) {
      if (DAT_004281a0 == 0x22) {
        lpString = (short *)&DAT_004281a2;
        puVar5 = (undefined2 *)FUN_00405b4a((LPCWSTR)&DAT_004281a2,L'\"');
        *puVar5 = 0;
      }
      iVar6 = lstrlenW(lpString);
      if (((lpString < lpString + iVar6 + -4) &&
          (iVar6 = lstrcmpiW(lpString + iVar6 + -4,u__exe_0040a388), iVar6 == 0)) &&
         ((DVar7 = GetFileAttributesW(lpString), DVar7 == 0xffffffff || ((DVar7 & 0x10) == 0)))) {
        FUN_00405b69(lpString);
      }
      pWVar8 = FUN_00405b1d(lpString);
      FUN_0040624c(&DAT_00435800,pWVar8);
    }
  }
  bVar1 = FUN_00405c25(&DAT_00435800);
  if (CONCAT31(extraout_var_00,bVar1) == 0) {
    FUN_0040626e(&DAT_00435800,*(int *)(iVar9 + 0x118));
  }
  DAT_004291e8 = LoadImageW(DAT_0042a200,(LPCWSTR)0x67,1,0,0,0x8040);
  if (*(int *)(iVar9 + 0x50) == -1) {
LAB_00403b57:
    iVar9 = FUN_0040140b(0);
    if (iVar9 == 0) {
      FUN_00403c30();
      if (DAT_0042a2c0 == 0) {
        ShowWindow(DAT_004236c8,5);
        iVar9 = FUN_004065b6("RichEd20");
        if (iVar9 == 0) {
          FUN_004065b6("RichEd32");
        }
        BVar10 = GetClassInfoW((HINSTANCE)0x0,L"RichEdit20W",(LPWNDCLASSW)&DAT_004291a0);
        if (BVar10 == 0) {
          GetClassInfoW((HINSTANCE)0x0,L"RichEdit",(LPWNDCLASSW)&DAT_004291a0);
          _DAT_004291c4 = L"RichEdit20W";
          RegisterClassW((WNDCLASSW *)&DAT_004291a0);
        }
        IVar11 = DialogBoxParamW(DAT_0042a200,(LPCWSTR)(DAT_004291e0 + 0x69U & 0xffff),(HWND)0x0,
                                 (DLGPROC)&LAB_00403d08,0);
        FUN_0040140b(5);
        FUN_004038aa(1);
        return IVar11;
      }
      iVar9 = FUN_00405383((HWND)0x0);
      if (iVar9 == 0) {
        FUN_0040140b(1);
        goto LAB_00403c26;
      }
      if (DAT_004291cc == 0) {
        FUN_0040140b(2);
      }
    }
    IVar11 = 2;
  }
  else {
    _DAT_004291a4 = FUN_00401000;
    _DAT_004291b0 = DAT_0042a200;
    _DAT_004291c4 = (wchar_t *)&DAT_0040a380;
    _DAT_004291b4 = DAT_004291e8;
    AVar2 = RegisterClassW((WNDCLASSW *)&DAT_004291a0);
    if (AVar2 != 0) {
      SystemParametersInfoW(0x30,0,&iStack_10,0);
      DAT_004236c8 = CreateWindowExW(0x80,(LPCWSTR)&DAT_0040a380,(LPCWSTR)0x0,0x80000000,iStack_10,
                                     iStack_c,iStack_8 - iStack_10,iStack_4 - iStack_c,(HWND)0x0,
                                     (HMENU)0x0,DAT_0042a200,(LPVOID)0x0);
      goto LAB_00403b57;
    }
LAB_00403c26:
    IVar11 = 0;
  }
  return IVar11;
}



/* Function: FUN_00403c30 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00403c30(void)

{
  int iVar1;
  ushort *puVar2;
  ushort uVar3;
  int iVar4;
  int *piVar5;
  
  uVar3 = 0xffff;
  iVar1 = FUN_004061ac((ushort *)&DAT_00437000);
  do {
    if (DAT_0042a264 != 0) {
      puVar2 = (ushort *)(*(int *)(DAT_0042a214 + 100) * DAT_0042a264 + _DAT_0042a260);
      iVar4 = DAT_0042a264;
      do {
        puVar2 = (ushort *)((int)puVar2 - *(int *)(DAT_0042a214 + 100));
        iVar4 = iVar4 + -1;
        if (((*puVar2 ^ (ushort)iVar1) & uVar3) == 0) {
          DAT_004291e0 = *(undefined4 *)(puVar2 + 1);
          DAT_0042a2c8 = *(undefined4 *)(puVar2 + 3);
          DAT_004291dc = puVar2 + 5;
          if (DAT_004291dc != (ushort *)0x0) {
            FUN_00406193((LPWSTR)&DAT_00437000,(uint)*puVar2);
            FUN_00403ce9();
            piVar5 = DAT_0042a248;
            for (iVar1 = DAT_0042a24c; iVar1 != 0; iVar1 = iVar1 + -1) {
              if (*piVar5 != 0) {
                FUN_0040626e((LPWSTR)(piVar5 + 6),*piVar5);
              }
              piVar5 = piVar5 + 0x206;
            }
            return;
          }
          break;
        }
      } while (iVar4 != 0);
    }
    if (uVar3 == 0xffff) {
      uVar3 = 0x3ff;
    }
    else {
      uVar3 = 0;
    }
  } while( true );
}



/* Function: FUN_00403ce9 */

undefined * FUN_00403ce9(void)

{
  FUN_0040626e((LPWSTR)&DAT_00429200,-2);
  SetWindowTextW(DAT_004236c8,(LPCWSTR)&DAT_00429200);
  return &DAT_00429200;
}



/* Function: FUN_004041ba */

void FUN_004041ba(WPARAM param_1)

{
  if (param_1 == 0x78) {
    DAT_004291cc = DAT_004291cc + 1;
  }
  SendMessageW(DAT_0042a208,0x408,param_1,0);
  return;
}



/* Function: FUN_004041e1 */

void FUN_004041e1(HWND param_1,int param_2,int param_3)

{
  LPCWSTR lpString;
  
  lpString = (LPCWSTR)FUN_0040626e((LPWSTR)0x0,param_3);
  SetDlgItemTextW(param_1,param_2 + 1000,lpString);
  return;
}



/* Function: FUN_00404203 */

void FUN_00404203(BOOL param_1)

{
  EnableWindow(DAT_004236e4,param_1);
  return;
}



/* Function: FUN_00404216 */

void FUN_00404216(WPARAM param_1)

{
  SendMessageW(DAT_0042a208,0x28,param_1,1);
  return;
}



/* Function: FUN_0040422d */

void FUN_0040422d(UINT param_1)

{
  if (DAT_004291d8 != (HWND)0x0) {
    SendMessageW(DAT_004291d8,param_1,0,0);
  }
  return;
}



/* Function: FUN_00404248 */

COLORREF FUN_00404248(int param_1,HDC param_2,HWND param_3)

{
  COLORREF *pCVar1;
  COLORREF color;
  HBRUSH pHVar2;
  LOGBRUSH local_10;
  
  if ((param_1 - 0x133U < 6) &&
     (pCVar1 = (COLORREF *)GetWindowLongW(param_3,-0x15), pCVar1 != (COLORREF *)0x0)) {
    color = *pCVar1;
    if ((pCVar1[5] & 2) != 0) {
      color = GetSysColor(color);
    }
    if ((pCVar1[5] & 1) != 0) {
      SetTextColor(param_2,color);
    }
    SetBkMode(param_2,pCVar1[4]);
    local_10.lbColor = pCVar1[1];
    if ((pCVar1[5] & 8) != 0) {
      local_10.lbColor = GetSysColor(local_10.lbColor);
    }
    if ((pCVar1[5] & 4) != 0) {
      SetBkColor(param_2,local_10.lbColor);
    }
    if ((pCVar1[5] & 0x10) != 0) {
      local_10.lbStyle = pCVar1[2];
      if ((HGDIOBJ)pCVar1[3] != (HGDIOBJ)0x0) {
        DeleteObject((HGDIOBJ)pCVar1[3]);
      }
      pHVar2 = CreateBrushIndirect(&local_10);
      pCVar1[3] = (COLORREF)pHVar2;
    }
    return pCVar1[3];
  }
  return 0;
}



/* Function: FUN_004042f5 */

undefined4 FUN_004042f5(int param_1,LPWSTR param_2,uint param_3,int *param_4)

{
  int iVar1;
  
  lstrcpynW(param_2,(LPCWSTR)(DAT_004216b4 + param_1),param_3 >> 1);
  iVar1 = lstrlenW(param_2);
  *param_4 = iVar1 * 2;
  DAT_004216b4 = DAT_004216b4 + iVar1 * 2;
  return 0;
}



/* Function: FUN_0040432f */

undefined4 FUN_0040432f(int param_1,LPSTR param_2,uint param_3,int *param_4)

{
  uint cchWideChar;
  int iVar1;
  
  cchWideChar = lstrlenW((LPCWSTR)(param_1 + DAT_004216b4 * 2));
  if (param_3 >> 1 <= cchWideChar) {
    cchWideChar = param_3 >> 1;
  }
  iVar1 = WideCharToMultiByte(0,0,(LPCWSTR)(param_1 + DAT_004216b4 * 2),cchWideChar,param_2,param_3,
                              (LPCSTR)0x0,(LPBOOL)0x0);
  *param_4 = iVar1;
  DAT_004216b4 = DAT_004216b4 + iVar1;
  return 0;
}



/* Function: FUN_0040437e */

COLORREF FUN_0040437e(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  uint *puVar1;
  ushort *puVar2;
  LPCWSTR lpString;
  HWND pHVar3;
  DWORD lParam;
  int iVar4;
  HCURSOR pHVar5;
  COLORREF CVar6;
  uint uVar7;
  uint uVar8;
  UINT Msg;
  WPARAM wParam;
  LPARAM lParam_00;
  LPCWSTR local_10;
  int local_c;
  code *local_8;
  
  if (param_2 == 0x110) {
    iVar4 = param_4[0xc].unused;
    if (iVar4 < 0) {
      iVar4 = *(int *)(DAT_004291dc - (iVar4 * 4 + 4));
    }
    puVar2 = (ushort *)(DAT_0042a258 + iVar4 * 2);
    uVar7 = (uint)*puVar2;
    lpString = (LPCWSTR)(puVar2 + 1);
    local_c = 0;
    local_8 = FUN_0040432f;
    if (uVar7 != 2) {
      local_8 = FUN_004042f5;
    }
    uVar8 = (uint)~param_4[5].unused >> 5 & 1 | param_4[5].unused & 1U;
    local_10 = lpString;
    FUN_004041e1(param_1,0x22,param_4[0xd].unused);
    FUN_004041e1(param_1,0x23,param_4[0xe].unused);
    CheckDlgButton(param_1,(uVar8 == 0) + 0x40a,1);
    FUN_00404203(uVar8);
    pHVar3 = GetDlgItem(param_1,1000);
    FUN_00404216((WPARAM)pHVar3);
    SendMessageW(pHVar3,0x45b,1,0);
    lParam = *(DWORD *)(DAT_0042a214 + 0x68);
    if ((int)lParam < 0) {
      lParam = GetSysColor(-lParam);
    }
    SendMessageW(pHVar3,0x443,0,lParam);
    SendMessageW(pHVar3,0x445,0,0x4010000);
    iVar4 = lstrlenW(lpString);
    SendMessageW(pHVar3,0x435,0,iVar4);
    DAT_004216b4 = 0;
    SendMessageW(pHVar3,0x449,uVar7,(LPARAM)&local_10);
    DAT_004216b4 = 0;
    return 0;
  }
  if (param_2 == 0x111) {
    if ((((short)((uint)param_3 >> 0x10) != 0) || (DAT_004216b4 != 0)) ||
       (puVar1 = (uint *)(DAT_004226c0 + 0x14), (*(byte *)puVar1 & 0x20) == 0)) goto LAB_004045f6;
    lParam_00 = 0;
    wParam = 0;
    Msg = 0xf0;
    pHVar3 = GetDlgItem(param_1,0x40a);
    uVar7 = SendMessageW(pHVar3,Msg,wParam,lParam_00);
    *puVar1 = *puVar1 & 0xfffffffe | uVar7 & 1;
    FUN_00404203(uVar7 & 1);
    FUN_00404609();
  }
  if (param_2 == 0x4e) {
    pHVar3 = GetDlgItem(param_1,1000);
    if ((param_4[2].unused == 0x70b) && (param_4[3].unused == 0x201)) {
      local_c = param_4[7].unused;
      local_10 = (LPCWSTR)param_4[6].unused;
      local_8 = (code *)&DAT_004281a0;
      if ((uint)(local_c - (int)local_10) < 0x800) {
        SendMessageW(pHVar3,1099,0,(LPARAM)&local_10);
        pHVar5 = LoadCursorW((HINSTANCE)0x0,(LPCWSTR)0x7f02);
        SetCursor(pHVar5);
        FUN_0040462d(param_1,(LPCWSTR)local_8);
        pHVar5 = LoadCursorW((HINSTANCE)0x0,(LPCWSTR)0x7f00);
        SetCursor(pHVar5);
      }
    }
    if ((param_4[2].unused == 0x700) && (param_4[3].unused == 0x100)) {
      if (param_4[4].unused == 0xd) {
        SendMessageW(DAT_0042a208,0x111,1,0);
      }
      if (param_4[4].unused == 0x1b) {
        SendMessageW(DAT_0042a208,0x10,0,0);
      }
      return 1;
    }
  }
  else if (param_2 == 0x40b) {
    DAT_004216b4 = DAT_004216b4 + 1;
  }
LAB_004045f6:
  CVar6 = FUN_00404248(param_2,param_3,param_4);
  return CVar6;
}



/* Function: FUN_00404609 */

void FUN_00404609(void)

{
  HWND hWnd;
  
  hWnd = DAT_004216b0;
  if (DAT_0042a2ac == 0) {
    hWnd = DAT_004236e4;
  }
  SendMessageW(hWnd,0xf4,1,1);
  return;
}



/* Function: FUN_0040462d */

void FUN_0040462d(HWND param_1,LPCWSTR param_2)

{
  SHELLEXECUTEINFOW local_40;
  
  local_40.lpParameters = (LPCWSTR)0x0;
  local_40.lpDirectory = (LPCWSTR)0x0;
  local_40.hwnd = param_1;
  local_40.fMask = 0x500;
  local_40.lpFile = param_2;
  local_40.nShow = 1;
  local_40.lpVerb = u_open_0040a394;
  FUN_00405874(&local_40);
  return;
}



/* Function: FUN_00404669 */

void FUN_00404669(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  if (param_2 == 0x110) {
    FUN_004041e1(param_1,0x1d,param_4[0xc].unused);
    SetDlgItemTextW(param_1,1000,(LPCWSTR)(&DAT_0042b000 + param_4[0xf].unused * 0x800));
  }
  FUN_00404248(param_2,param_3,param_4);
  return;
}



/* Function: FUN_004046b0 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_004046b0(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  bool bVar1;
  HWND hWnd;
  int iVar2;
  LPWSTR pWVar3;
  FARPROC pFVar4;
  LPITEMIDLIST pv;
  undefined3 extraout_var;
  BOOL BVar5;
  uint uVar6;
  int iVar7;
  LPCWSTR lpString;
  LPCITEMIDLIST *ppIVar8;
  LPCWSTR pWVar9;
  _browseinfoW local_50;
  uint local_30;
  uint local_2c;
  undefined1 local_28 [4];
  DWORD local_24;
  int local_20;
  undefined1 local_1c [4];
  DWORD local_18;
  DWORD local_14;
  FARPROC local_10;
  int local_c;
  int local_8;
  
  local_20 = DAT_004226c0;
  local_c = *(int *)(DAT_004226c0 + 0x38);
  lpString = (LPCWSTR)(&DAT_0042b000 + *(int *)(DAT_004226c0 + 0x3c) * 0x800);
  if (param_2 == 0x40b) {
    FUN_00405892(0x3fb,lpString);
    FUN_004064e0(lpString);
  }
  if (param_2 == 0x110) {
    hWnd = GetDlgItem(param_1,0x3fb);
    iVar2 = FUN_00405b94((ushort *)lpString);
    if ((iVar2 != 0) && (pWVar3 = FUN_00405bc8(lpString), pWVar3 == (LPWSTR)0x0)) {
      FUN_00405b1d(lpString);
    }
    DAT_004291d8 = param_1;
    SetWindowTextW(hWnd,lpString);
    FUN_004041e1(param_1,1,param_4[0xd].unused);
    FUN_004041e1(param_1,0x14,param_4[0xc].unused);
    FUN_00404216((WPARAM)hWnd);
    pFVar4 = FUN_00406626(7);
    if (pFVar4 == (FARPROC)0x0) goto LAB_004049f1;
    (*pFVar4)(hWnd,1);
  }
  iVar2 = local_c;
  if (param_2 == 0x111) {
    if (((uint)param_3 & 0xffff) == 0x3fb) {
      if ((short)((uint)param_3 >> 0x10) != 0x300) goto LAB_004049f1;
      param_2 = 0x40f;
    }
    if (((uint)param_3 & 0xffff) == 0x3e9) {
      ppIVar8 = &local_50.pidlRoot;
      for (iVar7 = 7; iVar7 != 0; iVar7 = iVar7 + -1) {
        *ppIVar8 = (LPCITEMIDLIST)0x0;
        ppIVar8 = ppIVar8 + 1;
      }
      local_50.hwndOwner = param_1;
      local_50.pszDisplayName = &DAT_004236e8;
      local_50.lpfn = FUN_00404a06;
      local_50.lParam = (LPARAM)lpString;
      local_50.lpszTitle = (LPCWSTR)FUN_0040626e((LPWSTR)&DAT_00421ec0,iVar2);
      local_50.ulFlags = 0x41;
      pv = SHBrowseForFolderW(&local_50);
      if (pv == (LPITEMIDLIST)0x0) {
        param_2 = 0x40f;
      }
      else {
        CoTaskMemFree(pv);
        FUN_00405b1d(lpString);
        if ((*(int *)(DAT_0042a214 + 0x11c) != 0) && (lpString == &DAT_00435800)) {
          FUN_0040626e((LPWSTR)0x0,*(int *)(DAT_0042a214 + 0x11c));
          iVar2 = lstrcmpiW(&DAT_004281a0,&DAT_004236e8);
          if (iVar2 != 0) {
            lstrcatW(&DAT_00435800,&DAT_004281a0);
          }
        }
        DAT_004236d8 = DAT_004236d8 + 1;
        SetDlgItemTextW(param_1,0x3fb,lpString);
      }
    }
  }
  if ((param_2 == 0x40f) || (param_2 == 0x405)) {
    local_8 = 0;
    local_c = 0;
    FUN_00405892(0x3fb,lpString);
    bVar1 = FUN_00405c25(lpString);
    if (CONCAT31(extraout_var,bVar1) == 0) {
      local_8 = 1;
    }
    FUN_0040624c((LPWSTR)&DAT_004216b8,lpString);
    local_10 = FUN_00406626(1);
    if (local_10 != (FARPROC)0x0) {
      pWVar9 = (LPCWSTR)0x0;
      do {
        iVar2 = (*local_10)(&DAT_004216b8,&local_30,local_1c,local_28);
        if (iVar2 != 0) {
          local_30 = local_30 >> 10 | local_2c << 0x16;
          local_2c = local_2c >> 10;
          local_c = 1;
          goto LAB_0040494a;
        }
        if (pWVar9 != (LPCWSTR)0x0) {
          *pWVar9 = L'\0';
        }
        pWVar9 = FUN_00405b69((LPCWSTR)&DAT_004216b8);
        *pWVar9 = L'\0';
        pWVar9 = pWVar9 + -1;
        *pWVar9 = L'\\';
      } while (pWVar9 != (LPCWSTR)&DAT_004216b8);
    }
    FUN_0040624c((LPWSTR)&DAT_004216b8,lpString);
    pWVar3 = FUN_00405bc8((LPCWSTR)&DAT_004216b8);
    if (pWVar3 != (LPWSTR)0x0) {
      *pWVar3 = L'\0';
    }
    BVar5 = GetDiskFreeSpaceW((LPCWSTR)&DAT_004216b8,&local_14,&local_18,(LPDWORD)&local_10,
                              &local_24);
    if (BVar5 != 0) {
      local_30 = MulDiv(local_14 * local_18,(int)local_10,0x400);
      local_2c = (int)local_30 >> 0x1f;
      local_c = 1;
    }
LAB_0040494a:
    uVar6 = FUN_00404b4d(5);
    if (((local_c != 0) && (local_2c == 0)) && (local_30 < uVar6)) {
      local_8 = 2;
    }
    if (*(int *)(DAT_004291dc + 0x10) != 0) {
      FUN_00404b35(0x3ff,-5,uVar6);
      if (local_c == 0) {
        SetDlgItemTextW(param_1,0x400,(LPCWSTR)&DAT_004216a8);
      }
      else {
        FUN_00404a6c(0x400,-4,local_30,local_2c);
      }
    }
    _DAT_0042a2c4 = local_8;
    if (local_8 == 0) {
      local_8 = FUN_0040140b(7);
    }
    if ((*(uint *)(local_20 + 0x14) & 0x400) != 0) {
      local_8 = 0;
    }
    FUN_00404203((uint)(local_8 == 0));
    if ((local_8 == 0) && (DAT_004236d8 == 0)) {
      FUN_00404609();
    }
    DAT_004236d8 = 0;
  }
LAB_004049f1:
  FUN_00404248(param_2,param_3,param_4);
  return;
}



/* Function: FUN_00404a06 */

undefined4 FUN_00404a06(HWND param_1,int param_2,LPCITEMIDLIST param_3,LPWSTR param_4)

{
  BOOL BVar1;
  int iVar2;
  LPARAM lParam;
  
  if (param_2 == 1) {
    FUN_00405892(0x3fb,param_4);
    SendMessageW(param_1,0x467,1,(LPARAM)param_4);
  }
  if (param_2 == 2) {
    BVar1 = SHGetPathFromIDListW(param_3,param_4);
    if ((BVar1 == 0) || (iVar2 = FUN_0040140b(7), iVar2 != 0)) {
      lParam = 0;
    }
    else {
      lParam = 1;
    }
    SendMessageW(param_1,0x465,0,lParam);
    return 0;
  }
  return 0;
}



/* Function: FUN_00404a6c */

void FUN_00404a6c(int param_1,int param_2,uint param_3,int param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  sbyte sVar5;
  uint uVar6;
  uint uVar7;
  wchar_t *pwVar8;
  WCHAR local_84 [32];
  WCHAR local_44 [32];
  
  iVar3 = -0x24;
  if (param_4 == 0) {
    sVar5 = 0x14;
    if (param_3 < 0x100000) {
      sVar5 = 10;
      iVar3 = -0x23;
    }
    if (param_3 < 0x400) {
      sVar5 = 0;
      iVar3 = -0x22;
    }
    if (param_3 < 0xffff3333) {
      param_3 = (1 << sVar5) / 0x14 + param_3;
    }
    uVar6 = param_3 >> sVar5;
    uVar7 = ((param_3 & 0xffffff) * 10 >> sVar5) % 10;
  }
  else {
    uVar6 = param_3 >> 0x14 | param_4 << 0xc;
    uVar7 = 0;
  }
  uVar1 = FUN_0040626e(local_44,-0x21);
  uVar2 = FUN_0040626e(local_84,iVar3);
  pwVar8 = u__u__u_s_s_0040a3a0;
  iVar3 = FUN_0040626e(&DAT_004236e8,param_2);
  iVar4 = lstrlenW(&DAT_004236e8);
  wsprintfW((LPWSTR)(iVar3 + iVar4 * 2),pwVar8,uVar6,uVar7,uVar2,uVar1);
  SetDlgItemTextW(DAT_004291d8,param_1,&DAT_004236e8);
  return;
}



/* Function: FUN_00404b35 */

void FUN_00404b35(int param_1,int param_2,uint param_3)

{
  FUN_00404a6c(param_1,param_2,param_3,0);
  return;
}



/* Function: FUN_00404b4d */

int FUN_00404b4d(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = 0;
  iVar2 = DAT_0042a248;
  iVar3 = DAT_0042a24c;
  if (DAT_0042a24c != 0) {
    do {
      if ((*(byte *)(iVar2 + 8) & 1) != 0) {
        iVar1 = iVar1 + *(int *)(iVar2 + param_1 * 4);
      }
      iVar3 = iVar3 + -1;
      iVar2 = iVar2 + 0x818;
    } while (iVar3 != 0);
  }
  return iVar1;
}



/* Function: FUN_00404b7a */

undefined4 FUN_00404b7a(HWND param_1,int param_2)

{
  DWORD DVar1;
  undefined4 local_3c;
  LRESULT local_38;
  undefined4 local_18;
  tagPOINT local_14;
  byte local_c;
  LRESULT local_8;
  
  local_38 = SendMessageW(param_1,0x110a,9,0);
  if (param_2 != 0) {
    DVar1 = GetMessagePos();
    local_14.x = (LONG)(short)DVar1;
    local_14.y = (LONG)(short)(DVar1 >> 0x10);
    ScreenToClient(param_1,&local_14);
    SendMessageW(param_1,0x1111,0,(LPARAM)&local_14);
    local_38 = local_8;
    if ((local_c & 0x66) == 0) {
      return 0xffffffff;
    }
  }
  local_3c = 4;
  SendMessageW(param_1,0x113e,0,(LPARAM)&local_3c);
  return local_18;
}



/* Function: FUN_00404bfa */

void FUN_00404bfa(int param_1,undefined4 param_2)

{
  FUN_0040624c(&DAT_004236e8,(LPCWSTR)&DAT_0042b000);
  FUN_00406193((LPWSTR)&DAT_0042b000,param_2);
  FUN_0040140b(param_1);
  FUN_0040624c((LPWSTR)&DAT_0042b000,&DAT_004236e8);
  return;
}



/* Function: FUN_00404c2c */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00404c2c(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  int iVar1;
  uint uVar2;
  HBITMAP hbmImage;
  LRESULT LVar3;
  LPARAM lParam;
  WPARAM WVar4;
  LRESULT LVar5;
  uint uVar6;
  HDC pHVar7;
  HWND pHVar8;
  int iVar9;
  uint *puVar10;
  LPARAM local_54 [5];
  uint local_40;
  uint *local_3c;
  uint *local_38;
  undefined4 local_2c;
  int local_28;
  HGLOBAL local_20;
  uint *local_1c;
  int local_18;
  int local_14;
  HWND local_10;
  HWND local_c;
  HWND local_8;
  
  local_c = GetDlgItem(param_1,0x3f9);
  local_8 = GetDlgItem(param_1,0x408);
  local_14 = DAT_0042a248;
  local_18 = DAT_0042a214 + 0x94;
  if (param_2 == 0x110) {
    local_20 = (HGLOBAL)0x0;
    local_10 = (HWND)0x2;
    _DAT_0042a280 = param_1;
    DAT_004236e0 = GlobalAlloc(0x40,DAT_0042a24c << 2);
    hbmImage = LoadBitmapW(DAT_0042a200,(LPCWSTR)0x6e);
    DAT_004236d4 = 0xffffffff;
    DAT_004236dc = SetWindowLongW(local_8,-4,0x405224);
    DAT_004236cc = ImageList_Create(0x10,0x10,0x21,6,0);
    ImageList_AddMasked(DAT_004236cc,hbmImage,0xff00ff);
    SendMessageW(local_8,0x1109,2,(LPARAM)DAT_004236cc);
    LVar3 = SendMessageW(local_8,0x111c,0,0);
    if (LVar3 < 0x10) {
      SendMessageW(local_8,0x111b,0x10,0);
    }
    DeleteObject(hbmImage);
    iVar9 = 0;
    do {
      iVar1 = *(int *)(local_18 + iVar9 * 4);
      if (iVar1 != 0) {
        if (iVar9 != 0x20) {
          local_10 = (HWND)0x0;
        }
        lParam = FUN_0040626e((LPWSTR)0x0,iVar1);
        WVar4 = SendMessageW(local_c,0x143,0,lParam);
        SendMessageW(local_c,0x151,WVar4,iVar9);
      }
      pHVar8 = local_10;
      iVar9 = iVar9 + 1;
    } while (iVar9 < 0x21);
    FUN_004041e1(param_1,0x15,param_4[(int)(local_10 + 3)].unused);
    FUN_004041e1(param_1,0x16,param_4[(int)((int)&pHVar8[3].unused + 1)].unused);
    iVar9 = 0;
    LVar3 = 0;
    if (DAT_0042a24c < 1) {
LAB_00404e58:
      uVar6 = GetWindowLongW(local_8,-0x10);
      SetWindowLongW(local_8,-0x10,uVar6 & 0xfffffffb);
    }
    else {
      local_1c = (uint *)(local_14 + 8);
      do {
        puVar10 = local_1c + 4;
        if ((short)*puVar10 != 0) {
          uVar6 = *local_1c;
          local_54[4] = uVar6 & 0x20;
          local_54[1] = 0xffff0002;
          local_54[2] = 0xd;
          local_40 = 0x20;
          local_54[0] = LVar3;
          local_3c = puVar10;
          local_28 = iVar9;
          if ((uVar6 & 2) == 0) {
            if ((uVar6 & 4) == 0) {
              LVar5 = SendMessageW(local_8,0x1132,0,(LPARAM)local_54);
              *(LRESULT *)((int)DAT_004236e0 + iVar9 * 4) = LVar5;
            }
            else {
              LVar3 = SendMessageW(local_8,0x110a,3,LVar3);
            }
          }
          else {
            local_54[2] = 0x4d;
            local_2c = 1;
            LVar3 = SendMessageW(local_8,0x1132,0,(LPARAM)local_54);
            local_20 = (HGLOBAL)0x1;
            *(LRESULT *)((int)DAT_004236e0 + iVar9 * 4) = LVar3;
            LVar3 = *(LRESULT *)((int)DAT_004236e0 + iVar9 * 4);
          }
        }
        iVar9 = iVar9 + 1;
        local_1c = local_1c + 0x206;
      } while (iVar9 < DAT_0042a24c);
      if (local_20 == (HGLOBAL)0x0) goto LAB_00404e58;
    }
    if (local_10 == (HWND)0x0) {
      ShowWindow(local_c,5);
      FUN_00404216((WPARAM)local_c);
      goto LAB_0040520f;
    }
    FUN_00404216((WPARAM)local_8);
  }
  if (param_2 == 0x405) {
    param_3 = (HDC)0x0;
    param_2 = 0x40f;
    param_4 = (HWND)0x1;
  }
  if (((param_2 == 0x4e) || (param_2 == 0x413)) &&
     ((local_10 = param_4, param_2 == 0x413 || (param_4[1].unused == 0x408)))) {
    if (((DAT_0042a21c & 0x200) == 0) &&
       (((param_2 == 0x413 || (param_4[2].unused == -2)) &&
        (iVar9 = FUN_00404b7a(local_8,(uint)(param_2 != 0x413)), -1 < iVar9)))) {
      puVar10 = (uint *)(iVar9 * 0x818 + 8 + local_14);
      uVar6 = *puVar10;
      if ((uVar6 & 0x10) == 0) {
        if ((uVar6 & 0x40) == 0) {
          uVar6 = uVar6 ^ 1;
        }
        else if ((char)((byte)uVar6 ^ 0x80) < '\0') {
          uVar6 = uVar6 ^ 0x80 | 1;
        }
        else {
          uVar6 = (uVar6 ^ 0x80) & 0xfffffffe;
        }
        *puVar10 = uVar6;
        FUN_0040117d(iVar9);
        param_3 = (HDC)(iVar9 + 1);
        param_4 = (HWND)(~DAT_0042a21c >> 8 & 1);
        param_2 = 0x40f;
      }
    }
    if (local_10 != (HWND)0x0) {
      if (local_10[2].unused == -0x1c3) {
        SendMessageW(local_8,0x419,0,local_10[0x17].unused);
      }
      if (local_10[2].unused == -0x1c7) {
        if (local_10[3].unused == 2) {
          puVar10 = (uint *)(local_10[0x17].unused * 0x818 + 8 + local_14);
          *puVar10 = *puVar10 | 0x20;
        }
        else {
          puVar10 = (uint *)(local_10[0x17].unused * 0x818 + 8 + local_14);
          *puVar10 = *puVar10 & 0xffffffdf;
        }
      }
    }
  }
  if (param_2 == 0x111) {
    if ((((short)param_3 != 0x3f9) || ((short)((uint)param_3 >> 0x10) != 1)) ||
       (WVar4 = SendMessageW(local_c,0x147,0,0), WVar4 == 0xffffffff)) goto LAB_0040520f;
    uVar6 = SendMessageW(local_c,0x150,WVar4,0);
    if ((uVar6 == 0xffffffff) || (*(int *)(local_18 + uVar6 * 4) == 0)) {
      uVar6 = 0x20;
    }
    FUN_00401299(uVar6);
    SendMessageW(param_1,0x420,0,uVar6);
    param_3 = (HDC)0xffffffff;
    param_4 = (HWND)0x0;
    param_2 = 0x40f;
  }
  if (param_2 == 0x200) {
    SendMessageW(local_8,0x200,0,0);
  }
  if (param_2 == 0x40b) {
    if (DAT_004236cc != (HIMAGELIST)0x0) {
      ImageList_Destroy(DAT_004236cc);
    }
    if (DAT_004236e0 != (HGLOBAL)0x0) {
      GlobalFree(DAT_004236e0);
    }
    DAT_004236cc = (HIMAGELIST)0x0;
    DAT_004236e0 = (HGLOBAL)0x0;
    _DAT_0042a280 = (HWND)0x0;
  }
  if (param_2 == 0x40f) {
    FUN_004011ef(0,0);
    if (param_3 != (HDC)0x0) {
      pHVar7 = param_3;
      if (param_3 != (HDC)0xffffffff) {
        pHVar7 = (HDC)((int)&param_3[-1].unused + 3);
      }
      FUN_00404bfa(8,pHVar7);
    }
    if (param_4 != (HWND)0x0) {
      param_4 = (HWND)FUN_004012e2((int)DAT_004236e0);
      FUN_00401299((uint)param_4);
      iVar9 = 0;
      WVar4 = 0;
      if (0 < (int)param_4) {
        do {
          if (*(int *)(local_18 + iVar9 * 4) != 0) {
            WVar4 = WVar4 + 1;
          }
          iVar9 = iVar9 + 1;
        } while (iVar9 < (int)param_4);
      }
      SendMessageW(local_c,0x14e,WVar4,0);
      param_2 = 0x420;
    }
    FUN_004011ef(0,0);
    local_20 = DAT_004236e0;
    local_3c = (uint *)0xf030;
    local_14 = 0;
    if (0 < DAT_0042a24c) {
      puVar10 = (uint *)(DAT_0042a248 + 8);
      do {
        uVar6 = *(uint *)((int)local_20 + local_14 * 4);
        if (uVar6 != 0) {
          uVar2 = *puVar10;
          local_54[3] = 8;
          if ((uVar2 & 0x100) != 0) {
            local_38 = puVar10 + 4;
            local_54[3] = 9;
            *(byte *)((int)puVar10 + 1) = *(byte *)((int)puVar10 + 1) & 0xfe;
          }
          if ((uVar2 & 0x40) == 0) {
            iVar9 = (uVar2 & 1) + 1;
            if ((uVar2 & 0x10) != 0) {
              iVar9 = (uVar2 & 1) + 4;
            }
          }
          else {
            iVar9 = 3;
          }
          local_40 = (iVar9 << 0xb | uVar2 & 8) * 2 | uVar2 & 0x20;
          local_54[4] = uVar6;
          SendMessageW(local_8,0x1102,((int)uVar2 >> 5 & 1U) + 1,uVar6);
          SendMessageW(local_8,0x113f,0,(LPARAM)(local_54 + 3));
        }
        local_14 = local_14 + 1;
        puVar10 = puVar10 + 0x206;
      } while (local_14 < DAT_0042a24c);
    }
    InvalidateRect(local_8,(RECT *)0x0,1);
    if (*(int *)(DAT_004291dc + 0x10) != 0) {
      uVar6 = FUN_00404b4d(5);
      FUN_00404b35(0x3ff,-5,uVar6);
    }
  }
  if ((param_2 == 0x420) && ((DAT_0042a21c & 0x100) != 0)) {
    iVar9 = (uint)(param_4 == (HWND)0x20) << 3;
    ShowWindow(local_8,iVar9);
    pHVar8 = GetDlgItem(param_1,0x3fe);
    ShowWindow(pHVar8,iVar9);
  }
LAB_0040520f:
  FUN_00404248(param_2,param_3,param_4);
  return;
}



/* Function: FUN_00405224 */

LRESULT FUN_00405224(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  BOOL BVar1;
  LRESULT LVar2;
  
  if (param_2 == 0x102) {
    if (param_3 == 0x20) {
      FUN_0040422d(0x413);
      return 0;
    }
  }
  else {
    if (param_2 == 0x200) {
      BVar1 = IsWindowVisible(param_1);
      if (BVar1 == 0) goto LAB_00405296;
      param_4 = FUN_00404b7a(param_1,1);
      param_2 = 0x419;
    }
    if ((param_2 == 0x419) && (DAT_004236d4 != param_4)) {
      DAT_004236d4 = param_4;
      FUN_00404bfa(6,param_4);
    }
  }
LAB_00405296:
  LVar2 = CallWindowProcW(DAT_004236dc,param_1,param_2,param_3,param_4);
  return LVar2;
}



/* Function: FUN_004052b0 */

void FUN_004052b0(int param_1,LPCWSTR param_2)

{
  int iVar1;
  int iVar2;
  LRESULT LVar3;
  uint uVar4;
  undefined4 local_34;
  WPARAM local_30;
  undefined4 local_2c;
  undefined *local_20;
  uint local_c;
  HWND local_8;
  
  local_8 = DAT_004291e4;
  if (DAT_004291e4 != (HWND)0x0) {
    local_c = DAT_0042a2d4;
    uVar4 = DAT_0042a2d4 & 1;
    if (uVar4 == 0) {
      FUN_0040626e((LPWSTR)&DAT_004226c8,param_1);
    }
    iVar1 = lstrlenW((LPCWSTR)&DAT_004226c8);
    if (param_2 != (LPCWSTR)0x0) {
      iVar2 = lstrlenW(param_2);
      if (0xfff < (uint)(iVar2 + iVar1)) {
        return;
      }
      lstrcatW((LPWSTR)&DAT_004226c8,param_2);
    }
    if ((local_c & 4) == 0) {
      SetWindowTextW(DAT_004291c8,(LPCWSTR)&DAT_004226c8);
    }
    if ((local_c & 2) == 0) {
      local_20 = &DAT_004226c8;
      local_34 = 1;
      LVar3 = SendMessageW(local_8,0x1004,0,0);
      local_30 = LVar3 - uVar4;
      local_2c = 0;
      SendMessageW(local_8,0x104d - uVar4,0,(LPARAM)&local_34);
      SendMessageW(local_8,0x1013,local_30,0);
    }
    if (uVar4 != 0) {
      *(undefined2 *)(&DAT_004226c8 + iVar1 * 2) = 0;
    }
  }
  return;
}



/* Function: FUN_00405383 */

int FUN_00405383(HWND param_1)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = DAT_0042a24c;
  iVar2 = DAT_0042a248;
  uVar1 = OleInitialize((LPVOID)0x0);
  DAT_0042a2d8 = DAT_0042a2d8 | uVar1;
  FUN_0040422d(0);
  if (iVar4 != 0) {
    piVar3 = (int *)(iVar2 + 0xc);
    do {
      iVar4 = iVar4 + -1;
      if (((*(byte *)(piVar3 + -1) & 1) != 0) && (iVar2 = FUN_00401389(*piVar3,param_1), iVar2 != 0)
         ) {
        DAT_0042a2ac = DAT_0042a2ac + 1;
        break;
      }
      piVar3 = piVar3 + 0x206;
    } while (iVar4 != 0);
  }
  FUN_0040422d(0x404);
  OleUninitialize();
  return DAT_0042a2ac;
}



/* Function: FUN_004053ef */

COLORREF FUN_004053ef(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  HWND pHVar1;
  HWND lpParameter;
  HANDLE hObject;
  HMENU hMenu;
  LPCWSTR lpNewItem;
  int iVar2;
  BOOL BVar3;
  LRESULT LVar4;
  HGLOBAL hMem;
  undefined2 *puVar5;
  COLORREF CVar6;
  int y;
  WPARAM wParam;
  int iVar7;
  DWORD dwCreationFlags;
  DWORD *lpThreadId;
  undefined1 local_44 [8];
  undefined4 local_3c;
  undefined4 local_38;
  int local_34;
  undefined2 *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 uStack_20;
  tagRECT local_1c;
  DWORD local_c;
  HWND local_8;
  
  pHVar1 = DAT_004291e4;
  wParam = 0;
  local_8 = DAT_004291e4;
  if (param_2 == 0x110) {
    local_34 = 0xffffffff;
    local_28 = 0xffffffff;
    local_3c = 2;
    local_38 = 0;
    local_30 = (undefined2 *)0x0;
    local_2c = 0;
    local_24 = 0;
    uStack_20 = 0;
    iVar7 = *(int *)(DAT_0042a214 + 0x5c);
    iVar2 = *(int *)(DAT_0042a214 + 0x60);
    DAT_004291d0 = GetDlgItem(param_1,0x403);
    DAT_004291c8 = GetDlgItem(param_1,0x3ee);
    DAT_004291e4 = GetDlgItem(param_1,0x3f8);
    local_8 = DAT_004291e4;
    FUN_00404216((WPARAM)DAT_004291d0);
    DAT_004291d4 = FUN_00404b4d(4);
    DAT_004291ec = 0;
    GetClientRect(local_8,&local_1c);
    local_34 = GetSystemMetrics(2);
    local_34 = local_1c.right - local_34;
    SendMessageW(local_8,0x1061,0,(LPARAM)&local_3c);
    SendMessageW(local_8,0x1036,0x4000,0x4000);
    if (-1 < iVar7) {
      SendMessageW(local_8,0x1001,0,iVar7);
      SendMessageW(local_8,0x1026,0,iVar7);
    }
    if (-1 < iVar2) {
      SendMessageW(local_8,0x1024,0,iVar2);
    }
    FUN_004041e1(param_1,0x1b,param_4[0xc].unused);
    if (((byte)DAT_0042a21c & 3) != 0) {
      ShowWindow(DAT_004291d0,0);
      if (((byte)DAT_0042a21c & 2) == 0) {
        ShowWindow(local_8,8);
      }
      else {
        DAT_004291d0 = (HWND)0x0;
      }
      FUN_00404216((WPARAM)DAT_004291c8);
    }
    pHVar1 = GetDlgItem(param_1,0x3ec);
    SendMessageW(pHVar1,0x401,0,0x75300000);
    if (((byte)DAT_0042a21c & 4) != 0) {
      SendMessageW(pHVar1,0x409,0,iVar2);
      SendMessageW(pHVar1,0x2001,0,iVar7);
    }
LAB_00405778:
    CVar6 = 0;
  }
  else {
    if (param_2 == 0x405) {
      lpThreadId = &local_c;
      dwCreationFlags = 0;
      lpParameter = GetDlgItem(param_1,0x3ec);
      hObject = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_00405383,lpParameter,dwCreationFlags,
                             lpThreadId);
      CloseHandle(hObject);
    }
    if (param_2 == 0x111) {
      if ((short)param_3 == 0x403) {
        ShowWindow(DAT_004291d0,0);
        ShowWindow(pHVar1,8);
        FUN_00404216((WPARAM)pHVar1);
        goto LAB_004055f5;
      }
    }
    else {
LAB_004055f5:
      iVar7 = 1;
      if (param_2 == 0x404) {
        if (DAT_004291cc != 0) {
          DAT_00421eb8 = 2;
          FUN_004041ba(0x78);
          goto LAB_0040561a;
        }
        ShowWindow(DAT_0042a208,8);
        if (DAT_0042a2ac == 0) {
          FUN_004052b0(*(int *)(DAT_004226c0 + 0x34),(LPCWSTR)0x0);
        }
        FUN_004041ba(1);
      }
      if ((param_2 == 0x7b) && (param_3 == (HDC)local_8)) {
        pHVar1 = (HWND)SendMessageW(local_8,0x1004,0,0);
        if (0 < (int)pHVar1) {
          hMenu = CreatePopupMenu();
          lpNewItem = (LPCWSTR)FUN_0040626e((LPWSTR)0x0,-0x1f);
          AppendMenuW(hMenu,0,1,lpNewItem);
          iVar2 = (int)(short)param_4;
          y = (int)(short)((uint)param_4 >> 0x10);
          if (param_4 == (HWND)0xffffffff) {
            GetWindowRect(local_8,&local_1c);
            iVar2 = local_1c.left;
            y = local_1c.top;
          }
          BVar3 = TrackPopupMenu(hMenu,0x180,iVar2,y,0,param_1,(RECT *)0x0);
          if (BVar3 == 1) {
            local_3c = 0;
            local_30 = &DAT_004236e8;
            local_2c = 0x1000;
            param_1 = pHVar1;
            do {
              param_1 = (HWND)((int)&param_1[-1].unused + 3);
              LVar4 = SendMessageW(local_8,0x1073,(WPARAM)param_1,(LPARAM)local_44);
              iVar7 = iVar7 + 2 + LVar4;
            } while (param_1 != (HWND)0x0);
            OpenClipboard((HWND)0x0);
            EmptyClipboard();
            hMem = GlobalAlloc(0x42,iVar7 * 2);
            puVar5 = (undefined2 *)GlobalLock(hMem);
            do {
              local_30 = puVar5;
              LVar4 = SendMessageW(local_8,0x1073,wParam,(LPARAM)local_44);
              puVar5 = puVar5 + LVar4;
              *puVar5 = 0xd;
              puVar5[1] = 10;
              puVar5 = puVar5 + 2;
              wParam = wParam + 1;
            } while ((int)wParam < (int)pHVar1);
            GlobalUnlock(hMem);
            SetClipboardData(0xd,hMem);
            CloseClipboard();
          }
        }
        goto LAB_00405778;
      }
    }
LAB_0040561a:
    CVar6 = FUN_00404248(param_2,param_3,param_4);
  }
  return CVar6;
}



/* Function: FUN_0040577f */

DWORD FUN_0040577f(LPCWSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  undefined1 local_24;
  undefined1 local_23;
  undefined2 local_22;
  undefined *local_20;
  undefined *local_1c;
  undefined4 local_18;
  undefined *local_14;
  _SECURITY_ATTRIBUTES local_10;
  
  local_23 = 0;
  local_20 = &DAT_004083f0;
  local_1c = &DAT_004083f0;
  local_10.lpSecurityDescriptor = &local_24;
  local_18 = 0;
  local_10.bInheritHandle = 0;
  local_24 = 1;
  local_22 = 4;
  local_14 = &DAT_004083e0;
  local_10.nLength = 0xc;
  BVar1 = CreateDirectoryW(param_1,&local_10);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 != 0xb7) {
      return DVar2;
    }
    BVar1 = SetFileSecurityW(param_1,0x80000007,&local_24);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      return DVar2;
    }
  }
  return 0;
}



/* Function: FUN_004057fc */

DWORD FUN_004057fc(LPCWSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  
  BVar1 = CreateDirectoryW(param_1,(LPSECURITY_ATTRIBUTES)0x0);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
  }
  else {
    DVar2 = 0;
  }
  return DVar2;
}



/* Function: FUN_00405819 */

undefined4 FUN_00405819(void)

{
  FARPROC pFVar1;
  int iVar2;
  
  pFVar1 = FUN_00406626(5);
  if (pFVar1 != (FARPROC)0x0) {
    iVar2 = (*pFVar1)();
    if (iVar2 != 0) {
      return 1;
    }
  }
  return 0;
}



/* Function: FUN_00405831 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

HANDLE FUN_00405831(LPWSTR param_1)

{
  HANDLE pvVar1;
  _PROCESS_INFORMATION local_14;
  
  _DAT_004266f0 = 0x44;
  pvVar1 = (HANDLE)CreateProcessW((LPCWSTR)0x0,param_1,(LPSECURITY_ATTRIBUTES)0x0,
                                  (LPSECURITY_ATTRIBUTES)0x0,0,0x4000000,(LPVOID)0x0,(LPCWSTR)0x0,
                                  (LPSTARTUPINFOW)&DAT_004266f0,&local_14);
  if (pvVar1 != (HANDLE)0x0) {
    CloseHandle(local_14.hThread);
    pvVar1 = local_14.hProcess;
  }
  return pvVar1;
}



/* Function: FUN_00405874 */

void FUN_00405874(SHELLEXECUTEINFOW *param_1)

{
  param_1->lpIDList = (void *)0x0;
  param_1->cbSize = 0x3c;
  ShellExecuteExW(param_1);
  return;
}



/* Function: SetDlgItemTextW */

BOOL SetDlgItemTextW(HWND hDlg,int nIDDlgItem,LPCWSTR lpString)

{
  BOOL BVar1;
  
                    /* WARNING: Could not recover jumptable at 0x0040588c. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  BVar1 = SetDlgItemTextW(hDlg,nIDDlgItem,lpString);
  return BVar1;
}



/* Function: FUN_00405892 */

void FUN_00405892(int param_1,LPWSTR param_2)

{
  GetDlgItemTextW(DAT_004291d8,param_1,param_2,0x400);
  return;
}



/* Function: FUN_004058ae */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_004058ae(undefined4 param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = param_2 & 0x1fffff;
  if ((DAT_0042a2c0 == 0) || (param_2 >> 0x15 == 0)) {
    if (DAT_0042a2c8 != 0) {
      uVar1 = uVar1 ^ 0x180000;
    }
    _DAT_0040a3bc = DAT_0042a208;
    _DAT_0040a3c0 = DAT_0042a200;
    _DAT_0040a3c4 = param_1;
    _DAT_0040a3c8 = &DAT_00429200;
    _DAT_0040a3cc = uVar1;
    MessageBoxIndirectW((MSGBOXPARAMSW *)&DAT_0040a3b8);
  }
  return;
}



/* Function: FUN_00405912 */

undefined4 FUN_00405912(LPCWSTR param_1,byte param_2)

{
  DWORD dwFileAttributes;
  int iVar1;
  
  dwFileAttributes = FUN_00405d19(param_1);
  if (dwFileAttributes != 0xffffffff) {
    if ((param_2 & 1) == 0) {
      iVar1 = DeleteFileW(param_1);
    }
    else {
      iVar1 = RemoveDirectoryW(param_1);
    }
    if (iVar1 != 0) {
      return 1;
    }
    if ((param_2 & 4) == 0) {
      SetFileAttributesW(param_1,dwFileAttributes);
    }
  }
  return 0;
}



/* Function: FUN_0040595a */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0040595a(LPCWSTR param_1,uint param_2)

{
  uint uVar1;
  bool bVar2;
  undefined3 extraout_var;
  BOOL BVar3;
  int iVar4;
  HANDLE hFindFile;
  int iVar5;
  undefined *puVar6;
  _WIN32_FIND_DATAW local_25c;
  int local_c;
  uint local_8;
  
  local_8 = param_2 & 4;
  bVar2 = FUN_00405c25(param_1);
  local_c = CONCAT31(extraout_var,bVar2);
  if ((param_2 & 8) == 0) {
    uVar1 = param_2 & 1;
    if ((uVar1 == 0) || ((local_c != 0 && ((param_2 & 2) != 0)))) {
      FUN_0040624c(&DAT_004256f0,param_1);
      if (uVar1 == 0) {
        FUN_00405b69(param_1);
      }
      else {
        lstrcatW(&DAT_004256f0,u______0040a54c);
      }
      if ((*param_1 != L'\0') || (DAT_004256f0 == 0x5c)) {
        lstrcatW(param_1,(LPCWSTR)&DAT_0040a014);
      }
      iVar4 = lstrlenW(param_1);
      hFindFile = FindFirstFileW(&DAT_004256f0,&local_25c);
      if (hFindFile != (HANDLE)0xffffffff) {
        do {
          if ((local_25c.cFileName[0] != L'.') ||
             ((local_25c.cFileName[1] != L'\0' &&
              ((local_25c.cFileName[1] != L'.' || (local_25c.cFileName[2] != L'\0')))))) {
            FUN_0040624c(param_1 + iVar4,local_25c.cFileName);
            if (((byte)local_25c.dwFileAttributes & 0x10) == 0) {
              iVar5 = FUN_00405912(param_1,(byte)local_8);
              if (iVar5 == 0) {
                if (local_8 == 0) {
                  _DAT_0042a2a8 = _DAT_0042a2a8 + 1;
                }
                else {
                  FUN_004052b0(-0xf,param_1);
                  FUN_00406012(param_1,(LPCWSTR)0x0);
                }
              }
              else {
                FUN_004052b0(-0xe,param_1);
              }
            }
            else if (((byte)param_2 & 3) == 3) {
              FUN_0040595a(param_1,param_2);
            }
          }
          BVar3 = FindNextFileW(hFindFile,&local_25c);
        } while (BVar3 != 0);
        FindClose(hFindFile);
      }
      if (uVar1 != 0) {
        (param_1 + iVar4)[-1] = L'\0';
      }
    }
    if (uVar1 != 0) {
      if (local_c != 0) {
        puVar6 = FUN_0040658f(param_1);
        if (puVar6 == (undefined *)0x0) {
          return;
        }
        FUN_00405b1d(param_1);
        iVar4 = FUN_00405912(param_1,(byte)local_8 | 1);
        if (iVar4 != 0) {
          FUN_004052b0(-0x1b,param_1);
          return;
        }
        if (local_8 != 0) {
          FUN_004052b0(-0xf,param_1);
          FUN_00406012(param_1,(LPCWSTR)0x0);
          return;
        }
      }
      _DAT_0042a2a8 = _DAT_0042a2a8 + 1;
    }
  }
  else {
    BVar3 = DeleteFileW(param_1);
    _DAT_0042a2a8 = _DAT_0042a2a8 + (uint)(BVar3 == 0);
  }
  return;
}



/* Function: FUN_00405b1d */

LPCWSTR FUN_00405b1d(LPCWSTR param_1)

{
  int iVar1;
  LPWSTR pWVar2;
  
  iVar1 = lstrlenW(param_1);
  pWVar2 = CharPrevW(param_1,param_1 + iVar1);
  if (*pWVar2 != L'\\') {
    lstrcatW(param_1,(LPCWSTR)&DAT_0040a014);
  }
  return param_1;
}



/* Function: FUN_00405b4a */

void FUN_00405b4a(LPCWSTR param_1,WCHAR param_2)

{
  for (; (*param_1 != L'\0' && (*param_1 != param_2)); param_1 = CharNextW(param_1)) {
  }
  return;
}



/* Function: FUN_00405b69 */

LPCWSTR FUN_00405b69(LPCWSTR param_1)

{
  int iVar1;
  LPCWSTR lpszCurrent;
  
  iVar1 = lstrlenW(param_1);
  lpszCurrent = param_1 + iVar1;
  do {
    if (*lpszCurrent == L'\\') break;
    lpszCurrent = CharPrevW(param_1,lpszCurrent);
  } while (param_1 < lpszCurrent);
  *lpszCurrent = L'\0';
  return lpszCurrent + 1;
}



/* Function: FUN_00405b94 */

undefined4 FUN_00405b94(ushort *param_1)

{
  ushort uVar1;
  undefined4 uVar2;
  
  uVar1 = *param_1 | 0x20;
  if (((*param_1 == 0x5c) && (param_1[1] == 0x5c)) ||
     ((0x60 < uVar1 && ((uVar1 < 0x7b && (param_1[1] == 0x3a)))))) {
    uVar2 = 1;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



/* Function: FUN_00405bc8 */

LPWSTR FUN_00405bc8(LPCWSTR param_1)

{
  LPWSTR lpsz;
  LPWSTR lpsz_00;
  short *psVar1;
  int iVar2;
  
  lpsz = CharNextW(param_1);
  lpsz_00 = CharNextW(lpsz);
  if (((*param_1 == L'\0') || (*lpsz != L':')) || (lpsz[1] != L'\\')) {
    if ((*param_1 == L'\\') && (param_1[1] == L'\\')) {
      iVar2 = 2;
      do {
        iVar2 = iVar2 + -1;
        psVar1 = (short *)FUN_00405b4a(lpsz_00,L'\\');
        if (*psVar1 == 0) goto LAB_00405c1d;
        lpsz_00 = psVar1 + 1;
      } while (iVar2 != 0);
    }
    else {
LAB_00405c1d:
      lpsz_00 = (LPWSTR)0x0;
    }
  }
  else {
    lpsz_00 = CharNextW(lpsz_00);
  }
  return lpsz_00;
}



/* Function: FUN_00405c25 */

bool FUN_00405c25(LPCWSTR param_1)

{
  LPWSTR pWVar1;
  byte *pbVar2;
  int iVar3;
  DWORD DVar4;
  
  FUN_0040624c((LPWSTR)&DAT_00425ef0,param_1);
  pWVar1 = FUN_00405bc8((LPCWSTR)&DAT_00425ef0);
  if ((pWVar1 != (LPWSTR)0x0) &&
     ((FUN_004064e0(pWVar1), ((byte)DAT_0042a21c & 0x80) == 0 ||
      ((*pWVar1 != L'\0' && (*pWVar1 != L'\\')))))) {
    while( true ) {
      iVar3 = lstrlenW((LPCWSTR)&DAT_00425ef0);
      if (iVar3 <= (int)(pWVar1 + -0x212f78) >> 1) {
        FUN_00405b1d((LPCWSTR)&DAT_00425ef0);
        DVar4 = GetFileAttributesW((LPCWSTR)&DAT_00425ef0);
        return DVar4 != 0xffffffff;
      }
      pbVar2 = FUN_0040658f((LPCWSTR)&DAT_00425ef0);
      if ((pbVar2 != (byte *)0x0) && ((*pbVar2 & 0x10) == 0)) break;
      FUN_00405b69((LPCWSTR)&DAT_00425ef0);
    }
  }
  return false;
}



/* Function: FUN_00405ca3 */

LPCSTR FUN_00405ca3(LPSTR param_1,LPCSTR param_2)

{
  CHAR CVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = lstrlenA(param_2);
  while( true ) {
    iVar3 = lstrlenA(param_1);
    if (iVar3 < iVar2) {
      return (LPCSTR)0x0;
    }
    CVar1 = param_1[iVar2];
    param_1[iVar2] = '\0';
    iVar3 = lstrcmpiA(param_1,param_2);
    param_1[iVar2] = CVar1;
    if (iVar3 == 0) break;
    param_1 = CharNextA(param_1);
  }
  return param_1;
}



/* Function: FUN_00405cf9 */

void FUN_00405cf9(undefined1 *param_1,int param_2,int param_3)

{
  int iVar1;
  
  if (param_3 != 0) {
    iVar1 = param_2 - (int)param_1;
    do {
      *param_1 = param_1[iVar1];
      param_1 = param_1 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return;
}



/* Function: FUN_00405d19 */

DWORD FUN_00405d19(LPCWSTR param_1)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesW(param_1);
  if (DVar1 != 0xffffffff) {
    SetFileAttributesW(param_1,DVar1 & 0xfffffffe);
  }
  return DVar1;
}



/* Function: FUN_00405d3e */

void FUN_00405d3e(LPCWSTR param_1,DWORD param_2,DWORD param_3)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesW(param_1);
  CreateFileW(param_1,param_2,1,(LPSECURITY_ATTRIBUTES)0x0,param_3,
              -(uint)(DVar1 != 0xffffffff) & DVar1,(HANDLE)0x0);
  return;
}



/* Function: FUN_00405d6d */

LPWSTR FUN_00405d6d(LPWSTR param_1,LPCWSTR param_2)

{
  DWORD DVar1;
  UINT UVar2;
  int iVar3;
  undefined4 local_c;
  undefined4 local_8;
  
  iVar3 = 100;
  do {
    iVar3 = iVar3 + -1;
    local_c = DAT_0040a558;
    local_8 = DAT_0040a55c;
    DVar1 = GetTickCount();
    local_8 = CONCAT22(local_8._2_2_,(short)local_8 + (short)(DVar1 % 0x1a));
    UVar2 = GetTempFileNameW(param_2,(LPCWSTR)&local_c,0,param_1);
    if (UVar2 != 0) {
      return param_1;
    }
  } while (iVar3 != 0);
  *param_1 = L'\0';
  return (LPWSTR)0x0;
}



/* Function: FUN_00405dc1 */

undefined4 FUN_00405dc1(HANDLE param_1,LPVOID param_2,DWORD param_3)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  
  DVar1 = param_3;
  BVar2 = ReadFile(param_1,param_2,param_3,&param_3,(LPOVERLAPPED)0x0);
  if ((BVar2 == 0) || (DVar1 != param_3)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



/* Function: FUN_00405df0 */

undefined4 FUN_00405df0(HANDLE param_1,LPCVOID param_2,DWORD param_3)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  
  DVar1 = param_3;
  BVar2 = WriteFile(param_1,param_2,param_3,&param_3,(LPOVERLAPPED)0x0);
  if ((BVar2 == 0) || (DVar1 != param_3)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



/* Function: FUN_00405e1f */

int FUN_00405e1f(HANDLE param_1,int param_2)

{
  HANDLE hFile;
  DWORD DVar1;
  int iVar2;
  
  hFile = param_1;
  DVar1 = SetFilePointer(param_1,0,(PLONG)0x0,1);
  if (DVar1 == 0) {
    iVar2 = FUN_00405dc1(hFile,(LPVOID)((int)&param_1 + 2),2);
    if (((iVar2 != 0) && (param_1._2_1_ == -1)) && (param_1._3_1_ == -2)) {
      return 0;
    }
    if ((param_2 != 0) && (DVar1 = SetFilePointer(hFile,0,(PLONG)0x0,1), DVar1 == 0)) {
      iVar2 = FUN_00405df0(hFile,&DAT_00408414,2);
      return (-(uint)(iVar2 != 0) & 0x7fffbffb) + 0x80004005;
    }
    SetFilePointer(hFile,0,(PLONG)0x0,0);
  }
  return 1;
}



/* Function: FUN_00405e98 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_00405e98(LPCWSTR param_1,LPCWSTR param_2)

{
  HANDLE pvVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR pCVar4;
  LPSTR hMem;
  int iVar5;
  LPCSTR pCVar6;
  LPCSTR pCVar7;
  CHAR *pCVar8;
  LPSTR pCVar9;
  
  _DAT_00426d88 = 0x55004e;
  _DAT_00426d8c = 0x4c;
  if (param_2 != (LPCWSTR)0x0) {
    pvVar1 = (HANDLE)FUN_00405d3e(param_2,0,1);
    CloseHandle(pvVar1);
    DVar2 = GetShortPathNameW(param_2,(LPWSTR)&DAT_00426d88,0x400);
    if (DVar2 == 0) {
      return;
    }
    if (0x400 < (int)DVar2) {
      return;
    }
  }
  DVar2 = GetShortPathNameW(param_1,(LPWSTR)&DAT_00427588,0x400);
  if ((DVar2 != 0) && ((int)DVar2 < 0x401)) {
    iVar3 = wsprintfA(&DAT_00426988,s__ls__ls_0040a570,&DAT_00426d88,&DAT_00427588);
    FUN_0040626e((LPWSTR)&DAT_00427588,*(int *)(DAT_0042a214 + 0x128));
    pvVar1 = (HANDLE)FUN_00405d3e((LPCWSTR)&DAT_00427588,0xc0000000,4);
    if (pvVar1 != (HANDLE)0xffffffff) {
      pCVar4 = (LPCSTR)GetFileSize(pvVar1,(LPDWORD)0x0);
      hMem = (LPSTR)GlobalAlloc(0x40,(SIZE_T)(pCVar4 + iVar3 + 10));
      if ((hMem != (LPSTR)0x0) && (iVar5 = FUN_00405dc1(pvVar1,hMem,(DWORD)pCVar4), iVar5 != 0)) {
        pCVar6 = FUN_00405ca3(hMem,s__Rename__0040a564);
        if (pCVar6 == (LPCSTR)0x0) {
          lstrcpyA(hMem + (int)pCVar4,s__Rename__0040a564);
          pCVar4 = pCVar4 + 10;
          pCVar6 = pCVar4;
        }
        else {
          pCVar7 = FUN_00405ca3(pCVar6 + 10,&DAT_0040a560);
          pCVar6 = pCVar4;
          if (pCVar7 != (LPCSTR)0x0) {
            pCVar9 = hMem + (int)pCVar4;
            pCVar8 = pCVar9 + iVar3;
            for (; pCVar7 < pCVar9; pCVar9 = pCVar9 + -1) {
              *pCVar8 = *pCVar9;
              pCVar8 = pCVar8 + -1;
            }
            pCVar6 = pCVar7 + (1 - (int)hMem);
          }
        }
        FUN_00405cf9(hMem + (int)pCVar6,0x426988,iVar3);
        SetFilePointer(pvVar1,0,(PLONG)0x0,0);
        FUN_00405df0(pvVar1,hMem,(DWORD)(pCVar4 + iVar3));
        GlobalFree(hMem);
      }
      CloseHandle(pvVar1);
    }
  }
  return;
}



/* Function: FUN_00406012 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00406012(LPCWSTR param_1,LPCWSTR param_2)

{
  BOOL BVar1;
  
  BVar1 = MoveFileExW(param_1,param_2,5);
  if (BVar1 == 0) {
    FUN_00405e98(param_1,param_2);
  }
  _DAT_0042a2b0 = _DAT_0042a2b0 + 1;
  return;
}



/* Function: FUN_0040603e */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint FUN_0040603e(uint param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar1 = *param_2;
  uVar3 = ~DAT_0042a20c >> 0x16 & 0x100;
  if (((uVar1 & 0x20) == 0) || ((param_1 & 0x60000000) == 0)) {
    if ((uVar1 & 0x100000) != 0) {
      uVar1 = uVar1 | _DAT_0042a2d0;
    }
  }
  else {
    uVar2 = param_1 >> 0x15 & 0x300;
    if (uVar2 == 0x300) {
      uVar2 = ~uVar3 & _DAT_0042a2d0;
    }
    uVar1 = (uVar1 & 0xfffffeff | uVar2) & 0xfffffdff;
    param_1 = param_1 & 0x9fffffff;
  }
  *param_2 = uVar1 & 0xffefffdf;
  return ~-(uint)((uVar1 & uVar3) != 0) & param_1;
}



/* Function: FUN_004060b9 */

LSTATUS FUN_004060b9(uint param_1,LPCWSTR param_2,REGSAM param_3,PHKEY param_4)

{
  HKEY hKey;
  LSTATUS LVar1;
  
  hKey = (HKEY)FUN_0040603e(param_1,&param_3);
  if (hKey == (HKEY)0x0) {
    LVar1 = 6;
  }
  else {
    LVar1 = RegOpenKeyExW(hKey,param_2,0,param_3,param_4);
  }
  return LVar1;
}



/* Function: FUN_004060e7 */

LSTATUS FUN_004060e7(uint param_1,LPCWSTR param_2,REGSAM param_3,PHKEY param_4)

{
  HKEY hKey;
  LSTATUS LVar1;
  
  hKey = (HKEY)FUN_0040603e(param_1,&param_3);
  if (hKey == (HKEY)0x0) {
    LVar1 = 6;
  }
  else {
    LVar1 = RegCreateKeyExW(hKey,param_2,0,(LPWSTR)0x0,0,param_3,(LPSECURITY_ATTRIBUTES)0x0,param_4,
                            (LPDWORD)0x0);
  }
  return LVar1;
}



/* Function: FUN_0040611a */

void FUN_0040611a(uint param_1,LPCWSTR param_2,LPCWSTR param_3,LPBYTE param_4,HKEY param_5)

{
  LPBYTE pBVar1;
  LSTATUS LVar2;
  DWORD local_8;
  
  local_8 = 0x800;
  LVar2 = FUN_004060b9(param_1,param_2,-(uint)(param_5 != (HKEY)0x0) & 0x100 | 0x20019,&param_5);
  pBVar1 = param_4;
  if (LVar2 == 0) {
    LVar2 = RegQueryValueExW(param_5,param_3,(LPDWORD)0x0,(LPDWORD)&param_2,param_4,&local_8);
    RegCloseKey(param_5);
    pBVar1[0x7fe] = '\0';
    pBVar1[0x7ff] = '\0';
    if (LVar2 == 0) {
      if (param_2 == (LPCWSTR)0x1) {
        return;
      }
      if (param_2 == (LPCWSTR)0x2) {
        return;
      }
    }
  }
  pBVar1[0] = '\0';
  pBVar1[1] = '\0';
  return;
}



/* Function: FUN_00406193 */

void FUN_00406193(LPWSTR param_1,undefined4 param_2)

{
  wsprintfW(param_1,L"%d",param_2);
  return;
}



/* Function: FUN_004061ac */

int FUN_004061ac(ushort *param_1)

{
  ushort uVar1;
  ushort uVar2;
  ushort *puVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int local_c;
  int local_8;
  
  local_8 = 0;
  uVar2 = 10;
  local_c = 1;
  uVar6 = 0x39;
  if (*param_1 == 0x2d) {
    param_1 = param_1 + 1;
    local_c = -1;
  }
  puVar3 = param_1;
  if (*param_1 == 0x30) {
    puVar3 = param_1 + 1;
    uVar1 = *puVar3;
    if ((0x2f < uVar1) && (uVar1 < 0x38)) {
      uVar2 = 8;
      uVar6 = 0x37;
    }
    if ((uVar1 & 0xffdf) == 0x58) {
      uVar2 = 0x10;
      puVar3 = param_1 + 2;
    }
  }
  do {
    uVar4 = (uint)*puVar3;
    puVar3 = puVar3 + 1;
    if ((uVar4 < 0x30) || (uVar6 < uVar4)) {
      if ((uVar2 != 0x10) || (((uVar4 & 0xffffffdf) < 0x41 || (0x46 < (uVar4 & 0xffffffdf))))) {
        return local_c * local_8;
      }
      iVar5 = (uVar4 & 7) + 9;
    }
    else {
      iVar5 = uVar4 - 0x30;
    }
    local_8 = (uint)uVar2 * local_8 + iVar5;
  } while( true );
}



/* Function: FUN_0040624c */

void FUN_0040624c(LPWSTR param_1,LPCWSTR param_2)

{
  lstrcpynW(param_1,param_2,0x400);
  return;
}



/* Function: lstrlenW */

int lstrlenW(LPCWSTR lpString)

{
  int iVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00406262. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = lstrlenW(lpString);
  return iVar1;
}



/* Function: lstrcatW */

LPWSTR lstrcatW(LPWSTR lpString1,LPCWSTR lpString2)

{
  LPWSTR pWVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00406268. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  pWVar1 = lstrcatW(lpString1,lpString2);
  return pWVar1;
}



/* Function: FUN_0040626e */

void FUN_0040626e(LPWSTR param_1,int param_2)

{
  byte bVar1;
  WCHAR WVar2;
  LPWSTR pWVar3;
  int iVar4;
  HRESULT HVar5;
  BOOL BVar6;
  int iVar7;
  WCHAR *pWVar8;
  uint uVar9;
  WCHAR *pWVar10;
  uint uVar11;
  LPWSTR lpBuffer;
  uint local_1c [4];
  LPCITEMIDLIST local_c;
  uint local_8;
  
  pWVar3 = param_1;
  if (param_2 < 0) {
    param_2 = *(int *)(DAT_004291dc - (param_2 * 4 + 4));
  }
  pWVar10 = (WCHAR *)(DAT_0042a258 + param_2 * 2);
  lpBuffer = &DAT_004281a0;
  if (((LPWSTR)0x42819f < param_1) && ((uint)((int)(param_1 + -0x2140d0) >> 1) < 0x800)) {
    param_1 = (LPWSTR)0x0;
    lpBuffer = pWVar3;
  }
  do {
    while( true ) {
      WVar2 = *pWVar10;
      if ((WVar2 == L'\0') || (0x7ff < (int)((uint)(lpBuffer + -0x2140d0) & 0xfffffffe))) {
        *lpBuffer = L'\0';
        if (param_1 != (LPWSTR)0x0) {
          FUN_0040624c(param_1,&DAT_004281a0);
        }
        return;
      }
      pWVar8 = pWVar10 + 1;
      if ((ushort)WVar2 < 4) break;
      if (WVar2 == L'\x04') {
        *lpBuffer = *pWVar8;
        lpBuffer = lpBuffer + 1;
        pWVar10 = pWVar10 + 2;
      }
      else {
        *lpBuffer = WVar2;
        lpBuffer = lpBuffer + 1;
        pWVar10 = pWVar8;
      }
    }
    bVar1 = (byte)*pWVar8;
    local_1c[1] = (uint)bVar1;
    uVar9 = (*(byte *)((int)pWVar10 + 3) & 0x7f) << 7 | bVar1 & 0x7f;
    local_1c[0] = local_1c[1] | 0x8000;
    uVar11 = (uint)*(byte *)((int)pWVar10 + 3);
    local_1c[3] = uVar11;
    local_1c[2] = uVar11 | 0x8000;
    if (WVar2 == L'\x02') {
      iVar7 = 2;
      if ((((DAT_0042a20c < 0) && ((short)DAT_0042a20c != 0x5a04)) && (uVar11 != 0x23)) &&
         (uVar11 != 0x2e)) {
        local_8 = 0;
      }
      else {
        local_8 = 1;
      }
      if (DAT_0042a2a4 != 0) {
        iVar7 = 4;
      }
      if ((char)bVar1 < '\0') {
        FUN_0040611a(0x80000002,L"Software\\Microsoft\\Windows\\CurrentVersion",
                     (LPCWSTR)(DAT_0042a258 + (local_1c[1] & 0x3f) * 2),(LPBYTE)lpBuffer,
                     (HKEY)(local_1c[1] & 0x40));
        if (*lpBuffer == L'\0') {
          FUN_0040626e(lpBuffer,uVar11);
          goto LAB_00406429;
        }
LAB_00406432:
        if (uVar11 == 0x1a) {
          lstrcatW(lpBuffer,L"\\Microsoft\\Internet Explorer\\Quick Launch");
        }
      }
      else {
        if (local_1c[1] == 0x25) {
          GetSystemDirectoryW(lpBuffer,0x400);
        }
        else {
          if (local_1c[1] == 0x24) {
            GetWindowsDirectoryW(lpBuffer,0x400);
            iVar7 = 0;
          }
          while ((iVar7 != 0 &&
                 (((iVar7 = iVar7 + -1, DAT_0042a204 == (code *)0x0 || (local_8 == 0)) ||
                  (iVar4 = (*DAT_0042a204)(DAT_0042a208,local_1c[iVar7],0,0,lpBuffer), iVar4 != 0)))
                 )) {
            HVar5 = SHGetSpecialFolderLocation(DAT_0042a208,local_1c[iVar7],&local_c);
            if (HVar5 == 0) {
              BVar6 = SHGetPathFromIDListW(local_c,lpBuffer);
              CoTaskMemFree(local_c);
              if (BVar6 != 0) break;
            }
            *lpBuffer = L'\0';
          }
        }
LAB_00406429:
        uVar11 = local_1c[3];
        if (*lpBuffer != L'\0') goto LAB_00406432;
      }
LAB_00406442:
      FUN_004064e0(lpBuffer);
    }
    else {
      local_8 = uVar9;
      if (WVar2 == L'\x03') {
        if (uVar9 == 0x1d) {
          FUN_00406193(lpBuffer,DAT_0042a208);
        }
        else {
          FUN_0040624c(lpBuffer,(LPCWSTR)(&DAT_0042b000 + uVar9 * 0x800));
        }
        if (uVar9 - 0x15 < 7) goto LAB_00406442;
      }
      else if (WVar2 == L'\x01') {
        FUN_0040626e(lpBuffer,-1 - uVar9);
      }
    }
    iVar7 = lstrlenW(lpBuffer);
    lpBuffer = lpBuffer + iVar7;
    pWVar10 = pWVar10 + 2;
  } while( true );
}



/* Function: FUN_004064e0 */

void FUN_004064e0(LPCWSTR param_1)

{
  WCHAR WVar1;
  int iVar2;
  short *psVar3;
  LPWSTR pWVar4;
  LPCWSTR lpsz;
  LPCWSTR lpsz_00;
  
  if ((((*param_1 == L'\\') && (param_1[1] == L'\\')) && (param_1[2] == L'?')) &&
     (param_1[3] == L'\\')) {
    param_1 = param_1 + 4;
  }
  if ((*param_1 != L'\0') && (iVar2 = FUN_00405b94((ushort *)param_1), iVar2 != 0)) {
    param_1 = param_1 + 2;
  }
  WVar1 = *param_1;
  lpsz_00 = param_1;
  lpsz = param_1;
  while (WVar1 != L'\0') {
    if ((0x1f < (ushort)WVar1) &&
       (psVar3 = (short *)FUN_00405b4a(u____<>____0040a57c,WVar1), *psVar3 == 0)) {
      pWVar4 = CharNextW(lpsz_00);
      FUN_00405cf9((undefined1 *)lpsz,(int)lpsz_00,(int)pWVar4 - (int)lpsz_00 >> 1);
      lpsz = CharNextW(lpsz);
    }
    lpsz_00 = CharNextW(lpsz_00);
    WVar1 = *lpsz_00;
  }
  *lpsz = L'\0';
  while( true ) {
    lpsz = CharPrevW(param_1,lpsz);
    if ((*lpsz != L' ') && (*lpsz != L'\\')) break;
    *lpsz = L'\0';
    if (lpsz <= param_1) {
      return;
    }
  }
  return;
}



/* Function: FUN_0040658f */

undefined * FUN_0040658f(LPCWSTR param_1)

{
  HANDLE hFindFile;
  undefined *puVar1;
  
  hFindFile = FindFirstFileW(param_1,(LPWIN32_FIND_DATAW)&DAT_00426738);
  if (hFindFile == (HANDLE)0xffffffff) {
    puVar1 = (undefined *)0x0;
  }
  else {
    FindClose(hFindFile);
    puVar1 = &DAT_00426738;
  }
  return puVar1;
}



/* Function: FUN_004065b6 */

void FUN_004065b6(undefined4 param_1)

{
  UINT UVar1;
  int iVar2;
  WCHAR local_240 [286];
  
  UVar1 = GetSystemDirectoryW(local_240,0x104);
  if (0x104 < UVar1) {
    UVar1 = 0;
  }
  if ((UVar1 == 0) || (local_240[UVar1 - 1] == L'\\')) {
    iVar2 = 1;
  }
  else {
    iVar2 = 0;
  }
  wsprintfW(local_240 + UVar1,u__s_S_dll_0040a590,&DAT_0040a014 + iVar2 * 2,param_1);
  LoadLibraryExW(local_240,(HANDLE)0x0,8);
  return;
}



/* Function: FUN_00406626 */

FARPROC FUN_00406626(int param_1)

{
  LPCSTR lpModuleName;
  HMODULE hModule;
  FARPROC pFVar1;
  
  lpModuleName = (&PTR_s_KERNEL32_0040a3e0)[param_1 * 2];
  hModule = GetModuleHandleA(lpModuleName);
  if ((hModule == (HMODULE)0x0) &&
     (hModule = (HMODULE)FUN_004065b6(lpModuleName), hModule == (HMODULE)0x0)) {
    return (FARPROC)0x0;
  }
  pFVar1 = GetProcAddress(hModule,(&PTR_s_SetDefaultDllDirectories_0040a3e4)[param_1 * 2]);
  return pFVar1;
}



/* Function: FUN_00406662 */

void FUN_00406662(UINT param_1)

{
  BOOL BVar1;
  MSG local_20;
  
  while( true ) {
    BVar1 = PeekMessageW(&local_20,(HWND)0x0,param_1,param_1,1);
    if (BVar1 == 0) break;
    DispatchMessageW(&local_20);
  }
  return;
}



/* Function: FUN_00406695 */

FARPROC FUN_00406695(HMODULE param_1,LPCWSTR param_2)

{
  int iVar1;
  FARPROC pFVar2;
  CHAR local_104 [256];
  
  iVar1 = WideCharToMultiByte(0,0,param_2,-1,local_104,0x100,(LPCSTR)0x0,(LPBOOL)0x0);
  if (iVar1 == 0) {
    pFVar2 = (FARPROC)0x0;
  }
  else {
    pFVar2 = GetProcAddress(param_1,local_104);
  }
  return pFVar2;
}



/* Function: FUN_004066d7 */

DWORD FUN_004066d7(HANDLE param_1)

{
  DWORD DVar1;
  DWORD local_8;
  
  DVar1 = WaitForSingleObject(param_1,100);
  while (DVar1 == 0x102) {
    FUN_00406662(0xf);
    DVar1 = WaitForSingleObject(param_1,100);
  }
  GetExitCodeProcess(param_1,&local_8);
  return local_8;
}



/* Function: FUN_00406719 */

uint FUN_00406719(uint param_1,byte *param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  
  if (DAT_00427d8c == 0) {
    uVar2 = 0;
    do {
      iVar3 = 8;
      uVar1 = uVar2;
      do {
        uVar1 = uVar1 >> 1 ^ -(uint)((uVar1 & 1) != 0) & 0xedb88320;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
      (&DAT_00427d88)[uVar2] = uVar1;
      uVar2 = uVar2 + 1;
    } while ((int)uVar2 < 0x100);
  }
  uVar2 = ~param_1;
  if (param_3 != 0) {
    do {
      uVar2 = uVar2 >> 8 ^ (&DAT_00427d88)[uVar2 & 0xff ^ (uint)*param_2];
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return ~uVar2;
}



/* Function: FUN_00406787 */

void __fastcall FUN_00406787(int param_1)

{
  int iVar1;
  
  iVar1 = 0x80;
  do {
    iVar1 = iVar1 + -1;
    *(undefined1 *)(iVar1 + param_1) = 0;
  } while (iVar1 != 0);
  *(undefined4 *)(param_1 + 0x78) = 0xffffffff;
  *(undefined4 *)(param_1 + 0x68) = 1;
  *(undefined4 *)(param_1 + 100) = 1;
  *(undefined4 *)(param_1 + 0x60) = 1;
  *(undefined4 *)(param_1 + 0x5c) = 1;
  return;
}



/* Function: FUN_004067a7 */

undefined4 __fastcall FUN_004067a7(SIZE_T *param_1)

{
  byte bVar1;
  ushort uVar2;
  ulonglong uVar3;
  SIZE_T dwBytes;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  ushort *puVar11;
  SIZE_T *pSVar12;
  SIZE_T *pSVar13;
  bool bVar14;
  SIZE_T local_8c [5];
  uint local_78;
  byte *local_74;
  int local_70;
  byte *local_6c;
  int local_68;
  uint local_64;
  byte local_60;
  byte local_5f;
  ushort *local_5c;
  ushort *local_58;
  int local_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  undefined4 local_40;
  int local_3c;
  int local_38;
  int local_34;
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  uint local_10;
  HGLOBAL local_c;
  HGLOBAL local_8;
  
  pSVar12 = param_1;
  pSVar13 = local_8c;
  for (iVar9 = 0x22; iVar9 != 0; iVar9 = iVar9 + -1) {
    *pSVar13 = *pSVar12;
    pSVar12 = pSVar12 + 1;
    pSVar13 = pSVar13 + 1;
  }
  uVar10 = local_48;
  puVar11 = local_58;
  if (local_34 == -1) {
    return 1;
  }
LAB_004067da:
  do {
    uVar6 = local_24;
    uVar8 = local_30;
    pbVar5 = local_6c;
    pbVar4 = local_74;
    switch(local_8c[0]) {
    case 0:
      if (local_70 == 0) goto LAB_004071dc;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      bVar1 = *pbVar4;
      if (0xe1 < bVar1) {
        return 0xffffffff;
      }
      uVar3 = (ulonglong)((uint)bVar1 % 0x2d) % 9;
      local_40 = (int)uVar3;
      local_20 = (1 << bVar1 / 0x2d) - 1;
      local_1c = (1 << (sbyte)((ulonglong)((uint)bVar1 % 0x2d) / 9)) - 1;
      iVar9 = (0x300 << (char)uVar3 + bVar1 / 0x2d) + 0x736;
      dwBytes = iVar9 * 2;
      if (dwBytes != local_8c[4]) {
        if (local_8 != (HGLOBAL)0x0) {
          GlobalFree(local_8);
        }
        local_8 = GlobalAlloc(0x40,dwBytes);
        if (local_8 == (HGLOBAL)0x0) {
          return 0xffffffff;
        }
        local_8c[4] = dwBytes;
      }
      while (iVar9 != 0) {
        iVar9 = iVar9 + -1;
        *(undefined2 *)((int)local_8 + iVar9 * 2) = 0x400;
      }
      local_44 = 0;
      for (local_4c = 0; (int)local_4c < 4; local_4c = local_4c + 1) {
switchD_004067e9_caseD_1:
        if (local_70 == 0) {
          local_8c[0] = 1;
          goto LAB_004071dc;
        }
        local_70 = local_70 + -1;
        local_44 = local_44 | (uint)*local_74 << ((byte)(local_4c << 3) & 0x1f);
        local_74 = local_74 + 1;
      }
      if (local_44 != local_78) {
        local_78 = local_44;
        if (local_c != (HGLOBAL)0x0) {
          GlobalFree(local_c);
        }
        local_c = GlobalAlloc(0x40,local_44);
        if (local_c == (HGLOBAL)0x0) {
          return 0xffffffff;
        }
      }
      local_4c = 5;
      *(undefined1 *)((int)local_c + (local_78 - 1)) = 0;
      while (uVar8 = local_4c, local_4c = local_4c - 1, uVar8 != 0) {
switchD_004067e9_caseD_3:
        if (local_70 == 0) {
          local_8c[0] = 3;
          goto LAB_004071dc;
        }
        local_70 = local_70 + -1;
        bVar1 = *local_74;
        local_74 = local_74 + 1;
        local_10 = local_10 << 8 | (uint)bVar1;
      }
    case 2:
      local_8c[1] = 6;
      local_50 = local_64 & local_20;
      puVar11 = (ushort *)((int)local_8 + (local_3c * 0x10 + (local_64 & local_20)) * 2);
      break;
    case 1:
      goto switchD_004067e9_caseD_1;
    case 3:
      goto switchD_004067e9_caseD_3;
    case 4:
      goto switchD_004067e9_caseD_4;
    case 5:
      goto switchD_004067e9_caseD_5;
    case 6:
      if (local_44 != 0) {
        local_38 = 1;
        local_8c[1] = 7;
        puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x180);
        break;
      }
      local_5c = (ushort *)
                 (((uint)(local_60 >> (8 - (byte)local_40 & 0x1f)) +
                  ((local_64 & local_1c) << ((byte)local_40 & 0x1f))) * 0x600 + 0xe6c + (int)local_8
                 );
      if (local_3c < 4) {
        local_3c = 0;
      }
      else if (local_3c < 10) {
        local_3c = local_3c + -3;
      }
      else {
        local_3c = local_3c + -6;
      }
      if (local_38 != 0) {
        uVar8 = local_18 - local_30;
        if (local_78 <= uVar8) {
          uVar8 = uVar8 + local_78;
        }
        uVar10 = 1;
        local_5f = *(byte *)(uVar8 + (int)local_c);
        do {
          bVar1 = local_5f;
          local_5f = local_5f << 1;
          local_4c = (uint)(bVar1 >> 7);
          puVar11 = local_5c + ((bVar1 >> 7) + 1) * 0x100 + uVar10;
          uVar2 = *puVar11;
          local_58 = puVar11;
          uVar8 = (local_14 >> 0xb) * (uint)uVar2;
          bVar14 = uVar8 <= local_10;
          if (bVar14) {
            local_14 = local_14 - uVar8;
            local_10 = local_10 - uVar8;
            local_44 = 1;
            uVar10 = uVar10 * 2 + 1;
            *puVar11 = uVar2 - (uVar2 >> 5);
          }
          else {
            local_44 = 0;
            local_14 = uVar8;
            uVar10 = uVar10 * 2;
            *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
          }
          local_44 = (uint)bVar14;
          local_48 = uVar10;
          if (local_14 < 0x1000000) {
switchD_004067e9_caseD_d:
            if (local_70 == 0) {
              local_8c[0] = 0xd;
              goto LAB_004071dc;
            }
            local_14 = local_14 << 8;
            bVar1 = *local_74;
            local_70 = local_70 + -1;
            local_74 = local_74 + 1;
            local_10 = local_10 << 8 | (uint)bVar1;
          }
          if (local_4c != local_44) goto LAB_00406acd;
        } while ((int)uVar10 < 0x100);
        goto LAB_00406b31;
      }
      uVar10 = 1;
      do {
        puVar11 = local_5c + uVar10;
        uVar2 = *puVar11;
        local_58 = puVar11;
        uVar8 = (local_14 >> 0xb) * (uint)uVar2;
        if (local_10 < uVar8) {
          local_14 = uVar8;
          uVar10 = uVar10 * 2;
          *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
        }
        else {
          local_14 = local_14 - uVar8;
          local_10 = local_10 - uVar8;
          uVar10 = uVar10 * 2 + 1;
          *puVar11 = uVar2 - (uVar2 >> 5);
        }
        local_48 = uVar10;
        if (local_14 < 0x1000000) {
switchD_004067e9_caseD_f:
          if (local_70 == 0) {
            local_8c[0] = 0xf;
            goto LAB_004071dc;
          }
          local_14 = local_14 << 8;
          bVar1 = *local_74;
          local_70 = local_70 + -1;
          local_74 = local_74 + 1;
          local_10 = local_10 << 8 | (uint)bVar1;
        }
      } while ((int)uVar10 < 0x100);
      goto LAB_00406b35;
    case 7:
      if (local_44 != 1) {
        local_8c[2] = 0x16;
        local_24 = local_28;
        local_28 = local_2c;
        local_2c = local_30;
        local_3c = ((6 < local_3c) - 1 & 0xfffffffd) + 10;
        local_5c = (ushort *)((int)local_8 + 0x664);
        goto switchD_004067e9_caseD_11;
      }
      local_8c[1] = 8;
      puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x198);
      break;
    case 8:
      if (local_44 == 0) {
        local_8c[1] = 9;
        puVar11 = (ushort *)((int)local_8 + ((local_3c + 0xf) * 0x10 + local_50) * 2);
      }
      else {
        local_8c[1] = 10;
        puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x1b0);
      }
      break;
    case 9:
      if (local_44 != 0) goto LAB_00406d5d;
      if (local_64 == 0) {
        return 0xffffffff;
      }
      local_3c = (uint)(6 < local_3c) * 2 + 9;
    case 0x1b:
      if (local_68 == 0) {
        local_8c[0] = 0x1b;
        goto LAB_004071dc;
      }
      uVar8 = local_18 - local_30;
      if (local_78 <= uVar8) {
        uVar8 = uVar8 + local_78;
      }
      local_60 = *(byte *)(uVar8 + (int)local_c);
      *(byte *)(local_18 + (int)local_c) = local_60;
      local_64 = local_64 + 1;
      local_6c = local_6c + 1;
      local_68 = local_68 + -1;
      *pbVar5 = local_60;
      goto LAB_00406d01;
    case 10:
      if (local_44 == 0) goto LAB_00406d54;
      local_8c[1] = 0xb;
      puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x1c8);
      break;
    case 0xb:
      uVar7 = local_28;
      if (local_44 != 0) {
        local_24 = local_28;
        uVar7 = uVar6;
      }
      local_28 = local_2c;
      local_2c = uVar7;
LAB_00406d54:
      local_30 = local_2c;
      local_2c = uVar8;
LAB_00406d5d:
      local_8c[2] = 0x15;
      local_5c = (ushort *)((int)local_8 + 0xa68);
    case 0x11:
switchD_004067e9_caseD_11:
      local_8c[1] = 0x12;
      puVar11 = local_5c;
      break;
    case 0xc:
      while (local_70 != 0) {
        local_14 = local_14 << 8;
        bVar1 = *local_74;
        local_70 = local_70 + -1;
        local_74 = local_74 + 1;
        local_10 = local_10 << 8 | (uint)bVar1;
        uVar8 = local_30;
        do {
          local_4c = local_4c - 1;
LAB_00406e25:
          if ((int)local_4c < 1) {
            local_44 = 4;
            local_30 = uVar8 + uVar10 * 0x10;
            local_5c = (ushort *)((int)local_8 + 0x644);
            goto LAB_00406e69;
          }
          uVar10 = uVar10 * 2;
          local_14 = local_14 >> 1;
          local_48 = uVar10;
          if (local_14 <= local_10) {
            local_10 = local_10 - local_14;
            uVar10 = uVar10 | 1;
            local_48 = uVar10;
          }
        } while (0xffffff < local_14);
      }
      local_8c[0] = 0xc;
      goto LAB_004071dc;
    case 0xd:
      goto switchD_004067e9_caseD_d;
    case 0xe:
      goto switchD_004067e9_caseD_e;
    case 0xf:
      goto switchD_004067e9_caseD_f;
    case 0x10:
      goto switchD_004067e9_caseD_10;
    case 0x12:
      if (local_44 == 0) {
        local_34 = 0;
        iVar9 = local_50 * 8 + 2;
LAB_00406fa3:
        local_5c = local_5c + iVar9;
        local_44 = 3;
        goto LAB_00407080;
      }
      local_8c[1] = 0x13;
      puVar11 = local_5c + 1;
      break;
    case 0x13:
      if (local_44 == 0) {
        local_34 = 8;
        iVar9 = local_50 * 8 + 0x82;
        goto LAB_00406fa3;
      }
      local_5c = local_5c + 0x102;
      local_34 = 0x10;
      local_44 = 8;
LAB_00407080:
      local_8c[3] = 0x14;
    case 0x17:
switchD_004067e9_caseD_17:
      local_54 = 1;
      for (local_4c = local_44; 0 < (int)local_4c; local_4c = local_4c - 1) {
        puVar11 = local_5c + local_54;
        local_58 = puVar11;
        uVar2 = *puVar11;
        uVar10 = (local_14 >> 0xb) * (uint)uVar2;
        if (local_10 < uVar10) {
          local_14 = uVar10;
          local_54 = local_54 << 1;
          *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
        }
        else {
          local_14 = local_14 - uVar10;
          local_10 = local_10 - uVar10;
          *puVar11 = uVar2 - (uVar2 >> 5);
          local_54 = local_54 * 2 + 1;
        }
        if (local_14 < 0x1000000) {
switchD_004067e9_caseD_18:
          if (local_70 == 0) {
            local_8c[0] = 0x18;
            goto LAB_004071dc;
          }
          local_14 = local_14 << 8;
          bVar1 = *local_74;
          local_70 = local_70 + -1;
          local_74 = local_74 + 1;
          local_10 = local_10 << 8 | (uint)bVar1;
        }
      }
      uVar10 = local_54 - (1 << ((byte)local_44 & 0x1f));
      local_48 = uVar10;
      local_8c[0] = local_8c[3];
      goto LAB_0040703e;
    case 0x14:
      local_34 = local_34 + uVar10;
      local_8c[0] = local_8c[2];
      goto LAB_0040703e;
    case 0x15:
      local_3c = ((6 < local_3c) - 1 & 0xfffffffd) + 0xb;
      goto LAB_00406f25;
    case 0x16:
      iVar9 = local_34;
      if (3 < local_34) {
        iVar9 = 3;
      }
      local_44 = 6;
      local_8c[3] = 0x19;
      local_5c = (ushort *)(iVar9 * 0x80 + 0x360 + (int)local_8);
      goto switchD_004067e9_caseD_17;
    case 0x18:
      goto switchD_004067e9_caseD_18;
    case 0x19:
      local_30 = uVar10;
      if (3 < (int)uVar10) {
        iVar9 = (int)uVar10 >> 1;
        local_44 = iVar9 - 1;
        uVar8 = (uint)((byte)uVar10 & 1 | 2) << ((byte)local_44 & 0x1f);
        local_30 = uVar8;
        if (0xd < (int)uVar10) {
          uVar10 = 0;
          local_4c = iVar9 - 5;
          goto LAB_00406e25;
        }
        local_5c = (ushort *)((int)local_8 + (uVar8 - uVar10) * 2 + 0x55e);
LAB_00406e69:
        uVar10 = 0;
        local_54 = 1;
        local_48 = 0;
        for (local_4c = 0; (int)local_4c < (int)local_44; local_4c = local_4c + 1) {
          puVar11 = local_5c + local_54;
          local_58 = puVar11;
          uVar2 = *puVar11;
          uVar8 = (local_14 >> 0xb) * (uint)uVar2;
          if (local_10 < uVar8) {
            local_14 = uVar8;
            local_54 = local_54 << 1;
            *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
          }
          else {
            local_14 = local_14 - uVar8;
            local_10 = local_10 - uVar8;
            uVar10 = local_48 | 1 << ((byte)local_4c & 0x1f);
            local_48 = uVar10;
            *puVar11 = uVar2 - (uVar2 >> 5);
            local_54 = local_54 * 2 + 1;
          }
          if (local_14 < 0x1000000) {
switchD_004067e9_caseD_10:
            if (local_70 == 0) {
              local_8c[0] = 0x10;
              goto LAB_004071dc;
            }
            local_14 = local_14 << 8;
            bVar1 = *local_74;
            local_70 = local_70 + -1;
            local_74 = local_74 + 1;
            local_10 = local_10 << 8 | (uint)bVar1;
          }
        }
        local_30 = local_30 + uVar10;
      }
      local_30 = local_30 + 1;
LAB_00406f25:
      if (local_30 == 0) {
        local_34 = 0xffffffff;
        goto LAB_004071dc;
      }
      if (local_64 < local_30) {
        return 0xffffffff;
      }
      local_34 = local_34 + 2;
      local_64 = local_64 + local_34;
switchD_004067e9_caseD_1c:
      do {
        pbVar4 = local_6c;
        if (local_68 == 0) {
          local_8c[0] = 0x1c;
          goto LAB_004071dc;
        }
        uVar8 = local_18 - local_30;
        if (local_78 <= uVar8) {
          uVar8 = uVar8 + local_78;
        }
        local_60 = *(byte *)(uVar8 + (int)local_c);
        *(byte *)(local_18 + (int)local_c) = local_60;
        local_6c = local_6c + 1;
        local_68 = local_68 + -1;
        local_34 = local_34 + -1;
        *pbVar4 = local_60;
        local_18 = (local_18 + 1) % local_78;
      } while (0 < local_34);
      goto LAB_00406d04;
    case 0x1a:
      goto switchD_004067e9_caseD_1a;
    case 0x1c:
      goto switchD_004067e9_caseD_1c;
    default:
      return 0xffffffff;
    }
    local_58 = puVar11;
switchD_004067e9_caseD_4:
    uVar2 = *puVar11;
    uVar8 = (local_14 >> 0xb) * (uint)uVar2;
    bVar14 = uVar8 <= local_10;
    if (bVar14) {
      local_14 = local_14 - uVar8;
      local_10 = local_10 - uVar8;
      local_44 = 1;
      *puVar11 = uVar2 - (uVar2 >> 5);
    }
    else {
      local_14 = uVar8;
      local_44 = 0;
      *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
    }
    local_44 = (uint)bVar14;
    local_8c[0] = local_8c[1];
    if (local_14 < 0x1000000) {
switchD_004067e9_caseD_5:
      if (local_70 == 0) {
        local_8c[0] = 5;
        goto LAB_004071dc;
      }
      local_14 = local_14 << 8;
      bVar1 = *local_74;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      local_10 = local_10 << 8 | (uint)bVar1;
      local_8c[0] = local_8c[1];
    }
LAB_0040703e:
  } while( true );
LAB_00406acd:
  if ((int)uVar10 < 0x100) {
    puVar11 = local_5c + uVar10;
    uVar2 = *puVar11;
    local_58 = puVar11;
    uVar8 = (local_14 >> 0xb) * (uint)uVar2;
    if (local_10 < uVar8) {
      local_14 = uVar8;
      uVar10 = uVar10 * 2;
      *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
    }
    else {
      local_14 = local_14 - uVar8;
      local_10 = local_10 - uVar8;
      uVar10 = uVar10 * 2 + 1;
      *puVar11 = uVar2 - (uVar2 >> 5);
    }
    local_48 = uVar10;
    if (local_14 < 0x1000000) {
switchD_004067e9_caseD_e:
      if (local_70 == 0) {
        local_8c[0] = 0xe;
        goto LAB_004071dc;
      }
      local_14 = local_14 << 8;
      bVar1 = *local_74;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      local_10 = local_10 << 8 | (uint)bVar1;
    }
    goto LAB_00406acd;
  }
LAB_00406b31:
  local_38 = 0;
LAB_00406b35:
  local_60 = (byte)local_48;
switchD_004067e9_caseD_1a:
  if (local_68 == 0) {
    local_8c[0] = 0x1a;
LAB_004071dc:
    pSVar12 = local_8c;
    for (iVar9 = 0x22; iVar9 != 0; iVar9 = iVar9 + -1) {
      *param_1 = *pSVar12;
      pSVar12 = pSVar12 + 1;
      param_1 = param_1 + 1;
    }
    return 0;
  }
  local_64 = local_64 + 1;
  local_6c = local_6c + 1;
  local_68 = local_68 + -1;
  *pbVar5 = local_60;
  *(byte *)(local_18 + (int)local_c) = local_60;
LAB_00406d01:
  local_18 = (local_18 + 1) % local_78;
LAB_00406d04:
  local_8c[0] = 2;
  goto LAB_004067da;
}



