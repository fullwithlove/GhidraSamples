/* Function: FUN_00401000 */

LRESULT FUN_00401000(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  int iVar1;
  LONG LVar2;
  LRESULT LVar3;
  HDC hDC;
  HBRUSH hbr;
  HFONT h;
  HGDIOBJ h_00;
  int iVar4;
  tagPAINTSTRUCT local_60;
  tagRECT local_20;
  LOGBRUSH local_10;
  
  iVar1 = DAT_00424330;
  if (param_2 == 0xf) {
    hDC = BeginPaint(param_1,&local_60);
    local_10.lbStyle = 0;
    GetClientRect(param_1,&local_20);
    LVar2 = local_20.bottom;
    local_20.bottom = 0;
    for (; local_20.top < LVar2; local_20.top = local_20.top + 4) {
      iVar4 = LVar2 - local_20.top;
      local_10.lbColor =
           (uint)CONCAT11((char)((int)((uint)*(byte *)(iVar1 + 0x52) * iVar4 +
                                      (uint)*(byte *)(iVar1 + 0x56) * local_20.top) / LVar2),
                          (char)((int)((uint)*(byte *)(iVar1 + 0x51) * iVar4 +
                                      (uint)*(byte *)(iVar1 + 0x55) * local_20.top) / LVar2)) << 8 |
           (int)((uint)*(byte *)(iVar1 + 0x50) * iVar4 +
                (uint)*(byte *)(iVar1 + 0x54) * local_20.top) / LVar2 & 0xffU;
      hbr = CreateBrushIndirect(&local_10);
      local_20.bottom = local_20.bottom + 4;
      FillRect(hDC,&local_20,hbr);
      DeleteObject(hbr);
    }
    if (*(int *)(iVar1 + 0x58) != -1) {
      h = CreateFontIndirectA(*(LOGFONTA **)(iVar1 + 0x34));
      if (h != (HFONT)0x0) {
        local_20.left = 0x10;
        local_20.top = 8;
        SetBkMode(hDC,1);
        SetTextColor(hDC,*(COLORREF *)(iVar1 + 0x58));
        h_00 = SelectObject(hDC,h);
        DrawTextA(hDC,&DAT_00423b20,-1,&local_20,0x820);
        SelectObject(hDC,h_00);
        DeleteObject(h);
      }
    }
    EndPaint(param_1,&local_60);
    LVar3 = 0;
  }
  else {
    if (param_2 == 0x46) {
      *(uint *)(param_4 + 0x18) = *(uint *)(param_4 + 0x18) | 0x10;
      *(undefined4 *)(param_4 + 4) = DAT_00424328;
    }
    LVar3 = DefWindowProcA(param_1,param_2,param_3,param_4);
  }
  return LVar3;
}



/* Function: FUN_0040117d */

void FUN_0040117d(int param_1)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  
  uVar1 = *(uint *)(param_1 * 0x418 + 8 + DAT_00424348);
  if ((uVar1 & 2) != 0) {
    uVar4 = param_1 + 1;
    if (uVar4 < DAT_0042434c) {
      puVar3 = (uint *)(uVar4 * 0x418 + 8 + DAT_00424348);
      iVar5 = 0;
      do {
        uVar2 = *puVar3;
        if ((uVar2 & 2) == 0) {
          if ((uVar2 & 4) == 0) {
            iVar6 = iVar5;
            if ((uVar2 & 0x10) == 0) {
              *puVar3 = (uVar2 ^ uVar1) & 1 ^ uVar2;
            }
          }
          else {
            iVar6 = iVar5 + -1;
            if (iVar5 == 0) {
              return;
            }
          }
        }
        else {
          iVar6 = iVar5 + 1;
        }
        uVar4 = uVar4 + 1;
        puVar3 = puVar3 + 0x106;
        iVar5 = iVar6;
      } while (uVar4 < DAT_0042434c);
    }
  }
  return;
}



/* Function: FUN_004011ef */

uint FUN_004011ef(uint param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int local_c;
  int local_8;
  
  iVar2 = DAT_00424348;
  iVar5 = param_1 * 0x418 + DAT_00424348;
  local_8 = 0;
  local_c = 0;
  if (((*(uint *)(iVar5 + 8) & 2) != 0) && (param_2 != 0)) {
    param_1 = param_1 + 1;
    *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) & 0xffffffbe;
  }
  if (param_1 < DAT_0042434c) {
    do {
      puVar1 = (uint *)(param_1 * 0x418 + 8 + iVar2);
      uVar3 = param_1 + 1;
      uVar4 = *puVar1;
      if ((uVar4 & 2) != 0) {
        uVar3 = FUN_004011ef(param_1,1);
        uVar4 = *puVar1;
      }
      if ((uVar4 & 4) != 0) {
        if (local_8 == 0) {
          return uVar3;
        }
        if (local_c != 0) {
          *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) | 0x40;
          return uVar3;
        }
        *(uint *)(iVar5 + 8) = *(uint *)(iVar5 + 8) & 0xffffff7f | 1;
        return uVar3;
      }
      if ((uVar4 & 0x40) != 0) {
        local_8 = local_8 + 1;
      }
      if ((uVar4 & 1) == 0) {
        local_c = local_c + 1;
      }
      else {
        local_8 = local_8 + 1;
      }
      param_1 = uVar3;
    } while (uVar3 < DAT_0042434c);
  }
  return 0;
}



/* Function: FUN_00401299 */

void FUN_00401299(uint param_1)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  
  uVar3 = 0;
  if ((param_1 < 0x20) && (DAT_0042434c != 0)) {
    puVar2 = (uint *)(DAT_00424348 + 8);
    do {
      uVar1 = *puVar2;
      if ((uVar1 & 6) == 0) {
        if ((puVar2[-1] & 1 << ((byte)param_1 & 0x1f)) == 0) {
          uVar1 = uVar1 & 0xfffffffe;
        }
        else {
          uVar1 = uVar1 | 1;
        }
        *puVar2 = uVar1;
      }
      uVar3 = uVar3 + 1;
      puVar2 = puVar2 + 0x106;
    } while (uVar3 < DAT_0042434c);
  }
  return;
}



/* Function: FUN_004012e2 */

uint FUN_004012e2(int param_1)

{
  uint uVar1;
  uint *puVar2;
  bool bVar3;
  int *local_c;
  uint local_8;
  
  local_8 = 0;
  local_c = (int *)(DAT_00424330 + 0x94);
  do {
    uVar1 = 0;
    if (*local_c != 0) {
      bVar3 = DAT_0042434c == 0;
      if (DAT_0042434c != 0) {
        puVar2 = (uint *)(DAT_00424348 + 8);
        do {
          if (((*puVar2 & 6) == 0) &&
             (((param_1 == 0 || (*(int *)(param_1 + uVar1 * 4) != 0)) &&
              ((puVar2[-1] & 1 << ((byte)local_8 & 0x1f)) != (*puVar2 & 1) << ((byte)local_8 & 0x1f)
              )))) break;
          uVar1 = uVar1 + 1;
          puVar2 = puVar2 + 0x106;
        } while (uVar1 < DAT_0042434c);
        bVar3 = uVar1 == DAT_0042434c;
      }
      if (bVar3) {
        return local_8;
      }
    }
    local_8 = local_8 + 1;
    local_c = local_c + 1;
    if (0x1f < local_8) {
      return local_8;
    }
  } while( true );
}



/* Function: FUN_0040136d */

void FUN_0040136d(int param_1)

{
  if (param_1 < 0) {
    FUN_00406209(&DAT_00425000 + (param_1 + 1) * -0x400);
  }
  return;
}



/* Function: FUN_00401389 */

undefined4 FUN_00401389(int param_1,HWND param_2)

{
  HWND pHVar1;
  int iVar2;
  int iVar3;
  WPARAM wParam;
  LPARAM lParam;
  
  while ((-1 < param_1 && (pHVar1 = (HWND)(param_1 * 0x1c + DAT_00424350), pHVar1->unused != 1))) {
    pHVar1 = FUN_00401434(pHVar1);
    if (pHVar1 == (HWND)0x7fffffff) {
      return 0x7fffffff;
    }
    iVar2 = FUN_0040136d((int)pHVar1);
    if (iVar2 == 0) {
      iVar3 = 1;
      iVar2 = param_1 + 1;
    }
    else {
      iVar2 = iVar2 + -1;
      iVar3 = iVar2 - param_1;
    }
    param_1 = iVar2;
    if (param_2 != (HWND)0x0) {
      DAT_00423b0c = DAT_00423b0c + iVar3;
      lParam = 0;
      wParam = MulDiv(DAT_00423b0c,30000,DAT_00423af4);
      SendMessageA(param_2,0x402,wParam,lParam);
    }
  }
  return 0;
}



/* Function: FUN_0040140b */

void FUN_0040140b(int param_1)

{
  FUN_00401389(*(int *)(DAT_00424330 + 0x6c + param_1 * 4),(HWND)0x0);
  return;
}



/* Function: FUN_00401423 */

void FUN_00401423(int param_1)

{
  FUN_004053d6(param_1,&DAT_0040a800);
  return;
}



/* Function: FUN_00401434 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

HWND FUN_00401434(HWND param_1)

{
  char cVar1;
  undefined4 uVar2;
  char *pcVar3;
  uint uVar4;
  LRESULT LVar5;
  HGDIOBJ ho;
  HDC hdc;
  HMODULE hModule;
  undefined *puVar6;
  byte *lpFileName;
  byte *pbVar7;
  HKEY pHVar8;
  LSTATUS LVar9;
  LPSTR pCVar10;
  BOOL BVar11;
  HANDLE pvVar12;
  HGLOBAL hMem;
  int *piVar13;
  HWND pHVar14;
  FARPROC pFVar15;
  HRESULT HVar16;
  byte bVar17;
  int iVar18;
  undefined4 extraout_EDX;
  byte *pbVar19;
  HWND pHVar20;
  CHAR *pCVar21;
  undefined4 *puVar22;
  HWND pHVar23;
  byte *pbVar24;
  DWORD DVar25;
  bool bVar26;
  undefined8 uVar27;
  undefined8 uVar28;
  LONG lDistanceToMove;
  PLONG lpDistanceToMoveHigh;
  LPCSTR pCVar29;
  int iVar30;
  uint uVar31;
  _WIN32_FIND_DATAA local_1d4;
  uint local_94;
  int local_90;
  byte *local_8c;
  tagRECT local_88;
  FARPROC local_78;
  undefined1 local_74 [32];
  HINSTANCE local_54;
  byte *local_50;
  byte *local_4c;
  undefined1 local_48 [12];
  undefined4 local_3c;
  byte *local_38;
  FARPROC local_34;
  byte local_2d;
  int local_2c;
  HWND local_28 [2];
  HWND local_20;
  FILETIME local_1c;
  HWND local_14;
  HWND local_10;
  HWND local_c;
  HWND local_8;
  
  pHVar14 = DAT_0040b840;
  local_c = DAT_00424328;
  pbVar19 = (byte *)0x0;
  pHVar20 = param_1;
  piVar13 = &local_2c;
  for (iVar18 = 7; iVar18 != 0; iVar18 = iVar18 + -1) {
    *piVar13 = pHVar20->unused;
    pHVar20 = pHVar20 + 1;
    piVar13 = piVar13 + 1;
  }
  iVar18 = (int)local_28[0] * 0x400;
  local_8 = (HWND)0x0;
  pHVar20 = (HWND)(&DAT_00425000 + iVar18);
  pHVar23 = (HWND)(&DAT_00425000 + (int)local_28[1] * 0x400);
  DAT_0040b83c = local_28;
  switch(local_2c) {
  case 2:
    goto switchD_00401489_caseD_2;
  case 3:
    pCVar29 = (LPCSTR)0x0;
LAB_00401492:
    FUN_004053d6((int)local_28[0],pCVar29);
    return (HWND)0x7fffffff;
  case 4:
    DAT_00423aec = DAT_00423aec + 1;
    if (local_c == (HWND)0x0) {
      return (HWND)0x7fffffff;
    }
    PostQuitMessage(0);
    return (HWND)0x7fffffff;
  case 5:
    iVar18 = FUN_0040136d((int)local_28[0]);
    pHVar14 = (HWND)FUN_00401389(iVar18 + -1,(HWND)0x0);
    return pHVar14;
  case 6:
    FUN_004053d6((int)local_28[0],(LPCSTR)0x0);
    break;
  case 7:
    uVar28 = FUN_00402c43(0);
    DVar25 = (DWORD)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    if ((int)DVar25 < 2) {
      DVar25 = 1;
    }
    Sleep(DVar25);
    break;
  case 8:
    SetForegroundWindow(local_c);
    break;
  case 9:
    if (DAT_00423af0 != (HWND)0x0) {
      ShowWindow(DAT_00423af0,(int)local_28[1]);
    }
    if (DAT_00423b04 != (HWND)0x0) {
      ShowWindow(DAT_00423b04,(int)local_28[0]);
    }
    break;
  case 10:
    pbVar19 = FUN_00402c65(0xfffffff0);
    pCVar10 = (LPSTR)SetFileAttributesA((LPCSTR)pbVar19,(DWORD)local_28[1]);
    goto LAB_004015d3;
  case 0xb:
    pbVar19 = FUN_00402c65(0xfffffff0);
    pcVar3 = FUN_00405cbd((LPCSTR)pbVar19);
    if (pcVar3 != (char *)0x0) {
      do {
        pcVar3 = (char *)FUN_00405c4f(pcVar3,'\\');
        cVar1 = *pcVar3;
        *pcVar3 = '\0';
        param_1 = (HWND)CONCAT13(cVar1,param_1._0_3_);
        if (((cVar1 == '\0') && (local_20 != (HWND)0x0)) && (iVar18 = FUN_00405913(), iVar18 != 0))
        {
          DVar25 = FUN_0040589c((LPCSTR)pbVar19);
          if (DVar25 != 0) {
            local_8 = (HWND)((int)&local_8->unused + 1);
            goto LAB_0040162d;
          }
        }
        else {
          DVar25 = FUN_004058f6((LPCSTR)pbVar19);
LAB_0040162d:
          if ((DVar25 != 0) &&
             ((DVar25 != 0xb7 ||
              (DVar25 = GetFileAttributesA((LPCSTR)pbVar19), (DVar25 & 0x10) == 0)))) {
            local_8 = (HWND)((int)&local_8->unused + 1);
          }
        }
        *pcVar3 = param_1._3_1_;
        pcVar3 = pcVar3 + 1;
      } while (param_1._3_1_ != '\0');
    }
    if (local_28[1] == (HWND)0x0) {
      iVar18 = -0xb;
      goto LAB_00402311;
    }
    FUN_00401423(-0x1a);
    FUN_00406292(&DAT_0042a800,(LPCSTR)pbVar19);
    BVar11 = SetCurrentDirectoryA((LPCSTR)pbVar19);
    if (BVar11 == 0) {
      local_8 = (HWND)((int)&local_8->unused + 1);
    }
    break;
  case 0xc:
    pbVar19 = FUN_00402c65(0);
    puVar6 = FUN_00406625((LPCSTR)pbVar19);
    local_1c.dwLowDateTime = (DWORD)local_28[1];
    goto joined_r0x00401a38;
  case 0xd:
    if ((int)local_20 < 1) {
      if ((int)local_20 < 0) {
        DAT_0040b844 = (&DAT_004243a0)[(int)local_28[0]];
      }
      else {
        *(undefined4 *)(&DAT_00424400 + (int)local_28[0] * 4) = (&DAT_004243a0)[(int)local_28[0]];
      }
      uVar2 = FUN_00402c43(1);
      (&DAT_004243a0)[(int)local_28[0]] = uVar2;
    }
    else {
      (&DAT_004243a0)[(int)local_28[0]] = *(undefined4 *)(&DAT_00424400 + (int)local_28[0] * 4);
      if ((int)local_1c.dwLowDateTime < 0) {
        (&DAT_004243a0)[(int)local_28[0]] = DAT_0040b844;
      }
    }
    break;
  case 0xe:
    uVar31 = (&DAT_004243a0)[(int)local_20];
    pHVar14 = local_28[uVar31 == 0];
    (&DAT_004243a0)[(int)local_20] = uVar31 & local_1c.dwLowDateTime;
    return pHVar14;
  case 0xf:
    pHVar14 = (HWND)(&DAT_004243a0)[(int)local_28[1]];
    goto switchD_00401af3_default;
  case 0x10:
    pbVar19 = FUN_00402c65(0xffffffd0);
    pbVar7 = FUN_00402c65(0xffffffdf);
    FUN_00402c65(0x13);
    BVar11 = MoveFileA((LPCSTR)pbVar19,(LPCSTR)pbVar7);
    if (BVar11 == 0) {
      if ((local_20 == (HWND)0x0) ||
         (puVar6 = FUN_00406625((LPCSTR)pbVar19), puVar6 == (undefined *)0x0)) goto LAB_004027f4;
      FUN_0040606b((LPCSTR)pbVar19,(LPCSTR)pbVar7);
      iVar18 = -0x1c;
    }
    else {
      iVar18 = -0x1d;
    }
    goto LAB_00402311;
  case 0x11:
    pHVar14 = (HWND)FUN_00402c65(0);
    DVar25 = GetFullPathNameA((LPCSTR)pHVar14,0x400,(LPSTR)pHVar23,(LPSTR *)&param_1);
    if (DVar25 == 0) {
LAB_00401727:
      local_8 = (HWND)0x1;
      *(undefined1 *)&pHVar23->unused = 0;
    }
    else if ((pHVar14 < param_1) && ((char)param_1->unused != '\0')) {
      puVar6 = FUN_00406625((LPCSTR)pHVar14);
      if (puVar6 == (undefined *)0x0) goto LAB_00401727;
      FUN_00406292((LPSTR)param_1,puVar6 + 0x2c);
    }
    if (local_20 == (HWND)0x0) {
      GetShortPathNameA((LPCSTR)pHVar23,(LPSTR)pHVar23,0x400);
    }
    break;
  case 0x12:
    pbVar19 = FUN_00402c65(0xffffffff);
    DVar25 = SearchPathA((LPCSTR)0x0,(LPCSTR)pbVar19,(LPCSTR)0x0,0x400,(LPSTR)pHVar20,
                         (LPSTR *)&param_1);
    bVar26 = DVar25 == 0;
    goto LAB_00401767;
  case 0x13:
    pbVar19 = FUN_00402c65(0xffffffef);
    pCVar10 = FUN_00405e54((LPSTR)pHVar20,(LPCSTR)pbVar19);
    goto LAB_004015d3;
  case 0x14:
    pHVar14 = (HWND)FUN_00402c65(0x31);
    param_1 = (HWND)((uint)local_28[0] & 7);
    local_c = pHVar14;
    iVar18 = FUN_00405c91((byte *)pHVar14);
    if (iVar18 == 0) {
      pCVar29 = (LPCSTR)FUN_00406292(&DAT_0040a400,&DAT_0042a800);
      pCVar29 = FUN_00405c24(pCVar29);
      lstrcatA(pCVar29,(LPCSTR)pHVar14);
    }
    else {
      FUN_00406292(&DAT_0040a400,(LPCSTR)pHVar14);
    }
    FUN_0040658c(&DAT_0040a400);
    do {
      if (2 < (int)param_1) {
        puVar6 = FUN_00406625(&DAT_0040a400);
        uVar31 = 0;
        if (puVar6 != (undefined *)0x0) {
          uVar31 = CompareFileTime((FILETIME *)(puVar6 + 0x14),&local_1c);
        }
        param_1 = (HWND)(uint)((((uint)((int)&param_1[-1].unused + 1U) | 0x80000000) & uVar31) == 0)
        ;
      }
      if (param_1 == (HWND)0x0) {
        FUN_00405e00(&DAT_0040a400);
      }
      local_10 = (HWND)FUN_00405e25(&DAT_0040a400,0x40000000,(param_1 != (HWND)0x1) + 1);
      if (local_10 != (HWND)0xffffffff) {
        FUN_004053d6(-0x16,(LPCSTR)local_c);
        DAT_004243d4 = DAT_004243d4 + 1;
        DVar25 = FUN_004031a3((int)local_20,local_10,(undefined *)0x0,0);
        DAT_004243d4 = DAT_004243d4 + -1;
        if (((HWND)local_1c.dwLowDateTime != (HWND)0xffffffff) ||
           ((HWND)local_1c.dwHighDateTime != (HWND)0xffffffff)) {
          SetFileTime(local_10,&local_1c,(FILETIME *)0x0,&local_1c);
        }
        CloseHandle(local_10);
        if (-1 < (int)DVar25) goto switchD_00401489_caseD_42;
        if (DVar25 == 0xfffffffe) {
          FUN_00406325(&DAT_0040a400,-0x17);
          lstrcatA(&DAT_0040a400,(LPCSTR)local_c);
        }
        else {
          FUN_00406325(&DAT_0040a400,-0x12);
        }
        uVar31 = 0x200010;
        puVar6 = &DAT_0040a400;
        goto LAB_004023b6;
      }
      if (param_1 != (HWND)0x0) {
        FUN_004053d6(-0x1e,(LPCSTR)local_c);
        bVar26 = param_1 == (HWND)0x2;
        goto LAB_004015d5;
      }
      FUN_00406292(&DAT_0040ac00,&DAT_00425000);
      FUN_00406292(&DAT_00425000,&DAT_0040a400);
      FUN_00406325(&DAT_0040a800,(int)local_14);
      FUN_00406292(&DAT_00425000,&DAT_0040ac00);
      iVar18 = FUN_004059a8(&DAT_0040a800,(int)local_28[0] >> 3);
    } while (iVar18 == 4);
    if (iVar18 != 5) {
      pCVar29 = &DAT_0040a400;
      local_28[0] = (HWND)0xfffffffa;
      goto LAB_00401492;
    }
    _DAT_004243a8 = _DAT_004243a8 + 1;
    goto LAB_00402afa;
  case 0x15:
    uVar31 = 0;
    goto LAB_00401960;
  case 0x16:
    pbVar19 = FUN_00402c65(0x31);
    pHVar14 = (HWND)FUN_004059a8(pbVar19,(uint)local_28[0]);
    if (pHVar14 == (HWND)0x0) goto LAB_004027f4;
    if (pHVar14 == local_20) {
      return (HWND)local_1c.dwLowDateTime;
    }
    if (pHVar14 == (HWND)local_1c.dwHighDateTime) {
      return local_14;
    }
    break;
  case 0x17:
    uVar31 = 0xfffffff0;
LAB_00401960:
    pbVar19 = FUN_00402c65(uVar31);
    FUN_00405a54((LPCSTR)pbVar19,(uint)local_28[1]);
    break;
  case 0x18:
    pbVar19 = FUN_00402c65(1);
    pHVar14 = (HWND)lstrlenA((LPCSTR)pbVar19);
    goto switchD_00401af3_default;
  case 0x19:
    uVar28 = FUN_00402c43(2);
    local_48._8_2_ = (undefined2)uVar28;
    local_48._10_2_ = (undefined2)((ulonglong)uVar28 >> 0x10);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    local_88._8_8_ = FUN_00402c43(3);
    pHVar14 = local_88.right;
    param_1 = (HWND)CONCAT22(local_48._10_2_,local_48._8_2_);
    local_34 = (FARPROC)FUN_00402c65(1);
    pHVar23 = (HWND)lstrlenA((LPCSTR)local_34);
    *(undefined1 *)&pHVar20->unused = 0;
    if (CONCAT22(local_3c._2_2_,(undefined2)local_3c) == 0) {
      param_1 = pHVar23;
    }
    if ((param_1 != (HWND)0x0) &&
       ((-1 < local_88.right ||
        (pHVar14 = (HWND)(local_88.right + (int)&pHVar23->unused), -1 < (int)pHVar14)))) {
      if ((int)pHVar23 < (int)pHVar14) {
        pHVar14 = pHVar23;
      }
      FUN_00406292((LPSTR)pHVar20,(LPCSTR)(local_34 + (int)pHVar14));
      if ((int)param_1 < 0) {
        iVar18 = lstrlenA((LPCSTR)pHVar20);
        param_1 = (HWND)((int)&param_1->unused + iVar18);
        if ((int)param_1 < 0) {
          param_1 = (HWND)0x0;
        }
      }
      if ((int)param_1 < 0x400) {
        *(undefined1 *)((int)&pHVar20->unused + (int)&param_1->unused) = 0;
      }
    }
    break;
  case 0x1a:
    pbVar19 = FUN_00402c65(0x20);
    pbVar7 = FUN_00402c65(0x31);
    if ((HWND)local_1c.dwHighDateTime == (HWND)0x0) {
      puVar6 = (undefined *)lstrcmpiA((LPCSTR)pbVar19,(LPCSTR)pbVar7);
    }
    else {
      puVar6 = (undefined *)lstrcmpA((LPCSTR)pbVar19,(LPCSTR)pbVar7);
    }
    goto joined_r0x00401a38;
  case 0x1b:
    param_1 = (HWND)FUN_00402c65(1);
    DVar25 = ExpandEnvironmentStringsA((LPCSTR)param_1,(LPSTR)pHVar20,0x400);
    if ((DVar25 == 0) ||
       ((local_20 != (HWND)0x0 && (iVar30 = lstrcmpA((LPCSTR)param_1,(LPCSTR)pHVar20), iVar30 == 0))
       )) {
      local_8 = (HWND)0x1;
      *(undefined1 *)&pHVar20->unused = 0;
    }
    (&DAT_004253ff)[iVar18] = 0;
    break;
  case 0x1c:
    uVar28 = FUN_00402c43(0);
    uVar31 = (uint)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    uVar4 = FUN_00402c43(1);
    if (local_14 != (HWND)0x0) {
      if (uVar31 < uVar4) {
        return (HWND)local_1c.dwLowDateTime;
      }
      if (uVar31 <= uVar4) {
        return local_20;
      }
      return (HWND)local_1c.dwHighDateTime;
    }
    if ((int)uVar31 < (int)uVar4) {
      return (HWND)local_1c.dwLowDateTime;
    }
    if ((int)uVar31 <= (int)uVar4) {
      return local_20;
    }
    return (HWND)local_1c.dwHighDateTime;
  case 0x1d:
    uVar28 = FUN_00402c43(1);
    pHVar23 = (HWND)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    param_1 = pHVar23;
    uVar28 = FUN_00402c43(2);
    uVar31 = (uint)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    bVar17 = (byte)uVar28;
    pHVar14 = param_1;
    switch(local_1c.dwLowDateTime) {
    case 0:
      pHVar14 = (HWND)((int)&pHVar23->unused + uVar31);
      break;
    case 1:
      pHVar14 = (HWND)((int)pHVar23 - uVar31);
      break;
    case 2:
      pHVar14 = (HWND)(uVar31 * (int)pHVar23);
      break;
    case 3:
      if (uVar31 == 0) {
LAB_00401b64:
        local_8 = (HWND)0x1;
        pHVar14 = (HWND)0x0;
      }
      else {
        pHVar14 = (HWND)((int)pHVar23 / (int)uVar31);
      }
      break;
    case 4:
      pHVar14 = (HWND)(uVar31 | (uint)pHVar23);
      break;
    case 5:
      pHVar14 = (HWND)(uVar31 & (uint)pHVar23);
      break;
    case 6:
      pHVar14 = (HWND)(uVar31 ^ (uint)pHVar23);
      break;
    case 7:
      pHVar14 = (HWND)(uint)(pHVar23 == (HWND)0x0);
      break;
    case 8:
      if (pHVar23 == (HWND)0x0) {
LAB_00401b48:
        if (uVar31 == 0) goto LAB_00401b3d;
      }
      pHVar14 = (HWND)0x1;
      break;
    case 9:
      if (pHVar23 != (HWND)0x0) goto LAB_00401b48;
LAB_00401b3d:
      pHVar14 = (HWND)0x0;
      break;
    case 10:
      if (uVar31 == 0) goto LAB_00401b64;
      pHVar14 = (HWND)((int)pHVar23 % (int)uVar31);
      break;
    case 0xb:
      pHVar14 = (HWND)((int)pHVar23 << (bVar17 & 0x1f));
      break;
    case 0xc:
      pHVar14 = (HWND)((int)pHVar23 >> (bVar17 & 0x1f));
      break;
    case 0xd:
      pHVar14 = (HWND)((uint)pHVar23 >> (bVar17 & 0x1f));
    }
    goto switchD_00401af3_default;
  case 0x1e:
    pbVar19 = FUN_00402c65(1);
    uVar28 = FUN_00402c43(2);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    wsprintfA((LPSTR)pHVar20,(LPCSTR)pbVar19,(int)uVar28);
    break;
  case 0x1f:
    if (local_20 == (HWND)0x0) {
      if (local_28[1] != (HWND)0x0) {
        if (DAT_0040b840 != (HWND)0x0) {
          FUN_00406292((LPSTR)pHVar20,(LPCSTR)(DAT_0040b840 + 1));
          DAT_0040b840 = (HWND)pHVar14->unused;
          goto LAB_00401c22;
        }
        goto LAB_004027f4;
      }
      pHVar14 = (HWND)GlobalAlloc(0x40,0x404);
      FUN_00406325((byte *)(pHVar14 + 1),(int)local_28[0]);
      pHVar14->unused = (int)DAT_0040b840;
      DAT_0040b840 = pHVar14;
    }
    else {
      do {
        local_20 = (HWND)((int)&local_20[-1].unused + 3);
        if (pHVar14 == (HWND)0x0) goto LAB_004023a8;
        pHVar14 = (HWND)pHVar14->unused;
      } while (local_20 != (HWND)0x0);
      if (pHVar14 == (HWND)0x0) goto LAB_004023a8;
      FUN_00406292(&DAT_0040a400,(LPCSTR)(pHVar14 + 1));
      FUN_00406292((LPSTR)(pHVar14 + 1),(LPCSTR)(DAT_0040b840 + 1));
      pCVar21 = &DAT_0040a400;
      pHVar20 = DAT_0040b840 + 1;
LAB_0040295d:
      FUN_00406292((LPSTR)pHVar20,pCVar21);
    }
    break;
  case 0x20:
  case 0x21:
    uVar28 = FUN_00402c43(3);
    local_c = (HWND)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    uVar28 = FUN_00402c43(4);
    param_1 = (HWND)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    if (((uint)local_14 & 1) != 0) {
      local_c = (HWND)FUN_00402c65(0x33);
    }
    if (((uint)local_14 & 2) != 0) {
      param_1 = (HWND)FUN_00402c65(0x44);
    }
    if (local_2c == 0x21) {
      uVar28 = FUN_00402c43(1);
      local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
      local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
      uVar27 = FUN_00402c43(2);
      local_3c._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
      local_3c._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
      if ((int)local_14 >> 2 == 0) {
        pHVar14 = (HWND)SendMessageA((HWND)uVar28,(UINT)uVar27,(WPARAM)local_c,(LPARAM)param_1);
        local_10 = pHVar14;
        local_28[1] = local_28[0];
      }
      else {
        LVar5 = SendMessageTimeoutA((HWND)uVar28,(UINT)uVar27,(WPARAM)local_c,(LPARAM)param_1,0,
                                    (int)local_14 >> 2,(PDWORD_PTR)&local_10);
        local_8 = (HWND)(uint)(LVar5 == 0);
        pHVar14 = local_10;
        local_28[1] = local_28[0];
      }
    }
    else {
      pbVar19 = FUN_00402c65(1);
      pbVar7 = FUN_00402c65(0x12);
      pHVar14 = FindWindowExA(local_c,param_1,(LPCSTR)(-(uint)(*pbVar19 != 0) & (uint)pbVar19),
                              (LPCSTR)(-(uint)(*pbVar7 != 0) & (uint)pbVar7));
      local_10 = pHVar14;
      local_28[1] = local_28[0];
    }
    goto joined_r0x00402786;
  case 0x22:
    uVar28 = FUN_00402c43(0);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    puVar6 = (undefined *)IsWindow((HWND)uVar28);
    local_1c.dwLowDateTime = (DWORD)local_28[1];
joined_r0x00401a38:
    if (puVar6 == (undefined *)0x0) {
      return local_20;
    }
    return (HWND)local_1c.dwLowDateTime;
  case 0x23:
    uVar28 = FUN_00402c43(2);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    uVar27 = FUN_00402c43(1);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    pHVar14 = GetDlgItem((HWND)uVar27,(int)uVar28);
    goto switchD_00401af3_default;
  case 0x24:
    iVar18 = (int)&local_28[1]->unused + DAT_00424368;
    uVar28 = FUN_00402c43(0);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    SetWindowLongA((HWND)uVar28,-0x15,iVar18);
    break;
  case 0x25:
    if ((local_1c.dwLowDateTime & 0x100) == 0) {
      param_1 = GetDlgItem(local_c,(int)local_20);
    }
    else {
      uVar28 = FUN_00402c43(2);
      param_1 = (HWND)uVar28;
      local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
      local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    }
    local_10 = (HWND)(local_1c.dwLowDateTime & 3);
    uVar31 = local_1c.dwLowDateTime & 4;
    local_38 = (byte *)(local_1c.dwLowDateTime >> 0x1f);
    local_34 = (FARPROC)(local_1c.dwLowDateTime >> 0x1e & 1);
    if ((local_1c.dwLowDateTime & 0x10000) == 0) {
      local_c = (HWND)((uint)local_28[1] & 0xffff);
    }
    else {
      local_c = (HWND)FUN_00402c65(0x11);
    }
    GetClientRect(param_1,&local_88);
    pHVar14 = (HWND)LoadImageA((HINSTANCE)(-(uint)(uVar31 != 0) & DAT_00424320),(LPCSTR)local_c,
                               (UINT)local_10,local_88.right * (int)local_38,
                               local_88.bottom * (int)local_34,local_1c.dwLowDateTime & 0xfef0);
    ho = (HGDIOBJ)SendMessageA(param_1,0x172,(WPARAM)local_10,(LPARAM)pHVar14);
    local_28[1] = local_28[0];
    if ((ho != (HGDIOBJ)0x0) && (local_10 == (HWND)0x0)) {
      DeleteObject(ho);
      local_28[1] = local_28[0];
    }
joined_r0x00402786:
    if (-1 < (int)local_28[1]) goto switchD_00401af3_default;
    break;
  case 0x26:
    hdc = GetDC(local_c);
    uVar28 = FUN_00402c43(2);
    iVar30 = 0x48;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    iVar18 = GetDeviceCaps(hdc,0x5a);
    _DAT_0040b800 = MulDiv((int)uVar28,iVar18,iVar30);
    _DAT_0040b800 = -_DAT_0040b800;
    ReleaseDC(local_c,hdc);
    uVar28 = FUN_00402c43(3);
    _DAT_0040b810 = (undefined4)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    DAT_0040b814 = (byte)local_1c.dwHighDateTime & 1;
    DAT_0040b817 = 1;
    DAT_0040b815 = (byte)local_1c.dwHighDateTime & 2;
    DAT_0040b816 = (byte)local_1c.dwHighDateTime & 4;
    FUN_00406325(&DAT_0040b81c,(int)local_28[1]);
    pHVar14 = (HWND)CreateFontIndirectA((LOGFONTA *)&DAT_0040b800);
    goto switchD_00401af3_default;
  case 0x27:
    uVar28 = FUN_00402c43(0);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    uVar27 = FUN_00402c43(1);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar27 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar27 >> 0x30);
    if ((HWND)local_1c.dwLowDateTime == (HWND)0x0) {
      ShowWindow((HWND)uVar28,(int)uVar27);
    }
    else {
      EnableWindow((HWND)uVar28,(int)uVar27);
    }
    break;
  case 0x28:
    pbVar19 = FUN_00402c65(0);
    pbVar7 = FUN_00402c65(0x31);
    pbVar24 = FUN_00402c65(0x22);
    FUN_00402c65(0x15);
    FUN_00401423(-0x14);
    local_74._4_4_ = local_1c.dwHighDateTime;
    local_74._8_4_ = local_c;
    local_74._28_4_ = local_1c.dwLowDateTime;
    local_74._12_4_ = -(uint)(*pbVar19 != 0) & (uint)pbVar19;
    local_74._24_4_ = &DAT_0042a800;
    local_74._20_4_ = -(uint)(*pbVar24 != 0) & (uint)pbVar24;
    local_74._16_4_ = pbVar7;
    iVar18 = FUN_0040596e((SHELLEXECUTEINFOA *)local_74);
    if (iVar18 == 0) goto LAB_004027f4;
    if ((local_74._4_4_ & 0x40) != 0) {
      FUN_0040672f((HANDLE)CONCAT22(local_3c._2_2_,(undefined2)local_3c));
      pvVar12 = (HANDLE)CONCAT22(local_3c._2_2_,(undefined2)local_3c);
      goto LAB_00401fec;
    }
    break;
  case 0x29:
    pbVar19 = FUN_00402c65(0);
    FUN_004053d6(-0x15,(LPCSTR)pbVar19);
    pvVar12 = FUN_0040592b((LPSTR)pbVar19);
    if (pvVar12 == (HANDLE)0x0) goto LAB_004027f4;
    if (local_20 != (HWND)0x0) {
      DVar25 = FUN_0040672f(pvVar12);
      if ((int)local_28[1] < 0) {
        if (DVar25 != 0) {
          local_8 = (HWND)0x1;
        }
      }
      else {
        FUN_004061f0((LPSTR)pHVar23,DVar25);
      }
    }
LAB_00401fec:
    CloseHandle(pvVar12);
    break;
  case 0x2a:
    pbVar19 = FUN_00402c65(2);
    pHVar14 = (HWND)FUN_00406625((LPCSTR)pbVar19);
    if (pHVar14 != (HWND)0x0) {
      param_1 = pHVar14;
      FUN_004061f0((LPSTR)pHVar23,pHVar14[5].unused);
      pHVar14 = (HWND)pHVar14[6].unused;
      goto switchD_00401af3_default;
    }
    *(undefined1 *)&pHVar20->unused = 0;
    *(undefined1 *)&pHVar23->unused = 0;
    goto LAB_004027f4;
  case 0x2b:
    pbVar19 = FUN_00402c65(0xffffffee);
    puVar22 = &local_3c;
    local_38 = pbVar19;
    pFVar15 = FUN_004066ba(0xb);
    local_10 = (HWND)(*pFVar15)(pbVar19,puVar22);
    *(undefined1 *)&pHVar20->unused = 0;
    *(undefined1 *)&pHVar23->unused = 0;
    local_8 = (HWND)0x1;
    if ((local_10 != (HWND)0x0) &&
       (param_1 = (HWND)GlobalAlloc(0x40,(SIZE_T)local_10), param_1 != (HWND)0x0)) {
      local_34 = FUN_004066ba(0xc);
      local_78 = FUN_004066ba(0xd);
      iVar18 = (*local_34)(local_38,0,local_10,param_1);
      pHVar14 = param_1;
      if ((iVar18 != 0) &&
         (iVar18 = (*local_78)(param_1,&DAT_0040a014,&local_c,&local_88.bottom), pHVar14 = param_1,
         iVar18 != 0)) {
        FUN_004061f0((LPSTR)pHVar20,local_c[(int)((int)(int *)local_1c.dwLowDateTime + 2)].unused);
        FUN_004061f0((LPSTR)pHVar23,local_c[(int)((int)(int *)local_1c.dwLowDateTime + 3)].unused);
        local_8 = (HWND)0x0;
        pHVar14 = param_1;
      }
LAB_00401c22:
      GlobalFree(pHVar14);
    }
    break;
  case 0x2c:
    local_8 = (HWND)0x1;
    if (DAT_004243e0 < 0) {
      iVar18 = -0x19;
    }
    else {
      pbVar19 = FUN_00402c65(0xfffffff0);
      param_1 = (HWND)FUN_00402c65(1);
      if ((((HWND)local_1c.dwHighDateTime != (HWND)0x0) &&
          (hModule = GetModuleHandleA((LPCSTR)pbVar19), hModule != (HMODULE)0x0)) ||
         (hModule = LoadLibraryExA((LPCSTR)pbVar19,(HANDLE)0x0,8), hModule != (HMODULE)0x0)) {
        pFVar15 = GetProcAddress(hModule,(LPCSTR)param_1);
        if (pFVar15 == (FARPROC)0x0) {
          FUN_004053d6(-9,(LPCSTR)param_1);
        }
        else {
          local_8 = (HWND)0x0;
          if (local_20 == (HWND)0x0) {
            (*pFVar15)(local_c,0x400,&DAT_00425000,&DAT_0040b840,&PTR_DAT_0040a000);
          }
          else {
            FUN_00401423((int)local_20);
            iVar18 = (*pFVar15)();
            if (iVar18 != 0) {
              local_8 = (HWND)0x1;
            }
          }
        }
        if (((HWND)local_1c.dwLowDateTime == (HWND)0x0) &&
           (iVar18 = FUN_00403a3b((int)hModule), iVar18 != 0)) {
          FreeLibrary(hModule);
        }
        break;
      }
      iVar18 = -10;
    }
    goto LAB_00402311;
  case 0x2d:
    pbVar19 = FUN_00402c65(0xfffffff0);
    local_3c._0_2_ = SUB42(pbVar19,0);
    local_3c._2_2_ = (undefined2)((uint)pbVar19 >> 0x10);
    local_10 = (HWND)FUN_00402c65(0xffffffdf);
    local_8c = FUN_00402c65(2);
    local_38 = FUN_00402c65(0xffffffcd);
    local_88.bottom = (LONG)FUN_00402c65(0x45);
    local_94 = local_1c.dwHighDateTime & 0xfff;
    local_78 = (FARPROC)((int)local_1c.dwHighDateTime >> 0x10 & 0xffff);
    uVar31 = (int)local_1c.dwHighDateTime >> 0xc & 7;
    iVar18 = FUN_00405c91((byte *)local_10);
    if (iVar18 == 0) {
      FUN_00402c65(0x21);
    }
    HVar16 = CoCreateInstance((IID *)&DAT_00408410,(LPUNKNOWN)0x0,1,(IID *)&DAT_00408400,&param_1);
    if (-1 < HVar16) {
      local_c = (HWND)(**(code **)param_1->unused)(param_1,&DAT_00408420,&local_34);
      if (-1 < (int)local_c) {
        local_c = (HWND)(**(code **)(param_1->unused + 0x50))(param_1,local_10);
        if ((local_1c.dwHighDateTime & 0x8000) == 0) {
          (**(code **)(param_1->unused + 0x24))(param_1,&DAT_0042a800);
        }
        if (uVar31 != 0) {
          (**(code **)(param_1->unused + 0x3c))(param_1,uVar31);
        }
        (**(code **)(param_1->unused + 0x34))(param_1,local_78);
        if (*local_38 != 0) {
          (**(code **)(param_1->unused + 0x44))(param_1,local_38,local_94);
        }
        (**(code **)(param_1->unused + 0x2c))(param_1,local_8c);
        (**(code **)(param_1->unused + 0x1c))(param_1,local_88.bottom);
        if (-1 < (int)local_c) {
          local_c = (HWND)0x80004005;
          iVar18 = MultiByteToWideChar(0,0,(LPCSTR)CONCAT22(local_3c._2_2_,(undefined2)local_3c),-1,
                                       (LPWSTR)local_10,0x400);
          if (iVar18 != 0) {
            local_c = (HWND)(**(code **)(*(int *)local_34 + 0x18))(local_34,local_10,1);
          }
        }
        (**(code **)(*(int *)local_34 + 8))(local_34);
      }
      (**(code **)(param_1->unused + 8))(param_1);
      if (-1 < (int)local_c) {
        iVar18 = -0xc;
        goto LAB_00402311;
      }
    }
    local_8 = (HWND)0x1;
    iVar18 = -0x10;
    goto LAB_00402311;
  case 0x2e:
    pbVar19 = FUN_00402c65(0);
    pbVar7 = FUN_00402c65(0x11);
    param_1 = (HWND)FUN_00402c65(0x23);
    puVar6 = FUN_00406625((LPCSTR)pbVar19);
    if (puVar6 != (undefined *)0x0) {
      local_74._28_4_ = local_c;
      local_54 = (HINSTANCE)0x2;
      iVar18 = lstrlenA((LPCSTR)pbVar19);
      pbVar19[iVar18 + 1] = 0;
      iVar18 = lstrlenA((LPCSTR)pbVar7);
      pbVar7[iVar18 + 1] = 0;
      local_48._10_2_ = SUB42(param_1,0);
      local_3c._0_2_ = (undefined2)((uint)param_1 >> 0x10);
      local_48._0_2_ = local_20._0_2_;
      local_50 = pbVar19;
      local_4c = pbVar7;
      FUN_004053d6(0,(LPCSTR)param_1);
      iVar18 = SHFileOperationA((LPSHFILEOPSTRUCTA)(local_74 + 0x1c));
      if (iVar18 == 0) break;
    }
    FUN_004053d6(-7,(LPCSTR)0x0);
    goto LAB_004027f4;
  case 0x2f:
    if (local_28[0] != (HWND)0xbadf00d) {
LAB_004023a8:
      uVar31 = 0x200010;
      puVar6 = (undefined *)FUN_00406325((byte *)0x0,-0x18);
LAB_004023b6:
      FUN_004059a8(puVar6,uVar31);
      return (HWND)0x7fffffff;
    }
    DAT_004243b4 = DAT_004243b4 + 1;
    break;
  case 0x30:
    pbVar7 = (byte *)0x0;
    pbVar24 = (byte *)0x0;
    if (local_28[0] != (HWND)0x0) {
      pbVar7 = FUN_00402c65(0);
    }
    if (local_28[1] != (HWND)0x0) {
      pbVar24 = FUN_00402c65(0x11);
    }
    if ((HWND)local_1c.dwHighDateTime != (HWND)0x0) {
      pbVar19 = FUN_00402c65(0x22);
    }
    lpFileName = FUN_00402c65(0xffffffcd);
    pCVar10 = (LPSTR)WritePrivateProfileStringA
                               ((LPCSTR)pbVar7,(LPCSTR)pbVar24,(LPCSTR)pbVar19,(LPCSTR)lpFileName);
LAB_004015d3:
    bVar26 = pCVar10 == (LPSTR)0x0;
LAB_004015d5:
    if (bVar26) goto LAB_004027f4;
    break;
  case 0x31:
    param_1 = (HWND)CONCAT22(DAT_0040a010,param_1._0_2_);
    pbVar19 = FUN_00402c65(1);
    pbVar7 = FUN_00402c65(0x12);
    local_3c._0_2_ = SUB42(pbVar7,0);
    local_3c._2_2_ = (undefined2)((uint)pbVar7 >> 0x10);
    pbVar7 = FUN_00402c65(0xffffffdd);
    GetPrivateProfileStringA
              ((LPCSTR)pbVar19,(LPCSTR)CONCAT22(local_3c._2_2_,(undefined2)local_3c),
               (LPCSTR)((int)&param_1 + 2),(LPSTR)pHVar20,0x3ff,(LPCSTR)pbVar7);
    bVar26 = (char)pHVar20->unused == '\n';
LAB_00401767:
    if (bVar26) {
LAB_004027c8:
      local_8 = (HWND)0x1;
      *(undefined1 *)&pHVar20->unused = 0;
    }
    break;
  case 0x32:
    if ((HWND)local_1c.dwHighDateTime == (HWND)0x0) {
      pHVar8 = (HKEY)FUN_00402ca5((HKEY)0x2);
      if (pHVar8 == (HKEY)0x0) goto LAB_004027f4;
      pbVar19 = FUN_00402c65(0x33);
      LVar9 = RegDeleteValueA(pHVar8,(LPCSTR)pbVar19);
      RegCloseKey(pHVar8);
    }
    else {
      pbVar19 = FUN_00402c65(0x22);
      LVar9 = FUN_00402d23((int)local_28[1],(LPCSTR)pbVar19,(int)local_1c.dwHighDateTime >> 1);
    }
    if (LVar9 != 0) goto LAB_004027f4;
    break;
  case 0x33:
    local_3c._0_2_ = SUB42(local_14,0);
    local_3c._2_2_ = (undefined2)((uint)local_14 >> 0x10);
    local_88.bottom = (LONG)FUN_00402c65(2);
    pbVar19 = FUN_00402c65(0x11);
    local_8 = (HWND)0x1;
    param_1 = (HWND)FUN_00402cf5((int)local_28[0],(LPCSTR)pbVar19,(HKEY)0x2);
    if (param_1 != (HWND)0x0) {
      DVar25 = 0;
      if ((HWND)local_1c.dwHighDateTime == (HWND)0x1) {
        FUN_00402c65(0x23);
        iVar18 = lstrlenA(&DAT_0040ac00);
        DVar25 = iVar18 + 1;
      }
      uVar28 = CONCAT44(local_8c,_DAT_0040ac00);
      if ((HWND)local_1c.dwHighDateTime == (HWND)0x4) {
        uVar28 = FUN_00402c43(3);
        DVar25 = 4;
      }
      local_8c = (byte *)((ulonglong)uVar28 >> 0x20);
      _DAT_0040ac00 = (undefined4)uVar28;
      if ((HWND)local_1c.dwHighDateTime == (HWND)0x3) {
        DVar25 = FUN_004031a3(local_1c.dwLowDateTime,(HANDLE)0x0,&DAT_0040ac00,0xc00);
        uVar28 = CONCAT44(local_8c,_DAT_0040ac00);
      }
      local_8c = (byte *)((ulonglong)uVar28 >> 0x20);
      _DAT_0040ac00 = (undefined4)uVar28;
      LVar9 = RegSetValueExA((HKEY)param_1,(LPCSTR)local_88.bottom,0,
                             CONCAT22(local_3c._2_2_,(undefined2)local_3c),&DAT_0040ac00,DVar25);
      pHVar8 = (HKEY)param_1;
      if (LVar9 == 0) {
        local_8 = (HWND)0x0;
      }
LAB_00402619:
      RegCloseKey(pHVar8);
    }
    break;
  case 0x34:
    pHVar8 = (HKEY)FUN_00402ca5((HKEY)0x20019);
    pbVar19 = FUN_00402c65(0x33);
    *(undefined1 *)&pHVar20->unused = 0;
    if (pHVar8 != (HKEY)0x0) {
      local_3c._0_1_ = '\0';
      local_3c._1_1_ = '\x04';
      local_3c._2_1_ = '\0';
      local_3c._3_1_ = '\0';
      LVar9 = RegQueryValueExA(pHVar8,(LPCSTR)pbVar19,(LPDWORD)0x0,(LPDWORD)&param_1,(LPBYTE)pHVar20
                               ,&local_3c);
      if (LVar9 == 0) {
        if (param_1 == (HWND)0x4) {
          local_8 = (HWND)(uint)((HWND)local_1c.dwHighDateTime == (HWND)0x0);
          FUN_004061f0((LPSTR)pHVar20,pHVar20->unused);
          goto LAB_00402619;
        }
        if ((param_1 == (HWND)0x1) || (param_1 == (HWND)0x2)) {
          local_8 = (HWND)local_1c.dwHighDateTime;
          goto LAB_00402612;
        }
      }
      *(undefined1 *)&pHVar20->unused = 0;
      local_8 = (HWND)0x1;
      goto LAB_00402619;
    }
    goto LAB_004027f4;
  case 0x35:
    pHVar8 = (HKEY)FUN_00402ca5((HKEY)0x20019);
    uVar28 = FUN_00402c43(3);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    *(undefined1 *)&pHVar20->unused = 0;
    if (pHVar8 != (HKEY)0x0) {
      param_1 = (HWND)0x3ff;
      if ((HWND)local_1c.dwHighDateTime == (HWND)0x0) {
        LVar9 = RegEnumValueA(pHVar8,(DWORD)uVar28,(LPSTR)pHVar20,(LPDWORD)&param_1,(LPDWORD)0x0,
                              (LPDWORD)0x0,(LPBYTE)0x0,(LPDWORD)0x0);
        if (LVar9 != 0) {
          local_8 = (HWND)0x1;
        }
      }
      else {
        RegEnumKeyA(pHVar8,(DWORD)uVar28,(LPSTR)pHVar20,0x3ff);
      }
LAB_00402612:
      (&DAT_004253ff)[iVar18] = 0;
      goto LAB_00402619;
    }
    goto LAB_004027f4;
  case 0x36:
    pvVar12 = (HANDLE)FUN_00406209((byte *)pHVar20);
    if (pvVar12 != (HANDLE)0x0) goto LAB_00401fec;
    break;
  case 0x37:
    pbVar19 = FUN_00402c65(0xffffffed);
    pHVar14 = (HWND)FUN_00405e25((LPCSTR)pbVar19,(DWORD)local_28[1],(DWORD)local_20);
    if (pHVar14 == (HWND)0xffffffff) goto LAB_004027f2;
switchD_00401af3_default:
    FUN_004061f0((LPSTR)pHVar20,pHVar14);
    break;
  case 0x38:
    if (local_20 == (HWND)0x0) {
      pbVar19 = FUN_00402c65(0x11);
      DVar25 = lstrlenA((LPCSTR)pbVar19);
    }
    else {
      DVar25 = 1;
      DAT_0040a800 = FUN_00402c43(1);
      local_3c._0_2_ = (undefined2)extraout_EDX;
      local_3c._2_2_ = (undefined2)((uint)extraout_EDX >> 0x10);
    }
    if ((char)pHVar20->unused != '\0') {
      pvVar12 = (HANDLE)FUN_00406209((byte *)pHVar20);
      pCVar10 = (LPSTR)FUN_00405ecc(pvVar12,&DAT_0040a800,DVar25);
      goto LAB_004015d3;
    }
    goto LAB_004027f4;
  case 0x39:
    local_c = (HWND)0x0;
    uVar28 = FUN_00402c43(2);
    local_10 = (HWND)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    if ((int)local_10 < 1) break;
    if (0x3ff < (int)local_10) {
      local_10 = (HWND)0x3ff;
    }
    pHVar14 = local_c;
    if ((char)pHVar20->unused != '\0') {
      param_1 = (HWND)((uint)param_1 & 0xffffff);
      local_34 = (FARPROC)FUN_00406209((byte *)pHVar20);
      pHVar14 = local_c;
      if (0 < (int)local_10) {
        while (iVar18 = FUN_00405e9d(local_34,&local_2d,1), iVar18 != 0) {
          if ((HWND)local_1c.dwLowDateTime != (HWND)0x0) {
            FUN_004061f0((LPSTR)pHVar23,(uint)local_2d);
            goto LAB_00402afa;
          }
          if ((param_1._3_1_ == 0xd) || (param_1._3_1_ == 10)) {
            if ((param_1._3_1_ == local_2d) || ((local_2d != 0xd && (local_2d != 10)))) {
              SetFilePointer(local_34,-1,(PLONG)0x0,1);
            }
            else {
              *(byte *)((int)&pHVar23->unused + (int)pHVar14) = local_2d;
              pHVar14 = (HWND)((int)&pHVar14->unused + 1);
            }
            break;
          }
          *(byte *)((int)&pHVar23->unused + (int)pHVar14) = local_2d;
          pHVar14 = (HWND)((int)&pHVar14->unused + 1);
          param_1 = (HWND)CONCAT13(local_2d,param_1._0_3_);
          if ((local_2d == 0) || ((int)local_10 <= (int)pHVar14)) break;
        }
      }
    }
    *(undefined1 *)((int)&pHVar23->unused + (int)pHVar14) = 0;
    bVar26 = pHVar14 == (HWND)0x0;
    goto LAB_004015d5;
  case 0x3a:
    if ((char)pHVar20->unused != '\0') {
      uVar28 = FUN_00402c43(2);
      lDistanceToMove = (LONG)uVar28;
      local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
      local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
      lpDistanceToMoveHigh = (PLONG)0x0;
      pvVar12 = (HANDLE)FUN_00406209((byte *)pHVar20);
      pHVar14 = (HWND)SetFilePointer(pvVar12,lDistanceToMove,lpDistanceToMoveHigh,
                                     local_1c.dwLowDateTime);
      pHVar20 = pHVar23;
      goto joined_r0x00402786;
    }
    break;
  case 0x3b:
    pvVar12 = (HANDLE)FUN_00406209((byte *)pHVar20);
    if (pvVar12 != (HANDLE)0x0) {
      FindClose(pvVar12);
    }
    break;
  case 0x3c:
    pvVar12 = (HANDLE)FUN_00406209((byte *)pHVar23);
    if ((pvVar12 != (HANDLE)0x0) && (BVar11 = FindNextFileA(pvVar12,&local_1d4), BVar11 != 0)) {
LAB_00402807:
      pCVar21 = local_1d4.cFileName;
      goto LAB_0040295d;
    }
    goto LAB_004027c8;
  case 0x3d:
    pbVar19 = FUN_00402c65(2);
    pvVar12 = FindFirstFileA((LPCSTR)pbVar19,&local_1d4);
    if (pvVar12 != (HANDLE)0xffffffff) {
      FUN_004061f0((LPSTR)pHVar23,pvVar12);
      goto LAB_00402807;
    }
    *(undefined1 *)&pHVar23->unused = 0;
LAB_004027f2:
    *(undefined1 *)&pHVar20->unused = 0;
LAB_004027f4:
    local_8 = (HWND)0x1;
    break;
  case 0x3e:
    DVar25 = 0xfffffd66;
    pbVar19 = FUN_00402c65(0xfffffff0);
    local_88.bottom = (LONG)pbVar19;
    iVar18 = FUN_00405c91(pbVar19);
    if (iVar18 == 0) {
      FUN_00402c65(0xffffffed);
    }
    FUN_00405e00((LPCSTR)pbVar19);
    param_1 = (HWND)FUN_00405e25((LPCSTR)pbVar19,0x40000000,2);
    if (param_1 != (HWND)0xffffffff) {
      local_10 = local_28[1];
      if (local_20 != (HWND)0x0) {
        local_34 = DAT_00424334;
        hMem = GlobalAlloc(0x40,(SIZE_T)DAT_00424334);
        if (hMem != (HGLOBAL)0x0) {
          FUN_00403395(0);
          FUN_0040337f(hMem,(DWORD)local_34);
          piVar13 = (int *)GlobalAlloc(0x40,(SIZE_T)local_20);
          local_3c._0_2_ = SUB42(piVar13,0);
          local_3c._2_2_ = (undefined2)((uint)piVar13 >> 0x10);
          if (piVar13 != (int *)0x0) {
            FUN_004031a3((int)local_28[1],(HANDLE)0x0,(undefined *)piVar13,(uint)local_20);
            for (; (char)*piVar13 != '\0'; piVar13 = (int *)((int)(piVar13 + 2) + local_90)) {
              local_90 = *piVar13;
              FUN_00405de0((undefined1 *)(piVar13[1] + (int)hMem),(int)(piVar13 + 2),local_90);
            }
            GlobalFree((HGLOBAL)CONCAT22(local_3c._2_2_,(undefined2)local_3c));
          }
          FUN_00405ecc(param_1,hMem,(DWORD)local_34);
          GlobalFree(hMem);
          local_10 = (HWND)0xffffffff;
        }
      }
      DVar25 = FUN_004031a3((int)local_10,param_1,(undefined *)0x0,0);
      CloseHandle(param_1);
    }
    iVar18 = -0xd;
    if ((int)DVar25 < 0) {
      iVar18 = -0x11;
      DeleteFileA((LPCSTR)local_88.bottom);
      local_8 = (HWND)0x1;
    }
LAB_00402311:
    FUN_00401423(iVar18);
    break;
  case 0x3f:
    uVar28 = FUN_00402c43(0);
    local_48._8_2_ = (undefined2)uVar28;
    local_48._10_2_ = (undefined2)((ulonglong)uVar28 >> 0x10);
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    if (DAT_0042434c <= (uint)uVar28) goto LAB_004027f4;
    iVar18 = (uint)uVar28 * 0x418 + DAT_00424348;
    if (-1 < (int)local_20) {
      pHVar20 = pHVar23;
      pHVar14 = *(HWND *)(iVar18 + (int)local_20 * 4);
      if (local_20 == (HWND)0x0) {
        pCVar21 = (CHAR *)(iVar18 + 0x18);
        goto LAB_0040295d;
      }
      goto switchD_00401af3_default;
    }
    local_20 = (HWND)(-1 - (int)local_20);
    if (local_20 == (HWND)0x0) {
      FUN_00406325((byte *)(iVar18 + 0x18),local_1c.dwHighDateTime);
      uVar28 = CONCAT44(local_88.bottom,local_28[1]);
      *(byte *)(iVar18 + 9) = *(byte *)(iVar18 + 9) | 1;
    }
    else {
      uVar28 = FUN_00402c43(1);
    }
    local_88.bottom = (LONG)((ulonglong)uVar28 >> 0x20);
    local_28[1] = (HWND)uVar28;
    *(HWND *)(iVar18 + (int)local_20 * 4) = local_28[1];
    if ((HWND)local_1c.dwLowDateTime != (HWND)0x0) {
      FUN_0040117d(CONCAT22(local_48._10_2_,local_48._8_2_));
    }
    break;
  case 0x40:
    uVar28 = FUN_00402c43(0);
    uVar31 = (uint)uVar28;
    local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
    local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
    if (0x1f < uVar31) goto LAB_004027f4;
    if ((HWND)local_1c.dwLowDateTime == (HWND)0x0) {
      if (local_20 == (HWND)0x0) {
        FUN_00406325((byte *)pHVar23,*(int *)(DAT_00424330 + 0x94 + uVar31 * 4));
      }
      else {
        *(HWND *)(DAT_00424330 + 0x94 + uVar31 * 4) = local_28[1];
      }
    }
    else {
      if (local_20 == (HWND)0x0) {
        pHVar14 = (HWND)FUN_004012e2(0);
        pHVar20 = pHVar23;
        goto switchD_00401af3_default;
      }
      FUN_00401299(uVar31);
      FUN_004011ef(0,0);
    }
    break;
  case 0x41:
    if ((HWND)local_1c.dwLowDateTime == (HWND)0x0) {
      pFVar15 = FUN_004066ba(5);
      pbVar19 = FUN_00402c65(0x22);
      if (((pFVar15 == (FARPROC)0x0) ||
          (HVar16 = FUN_004062e5((int)pbVar19,(LPIID)local_48), HVar16 < 0)) ||
         (iVar18 = (*pFVar15)(local_48,local_1c.dwLowDateTime,0,&param_1), iVar18 < 0)) {
        local_8 = (HWND)0x1;
        *(undefined1 *)&pHVar23->unused = 0;
      }
      else {
        FUN_004062cf((LPSTR)pHVar23,(LPCWSTR)param_1);
        CoTaskMemFree(param_1);
      }
    }
    else if ((HWND)local_1c.dwLowDateTime == (HWND)0x1) {
      uVar28 = FUN_00402c43(2);
      puVar22 = (undefined4 *)uVar28;
      local_48._8_2_ = (undefined2)uVar28;
      local_48._10_2_ = (undefined2)((ulonglong)uVar28 >> 0x10);
      local_3c._0_2_ = (undefined2)((ulonglong)uVar28 >> 0x20);
      local_3c._2_2_ = (undefined2)((ulonglong)uVar28 >> 0x30);
      uVar28 = FUN_00402c43(4);
      local_88.bottom = (LONG)((ulonglong)uVar28 >> 0x20);
      param_1 = (HWND)0x0;
      if (puVar22 == (undefined4 *)0x0) {
        puVar22 = &DAT_004243a0;
      }
      FUN_00405de0((undefined1 *)&param_1,((uint)uVar28 >> 0x18) + (int)puVar22,(uint)uVar28 & 0xff)
      ;
      pHVar20 = pHVar23;
      pHVar14 = param_1;
      goto switchD_00401af3_default;
    }
    break;
  case 0x43:
    SendMessageA(local_c,0xb,DAT_00421920 & (uint)local_28[0],0);
    if (local_28[0] != (HWND)0x0) {
      InvalidateRect(local_c,(RECT *)0x0,0);
    }
  }
switchD_00401489_caseD_42:
  _DAT_004243a8 = (int)&local_8->unused + _DAT_004243a8;
LAB_00402afa:
  local_28[0] = (HWND)0x0;
switchD_00401489_caseD_2:
  return local_28[0];
}



/* Function: FUN_00402c43 */

void __cdecl FUN_00402c43(int param_1)

{
  byte *pbVar1;
  
  pbVar1 = (byte *)FUN_00406325((byte *)0x0,*(int *)(DAT_0040b83c + param_1 * 4));
  FUN_00406209(pbVar1);
  return;
}



/* Function: FUN_00402c65 */

byte * FUN_00402c65(uint param_1)

{
  uint uVar1;
  byte *pbVar2;
  
  uVar1 = param_1;
  if ((int)param_1 < 0) {
    uVar1 = -param_1;
  }
  pbVar2 = (byte *)FUN_00406325(&DAT_0040a400 + ((int)uVar1 >> 4) * 0x400,
                                *(int *)(DAT_0040b83c + (uVar1 & 0xf) * 4));
  if ((int)param_1 < 0) {
    FUN_0040658c(pbVar2);
  }
  return pbVar2;
}



/* Function: FUN_00402ca5 */

uint FUN_00402ca5(HKEY param_1)

{
  uint uVar1;
  byte *pbVar2;
  uint uVar3;
  LSTATUS LVar4;
  HKEY *ppHVar5;
  
  ppHVar5 = &param_1;
  uVar1 = (uint)param_1 | 0x100020;
  pbVar2 = FUN_00402c65(0x22);
  uVar3 = FUN_00402cdd(*(int *)(DAT_0040b83c + 4));
  LVar4 = FUN_00406118(uVar3,(LPCSTR)pbVar2,uVar1,ppHVar5);
  return ~-(uint)(LVar4 != 0) & (uint)param_1;
}



/* Function: FUN_00402cdd */

int FUN_00402cdd(int param_1)

{
  if (-1 < param_1) {
    param_1 = DAT_004243a4 + -0x7fffffff + param_1;
  }
  return param_1;
}



/* Function: FUN_00402cf5 */

uint FUN_00402cf5(int param_1,LPCSTR param_2,HKEY param_3)

{
  uint uVar1;
  uint uVar2;
  LSTATUS LVar3;
  HKEY *ppHVar4;
  
  ppHVar4 = &param_3;
  uVar1 = (uint)param_3 | 0x100020;
  uVar2 = FUN_00402cdd(param_1);
  LVar3 = FUN_00406146(uVar2,param_2,uVar1,ppHVar4);
  return ~-(uint)(LVar3 != 0) & (uint)param_3;
}



/* Function: FUN_00402d23 */

LSTATUS FUN_00402d23(int param_1,LPCSTR param_2,uint param_3)

{
  LSTATUS LVar1;
  uint uVar2;
  HKEY pHVar3;
  uint *puVar4;
  
  if (*param_2 == '\0') {
    LVar1 = 0x3eb;
  }
  else {
    param_3 = param_3 | 0x100020;
    puVar4 = &param_3;
    uVar2 = FUN_00402cdd(param_1);
    pHVar3 = (HKEY)FUN_00406097(uVar2,puVar4);
    if (pHVar3 == (HKEY)0x0) {
      LVar1 = 6;
    }
    else {
      LVar1 = FUN_00402d67(pHVar3,param_2,param_3);
    }
  }
  return LVar1;
}



/* Function: FUN_00402d67 */

LSTATUS FUN_00402d67(HKEY param_1,LPCSTR param_2,uint param_3)

{
  LSTATUS LVar1;
  FARPROC pFVar2;
  CHAR local_114 [264];
  DWORD local_c;
  HKEY local_8;
  
  LVar1 = FUN_00406118((uint)param_1,param_2,CONCAT31((int3)((param_3 & 0x300) >> 8),9),&local_8);
  if (LVar1 == 0) {
    if ((param_3 & 2) != 0) {
      local_c = 0;
      LVar1 = RegEnumValueA(local_8,0,local_114,&local_c,(LPDWORD)0x0,(LPDWORD)0x0,(LPBYTE)0x0,
                            (LPDWORD)0x0);
      if (LVar1 != 0x103) {
LAB_00402e2f:
        RegCloseKey(local_8);
        return 0x3eb;
      }
    }
    do {
      LVar1 = RegEnumKeyA(local_8,0,local_114,0x105);
      if (LVar1 != 0) break;
      if ((param_3 & 1) != 0) goto LAB_00402e2f;
      LVar1 = FUN_00402d67(local_8,local_114,param_3);
    } while (LVar1 == 0);
    RegCloseKey(local_8);
    pFVar2 = FUN_004066ba(3);
    if (pFVar2 == (FARPROC)0x0) {
      LVar1 = RegDeleteKeyA(param_1,param_2);
    }
    else {
      LVar1 = (*pFVar2)(param_1,param_2,param_3 & 0x300,0);
    }
  }
  return LVar1;
}



/* Function: FUN_00402e51 */

undefined4 FUN_00402e51(HWND param_1,int param_2)

{
  int iVar1;
  uint nNumber;
  CHAR local_44 [64];
  
  if (param_2 == 0x110) {
    SetTimer(param_1,1,0xfa,(TIMERPROC)0x0);
    param_2 = 0x113;
  }
  if (param_2 == 0x113) {
    nNumber = DAT_0040b8d0;
    if (DAT_0041f8dc <= DAT_0040b8d0) {
      nNumber = DAT_0041f8dc;
    }
    iVar1 = MulDiv(nNumber,100,DAT_0041f8dc);
    wsprintfA(local_44,s_verifying_installer___d___0040a01c,iVar1);
    SetWindowTextA(param_1,local_44);
    SetDlgItemTextA(param_1,0x406,local_44);
  }
  return 0;
}



/* Function: FUN_00402ed4 */

void __cdecl FUN_00402ed4(int param_1)

{
  DWORD DVar1;
  
  if (param_1 != 0) {
    if (DAT_0041f8d8 != (HWND)0x0) {
      DestroyWindow(DAT_0041f8d8);
    }
    DAT_0041f8d8 = (HWND)0x0;
    return;
  }
  if (DAT_0041f8d8 != (HWND)0x0) {
    FUN_004066f6(0);
    return;
  }
  DVar1 = GetTickCount();
  if (DAT_0042432c < DVar1) {
    DAT_0041f8d8 = CreateDialogParamA(DAT_00424320,(LPCSTR)0x6f,(HWND)0x0,FUN_00402e51,0);
    ShowWindow(DAT_0041f8d8,5);
  }
  return;
}



/* Function: FUN_00402f38 */

char * FUN_00402f38(uint param_1)

{
  DWORD DVar1;
  HANDLE hFile;
  LPCSTR pCVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  undefined4 *puVar6;
  int *piVar7;
  uint uVar8;
  uint local_2c;
  int local_28;
  int local_24;
  int local_20;
  int local_1c;
  SIZE_T local_18;
  uint local_14;
  uint local_10;
  int local_c;
  uint local_8;
  
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  DVar1 = GetTickCount();
  DAT_0042432c = DVar1 + 1000;
  GetModuleFileNameA((HMODULE)0x0,&DAT_0042bc00,0x400);
  while (hFile = (HANDLE)FUN_00405e25(&DAT_0042bc00,0x80000000,3), DAT_0040a018 = hFile,
        hFile == (HANDLE)0xffffffff) {
    DVar1 = GetLastError();
    if ((DVar1 != 0x20) || (local_8 = local_8 + 1, 6 < local_8)) {
      return s_Error_launching_installer_0040a104;
    }
    Sleep(0xfa);
  }
  FUN_00406292(&DAT_0042ac00,&DAT_0042bc00);
  pCVar2 = FUN_00405c6b(&DAT_0042ac00);
  FUN_00406292(&DAT_0042c000,pCVar2);
  uVar3 = GetFileSize(hFile,(LPDWORD)0x0);
  DAT_0041f8dc = uVar3;
  for (; uVar3 != 0; uVar3 = uVar3 - uVar8) {
    uVar4 = (-(uint)(DAT_00424334 != 0) & 0x7e00) + 0x200;
    uVar8 = uVar3;
    if (uVar4 <= uVar3) {
      uVar8 = uVar4;
    }
    iVar5 = FUN_0040337f(&DAT_0040b8d8,uVar8);
    if (iVar5 == 0) {
      FUN_00402ed4(1);
      goto LAB_00403144;
    }
    if (DAT_00424334 == 0) {
      FUN_00405de0((undefined1 *)&local_2c,0x40b8d8,0x1c);
      if (((((local_2c & 0xfffffff0) == 0) && (local_28 == -0x21524111)) && (local_1c == 0x74736e49)
          ) && ((local_20 == 0x74666f73 && (local_24 == 0x6c6c754e)))) {
        param_1 = param_1 | local_2c;
        DAT_004243c0 = DAT_004243c0 | param_1 & 2;
        DAT_00424334 = DAT_0040b8d0;
        if (uVar3 < local_14) goto LAB_00403144;
        if (((param_1 & 8) == 0) && ((param_1 & 4) != 0)) break;
        local_c = local_c + 1;
        uVar3 = local_14 - 4;
        if (uVar3 < uVar8) {
          uVar8 = uVar3;
        }
      }
    }
    else if ((param_1 & 2) == 0) {
      FUN_00402ed4(0);
    }
    if (uVar3 < DAT_0041f8dc) {
      local_10 = FUN_00406771(local_10,&DAT_0040b8d8,uVar8);
    }
    DAT_0040b8d0 = DAT_0040b8d0 + uVar8;
  }
  FUN_00402ed4(1);
  if (DAT_00424334 != 0) {
    if (local_c != 0) {
      FUN_00403395(DAT_0040b8d0);
      iVar5 = FUN_0040337f(&param_1,4);
      if ((iVar5 == 0) || (local_10 != param_1)) goto LAB_00403144;
    }
    puVar6 = (undefined4 *)GlobalAlloc(0x40,local_18);
    FUN_00403395(DAT_00424334 + 0x1c);
    DVar1 = FUN_004031a3(-1,(HANDLE)0x0,(undefined *)puVar6,local_18);
    if (DVar1 == local_18) {
      DAT_00424338 = *puVar6;
      if ((local_2c & 1) != 0) {
        DAT_0042433c = DAT_0042433c + 1;
      }
      piVar7 = puVar6 + 0x11;
      iVar5 = 8;
      DAT_00424330 = puVar6;
      do {
        piVar7 = piVar7 + -2;
        *piVar7 = *piVar7 + (int)puVar6;
        iVar5 = iVar5 + -1;
      } while (iVar5 != 0);
      DVar1 = SetFilePointer(hFile,0,(PLONG)0x0,1);
      puVar6[0xf] = DVar1;
      FUN_00405de0(&DAT_00424340,(int)(puVar6 + 1),0x40);
      return (char *)0x0;
    }
  }
LAB_00403144:
  return s_Installer_integrity_check_has_fa_0040a038;
}



/* Function: FUN_004031a3 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

DWORD FUN_004031a3(int param_1,HANDLE param_2,undefined *param_3,uint param_4)

{
  int iVar1;
  DWORD DVar2;
  undefined *puVar3;
  DWORD DVar4;
  uint uVar5;
  CHAR local_54 [64];
  int local_14;
  DWORD local_10;
  DWORD local_c;
  DWORD local_8;
  
  uVar5 = param_4;
  local_c = param_4;
  if (param_3 == (undefined *)0x0) {
    local_c = 0x8000;
  }
  local_8 = 0;
  puVar3 = param_3;
  if (param_3 == (undefined *)0x0) {
    puVar3 = &DAT_004178d8;
  }
  if (-1 < param_1) {
    FUN_00403395(DAT_00424378 + param_1);
  }
  iVar1 = FUN_0040337f(&param_4,4);
  if (iVar1 != 0) {
    if ((param_4 & 0x80000000) == 0) {
      if (param_3 == (undefined *)0x0) {
        while( true ) {
          if ((int)param_4 < 1) {
            return local_8;
          }
          uVar5 = local_c;
          if ((int)param_4 < (int)local_c) {
            uVar5 = param_4;
          }
          iVar1 = FUN_0040337f(&DAT_004138d8,uVar5);
          if (iVar1 == 0) break;
          iVar1 = FUN_00405ecc(param_2,&DAT_004138d8,uVar5);
          if (iVar1 == 0) {
            return 0xfffffffe;
          }
          local_8 = local_8 + uVar5;
          param_4 = param_4 - uVar5;
        }
      }
      else {
        if ((int)param_4 < (int)uVar5) {
          uVar5 = param_4;
        }
        iVar1 = FUN_0040337f(param_3,uVar5);
        if (iVar1 != 0) {
          return uVar5;
        }
      }
    }
    else {
      local_10 = GetTickCount();
      FUN_004067df(0x40b848);
      uVar5 = param_4 & 0x7fffffff;
      param_4 = uVar5;
      if (uVar5 == 0) {
        return local_8;
      }
      while( true ) {
        DVar2 = 0x4000;
        if ((int)param_4 < 0x4000) {
          DVar2 = param_4;
        }
        iVar1 = FUN_0040337f(&DAT_004138d8,DVar2);
        if (iVar1 == 0) break;
        param_4 = param_4 - DVar2;
        _DAT_0040b860 = &DAT_004138d8;
        _DAT_0040b864 = DVar2;
        while( true ) {
          _DAT_0040b86c = local_c;
          DAT_0040b868 = puVar3;
          local_14 = FUN_004067ff((SIZE_T *)&DAT_0040b848);
          if (local_14 < 0) {
            return 0xfffffffc;
          }
          DVar4 = (int)DAT_0040b868 - (int)puVar3;
          DVar2 = GetTickCount();
          if ((((byte)DAT_004243d4 & 1) != 0) && ((200 < DVar2 - local_10 || (param_4 == 0)))) {
            iVar1 = MulDiv(uVar5 - param_4,100,uVar5);
            wsprintfA(local_54,s______d___0040a120,iVar1);
            FUN_004053d6(0,local_54);
            local_10 = DVar2;
          }
          if (DVar4 == 0) break;
          if (param_3 == (undefined *)0x0) {
            iVar1 = FUN_00405ecc(param_2,puVar3,DVar4);
            if (iVar1 == 0) {
              return 0xfffffffe;
            }
          }
          else {
            local_c = local_c - DVar4;
            puVar3 = DAT_0040b868;
          }
          local_8 = local_8 + DVar4;
          if (local_14 == 1) {
            return local_8;
          }
        }
        if ((int)param_4 < 1) {
          return local_8;
        }
      }
    }
  }
  return 0xfffffffd;
}



/* Function: FUN_0040337f */

void FUN_0040337f(LPVOID param_1,DWORD param_2)

{
  FUN_00405e9d(DAT_0040a018,param_1,param_2);
  return;
}



/* Function: FUN_00403395 */

void FUN_00403395(LONG param_1)

{
  SetFilePointer(DAT_0040a018,param_1,(PLONG)0x0,0);
  return;
}



/* Function: FUN_004033ac */

void FUN_004033ac(void)

{
  int iVar1;
  
  FUN_0040658c(&DAT_0042b400);
  iVar1 = FUN_00405c91(&DAT_0042b400);
  if (iVar1 == 0) {
    return;
  }
  FUN_00405c24(&DAT_0042b400);
  FUN_004058f6(&DAT_0042b400);
  FUN_00405e54(&DAT_0042b000,&DAT_0042b400);
  return;
}



/* Function: entry */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void entry(void)

{
  char cVar1;
  bool bVar2;
  BOOL BVar3;
  FARPROC pFVar4;
  int iVar5;
  LPSTR pCVar6;
  LPCSTR lpsz;
  uint *puVar7;
  uint *puVar8;
  undefined3 extraout_var;
  undefined *puVar9;
  HANDLE pvVar10;
  char *pcVar11;
  DWORD DVar12;
  HANDLE *TokenHandle;
  SHFILEINFOA local_228;
  _OSVERSIONINFOA local_c8;
  undefined4 local_34;
  undefined4 local_30;
  _TOKEN_PRIVILEGES local_2c;
  HANDLE local_1c;
  UINT local_18;
  uint *local_14;
  char *local_10;
  uint local_c;
  int local_8;
  
  local_18 = 0;
  local_10 = s_Error_writing_temporary_file__Ma_0040a188;
  local_c = 0;
  local_8 = CONCAT31(local_8._1_3_,0x20);
  SetErrorMode(0x8001);
  local_c8.szCSDVersion[0] = '\0';
  local_c8.szCSDVersion[1] = '\0';
  local_c8.szCSDVersion[2] = '\0';
  local_c8.szCSDVersion[3] = '\0';
  local_34 = 0;
  local_30 = 0;
  local_c8.dwOSVersionInfoSize = 0x9c;
  BVar3 = GetVersionExA(&local_c8);
  if (BVar3 == 0) {
    local_c8.dwOSVersionInfoSize = 0x94;
    GetVersionExA(&local_c8);
    if (local_c8.dwPlatformId == 2) {
      local_30._0_3_ = CONCAT12(4,(ushort)local_30);
      local_34 = CONCAT22(local_34._2_2_,
                          ~-(ushort)(local_c8.szCSDVersion[0] != 'S') &
                          (short)local_c8.szCSDVersion[0xd] - 0x30U);
    }
  }
  if (local_c8.dwPlatformId < 2) {
    local_30._0_3_ = (uint3)(ushort)local_30;
    if (local_c8.szCSDVersion[1] < 'A') {
      local_34 = (uint)local_34._2_2_ << 0x10;
    }
    else {
      local_34 = CONCAT22(local_34._2_2_,local_c8.szCSDVersion[1] + -0x40);
    }
  }
  if (local_c8.dwMajorVersion < 10) {
    local_c8.dwBuildNumber = local_c8.dwBuildNumber & 0xffff;
  }
  _DAT_004243d8 = local_c8.dwBuildNumber;
  _DAT_004243dc =
       (uint)CONCAT11((undefined1)local_c8.dwMajorVersion,(undefined1)local_c8.dwMinorVersion) <<
       0x10 | (local_34 & 0xff) << 8 | local_30 >> 0x10 & 0xff;
  if ((CONCAT11((undefined1)local_c8.dwMajorVersion,(undefined1)local_c8.dwMinorVersion) != 0x600)
     && (pFVar4 = FUN_004066ba(0), pFVar4 != (FARPROC)0x0)) {
    (*pFVar4)(0xc00);
  }
  pcVar11 = "UXTHEME";
  do {
    FUN_0040664c(pcVar11);
    iVar5 = lstrlenA(pcVar11);
    pcVar11 = pcVar11 + iVar5 + 1;
  } while (*pcVar11 != '\0');
  FUN_004066ba(0xc);
  DAT_00424324 = FUN_004066ba(10);
  pFVar4 = FUN_004066ba(8);
  if ((pFVar4 != (FARPROC)0x0) && (iVar5 = (*pFVar4)(0x1e), iVar5 != 0)) {
    _DAT_004243dc = _DAT_004243dc | 0x80;
  }
  Ordinal_17();
  DAT_004243e0 = OleInitialize((LPVOID)0x0);
  SHGetFileInfoA(&DAT_0041f8e0,0,&local_228,0x160,0);
  FUN_00406292(&DAT_00423b20,s_NSIS_Error_0040a17c);
  pCVar6 = GetCommandLineA();
  FUN_00406292(&DAT_0042a000,pCVar6);
  DAT_00424320 = 0x400000;
  pcVar11 = &DAT_0042a000;
  if (DAT_0042a000 == '\"') {
    local_8 = CONCAT31(local_8._1_3_,0x22);
    pcVar11 = &DAT_0042a001;
  }
  lpsz = (LPCSTR)FUN_00405c4f(pcVar11,(char)local_8);
  puVar7 = (uint *)CharNextA(lpsz);
  local_14 = puVar7;
  while (cVar1 = (char)*puVar7, cVar1 != '\0') {
    while (cVar1 == ' ') {
      puVar7 = (uint *)((int)puVar7 + 1);
      cVar1 = *(char *)puVar7;
    }
    local_8 = CONCAT31(local_8._1_3_,0x20);
    if ((char)*puVar7 == '\"') {
      puVar7 = (uint *)((int)puVar7 + 1);
      local_8 = CONCAT31(local_8._1_3_,0x22);
    }
    puVar8 = puVar7;
    if ((char)*puVar7 == '/') {
      puVar8 = (uint *)((int)puVar7 + 1);
      if ((*(char *)puVar8 == 'S') &&
         ((*(char *)((int)puVar7 + 2) == ' ' || (*(char *)((int)puVar7 + 2) == '\0')))) {
        DAT_004243c0 = 1;
      }
      if ((*puVar8 ==
           ((((int)DAT_0040a177 << 8 | (int)DAT_0040a176) << 8 | (int)DAT_0040a175) << 8 |
           (int)DAT_0040a174)) &&
         ((*(char *)((int)puVar7 + 5) == ' ' || (*(char *)((int)puVar7 + 5) == '\0')))) {
        local_c = local_c | 4;
      }
      if (*(uint *)((int)puVar7 + -1) ==
          ((((int)DAT_0040a16f << 8 | (int)DAT_0040a16e) << 8 | (int)DAT_0040a16d) << 8 |
          (int)DAT_0040a16c)) {
        *(char *)((int)puVar7 + -1) = '\0';
        FUN_00406292(&DAT_0042a400,(LPCSTR)((int)puVar7 + 3));
        break;
      }
    }
    puVar7 = (uint *)FUN_00405c4f((LPCSTR)puVar8,(char)local_8);
    if ((char)*puVar7 == '\"') {
      puVar7 = (uint *)((int)puVar7 + 1);
    }
  }
  GetTempPathA(0x400,&DAT_0042b400);
  iVar5 = FUN_004033ac();
  if (iVar5 == 0) {
    GetWindowsDirectoryA(&DAT_0042b400,0x3fb);
    lstrcatA(&DAT_0042b400,s__Temp_0040a164);
    iVar5 = FUN_004033ac();
    if (iVar5 == 0) {
      GetTempPathA(0x3fc,&DAT_0042b400);
      lstrcatA(&DAT_0042b400,&DAT_0040a160);
      SetEnvironmentVariableA(&DAT_0040a158,&DAT_0042b400);
      SetEnvironmentVariableA(&DAT_0040a154,&DAT_0042b400);
      iVar5 = FUN_004033ac();
      if (iVar5 == 0) goto LAB_004037bf;
    }
  }
  DeleteFileA(&DAT_0042b000);
  local_10 = FUN_00402f38(local_c);
  if (local_10 != (char *)0x0) goto LAB_004037bf;
  if (DAT_0042433c != 0) {
    puVar7 = (uint *)FUN_00405c4f(&DAT_0042a000,'\0');
    if ((uint *)0x429fff < puVar7) {
      do {
        if (*puVar7 ==
            ((((int)DAT_0040a14f << 8 | (int)DAT_0040a14e) << 8 | (int)DAT_0040a14d) << 8 |
            (int)DAT_0040a14c)) break;
        puVar7 = (uint *)((int)puVar7 + -1);
      } while ((uint *)0x429fff < puVar7);
    }
    local_10 = s_Error_launching_installer_0040a104;
    if (puVar7 < &DAT_0042a000) {
      local_1c = (HANDLE)FUN_00405913();
      iVar5 = lstrlenA(&DAT_0042b400);
      FUN_00406292(&DAT_00425000,(LPCSTR)local_14);
      if (DAT_0042a400 == '\0') {
        FUN_00406292(&DAT_0042a400,&DAT_0042ac00);
      }
      local_14 = (uint *)(&DAT_0042b400 + iVar5);
      local_c = 1;
      do {
        local_8 = 0;
        do {
          while( true ) {
            wsprintfA((LPSTR)local_14,s__nsu_X_tmp_0040a140,local_c & 0xffff);
            FUN_00406325(&DAT_00426400,*(int *)(DAT_00424330 + 0x120));
            if (local_1c == (HANDLE)0x0) {
              DVar12 = FUN_004058f6(&DAT_0042b400);
            }
            else {
              DVar12 = FUN_0040589c(&DAT_0042b400);
            }
            if (DVar12 != 0) break;
            SetCurrentDirectoryA(&DAT_0042b400);
            FUN_0040606b(&DAT_0042b400,(LPCSTR)0x0);
            BVar3 = CopyFileA(&DAT_0042bc00,&DAT_00426400,1);
            if (BVar3 == 0) goto LAB_004037bf;
            FUN_0040606b(&DAT_00426400,(LPCSTR)0x0);
            FUN_00406325(&DAT_00426800,*(int *)(DAT_00424330 + 0x124));
            pvVar10 = FUN_0040592b(&DAT_00426800);
            if (pvVar10 != (HANDLE)0x0) {
              CloseHandle(pvVar10);
              local_10 = (char *)0x0;
              goto LAB_004037bf;
            }
            iVar5 = local_8 + 1;
            bVar2 = local_8 != 0;
            local_8 = iVar5;
            if ((bVar2) || (puVar9 = FUN_00406625(&DAT_00426400), puVar9 != (undefined *)0x0))
            goto LAB_004037bf;
          }
          DVar12 = GetFileAttributesA(&DAT_00426400);
          if (((DVar12 & 0x400) != 0) || (BVar3 = DeleteFileA(&DAT_00426400), BVar3 == 0)) break;
          FUN_00405a54(&DAT_0042b400,1);
          iVar5 = local_8 + 1;
          bVar2 = local_8 == 0;
          local_8 = iVar5;
        } while (bVar2);
        local_c = local_c + 1;
      } while ((short)local_c != 0);
      goto LAB_004037bf;
    }
    *(undefined1 *)puVar7 = 0;
    puVar7 = puVar7 + 1;
    bVar2 = FUN_00405d12((LPCSTR)puVar7);
    if (CONCAT31(extraout_var,bVar2) == 0) goto LAB_004037bf;
    FUN_00406292(&DAT_0042a400,(LPCSTR)puVar7);
    FUN_00406292(&DAT_0042a800,(LPCSTR)puVar7);
    local_10 = (char *)0x0;
  }
  DAT_004243cc = -1;
  local_18 = FUN_00403a9b();
LAB_004037bf:
  FUN_004039c1();
  OleUninitialize();
  if (local_10 != (char *)0x0) {
    FUN_004059a8(local_10,0x200010);
                    /* WARNING: Subroutine does not return */
    ExitProcess(2);
  }
  if (DAT_004243b4 != 0) {
    TokenHandle = &local_1c;
    DVar12 = 0x28;
    pvVar10 = GetCurrentProcess();
    BVar3 = OpenProcessToken(pvVar10,DVar12,TokenHandle);
    if (BVar3 != 0) {
      LookupPrivilegeValueA((LPCSTR)0x0,s_SeShutdownPrivilege_0040a12c,&local_2c.Privileges[0].Luid)
      ;
      local_2c.PrivilegeCount = 1;
      local_2c.Privileges[0].Attributes = 2;
      AdjustTokenPrivileges(local_1c,0,&local_2c,0,(PTOKEN_PRIVILEGES)0x0,(PDWORD)0x0);
    }
    pFVar4 = FUN_004066ba(4);
    if (((pFVar4 != (FARPROC)0x0) && (iVar5 = (*pFVar4)(0,0,0,0x25,0x80040002), iVar5 == 0)) ||
       (BVar3 = ExitWindowsEx(2,0x80040002), BVar3 == 0)) {
      FUN_0040140b(9);
    }
  }
  if (DAT_004243cc != -1) {
    local_18 = DAT_004243cc;
  }
                    /* WARNING: Subroutine does not return */
  ExitProcess(local_18);
}



/* Function: FUN_004039c1 */

void FUN_004039c1(void)

{
  if (DAT_0040a018 != (HANDLE)0xffffffff) {
    CloseHandle(DAT_0040a018);
    DAT_0040a018 = (HANDLE)0xffffffff;
  }
  FUN_00403a06();
  FUN_00405a54(&DAT_0042b800,7);
  return;
}



/* Function: FUN_004039eb */

void FUN_004039eb(undefined4 param_1)

{
  undefined4 *puVar1;
  
  for (puVar1 = DAT_0041f8e4; puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1) {
    (*(code *)puVar1[1])(param_1);
  }
  return;
}



/* Function: FUN_00403a06 */

void FUN_00403a06(void)

{
  int *piVar1;
  int *hMem;
  
  hMem = DAT_0041f8e4;
  FUN_004039eb(0);
  if (hMem != (int *)0x0) {
    do {
      piVar1 = (int *)*hMem;
      FreeLibrary((HMODULE)hMem[2]);
      GlobalFree(hMem);
      hMem = piVar1;
    } while (piVar1 != (int *)0x0);
  }
  DAT_0041f8e4 = (int *)0x0;
  return;
}



/* Function: FUN_00403a3b */

undefined4 FUN_00403a3b(int param_1)

{
  undefined4 *puVar1;
  
  puVar1 = DAT_0041f8e4;
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 1;
    }
    if (puVar1[2] == param_1) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  return 0;
}



/* Function: FUN_00403a59 */

undefined4 FUN_00403a59(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  iVar1 = FUN_00403a3b(param_1);
  if (iVar1 == 0) {
    uVar2 = 1;
  }
  else {
    puVar3 = (undefined4 *)GlobalAlloc(0x40,0xc);
    if (puVar3 == (undefined4 *)0x0) {
      uVar2 = 0xffffffff;
    }
    else {
      puVar3[2] = param_1;
      puVar3[1] = param_2;
      *puVar3 = DAT_0041f8e4;
      uVar2 = 0;
      DAT_0041f8e4 = puVar3;
    }
  }
  return uVar2;
}



/* Function: FUN_00403a9b */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

INT_PTR FUN_00403a9b(void)

{
  bool bVar1;
  ATOM AVar2;
  FARPROC pFVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined1 *puVar5;
  int iVar6;
  DWORD DVar7;
  LPCSTR pCVar8;
  undefined3 extraout_var_00;
  int iVar9;
  BOOL BVar10;
  INT_PTR IVar11;
  char *lpString;
  int iStack_10;
  int iStack_c;
  int iStack_8;
  int iStack_4;
  
  iVar9 = DAT_00424330;
  pFVar3 = FUN_004066ba(2);
  if (pFVar3 == (FARPROC)0x0) {
    DAT_0042b000 = 0x30;
    DAT_0042b001 = 0x78;
    DAT_0042b002 = 0;
    FUN_00406179(0x80000001,"Control Panel\\Desktop\\ResourceLocale",(LPCSTR)0x0,
                 (LPBYTE)&DAT_00420920,(HKEY)0x0);
    if (DAT_00420920 == '\0') {
      FUN_00406179(0x80000003,".DEFAULT\\Control Panel\\International","Locale",
                   (LPBYTE)&DAT_00420920,(HKEY)0x0);
    }
    lstrcatA(&DAT_0042b000,&DAT_00420920);
  }
  else {
    uVar4 = (*pFVar3)();
    FUN_004061f0(&DAT_0042b000,uVar4 & 0xffff);
  }
  FUN_00403d60();
  DAT_004243a0 = DAT_00424338 & 0x20;
  _DAT_004243bc = 0x10000;
  bVar1 = FUN_00405d12(&DAT_0042a400);
  if ((CONCAT31(extraout_var,bVar1) == 0) && (*(int *)(iVar9 + 0x48) != 0)) {
    lpString = &DAT_004232c0;
    FUN_00406179(*(uint *)(iVar9 + 0x44),(LPCSTR)(*(int *)(iVar9 + 0x48) + DAT_00424358),
                 (LPCSTR)(*(int *)(iVar9 + 0x4c) + DAT_00424358),(LPBYTE)&DAT_004232c0,(HKEY)0x0);
    if (DAT_004232c0 != '\0') {
      if (DAT_004232c0 == '\"') {
        lpString = &DAT_004232c1;
        puVar5 = (undefined1 *)FUN_00405c4f(&DAT_004232c1,'\"');
        *puVar5 = 0;
      }
      iVar6 = lstrlenA(lpString);
      if (((lpString < lpString + iVar6 + -4) &&
          (iVar6 = lstrcmpiA(lpString + iVar6 + -4,&DAT_0040a1e8), iVar6 == 0)) &&
         ((DVar7 = GetFileAttributesA(lpString), DVar7 == 0xffffffff || ((DVar7 & 0x10) == 0)))) {
        FUN_00405c6b(lpString);
      }
      pCVar8 = FUN_00405c24(lpString);
      FUN_00406292(&DAT_0042a400,pCVar8);
    }
  }
  bVar1 = FUN_00405d12(&DAT_0042a400);
  if (CONCAT31(extraout_var_00,bVar1) == 0) {
    FUN_00406325(&DAT_0042a400,*(int *)(iVar9 + 0x118));
  }
  DAT_00423b08 = LoadImageA(DAT_00424320,(LPCSTR)0x67,1,0,0,0x8040);
  if (*(int *)(iVar9 + 0x50) == -1) {
LAB_00403c87:
    iVar9 = FUN_0040140b(0);
    if (iVar9 == 0) {
      FUN_00403d60();
      if (DAT_004243c0 == 0) {
        ShowWindow(DAT_00420900,5);
        iVar9 = FUN_0040664c("RichEd20");
        if (iVar9 == 0) {
          FUN_0040664c("RichEd32");
        }
        BVar10 = GetClassInfoA((HINSTANCE)0x0,"RichEdit20A",(LPWNDCLASSA)&DAT_00423ac0);
        if (BVar10 == 0) {
          GetClassInfoA((HINSTANCE)0x0,"RichEdit",(LPWNDCLASSA)&DAT_00423ac0);
          _DAT_00423ae4 = "RichEdit20A";
          RegisterClassA((WNDCLASSA *)&DAT_00423ac0);
        }
        IVar11 = DialogBoxParamA(DAT_00424320,(LPCSTR)(DAT_00423b00 + 0x69U & 0xffff),(HWND)0x0,
                                 (DLGPROC)&LAB_00403e38,0);
        FUN_0040140b(5);
        FUN_004039eb(1);
        return IVar11;
      }
      iVar9 = FUN_004054a8((HWND)0x0);
      if (iVar9 == 0) {
        FUN_0040140b(1);
        goto LAB_00403d56;
      }
      if (DAT_00423aec == 0) {
        FUN_0040140b(2);
      }
    }
    IVar11 = 2;
  }
  else {
    _DAT_00423ac4 = FUN_00401000;
    _DAT_00423ad0 = DAT_00424320;
    _DAT_00423ae4 = &DAT_0040a1e4;
    _DAT_00423ad4 = DAT_00423b08;
    AVar2 = RegisterClassA((WNDCLASSA *)&DAT_00423ac0);
    if (AVar2 != 0) {
      SystemParametersInfoA(0x30,0,&iStack_10,0);
      DAT_00420900 = CreateWindowExA(0x80,&DAT_0040a1e4,(LPCSTR)0x0,0x80000000,iStack_10,iStack_c,
                                     iStack_8 - iStack_10,iStack_4 - iStack_c,(HWND)0x0,(HMENU)0x0,
                                     DAT_00424320,(LPVOID)0x0);
      goto LAB_00403c87;
    }
LAB_00403d56:
    IVar11 = 0;
  }
  return IVar11;
}



/* Function: FUN_00403d60 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00403d60(void)

{
  int iVar1;
  ushort *puVar2;
  ushort uVar3;
  int iVar4;
  int *piVar5;
  
  uVar3 = 0xffff;
  iVar1 = FUN_00406209(&DAT_0042b000);
  do {
    if (DAT_00424364 != 0) {
      puVar2 = (ushort *)(*(int *)(DAT_00424330 + 100) * DAT_00424364 + _DAT_00424360);
      iVar4 = DAT_00424364;
      do {
        puVar2 = (ushort *)((int)puVar2 - *(int *)(DAT_00424330 + 100));
        iVar4 = iVar4 + -1;
        if (((*puVar2 ^ (ushort)iVar1) & uVar3) == 0) {
          DAT_00423b00 = *(undefined4 *)(puVar2 + 1);
          DAT_004243c8 = *(undefined4 *)(puVar2 + 3);
          DAT_00423afc = puVar2 + 5;
          if (DAT_00423afc != (ushort *)0x0) {
            FUN_004061f0(&DAT_0042b000,(uint)*puVar2);
            FUN_00403e19();
            piVar5 = DAT_00424348;
            for (iVar1 = DAT_0042434c; iVar1 != 0; iVar1 = iVar1 + -1) {
              if (*piVar5 != 0) {
                FUN_00406325((byte *)(piVar5 + 6),*piVar5);
              }
              piVar5 = piVar5 + 0x106;
            }
            return;
          }
          break;
        }
      } while (iVar4 != 0);
    }
    if (uVar3 == 0xffff) {
      uVar3 = 0x3ff;
    }
    else {
      uVar3 = 0;
    }
  } while( true );
}



/* Function: FUN_00403e19 */

undefined * FUN_00403e19(void)

{
  FUN_00406325(&DAT_00423b20,-2);
  SetWindowTextA(DAT_00420900,&DAT_00423b20);
  return &DAT_00423b20;
}



/* Function: FUN_0040430b */

void FUN_0040430b(WPARAM param_1)

{
  if (param_1 == 0x78) {
    DAT_00423aec = DAT_00423aec + 1;
  }
  SendMessageA(DAT_00424328,0x408,param_1,0);
  return;
}



/* Function: FUN_00404332 */

void FUN_00404332(HWND param_1,int param_2,int param_3)

{
  LPCSTR lpString;
  
  lpString = (LPCSTR)FUN_00406325((byte *)0x0,param_3);
  SetDlgItemTextA(param_1,param_2 + 1000,lpString);
  return;
}



/* Function: FUN_00404354 */

void FUN_00404354(BOOL param_1)

{
  EnableWindow(DAT_0042091c,param_1);
  return;
}



/* Function: FUN_00404367 */

void FUN_00404367(WPARAM param_1)

{
  SendMessageA(DAT_00424328,0x28,param_1,1);
  return;
}



/* Function: FUN_0040437e */

void FUN_0040437e(UINT param_1)

{
  if (DAT_00423af8 != (HWND)0x0) {
    SendMessageA(DAT_00423af8,param_1,0,0);
  }
  return;
}



/* Function: FUN_00404399 */

COLORREF FUN_00404399(int param_1,HDC param_2,HWND param_3)

{
  COLORREF *pCVar1;
  COLORREF color;
  HBRUSH pHVar2;
  LOGBRUSH local_10;
  
  if ((((param_1 - 0x133U < 6) &&
       (pCVar1 = (COLORREF *)GetWindowLongA(param_3,-0x15), pCVar1 != (COLORREF *)0x0)) &&
      (pCVar1[2] < 2)) && ((pCVar1[4] < 3 && ((pCVar1[5] & 0xffffffe0) == 0)))) {
    color = *pCVar1;
    if ((pCVar1[5] & 2) != 0) {
      color = GetSysColor(color);
    }
    if ((pCVar1[5] & 1) != 0) {
      SetTextColor(param_2,color);
    }
    SetBkMode(param_2,pCVar1[4]);
    local_10.lbColor = pCVar1[1];
    if ((pCVar1[5] & 8) != 0) {
      local_10.lbColor = GetSysColor(local_10.lbColor);
    }
    if ((pCVar1[5] & 4) != 0) {
      SetBkColor(param_2,local_10.lbColor);
    }
    if ((pCVar1[5] & 0x10) != 0) {
      local_10.lbStyle = pCVar1[2];
      if ((HGDIOBJ)pCVar1[3] != (HGDIOBJ)0x0) {
        DeleteObject((HGDIOBJ)pCVar1[3]);
      }
      pHVar2 = CreateBrushIndirect(&local_10);
      pCVar1[3] = (COLORREF)pHVar2;
    }
    return pCVar1[3];
  }
  return 0;
}



/* Function: FUN_00404468 */

undefined4 FUN_00404468(int param_1,LPSTR param_2,int param_3,int *param_4)

{
  int iVar1;
  
  lstrcpynA(param_2,(LPCSTR)(DAT_0041f8ec + param_1),param_3);
  iVar1 = lstrlenA(param_2);
  *param_4 = iVar1;
  DAT_0041f8ec = DAT_0041f8ec + iVar1;
  return 0;
}



/* Function: FUN_0040449d */

COLORREF FUN_0040449d(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  uint *puVar1;
  char cVar2;
  HWND pHVar3;
  DWORD lParam;
  int iVar4;
  HCURSOR pHVar5;
  COLORREF CVar6;
  uint uVar7;
  LPCSTR lpString;
  UINT Msg;
  WPARAM wParam;
  LPARAM lParam_00;
  LPCSTR local_10;
  int local_c;
  code *local_8;
  
  if (param_2 == 0x110) {
    iVar4 = param_4[0xc].unused;
    if (iVar4 < 0) {
      iVar4 = *(int *)(DAT_00423afc - (iVar4 * 4 + 4));
    }
    cVar2 = *(char *)(iVar4 + DAT_00424358);
    local_c = 0;
    lpString = (char *)(iVar4 + DAT_00424358) + 1;
    local_8 = FUN_00404468;
    uVar7 = (uint)~param_4[5].unused >> 5 & 1 | param_4[5].unused & 1U;
    local_10 = lpString;
    FUN_00404332(param_1,0x22,param_4[0xd].unused);
    FUN_00404332(param_1,0x23,param_4[0xe].unused);
    CheckDlgButton(param_1,(uVar7 == 0) + 0x40a,1);
    FUN_00404354(uVar7);
    pHVar3 = GetDlgItem(param_1,1000);
    FUN_00404367((WPARAM)pHVar3);
    SendMessageA(pHVar3,0x45b,1,0);
    lParam = *(DWORD *)(DAT_00424330 + 0x68);
    if ((int)lParam < 0) {
      lParam = GetSysColor(-lParam);
    }
    SendMessageA(pHVar3,0x443,0,lParam);
    SendMessageA(pHVar3,0x445,0,0x4010000);
    iVar4 = lstrlenA(lpString);
    SendMessageA(pHVar3,0x435,0,iVar4);
    DAT_0041f8ec = 0;
    SendMessageA(pHVar3,0x449,(int)cVar2,(LPARAM)&local_10);
    DAT_0041f8ec = 0;
    return 0;
  }
  if (param_2 == 0x111) {
    if ((((short)((uint)param_3 >> 0x10) != 0) || (DAT_0041f8ec != 0)) ||
       (puVar1 = (uint *)(DAT_004200f8 + 0x14), (*(byte *)puVar1 & 0x20) == 0)) goto LAB_0040470a;
    lParam_00 = 0;
    wParam = 0;
    Msg = 0xf0;
    pHVar3 = GetDlgItem(param_1,0x40a);
    uVar7 = SendMessageA(pHVar3,Msg,wParam,lParam_00);
    *puVar1 = *puVar1 & 0xfffffffe | uVar7 & 1;
    FUN_00404354(uVar7 & 1);
    FUN_0040471d();
  }
  if (param_2 == 0x4e) {
    pHVar3 = GetDlgItem(param_1,1000);
    if ((param_4[2].unused == 0x70b) && (param_4[3].unused == 0x201)) {
      local_c = param_4[7].unused;
      local_10 = (LPCSTR)param_4[6].unused;
      local_8 = (code *)&DAT_004232c0;
      if ((uint)(local_c - (int)local_10) < 0x800) {
        SendMessageA(pHVar3,1099,0,(LPARAM)&local_10);
        pHVar5 = LoadCursorA((HINSTANCE)0x0,(LPCSTR)0x7f02);
        SetCursor(pHVar5);
        FUN_00404741(param_1,(LPCSTR)local_8);
        pHVar5 = LoadCursorA((HINSTANCE)0x0,(LPCSTR)0x7f00);
        SetCursor(pHVar5);
      }
    }
    if ((param_4[2].unused == 0x700) && (param_4[3].unused == 0x100)) {
      if (param_4[4].unused == 0xd) {
        SendMessageA(DAT_00424328,0x111,1,0);
      }
      if (param_4[4].unused == 0x1b) {
        SendMessageA(DAT_00424328,0x10,0,0);
      }
      return 1;
    }
  }
  else if (param_2 == 0x40b) {
    DAT_0041f8ec = DAT_0041f8ec + 1;
  }
LAB_0040470a:
  CVar6 = FUN_00404399(param_2,param_3,param_4);
  return CVar6;
}



/* Function: FUN_0040471d */

void FUN_0040471d(void)

{
  HWND hWnd;
  
  hWnd = DAT_0041f8e8;
  if (DAT_004243ac == 0) {
    hWnd = DAT_0042091c;
  }
  SendMessageA(hWnd,0xf4,1,1);
  return;
}



/* Function: FUN_00404741 */

void FUN_00404741(HWND param_1,LPCSTR param_2)

{
  SHELLEXECUTEINFOA local_40;
  
  local_40.lpParameters = (LPCSTR)0x0;
  local_40.lpDirectory = (LPCSTR)0x0;
  local_40.hwnd = param_1;
  local_40.fMask = 0x500;
  local_40.lpFile = param_2;
  local_40.nShow = 1;
  local_40.lpVerb = &DAT_0040a1f0;
  FUN_0040596e(&local_40);
  return;
}



/* Function: FUN_0040477d */

void FUN_0040477d(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  if (param_2 == 0x110) {
    FUN_00404332(param_1,0x1d,param_4[0xc].unused);
    SetDlgItemTextA(param_1,1000,&DAT_00425000 + param_4[0xf].unused * 0x400);
  }
  FUN_00404399(param_2,param_3,param_4);
  return;
}



/* Function: FUN_004047c4 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_004047c4(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  bool bVar1;
  HWND hWnd;
  int iVar2;
  char *pcVar3;
  FARPROC pFVar4;
  LPITEMIDLIST pv;
  undefined3 extraout_var;
  BOOL BVar5;
  uint uVar6;
  int iVar7;
  byte *lpString;
  LPCITEMIDLIST *ppIVar8;
  LPCSTR pCVar9;
  _browseinfoA local_50;
  uint local_30;
  uint local_2c;
  undefined1 local_28 [4];
  DWORD local_24;
  int local_20;
  undefined1 local_1c [4];
  DWORD local_18;
  DWORD local_14;
  FARPROC local_10;
  int local_c;
  int local_8;
  
  local_20 = DAT_004200f8;
  local_c = *(int *)(DAT_004200f8 + 0x38);
  lpString = &DAT_00425000 + *(int *)(DAT_004200f8 + 0x3c) * 0x400;
  if (param_2 == 0x40b) {
    FUN_0040598c(0x3fb,(LPSTR)lpString);
    FUN_0040658c(lpString);
  }
  if (param_2 == 0x110) {
    hWnd = GetDlgItem(param_1,0x3fb);
    iVar2 = FUN_00405c91(lpString);
    if ((iVar2 != 0) && (pcVar3 = FUN_00405cbd((LPCSTR)lpString), pcVar3 == (char *)0x0)) {
      FUN_00405c24((LPCSTR)lpString);
    }
    DAT_00423af8 = param_1;
    SetWindowTextA(hWnd,(LPCSTR)lpString);
    FUN_00404332(param_1,1,param_4[0xd].unused);
    FUN_00404332(param_1,0x14,param_4[0xc].unused);
    FUN_00404367((WPARAM)hWnd);
    pFVar4 = FUN_004066ba(9);
    if (pFVar4 == (FARPROC)0x0) goto LAB_00404b00;
    (*pFVar4)(hWnd,1);
  }
  iVar2 = local_c;
  if (param_2 == 0x111) {
    if (((uint)param_3 & 0xffff) == 0x3fb) {
      if ((short)((uint)param_3 >> 0x10) != 0x300) goto LAB_00404b00;
      param_2 = 0x40f;
    }
    if (((uint)param_3 & 0xffff) == 0x3e9) {
      ppIVar8 = &local_50.pidlRoot;
      for (iVar7 = 7; iVar7 != 0; iVar7 = iVar7 + -1) {
        *ppIVar8 = (LPCITEMIDLIST)0x0;
        ppIVar8 = ppIVar8 + 1;
      }
      local_50.hwndOwner = param_1;
      local_50.pszDisplayName = &DAT_00420920;
      local_50.lpfn = FUN_00404b15;
      local_50.lParam = (LPARAM)lpString;
      local_50.lpszTitle = (LPCSTR)FUN_00406325(&DAT_0041fcf8,iVar2);
      local_50.ulFlags = 0x41;
      pv = SHBrowseForFolderA(&local_50);
      if (pv == (LPITEMIDLIST)0x0) {
        param_2 = 0x40f;
      }
      else {
        CoTaskMemFree(pv);
        FUN_00405c24((LPCSTR)lpString);
        if ((*(int *)(DAT_00424330 + 0x11c) != 0) && (lpString == &DAT_0042a400)) {
          FUN_00406325((byte *)0x0,*(int *)(DAT_00424330 + 0x11c));
          iVar2 = lstrcmpiA(&DAT_004232c0,&DAT_00420920);
          if (iVar2 != 0) {
            lstrcatA(&DAT_0042a400,&DAT_004232c0);
          }
        }
        DAT_00420910 = DAT_00420910 + 1;
        SetDlgItemTextA(param_1,0x3fb,(LPCSTR)lpString);
      }
    }
  }
  if ((param_2 == 0x40f) || (param_2 == 0x405)) {
    local_8 = 0;
    local_c = 0;
    FUN_0040598c(0x3fb,(LPSTR)lpString);
    bVar1 = FUN_00405d12((LPCSTR)lpString);
    if (CONCAT31(extraout_var,bVar1) == 0) {
      local_8 = 1;
    }
    FUN_00406292(&DAT_0041f8f0,(LPCSTR)lpString);
    local_10 = FUN_004066ba(1);
    if (local_10 != (FARPROC)0x0) {
      pCVar9 = (LPCSTR)0x0;
      do {
        iVar2 = (*local_10)(&DAT_0041f8f0,&local_30,local_1c,local_28);
        if (iVar2 != 0) {
          local_30 = local_30 >> 10 | local_2c << 0x16;
          local_2c = local_2c >> 10;
          local_c = 1;
          goto LAB_00404a59;
        }
        if (pCVar9 != (LPCSTR)0x0) {
          *pCVar9 = '\0';
        }
        pCVar9 = FUN_00405c6b(&DAT_0041f8f0);
        *pCVar9 = '\0';
        pCVar9 = pCVar9 + -1;
        *pCVar9 = '\\';
      } while (pCVar9 != &DAT_0041f8f0);
    }
    FUN_00406292(&DAT_0041f8f0,(LPCSTR)lpString);
    pcVar3 = FUN_00405cbd(&DAT_0041f8f0);
    if (pcVar3 != (char *)0x0) {
      *pcVar3 = '\0';
    }
    BVar5 = GetDiskFreeSpaceA(&DAT_0041f8f0,&local_14,&local_18,(LPDWORD)&local_10,&local_24);
    if (BVar5 != 0) {
      local_30 = MulDiv(local_14 * local_18,(int)local_10,0x400);
      local_2c = (int)local_30 >> 0x1f;
      local_c = 1;
    }
LAB_00404a59:
    uVar6 = FUN_00404c58(5);
    if (((local_c != 0) && (local_2c == 0)) && (local_30 < uVar6)) {
      local_8 = 2;
    }
    if (*(int *)(DAT_00423afc + 0x10) != 0) {
      FUN_00404c40(0x3ff,-5,uVar6);
      if (local_c == 0) {
        SetDlgItemTextA(param_1,0x400,&DAT_0041f8e0);
      }
      else {
        FUN_00404b7b(0x400,-4,local_30,local_2c);
      }
    }
    _DAT_004243c4 = local_8;
    if (local_8 == 0) {
      local_8 = FUN_0040140b(7);
    }
    if ((*(uint *)(local_20 + 0x14) & 0x400) != 0) {
      local_8 = 0;
    }
    FUN_00404354((uint)(local_8 == 0));
    if ((local_8 == 0) && (DAT_00420910 == 0)) {
      FUN_0040471d();
    }
    DAT_00420910 = 0;
  }
LAB_00404b00:
  FUN_00404399(param_2,param_3,param_4);
  return;
}



/* Function: FUN_00404b15 */

undefined4 FUN_00404b15(HWND param_1,int param_2,LPCITEMIDLIST param_3,LPSTR param_4)

{
  BOOL BVar1;
  int iVar2;
  LPARAM lParam;
  
  if (param_2 == 1) {
    FUN_0040598c(0x3fb,param_4);
    SendMessageA(param_1,0x466,1,(LPARAM)param_4);
  }
  if (param_2 == 2) {
    BVar1 = SHGetPathFromIDListA(param_3,param_4);
    if ((BVar1 == 0) || (iVar2 = FUN_0040140b(7), iVar2 != 0)) {
      lParam = 0;
    }
    else {
      lParam = 1;
    }
    SendMessageA(param_1,0x465,0,lParam);
    return 0;
  }
  return 0;
}



/* Function: FUN_00404b7b */

void FUN_00404b7b(int param_1,int param_2,uint param_3,int param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  sbyte sVar5;
  uint uVar6;
  uint uVar7;
  char *pcVar8;
  byte local_44 [32];
  byte local_24 [32];
  
  iVar3 = -0x24;
  if (param_4 == 0) {
    sVar5 = 0x14;
    if (param_3 < 0x100000) {
      sVar5 = 10;
      iVar3 = -0x23;
    }
    if (param_3 < 0x400) {
      sVar5 = 0;
      iVar3 = -0x22;
    }
    if (param_3 < 0xffff3333) {
      param_3 = (1 << sVar5) / 0x14 + param_3;
    }
    uVar6 = param_3 >> sVar5;
    uVar7 = ((param_3 & 0xffffff) * 10 >> sVar5) % 10;
  }
  else {
    uVar6 = param_3 >> 0x14 | param_4 << 0xc;
    uVar7 = 0;
  }
  uVar1 = FUN_00406325(local_24,-0x21);
  uVar2 = FUN_00406325(local_44,iVar3);
  pcVar8 = s__u__u_s_s_0040a1f8;
  iVar3 = FUN_00406325(&DAT_00420920,param_2);
  iVar4 = lstrlenA(&DAT_00420920);
  wsprintfA((LPSTR)(iVar3 + iVar4),pcVar8,uVar6,uVar7,uVar2,uVar1);
  SetDlgItemTextA(DAT_00423af8,param_1,&DAT_00420920);
  return;
}



/* Function: FUN_00404c40 */

void FUN_00404c40(int param_1,int param_2,uint param_3)

{
  FUN_00404b7b(param_1,param_2,param_3,0);
  return;
}



/* Function: FUN_00404c58 */

int FUN_00404c58(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = 0;
  iVar2 = DAT_00424348;
  iVar3 = DAT_0042434c;
  if (DAT_0042434c != 0) {
    do {
      if ((*(byte *)(iVar2 + 8) & 1) != 0) {
        iVar1 = iVar1 + *(int *)(iVar2 + param_1 * 4);
      }
      iVar3 = iVar3 + -1;
      iVar2 = iVar2 + 0x418;
    } while (iVar3 != 0);
  }
  return iVar1;
}



/* Function: FUN_00404c85 */

undefined4 FUN_00404c85(HWND param_1,int param_2)

{
  DWORD DVar1;
  undefined4 local_3c;
  LRESULT local_38;
  undefined4 local_18;
  tagPOINT local_14;
  byte local_c;
  LRESULT local_8;
  
  local_38 = SendMessageA(param_1,0x110a,9,0);
  if (param_2 != 0) {
    DVar1 = GetMessagePos();
    local_14.x = (LONG)(short)DVar1;
    local_14.y = (LONG)(short)(DVar1 >> 0x10);
    ScreenToClient(param_1,&local_14);
    SendMessageA(param_1,0x1111,0,(LPARAM)&local_14);
    local_38 = local_8;
    if ((local_c & 0x66) == 0) {
      return 0xffffffff;
    }
  }
  local_3c = 4;
  SendMessageA(param_1,0x110c,0,(LPARAM)&local_3c);
  return local_18;
}



/* Function: FUN_00404d05 */

void FUN_00404d05(int param_1,undefined4 param_2)

{
  FUN_00406292(&DAT_00420920,&DAT_00425000);
  FUN_004061f0(&DAT_00425000,param_2);
  FUN_0040140b(param_1);
  FUN_00406292(&DAT_00425000,&DAT_00420920);
  return;
}



/* Function: FUN_00404d37 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00404d37(HWND param_1,int param_2,HDC param_3,HWND param_4)

{
  int iVar1;
  uint uVar2;
  LRESULT LVar3;
  LPARAM lParam;
  WPARAM WVar4;
  uint uVar5;
  HDC pHVar6;
  HWND hWnd;
  int iVar7;
  uint *puVar8;
  HWND local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  uint local_48;
  uint local_44;
  uint *local_40;
  uint *local_3c;
  undefined4 local_30;
  int local_2c;
  HGLOBAL local_24;
  uint *local_20;
  int local_1c;
  int local_18;
  int local_14;
  HWND local_10;
  HWND local_c;
  HWND local_8;
  
  local_c = GetDlgItem(param_1,0x3f9);
  local_8 = GetDlgItem(param_1,0x408);
  local_18 = DAT_00424348;
  local_1c = DAT_00424330 + 0x94;
  if (param_2 == 0x110) {
    local_24 = (HGLOBAL)0x0;
    _DAT_00424380 = param_1;
    local_14 = 2;
    DAT_00420918 = GlobalAlloc(0x40,DAT_0042434c << 2);
    local_10 = (HWND)LoadImageA(DAT_00424320,(LPCSTR)0x6e,0,0,0,0);
    DAT_0042090c = 0xffffffff;
    DAT_00420914 = SetWindowLongA(local_8,-4,0x40534a);
    DAT_00420904 = ImageList_Create(0x10,0x10,0x21,6,0);
    ImageList_AddMasked(DAT_00420904,(HBITMAP)local_10,0xff00ff);
    SendMessageA(local_8,0x1109,2,(LPARAM)DAT_00420904);
    LVar3 = SendMessageA(local_8,0x111c,0,0);
    if (LVar3 < 0x10) {
      SendMessageA(local_8,0x111b,0x10,0);
    }
    DeleteObject(local_10);
    iVar7 = 0;
    do {
      iVar1 = *(int *)(local_1c + iVar7 * 4);
      if (iVar1 != 0) {
        if (iVar7 != 0x20) {
          local_14 = 0;
        }
        lParam = FUN_00406325((byte *)0x0,iVar1);
        WVar4 = SendMessageA(local_c,0x143,0,lParam);
        SendMessageA(local_c,0x151,WVar4,iVar7);
      }
      iVar7 = iVar7 + 1;
    } while (iVar7 < 0x21);
    FUN_00404332(param_1,0x15,param_4[local_14 + 0xc].unused);
    FUN_00404332(param_1,0x16,param_4[local_14 + 0xd].unused);
    iVar7 = 0;
    local_10 = (HWND)0x0;
    if (DAT_0042434c < 1) {
LAB_00404f76:
      uVar5 = GetWindowLongA(local_8,-0x10);
      SetWindowLongA(local_8,-0x10,uVar5 & 0xfffffffb);
    }
    else {
      local_20 = (uint *)(local_18 + 8);
      do {
        puVar8 = local_20 + 4;
        if ((char)*puVar8 != '\0') {
          uVar5 = *local_20;
          local_58 = local_10;
          local_54 = 0xffff0002;
          local_48 = uVar5 & 0x20;
          local_50 = 0xd;
          local_44 = 0x20;
          local_40 = puVar8;
          local_2c = iVar7;
          if ((uVar5 & 2) == 0) {
            if ((uVar5 & 4) == 0) {
              LVar3 = SendMessageA(local_8,0x1100,0,(LPARAM)&local_58);
              *(LRESULT *)((int)DAT_00420918 + iVar7 * 4) = LVar3;
            }
            else {
              local_10 = (HWND)SendMessageA(local_8,0x110a,3,(LPARAM)local_10);
            }
          }
          else {
            local_50 = 0x4d;
            local_30 = 1;
            LVar3 = SendMessageA(local_8,0x1100,0,(LPARAM)&local_58);
            local_24 = (HGLOBAL)0x1;
            *(LRESULT *)((int)DAT_00420918 + iVar7 * 4) = LVar3;
            local_10 = *(HWND *)((int)DAT_00420918 + iVar7 * 4);
          }
        }
        iVar7 = iVar7 + 1;
        local_20 = local_20 + 0x106;
      } while (iVar7 < DAT_0042434c);
      if (local_24 == (HGLOBAL)0x0) goto LAB_00404f76;
    }
    if (local_14 == 0) {
      ShowWindow(local_c,5);
      FUN_00404367((WPARAM)local_c);
      goto LAB_00405335;
    }
    FUN_00404367((WPARAM)local_8);
  }
  if (param_2 == 0x405) {
    param_3 = (HDC)0x0;
    param_2 = 0x40f;
    param_4 = (HWND)0x1;
  }
  if (((param_2 == 0x4e) || (param_2 == 0x413)) &&
     ((local_10 = param_4, param_2 == 0x413 || (param_4[1].unused == 0x408)))) {
    if (((DAT_00424338 & 0x200) == 0) &&
       (((param_2 == 0x413 || (param_4[2].unused == -2)) &&
        (iVar7 = FUN_00404c85(local_8,(uint)(param_2 != 0x413)), -1 < iVar7)))) {
      puVar8 = (uint *)(iVar7 * 0x418 + 8 + local_18);
      uVar5 = *puVar8;
      if ((uVar5 & 0x10) == 0) {
        if ((uVar5 & 0x40) == 0) {
          uVar5 = uVar5 ^ 1;
        }
        else if ((char)((byte)uVar5 ^ 0x80) < '\0') {
          uVar5 = uVar5 ^ 0x80 | 1;
        }
        else {
          uVar5 = (uVar5 ^ 0x80) & 0xfffffffe;
        }
        *puVar8 = uVar5;
        FUN_0040117d(iVar7);
        param_3 = (HDC)(iVar7 + 1);
        param_4 = (HWND)(~DAT_00424338 >> 8 & 1);
        param_2 = 0x40f;
      }
    }
    if (local_10 != (HWND)0x0) {
      if (local_10[2].unused == -0x192) {
        SendMessageA(local_8,0x419,0,local_10[0x17].unused);
      }
      if (local_10[2].unused == -0x196) {
        if (local_10[3].unused == 2) {
          puVar8 = (uint *)(local_10[0x17].unused * 0x418 + 8 + local_18);
          *puVar8 = *puVar8 | 0x20;
        }
        else {
          puVar8 = (uint *)(local_10[0x17].unused * 0x418 + 8 + local_18);
          *puVar8 = *puVar8 & 0xffffffdf;
        }
      }
    }
  }
  if (param_2 == 0x111) {
    if ((((short)param_3 != 0x3f9) || ((short)((uint)param_3 >> 0x10) != 1)) ||
       (WVar4 = SendMessageA(local_c,0x147,0,0), WVar4 == 0xffffffff)) goto LAB_00405335;
    uVar5 = SendMessageA(local_c,0x150,WVar4,0);
    if ((uVar5 == 0xffffffff) || (*(int *)(local_1c + uVar5 * 4) == 0)) {
      uVar5 = 0x20;
    }
    FUN_00401299(uVar5);
    SendMessageA(param_1,0x420,0,uVar5);
    param_3 = (HDC)0xffffffff;
    param_4 = (HWND)0x0;
    param_2 = 0x40f;
  }
  if (param_2 == 0x200) {
    SendMessageA(local_8,0x200,0,0);
  }
  if (param_2 == 0x40b) {
    if (DAT_00420904 != (HIMAGELIST)0x0) {
      ImageList_Destroy(DAT_00420904);
    }
    if (DAT_00420918 != (HGLOBAL)0x0) {
      GlobalFree(DAT_00420918);
    }
    DAT_00420904 = (HIMAGELIST)0x0;
    DAT_00420918 = (HGLOBAL)0x0;
    _DAT_00424380 = (HWND)0x0;
  }
  if (param_2 == 0x40f) {
    FUN_004011ef(0,0);
    if (param_3 != (HDC)0x0) {
      pHVar6 = param_3;
      if (param_3 != (HDC)0xffffffff) {
        pHVar6 = (HDC)((int)&param_3[-1].unused + 3);
      }
      FUN_00404d05(8,pHVar6);
    }
    if (param_4 != (HWND)0x0) {
      param_4 = (HWND)FUN_004012e2((int)DAT_00420918);
      FUN_00401299((uint)param_4);
      iVar7 = 0;
      WVar4 = 0;
      if (0 < (int)param_4) {
        do {
          if (*(int *)(local_1c + iVar7 * 4) != 0) {
            WVar4 = WVar4 + 1;
          }
          iVar7 = iVar7 + 1;
        } while (iVar7 < (int)param_4);
      }
      SendMessageA(local_c,0x14e,WVar4,0);
      param_2 = 0x420;
    }
    FUN_004011ef(0,0);
    local_24 = DAT_00420918;
    local_40 = (uint *)0xf030;
    local_18 = 0;
    if (0 < DAT_0042434c) {
      puVar8 = (uint *)(DAT_00424348 + 8);
      do {
        uVar5 = *(uint *)((int)local_24 + local_18 * 4);
        if (uVar5 != 0) {
          uVar2 = *puVar8;
          local_4c = 8;
          if ((uVar2 & 0x100) != 0) {
            local_3c = puVar8 + 4;
            local_4c = 9;
            *(byte *)((int)puVar8 + 1) = *(byte *)((int)puVar8 + 1) & 0xfe;
          }
          if ((uVar2 & 0x40) == 0) {
            iVar7 = (uVar2 & 1) + 1;
            if ((uVar2 & 0x10) != 0) {
              iVar7 = (uVar2 & 1) + 4;
            }
          }
          else {
            iVar7 = 3;
          }
          local_44 = (iVar7 << 0xb | uVar2 & 8) * 2 | uVar2 & 0x20;
          local_48 = uVar5;
          SendMessageA(local_8,0x1102,((int)uVar2 >> 5 & 1U) + 1,uVar5);
          SendMessageA(local_8,0x110d,0,(LPARAM)&local_4c);
        }
        local_18 = local_18 + 1;
        puVar8 = puVar8 + 0x106;
      } while (local_18 < DAT_0042434c);
    }
    if (DAT_004243de == 0x400) {
      InvalidateRect(local_8,(RECT *)0x0,1);
    }
    if (*(int *)(DAT_00423afc + 0x10) != 0) {
      uVar5 = FUN_00404c58(5);
      FUN_00404c40(0x3ff,-5,uVar5);
    }
  }
  if ((param_2 == 0x420) && ((DAT_00424338 & 0x100) != 0)) {
    iVar7 = (uint)(param_4 == (HWND)0x20) << 3;
    ShowWindow(local_8,iVar7);
    hWnd = GetDlgItem(param_1,0x3fe);
    ShowWindow(hWnd,iVar7);
  }
LAB_00405335:
  FUN_00404399(param_2,param_3,param_4);
  return;
}



/* Function: FUN_0040534a */

LRESULT FUN_0040534a(HWND param_1,UINT param_2,WPARAM param_3,int param_4)

{
  BOOL BVar1;
  LRESULT LVar2;
  
  if (param_2 == 0x102) {
    if (param_3 == 0x20) {
      FUN_0040437e(0x413);
      return 0;
    }
  }
  else {
    if (param_2 == 0x200) {
      BVar1 = IsWindowVisible(param_1);
      if (BVar1 == 0) goto LAB_004053bc;
      param_4 = FUN_00404c85(param_1,1);
      param_2 = 0x419;
    }
    if ((param_2 == 0x419) && (DAT_0042090c != param_4)) {
      DAT_0042090c = param_4;
      FUN_00404d05(6,param_4);
    }
  }
LAB_004053bc:
  LVar2 = CallWindowProcA(DAT_00420914,param_1,param_2,param_3,param_4);
  return LVar2;
}



/* Function: FUN_004053d6 */

void FUN_004053d6(int param_1,LPCSTR param_2)

{
  int iVar1;
  int iVar2;
  LRESULT LVar3;
  uint uVar4;
  undefined4 local_34;
  WPARAM local_30;
  undefined4 local_2c;
  undefined *local_20;
  uint local_c;
  HWND local_8;
  
  local_8 = DAT_00423b04;
  if (DAT_00423b04 != (HWND)0x0) {
    local_c = DAT_004243d4;
    uVar4 = DAT_004243d4 & 1;
    if (uVar4 == 0) {
      FUN_00406325(&DAT_00420100,param_1);
    }
    iVar1 = lstrlenA(&DAT_00420100);
    if (param_2 != (LPCSTR)0x0) {
      iVar2 = lstrlenA(param_2);
      if (0x7ff < (uint)(iVar2 + iVar1)) {
        return;
      }
      lstrcatA(&DAT_00420100,param_2);
    }
    if ((local_c & 4) == 0) {
      SetWindowTextA(DAT_00423ae8,&DAT_00420100);
    }
    if ((local_c & 2) == 0) {
      local_20 = &DAT_00420100;
      local_34 = 1;
      LVar3 = SendMessageA(local_8,0x1004,0,0);
      local_30 = LVar3 - uVar4;
      local_2c = 0;
      SendMessageA(local_8,0x1007 - uVar4,0,(LPARAM)&local_34);
      SendMessageA(local_8,0x1013,local_30,0);
    }
    if (uVar4 != 0) {
      (&DAT_00420100)[iVar1] = 0;
    }
  }
  return;
}



/* Function: FUN_004054a8 */

int FUN_004054a8(HWND param_1)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = DAT_0042434c;
  iVar2 = DAT_00424348;
  uVar1 = OleInitialize((LPVOID)0x0);
  DAT_004243e0 = DAT_004243e0 | uVar1;
  FUN_0040437e(0);
  if (iVar4 != 0) {
    piVar3 = (int *)(iVar2 + 0xc);
    do {
      iVar4 = iVar4 + -1;
      if (((*(byte *)(piVar3 + -1) & 1) != 0) && (iVar2 = FUN_00401389(*piVar3,param_1), iVar2 != 0)
         ) {
        DAT_004243ac = DAT_004243ac + 1;
        break;
      }
      piVar3 = piVar3 + 0x106;
    } while (iVar4 != 0);
  }
  FUN_0040437e(0x404);
  OleUninitialize();
  return DAT_004243ac;
}



/* Function: FUN_00405514 */

COLORREF FUN_00405514(HWND param_1,DWORD param_2,HDC param_3,HWND param_4)

{
  DWORD DVar1;
  HWND pHVar2;
  HANDLE hObject;
  HMENU hMenu;
  LPCSTR lpNewItem;
  int x;
  BOOL BVar3;
  LRESULT LVar4;
  HGLOBAL hMem;
  undefined1 *puVar5;
  COLORREF CVar6;
  int y;
  WPARAM wParam;
  SIZE_T dwBytes;
  DWORD dwCreationFlags;
  DWORD *lpThreadId;
  undefined1 local_40 [8];
  undefined4 local_38;
  undefined4 local_34;
  int local_30;
  undefined1 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 uStack_1c;
  tagRECT local_18;
  HWND local_8;
  
  DVar1 = param_2;
  wParam = 0;
  local_8 = DAT_00423b04;
  if (param_2 == 0x110) {
    local_30 = 0xffffffff;
    local_24 = 0xffffffff;
    local_38 = 2;
    local_34 = 0;
    local_2c = (undefined1 *)0x0;
    local_28 = 0;
    local_20 = 0;
    uStack_1c = 0;
    param_3 = *(HDC *)(DAT_00424330 + 0x5c);
    param_2 = *(DWORD *)(DAT_00424330 + 0x60);
    DAT_00423af0 = GetDlgItem(param_1,0x403);
    DAT_00423ae8 = GetDlgItem(param_1,0x3ee);
    DAT_00423b04 = GetDlgItem(param_1,0x3f8);
    local_8 = DAT_00423b04;
    FUN_00404367((WPARAM)DAT_00423af0);
    DAT_00423af4 = FUN_00404c58(4);
    DAT_00423b0c = 0;
    GetClientRect(local_8,&local_18);
    local_30 = GetSystemMetrics(2);
    local_30 = local_18.right - local_30;
    SendMessageA(local_8,0x101b,0,(LPARAM)&local_38);
    SendMessageA(local_8,0x1036,0x4000,0x4000);
    if (-1 < (int)param_3) {
      SendMessageA(local_8,0x1001,0,(LPARAM)param_3);
      SendMessageA(local_8,0x1026,0,(LPARAM)param_3);
    }
    if (-1 < (int)param_2) {
      SendMessageA(local_8,0x1024,0,param_2);
    }
    FUN_00404332(param_1,0x1b,param_4[0xc].unused);
    if (((byte)DAT_00424338 & 3) != 0) {
      ShowWindow(DAT_00423af0,0);
      if (((byte)DAT_00424338 & 2) == 0) {
        ShowWindow(local_8,8);
      }
      else {
        DAT_00423af0 = (HWND)0x0;
      }
      FUN_00404367((WPARAM)DAT_00423ae8);
    }
    pHVar2 = GetDlgItem(param_1,0x3ec);
    SendMessageA(pHVar2,0x401,0,0x75300000);
    if (((byte)DAT_00424338 & 4) != 0) {
      SendMessageA(pHVar2,0x409,0,param_2);
      SendMessageA(pHVar2,0x2001,0,(LPARAM)param_3);
    }
LAB_00405895:
    CVar6 = 0;
  }
  else {
    if (param_2 == 0x405) {
      lpThreadId = &param_2;
      dwCreationFlags = 0;
      pHVar2 = GetDlgItem(param_1,0x3ec);
      hObject = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_004054a8,pHVar2,dwCreationFlags,
                             lpThreadId);
      CloseHandle(hObject);
    }
    if (DVar1 == 0x111) {
      if ((short)param_3 == 0x403) {
        ShowWindow(DAT_00423af0,0);
        ShowWindow(local_8,8);
        FUN_00404367((WPARAM)local_8);
        goto LAB_0040571d;
      }
    }
    else {
LAB_0040571d:
      if (DVar1 == 0x404) {
        if (DAT_00423aec != 0) {
          DAT_0041fcf0 = 2;
          FUN_0040430b(0x78);
          goto LAB_0040573e;
        }
        ShowWindow(DAT_00424328,8);
        if (DAT_004243ac == 0) {
          FUN_004053d6(*(int *)(DAT_004200f8 + 0x34),(LPCSTR)0x0);
        }
        FUN_0040430b(1);
      }
      if ((DVar1 == 0x7b) && (param_3 == (HDC)local_8)) {
        param_3 = (HDC)SendMessageA(local_8,0x1004,0,0);
        if (0 < (int)param_3) {
          hMenu = CreatePopupMenu();
          lpNewItem = (LPCSTR)FUN_00406325((byte *)0x0,-0x1f);
          AppendMenuA(hMenu,0,1,lpNewItem);
          x = (int)(short)param_4;
          y = (int)(short)((uint)param_4 >> 0x10);
          if (param_4 == (HWND)0xffffffff) {
            GetWindowRect(local_8,&local_18);
            x = local_18.left;
            y = local_18.top;
          }
          BVar3 = TrackPopupMenu(hMenu,0x180,x,y,0,param_1,(RECT *)0x0);
          if (BVar3 == 1) {
            dwBytes = 1;
            local_38 = 0;
            local_2c = &DAT_00420920;
            local_28 = 0x1000;
            param_1 = (HWND)param_3;
            do {
              param_1 = (HWND)((int)&param_1[-1].unused + 3);
              LVar4 = SendMessageA(local_8,0x102d,(WPARAM)param_1,(LPARAM)local_40);
              dwBytes = dwBytes + 2 + LVar4;
            } while (param_1 != (HWND)0x0);
            OpenClipboard((HWND)0x0);
            EmptyClipboard();
            hMem = GlobalAlloc(0x42,dwBytes);
            puVar5 = (undefined1 *)GlobalLock(hMem);
            do {
              local_2c = puVar5;
              LVar4 = SendMessageA(local_8,0x102d,wParam,(LPARAM)local_40);
              puVar5 = puVar5 + LVar4;
              *puVar5 = 0xd;
              puVar5[1] = 10;
              puVar5 = puVar5 + 2;
              wParam = wParam + 1;
            } while ((int)wParam < (int)param_3);
            GlobalUnlock(hMem);
            SetClipboardData(1,hMem);
            CloseClipboard();
          }
        }
        goto LAB_00405895;
      }
    }
LAB_0040573e:
    CVar6 = FUN_00404399(DVar1,param_3,param_4);
  }
  return CVar6;
}



/* Function: FUN_0040589c */

DWORD FUN_0040589c(LPCSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  undefined1 local_24;
  undefined1 local_23;
  undefined2 local_22;
  undefined *local_20;
  undefined *local_1c;
  undefined4 local_18;
  undefined *local_14;
  _SECURITY_ATTRIBUTES local_10;
  
  local_23 = 0;
  local_20 = &DAT_0040837c;
  local_1c = &DAT_0040837c;
  local_10.lpSecurityDescriptor = &local_24;
  local_18 = 0;
  local_10.bInheritHandle = 0;
  local_24 = 1;
  local_22 = 4;
  local_14 = &DAT_0040836c;
  local_10.nLength = 0xc;
  BVar1 = CreateDirectoryA(param_1,&local_10);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
  }
  else {
    DVar2 = 0;
  }
  return DVar2;
}



/* Function: FUN_004058f6 */

DWORD FUN_004058f6(LPCSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  
  BVar1 = CreateDirectoryA(param_1,(LPSECURITY_ATTRIBUTES)0x0);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
  }
  else {
    DVar2 = 0;
  }
  return DVar2;
}



/* Function: FUN_00405913 */

undefined4 FUN_00405913(void)

{
  FARPROC pFVar1;
  int iVar2;
  
  pFVar1 = FUN_004066ba(6);
  if (pFVar1 != (FARPROC)0x0) {
    iVar2 = (*pFVar1)();
    if (iVar2 != 0) {
      return 1;
    }
  }
  return 0;
}



/* Function: FUN_0040592b */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

HANDLE FUN_0040592b(LPSTR param_1)

{
  HANDLE pvVar1;
  _PROCESS_INFORMATION local_14;
  
  _DAT_00422128 = 0x44;
  pvVar1 = (HANDLE)CreateProcessA((LPCSTR)0x0,param_1,(LPSECURITY_ATTRIBUTES)0x0,
                                  (LPSECURITY_ATTRIBUTES)0x0,0,0x4000000,(LPVOID)0x0,(LPCSTR)0x0,
                                  (LPSTARTUPINFOA)&DAT_00422128,&local_14);
  if (pvVar1 != (HANDLE)0x0) {
    CloseHandle(local_14.hThread);
    pvVar1 = local_14.hProcess;
  }
  return pvVar1;
}



/* Function: FUN_0040596e */

void FUN_0040596e(SHELLEXECUTEINFOA *param_1)

{
  param_1->lpIDList = (void *)0x0;
  param_1->cbSize = 0x3c;
  ShellExecuteExA(param_1);
  return;
}



/* Function: SetDlgItemTextA */

BOOL SetDlgItemTextA(HWND hDlg,int nIDDlgItem,LPCSTR lpString)

{
  BOOL BVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00405986. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  BVar1 = SetDlgItemTextA(hDlg,nIDDlgItem,lpString);
  return BVar1;
}



/* Function: FUN_0040598c */

void FUN_0040598c(int param_1,LPSTR param_2)

{
  GetDlgItemTextA(DAT_00423af8,param_1,param_2,0x400);
  return;
}



/* Function: FUN_004059a8 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_004059a8(undefined4 param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = param_2 & 0x1fffff;
  if ((DAT_004243c0 == 0) || (param_2 >> 0x15 == 0)) {
    if (DAT_004243c8 != 0) {
      uVar1 = uVar1 ^ 0x180000;
    }
    _DAT_0040a20c = DAT_00424328;
    _DAT_0040a210 = DAT_00424320;
    _DAT_0040a214 = param_1;
    _DAT_0040a218 = &DAT_00423b20;
    _DAT_0040a21c = uVar1;
    MessageBoxIndirectA((MSGBOXPARAMSA *)&DAT_0040a208);
  }
  return;
}



/* Function: FUN_00405a0c */

undefined4 FUN_00405a0c(LPCSTR param_1,byte param_2)

{
  DWORD dwFileAttributes;
  int iVar1;
  
  dwFileAttributes = FUN_00405e00(param_1);
  if (dwFileAttributes != 0xffffffff) {
    if ((param_2 & 1) == 0) {
      iVar1 = DeleteFileA(param_1);
    }
    else {
      iVar1 = RemoveDirectoryA(param_1);
    }
    if (iVar1 != 0) {
      return 1;
    }
    if ((param_2 & 4) == 0) {
      SetFileAttributesA(param_1,dwFileAttributes);
    }
  }
  return 0;
}



/* Function: FUN_00405a54 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00405a54(LPCSTR param_1,uint param_2)

{
  uint uVar1;
  bool bVar2;
  undefined3 extraout_var;
  BOOL BVar3;
  int iVar4;
  char *pcVar5;
  int iVar6;
  undefined *puVar7;
  CHAR *pCVar8;
  _WIN32_FIND_DATAA local_150;
  int local_10;
  HANDLE local_c;
  uint local_8;
  
  local_8 = param_2 & 4;
  bVar2 = FUN_00405d12(param_1);
  local_10 = CONCAT31(extraout_var,bVar2);
  if ((param_2 & 8) == 0) {
    uVar1 = param_2 & 1;
    if ((uVar1 == 0) || ((local_10 != 0 && ((param_2 & 2) != 0)))) {
      FUN_00406292(&DAT_00421928,param_1);
      if (uVar1 == 0) {
        FUN_00405c6b(param_1);
      }
      else {
        lstrcatA(&DAT_00421928,&DAT_0040a3c4);
      }
      if ((*param_1 != '\0') || (DAT_00421928 == '\\')) {
        lstrcatA(param_1,&DAT_0040a014);
      }
      iVar4 = lstrlenA(param_1);
      local_c = FindFirstFileA(&DAT_00421928,&local_150);
      if (local_c != (HANDLE)0xffffffff) {
        do {
          pCVar8 = local_150.cFileName;
          pcVar5 = (char *)FUN_00405c4f(local_150.cFileName,'?');
          if ((*pcVar5 != '\0') && (local_150.cAlternateFileName[0] != '\0')) {
            pCVar8 = local_150.cAlternateFileName;
          }
          if ((*pCVar8 != '.') ||
             ((pCVar8[1] != '\0' && ((pCVar8[1] != '.' || (pCVar8[2] != '\0')))))) {
            FUN_00406292(param_1 + iVar4,pCVar8);
            if (((byte)local_150.dwFileAttributes & 0x10) == 0) {
              iVar6 = FUN_00405a0c(param_1,(byte)local_8);
              if (iVar6 == 0) {
                if (local_8 == 0) {
                  _DAT_004243a8 = _DAT_004243a8 + 1;
                }
                else {
                  FUN_004053d6(-0xf,param_1);
                  FUN_0040606b(param_1,(LPCSTR)0x0);
                }
              }
              else {
                FUN_004053d6(-0xe,param_1);
              }
            }
            else if (((byte)param_2 & 3) == 3) {
              FUN_00405a54(param_1,param_2);
            }
          }
          BVar3 = FindNextFileA(local_c,&local_150);
        } while (BVar3 != 0);
        FindClose(local_c);
      }
      if (uVar1 != 0) {
        (param_1 + iVar4)[-1] = '\0';
      }
    }
    if (uVar1 != 0) {
      if (local_10 != 0) {
        puVar7 = FUN_00406625(param_1);
        if (puVar7 == (undefined *)0x0) {
          return;
        }
        FUN_00405c24(param_1);
        iVar4 = FUN_00405a0c(param_1,(byte)local_8 | 1);
        if (iVar4 != 0) {
          FUN_004053d6(-0x1b,param_1);
          return;
        }
        if (local_8 != 0) {
          FUN_004053d6(-0xf,param_1);
          FUN_0040606b(param_1,(LPCSTR)0x0);
          return;
        }
      }
      _DAT_004243a8 = _DAT_004243a8 + 1;
    }
  }
  else {
    BVar3 = DeleteFileA(param_1);
    _DAT_004243a8 = _DAT_004243a8 + (uint)(BVar3 == 0);
  }
  return;
}



/* Function: FUN_00405c24 */

LPCSTR FUN_00405c24(LPCSTR param_1)

{
  int iVar1;
  LPSTR pCVar2;
  
  iVar1 = lstrlenA(param_1);
  pCVar2 = CharPrevA(param_1,param_1 + iVar1);
  if (*pCVar2 != '\\') {
    lstrcatA(param_1,&DAT_0040a014);
  }
  return param_1;
}



/* Function: FUN_00405c4f */

void FUN_00405c4f(LPCSTR param_1,char param_2)

{
  for (; (*param_1 != '\0' && (*param_1 != param_2)); param_1 = CharNextA(param_1)) {
  }
  return;
}



/* Function: FUN_00405c6b */

LPCSTR FUN_00405c6b(LPCSTR param_1)

{
  int iVar1;
  LPCSTR lpszCurrent;
  
  iVar1 = lstrlenA(param_1);
  lpszCurrent = param_1 + iVar1;
  do {
    if (*lpszCurrent == '\\') break;
    lpszCurrent = CharPrevA(param_1,lpszCurrent);
  } while (param_1 < lpszCurrent);
  *lpszCurrent = '\0';
  return lpszCurrent + 1;
}



/* Function: FUN_00405c91 */

undefined4 FUN_00405c91(byte *param_1)

{
  byte bVar1;
  undefined4 uVar2;
  
  bVar1 = *param_1 | 0x20;
  if (((*param_1 == 0x5c) && (param_1[1] == 0x5c)) ||
     (('`' < (char)bVar1 && (((char)bVar1 < '{' && (param_1[1] == 0x3a)))))) {
    uVar2 = 1;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



/* Function: FUN_00405cbd */

char * FUN_00405cbd(LPCSTR param_1)

{
  LPSTR lpsz;
  char *pcVar1;
  int iVar2;
  
  lpsz = CharNextA(param_1);
  pcVar1 = CharNextA(lpsz);
  if (((*param_1 == '\0') || (*lpsz != ':')) || (lpsz[1] != '\\')) {
    if ((*param_1 == '\\') && (param_1[1] == '\\')) {
      iVar2 = 2;
      do {
        iVar2 = iVar2 + -1;
        pcVar1 = (char *)FUN_00405c4f(pcVar1,'\\');
        if (*pcVar1 == '\0') goto LAB_00405d0a;
        pcVar1 = pcVar1 + 1;
      } while (iVar2 != 0);
    }
    else {
LAB_00405d0a:
      pcVar1 = (char *)0x0;
    }
  }
  else {
    pcVar1 = CharNextA(pcVar1);
  }
  return pcVar1;
}



/* Function: FUN_00405d12 */

bool FUN_00405d12(LPCSTR param_1)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  DWORD DVar4;
  
  FUN_00406292(&DAT_00421d28,param_1);
  pbVar1 = (byte *)FUN_00405cbd(&DAT_00421d28);
  if ((pbVar1 != (byte *)0x0) &&
     ((FUN_0040658c(pbVar1), ((byte)DAT_00424338 & 0x80) == 0 ||
      ((*pbVar1 != 0 && (*pbVar1 != 0x5c)))))) {
    while( true ) {
      iVar3 = lstrlenA(&DAT_00421d28);
      if (iVar3 <= (int)(pbVar1 + -0x421d28)) {
        FUN_00405c24(&DAT_00421d28);
        DVar4 = GetFileAttributesA(&DAT_00421d28);
        return DVar4 != 0xffffffff;
      }
      pbVar2 = FUN_00406625(&DAT_00421d28);
      if ((pbVar2 != (byte *)0x0) && ((*pbVar2 & 0x10) == 0)) break;
      FUN_00405c6b(&DAT_00421d28);
    }
  }
  return false;
}



/* Function: FUN_00405d8a */

LPCSTR FUN_00405d8a(LPSTR param_1,LPCSTR param_2)

{
  CHAR CVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = lstrlenA(param_2);
  while( true ) {
    iVar3 = lstrlenA(param_1);
    if (iVar3 < iVar2) {
      return (LPCSTR)0x0;
    }
    CVar1 = param_1[iVar2];
    param_1[iVar2] = '\0';
    iVar3 = lstrcmpiA(param_1,param_2);
    param_1[iVar2] = CVar1;
    if (iVar3 == 0) break;
    param_1 = CharNextA(param_1);
  }
  return param_1;
}



/* Function: FUN_00405de0 */

void FUN_00405de0(undefined1 *param_1,int param_2,int param_3)

{
  int iVar1;
  
  if (param_3 != 0) {
    iVar1 = param_2 - (int)param_1;
    do {
      *param_1 = param_1[iVar1];
      param_1 = param_1 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return;
}



/* Function: FUN_00405e00 */

DWORD FUN_00405e00(LPCSTR param_1)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesA(param_1);
  if (DVar1 != 0xffffffff) {
    SetFileAttributesA(param_1,DVar1 & 0xfffffffe);
  }
  return DVar1;
}



/* Function: FUN_00405e25 */

void FUN_00405e25(LPCSTR param_1,DWORD param_2,DWORD param_3)

{
  DWORD DVar1;
  
  DVar1 = GetFileAttributesA(param_1);
  CreateFileA(param_1,param_2,1,(LPSECURITY_ATTRIBUTES)0x0,param_3,
              -(uint)(DVar1 != 0xffffffff) & DVar1,(HANDLE)0x0);
  return;
}



/* Function: FUN_00405e54 */

LPSTR FUN_00405e54(LPSTR param_1,LPCSTR param_2)

{
  char cVar1;
  LPSTR lpTempFileName;
  DWORD DVar2;
  UINT UVar3;
  int iVar4;
  
  lpTempFileName = param_1;
  iVar4 = 100;
  do {
    iVar4 = iVar4 + -1;
    param_1 = DAT_0040a3cc;
    DVar2 = GetTickCount();
    cVar1 = param_1._2_1_ + (char)(DVar2 % 0x1a);
    param_1._0_3_ = CONCAT12(cVar1,param_1._0_2_);
    UVar3 = GetTempFileNameA(param_2,(LPCSTR)&param_1,0,lpTempFileName);
    if (UVar3 != 0) {
      return lpTempFileName;
    }
  } while (iVar4 != 0);
  *lpTempFileName = '\0';
  return (LPSTR)0x0;
}



/* Function: FUN_00405e9d */

undefined4 FUN_00405e9d(HANDLE param_1,LPVOID param_2,DWORD param_3)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  
  DVar1 = param_3;
  BVar2 = ReadFile(param_1,param_2,param_3,&param_3,(LPOVERLAPPED)0x0);
  if ((BVar2 == 0) || (DVar1 != param_3)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



/* Function: FUN_00405ecc */

undefined4 FUN_00405ecc(HANDLE param_1,LPCVOID param_2,DWORD param_3)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  
  DVar1 = param_3;
  BVar2 = WriteFile(param_1,param_2,param_3,&param_3,(LPOVERLAPPED)0x0);
  if ((BVar2 == 0) || (DVar1 != param_3)) {
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



/* Function: FUN_00405efb */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_00405efb(LPCSTR param_1,LPCSTR param_2)

{
  HANDLE pvVar1;
  DWORD DVar2;
  int iVar3;
  LPCSTR pCVar4;
  LPSTR hMem;
  int iVar5;
  LPCSTR pCVar6;
  LPCSTR pCVar7;
  CHAR *pCVar8;
  LPSTR pCVar9;
  
  _DAT_004226b0 = 0x4c554e;
  if (param_2 != (LPCSTR)0x0) {
    pvVar1 = (HANDLE)FUN_00405e25(param_2,0,1);
    CloseHandle(pvVar1);
    DVar2 = GetShortPathNameA(param_2,&DAT_004226b0,0x400);
    if (DVar2 == 0) {
      return;
    }
    if (0x400 < (int)DVar2) {
      return;
    }
  }
  DVar2 = GetShortPathNameA(param_1,&DAT_00422ab0,0x400);
  if ((DVar2 != 0) && ((int)DVar2 < 0x401)) {
    iVar3 = wsprintfA(&DAT_004222b0,s__s__s_0040a3e0,&DAT_004226b0,&DAT_00422ab0);
    FUN_00406325(&DAT_00422ab0,*(int *)(DAT_00424330 + 0x128));
    pvVar1 = (HANDLE)FUN_00405e25(&DAT_00422ab0,0xc0000000,4);
    if (pvVar1 != (HANDLE)0xffffffff) {
      pCVar4 = (LPCSTR)GetFileSize(pvVar1,(LPDWORD)0x0);
      hMem = (LPSTR)GlobalAlloc(0x40,(SIZE_T)(pCVar4 + iVar3 + 10));
      if ((hMem != (LPSTR)0x0) && (iVar5 = FUN_00405e9d(pvVar1,hMem,(DWORD)pCVar4), iVar5 != 0)) {
        pCVar6 = FUN_00405d8a(hMem,s__Rename__0040a3d4);
        if (pCVar6 == (LPCSTR)0x0) {
          lstrcpyA(hMem + (int)pCVar4,s__Rename__0040a3d4);
          pCVar4 = pCVar4 + 10;
          pCVar6 = pCVar4;
        }
        else {
          pCVar7 = FUN_00405d8a(pCVar6 + 10,&DAT_0040a3d0);
          pCVar6 = pCVar4;
          if (pCVar7 != (LPCSTR)0x0) {
            pCVar9 = hMem + (int)pCVar4;
            pCVar8 = pCVar9 + iVar3;
            for (; pCVar7 < pCVar9; pCVar9 = pCVar9 + -1) {
              *pCVar8 = *pCVar9;
              pCVar8 = pCVar8 + -1;
            }
            pCVar6 = pCVar7 + (1 - (int)hMem);
          }
        }
        FUN_00405de0(hMem + (int)pCVar6,0x4222b0,iVar3);
        SetFilePointer(pvVar1,0,(PLONG)0x0,0);
        FUN_00405ecc(pvVar1,hMem,(DWORD)(pCVar4 + iVar3));
        GlobalFree(hMem);
      }
      CloseHandle(pvVar1);
    }
  }
  return;
}



/* Function: FUN_0040606b */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0040606b(LPCSTR param_1,LPCSTR param_2)

{
  BOOL BVar1;
  
  BVar1 = MoveFileExA(param_1,param_2,5);
  if (BVar1 == 0) {
    FUN_00405efb(param_1,param_2);
  }
  _DAT_004243b0 = _DAT_004243b0 + 1;
  return;
}



/* Function: FUN_00406097 */

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint FUN_00406097(uint param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar1 = *param_2;
  uVar3 = (-(uint)(DAT_004243dc < '\0') & 0xffffff00) + 0x100;
  if (((uVar1 & 0x20) == 0) || ((param_1 & 0x60000000) == 0)) {
    if ((uVar1 & 0x100000) != 0) {
      uVar1 = uVar1 | _DAT_004243d0;
    }
  }
  else {
    uVar2 = param_1 >> 0x15 & 0x300;
    if (uVar2 == 0x300) {
      uVar2 = ~uVar3 & _DAT_004243d0;
    }
    uVar1 = (uVar1 & 0xfffffeff | uVar2) & 0xfffffdff;
    param_1 = param_1 & 0x9fffffff;
  }
  *param_2 = uVar1 & 0xffefffdf;
  return ~-(uint)((uVar1 & uVar3) != 0) & param_1;
}



/* Function: FUN_00406118 */

LSTATUS FUN_00406118(uint param_1,LPCSTR param_2,REGSAM param_3,PHKEY param_4)

{
  HKEY hKey;
  LSTATUS LVar1;
  
  hKey = (HKEY)FUN_00406097(param_1,&param_3);
  if (hKey == (HKEY)0x0) {
    LVar1 = 6;
  }
  else {
    LVar1 = RegOpenKeyExA(hKey,param_2,0,param_3,param_4);
  }
  return LVar1;
}



/* Function: FUN_00406146 */

LSTATUS FUN_00406146(uint param_1,LPCSTR param_2,REGSAM param_3,PHKEY param_4)

{
  HKEY hKey;
  LSTATUS LVar1;
  
  hKey = (HKEY)FUN_00406097(param_1,&param_3);
  if (hKey == (HKEY)0x0) {
    LVar1 = 6;
  }
  else {
    LVar1 = RegCreateKeyExA(hKey,param_2,0,(LPSTR)0x0,0,param_3,(LPSECURITY_ATTRIBUTES)0x0,param_4,
                            (LPDWORD)0x0);
  }
  return LVar1;
}



/* Function: FUN_00406179 */

void FUN_00406179(uint param_1,LPCSTR param_2,LPCSTR param_3,LPBYTE param_4,HKEY param_5)

{
  LPBYTE pBVar1;
  LSTATUS LVar2;
  DWORD local_8;
  
  local_8 = 0x400;
  LVar2 = FUN_00406118(param_1,param_2,-(uint)(param_5 != (HKEY)0x0) & 0x100 | 0x20019,&param_5);
  pBVar1 = param_4;
  if (LVar2 == 0) {
    LVar2 = RegQueryValueExA(param_5,param_3,(LPDWORD)0x0,(LPDWORD)&param_2,param_4,&local_8);
    RegCloseKey(param_5);
    pBVar1[0x3ff] = '\0';
    if (LVar2 == 0) {
      if (param_2 == (LPCSTR)0x1) {
        return;
      }
      if (param_2 == (LPCSTR)0x2) {
        return;
      }
    }
  }
  *pBVar1 = '\0';
  return;
}



/* Function: FUN_004061f0 */

void FUN_004061f0(LPSTR param_1,undefined4 param_2)

{
  wsprintfA(param_1,"%d",param_2);
  return;
}



/* Function: FUN_00406209 */

int FUN_00406209(byte *param_1)

{
  byte bVar1;
  char cVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  char cVar6;
  int iVar7;
  int local_8;
  
  iVar7 = 0;
  local_8 = 1;
  cVar2 = '\n';
  cVar6 = '9';
  if (*param_1 == 0x2d) {
    param_1 = param_1 + 1;
    local_8 = -1;
  }
  pbVar3 = param_1;
  if (*param_1 == 0x30) {
    pbVar3 = param_1 + 1;
    bVar1 = *pbVar3;
    if (('/' < (char)bVar1) && ((char)bVar1 < '8')) {
      cVar2 = '\b';
      cVar6 = '7';
    }
    if ((bVar1 & 0xdf) == 0x58) {
      cVar2 = '\x10';
      pbVar3 = param_1 + 2;
    }
  }
  do {
    uVar4 = (uint)(char)*pbVar3;
    pbVar3 = pbVar3 + 1;
    if (((int)uVar4 < 0x30) || ((int)cVar6 < (int)uVar4)) {
      if ((cVar2 != '\x10') ||
         (((int)(uVar4 & 0xffffffdf) < 0x41 || (0x46 < (int)(uVar4 & 0xffffffdf))))) {
        return local_8 * iVar7;
      }
      iVar5 = (uVar4 & 7) + 9;
    }
    else {
      iVar5 = uVar4 - 0x30;
    }
    iVar7 = cVar2 * iVar7 + iVar5;
  } while( true );
}



/* Function: FUN_00406292 */

void FUN_00406292(LPSTR param_1,LPCSTR param_2)

{
  lstrcpynA(param_1,param_2,0x400);
  return;
}



/* Function: lstrlenA */

int lstrlenA(LPCSTR lpString)

{
  int iVar1;
  
                    /* WARNING: Could not recover jumptable at 0x004062a8. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  iVar1 = lstrlenA(lpString);
  return iVar1;
}



/* Function: lstrcatA */

LPSTR lstrcatA(LPSTR lpString1,LPCSTR lpString2)

{
  LPSTR pCVar1;
  
                    /* WARNING: Could not recover jumptable at 0x004062ae. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  pCVar1 = lstrcatA(lpString1,lpString2);
  return pCVar1;
}



/* Function: FUN_004062b4 */

void __cdecl FUN_004062b4(LPCWSTR param_1,LPSTR param_2,int param_3)

{
  WideCharToMultiByte(0,0,param_1,-1,param_2,param_3,(LPCSTR)0x0,(LPBOOL)0x0);
  return;
}



/* Function: FUN_004062cf */

void __cdecl FUN_004062cf(LPSTR param_1,LPCWSTR param_2)

{
  FUN_004062b4(param_2,param_1,0x400);
  return;
}



/* Function: FUN_004062e5 */

HRESULT __cdecl FUN_004062e5(int param_1,LPIID param_2)

{
  char cVar1;
  HRESULT HVar2;
  char cVar3;
  OLECHAR local_108 [130];
  
  cVar3 = '\0';
  do {
    cVar1 = *(char *)(cVar3 + param_1);
    local_108[cVar3] = (short)cVar1;
    if (cVar1 == '\0') {
      HVar2 = IIDFromString(local_108,param_2);
      return HVar2;
    }
    cVar3 = cVar3 + '\x01';
  } while (-1 < cVar3);
  return -0x7fffbffb;
}



/* Function: FUN_00406325 */

void FUN_00406325(byte *param_1,int param_2)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  byte *pbVar4;
  uint uVar5;
  FARPROC pFVar6;
  LPCITEMIDLIST pidl;
  BOOL BVar7;
  int iVar8;
  byte *pbVar9;
  uint uVar10;
  byte *lpBuffer;
  uint local_1c [4];
  int local_c;
  byte *local_8;
  
  pbVar4 = param_1;
  if (param_2 < 0) {
    param_2 = *(int *)(DAT_00423afc - (param_2 * 4 + 4));
  }
  pbVar9 = (byte *)(DAT_00424358 + param_2);
  lpBuffer = &DAT_004232c0;
  if (((byte *)0x4232bf < param_1) && (param_1 + -0x4232c0 < (byte *)0x800)) {
    param_1 = (byte *)0x0;
    lpBuffer = pbVar4;
  }
  do {
    while( true ) {
      bVar3 = *pbVar9;
      if ((bVar3 == 0) || (0x3ff < (int)(lpBuffer + -0x4232c0))) {
        *lpBuffer = 0;
        if (param_1 != (byte *)0x0) {
          FUN_00406292((LPSTR)param_1,&DAT_004232c0);
        }
        return;
      }
      local_8 = pbVar9 + 1;
      if (bVar3 < 4) break;
      if (bVar3 == 4) {
        *lpBuffer = *local_8;
        lpBuffer = lpBuffer + 1;
        pbVar9 = pbVar9 + 2;
      }
      else {
        *lpBuffer = bVar3;
        lpBuffer = lpBuffer + 1;
        pbVar9 = local_8;
      }
    }
    bVar1 = pbVar9[2];
    uVar5 = (uint)(char)bVar1;
    bVar2 = *local_8;
    local_1c[1] = (uint)(char)bVar2;
    uVar10 = (uVar5 & 0x7f) << 7 | local_1c[1] & 0x7f;
    local_1c[0] = CONCAT22((char)bVar2 >> 7,(short)(char)bVar2) | 0x8000;
    local_1c[2] = CONCAT22((char)bVar1 >> 7,(short)(char)bVar1) | 0x8000;
    local_1c[3] = uVar5;
    local_8 = pbVar9 + 3;
    if (bVar3 == 2) {
      param_2 = 2;
      if ((((DAT_004243dc == '\0') && (DAT_004243de < 0x45a)) && (uVar5 != 0x23)) && (uVar5 != 0x2e)
         ) {
        local_c = 0;
      }
      else {
        local_c = 1;
      }
      if (DAT_004243a4 != 0) {
        param_2 = 4;
      }
      if ((char)bVar2 < '\0') {
        FUN_00406179(0x80000002,"Software\\Microsoft\\Windows\\CurrentVersion",
                     (LPCSTR)((local_1c[1] & 0x3f) + DAT_00424358),lpBuffer,
                     (HKEY)(local_1c[1] & 0x40));
        if (*lpBuffer == 0) {
          FUN_00406325(lpBuffer,uVar5);
          goto LAB_004064e8;
        }
LAB_004064ed:
        if (local_1c[3] == 0x1a) {
          lstrcatA((LPSTR)lpBuffer,"\\Microsoft\\Internet Explorer\\Quick Launch");
        }
      }
      else {
        if (local_1c[1] == 0x25) {
          GetSystemDirectoryA((LPSTR)lpBuffer,0x400);
        }
        else {
          if (local_1c[1] == 0x24) {
            GetWindowsDirectoryA((LPSTR)lpBuffer,0x400);
            param_2 = 0;
          }
          while (param_2 != 0) {
            param_2 = param_2 + -1;
            uVar5 = local_1c[param_2];
            if (((DAT_00424324 != (code *)0x0) && (local_c != 0)) &&
               (iVar8 = (*DAT_00424324)(DAT_00424328,uVar5 & 0xffffffbf,0,0,lpBuffer), iVar8 == 0))
            break;
            pFVar6 = FUN_004066ba(7);
            pidl = (LPCITEMIDLIST)(*pFVar6)(DAT_00424328,uVar5 & 0xbf,uVar5 & 0x8000);
            if (pidl != (LPCITEMIDLIST)0x0) {
              BVar7 = SHGetPathFromIDListA(pidl,(LPSTR)lpBuffer);
              CoTaskMemFree(pidl);
              if (BVar7 != 0) break;
            }
            *lpBuffer = 0;
          }
        }
LAB_004064e8:
        if (*lpBuffer != 0) goto LAB_004064ed;
      }
LAB_004064fe:
      FUN_0040658c(lpBuffer);
    }
    else if (bVar3 == 3) {
      if (uVar10 == 0x1d) {
        FUN_004061f0((LPSTR)lpBuffer,DAT_00424328);
      }
      else {
        FUN_00406292((LPSTR)lpBuffer,&DAT_00425000 + uVar10 * 0x400);
      }
      if (uVar10 - 0x15 < 7) goto LAB_004064fe;
    }
    else if (bVar3 == 1) {
      FUN_00406325(lpBuffer,-1 - uVar10);
    }
    iVar8 = lstrlenA((LPCSTR)lpBuffer);
    lpBuffer = lpBuffer + iVar8;
    pbVar9 = local_8;
  } while( true );
}



/* Function: FUN_0040658c */

void FUN_0040658c(byte *param_1)

{
  byte bVar1;
  int iVar2;
  char *pcVar3;
  LPSTR pCVar4;
  byte *lpsz;
  byte *lpsz_00;
  
  if ((((*param_1 == 0x5c) && (param_1[1] == 0x5c)) && (param_1[2] == 0x3f)) && (param_1[3] == 0x5c)
     ) {
    param_1 = param_1 + 4;
  }
  if ((*param_1 != 0) && (iVar2 = FUN_00405c91(param_1), iVar2 != 0)) {
    param_1 = param_1 + 2;
  }
  bVar1 = *param_1;
  lpsz_00 = param_1;
  lpsz = param_1;
  while (bVar1 != 0) {
    if ((0x1f < bVar1) &&
       (pcVar3 = (char *)FUN_00405c4f(s____<>____0040a3e8,bVar1), *pcVar3 == '\0')) {
      pCVar4 = CharNextA((LPCSTR)lpsz_00);
      FUN_00405de0(lpsz,(int)lpsz_00,(int)pCVar4 - (int)lpsz_00);
      lpsz = (byte *)CharNextA((LPCSTR)lpsz);
    }
    lpsz_00 = (byte *)CharNextA((LPCSTR)lpsz_00);
    bVar1 = *lpsz_00;
  }
  *lpsz = 0;
  while( true ) {
    lpsz = (byte *)CharPrevA((LPCSTR)param_1,(LPCSTR)lpsz);
    if ((*lpsz != 0x20) && (*lpsz != 0x5c)) break;
    *lpsz = 0;
    if (lpsz <= param_1) {
      return;
    }
  }
  return;
}



/* Function: FUN_00406625 */

undefined * FUN_00406625(LPCSTR param_1)

{
  HANDLE hFindFile;
  undefined *puVar1;
  
  hFindFile = FindFirstFileA(param_1,(LPWIN32_FIND_DATAA)&DAT_00422170);
  if (hFindFile == (HANDLE)0xffffffff) {
    puVar1 = (undefined *)0x0;
  }
  else {
    FindClose(hFindFile);
    puVar1 = &DAT_00422170;
  }
  return puVar1;
}



/* Function: FUN_0040664c */

void FUN_0040664c(undefined4 param_1)

{
  UINT UVar1;
  int iVar2;
  CHAR local_124 [288];
  
  UVar1 = GetSystemDirectoryA(local_124,0x104);
  if (0x104 < UVar1) {
    UVar1 = 0;
  }
  if ((UVar1 == 0) || (local_124[UVar1 - 1] == '\\')) {
    iVar2 = 1;
  }
  else {
    iVar2 = 0;
  }
  wsprintfA(local_124 + UVar1,s__s_s_dll_0040a3f4,&DAT_0040a014 + iVar2,param_1);
  LoadLibraryExA(local_124,(HANDLE)0x0,8);
  return;
}



/* Function: FUN_004066ba */

FARPROC FUN_004066ba(int param_1)

{
  LPCSTR lpModuleName;
  HMODULE hModule;
  FARPROC pFVar1;
  
  lpModuleName = (&PTR_s_KERNEL32_0040a230)[param_1 * 2];
  hModule = GetModuleHandleA(lpModuleName);
  if ((hModule == (HMODULE)0x0) &&
     (hModule = (HMODULE)FUN_0040664c(lpModuleName), hModule == (HMODULE)0x0)) {
    return (FARPROC)0x0;
  }
  pFVar1 = GetProcAddress(hModule,(&PTR_s_SetDefaultDllDirectories_0040a234)[param_1 * 2]);
  return pFVar1;
}



/* Function: FUN_004066f6 */

void FUN_004066f6(UINT param_1)

{
  BOOL BVar1;
  MSG local_20;
  
  while( true ) {
    BVar1 = PeekMessageA(&local_20,(HWND)0x0,param_1,param_1,1);
    if (BVar1 == 0) break;
    DispatchMessageA(&local_20);
  }
  return;
}



/* Function: GetProcAddress */

FARPROC GetProcAddress(HMODULE hModule,LPCSTR lpProcName)

{
  FARPROC pFVar1;
  
                    /* WARNING: Could not recover jumptable at 0x00406729. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  pFVar1 = GetProcAddress(hModule,lpProcName);
  return pFVar1;
}



/* Function: FUN_0040672f */

DWORD FUN_0040672f(HANDLE param_1)

{
  DWORD DVar1;
  DWORD local_8;
  
  DVar1 = WaitForSingleObject(param_1,100);
  while (DVar1 == 0x102) {
    FUN_004066f6(0xf);
    DVar1 = WaitForSingleObject(param_1,100);
  }
  GetExitCodeProcess(param_1,&local_8);
  return local_8;
}



/* Function: FUN_00406771 */

uint FUN_00406771(uint param_1,byte *param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  
  if (DAT_00422eb4 == 0) {
    uVar2 = 0;
    do {
      iVar3 = 8;
      uVar1 = uVar2;
      do {
        uVar1 = uVar1 >> 1 ^ -(uint)((uVar1 & 1) != 0) & 0xedb88320;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
      (&DAT_00422eb0)[uVar2] = uVar1;
      uVar2 = uVar2 + 1;
    } while ((int)uVar2 < 0x100);
  }
  uVar2 = ~param_1;
  if (param_3 != 0) {
    do {
      uVar2 = uVar2 >> 8 ^ (&DAT_00422eb0)[uVar2 & 0xff ^ (uint)*param_2];
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return ~uVar2;
}



/* Function: FUN_004067df */

void __fastcall FUN_004067df(int param_1)

{
  int iVar1;
  
  iVar1 = 0x80;
  do {
    iVar1 = iVar1 + -1;
    *(undefined1 *)(iVar1 + param_1) = 0;
  } while (iVar1 != 0);
  *(undefined4 *)(param_1 + 0x78) = 0xffffffff;
  *(undefined4 *)(param_1 + 0x68) = 1;
  *(undefined4 *)(param_1 + 100) = 1;
  *(undefined4 *)(param_1 + 0x60) = 1;
  *(undefined4 *)(param_1 + 0x5c) = 1;
  return;
}



/* Function: FUN_004067ff */

undefined4 __fastcall FUN_004067ff(SIZE_T *param_1)

{
  byte bVar1;
  ushort uVar2;
  ulonglong uVar3;
  SIZE_T dwBytes;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  ushort *puVar11;
  SIZE_T *pSVar12;
  SIZE_T *pSVar13;
  bool bVar14;
  SIZE_T local_8c [5];
  uint local_78;
  byte *local_74;
  int local_70;
  byte *local_6c;
  int local_68;
  uint local_64;
  byte local_60;
  byte local_5f;
  ushort *local_5c;
  ushort *local_58;
  int local_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  undefined4 local_40;
  int local_3c;
  int local_38;
  int local_34;
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  uint local_10;
  HGLOBAL local_c;
  HGLOBAL local_8;
  
  pSVar12 = param_1;
  pSVar13 = local_8c;
  for (iVar9 = 0x22; iVar9 != 0; iVar9 = iVar9 + -1) {
    *pSVar13 = *pSVar12;
    pSVar12 = pSVar12 + 1;
    pSVar13 = pSVar13 + 1;
  }
  uVar10 = local_48;
  puVar11 = local_58;
  if (local_34 == -1) {
    return 1;
  }
LAB_00406832:
  do {
    uVar6 = local_24;
    uVar8 = local_30;
    pbVar5 = local_6c;
    pbVar4 = local_74;
    switch(local_8c[0]) {
    case 0:
      if (local_70 == 0) goto LAB_00407234;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      bVar1 = *pbVar4;
      if (0xe1 < bVar1) {
        return 0xffffffff;
      }
      uVar3 = (ulonglong)((uint)bVar1 % 0x2d) % 9;
      local_40 = (int)uVar3;
      local_20 = (1 << bVar1 / 0x2d) - 1;
      local_1c = (1 << (sbyte)((ulonglong)((uint)bVar1 % 0x2d) / 9)) - 1;
      iVar9 = (0x300 << (char)uVar3 + bVar1 / 0x2d) + 0x736;
      dwBytes = iVar9 * 2;
      if (dwBytes != local_8c[4]) {
        if (local_8 != (HGLOBAL)0x0) {
          GlobalFree(local_8);
        }
        local_8 = GlobalAlloc(0x40,dwBytes);
        if (local_8 == (HGLOBAL)0x0) {
          return 0xffffffff;
        }
        local_8c[4] = dwBytes;
      }
      while (iVar9 != 0) {
        iVar9 = iVar9 + -1;
        *(undefined2 *)((int)local_8 + iVar9 * 2) = 0x400;
      }
      local_44 = 0;
      for (local_4c = 0; (int)local_4c < 4; local_4c = local_4c + 1) {
switchD_00406841_caseD_1:
        if (local_70 == 0) {
          local_8c[0] = 1;
          goto LAB_00407234;
        }
        local_70 = local_70 + -1;
        local_44 = local_44 | (uint)*local_74 << ((byte)(local_4c << 3) & 0x1f);
        local_74 = local_74 + 1;
      }
      if (local_44 != local_78) {
        local_78 = local_44;
        if (local_c != (HGLOBAL)0x0) {
          GlobalFree(local_c);
        }
        local_c = GlobalAlloc(0x40,local_44);
        if (local_c == (HGLOBAL)0x0) {
          return 0xffffffff;
        }
      }
      local_4c = 5;
      *(undefined1 *)((int)local_c + (local_78 - 1)) = 0;
      while (uVar8 = local_4c, local_4c = local_4c - 1, uVar8 != 0) {
switchD_00406841_caseD_3:
        if (local_70 == 0) {
          local_8c[0] = 3;
          goto LAB_00407234;
        }
        local_70 = local_70 + -1;
        bVar1 = *local_74;
        local_74 = local_74 + 1;
        local_10 = local_10 << 8 | (uint)bVar1;
      }
    case 2:
      local_8c[1] = 6;
      local_50 = local_64 & local_20;
      puVar11 = (ushort *)((int)local_8 + (local_3c * 0x10 + (local_64 & local_20)) * 2);
      break;
    case 1:
      goto switchD_00406841_caseD_1;
    case 3:
      goto switchD_00406841_caseD_3;
    case 4:
      goto switchD_00406841_caseD_4;
    case 5:
      goto switchD_00406841_caseD_5;
    case 6:
      if (local_44 != 0) {
        local_38 = 1;
        local_8c[1] = 7;
        puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x180);
        break;
      }
      local_5c = (ushort *)
                 (((uint)(local_60 >> (8 - (byte)local_40 & 0x1f)) +
                  ((local_64 & local_1c) << ((byte)local_40 & 0x1f))) * 0x600 + 0xe6c + (int)local_8
                 );
      if (local_3c < 4) {
        local_3c = 0;
      }
      else if (local_3c < 10) {
        local_3c = local_3c + -3;
      }
      else {
        local_3c = local_3c + -6;
      }
      if (local_38 != 0) {
        uVar8 = local_18 - local_30;
        if (local_78 <= uVar8) {
          uVar8 = uVar8 + local_78;
        }
        uVar10 = 1;
        local_5f = *(byte *)(uVar8 + (int)local_c);
        do {
          bVar1 = local_5f;
          local_5f = local_5f << 1;
          local_4c = (uint)(bVar1 >> 7);
          puVar11 = local_5c + ((bVar1 >> 7) + 1) * 0x100 + uVar10;
          uVar2 = *puVar11;
          local_58 = puVar11;
          uVar8 = (local_14 >> 0xb) * (uint)uVar2;
          bVar14 = uVar8 <= local_10;
          if (bVar14) {
            local_14 = local_14 - uVar8;
            local_10 = local_10 - uVar8;
            local_44 = 1;
            uVar10 = uVar10 * 2 + 1;
            *puVar11 = uVar2 - (uVar2 >> 5);
          }
          else {
            local_44 = 0;
            local_14 = uVar8;
            uVar10 = uVar10 * 2;
            *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
          }
          local_44 = (uint)bVar14;
          local_48 = uVar10;
          if (local_14 < 0x1000000) {
switchD_00406841_caseD_d:
            if (local_70 == 0) {
              local_8c[0] = 0xd;
              goto LAB_00407234;
            }
            local_14 = local_14 << 8;
            bVar1 = *local_74;
            local_70 = local_70 + -1;
            local_74 = local_74 + 1;
            local_10 = local_10 << 8 | (uint)bVar1;
          }
          if (local_4c != local_44) goto LAB_00406b25;
        } while ((int)uVar10 < 0x100);
        goto LAB_00406b89;
      }
      uVar10 = 1;
      do {
        puVar11 = local_5c + uVar10;
        uVar2 = *puVar11;
        local_58 = puVar11;
        uVar8 = (local_14 >> 0xb) * (uint)uVar2;
        if (local_10 < uVar8) {
          local_14 = uVar8;
          uVar10 = uVar10 * 2;
          *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
        }
        else {
          local_14 = local_14 - uVar8;
          local_10 = local_10 - uVar8;
          uVar10 = uVar10 * 2 + 1;
          *puVar11 = uVar2 - (uVar2 >> 5);
        }
        local_48 = uVar10;
        if (local_14 < 0x1000000) {
switchD_00406841_caseD_f:
          if (local_70 == 0) {
            local_8c[0] = 0xf;
            goto LAB_00407234;
          }
          local_14 = local_14 << 8;
          bVar1 = *local_74;
          local_70 = local_70 + -1;
          local_74 = local_74 + 1;
          local_10 = local_10 << 8 | (uint)bVar1;
        }
      } while ((int)uVar10 < 0x100);
      goto LAB_00406b8d;
    case 7:
      if (local_44 != 1) {
        local_8c[2] = 0x16;
        local_24 = local_28;
        local_28 = local_2c;
        local_2c = local_30;
        local_3c = ((6 < local_3c) - 1 & 0xfffffffd) + 10;
        local_5c = (ushort *)((int)local_8 + 0x664);
        goto switchD_00406841_caseD_11;
      }
      local_8c[1] = 8;
      puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x198);
      break;
    case 8:
      if (local_44 == 0) {
        local_8c[1] = 9;
        puVar11 = (ushort *)((int)local_8 + ((local_3c + 0xf) * 0x10 + local_50) * 2);
      }
      else {
        local_8c[1] = 10;
        puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x1b0);
      }
      break;
    case 9:
      if (local_44 != 0) goto LAB_00406db5;
      if (local_64 == 0) {
        return 0xffffffff;
      }
      local_3c = (uint)(6 < local_3c) * 2 + 9;
    case 0x1b:
      if (local_68 == 0) {
        local_8c[0] = 0x1b;
        goto LAB_00407234;
      }
      uVar8 = local_18 - local_30;
      if (local_78 <= uVar8) {
        uVar8 = uVar8 + local_78;
      }
      local_60 = *(byte *)(uVar8 + (int)local_c);
      *(byte *)(local_18 + (int)local_c) = local_60;
      local_64 = local_64 + 1;
      local_6c = local_6c + 1;
      local_68 = local_68 + -1;
      *pbVar5 = local_60;
      goto LAB_00406d59;
    case 10:
      if (local_44 == 0) goto LAB_00406dac;
      local_8c[1] = 0xb;
      puVar11 = (ushort *)((int)local_8 + local_3c * 2 + 0x1c8);
      break;
    case 0xb:
      uVar7 = local_28;
      if (local_44 != 0) {
        local_24 = local_28;
        uVar7 = uVar6;
      }
      local_28 = local_2c;
      local_2c = uVar7;
LAB_00406dac:
      local_30 = local_2c;
      local_2c = uVar8;
LAB_00406db5:
      local_8c[2] = 0x15;
      local_5c = (ushort *)((int)local_8 + 0xa68);
    case 0x11:
switchD_00406841_caseD_11:
      local_8c[1] = 0x12;
      puVar11 = local_5c;
      break;
    case 0xc:
      while (local_70 != 0) {
        local_14 = local_14 << 8;
        bVar1 = *local_74;
        local_70 = local_70 + -1;
        local_74 = local_74 + 1;
        local_10 = local_10 << 8 | (uint)bVar1;
        uVar8 = local_30;
        do {
          local_4c = local_4c - 1;
LAB_00406e7d:
          if ((int)local_4c < 1) {
            local_44 = 4;
            local_30 = uVar8 + uVar10 * 0x10;
            local_5c = (ushort *)((int)local_8 + 0x644);
            goto LAB_00406ec1;
          }
          uVar10 = uVar10 * 2;
          local_14 = local_14 >> 1;
          local_48 = uVar10;
          if (local_14 <= local_10) {
            local_10 = local_10 - local_14;
            uVar10 = uVar10 | 1;
            local_48 = uVar10;
          }
        } while (0xffffff < local_14);
      }
      local_8c[0] = 0xc;
      goto LAB_00407234;
    case 0xd:
      goto switchD_00406841_caseD_d;
    case 0xe:
      goto switchD_00406841_caseD_e;
    case 0xf:
      goto switchD_00406841_caseD_f;
    case 0x10:
      goto switchD_00406841_caseD_10;
    case 0x12:
      if (local_44 == 0) {
        local_34 = 0;
        iVar9 = local_50 * 8 + 2;
LAB_00406ffb:
        local_5c = local_5c + iVar9;
        local_44 = 3;
        goto LAB_004070d8;
      }
      local_8c[1] = 0x13;
      puVar11 = local_5c + 1;
      break;
    case 0x13:
      if (local_44 == 0) {
        local_34 = 8;
        iVar9 = local_50 * 8 + 0x82;
        goto LAB_00406ffb;
      }
      local_5c = local_5c + 0x102;
      local_34 = 0x10;
      local_44 = 8;
LAB_004070d8:
      local_8c[3] = 0x14;
    case 0x17:
switchD_00406841_caseD_17:
      local_54 = 1;
      for (local_4c = local_44; 0 < (int)local_4c; local_4c = local_4c - 1) {
        puVar11 = local_5c + local_54;
        local_58 = puVar11;
        uVar2 = *puVar11;
        uVar10 = (local_14 >> 0xb) * (uint)uVar2;
        if (local_10 < uVar10) {
          local_14 = uVar10;
          local_54 = local_54 << 1;
          *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
        }
        else {
          local_14 = local_14 - uVar10;
          local_10 = local_10 - uVar10;
          *puVar11 = uVar2 - (uVar2 >> 5);
          local_54 = local_54 * 2 + 1;
        }
        if (local_14 < 0x1000000) {
switchD_00406841_caseD_18:
          if (local_70 == 0) {
            local_8c[0] = 0x18;
            goto LAB_00407234;
          }
          local_14 = local_14 << 8;
          bVar1 = *local_74;
          local_70 = local_70 + -1;
          local_74 = local_74 + 1;
          local_10 = local_10 << 8 | (uint)bVar1;
        }
      }
      uVar10 = local_54 - (1 << ((byte)local_44 & 0x1f));
      local_48 = uVar10;
      local_8c[0] = local_8c[3];
      goto LAB_00407096;
    case 0x14:
      local_34 = local_34 + uVar10;
      local_8c[0] = local_8c[2];
      goto LAB_00407096;
    case 0x15:
      local_3c = ((6 < local_3c) - 1 & 0xfffffffd) + 0xb;
      goto LAB_00406f7d;
    case 0x16:
      iVar9 = local_34;
      if (3 < local_34) {
        iVar9 = 3;
      }
      local_44 = 6;
      local_8c[3] = 0x19;
      local_5c = (ushort *)(iVar9 * 0x80 + 0x360 + (int)local_8);
      goto switchD_00406841_caseD_17;
    case 0x18:
      goto switchD_00406841_caseD_18;
    case 0x19:
      local_30 = uVar10;
      if (3 < (int)uVar10) {
        iVar9 = (int)uVar10 >> 1;
        local_44 = iVar9 - 1;
        uVar8 = (uint)((byte)uVar10 & 1 | 2) << ((byte)local_44 & 0x1f);
        local_30 = uVar8;
        if (0xd < (int)uVar10) {
          uVar10 = 0;
          local_4c = iVar9 - 5;
          goto LAB_00406e7d;
        }
        local_5c = (ushort *)((int)local_8 + (uVar8 - uVar10) * 2 + 0x55e);
LAB_00406ec1:
        uVar10 = 0;
        local_54 = 1;
        local_48 = 0;
        for (local_4c = 0; (int)local_4c < (int)local_44; local_4c = local_4c + 1) {
          puVar11 = local_5c + local_54;
          local_58 = puVar11;
          uVar2 = *puVar11;
          uVar8 = (local_14 >> 0xb) * (uint)uVar2;
          if (local_10 < uVar8) {
            local_14 = uVar8;
            local_54 = local_54 << 1;
            *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
          }
          else {
            local_14 = local_14 - uVar8;
            local_10 = local_10 - uVar8;
            uVar10 = local_48 | 1 << ((byte)local_4c & 0x1f);
            local_48 = uVar10;
            *puVar11 = uVar2 - (uVar2 >> 5);
            local_54 = local_54 * 2 + 1;
          }
          if (local_14 < 0x1000000) {
switchD_00406841_caseD_10:
            if (local_70 == 0) {
              local_8c[0] = 0x10;
              goto LAB_00407234;
            }
            local_14 = local_14 << 8;
            bVar1 = *local_74;
            local_70 = local_70 + -1;
            local_74 = local_74 + 1;
            local_10 = local_10 << 8 | (uint)bVar1;
          }
        }
        local_30 = local_30 + uVar10;
      }
      local_30 = local_30 + 1;
LAB_00406f7d:
      if (local_30 == 0) {
        local_34 = 0xffffffff;
        goto LAB_00407234;
      }
      if (local_64 < local_30) {
        return 0xffffffff;
      }
      local_34 = local_34 + 2;
      local_64 = local_64 + local_34;
switchD_00406841_caseD_1c:
      do {
        pbVar4 = local_6c;
        if (local_68 == 0) {
          local_8c[0] = 0x1c;
          goto LAB_00407234;
        }
        uVar8 = local_18 - local_30;
        if (local_78 <= uVar8) {
          uVar8 = uVar8 + local_78;
        }
        local_60 = *(byte *)(uVar8 + (int)local_c);
        *(byte *)(local_18 + (int)local_c) = local_60;
        local_6c = local_6c + 1;
        local_68 = local_68 + -1;
        local_34 = local_34 + -1;
        *pbVar4 = local_60;
        local_18 = (local_18 + 1) % local_78;
      } while (0 < local_34);
      goto LAB_00406d5c;
    case 0x1a:
      goto switchD_00406841_caseD_1a;
    case 0x1c:
      goto switchD_00406841_caseD_1c;
    default:
      return 0xffffffff;
    }
    local_58 = puVar11;
switchD_00406841_caseD_4:
    uVar2 = *puVar11;
    uVar8 = (local_14 >> 0xb) * (uint)uVar2;
    bVar14 = uVar8 <= local_10;
    if (bVar14) {
      local_14 = local_14 - uVar8;
      local_10 = local_10 - uVar8;
      local_44 = 1;
      *puVar11 = uVar2 - (uVar2 >> 5);
    }
    else {
      local_14 = uVar8;
      local_44 = 0;
      *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
    }
    local_44 = (uint)bVar14;
    local_8c[0] = local_8c[1];
    if (local_14 < 0x1000000) {
switchD_00406841_caseD_5:
      if (local_70 == 0) {
        local_8c[0] = 5;
        goto LAB_00407234;
      }
      local_14 = local_14 << 8;
      bVar1 = *local_74;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      local_10 = local_10 << 8 | (uint)bVar1;
      local_8c[0] = local_8c[1];
    }
LAB_00407096:
  } while( true );
LAB_00406b25:
  if ((int)uVar10 < 0x100) {
    puVar11 = local_5c + uVar10;
    uVar2 = *puVar11;
    local_58 = puVar11;
    uVar8 = (local_14 >> 0xb) * (uint)uVar2;
    if (local_10 < uVar8) {
      local_14 = uVar8;
      uVar10 = uVar10 * 2;
      *puVar11 = (short)((int)(0x800 - (uint)uVar2) >> 5) + uVar2;
    }
    else {
      local_14 = local_14 - uVar8;
      local_10 = local_10 - uVar8;
      uVar10 = uVar10 * 2 + 1;
      *puVar11 = uVar2 - (uVar2 >> 5);
    }
    local_48 = uVar10;
    if (local_14 < 0x1000000) {
switchD_00406841_caseD_e:
      if (local_70 == 0) {
        local_8c[0] = 0xe;
        goto LAB_00407234;
      }
      local_14 = local_14 << 8;
      bVar1 = *local_74;
      local_70 = local_70 + -1;
      local_74 = local_74 + 1;
      local_10 = local_10 << 8 | (uint)bVar1;
    }
    goto LAB_00406b25;
  }
LAB_00406b89:
  local_38 = 0;
LAB_00406b8d:
  local_60 = (byte)local_48;
switchD_00406841_caseD_1a:
  if (local_68 == 0) {
    local_8c[0] = 0x1a;
LAB_00407234:
    pSVar12 = local_8c;
    for (iVar9 = 0x22; iVar9 != 0; iVar9 = iVar9 + -1) {
      *param_1 = *pSVar12;
      pSVar12 = pSVar12 + 1;
      param_1 = param_1 + 1;
    }
    return 0;
  }
  local_64 = local_64 + 1;
  local_6c = local_6c + 1;
  local_68 = local_68 + -1;
  *pbVar5 = local_60;
  *(byte *)(local_18 + (int)local_c) = local_60;
LAB_00406d59:
  local_18 = (local_18 + 1) % local_78;
LAB_00406d5c:
  local_8c[0] = 2;
  goto LAB_00406832;
}



